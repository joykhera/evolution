{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7217201651561828, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.185116860097048, "policy_loss": -0.007637061213916808, "vf_loss": 4.191411911242853, "vf_explained_var": 0.005362744306130384, "kl": 0.00671007578673075, "entropy": 1.6028172827271558, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8379919139165727, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.196685807667081, "policy_loss": -0.004508740504681276, "vf_loss": 7.200243175345123, "vf_explained_var": 0.01132294497792683, "kl": 0.004756827422003577, "entropy": 1.6047240599753365, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 333.0, "episode_reward_min": -143.0, "episode_reward_mean": 16.61111111111111, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 3600, "policy_reward_min": {"prey_policy": -322.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 145.0}, "policy_reward_mean": {"prey_policy": -31.36111111111111, "predator_policy": 39.666666666666664}, "custom_metrics": {}, "hist_stats": {"episode_reward": [333.0, 30.0, -96.0, 56.0, 127.0, 20.0, 10.0, -52.0, -55.0, 52.0, -79.0, 180.0, -4.0, -49.0, 29.0, 42.0, -143.0, -102.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [199.0, 104.0, -12.0, -23.0, -68.0, -131.0, 0.0, 35.0, 52.0, 75.0, 92.0, -322.0, 72.0, -128.0, -76.0, -35.0, 0.0, -110.0, -50.0, 30.0, -160.0, 0.0, 15.0, 122.0, 13.0, -78.0, -158.0, -79.0, 13.0, 16.0, 5.0, 18.0, -109.0, -186.0, -167.0, -98.0], "policy_predator_policy_reward": [30.0, 0.0, 37.0, 28.0, 103.0, 0.0, 0.0, 21.0, 0.0, 0.0, 145.0, 105.0, 0.0, 66.0, 19.0, 40.0, 0.0, 55.0, 0.0, 72.0, 75.0, 6.0, 37.0, 6.0, 0.0, 61.0, 103.0, 85.0, 0.0, 0.0, 19.0, 0.0, 55.0, 97.0, 37.0, 126.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.364284945771089, "mean_inference_ms": 3.150822390287264, "mean_action_processing_ms": 0.515534205152216, "mean_env_wait_ms": 0.4468175790325162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04092521137661404, "StateBufferConnector_ms": 0.003225935830010308, "ViewRequirementAgentConnector_ms": 0.1364429791768392}, "num_episodes": 18, "episode_return_max": 333.0, "episode_return_min": -143.0, "episode_return_mean": 16.61111111111111, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 217.21281060824862, "num_env_steps_trained_throughput_per_sec": 217.21281060824862, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 18415.17, "restore_workers_time_ms": 0.061, "training_step_time_ms": 18415.017, "sample_time_ms": 2594.129, "learn_time_ms": 15803.339, "learn_throughput": 253.111, "synch_weights_time_ms": 12.381}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "f6b99_00000", "date": "2024-08-13_19-45-03", "timestamp": 1723592703, "time_this_iter_s": 18.506732940673828, "time_total_s": 18.506732940673828, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b324b8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.506732940673828, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 81.47037037037036, "ram_util_percent": 83.97407407407408}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1760011374004304, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.944655702984522, "policy_loss": -0.009606790797361148, "vf_loss": 4.952333114513014, "vf_explained_var": 0.021937787911248587, "kl": 0.009646865609121456, "entropy": 1.5828749989706372, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0030550805979936, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.446452894917241, "policy_loss": -0.007731517222734592, "vf_loss": 7.4533491157350085, "vf_explained_var": 0.020851820328878976, "kl": 0.008352969937512545, "entropy": 1.5928235667092459, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 333.0, "episode_reward_min": -143.0, "episode_reward_mean": 47.638888888888886, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 7200, "policy_reward_min": {"prey_policy": -322.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 145.0}, "policy_reward_mean": {"prey_policy": -16.26388888888889, "predator_policy": 40.083333333333336}, "custom_metrics": {}, "hist_stats": {"episode_reward": [333.0, 30.0, -96.0, 56.0, 127.0, 20.0, 10.0, -52.0, -55.0, 52.0, -79.0, 180.0, -4.0, -49.0, 29.0, 42.0, -143.0, -102.0, 83.0, 87.0, -102.0, -3.0, 114.0, 248.0, 96.0, 85.0, 35.0, 76.0, 111.0, -39.0, 22.0, 9.0, 186.0, -22.0, 102.0, 328.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [199.0, 104.0, -12.0, -23.0, -68.0, -131.0, 0.0, 35.0, 52.0, 75.0, 92.0, -322.0, 72.0, -128.0, -76.0, -35.0, 0.0, -110.0, -50.0, 30.0, -160.0, 0.0, 15.0, 122.0, 13.0, -78.0, -158.0, -79.0, 13.0, 16.0, 5.0, 18.0, -109.0, -186.0, -167.0, -98.0, -81.0, 96.0, 65.0, -76.0, -261.0, 28.0, 2.0, -33.0, 139.0, -257.0, 146.0, 90.0, -65.0, 79.0, 29.0, 0.0, -8.0, 36.0, -27.0, 48.0, 2.0, -28.0, -179.0, 34.0, -65.0, -2.0, -160.0, 56.0, -41.0, 192.0, -177.0, 16.0, 58.0, -12.0, 126.0, 188.0], "policy_predator_policy_reward": [30.0, 0.0, 37.0, 28.0, 103.0, 0.0, 0.0, 21.0, 0.0, 0.0, 145.0, 105.0, 0.0, 66.0, 19.0, 40.0, 0.0, 55.0, 0.0, 72.0, 75.0, 6.0, 37.0, 6.0, 0.0, 61.0, 103.0, 85.0, 0.0, 0.0, 19.0, 0.0, 55.0, 97.0, 37.0, 126.0, 40.0, 28.0, 9.0, 89.0, 82.0, 49.0, 0.0, 28.0, 139.0, 93.0, 0.0, 12.0, 30.0, 52.0, 0.0, 56.0, 0.0, 7.0, 28.0, 27.0, 74.0, 63.0, 106.0, 0.0, 87.0, 2.0, 0.0, 113.0, 0.0, 35.0, 88.0, 51.0, 0.0, 56.0, 0.0, 14.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3812845192461032, "mean_inference_ms": 3.2820653828728537, "mean_action_processing_ms": 0.530401497042171, "mean_env_wait_ms": 0.45996475615800236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0345485077963935, "StateBufferConnector_ms": 0.0031703048282199437, "ViewRequirementAgentConnector_ms": 0.2554121944639418}, "num_episodes": 18, "episode_return_max": 333.0, "episode_return_min": -143.0, "episode_return_mean": 47.638888888888886, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 226.2642583623237, "num_env_steps_trained_throughput_per_sec": 226.2642583623237, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 18046.887, "restore_workers_time_ms": 0.124, "training_step_time_ms": 18046.565, "sample_time_ms": 2752.836, "learn_time_ms": 15273.175, "learn_throughput": 261.897, "synch_weights_time_ms": 13.897}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "f6b99_00000", "date": "2024-08-13_19-45-27", "timestamp": 1723592727, "time_this_iter_s": 17.72310709953308, "time_total_s": 36.22984004020691, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b324b160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 36.22984004020691, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 80.93235294117646, "ram_util_percent": 83.92941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4333368447407213, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.656484982828615, "policy_loss": -0.0072603311907086104, "vf_loss": 6.661854652626805, "vf_explained_var": 0.012143725282931454, "kl": 0.009453209790002215, "entropy": 1.568425593994282, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4555530785568176, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.280620833048745, "policy_loss": -0.004589584028525722, "vf_loss": 8.284474665273434, "vf_explained_var": 0.011737798950659534, "kl": 0.007357537592296829, "entropy": 1.580231596679284, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 333.0, "episode_reward_min": -156.0, "episode_reward_mean": 41.22222222222222, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 10800, "policy_reward_min": {"prey_policy": -322.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 166.0}, "policy_reward_mean": {"prey_policy": -24.75925925925926, "predator_policy": 45.370370370370374}, "custom_metrics": {}, "hist_stats": {"episode_reward": [333.0, 30.0, -96.0, 56.0, 127.0, 20.0, 10.0, -52.0, -55.0, 52.0, -79.0, 180.0, -4.0, -49.0, 29.0, 42.0, -143.0, -102.0, 83.0, 87.0, -102.0, -3.0, 114.0, 248.0, 96.0, 85.0, 35.0, 76.0, 111.0, -39.0, 22.0, 9.0, 186.0, -22.0, 102.0, 328.0, 324.0, -71.0, 60.0, 140.0, 93.0, -126.0, 142.0, 73.0, -81.0, 154.0, 2.0, -59.0, 40.0, -6.0, 66.0, -156.0, 0.0, -84.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [199.0, 104.0, -12.0, -23.0, -68.0, -131.0, 0.0, 35.0, 52.0, 75.0, 92.0, -322.0, 72.0, -128.0, -76.0, -35.0, 0.0, -110.0, -50.0, 30.0, -160.0, 0.0, 15.0, 122.0, 13.0, -78.0, -158.0, -79.0, 13.0, 16.0, 5.0, 18.0, -109.0, -186.0, -167.0, -98.0, -81.0, 96.0, 65.0, -76.0, -261.0, 28.0, 2.0, -33.0, 139.0, -257.0, 146.0, 90.0, -65.0, 79.0, 29.0, 0.0, -8.0, 36.0, -27.0, 48.0, 2.0, -28.0, -179.0, 34.0, -65.0, -2.0, -160.0, 56.0, -41.0, 192.0, -177.0, 16.0, 58.0, -12.0, 126.0, 188.0, 125.0, 199.0, -140.0, -81.0, 48.0, 12.0, 41.0, 56.0, -144.0, 39.0, -166.0, -178.0, 138.0, 0.0, -50.0, 46.0, -291.0, 7.0, 37.0, -24.0, 0.0, 2.0, 0.0, -190.0, -128.0, 72.0, 23.0, -119.0, 109.0, -201.0, -210.0, -210.0, 13.0, -107.0, -90.0, -141.0], "policy_predator_policy_reward": [30.0, 0.0, 37.0, 28.0, 103.0, 0.0, 0.0, 21.0, 0.0, 0.0, 145.0, 105.0, 0.0, 66.0, 19.0, 40.0, 0.0, 55.0, 0.0, 72.0, 75.0, 6.0, 37.0, 6.0, 0.0, 61.0, 103.0, 85.0, 0.0, 0.0, 19.0, 0.0, 55.0, 97.0, 37.0, 126.0, 40.0, 28.0, 9.0, 89.0, 82.0, 49.0, 0.0, 28.0, 139.0, 93.0, 0.0, 12.0, 30.0, 52.0, 0.0, 56.0, 0.0, 7.0, 28.0, 27.0, 74.0, 63.0, 106.0, 0.0, 87.0, 2.0, 0.0, 113.0, 0.0, 35.0, 88.0, 51.0, 0.0, 56.0, 0.0, 14.0, 0.0, 0.0, 63.0, 87.0, 0.0, 0.0, 43.0, 0.0, 97.0, 101.0, 66.0, 152.0, 2.0, 2.0, 39.0, 38.0, 166.0, 37.0, 82.0, 59.0, 0.0, 0.0, 128.0, 3.0, 50.0, 46.0, 58.0, 32.0, 83.0, 75.0, 165.0, 99.0, 27.0, 67.0, 48.0, 99.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3231993184832118, "mean_inference_ms": 3.1805247625282154, "mean_action_processing_ms": 0.5084009717155106, "mean_env_wait_ms": 0.4390722459910118, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025919410917494033, "StateBufferConnector_ms": 0.0032462455608226635, "ViewRequirementAgentConnector_ms": 0.21771611990752043}, "num_episodes": 18, "episode_return_max": 333.0, "episode_return_min": -156.0, "episode_return_mean": 41.22222222222222, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 243.8401257226234, "num_env_steps_trained_throughput_per_sec": 243.8401257226234, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 17499.325, "restore_workers_time_ms": 0.088, "training_step_time_ms": 17499.093, "sample_time_ms": 2380.469, "learn_time_ms": 15096.299, "learn_throughput": 264.966, "synch_weights_time_ms": 15.367}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "f6b99_00000", "date": "2024-08-13_19-45-44", "timestamp": 1723592744, "time_this_iter_s": 16.456736087799072, "time_total_s": 52.68657612800598, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b60213a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 52.68657612800598, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 78.7695652173913, "ram_util_percent": 83.59565217391304}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4302586042376422, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.4843311847202365, "policy_loss": -0.008256135288892047, "vf_loss": 7.490645426543302, "vf_explained_var": 0.012992261421112787, "kl": 0.009709369930070788, "entropy": 1.549536031705362, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.513473760577106, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.273107599329066, "policy_loss": -0.007994988059228355, "vf_loss": 9.27968586916646, "vf_explained_var": 0.016808049987863612, "kl": 0.01416703924124236, "entropy": 1.5649980029101094, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 333.0, "episode_reward_min": -191.0, "episode_reward_mean": 26.25, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -371.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 185.0}, "policy_reward_mean": {"prey_policy": -39.166666666666664, "predator_policy": 52.291666666666664}, "custom_metrics": {}, "hist_stats": {"episode_reward": [333.0, 30.0, -96.0, 56.0, 127.0, 20.0, 10.0, -52.0, -55.0, 52.0, -79.0, 180.0, -4.0, -49.0, 29.0, 42.0, -143.0, -102.0, 83.0, 87.0, -102.0, -3.0, 114.0, 248.0, 96.0, 85.0, 35.0, 76.0, 111.0, -39.0, 22.0, 9.0, 186.0, -22.0, 102.0, 328.0, 324.0, -71.0, 60.0, 140.0, 93.0, -126.0, 142.0, 73.0, -81.0, 154.0, 2.0, -59.0, 40.0, -6.0, 66.0, -156.0, 0.0, -84.0, 131.0, -28.0, -97.0, -191.0, 155.0, -154.0, -40.0, -90.0, 3.0, -90.0, 159.0, -13.0, -51.0, 1.0, 73.0, 5.0, -63.0, -46.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [199.0, 104.0, -12.0, -23.0, -68.0, -131.0, 0.0, 35.0, 52.0, 75.0, 92.0, -322.0, 72.0, -128.0, -76.0, -35.0, 0.0, -110.0, -50.0, 30.0, -160.0, 0.0, 15.0, 122.0, 13.0, -78.0, -158.0, -79.0, 13.0, 16.0, 5.0, 18.0, -109.0, -186.0, -167.0, -98.0, -81.0, 96.0, 65.0, -76.0, -261.0, 28.0, 2.0, -33.0, 139.0, -257.0, 146.0, 90.0, -65.0, 79.0, 29.0, 0.0, -8.0, 36.0, -27.0, 48.0, 2.0, -28.0, -179.0, 34.0, -65.0, -2.0, -160.0, 56.0, -41.0, 192.0, -177.0, 16.0, 58.0, -12.0, 126.0, 188.0, 125.0, 199.0, -140.0, -81.0, 48.0, 12.0, 41.0, 56.0, -144.0, 39.0, -166.0, -178.0, 138.0, 0.0, -50.0, 46.0, -291.0, 7.0, 37.0, -24.0, 0.0, 2.0, 0.0, -190.0, -128.0, 72.0, 23.0, -119.0, 109.0, -201.0, -210.0, -210.0, 13.0, -107.0, -90.0, -141.0, 7.0, 55.0, -133.0, -99.0, -27.0, -289.0, -371.0, -164.0, 49.0, 74.0, -228.0, -104.0, -241.0, -11.0, -78.0, -54.0, -29.0, -57.0, -47.0, -234.0, 64.0, 21.0, -7.0, -121.0, -43.0, -130.0, -79.0, -96.0, 22.0, -86.0, -23.0, -92.0, -191.0, -2.0, -40.0, -182.0], "policy_predator_policy_reward": [30.0, 0.0, 37.0, 28.0, 103.0, 0.0, 0.0, 21.0, 0.0, 0.0, 145.0, 105.0, 0.0, 66.0, 19.0, 40.0, 0.0, 55.0, 0.0, 72.0, 75.0, 6.0, 37.0, 6.0, 0.0, 61.0, 103.0, 85.0, 0.0, 0.0, 19.0, 0.0, 55.0, 97.0, 37.0, 126.0, 40.0, 28.0, 9.0, 89.0, 82.0, 49.0, 0.0, 28.0, 139.0, 93.0, 0.0, 12.0, 30.0, 52.0, 0.0, 56.0, 0.0, 7.0, 28.0, 27.0, 74.0, 63.0, 106.0, 0.0, 87.0, 2.0, 0.0, 113.0, 0.0, 35.0, 88.0, 51.0, 0.0, 56.0, 0.0, 14.0, 0.0, 0.0, 63.0, 87.0, 0.0, 0.0, 43.0, 0.0, 97.0, 101.0, 66.0, 152.0, 2.0, 2.0, 39.0, 38.0, 166.0, 37.0, 82.0, 59.0, 0.0, 0.0, 128.0, 3.0, 50.0, 46.0, 58.0, 32.0, 83.0, 75.0, 165.0, 99.0, 27.0, 67.0, 48.0, 99.0, 23.0, 46.0, 82.0, 122.0, 99.0, 120.0, 185.0, 159.0, 0.0, 32.0, 90.0, 88.0, 131.0, 81.0, 42.0, 0.0, 51.0, 38.0, 28.0, 163.0, 61.0, 13.0, 107.0, 8.0, 99.0, 23.0, 100.0, 76.0, 31.0, 106.0, 43.0, 77.0, 79.0, 51.0, 56.0, 120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2683323519448695, "mean_inference_ms": 3.0821446685510034, "mean_action_processing_ms": 0.4919488026028669, "mean_env_wait_ms": 0.424043684422011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02096013890372382, "StateBufferConnector_ms": 0.003237360053592258, "ViewRequirementAgentConnector_ms": 0.1906628410021464}, "num_episodes": 18, "episode_return_max": 333.0, "episode_return_min": -191.0, "episode_return_mean": 26.25, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 242.72236515511767, "num_env_steps_trained_throughput_per_sec": 242.72236515511767, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 17244.429, "restore_workers_time_ms": 0.07, "training_step_time_ms": 17244.242, "sample_time_ms": 2235.057, "learn_time_ms": 14988.962, "learn_throughput": 266.863, "synch_weights_time_ms": 14.557}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "f6b99_00000", "date": "2024-08-13_19-46-01", "timestamp": 1723592761, "time_this_iter_s": 16.527651071548462, "time_total_s": 69.21422719955444, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b60215e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 69.21422719955444, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 76.96249999999999, "ram_util_percent": 83.58333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8124363847825893, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.22680996864561, "policy_loss": -0.007655344288500529, "vf_loss": 6.2321098138415625, "vf_explained_var": 0.002817714813525084, "kl": 0.011777461466767072, "entropy": 1.527014184628845, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.88729523619016, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.063138818236255, "policy_loss": -0.006011030306822803, "vf_loss": 7.068146636246373, "vf_explained_var": -0.05166840187456242, "kl": 0.010032016377750601, "entropy": 1.5639723423296812, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 342.0, "episode_reward_min": -191.0, "episode_reward_mean": 29.86868686868687, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 19800, "policy_reward_min": {"prey_policy": -371.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 185.0}, "policy_reward_mean": {"prey_policy": -36.04040404040404, "predator_policy": 50.974747474747474}, "custom_metrics": {}, "hist_stats": {"episode_reward": [333.0, 30.0, -96.0, 56.0, 127.0, 20.0, 10.0, -52.0, -55.0, 52.0, -79.0, 180.0, -4.0, -49.0, 29.0, 42.0, -143.0, -102.0, 83.0, 87.0, -102.0, -3.0, 114.0, 248.0, 96.0, 85.0, 35.0, 76.0, 111.0, -39.0, 22.0, 9.0, 186.0, -22.0, 102.0, 328.0, 324.0, -71.0, 60.0, 140.0, 93.0, -126.0, 142.0, 73.0, -81.0, 154.0, 2.0, -59.0, 40.0, -6.0, 66.0, -156.0, 0.0, -84.0, 131.0, -28.0, -97.0, -191.0, 155.0, -154.0, -40.0, -90.0, 3.0, -90.0, 159.0, -13.0, -51.0, 1.0, 73.0, 5.0, -63.0, -46.0, 36.0, 28.0, 156.0, 342.0, -42.0, 43.0, -5.0, 76.0, 23.0, -123.0, -69.0, 57.0, 47.0, -75.0, 3.0, 199.0, 14.0, -81.0, 40.0, 68.0, 12.0, -91.0, 73.0, -7.0, 204.0, 56.0, 83.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [199.0, 104.0, -12.0, -23.0, -68.0, -131.0, 0.0, 35.0, 52.0, 75.0, 92.0, -322.0, 72.0, -128.0, -76.0, -35.0, 0.0, -110.0, -50.0, 30.0, -160.0, 0.0, 15.0, 122.0, 13.0, -78.0, -158.0, -79.0, 13.0, 16.0, 5.0, 18.0, -109.0, -186.0, -167.0, -98.0, -81.0, 96.0, 65.0, -76.0, -261.0, 28.0, 2.0, -33.0, 139.0, -257.0, 146.0, 90.0, -65.0, 79.0, 29.0, 0.0, -8.0, 36.0, -27.0, 48.0, 2.0, -28.0, -179.0, 34.0, -65.0, -2.0, -160.0, 56.0, -41.0, 192.0, -177.0, 16.0, 58.0, -12.0, 126.0, 188.0, 125.0, 199.0, -140.0, -81.0, 48.0, 12.0, 41.0, 56.0, -144.0, 39.0, -166.0, -178.0, 138.0, 0.0, -50.0, 46.0, -291.0, 7.0, 37.0, -24.0, 0.0, 2.0, 0.0, -190.0, -128.0, 72.0, 23.0, -119.0, 109.0, -201.0, -210.0, -210.0, 13.0, -107.0, -90.0, -141.0, 7.0, 55.0, -133.0, -99.0, -27.0, -289.0, -371.0, -164.0, 49.0, 74.0, -228.0, -104.0, -241.0, -11.0, -78.0, -54.0, -29.0, -57.0, -47.0, -234.0, 64.0, 21.0, -7.0, -121.0, -43.0, -130.0, -79.0, -96.0, 22.0, -86.0, -23.0, -92.0, -191.0, -2.0, -40.0, -182.0, -150.0, 39.0, 18.0, -88.0, 79.0, -4.0, 183.0, 157.0, -149.0, -66.0, -1.0, 0.0, -130.0, -40.0, 48.0, 0.0, -18.0, 17.0, -68.0, -257.0, -165.0, -32.0, -44.0, -46.0, -190.0, 142.0, -38.0, -102.0, 7.0, -119.0, 47.0, 106.0, -18.0, -61.0, -170.0, -122.0, -113.0, 46.0, 48.0, -57.0, -10.0, -73.0, -143.0, -83.0, 0.0, 73.0, 14.0, -197.0, 66.0, 61.0, 41.0, -15.0, 44.0, 37.0], "policy_predator_policy_reward": [30.0, 0.0, 37.0, 28.0, 103.0, 0.0, 0.0, 21.0, 0.0, 0.0, 145.0, 105.0, 0.0, 66.0, 19.0, 40.0, 0.0, 55.0, 0.0, 72.0, 75.0, 6.0, 37.0, 6.0, 0.0, 61.0, 103.0, 85.0, 0.0, 0.0, 19.0, 0.0, 55.0, 97.0, 37.0, 126.0, 40.0, 28.0, 9.0, 89.0, 82.0, 49.0, 0.0, 28.0, 139.0, 93.0, 0.0, 12.0, 30.0, 52.0, 0.0, 56.0, 0.0, 7.0, 28.0, 27.0, 74.0, 63.0, 106.0, 0.0, 87.0, 2.0, 0.0, 113.0, 0.0, 35.0, 88.0, 51.0, 0.0, 56.0, 0.0, 14.0, 0.0, 0.0, 63.0, 87.0, 0.0, 0.0, 43.0, 0.0, 97.0, 101.0, 66.0, 152.0, 2.0, 2.0, 39.0, 38.0, 166.0, 37.0, 82.0, 59.0, 0.0, 0.0, 128.0, 3.0, 50.0, 46.0, 58.0, 32.0, 83.0, 75.0, 165.0, 99.0, 27.0, 67.0, 48.0, 99.0, 23.0, 46.0, 82.0, 122.0, 99.0, 120.0, 185.0, 159.0, 0.0, 32.0, 90.0, 88.0, 131.0, 81.0, 42.0, 0.0, 51.0, 38.0, 28.0, 163.0, 61.0, 13.0, 107.0, 8.0, 99.0, 23.0, 100.0, 76.0, 31.0, 106.0, 43.0, 77.0, 79.0, 51.0, 56.0, 120.0, 108.0, 39.0, 43.0, 55.0, 16.0, 65.0, 0.0, 2.0, 137.0, 36.0, 38.0, 6.0, 88.0, 77.0, 0.0, 28.0, 8.0, 16.0, 151.0, 51.0, 61.0, 67.0, 81.0, 66.0, 95.0, 0.0, 32.0, 33.0, 78.0, 37.0, 0.0, 46.0, 73.0, 20.0, 102.0, 109.0, 42.0, 65.0, 22.0, 55.0, 72.0, 23.0, 57.0, 78.0, 0.0, 0.0, 77.0, 99.0, 35.0, 42.0, 30.0, 0.0, 0.0, 2.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.242115551754252, "mean_inference_ms": 3.0397058677183284, "mean_action_processing_ms": 0.4875702841749615, "mean_env_wait_ms": 0.4189881686251071, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0427543514906758, "StateBufferConnector_ms": 0.0033063117903892442, "ViewRequirementAgentConnector_ms": 0.22003602499913688}, "num_episodes": 27, "episode_return_max": 342.0, "episode_return_min": -191.0, "episode_return_mean": 29.86868686868687, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 114.9624155103592, "num_env_steps_trained_throughput_per_sec": 114.9624155103592, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 20754.341, "restore_workers_time_ms": 0.059, "training_step_time_ms": 20754.168, "sample_time_ms": 2373.573, "learn_time_ms": 18361.501, "learn_throughput": 217.847, "synch_weights_time_ms": 14.165}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "f6b99_00000", "date": "2024-08-13_19-46-35", "timestamp": 1723592795, "time_this_iter_s": 34.86646294593811, "time_total_s": 104.08069014549255, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b328e160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 104.08069014549255, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 93.01224489795919, "ram_util_percent": 84.59591836734695}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7466894393560117, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.000654466694625, "policy_loss": -0.007310872012379742, "vf_loss": 5.006007406446669, "vf_explained_var": 0.017317791905983416, "kl": 0.009789630329727595, "entropy": 1.5230933579187544, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7147362087769482, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.124846525797769, "policy_loss": -0.00927387387996845, "vf_loss": 7.132808272296159, "vf_explained_var": 0.006632635706946963, "kl": 0.01312124731866594, "entropy": 1.5480726245849852, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 342.0, "episode_reward_min": -191.0, "episode_reward_mean": 35.41, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -371.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 185.0}, "policy_reward_mean": {"prey_policy": -32.96, "predator_policy": 50.665}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-102.0, 83.0, 87.0, -102.0, -3.0, 114.0, 248.0, 96.0, 85.0, 35.0, 76.0, 111.0, -39.0, 22.0, 9.0, 186.0, -22.0, 102.0, 328.0, 324.0, -71.0, 60.0, 140.0, 93.0, -126.0, 142.0, 73.0, -81.0, 154.0, 2.0, -59.0, 40.0, -6.0, 66.0, -156.0, 0.0, -84.0, 131.0, -28.0, -97.0, -191.0, 155.0, -154.0, -40.0, -90.0, 3.0, -90.0, 159.0, -13.0, -51.0, 1.0, 73.0, 5.0, -63.0, -46.0, 36.0, 28.0, 156.0, 342.0, -42.0, 43.0, -5.0, 76.0, 23.0, -123.0, -69.0, 57.0, 47.0, -75.0, 3.0, 199.0, 14.0, -81.0, 40.0, 68.0, 12.0, -91.0, 73.0, -7.0, 204.0, 56.0, 83.0, 262.0, 130.0, -16.0, 22.0, -32.0, 43.0, 105.0, 139.0, -2.0, 38.0, 24.0, -98.0, 101.0, 76.0, 101.0, 12.0, -40.0, 120.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-167.0, -98.0, -81.0, 96.0, 65.0, -76.0, -261.0, 28.0, 2.0, -33.0, 139.0, -257.0, 146.0, 90.0, -65.0, 79.0, 29.0, 0.0, -8.0, 36.0, -27.0, 48.0, 2.0, -28.0, -179.0, 34.0, -65.0, -2.0, -160.0, 56.0, -41.0, 192.0, -177.0, 16.0, 58.0, -12.0, 126.0, 188.0, 125.0, 199.0, -140.0, -81.0, 48.0, 12.0, 41.0, 56.0, -144.0, 39.0, -166.0, -178.0, 138.0, 0.0, -50.0, 46.0, -291.0, 7.0, 37.0, -24.0, 0.0, 2.0, 0.0, -190.0, -128.0, 72.0, 23.0, -119.0, 109.0, -201.0, -210.0, -210.0, 13.0, -107.0, -90.0, -141.0, 7.0, 55.0, -133.0, -99.0, -27.0, -289.0, -371.0, -164.0, 49.0, 74.0, -228.0, -104.0, -241.0, -11.0, -78.0, -54.0, -29.0, -57.0, -47.0, -234.0, 64.0, 21.0, -7.0, -121.0, -43.0, -130.0, -79.0, -96.0, 22.0, -86.0, -23.0, -92.0, -191.0, -2.0, -40.0, -182.0, -150.0, 39.0, 18.0, -88.0, 79.0, -4.0, 183.0, 157.0, -149.0, -66.0, -1.0, 0.0, -130.0, -40.0, 48.0, 0.0, -18.0, 17.0, -68.0, -257.0, -165.0, -32.0, -44.0, -46.0, -190.0, 142.0, -38.0, -102.0, 7.0, -119.0, 47.0, 106.0, -18.0, -61.0, -170.0, -122.0, -113.0, 46.0, 48.0, -57.0, -10.0, -73.0, -143.0, -83.0, 0.0, 73.0, 14.0, -197.0, 66.0, 61.0, 41.0, -15.0, 44.0, 37.0, 134.0, 122.0, -153.0, 136.0, 0.0, -90.0, -63.0, 0.0, -102.0, -8.0, 8.0, -28.0, 53.0, 14.0, 108.0, 30.0, -22.0, -40.0, 1.0, 29.0, -41.0, -47.0, -142.0, -98.0, 67.0, -39.0, 50.0, 17.0, 7.0, 30.0, -22.0, -100.0, -140.0, -74.0, -30.0, 113.0], "policy_predator_policy_reward": [37.0, 126.0, 40.0, 28.0, 9.0, 89.0, 82.0, 49.0, 0.0, 28.0, 139.0, 93.0, 0.0, 12.0, 30.0, 52.0, 0.0, 56.0, 0.0, 7.0, 28.0, 27.0, 74.0, 63.0, 106.0, 0.0, 87.0, 2.0, 0.0, 113.0, 0.0, 35.0, 88.0, 51.0, 0.0, 56.0, 0.0, 14.0, 0.0, 0.0, 63.0, 87.0, 0.0, 0.0, 43.0, 0.0, 97.0, 101.0, 66.0, 152.0, 2.0, 2.0, 39.0, 38.0, 166.0, 37.0, 82.0, 59.0, 0.0, 0.0, 128.0, 3.0, 50.0, 46.0, 58.0, 32.0, 83.0, 75.0, 165.0, 99.0, 27.0, 67.0, 48.0, 99.0, 23.0, 46.0, 82.0, 122.0, 99.0, 120.0, 185.0, 159.0, 0.0, 32.0, 90.0, 88.0, 131.0, 81.0, 42.0, 0.0, 51.0, 38.0, 28.0, 163.0, 61.0, 13.0, 107.0, 8.0, 99.0, 23.0, 100.0, 76.0, 31.0, 106.0, 43.0, 77.0, 79.0, 51.0, 56.0, 120.0, 108.0, 39.0, 43.0, 55.0, 16.0, 65.0, 0.0, 2.0, 137.0, 36.0, 38.0, 6.0, 88.0, 77.0, 0.0, 28.0, 8.0, 16.0, 151.0, 51.0, 61.0, 67.0, 81.0, 66.0, 95.0, 0.0, 32.0, 33.0, 78.0, 37.0, 0.0, 46.0, 73.0, 20.0, 102.0, 109.0, 42.0, 65.0, 22.0, 55.0, 72.0, 23.0, 57.0, 78.0, 0.0, 0.0, 77.0, 99.0, 35.0, 42.0, 30.0, 0.0, 0.0, 2.0, 1.0, 5.0, 80.0, 67.0, 30.0, 44.0, 79.0, 6.0, 22.0, 56.0, 57.0, 6.0, 24.0, 14.0, 0.0, 1.0, 40.0, 20.0, 5.0, 3.0, 65.0, 47.0, 45.0, 97.0, 41.0, 32.0, 3.0, 6.0, 20.0, 44.0, 35.0, 99.0, 100.0, 74.0, 1.0, 36.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2215948794645615, "mean_inference_ms": 3.0258268450765966, "mean_action_processing_ms": 0.48532318170328465, "mean_env_wait_ms": 0.4170646181418285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03600418567657471, "StateBufferConnector_ms": 0.0035920143127441406, "ViewRequirementAgentConnector_ms": 0.23606252670288086}, "num_episodes": 18, "episode_return_max": 342.0, "episode_return_min": -191.0, "episode_return_mean": 35.41, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 228.0733049730542, "num_env_steps_trained_throughput_per_sec": 228.0733049730542, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 20218.323, "restore_workers_time_ms": 0.052, "training_step_time_ms": 20218.17, "sample_time_ms": 2516.128, "learn_time_ms": 17681.77, "learn_throughput": 226.222, "synch_weights_time_ms": 14.812}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "f6b99_00000", "date": "2024-08-13_19-46-53", "timestamp": 1723592813, "time_this_iter_s": 17.666506052017212, "time_total_s": 121.74719619750977, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6021700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 121.74719619750977, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 76.94800000000001, "ram_util_percent": 83.788}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5956670949383387, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.596793926960577, "policy_loss": -0.011103116121221945, "vf_loss": 4.605364795336648, "vf_explained_var": 0.0010920668720568298, "kl": 0.012661226812915012, "entropy": 1.505569348385725, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.703815791436604, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.806432010761644, "policy_loss": -0.005045502847947535, "vf_loss": 5.810421644442926, "vf_explained_var": -0.004909854843502953, "kl": 0.01055865651906808, "entropy": 1.550772513409771, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 342.0, "episode_reward_min": -191.0, "episode_reward_mean": 32.07, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -371.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 185.0}, "policy_reward_mean": {"prey_policy": -33.515, "predator_policy": 49.55}, "custom_metrics": {}, "hist_stats": {"episode_reward": [328.0, 324.0, -71.0, 60.0, 140.0, 93.0, -126.0, 142.0, 73.0, -81.0, 154.0, 2.0, -59.0, 40.0, -6.0, 66.0, -156.0, 0.0, -84.0, 131.0, -28.0, -97.0, -191.0, 155.0, -154.0, -40.0, -90.0, 3.0, -90.0, 159.0, -13.0, -51.0, 1.0, 73.0, 5.0, -63.0, -46.0, 36.0, 28.0, 156.0, 342.0, -42.0, 43.0, -5.0, 76.0, 23.0, -123.0, -69.0, 57.0, 47.0, -75.0, 3.0, 199.0, 14.0, -81.0, 40.0, 68.0, 12.0, -91.0, 73.0, -7.0, 204.0, 56.0, 83.0, 262.0, 130.0, -16.0, 22.0, -32.0, 43.0, 105.0, 139.0, -2.0, 38.0, 24.0, -98.0, 101.0, 76.0, 101.0, 12.0, -40.0, 120.0, 146.0, -50.0, 64.0, 17.0, 21.0, 12.0, 78.0, 124.0, 12.0, 52.0, 137.0, 92.0, -75.0, -3.0, 95.0, -16.0, -67.0, 13.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [126.0, 188.0, 125.0, 199.0, -140.0, -81.0, 48.0, 12.0, 41.0, 56.0, -144.0, 39.0, -166.0, -178.0, 138.0, 0.0, -50.0, 46.0, -291.0, 7.0, 37.0, -24.0, 0.0, 2.0, 0.0, -190.0, -128.0, 72.0, 23.0, -119.0, 109.0, -201.0, -210.0, -210.0, 13.0, -107.0, -90.0, -141.0, 7.0, 55.0, -133.0, -99.0, -27.0, -289.0, -371.0, -164.0, 49.0, 74.0, -228.0, -104.0, -241.0, -11.0, -78.0, -54.0, -29.0, -57.0, -47.0, -234.0, 64.0, 21.0, -7.0, -121.0, -43.0, -130.0, -79.0, -96.0, 22.0, -86.0, -23.0, -92.0, -191.0, -2.0, -40.0, -182.0, -150.0, 39.0, 18.0, -88.0, 79.0, -4.0, 183.0, 157.0, -149.0, -66.0, -1.0, 0.0, -130.0, -40.0, 48.0, 0.0, -18.0, 17.0, -68.0, -257.0, -165.0, -32.0, -44.0, -46.0, -190.0, 142.0, -38.0, -102.0, 7.0, -119.0, 47.0, 106.0, -18.0, -61.0, -170.0, -122.0, -113.0, 46.0, 48.0, -57.0, -10.0, -73.0, -143.0, -83.0, 0.0, 73.0, 14.0, -197.0, 66.0, 61.0, 41.0, -15.0, 44.0, 37.0, 134.0, 122.0, -153.0, 136.0, 0.0, -90.0, -63.0, 0.0, -102.0, -8.0, 8.0, -28.0, 53.0, 14.0, 108.0, 30.0, -22.0, -40.0, 1.0, 29.0, -41.0, -47.0, -142.0, -98.0, 67.0, -39.0, 50.0, 17.0, 7.0, 30.0, -22.0, -100.0, -140.0, -74.0, -30.0, 113.0, 120.0, -6.0, 0.0, -112.0, 0.0, 7.0, 0.0, 17.0, -21.0, -42.0, 12.0, -4.0, 22.0, -38.0, 104.0, 0.0, -13.0, -6.0, 0.0, 12.0, 68.0, 38.0, -59.0, 75.0, -121.0, -128.0, -93.0, -97.0, 0.0, 70.0, -184.0, -32.0, -46.0, -96.0, -110.0, -69.0], "policy_predator_policy_reward": [0.0, 14.0, 0.0, 0.0, 63.0, 87.0, 0.0, 0.0, 43.0, 0.0, 97.0, 101.0, 66.0, 152.0, 2.0, 2.0, 39.0, 38.0, 166.0, 37.0, 82.0, 59.0, 0.0, 0.0, 128.0, 3.0, 50.0, 46.0, 58.0, 32.0, 83.0, 75.0, 165.0, 99.0, 27.0, 67.0, 48.0, 99.0, 23.0, 46.0, 82.0, 122.0, 99.0, 120.0, 185.0, 159.0, 0.0, 32.0, 90.0, 88.0, 131.0, 81.0, 42.0, 0.0, 51.0, 38.0, 28.0, 163.0, 61.0, 13.0, 107.0, 8.0, 99.0, 23.0, 100.0, 76.0, 31.0, 106.0, 43.0, 77.0, 79.0, 51.0, 56.0, 120.0, 108.0, 39.0, 43.0, 55.0, 16.0, 65.0, 0.0, 2.0, 137.0, 36.0, 38.0, 6.0, 88.0, 77.0, 0.0, 28.0, 8.0, 16.0, 151.0, 51.0, 61.0, 67.0, 81.0, 66.0, 95.0, 0.0, 32.0, 33.0, 78.0, 37.0, 0.0, 46.0, 73.0, 20.0, 102.0, 109.0, 42.0, 65.0, 22.0, 55.0, 72.0, 23.0, 57.0, 78.0, 0.0, 0.0, 77.0, 99.0, 35.0, 42.0, 30.0, 0.0, 0.0, 2.0, 1.0, 5.0, 80.0, 67.0, 30.0, 44.0, 79.0, 6.0, 22.0, 56.0, 57.0, 6.0, 24.0, 14.0, 0.0, 1.0, 40.0, 20.0, 5.0, 3.0, 65.0, 47.0, 45.0, 97.0, 41.0, 32.0, 3.0, 6.0, 20.0, 44.0, 35.0, 99.0, 100.0, 74.0, 1.0, 36.0, 12.0, 20.0, 47.0, 15.0, 37.0, 20.0, 0.0, 0.0, 57.0, 27.0, 2.0, 2.0, 55.0, 39.0, 3.0, 17.0, 21.0, 10.0, 8.0, 32.0, 31.0, 0.0, 52.0, 24.0, 106.0, 68.0, 96.0, 91.0, 16.0, 9.0, 114.0, 86.0, 38.0, 37.0, 97.0, 95.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.209327598536175, "mean_inference_ms": 3.021684299279327, "mean_action_processing_ms": 0.4862230402668725, "mean_env_wait_ms": 0.4150017759913132, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03178548812866211, "StateBufferConnector_ms": 0.003643035888671875, "ViewRequirementAgentConnector_ms": 0.2513589859008789}, "num_episodes": 18, "episode_return_max": 342.0, "episode_return_min": -191.0, "episode_return_mean": 32.07, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 186.60989936920726, "num_env_steps_trained_throughput_per_sec": 186.60989936920726, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 20392.148, "restore_workers_time_ms": 0.047, "training_step_time_ms": 20392.008, "sample_time_ms": 2712.219, "learn_time_ms": 17654.952, "learn_throughput": 226.565, "synch_weights_time_ms": 19.595}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "f6b99_00000", "date": "2024-08-13_19-47-15", "timestamp": 1723592835, "time_this_iter_s": 21.54067301750183, "time_total_s": 143.2878692150116, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b324b3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 143.2878692150116, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 82.19642857142857, "ram_util_percent": 84.14285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6442594159847845, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.025168147793522, "policy_loss": -0.008419355235023119, "vf_loss": 5.031860043384411, "vf_explained_var": -0.0069088012453109495, "kl": 0.00863721412125997, "entropy": 1.5177183354342425, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6913265407716156, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.4201155170561774, "policy_loss": -0.009164059730295939, "vf_loss": 6.428029847271228, "vf_explained_var": -0.011320904039201283, "kl": 0.01249736099675047, "entropy": 1.544058681354321, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 342.0, "episode_reward_min": -193.0, "episode_reward_mean": 17.14, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -371.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 183.0, "predator_policy": 185.0}, "policy_reward_mean": {"prey_policy": -40.655, "predator_policy": 49.225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-84.0, 131.0, -28.0, -97.0, -191.0, 155.0, -154.0, -40.0, -90.0, 3.0, -90.0, 159.0, -13.0, -51.0, 1.0, 73.0, 5.0, -63.0, -46.0, 36.0, 28.0, 156.0, 342.0, -42.0, 43.0, -5.0, 76.0, 23.0, -123.0, -69.0, 57.0, 47.0, -75.0, 3.0, 199.0, 14.0, -81.0, 40.0, 68.0, 12.0, -91.0, 73.0, -7.0, 204.0, 56.0, 83.0, 262.0, 130.0, -16.0, 22.0, -32.0, 43.0, 105.0, 139.0, -2.0, 38.0, 24.0, -98.0, 101.0, 76.0, 101.0, 12.0, -40.0, 120.0, 146.0, -50.0, 64.0, 17.0, 21.0, 12.0, 78.0, 124.0, 12.0, 52.0, 137.0, 92.0, -75.0, -3.0, 95.0, -16.0, -67.0, 13.0, 96.0, -108.0, -114.0, -10.0, 2.0, -100.0, 3.0, -53.0, -12.0, -193.0, -40.0, 63.0, 69.0, -82.0, 26.0, -149.0, 104.0, -72.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-90.0, -141.0, 7.0, 55.0, -133.0, -99.0, -27.0, -289.0, -371.0, -164.0, 49.0, 74.0, -228.0, -104.0, -241.0, -11.0, -78.0, -54.0, -29.0, -57.0, -47.0, -234.0, 64.0, 21.0, -7.0, -121.0, -43.0, -130.0, -79.0, -96.0, 22.0, -86.0, -23.0, -92.0, -191.0, -2.0, -40.0, -182.0, -150.0, 39.0, 18.0, -88.0, 79.0, -4.0, 183.0, 157.0, -149.0, -66.0, -1.0, 0.0, -130.0, -40.0, 48.0, 0.0, -18.0, 17.0, -68.0, -257.0, -165.0, -32.0, -44.0, -46.0, -190.0, 142.0, -38.0, -102.0, 7.0, -119.0, 47.0, 106.0, -18.0, -61.0, -170.0, -122.0, -113.0, 46.0, 48.0, -57.0, -10.0, -73.0, -143.0, -83.0, 0.0, 73.0, 14.0, -197.0, 66.0, 61.0, 41.0, -15.0, 44.0, 37.0, 134.0, 122.0, -153.0, 136.0, 0.0, -90.0, -63.0, 0.0, -102.0, -8.0, 8.0, -28.0, 53.0, 14.0, 108.0, 30.0, -22.0, -40.0, 1.0, 29.0, -41.0, -47.0, -142.0, -98.0, 67.0, -39.0, 50.0, 17.0, 7.0, 30.0, -22.0, -100.0, -140.0, -74.0, -30.0, 113.0, 120.0, -6.0, 0.0, -112.0, 0.0, 7.0, 0.0, 17.0, -21.0, -42.0, 12.0, -4.0, 22.0, -38.0, 104.0, 0.0, -13.0, -6.0, 0.0, 12.0, 68.0, 38.0, -59.0, 75.0, -121.0, -128.0, -93.0, -97.0, 0.0, 70.0, -184.0, -32.0, -46.0, -96.0, -110.0, -69.0, 55.0, 0.0, -31.0, -216.0, -274.0, -98.0, 0.0, -46.0, -32.0, 0.0, -119.0, -138.0, -40.0, -51.0, -95.0, -53.0, -49.0, -2.0, -153.0, -163.0, -251.0, -8.0, 3.0, 47.0, -55.0, 25.0, -54.0, -153.0, 16.0, 0.0, -298.0, 0.0, 0.0, 28.0, 0.0, -181.0], "policy_predator_policy_reward": [48.0, 99.0, 23.0, 46.0, 82.0, 122.0, 99.0, 120.0, 185.0, 159.0, 0.0, 32.0, 90.0, 88.0, 131.0, 81.0, 42.0, 0.0, 51.0, 38.0, 28.0, 163.0, 61.0, 13.0, 107.0, 8.0, 99.0, 23.0, 100.0, 76.0, 31.0, 106.0, 43.0, 77.0, 79.0, 51.0, 56.0, 120.0, 108.0, 39.0, 43.0, 55.0, 16.0, 65.0, 0.0, 2.0, 137.0, 36.0, 38.0, 6.0, 88.0, 77.0, 0.0, 28.0, 8.0, 16.0, 151.0, 51.0, 61.0, 67.0, 81.0, 66.0, 95.0, 0.0, 32.0, 33.0, 78.0, 37.0, 0.0, 46.0, 73.0, 20.0, 102.0, 109.0, 42.0, 65.0, 22.0, 55.0, 72.0, 23.0, 57.0, 78.0, 0.0, 0.0, 77.0, 99.0, 35.0, 42.0, 30.0, 0.0, 0.0, 2.0, 1.0, 5.0, 80.0, 67.0, 30.0, 44.0, 79.0, 6.0, 22.0, 56.0, 57.0, 6.0, 24.0, 14.0, 0.0, 1.0, 40.0, 20.0, 5.0, 3.0, 65.0, 47.0, 45.0, 97.0, 41.0, 32.0, 3.0, 6.0, 20.0, 44.0, 35.0, 99.0, 100.0, 74.0, 1.0, 36.0, 12.0, 20.0, 47.0, 15.0, 37.0, 20.0, 0.0, 0.0, 57.0, 27.0, 2.0, 2.0, 55.0, 39.0, 3.0, 17.0, 21.0, 10.0, 8.0, 32.0, 31.0, 0.0, 52.0, 24.0, 106.0, 68.0, 96.0, 91.0, 16.0, 9.0, 114.0, 86.0, 38.0, 37.0, 97.0, 95.0, 16.0, 25.0, 92.0, 47.0, 150.0, 108.0, 36.0, 0.0, 34.0, 0.0, 72.0, 85.0, 23.0, 71.0, 14.0, 81.0, 39.0, 0.0, 117.0, 6.0, 150.0, 69.0, 12.0, 1.0, 12.0, 87.0, 30.0, 95.0, 6.0, 4.0, 0.0, 149.0, 50.0, 26.0, 109.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5013610803176938, "mean_inference_ms": 3.4930496106731477, "mean_action_processing_ms": 0.6795757391728446, "mean_env_wait_ms": 0.5345649233939842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04035520553588867, "StateBufferConnector_ms": 0.005809903144836426, "ViewRequirementAgentConnector_ms": 0.44282209873199463}, "num_episodes": 18, "episode_return_max": 342.0, "episode_return_min": -193.0, "episode_return_mean": 17.14, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 71.80745714072995, "num_env_steps_trained_throughput_per_sec": 71.80745714072995, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 24806.213, "restore_workers_time_ms": 0.06, "training_step_time_ms": 24806.04, "sample_time_ms": 5224.494, "learn_time_ms": 19541.751, "learn_throughput": 204.69, "synch_weights_time_ms": 31.982}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "f6b99_00000", "date": "2024-08-13_19-48-12", "timestamp": 1723592892, "time_this_iter_s": 56.03039216995239, "time_total_s": 199.318261384964, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6024f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 199.318261384964, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 96.83692307692309, "ram_util_percent": 84.32615384615384}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3632452541715885, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8642921167706685, "policy_loss": -0.00727489776404269, "vf_loss": 3.8696150347038554, "vf_explained_var": 0.0003716542922630512, "kl": 0.009759805751081568, "entropy": 1.4732416325776034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3993409415716846, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.559010747500828, "policy_loss": -0.010439156943059984, "vf_loss": 3.568147034052188, "vf_explained_var": -0.06482985839641914, "kl": 0.013028684470771682, "entropy": 1.5442667536634618, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 342.0, "episode_reward_min": -197.0, "episode_reward_mean": 16.55, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -298.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 183.0, "predator_policy": 151.0}, "policy_reward_mean": {"prey_policy": -33.535, "predator_policy": 41.81}, "custom_metrics": {}, "hist_stats": {"episode_reward": [342.0, -42.0, 43.0, -5.0, 76.0, 23.0, -123.0, -69.0, 57.0, 47.0, -75.0, 3.0, 199.0, 14.0, -81.0, 40.0, 68.0, 12.0, -91.0, 73.0, -7.0, 204.0, 56.0, 83.0, 262.0, 130.0, -16.0, 22.0, -32.0, 43.0, 105.0, 139.0, -2.0, 38.0, 24.0, -98.0, 101.0, 76.0, 101.0, 12.0, -40.0, 120.0, 146.0, -50.0, 64.0, 17.0, 21.0, 12.0, 78.0, 124.0, 12.0, 52.0, 137.0, 92.0, -75.0, -3.0, 95.0, -16.0, -67.0, 13.0, 96.0, -108.0, -114.0, -10.0, 2.0, -100.0, 3.0, -53.0, -12.0, -193.0, -40.0, 63.0, 69.0, -82.0, 26.0, -149.0, 104.0, -72.0, -197.0, 49.0, -113.0, 93.0, 31.0, 18.0, -163.0, 11.0, -20.0, 50.0, -49.0, -44.0, 150.0, -14.0, -22.0, -41.0, 22.0, 0.0, 130.0, -83.0, -67.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [183.0, 157.0, -149.0, -66.0, -1.0, 0.0, -130.0, -40.0, 48.0, 0.0, -18.0, 17.0, -68.0, -257.0, -165.0, -32.0, -44.0, -46.0, -190.0, 142.0, -38.0, -102.0, 7.0, -119.0, 47.0, 106.0, -18.0, -61.0, -170.0, -122.0, -113.0, 46.0, 48.0, -57.0, -10.0, -73.0, -143.0, -83.0, 0.0, 73.0, 14.0, -197.0, 66.0, 61.0, 41.0, -15.0, 44.0, 37.0, 134.0, 122.0, -153.0, 136.0, 0.0, -90.0, -63.0, 0.0, -102.0, -8.0, 8.0, -28.0, 53.0, 14.0, 108.0, 30.0, -22.0, -40.0, 1.0, 29.0, -41.0, -47.0, -142.0, -98.0, 67.0, -39.0, 50.0, 17.0, 7.0, 30.0, -22.0, -100.0, -140.0, -74.0, -30.0, 113.0, 120.0, -6.0, 0.0, -112.0, 0.0, 7.0, 0.0, 17.0, -21.0, -42.0, 12.0, -4.0, 22.0, -38.0, 104.0, 0.0, -13.0, -6.0, 0.0, 12.0, 68.0, 38.0, -59.0, 75.0, -121.0, -128.0, -93.0, -97.0, 0.0, 70.0, -184.0, -32.0, -46.0, -96.0, -110.0, -69.0, 55.0, 0.0, -31.0, -216.0, -274.0, -98.0, 0.0, -46.0, -32.0, 0.0, -119.0, -138.0, -40.0, -51.0, -95.0, -53.0, -49.0, -2.0, -153.0, -163.0, -251.0, -8.0, 3.0, 47.0, -55.0, 25.0, -54.0, -153.0, 16.0, 0.0, -298.0, 0.0, 0.0, 28.0, 0.0, -181.0, -210.0, -108.0, -9.0, 44.0, -173.0, -68.0, 14.0, 46.0, -7.0, 28.0, 16.0, -39.0, -149.0, -244.0, 11.0, 0.0, -86.0, -36.0, 36.0, 0.0, -73.0, -141.0, -145.0, 0.0, 89.0, 30.0, -110.0, 0.0, -2.0, -52.0, -139.0, 0.0, -86.0, 0.0, 0.0, 0.0, -56.0, 102.0, -148.0, -84.0, -126.0, -4.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 2.0, 137.0, 36.0, 38.0, 6.0, 88.0, 77.0, 0.0, 28.0, 8.0, 16.0, 151.0, 51.0, 61.0, 67.0, 81.0, 66.0, 95.0, 0.0, 32.0, 33.0, 78.0, 37.0, 0.0, 46.0, 73.0, 20.0, 102.0, 109.0, 42.0, 65.0, 22.0, 55.0, 72.0, 23.0, 57.0, 78.0, 0.0, 0.0, 77.0, 99.0, 35.0, 42.0, 30.0, 0.0, 0.0, 2.0, 1.0, 5.0, 80.0, 67.0, 30.0, 44.0, 79.0, 6.0, 22.0, 56.0, 57.0, 6.0, 24.0, 14.0, 0.0, 1.0, 40.0, 20.0, 5.0, 3.0, 65.0, 47.0, 45.0, 97.0, 41.0, 32.0, 3.0, 6.0, 20.0, 44.0, 35.0, 99.0, 100.0, 74.0, 1.0, 36.0, 12.0, 20.0, 47.0, 15.0, 37.0, 20.0, 0.0, 0.0, 57.0, 27.0, 2.0, 2.0, 55.0, 39.0, 3.0, 17.0, 21.0, 10.0, 8.0, 32.0, 31.0, 0.0, 52.0, 24.0, 106.0, 68.0, 96.0, 91.0, 16.0, 9.0, 114.0, 86.0, 38.0, 37.0, 97.0, 95.0, 16.0, 25.0, 92.0, 47.0, 150.0, 108.0, 36.0, 0.0, 34.0, 0.0, 72.0, 85.0, 23.0, 71.0, 14.0, 81.0, 39.0, 0.0, 117.0, 6.0, 150.0, 69.0, 12.0, 1.0, 12.0, 87.0, 30.0, 95.0, 6.0, 4.0, 0.0, 149.0, 50.0, 26.0, 109.0, 0.0, 0.0, 121.0, 0.0, 14.0, 40.0, 88.0, 19.0, 14.0, 6.0, 4.0, 12.0, 29.0, 139.0, 91.0, 0.0, 0.0, 35.0, 67.0, 10.0, 4.0, 88.0, 77.0, 40.0, 61.0, 10.0, 21.0, 45.0, 51.0, 8.0, 24.0, 35.0, 63.0, 32.0, 76.0, 0.0, 0.0, 44.0, 40.0, 78.0, 71.0, 63.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.894901511563217, "mean_inference_ms": 4.262283183759835, "mean_action_processing_ms": 0.9074822357893075, "mean_env_wait_ms": 0.6851573693684321, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026340842247009277, "StateBufferConnector_ms": 0.006978392601013184, "ViewRequirementAgentConnector_ms": 0.43765759468078613}, "num_episodes": 22, "episode_return_max": 342.0, "episode_return_min": -197.0, "episode_return_mean": 16.55, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.25467391518676, "num_env_steps_trained_throughput_per_sec": 105.25467391518676, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 26272.534, "restore_workers_time_ms": 0.059, "training_step_time_ms": 26272.366, "sample_time_ms": 5602.592, "learn_time_ms": 20622.518, "learn_throughput": 193.963, "synch_weights_time_ms": 39.373}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 9, "trial_id": "f6b99_00000", "date": "2024-08-13_19-48-51", "timestamp": 1723592931, "time_this_iter_s": 38.89671230316162, "time_total_s": 238.2149736881256, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b328e4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 238.2149736881256, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 93.04599999999999, "ram_util_percent": 84.16400000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2791219072524833, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5641384094165116, "policy_loss": -0.0060655149171700475, "vf_loss": 1.5687719216737797, "vf_explained_var": 0.006548418254448623, "kl": 0.007159997840912093, "entropy": 1.4397117045821337, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0403657267491022, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4886201677183626, "policy_loss": -0.010210746757084967, "vf_loss": 1.4977392642113267, "vf_explained_var": -0.017220345092198205, "kl": 0.010916519181959194, "entropy": 1.5332648371262525, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 262.0, "episode_reward_min": -197.0, "episode_reward_mean": 7.9, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -298.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 136.0, "predator_policy": 150.0}, "policy_reward_mean": {"prey_policy": -29.165, "predator_policy": 33.115}, "custom_metrics": {}, "hist_stats": {"episode_reward": [83.0, 262.0, 130.0, -16.0, 22.0, -32.0, 43.0, 105.0, 139.0, -2.0, 38.0, 24.0, -98.0, 101.0, 76.0, 101.0, 12.0, -40.0, 120.0, 146.0, -50.0, 64.0, 17.0, 21.0, 12.0, 78.0, 124.0, 12.0, 52.0, 137.0, 92.0, -75.0, -3.0, 95.0, -16.0, -67.0, 13.0, 96.0, -108.0, -114.0, -10.0, 2.0, -100.0, 3.0, -53.0, -12.0, -193.0, -40.0, 63.0, 69.0, -82.0, 26.0, -149.0, 104.0, -72.0, -197.0, 49.0, -113.0, 93.0, 31.0, 18.0, -163.0, 11.0, -20.0, 50.0, -49.0, -44.0, 150.0, -14.0, -22.0, -41.0, 22.0, 0.0, 130.0, -83.0, -67.0, 0.0, 6.0, -3.0, -70.0, -3.0, -9.0, -3.0, -2.0, -2.0, 34.0, 0.0, -34.0, -33.0, 0.0, -6.0, 6.0, 6.0, -4.0, 10.0, 0.0, -28.0, 38.0, 11.0, -15.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [44.0, 37.0, 134.0, 122.0, -153.0, 136.0, 0.0, -90.0, -63.0, 0.0, -102.0, -8.0, 8.0, -28.0, 53.0, 14.0, 108.0, 30.0, -22.0, -40.0, 1.0, 29.0, -41.0, -47.0, -142.0, -98.0, 67.0, -39.0, 50.0, 17.0, 7.0, 30.0, -22.0, -100.0, -140.0, -74.0, -30.0, 113.0, 120.0, -6.0, 0.0, -112.0, 0.0, 7.0, 0.0, 17.0, -21.0, -42.0, 12.0, -4.0, 22.0, -38.0, 104.0, 0.0, -13.0, -6.0, 0.0, 12.0, 68.0, 38.0, -59.0, 75.0, -121.0, -128.0, -93.0, -97.0, 0.0, 70.0, -184.0, -32.0, -46.0, -96.0, -110.0, -69.0, 55.0, 0.0, -31.0, -216.0, -274.0, -98.0, 0.0, -46.0, -32.0, 0.0, -119.0, -138.0, -40.0, -51.0, -95.0, -53.0, -49.0, -2.0, -153.0, -163.0, -251.0, -8.0, 3.0, 47.0, -55.0, 25.0, -54.0, -153.0, 16.0, 0.0, -298.0, 0.0, 0.0, 28.0, 0.0, -181.0, -210.0, -108.0, -9.0, 44.0, -173.0, -68.0, 14.0, 46.0, -7.0, 28.0, 16.0, -39.0, -149.0, -244.0, 11.0, 0.0, -86.0, -36.0, 36.0, 0.0, -73.0, -141.0, -145.0, 0.0, 89.0, 30.0, -110.0, 0.0, -2.0, -52.0, -139.0, 0.0, -86.0, 0.0, 0.0, 0.0, -56.0, 102.0, -148.0, -84.0, -126.0, -4.0, 0.0, 0.0, 0.0, -15.0, -62.0, -1.0, -68.0, -72.0, -8.0, 0.0, -10.0, -8.0, -14.0, 0.0, 0.0, -4.0, 22.0, -68.0, 30.0, 0.0, 0.0, 0.0, -10.0, -58.0, 0.0, -127.0, 0.0, 0.0, -12.0, 0.0, 15.0, -18.0, -21.0, -4.0, 0.0, -8.0, 9.0, -6.0, 0.0, 0.0, 0.0, -94.0, 0.0, 38.0, 6.0, 5.0, 0.0, -34.0], "policy_predator_policy_reward": [0.0, 2.0, 1.0, 5.0, 80.0, 67.0, 30.0, 44.0, 79.0, 6.0, 22.0, 56.0, 57.0, 6.0, 24.0, 14.0, 0.0, 1.0, 40.0, 20.0, 5.0, 3.0, 65.0, 47.0, 45.0, 97.0, 41.0, 32.0, 3.0, 6.0, 20.0, 44.0, 35.0, 99.0, 100.0, 74.0, 1.0, 36.0, 12.0, 20.0, 47.0, 15.0, 37.0, 20.0, 0.0, 0.0, 57.0, 27.0, 2.0, 2.0, 55.0, 39.0, 3.0, 17.0, 21.0, 10.0, 8.0, 32.0, 31.0, 0.0, 52.0, 24.0, 106.0, 68.0, 96.0, 91.0, 16.0, 9.0, 114.0, 86.0, 38.0, 37.0, 97.0, 95.0, 16.0, 25.0, 92.0, 47.0, 150.0, 108.0, 36.0, 0.0, 34.0, 0.0, 72.0, 85.0, 23.0, 71.0, 14.0, 81.0, 39.0, 0.0, 117.0, 6.0, 150.0, 69.0, 12.0, 1.0, 12.0, 87.0, 30.0, 95.0, 6.0, 4.0, 0.0, 149.0, 50.0, 26.0, 109.0, 0.0, 0.0, 121.0, 0.0, 14.0, 40.0, 88.0, 19.0, 14.0, 6.0, 4.0, 12.0, 29.0, 139.0, 91.0, 0.0, 0.0, 35.0, 67.0, 10.0, 4.0, 88.0, 77.0, 40.0, 61.0, 10.0, 21.0, 45.0, 51.0, 8.0, 24.0, 35.0, 63.0, 32.0, 76.0, 0.0, 0.0, 44.0, 40.0, 78.0, 71.0, 63.0, 0.0, 0.0, 0.0, 0.0, 21.0, 32.0, 28.0, 37.0, 33.0, 5.0, 0.0, 9.0, 0.0, 7.0, 4.0, 0.0, 2.0, 34.0, 10.0, 4.0, 0.0, 0.0, 0.0, 29.0, 5.0, 37.0, 57.0, 0.0, 0.0, 6.0, 0.0, 0.0, 9.0, 0.0, 31.0, 4.0, 0.0, 3.0, 4.0, 0.0, 0.0, 20.0, 46.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2827616546831013, "mean_inference_ms": 4.958682906833876, "mean_action_processing_ms": 1.1332480353663237, "mean_env_wait_ms": 0.8411056766778813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04119253158569336, "StateBufferConnector_ms": 0.0108184814453125, "ViewRequirementAgentConnector_ms": 0.5281705856323242}, "num_episodes": 23, "episode_return_max": 262.0, "episode_return_min": -197.0, "episode_return_mean": 7.9, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 168.0713505339395, "num_env_steps_trained_throughput_per_sec": 168.0713505339395, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 26025.226, "restore_workers_time_ms": 0.059, "training_step_time_ms": 26025.061, "sample_time_ms": 5392.591, "learn_time_ms": 20588.171, "learn_throughput": 194.286, "synch_weights_time_ms": 37.069}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 10, "trial_id": "f6b99_00000", "date": "2024-08-13_19-49-15", "timestamp": 1723592955, "time_this_iter_s": 23.852777004241943, "time_total_s": 262.06775069236755, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b324b040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 262.06775069236755, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 90.28857142857143, "ram_util_percent": 83.97142857142859}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9932882723511842, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6549751324943764, "policy_loss": -0.006678917914968989, "vf_loss": 0.6610233200329637, "vf_explained_var": 0.023984600059569827, "kl": 0.003153660689729529, "entropy": 1.453827886669724, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.803457891807039, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.747317798731346, "policy_loss": -0.0066894965551833, "vf_loss": 0.7528484662846914, "vf_explained_var": -0.0008504748975158369, "kl": 0.011588290692244629, "entropy": 1.4987798159084622, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 150.0, "episode_reward_min": -197.0, "episode_reward_mean": -3.37, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -298.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 120.0, "predator_policy": 150.0}, "policy_reward_mean": {"prey_policy": -30.465, "predator_policy": 28.78}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 146.0, -50.0, 64.0, 17.0, 21.0, 12.0, 78.0, 124.0, 12.0, 52.0, 137.0, 92.0, -75.0, -3.0, 95.0, -16.0, -67.0, 13.0, 96.0, -108.0, -114.0, -10.0, 2.0, -100.0, 3.0, -53.0, -12.0, -193.0, -40.0, 63.0, 69.0, -82.0, 26.0, -149.0, 104.0, -72.0, -197.0, 49.0, -113.0, 93.0, 31.0, 18.0, -163.0, 11.0, -20.0, 50.0, -49.0, -44.0, 150.0, -14.0, -22.0, -41.0, 22.0, 0.0, 130.0, -83.0, -67.0, 0.0, 6.0, -3.0, -70.0, -3.0, -9.0, -3.0, -2.0, -2.0, 34.0, 0.0, -34.0, -33.0, 0.0, -6.0, 6.0, 6.0, -4.0, 10.0, 0.0, -28.0, 38.0, 11.0, -15.0, -34.0, 24.0, -19.0, -32.0, -6.0, 30.0, -29.0, -14.0, 6.0, -6.0, -85.0, 0.0, 58.0, -20.0, -1.0, -61.0, 40.0, -30.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-30.0, 113.0, 120.0, -6.0, 0.0, -112.0, 0.0, 7.0, 0.0, 17.0, -21.0, -42.0, 12.0, -4.0, 22.0, -38.0, 104.0, 0.0, -13.0, -6.0, 0.0, 12.0, 68.0, 38.0, -59.0, 75.0, -121.0, -128.0, -93.0, -97.0, 0.0, 70.0, -184.0, -32.0, -46.0, -96.0, -110.0, -69.0, 55.0, 0.0, -31.0, -216.0, -274.0, -98.0, 0.0, -46.0, -32.0, 0.0, -119.0, -138.0, -40.0, -51.0, -95.0, -53.0, -49.0, -2.0, -153.0, -163.0, -251.0, -8.0, 3.0, 47.0, -55.0, 25.0, -54.0, -153.0, 16.0, 0.0, -298.0, 0.0, 0.0, 28.0, 0.0, -181.0, -210.0, -108.0, -9.0, 44.0, -173.0, -68.0, 14.0, 46.0, -7.0, 28.0, 16.0, -39.0, -149.0, -244.0, 11.0, 0.0, -86.0, -36.0, 36.0, 0.0, -73.0, -141.0, -145.0, 0.0, 89.0, 30.0, -110.0, 0.0, -2.0, -52.0, -139.0, 0.0, -86.0, 0.0, 0.0, 0.0, -56.0, 102.0, -148.0, -84.0, -126.0, -4.0, 0.0, 0.0, 0.0, -15.0, -62.0, -1.0, -68.0, -72.0, -8.0, 0.0, -10.0, -8.0, -14.0, 0.0, 0.0, -4.0, 22.0, -68.0, 30.0, 0.0, 0.0, 0.0, -10.0, -58.0, 0.0, -127.0, 0.0, 0.0, -12.0, 0.0, 15.0, -18.0, -21.0, -4.0, 0.0, -8.0, 9.0, -6.0, 0.0, 0.0, 0.0, -94.0, 0.0, 38.0, 6.0, 5.0, 0.0, -34.0, -1.0, -72.0, 0.0, 24.0, -6.0, -29.0, -33.0, -32.0, 0.0, -12.0, 9.0, 21.0, -18.0, -64.0, -25.0, -14.0, 0.0, 0.0, -4.0, -8.0, 17.0, -204.0, 0.0, 0.0, 2.0, 53.0, -40.0, 0.0, -2.0, 0.0, 0.0, -122.0, 0.0, 38.0, 0.0, -60.0], "policy_predator_policy_reward": [1.0, 36.0, 12.0, 20.0, 47.0, 15.0, 37.0, 20.0, 0.0, 0.0, 57.0, 27.0, 2.0, 2.0, 55.0, 39.0, 3.0, 17.0, 21.0, 10.0, 8.0, 32.0, 31.0, 0.0, 52.0, 24.0, 106.0, 68.0, 96.0, 91.0, 16.0, 9.0, 114.0, 86.0, 38.0, 37.0, 97.0, 95.0, 16.0, 25.0, 92.0, 47.0, 150.0, 108.0, 36.0, 0.0, 34.0, 0.0, 72.0, 85.0, 23.0, 71.0, 14.0, 81.0, 39.0, 0.0, 117.0, 6.0, 150.0, 69.0, 12.0, 1.0, 12.0, 87.0, 30.0, 95.0, 6.0, 4.0, 0.0, 149.0, 50.0, 26.0, 109.0, 0.0, 0.0, 121.0, 0.0, 14.0, 40.0, 88.0, 19.0, 14.0, 6.0, 4.0, 12.0, 29.0, 139.0, 91.0, 0.0, 0.0, 35.0, 67.0, 10.0, 4.0, 88.0, 77.0, 40.0, 61.0, 10.0, 21.0, 45.0, 51.0, 8.0, 24.0, 35.0, 63.0, 32.0, 76.0, 0.0, 0.0, 44.0, 40.0, 78.0, 71.0, 63.0, 0.0, 0.0, 0.0, 0.0, 21.0, 32.0, 28.0, 37.0, 33.0, 5.0, 0.0, 9.0, 0.0, 7.0, 4.0, 0.0, 2.0, 34.0, 10.0, 4.0, 0.0, 0.0, 0.0, 29.0, 5.0, 37.0, 57.0, 0.0, 0.0, 6.0, 0.0, 0.0, 9.0, 0.0, 31.0, 4.0, 0.0, 3.0, 4.0, 0.0, 0.0, 20.0, 46.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 37.0, 2.0, 0.0, 0.0, 16.0, 0.0, 16.0, 17.0, 0.0, 6.0, 0.0, 0.0, 34.0, 19.0, 22.0, 3.0, 0.0, 6.0, 4.0, 2.0, 102.0, 0.0, 0.0, 0.0, 3.0, 0.0, 15.0, 5.0, 1.0, 0.0, 61.0, 0.0, 0.0, 2.0, 30.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.554424847238679, "mean_inference_ms": 5.4856221110054575, "mean_action_processing_ms": 1.2889358622768379, "mean_env_wait_ms": 0.946900443700152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04114329814910889, "StateBufferConnector_ms": 0.016526222229003906, "ViewRequirementAgentConnector_ms": 0.5454859733581543}, "num_episodes": 18, "episode_return_max": 150.0, "episode_return_min": -197.0, "episode_return_mean": -3.37, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 183.09146698454933, "num_env_steps_trained_throughput_per_sec": 183.09146698454933, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 26368.41, "restore_workers_time_ms": 0.054, "training_step_time_ms": 26368.255, "sample_time_ms": 5562.434, "learn_time_ms": 20760.881, "learn_throughput": 192.67, "synch_weights_time_ms": 37.756}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 11, "trial_id": "f6b99_00000", "date": "2024-08-13_19-49-37", "timestamp": 1723592977, "time_this_iter_s": 21.890210151672363, "time_total_s": 283.9579608440399, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b602faf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 283.9579608440399, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 84.42903225806451, "ram_util_percent": 83.9774193548387}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1168367094069562, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3652798842658442, "policy_loss": -0.005956947566847755, "vf_loss": 0.37017830525224327, "vf_explained_var": 0.046808308016055476, "kl": 0.010585270525354655, "entropy": 1.4327121462140764, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8464355747929957, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.47880836322250103, "policy_loss": -0.006705096978620286, "vf_loss": 0.4850910262586598, "vf_explained_var": -0.013327246021341395, "kl": 0.004224318133809609, "entropy": 1.506652921848196, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 150.0, "episode_reward_min": -197.0, "episode_reward_mean": -11.07, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -298.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 102.0, "predator_policy": 150.0}, "policy_reward_mean": {"prey_policy": -28.69, "predator_policy": 23.155}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.0, 96.0, -108.0, -114.0, -10.0, 2.0, -100.0, 3.0, -53.0, -12.0, -193.0, -40.0, 63.0, 69.0, -82.0, 26.0, -149.0, 104.0, -72.0, -197.0, 49.0, -113.0, 93.0, 31.0, 18.0, -163.0, 11.0, -20.0, 50.0, -49.0, -44.0, 150.0, -14.0, -22.0, -41.0, 22.0, 0.0, 130.0, -83.0, -67.0, 0.0, 6.0, -3.0, -70.0, -3.0, -9.0, -3.0, -2.0, -2.0, 34.0, 0.0, -34.0, -33.0, 0.0, -6.0, 6.0, 6.0, -4.0, 10.0, 0.0, -28.0, 38.0, 11.0, -15.0, -34.0, 24.0, -19.0, -32.0, -6.0, 30.0, -29.0, -14.0, 6.0, -6.0, -85.0, 0.0, 58.0, -20.0, -1.0, -61.0, 40.0, -30.0, -7.0, 8.0, 5.0, -5.0, -4.0, 0.0, -17.0, 0.0, -1.0, 11.0, -2.0, 0.0, 3.0, -4.0, 0.0, 19.0, -1.0, -16.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-110.0, -69.0, 55.0, 0.0, -31.0, -216.0, -274.0, -98.0, 0.0, -46.0, -32.0, 0.0, -119.0, -138.0, -40.0, -51.0, -95.0, -53.0, -49.0, -2.0, -153.0, -163.0, -251.0, -8.0, 3.0, 47.0, -55.0, 25.0, -54.0, -153.0, 16.0, 0.0, -298.0, 0.0, 0.0, 28.0, 0.0, -181.0, -210.0, -108.0, -9.0, 44.0, -173.0, -68.0, 14.0, 46.0, -7.0, 28.0, 16.0, -39.0, -149.0, -244.0, 11.0, 0.0, -86.0, -36.0, 36.0, 0.0, -73.0, -141.0, -145.0, 0.0, 89.0, 30.0, -110.0, 0.0, -2.0, -52.0, -139.0, 0.0, -86.0, 0.0, 0.0, 0.0, -56.0, 102.0, -148.0, -84.0, -126.0, -4.0, 0.0, 0.0, 0.0, -15.0, -62.0, -1.0, -68.0, -72.0, -8.0, 0.0, -10.0, -8.0, -14.0, 0.0, 0.0, -4.0, 22.0, -68.0, 30.0, 0.0, 0.0, 0.0, -10.0, -58.0, 0.0, -127.0, 0.0, 0.0, -12.0, 0.0, 15.0, -18.0, -21.0, -4.0, 0.0, -8.0, 9.0, -6.0, 0.0, 0.0, 0.0, -94.0, 0.0, 38.0, 6.0, 5.0, 0.0, -34.0, -1.0, -72.0, 0.0, 24.0, -6.0, -29.0, -33.0, -32.0, 0.0, -12.0, 9.0, 21.0, -18.0, -64.0, -25.0, -14.0, 0.0, 0.0, -4.0, -8.0, 17.0, -204.0, 0.0, 0.0, 2.0, 53.0, -40.0, 0.0, -2.0, 0.0, 0.0, -122.0, 0.0, 38.0, 0.0, -60.0, 0.0, -16.0, 27.0, -38.0, 0.0, 5.0, 0.0, -10.0, 0.0, -8.0, 0.0, 0.0, 0.0, -34.0, -2.0, -22.0, 0.0, -2.0, 9.0, 0.0, -4.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, -8.0, 0.0, 0.0, 0.0, 19.0, 0.0, -2.0, -18.0, -14.0], "policy_predator_policy_reward": [97.0, 95.0, 16.0, 25.0, 92.0, 47.0, 150.0, 108.0, 36.0, 0.0, 34.0, 0.0, 72.0, 85.0, 23.0, 71.0, 14.0, 81.0, 39.0, 0.0, 117.0, 6.0, 150.0, 69.0, 12.0, 1.0, 12.0, 87.0, 30.0, 95.0, 6.0, 4.0, 0.0, 149.0, 50.0, 26.0, 109.0, 0.0, 0.0, 121.0, 0.0, 14.0, 40.0, 88.0, 19.0, 14.0, 6.0, 4.0, 12.0, 29.0, 139.0, 91.0, 0.0, 0.0, 35.0, 67.0, 10.0, 4.0, 88.0, 77.0, 40.0, 61.0, 10.0, 21.0, 45.0, 51.0, 8.0, 24.0, 35.0, 63.0, 32.0, 76.0, 0.0, 0.0, 44.0, 40.0, 78.0, 71.0, 63.0, 0.0, 0.0, 0.0, 0.0, 21.0, 32.0, 28.0, 37.0, 33.0, 5.0, 0.0, 9.0, 0.0, 7.0, 4.0, 0.0, 2.0, 34.0, 10.0, 4.0, 0.0, 0.0, 0.0, 29.0, 5.0, 37.0, 57.0, 0.0, 0.0, 6.0, 0.0, 0.0, 9.0, 0.0, 31.0, 4.0, 0.0, 3.0, 4.0, 0.0, 0.0, 20.0, 46.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 37.0, 2.0, 0.0, 0.0, 16.0, 0.0, 16.0, 17.0, 0.0, 6.0, 0.0, 0.0, 34.0, 19.0, 22.0, 3.0, 0.0, 6.0, 4.0, 2.0, 102.0, 0.0, 0.0, 0.0, 3.0, 0.0, 15.0, 5.0, 1.0, 0.0, 61.0, 0.0, 0.0, 2.0, 30.0, 0.0, 9.0, 0.0, 15.0, 4.0, 0.0, 0.0, 0.0, 5.0, 0.0, 4.0, 0.0, 0.0, 17.0, 0.0, 11.0, 13.0, 0.0, 1.0, 0.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 7.0, 9.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7853797822391004, "mean_inference_ms": 5.915803628877893, "mean_action_processing_ms": 1.4219556851047073, "mean_env_wait_ms": 1.0372406204898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.041085124015808105, "StateBufferConnector_ms": 0.01651310920715332, "ViewRequirementAgentConnector_ms": 0.48967957496643066}, "num_episodes": 18, "episode_return_max": 150.0, "episode_return_min": -197.0, "episode_return_mean": -11.07, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 199.17836805221532, "num_env_steps_trained_throughput_per_sec": 199.17836805221532, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 26608.802, "restore_workers_time_ms": 0.038, "training_step_time_ms": 26608.688, "sample_time_ms": 5497.34, "learn_time_ms": 21065.038, "learn_throughput": 189.888, "synch_weights_time_ms": 39.641}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 12, "trial_id": "f6b99_00000", "date": "2024-08-13_19-49-57", "timestamp": 1723592997, "time_this_iter_s": 20.15506887435913, "time_total_s": 304.11302971839905, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6047670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 304.11302971839905, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 82.87857142857142, "ram_util_percent": 83.88928571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8697042055546291, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3201564322072993, "policy_loss": -0.008902338626129287, "vf_loss": 0.32818489453038346, "vf_explained_var": 0.010759368018498496, "kl": 0.008738752760574961, "entropy": 1.4577321172391295, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6935096927972698, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.343459380981537, "policy_loss": -0.008727121312742826, "vf_loss": 0.3518906140170262, "vf_explained_var": -0.03256132479697939, "kl": 0.005917774919412985, "entropy": 1.4920299934331702, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 150.0, "episode_reward_min": -197.0, "episode_reward_mean": -6.76, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -244.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 102.0, "predator_policy": 139.0}, "policy_reward_mean": {"prey_policy": -17.945, "predator_policy": 14.565}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-72.0, -197.0, 49.0, -113.0, 93.0, 31.0, 18.0, -163.0, 11.0, -20.0, 50.0, -49.0, -44.0, 150.0, -14.0, -22.0, -41.0, 22.0, 0.0, 130.0, -83.0, -67.0, 0.0, 6.0, -3.0, -70.0, -3.0, -9.0, -3.0, -2.0, -2.0, 34.0, 0.0, -34.0, -33.0, 0.0, -6.0, 6.0, 6.0, -4.0, 10.0, 0.0, -28.0, 38.0, 11.0, -15.0, -34.0, 24.0, -19.0, -32.0, -6.0, 30.0, -29.0, -14.0, 6.0, -6.0, -85.0, 0.0, 58.0, -20.0, -1.0, -61.0, 40.0, -30.0, -7.0, 8.0, 5.0, -5.0, -4.0, 0.0, -17.0, 0.0, -1.0, 11.0, -2.0, 0.0, 3.0, -4.0, 0.0, 19.0, -1.0, -16.0, -3.0, 0.0, 0.0, 0.0, 8.0, -13.0, 12.0, 0.0, -3.0, 0.0, -48.0, 24.0, -8.0, 3.0, 0.0, -24.0, -2.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -181.0, -210.0, -108.0, -9.0, 44.0, -173.0, -68.0, 14.0, 46.0, -7.0, 28.0, 16.0, -39.0, -149.0, -244.0, 11.0, 0.0, -86.0, -36.0, 36.0, 0.0, -73.0, -141.0, -145.0, 0.0, 89.0, 30.0, -110.0, 0.0, -2.0, -52.0, -139.0, 0.0, -86.0, 0.0, 0.0, 0.0, -56.0, 102.0, -148.0, -84.0, -126.0, -4.0, 0.0, 0.0, 0.0, -15.0, -62.0, -1.0, -68.0, -72.0, -8.0, 0.0, -10.0, -8.0, -14.0, 0.0, 0.0, -4.0, 22.0, -68.0, 30.0, 0.0, 0.0, 0.0, -10.0, -58.0, 0.0, -127.0, 0.0, 0.0, -12.0, 0.0, 15.0, -18.0, -21.0, -4.0, 0.0, -8.0, 9.0, -6.0, 0.0, 0.0, 0.0, -94.0, 0.0, 38.0, 6.0, 5.0, 0.0, -34.0, -1.0, -72.0, 0.0, 24.0, -6.0, -29.0, -33.0, -32.0, 0.0, -12.0, 9.0, 21.0, -18.0, -64.0, -25.0, -14.0, 0.0, 0.0, -4.0, -8.0, 17.0, -204.0, 0.0, 0.0, 2.0, 53.0, -40.0, 0.0, -2.0, 0.0, 0.0, -122.0, 0.0, 38.0, 0.0, -60.0, 0.0, -16.0, 27.0, -38.0, 0.0, 5.0, 0.0, -10.0, 0.0, -8.0, 0.0, 0.0, 0.0, -34.0, -2.0, -22.0, 0.0, -2.0, 9.0, 0.0, -4.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, -8.0, 0.0, 0.0, 0.0, 19.0, 0.0, -2.0, -18.0, -14.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, -37.0, 0.0, -20.0, 18.0, -44.0, 7.0, 3.0, -7.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, -40.0, -37.0, 24.0, 0.0, -16.0, 0.0, -4.0, 0.0, 0.0, 0.0, -10.0, -38.0, 0.0, -4.0, 0.0, 0.0], "policy_predator_policy_reward": [109.0, 0.0, 0.0, 121.0, 0.0, 14.0, 40.0, 88.0, 19.0, 14.0, 6.0, 4.0, 12.0, 29.0, 139.0, 91.0, 0.0, 0.0, 35.0, 67.0, 10.0, 4.0, 88.0, 77.0, 40.0, 61.0, 10.0, 21.0, 45.0, 51.0, 8.0, 24.0, 35.0, 63.0, 32.0, 76.0, 0.0, 0.0, 44.0, 40.0, 78.0, 71.0, 63.0, 0.0, 0.0, 0.0, 0.0, 21.0, 32.0, 28.0, 37.0, 33.0, 5.0, 0.0, 9.0, 0.0, 7.0, 4.0, 0.0, 2.0, 34.0, 10.0, 4.0, 0.0, 0.0, 0.0, 29.0, 5.0, 37.0, 57.0, 0.0, 0.0, 6.0, 0.0, 0.0, 9.0, 0.0, 31.0, 4.0, 0.0, 3.0, 4.0, 0.0, 0.0, 20.0, 46.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 37.0, 2.0, 0.0, 0.0, 16.0, 0.0, 16.0, 17.0, 0.0, 6.0, 0.0, 0.0, 34.0, 19.0, 22.0, 3.0, 0.0, 6.0, 4.0, 2.0, 102.0, 0.0, 0.0, 0.0, 3.0, 0.0, 15.0, 5.0, 1.0, 0.0, 61.0, 0.0, 0.0, 2.0, 30.0, 0.0, 9.0, 0.0, 15.0, 4.0, 0.0, 0.0, 0.0, 5.0, 0.0, 4.0, 0.0, 0.0, 17.0, 0.0, 11.0, 13.0, 0.0, 1.0, 0.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 7.0, 9.0, 5.0, 2.0, 0.0, 0.0, 0.0, 0.0, 26.0, 11.0, 10.0, 0.0, 22.0, 2.0, 15.0, 1.0, 0.0, 0.0, 12.0, 5.0, 0.0, 0.0, 8.0, 21.0, 0.0, 0.0, 0.0, 8.0, 7.0, 0.0, 0.0, 0.0, 0.0, 24.0, 0.0, 2.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.754080764370846, "mean_inference_ms": 5.921538927657967, "mean_action_processing_ms": 1.367644578422728, "mean_env_wait_ms": 1.0121785870741677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03387606143951416, "StateBufferConnector_ms": 0.015153169631958008, "ViewRequirementAgentConnector_ms": 0.300939679145813}, "num_episodes": 18, "episode_return_max": 150.0, "episode_return_min": -197.0, "episode_return_mean": -6.76, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 186.47095452460215, "num_env_steps_trained_throughput_per_sec": 186.47095452460215, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 27113.489, "restore_workers_time_ms": 0.038, "training_step_time_ms": 27113.375, "sample_time_ms": 5580.743, "learn_time_ms": 21486.394, "learn_throughput": 186.164, "synch_weights_time_ms": 39.954}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 13, "trial_id": "f6b99_00000", "date": "2024-08-13_19-50-19", "timestamp": 1723593019, "time_this_iter_s": 21.52863097190857, "time_total_s": 325.6416606903076, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6047700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 325.6416606903076, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 84.4225806451613, "ram_util_percent": 83.6516129032258}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9714431703800247, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6069551583005007, "policy_loss": -0.008462851597538228, "vf_loss": 0.6145363828386599, "vf_explained_var": 0.012926887172870535, "kl": 0.008816255041265517, "entropy": 1.4219253278283215, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9354510649171456, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9426831392778291, "policy_loss": -0.006353954572622324, "vf_loss": 0.9485608501093729, "vf_explained_var": 0.015490790586622935, "kl": 0.009524866800902499, "entropy": 1.4786474601301567, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 112.0, "episode_reward_min": -86.0, "episode_reward_mean": -2.51, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -204.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 112.0, "predator_policy": 102.0}, "policy_reward_mean": {"prey_policy": -8.06, "predator_policy": 6.805}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.0, -3.0, -2.0, -2.0, 34.0, 0.0, -34.0, -33.0, 0.0, -6.0, 6.0, 6.0, -4.0, 10.0, 0.0, -28.0, 38.0, 11.0, -15.0, -34.0, 24.0, -19.0, -32.0, -6.0, 30.0, -29.0, -14.0, 6.0, -6.0, -85.0, 0.0, 58.0, -20.0, -1.0, -61.0, 40.0, -30.0, -7.0, 8.0, 5.0, -5.0, -4.0, 0.0, -17.0, 0.0, -1.0, 11.0, -2.0, 0.0, 3.0, -4.0, 0.0, 19.0, -1.0, -16.0, -3.0, 0.0, 0.0, 0.0, 8.0, -13.0, 12.0, 0.0, -3.0, 0.0, -48.0, 24.0, -8.0, 3.0, 0.0, -24.0, -2.0, 0.0, -8.0, 2.0, 0.0, -31.0, 0.0, 7.0, -3.0, 47.0, 0.0, 0.0, 0.0, 3.0, -15.0, 0.0, -16.0, 0.0, 112.0, -4.0, -4.0, -12.0, 14.0, 0.0, 0.0, -26.0, 0.0, 44.0, -86.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-10.0, -8.0, -14.0, 0.0, 0.0, -4.0, 22.0, -68.0, 30.0, 0.0, 0.0, 0.0, -10.0, -58.0, 0.0, -127.0, 0.0, 0.0, -12.0, 0.0, 15.0, -18.0, -21.0, -4.0, 0.0, -8.0, 9.0, -6.0, 0.0, 0.0, 0.0, -94.0, 0.0, 38.0, 6.0, 5.0, 0.0, -34.0, -1.0, -72.0, 0.0, 24.0, -6.0, -29.0, -33.0, -32.0, 0.0, -12.0, 9.0, 21.0, -18.0, -64.0, -25.0, -14.0, 0.0, 0.0, -4.0, -8.0, 17.0, -204.0, 0.0, 0.0, 2.0, 53.0, -40.0, 0.0, -2.0, 0.0, 0.0, -122.0, 0.0, 38.0, 0.0, -60.0, 0.0, -16.0, 27.0, -38.0, 0.0, 5.0, 0.0, -10.0, 0.0, -8.0, 0.0, 0.0, 0.0, -34.0, -2.0, -22.0, 0.0, -2.0, 9.0, 0.0, -4.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, -8.0, 0.0, 0.0, 0.0, 19.0, 0.0, -2.0, -18.0, -14.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, -37.0, 0.0, -20.0, 18.0, -44.0, 7.0, 3.0, -7.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, -40.0, -37.0, 24.0, 0.0, -16.0, 0.0, -4.0, 0.0, 0.0, 0.0, -10.0, -38.0, 0.0, -4.0, 0.0, 0.0, -6.0, -10.0, 2.0, 0.0, 0.0, 0.0, -58.0, -2.0, 0.0, 0.0, 0.0, 7.0, -14.0, -2.0, 47.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -31.0, 0.0, -56.0, 0.0, 0.0, -53.0, 2.0, 0.0, 0.0, 0.0, 112.0, -8.0, 0.0, -12.0, 0.0, -35.0, 0.0, -23.0, 0.0, 0.0, 0.0, 0.0, 0.0, -53.0, 0.0, 0.0, 0.0, -12.0, 50.0, -104.0, -50.0], "policy_predator_policy_reward": [9.0, 0.0, 7.0, 4.0, 0.0, 2.0, 34.0, 10.0, 4.0, 0.0, 0.0, 0.0, 29.0, 5.0, 37.0, 57.0, 0.0, 0.0, 6.0, 0.0, 0.0, 9.0, 0.0, 31.0, 4.0, 0.0, 3.0, 4.0, 0.0, 0.0, 20.0, 46.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 37.0, 2.0, 0.0, 0.0, 16.0, 0.0, 16.0, 17.0, 0.0, 6.0, 0.0, 0.0, 34.0, 19.0, 22.0, 3.0, 0.0, 6.0, 4.0, 2.0, 102.0, 0.0, 0.0, 0.0, 3.0, 0.0, 15.0, 5.0, 1.0, 0.0, 61.0, 0.0, 0.0, 2.0, 30.0, 0.0, 9.0, 0.0, 15.0, 4.0, 0.0, 0.0, 0.0, 5.0, 0.0, 4.0, 0.0, 0.0, 17.0, 0.0, 11.0, 13.0, 0.0, 1.0, 0.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 7.0, 9.0, 5.0, 2.0, 0.0, 0.0, 0.0, 0.0, 26.0, 11.0, 10.0, 0.0, 22.0, 2.0, 15.0, 1.0, 0.0, 0.0, 12.0, 5.0, 0.0, 0.0, 8.0, 21.0, 0.0, 0.0, 0.0, 8.0, 7.0, 0.0, 0.0, 0.0, 0.0, 24.0, 0.0, 2.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 0.0, 0.0, 29.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 26.0, 25.0, 16.0, 0.0, 0.0, 23.0, 12.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 8.0, 0.0, 21.0, 2.0, 19.0, 18.0, 0.0, 0.0, 0.0, 0.0, 13.0, 14.0, 0.0, 0.0, 0.0, 6.0, 58.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5772999957781457, "mean_inference_ms": 5.677961036317611, "mean_action_processing_ms": 1.3218438771158603, "mean_env_wait_ms": 0.9752491302111785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03261733055114746, "StateBufferConnector_ms": 0.013967633247375488, "ViewRequirementAgentConnector_ms": 0.2991940975189209}, "num_episodes": 27, "episode_return_max": 112.0, "episode_return_min": -86.0, "episode_return_mean": -2.51, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 205.00828160719732, "num_env_steps_trained_throughput_per_sec": 205.00828160719732, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 27416.657, "restore_workers_time_ms": 0.038, "training_step_time_ms": 27416.542, "sample_time_ms": 5647.986, "learn_time_ms": 21720.355, "learn_throughput": 184.159, "synch_weights_time_ms": 40.693}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 14, "trial_id": "f6b99_00000", "date": "2024-08-13_19-50-39", "timestamp": 1723593039, "time_this_iter_s": 19.567928075790405, "time_total_s": 345.209588766098, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b604fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 345.209588766098, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 83.475, "ram_util_percent": 83.90714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2030745542396313, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1581099281235347, "policy_loss": -0.007347025598335282, "vf_loss": 1.1646300333832937, "vf_explained_var": 0.003796298762477895, "kl": 0.00826915650661012, "entropy": 1.4659297027285136, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2409354312394663, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1891383510339197, "policy_loss": -0.006253918216110419, "vf_loss": 1.1949475815844914, "vf_explained_var": -0.03717312860110449, "kl": 0.008893734521828619, "entropy": 1.4539329103691867, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 112.0, "episode_reward_min": -86.0, "episode_reward_mean": -0.84, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -204.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 112.0, "predator_policy": 102.0}, "policy_reward_mean": {"prey_policy": -7.035, "predator_policy": 6.615}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.0, -34.0, 24.0, -19.0, -32.0, -6.0, 30.0, -29.0, -14.0, 6.0, -6.0, -85.0, 0.0, 58.0, -20.0, -1.0, -61.0, 40.0, -30.0, -7.0, 8.0, 5.0, -5.0, -4.0, 0.0, -17.0, 0.0, -1.0, 11.0, -2.0, 0.0, 3.0, -4.0, 0.0, 19.0, -1.0, -16.0, -3.0, 0.0, 0.0, 0.0, 8.0, -13.0, 12.0, 0.0, -3.0, 0.0, -48.0, 24.0, -8.0, 3.0, 0.0, -24.0, -2.0, 0.0, -8.0, 2.0, 0.0, -31.0, 0.0, 7.0, -3.0, 47.0, 0.0, 0.0, 0.0, 3.0, -15.0, 0.0, -16.0, 0.0, 112.0, -4.0, -4.0, -12.0, 14.0, 0.0, 0.0, -26.0, 0.0, 44.0, -86.0, 0.0, 12.0, 2.0, 109.0, -46.0, -21.0, -9.0, -14.0, 65.0, 26.0, 33.0, 32.0, 7.0, -18.0, 0.0, -8.0, -8.0, -11.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -34.0, -1.0, -72.0, 0.0, 24.0, -6.0, -29.0, -33.0, -32.0, 0.0, -12.0, 9.0, 21.0, -18.0, -64.0, -25.0, -14.0, 0.0, 0.0, -4.0, -8.0, 17.0, -204.0, 0.0, 0.0, 2.0, 53.0, -40.0, 0.0, -2.0, 0.0, 0.0, -122.0, 0.0, 38.0, 0.0, -60.0, 0.0, -16.0, 27.0, -38.0, 0.0, 5.0, 0.0, -10.0, 0.0, -8.0, 0.0, 0.0, 0.0, -34.0, -2.0, -22.0, 0.0, -2.0, 9.0, 0.0, -4.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, -8.0, 0.0, 0.0, 0.0, 19.0, 0.0, -2.0, -18.0, -14.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, -37.0, 0.0, -20.0, 18.0, -44.0, 7.0, 3.0, -7.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, -40.0, -37.0, 24.0, 0.0, -16.0, 0.0, -4.0, 0.0, 0.0, 0.0, -10.0, -38.0, 0.0, -4.0, 0.0, 0.0, -6.0, -10.0, 2.0, 0.0, 0.0, 0.0, -58.0, -2.0, 0.0, 0.0, 0.0, 7.0, -14.0, -2.0, 47.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -31.0, 0.0, -56.0, 0.0, 0.0, -53.0, 2.0, 0.0, 0.0, 0.0, 112.0, -8.0, 0.0, -12.0, 0.0, -35.0, 0.0, -23.0, 0.0, 0.0, 0.0, 0.0, 0.0, -53.0, 0.0, 0.0, 0.0, -12.0, 50.0, -104.0, -50.0, 0.0, 0.0, 8.0, 4.0, -18.0, -15.0, 0.0, 72.0, -34.0, -32.0, -2.0, -38.0, -18.0, 0.0, -18.0, -10.0, 0.0, 65.0, 0.0, -21.0, 45.0, -24.0, 15.0, 0.0, 31.0, -52.0, -32.0, -4.0, 0.0, 0.0, -16.0, 0.0, -16.0, 0.0, -16.0, -6.0], "policy_predator_policy_reward": [0.0, 19.0, 37.0, 2.0, 0.0, 0.0, 16.0, 0.0, 16.0, 17.0, 0.0, 6.0, 0.0, 0.0, 34.0, 19.0, 22.0, 3.0, 0.0, 6.0, 4.0, 2.0, 102.0, 0.0, 0.0, 0.0, 3.0, 0.0, 15.0, 5.0, 1.0, 0.0, 61.0, 0.0, 0.0, 2.0, 30.0, 0.0, 9.0, 0.0, 15.0, 4.0, 0.0, 0.0, 0.0, 5.0, 0.0, 4.0, 0.0, 0.0, 17.0, 0.0, 11.0, 13.0, 0.0, 1.0, 0.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 7.0, 9.0, 5.0, 2.0, 0.0, 0.0, 0.0, 0.0, 26.0, 11.0, 10.0, 0.0, 22.0, 2.0, 15.0, 1.0, 0.0, 0.0, 12.0, 5.0, 0.0, 0.0, 8.0, 21.0, 0.0, 0.0, 0.0, 8.0, 7.0, 0.0, 0.0, 0.0, 0.0, 24.0, 0.0, 2.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 0.0, 0.0, 29.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 26.0, 25.0, 16.0, 0.0, 0.0, 23.0, 12.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 8.0, 0.0, 21.0, 2.0, 19.0, 18.0, 0.0, 0.0, 0.0, 0.0, 13.0, 14.0, 0.0, 0.0, 0.0, 6.0, 58.0, 10.0, 0.0, 0.0, 0.0, 0.0, 26.0, 9.0, 17.0, 20.0, 11.0, 9.0, 0.0, 19.0, 0.0, 9.0, 9.0, 5.0, 0.0, 0.0, 5.0, 42.0, 12.0, 0.0, 2.0, 15.0, 27.0, 1.0, 3.0, 15.0, 0.0, 0.0, 0.0, 8.0, 8.0, 0.0, 3.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5135452032337042, "mean_inference_ms": 5.581053821686116, "mean_action_processing_ms": 1.2247145712539163, "mean_env_wait_ms": 0.9181493284841143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0061370134353637695, "StateBufferConnector_ms": 0.010236501693725586, "ViewRequirementAgentConnector_ms": 0.20921659469604492}, "num_episodes": 18, "episode_return_max": 112.0, "episode_return_min": -86.0, "episode_return_mean": -0.84, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 190.3725990987709, "num_env_steps_trained_throughput_per_sec": 190.3725990987709, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 26038.401, "restore_workers_time_ms": 0.038, "training_step_time_ms": 26038.294, "sample_time_ms": 5669.771, "learn_time_ms": 20319.544, "learn_throughput": 196.855, "synch_weights_time_ms": 41.465}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 15, "trial_id": "f6b99_00000", "date": "2024-08-13_19-51-00", "timestamp": 1723593060, "time_this_iter_s": 21.053044080734253, "time_total_s": 366.2626328468323, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b602fdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 366.2626328468323, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 82.99666666666667, "ram_util_percent": 83.69666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8835901620763319, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8687790876027768, "policy_loss": -0.011579702997570315, "vf_loss": 0.8792729451700493, "vf_explained_var": 0.0058410040285221485, "kl": 0.010858461980090639, "entropy": 1.4556051910238923, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9257012074586576, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0127261935955003, "policy_loss": -0.007181142959694462, "vf_loss": 1.0195559315107487, "vf_explained_var": -0.047479325059860474, "kl": 0.007028064950839231, "entropy": 1.4254636143881176, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 112.0, "episode_reward_min": -88.0, "episode_reward_mean": -1.11, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -221.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 112.0, "predator_policy": 131.0}, "policy_reward_mean": {"prey_policy": -7.78, "predator_policy": 7.225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.0, -7.0, 8.0, 5.0, -5.0, -4.0, 0.0, -17.0, 0.0, -1.0, 11.0, -2.0, 0.0, 3.0, -4.0, 0.0, 19.0, -1.0, -16.0, -3.0, 0.0, 0.0, 0.0, 8.0, -13.0, 12.0, 0.0, -3.0, 0.0, -48.0, 24.0, -8.0, 3.0, 0.0, -24.0, -2.0, 0.0, -8.0, 2.0, 0.0, -31.0, 0.0, 7.0, -3.0, 47.0, 0.0, 0.0, 0.0, 3.0, -15.0, 0.0, -16.0, 0.0, 112.0, -4.0, -4.0, -12.0, 14.0, 0.0, 0.0, -26.0, 0.0, 44.0, -86.0, 0.0, 12.0, 2.0, 109.0, -46.0, -21.0, -9.0, -14.0, 65.0, 26.0, 33.0, 32.0, 7.0, -18.0, 0.0, -8.0, -8.0, -11.0, -4.0, 0.0, -28.0, -10.0, 4.0, 0.0, -4.0, -88.0, 7.0, -1.0, -1.0, -5.0, 51.0, -3.0, 5.0, -16.0, -80.0, -18.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -60.0, 0.0, -16.0, 27.0, -38.0, 0.0, 5.0, 0.0, -10.0, 0.0, -8.0, 0.0, 0.0, 0.0, -34.0, -2.0, -22.0, 0.0, -2.0, 9.0, 0.0, -4.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, -8.0, 0.0, 0.0, 0.0, 19.0, 0.0, -2.0, -18.0, -14.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, -37.0, 0.0, -20.0, 18.0, -44.0, 7.0, 3.0, -7.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, -40.0, -37.0, 24.0, 0.0, -16.0, 0.0, -4.0, 0.0, 0.0, 0.0, -10.0, -38.0, 0.0, -4.0, 0.0, 0.0, -6.0, -10.0, 2.0, 0.0, 0.0, 0.0, -58.0, -2.0, 0.0, 0.0, 0.0, 7.0, -14.0, -2.0, 47.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -31.0, 0.0, -56.0, 0.0, 0.0, -53.0, 2.0, 0.0, 0.0, 0.0, 112.0, -8.0, 0.0, -12.0, 0.0, -35.0, 0.0, -23.0, 0.0, 0.0, 0.0, 0.0, 0.0, -53.0, 0.0, 0.0, 0.0, -12.0, 50.0, -104.0, -50.0, 0.0, 0.0, 8.0, 4.0, -18.0, -15.0, 0.0, 72.0, -34.0, -32.0, -2.0, -38.0, -18.0, 0.0, -18.0, -10.0, 0.0, 65.0, 0.0, -21.0, 45.0, -24.0, 15.0, 0.0, 31.0, -52.0, -32.0, -4.0, 0.0, 0.0, -16.0, 0.0, -16.0, 0.0, -16.0, -6.0, -14.0, 0.0, 0.0, 0.0, -22.0, -18.0, 0.0, -20.0, 8.0, -46.0, 0.0, 0.0, 0.0, -16.0, 0.0, -221.0, 7.0, 0.0, -12.0, -13.0, 0.0, -2.0, -16.0, -46.0, 68.0, -48.0, 0.0, -6.0, 5.0, 0.0, 0.0, -74.0, -206.0, 23.0, 0.0, -36.0], "policy_predator_policy_reward": [30.0, 0.0, 9.0, 0.0, 15.0, 4.0, 0.0, 0.0, 0.0, 5.0, 0.0, 4.0, 0.0, 0.0, 17.0, 0.0, 11.0, 13.0, 0.0, 1.0, 0.0, 2.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 7.0, 9.0, 5.0, 2.0, 0.0, 0.0, 0.0, 0.0, 26.0, 11.0, 10.0, 0.0, 22.0, 2.0, 15.0, 1.0, 0.0, 0.0, 12.0, 5.0, 0.0, 0.0, 8.0, 21.0, 0.0, 0.0, 0.0, 8.0, 7.0, 0.0, 0.0, 0.0, 0.0, 24.0, 0.0, 2.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 0.0, 0.0, 29.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 26.0, 25.0, 16.0, 0.0, 0.0, 23.0, 12.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 8.0, 0.0, 21.0, 2.0, 19.0, 18.0, 0.0, 0.0, 0.0, 0.0, 13.0, 14.0, 0.0, 0.0, 0.0, 6.0, 58.0, 10.0, 0.0, 0.0, 0.0, 0.0, 26.0, 9.0, 17.0, 20.0, 11.0, 9.0, 0.0, 19.0, 0.0, 9.0, 9.0, 5.0, 0.0, 0.0, 5.0, 42.0, 12.0, 0.0, 2.0, 15.0, 27.0, 1.0, 3.0, 15.0, 0.0, 0.0, 0.0, 8.0, 8.0, 0.0, 3.0, 8.0, 7.0, 3.0, 0.0, 0.0, 0.0, 12.0, 0.0, 10.0, 33.0, 9.0, 0.0, 0.0, 12.0, 0.0, 131.0, 2.0, 0.0, 0.0, 7.0, 17.0, 1.0, 0.0, 41.0, 16.0, 29.0, 2.0, 0.0, 3.0, 0.0, 0.0, 26.0, 32.0, 0.0, 103.0, 0.0, 18.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4254234939268717, "mean_inference_ms": 5.446746759827924, "mean_action_processing_ms": 1.176161634428649, "mean_env_wait_ms": 0.8845214788107518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006283879280090332, "StateBufferConnector_ms": 0.004421830177307129, "ViewRequirementAgentConnector_ms": 0.19562017917633057}, "num_episodes": 18, "episode_return_max": 112.0, "episode_return_min": -88.0, "episode_return_mean": -1.11, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 191.7712043646962, "num_env_steps_trained_throughput_per_sec": 191.7712043646962, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 26370.398, "restore_workers_time_ms": 0.038, "training_step_time_ms": 26370.291, "sample_time_ms": 5675.594, "learn_time_ms": 20646.397, "learn_throughput": 193.738, "synch_weights_time_ms": 41.202}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 16, "trial_id": "f6b99_00000", "date": "2024-08-13_19-51-21", "timestamp": 1723593081, "time_this_iter_s": 20.93280005455017, "time_total_s": 387.19543290138245, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b602f940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 387.19543290138245, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 77.96551724137935, "ram_util_percent": 83.61379310344829}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0734232665842802, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8233562972179796, "policy_loss": -0.008403580622974211, "vf_loss": 0.8302051884077845, "vf_explained_var": 0.008647397460130157, "kl": 0.015546890323513834, "entropy": 1.4396301589945637, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9008563684881049, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9518948421118751, "policy_loss": -0.0121021937599859, "vf_loss": 0.9635853349137559, "vf_explained_var": -0.12097937467867735, "kl": 0.008233993593763764, "entropy": 1.4202508337283262, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 112.0, "episode_reward_min": -88.0, "episode_reward_mean": -0.1, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -221.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 112.0, "predator_policy": 131.0}, "policy_reward_mean": {"prey_policy": -7.665, "predator_policy": 7.615}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.0, -3.0, 0.0, 0.0, 0.0, 8.0, -13.0, 12.0, 0.0, -3.0, 0.0, -48.0, 24.0, -8.0, 3.0, 0.0, -24.0, -2.0, 0.0, -8.0, 2.0, 0.0, -31.0, 0.0, 7.0, -3.0, 47.0, 0.0, 0.0, 0.0, 3.0, -15.0, 0.0, -16.0, 0.0, 112.0, -4.0, -4.0, -12.0, 14.0, 0.0, 0.0, -26.0, 0.0, 44.0, -86.0, 0.0, 12.0, 2.0, 109.0, -46.0, -21.0, -9.0, -14.0, 65.0, 26.0, 33.0, 32.0, 7.0, -18.0, 0.0, -8.0, -8.0, -11.0, -4.0, 0.0, -28.0, -10.0, 4.0, 0.0, -4.0, -88.0, 7.0, -1.0, -1.0, -5.0, 51.0, -3.0, 5.0, -16.0, -80.0, -18.0, -7.0, 0.0, 0.0, 17.0, 0.0, -34.0, 23.0, 2.0, 26.0, -7.0, 0.0, -16.0, 21.0, 42.0, 7.0, -16.0, -4.0, 22.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-18.0, -14.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, -37.0, 0.0, -20.0, 18.0, -44.0, 7.0, 3.0, -7.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, -40.0, -37.0, 24.0, 0.0, -16.0, 0.0, -4.0, 0.0, 0.0, 0.0, -10.0, -38.0, 0.0, -4.0, 0.0, 0.0, -6.0, -10.0, 2.0, 0.0, 0.0, 0.0, -58.0, -2.0, 0.0, 0.0, 0.0, 7.0, -14.0, -2.0, 47.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -31.0, 0.0, -56.0, 0.0, 0.0, -53.0, 2.0, 0.0, 0.0, 0.0, 112.0, -8.0, 0.0, -12.0, 0.0, -35.0, 0.0, -23.0, 0.0, 0.0, 0.0, 0.0, 0.0, -53.0, 0.0, 0.0, 0.0, -12.0, 50.0, -104.0, -50.0, 0.0, 0.0, 8.0, 4.0, -18.0, -15.0, 0.0, 72.0, -34.0, -32.0, -2.0, -38.0, -18.0, 0.0, -18.0, -10.0, 0.0, 65.0, 0.0, -21.0, 45.0, -24.0, 15.0, 0.0, 31.0, -52.0, -32.0, -4.0, 0.0, 0.0, -16.0, 0.0, -16.0, 0.0, -16.0, -6.0, -14.0, 0.0, 0.0, 0.0, -22.0, -18.0, 0.0, -20.0, 8.0, -46.0, 0.0, 0.0, 0.0, -16.0, 0.0, -221.0, 7.0, 0.0, -12.0, -13.0, 0.0, -2.0, -16.0, -46.0, 68.0, -48.0, 0.0, -6.0, 5.0, 0.0, 0.0, -74.0, -206.0, 23.0, 0.0, -36.0, -21.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, -52.0, -18.0, 22.0, 0.0, -6.0, 0.0, 29.0, -35.0, 4.0, -22.0, 0.0, 0.0, -19.0, -8.0, 24.0, -6.0, 27.0, 10.0, -2.0, 4.0, -26.0, -35.0, 0.0, -8.0, 1.0, 0.0], "policy_predator_policy_reward": [7.0, 9.0, 5.0, 2.0, 0.0, 0.0, 0.0, 0.0, 26.0, 11.0, 10.0, 0.0, 22.0, 2.0, 15.0, 1.0, 0.0, 0.0, 12.0, 5.0, 0.0, 0.0, 8.0, 21.0, 0.0, 0.0, 0.0, 8.0, 7.0, 0.0, 0.0, 0.0, 0.0, 24.0, 0.0, 2.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 0.0, 0.0, 29.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 26.0, 25.0, 16.0, 0.0, 0.0, 23.0, 12.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 8.0, 0.0, 21.0, 2.0, 19.0, 18.0, 0.0, 0.0, 0.0, 0.0, 13.0, 14.0, 0.0, 0.0, 0.0, 6.0, 58.0, 10.0, 0.0, 0.0, 0.0, 0.0, 26.0, 9.0, 17.0, 20.0, 11.0, 9.0, 0.0, 19.0, 0.0, 9.0, 9.0, 5.0, 0.0, 0.0, 5.0, 42.0, 12.0, 0.0, 2.0, 15.0, 27.0, 1.0, 3.0, 15.0, 0.0, 0.0, 0.0, 8.0, 8.0, 0.0, 3.0, 8.0, 7.0, 3.0, 0.0, 0.0, 0.0, 12.0, 0.0, 10.0, 33.0, 9.0, 0.0, 0.0, 12.0, 0.0, 131.0, 2.0, 0.0, 0.0, 7.0, 17.0, 1.0, 0.0, 41.0, 16.0, 29.0, 2.0, 0.0, 3.0, 0.0, 0.0, 26.0, 32.0, 0.0, 103.0, 0.0, 18.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 24.0, 12.0, 1.0, 0.0, 0.0, 8.0, 8.0, 24.0, 0.0, 11.0, 0.0, 0.0, 0.0, 11.0, 3.0, 0.0, 5.0, 0.0, 0.0, 5.0, 19.0, 26.0, 0.0, 4.0, 16.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3496630736358215, "mean_inference_ms": 5.330834073018854, "mean_action_processing_ms": 1.1339365432286046, "mean_env_wait_ms": 0.8549050365157078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006454348564147949, "StateBufferConnector_ms": 0.005214214324951172, "ViewRequirementAgentConnector_ms": 0.19420087337493896}, "num_episodes": 18, "episode_return_max": 112.0, "episode_return_min": -88.0, "episode_return_mean": -0.1, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.04790572617574, "num_env_steps_trained_throughput_per_sec": 213.04790572617574, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 26104.401, "restore_workers_time_ms": 0.037, "training_step_time_ms": 26104.294, "sample_time_ms": 5508.509, "learn_time_ms": 20550.625, "learn_throughput": 194.641, "synch_weights_time_ms": 38.04}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 17, "trial_id": "f6b99_00000", "date": "2024-08-13_19-51-40", "timestamp": 1723593100, "time_this_iter_s": 18.85657000541687, "time_total_s": 406.0520029067993, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b318cee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 406.0520029067993, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 80.18148148148147, "ram_util_percent": 83.7148148148148}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.033675850904177, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9054307526381559, "policy_loss": -0.00971103032149138, "vf_loss": 0.9143993164811816, "vf_explained_var": 0.0032748736401714347, "kl": 0.007424662579988945, "entropy": 1.4690634535103249, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4282442505870547, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2271081755085598, "policy_loss": -0.005509471953181284, "vf_loss": 1.232227331636444, "vf_explained_var": -0.0030394813686451584, "kl": 0.00780625954164524, "entropy": 1.3664805443198593, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 112.0, "episode_reward_min": -95.0, "episode_reward_mean": -0.46, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -221.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 112.0, "predator_policy": 131.0}, "policy_reward_mean": {"prey_policy": -8.415, "predator_policy": 8.185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-31.0, 0.0, 7.0, -3.0, 47.0, 0.0, 0.0, 0.0, 3.0, -15.0, 0.0, -16.0, 0.0, 112.0, -4.0, -4.0, -12.0, 14.0, 0.0, 0.0, -26.0, 0.0, 44.0, -86.0, 0.0, 12.0, 2.0, 109.0, -46.0, -21.0, -9.0, -14.0, 65.0, 26.0, 33.0, 32.0, 7.0, -18.0, 0.0, -8.0, -8.0, -11.0, -4.0, 0.0, -28.0, -10.0, 4.0, 0.0, -4.0, -88.0, 7.0, -1.0, -1.0, -5.0, 51.0, -3.0, 5.0, -16.0, -80.0, -18.0, -7.0, 0.0, 0.0, 17.0, 0.0, -34.0, 23.0, 2.0, 26.0, -7.0, 0.0, -16.0, 21.0, 42.0, 7.0, -16.0, -4.0, 22.0, -18.0, 8.0, 1.0, -7.0, 0.0, 17.0, 0.0, -6.0, -3.0, -3.0, 12.0, -5.0, 0.0, 0.0, -16.0, -95.0, -10.0, -3.0, 12.0, 2.0, -9.0, 11.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-58.0, -2.0, 0.0, 0.0, 0.0, 7.0, -14.0, -2.0, 47.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -31.0, 0.0, -56.0, 0.0, 0.0, -53.0, 2.0, 0.0, 0.0, 0.0, 112.0, -8.0, 0.0, -12.0, 0.0, -35.0, 0.0, -23.0, 0.0, 0.0, 0.0, 0.0, 0.0, -53.0, 0.0, 0.0, 0.0, -12.0, 50.0, -104.0, -50.0, 0.0, 0.0, 8.0, 4.0, -18.0, -15.0, 0.0, 72.0, -34.0, -32.0, -2.0, -38.0, -18.0, 0.0, -18.0, -10.0, 0.0, 65.0, 0.0, -21.0, 45.0, -24.0, 15.0, 0.0, 31.0, -52.0, -32.0, -4.0, 0.0, 0.0, -16.0, 0.0, -16.0, 0.0, -16.0, -6.0, -14.0, 0.0, 0.0, 0.0, -22.0, -18.0, 0.0, -20.0, 8.0, -46.0, 0.0, 0.0, 0.0, -16.0, 0.0, -221.0, 7.0, 0.0, -12.0, -13.0, 0.0, -2.0, -16.0, -46.0, 68.0, -48.0, 0.0, -6.0, 5.0, 0.0, 0.0, -74.0, -206.0, 23.0, 0.0, -36.0, -21.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, -52.0, -18.0, 22.0, 0.0, -6.0, 0.0, 29.0, -35.0, 4.0, -22.0, 0.0, 0.0, -19.0, -8.0, 24.0, -6.0, 27.0, 10.0, -2.0, 4.0, -26.0, -35.0, 0.0, -8.0, 1.0, 0.0, 0.0, -38.0, 8.0, 0.0, -8.0, 5.0, 0.0, -14.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, -12.0, -43.0, 6.0, -4.0, -45.0, 10.0, 2.0, -13.0, 1.0, 0.0, 0.0, 0.0, 0.0, -8.0, -24.0, -204.0, -11.0, -20.0, 0.0, 0.0, -6.0, 0.0, 12.0, -6.0, 0.0, -25.0, -2.0, -22.0, 13.0], "policy_predator_policy_reward": [29.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 26.0, 25.0, 16.0, 0.0, 0.0, 23.0, 12.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 8.0, 0.0, 21.0, 2.0, 19.0, 18.0, 0.0, 0.0, 0.0, 0.0, 13.0, 14.0, 0.0, 0.0, 0.0, 6.0, 58.0, 10.0, 0.0, 0.0, 0.0, 0.0, 26.0, 9.0, 17.0, 20.0, 11.0, 9.0, 0.0, 19.0, 0.0, 9.0, 9.0, 5.0, 0.0, 0.0, 5.0, 42.0, 12.0, 0.0, 2.0, 15.0, 27.0, 1.0, 3.0, 15.0, 0.0, 0.0, 0.0, 8.0, 8.0, 0.0, 3.0, 8.0, 7.0, 3.0, 0.0, 0.0, 0.0, 12.0, 0.0, 10.0, 33.0, 9.0, 0.0, 0.0, 12.0, 0.0, 131.0, 2.0, 0.0, 0.0, 7.0, 17.0, 1.0, 0.0, 41.0, 16.0, 29.0, 2.0, 0.0, 3.0, 0.0, 0.0, 26.0, 32.0, 0.0, 103.0, 0.0, 18.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 24.0, 12.0, 1.0, 0.0, 0.0, 8.0, 8.0, 24.0, 0.0, 11.0, 0.0, 0.0, 0.0, 11.0, 3.0, 0.0, 5.0, 0.0, 0.0, 5.0, 19.0, 26.0, 0.0, 4.0, 16.0, 5.0, 16.0, 4.0, 0.0, 0.0, 0.0, 4.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 17.0, 17.0, 21.0, 25.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 12.0, 4.0, 112.0, 8.0, 0.0, 10.0, 0.0, 3.0, 0.0, 0.0, 0.0, 8.0, 17.0, 1.0, 11.0, 9.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.276240272251114, "mean_inference_ms": 5.210445064181938, "mean_action_processing_ms": 1.1077978331928149, "mean_env_wait_ms": 0.8309554129143115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004773139953613281, "StateBufferConnector_ms": 0.004422426223754883, "ViewRequirementAgentConnector_ms": 0.22439038753509521}, "num_episodes": 22, "episode_return_max": 112.0, "episode_return_min": -95.0, "episode_return_mean": -0.46, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 198.68902931041725, "num_env_steps_trained_throughput_per_sec": 198.68902931041725, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 22547.132, "restore_workers_time_ms": 0.023, "training_step_time_ms": 22547.057, "sample_time_ms": 3587.325, "learn_time_ms": 18926.364, "learn_throughput": 211.345, "synch_weights_time_ms": 28.244}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 18, "trial_id": "f6b99_00000", "date": "2024-08-13_19-52-00", "timestamp": 1723593120, "time_this_iter_s": 20.225162982940674, "time_total_s": 426.27716588974, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b604f670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 426.27716588974, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 81.26896551724138, "ram_util_percent": 83.63103448275862}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.464248925037485, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5909602337413364, "policy_loss": -0.012951551919443307, "vf_loss": 1.6025152273279017, "vf_explained_var": 0.012044680244708188, "kl": 0.013965616467347541, "entropy": 1.4358993472876371, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4255079077192085, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0785976425049797, "policy_loss": -0.0074695033270116675, "vf_loss": 2.0855687973991275, "vf_explained_var": -0.07356256151956225, "kl": 0.009966982753107782, "entropy": 1.325525308159924, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 109.0, "episode_reward_min": -95.0, "episode_reward_mean": -3.07, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -221.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 72.0, "predator_policy": 131.0}, "policy_reward_mean": {"prey_policy": -10.37, "predator_policy": 8.835}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-86.0, 0.0, 12.0, 2.0, 109.0, -46.0, -21.0, -9.0, -14.0, 65.0, 26.0, 33.0, 32.0, 7.0, -18.0, 0.0, -8.0, -8.0, -11.0, -4.0, 0.0, -28.0, -10.0, 4.0, 0.0, -4.0, -88.0, 7.0, -1.0, -1.0, -5.0, 51.0, -3.0, 5.0, -16.0, -80.0, -18.0, -7.0, 0.0, 0.0, 17.0, 0.0, -34.0, 23.0, 2.0, 26.0, -7.0, 0.0, -16.0, 21.0, 42.0, 7.0, -16.0, -4.0, 22.0, -18.0, 8.0, 1.0, -7.0, 0.0, 17.0, 0.0, -6.0, -3.0, -3.0, 12.0, -5.0, 0.0, 0.0, -16.0, -95.0, -10.0, -3.0, 12.0, 2.0, -9.0, 11.0, 0.0, -11.0, 4.0, -17.0, -7.0, 17.0, -13.0, 3.0, -17.0, -3.0, -12.0, 0.0, 2.0, -25.0, 4.0, 0.0, -14.0, -29.0, -2.0, 0.0, -3.0, -19.0, -3.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-104.0, -50.0, 0.0, 0.0, 8.0, 4.0, -18.0, -15.0, 0.0, 72.0, -34.0, -32.0, -2.0, -38.0, -18.0, 0.0, -18.0, -10.0, 0.0, 65.0, 0.0, -21.0, 45.0, -24.0, 15.0, 0.0, 31.0, -52.0, -32.0, -4.0, 0.0, 0.0, -16.0, 0.0, -16.0, 0.0, -16.0, -6.0, -14.0, 0.0, 0.0, 0.0, -22.0, -18.0, 0.0, -20.0, 8.0, -46.0, 0.0, 0.0, 0.0, -16.0, 0.0, -221.0, 7.0, 0.0, -12.0, -13.0, 0.0, -2.0, -16.0, -46.0, 68.0, -48.0, 0.0, -6.0, 5.0, 0.0, 0.0, -74.0, -206.0, 23.0, 0.0, -36.0, -21.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, -52.0, -18.0, 22.0, 0.0, -6.0, 0.0, 29.0, -35.0, 4.0, -22.0, 0.0, 0.0, -19.0, -8.0, 24.0, -6.0, 27.0, 10.0, -2.0, 4.0, -26.0, -35.0, 0.0, -8.0, 1.0, 0.0, 0.0, -38.0, 8.0, 0.0, -8.0, 5.0, 0.0, -14.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, -12.0, -43.0, 6.0, -4.0, -45.0, 10.0, 2.0, -13.0, 1.0, 0.0, 0.0, 0.0, 0.0, -8.0, -24.0, -204.0, -11.0, -20.0, 0.0, 0.0, -6.0, 0.0, 12.0, -6.0, 0.0, -25.0, -2.0, -22.0, 13.0, 0.0, 0.0, -14.0, -23.0, 0.0, 4.0, -22.0, -27.0, -8.0, -6.0, 8.0, 9.0, -26.0, 0.0, -32.0, 0.0, -2.0, -32.0, 0.0, -26.0, -24.0, 0.0, 0.0, 0.0, -41.0, 3.0, 0.0, -50.0, 4.0, 0.0, 0.0, 0.0, -44.0, 0.0, 8.0, -87.0, 0.0, -4.0, 0.0, 0.0, 4.0, -28.0, -10.0, -29.0, 18.0, -55.0], "policy_predator_policy_reward": [58.0, 10.0, 0.0, 0.0, 0.0, 0.0, 26.0, 9.0, 17.0, 20.0, 11.0, 9.0, 0.0, 19.0, 0.0, 9.0, 9.0, 5.0, 0.0, 0.0, 5.0, 42.0, 12.0, 0.0, 2.0, 15.0, 27.0, 1.0, 3.0, 15.0, 0.0, 0.0, 0.0, 8.0, 8.0, 0.0, 3.0, 8.0, 7.0, 3.0, 0.0, 0.0, 0.0, 12.0, 0.0, 10.0, 33.0, 9.0, 0.0, 0.0, 12.0, 0.0, 131.0, 2.0, 0.0, 0.0, 7.0, 17.0, 1.0, 0.0, 41.0, 16.0, 29.0, 2.0, 0.0, 3.0, 0.0, 0.0, 26.0, 32.0, 0.0, 103.0, 0.0, 18.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 24.0, 12.0, 1.0, 0.0, 0.0, 8.0, 8.0, 24.0, 0.0, 11.0, 0.0, 0.0, 0.0, 11.0, 3.0, 0.0, 5.0, 0.0, 0.0, 5.0, 19.0, 26.0, 0.0, 4.0, 16.0, 5.0, 16.0, 4.0, 0.0, 0.0, 0.0, 4.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 17.0, 17.0, 21.0, 25.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 12.0, 4.0, 112.0, 8.0, 0.0, 10.0, 0.0, 3.0, 0.0, 0.0, 0.0, 8.0, 17.0, 1.0, 11.0, 9.0, 0.0, 0.0, 17.0, 9.0, 0.0, 0.0, 24.0, 8.0, 3.0, 4.0, 0.0, 0.0, 0.0, 13.0, 10.0, 25.0, 1.0, 16.0, 17.0, 6.0, 6.0, 6.0, 0.0, 0.0, 17.0, 23.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 14.0, 16.0, 2.0, 48.0, 2.0, 0.0, 0.0, 0.0, 20.0, 1.0, 20.0, 0.0, 30.0, 4.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.229184809094794, "mean_inference_ms": 5.173871673636905, "mean_action_processing_ms": 1.0602195429239638, "mean_env_wait_ms": 0.8079333720330633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005870699882507324, "StateBufferConnector_ms": 0.007106184959411621, "ViewRequirementAgentConnector_ms": 0.35091936588287354}, "num_episodes": 23, "episode_return_max": 109.0, "episode_return_min": -95.0, "episode_return_mean": -3.07, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 184.13177268894415, "num_env_steps_trained_throughput_per_sec": 184.13177268894415, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 20919.18, "restore_workers_time_ms": 0.02, "training_step_time_ms": 20919.113, "sample_time_ms": 3204.044, "learn_time_ms": 17690.158, "learn_throughput": 226.114, "synch_weights_time_ms": 20.433}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 19, "trial_id": "f6b99_00000", "date": "2024-08-13_19-52-22", "timestamp": 1723593142, "time_this_iter_s": 21.78631091117859, "time_total_s": 448.0634768009186, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b60361f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 448.0634768009186, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 82.71612903225807, "ram_util_percent": 83.82580645161293}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4034242908317576, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6589224555189648, "policy_loss": -0.00987431971311924, "vf_loss": 1.6675659939094827, "vf_explained_var": -0.003728316353742408, "kl": 0.012307836930745645, "entropy": 1.4329766953433, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9081253336220191, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.587991447644259, "policy_loss": -0.0084954139761745, "vf_loss": 1.5961101958045254, "vf_explained_var": 0.0020356346059728554, "kl": 0.007533269012872249, "entropy": 1.3383225997919759, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 51.0, "episode_reward_min": -108.0, "episode_reward_mean": -7.47, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -221.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 68.0, "predator_policy": 131.0}, "policy_reward_mean": {"prey_policy": -13.24, "predator_policy": 9.505}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.0, -4.0, 0.0, -28.0, -10.0, 4.0, 0.0, -4.0, -88.0, 7.0, -1.0, -1.0, -5.0, 51.0, -3.0, 5.0, -16.0, -80.0, -18.0, -7.0, 0.0, 0.0, 17.0, 0.0, -34.0, 23.0, 2.0, 26.0, -7.0, 0.0, -16.0, 21.0, 42.0, 7.0, -16.0, -4.0, 22.0, -18.0, 8.0, 1.0, -7.0, 0.0, 17.0, 0.0, -6.0, -3.0, -3.0, 12.0, -5.0, 0.0, 0.0, -16.0, -95.0, -10.0, -3.0, 12.0, 2.0, -9.0, 11.0, 0.0, -11.0, 4.0, -17.0, -7.0, 17.0, -13.0, 3.0, -17.0, -3.0, -12.0, 0.0, 2.0, -25.0, 4.0, 0.0, -14.0, -29.0, -2.0, 0.0, -3.0, -19.0, -3.0, -47.0, 1.0, 0.0, -6.0, -18.0, -8.0, -2.0, -1.0, -108.0, -39.0, -6.0, 0.0, 0.0, 1.0, 5.0, -99.0, -8.0, -29.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-16.0, -6.0, -14.0, 0.0, 0.0, 0.0, -22.0, -18.0, 0.0, -20.0, 8.0, -46.0, 0.0, 0.0, 0.0, -16.0, 0.0, -221.0, 7.0, 0.0, -12.0, -13.0, 0.0, -2.0, -16.0, -46.0, 68.0, -48.0, 0.0, -6.0, 5.0, 0.0, 0.0, -74.0, -206.0, 23.0, 0.0, -36.0, -21.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, -52.0, -18.0, 22.0, 0.0, -6.0, 0.0, 29.0, -35.0, 4.0, -22.0, 0.0, 0.0, -19.0, -8.0, 24.0, -6.0, 27.0, 10.0, -2.0, 4.0, -26.0, -35.0, 0.0, -8.0, 1.0, 0.0, 0.0, -38.0, 8.0, 0.0, -8.0, 5.0, 0.0, -14.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, -12.0, -43.0, 6.0, -4.0, -45.0, 10.0, 2.0, -13.0, 1.0, 0.0, 0.0, 0.0, 0.0, -8.0, -24.0, -204.0, -11.0, -20.0, 0.0, 0.0, -6.0, 0.0, 12.0, -6.0, 0.0, -25.0, -2.0, -22.0, 13.0, 0.0, 0.0, -14.0, -23.0, 0.0, 4.0, -22.0, -27.0, -8.0, -6.0, 8.0, 9.0, -26.0, 0.0, -32.0, 0.0, -2.0, -32.0, 0.0, -26.0, -24.0, 0.0, 0.0, 0.0, -41.0, 3.0, 0.0, -50.0, 4.0, 0.0, 0.0, 0.0, -44.0, 0.0, 8.0, -87.0, 0.0, -4.0, 0.0, 0.0, 4.0, -28.0, -10.0, -29.0, 18.0, -55.0, -110.0, 0.0, 1.0, -9.0, 0.0, 0.0, 0.0, -20.0, -28.0, -9.0, 0.0, -16.0, -6.0, 0.0, 0.0, -6.0, -218.0, 0.0, 0.0, -78.0, -14.0, -4.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, 9.0, -8.0, -50.0, -132.0, -16.0, 0.0, 0.0, -112.0], "policy_predator_policy_reward": [3.0, 8.0, 7.0, 3.0, 0.0, 0.0, 0.0, 12.0, 0.0, 10.0, 33.0, 9.0, 0.0, 0.0, 12.0, 0.0, 131.0, 2.0, 0.0, 0.0, 7.0, 17.0, 1.0, 0.0, 41.0, 16.0, 29.0, 2.0, 0.0, 3.0, 0.0, 0.0, 26.0, 32.0, 0.0, 103.0, 0.0, 18.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 24.0, 12.0, 1.0, 0.0, 0.0, 8.0, 8.0, 24.0, 0.0, 11.0, 0.0, 0.0, 0.0, 11.0, 3.0, 0.0, 5.0, 0.0, 0.0, 5.0, 19.0, 26.0, 0.0, 4.0, 16.0, 5.0, 16.0, 4.0, 0.0, 0.0, 0.0, 4.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 17.0, 17.0, 21.0, 25.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 12.0, 4.0, 112.0, 8.0, 0.0, 10.0, 0.0, 3.0, 0.0, 0.0, 0.0, 8.0, 17.0, 1.0, 11.0, 9.0, 0.0, 0.0, 17.0, 9.0, 0.0, 0.0, 24.0, 8.0, 3.0, 4.0, 0.0, 0.0, 0.0, 13.0, 10.0, 25.0, 1.0, 16.0, 17.0, 6.0, 6.0, 6.0, 0.0, 0.0, 17.0, 23.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 14.0, 16.0, 2.0, 48.0, 2.0, 0.0, 0.0, 0.0, 20.0, 1.0, 20.0, 0.0, 30.0, 4.0, 59.0, 4.0, 9.0, 0.0, 0.0, 0.0, 0.0, 14.0, 5.0, 14.0, 8.0, 0.0, 3.0, 1.0, 5.0, 0.0, 110.0, 0.0, 34.0, 5.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 6.0, 7.0, 0.0, 4.0, 79.0, 4.0, 5.0, 3.0, 30.0, 53.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1897952935050222, "mean_inference_ms": 5.125738696918163, "mean_action_processing_ms": 1.0363406219986178, "mean_env_wait_ms": 0.7919854864208241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020253300666809082, "StateBufferConnector_ms": 0.007063746452331543, "ViewRequirementAgentConnector_ms": 0.346432089805603}, "num_episodes": 18, "episode_return_max": 51.0, "episode_return_min": -108.0, "episode_return_mean": -7.47, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 202.8277551018829, "num_env_steps_trained_throughput_per_sec": 202.8277551018829, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 20511.354, "restore_workers_time_ms": 0.021, "training_step_time_ms": 20511.288, "sample_time_ms": 3072.261, "learn_time_ms": 17412.992, "learn_throughput": 229.714, "synch_weights_time_ms": 20.745}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 20, "trial_id": "f6b99_00000", "date": "2024-08-13_19-52-42", "timestamp": 1723593162, "time_this_iter_s": 19.77188992500305, "time_total_s": 467.83536672592163, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6036e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 467.83536672592163, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 84.40357142857144, "ram_util_percent": 83.57142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9756344357968638, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0971898174948163, "policy_loss": -0.009501430106216244, "vf_loss": 1.1057052411572643, "vf_explained_var": 0.0013020340727750586, "kl": 0.009860071601725823, "entropy": 1.3930947579404034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0814705133122742, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2943129801245594, "policy_loss": -0.01809207856182068, "vf_loss": 1.311763749220384, "vf_explained_var": -0.034589592426542255, "kl": 0.012826187375355775, "entropy": 1.2709489636951024, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 42.0, "episode_reward_min": -108.0, "episode_reward_mean": -7.29, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -218.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 29.0, "predator_policy": 112.0}, "policy_reward_mean": {"prey_policy": -12.56, "predator_policy": 8.915}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.0, -7.0, 0.0, 0.0, 17.0, 0.0, -34.0, 23.0, 2.0, 26.0, -7.0, 0.0, -16.0, 21.0, 42.0, 7.0, -16.0, -4.0, 22.0, -18.0, 8.0, 1.0, -7.0, 0.0, 17.0, 0.0, -6.0, -3.0, -3.0, 12.0, -5.0, 0.0, 0.0, -16.0, -95.0, -10.0, -3.0, 12.0, 2.0, -9.0, 11.0, 0.0, -11.0, 4.0, -17.0, -7.0, 17.0, -13.0, 3.0, -17.0, -3.0, -12.0, 0.0, 2.0, -25.0, 4.0, 0.0, -14.0, -29.0, -2.0, 0.0, -3.0, -19.0, -3.0, -47.0, 1.0, 0.0, -6.0, -18.0, -8.0, -2.0, -1.0, -108.0, -39.0, -6.0, 0.0, 0.0, 1.0, 5.0, -99.0, -8.0, -29.0, 0.0, -32.0, -12.0, 20.0, -3.0, 0.0, -11.0, 3.0, 9.0, 0.0, -25.0, 0.0, 0.0, -78.0, 0.0, 3.0, 0.0, -40.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -36.0, -21.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, -52.0, -18.0, 22.0, 0.0, -6.0, 0.0, 29.0, -35.0, 4.0, -22.0, 0.0, 0.0, -19.0, -8.0, 24.0, -6.0, 27.0, 10.0, -2.0, 4.0, -26.0, -35.0, 0.0, -8.0, 1.0, 0.0, 0.0, -38.0, 8.0, 0.0, -8.0, 5.0, 0.0, -14.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, -12.0, -43.0, 6.0, -4.0, -45.0, 10.0, 2.0, -13.0, 1.0, 0.0, 0.0, 0.0, 0.0, -8.0, -24.0, -204.0, -11.0, -20.0, 0.0, 0.0, -6.0, 0.0, 12.0, -6.0, 0.0, -25.0, -2.0, -22.0, 13.0, 0.0, 0.0, -14.0, -23.0, 0.0, 4.0, -22.0, -27.0, -8.0, -6.0, 8.0, 9.0, -26.0, 0.0, -32.0, 0.0, -2.0, -32.0, 0.0, -26.0, -24.0, 0.0, 0.0, 0.0, -41.0, 3.0, 0.0, -50.0, 4.0, 0.0, 0.0, 0.0, -44.0, 0.0, 8.0, -87.0, 0.0, -4.0, 0.0, 0.0, 4.0, -28.0, -10.0, -29.0, 18.0, -55.0, -110.0, 0.0, 1.0, -9.0, 0.0, 0.0, 0.0, -20.0, -28.0, -9.0, 0.0, -16.0, -6.0, 0.0, 0.0, -6.0, -218.0, 0.0, 0.0, -78.0, -14.0, -4.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, 9.0, -8.0, -50.0, -132.0, -16.0, 0.0, 0.0, -112.0, 0.0, 0.0, 0.0, -68.0, 0.0, -24.0, 2.0, 18.0, -14.0, 4.0, 0.0, 0.0, -19.0, -4.0, 3.0, 0.0, 9.0, 0.0, 0.0, 0.0, 5.0, -96.0, 0.0, 0.0, 0.0, 0.0, -72.0, -187.0, 0.0, 0.0, 14.0, -32.0, 0.0, 0.0, -94.0, 0.0], "policy_predator_policy_reward": [0.0, 18.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 24.0, 12.0, 1.0, 0.0, 0.0, 8.0, 8.0, 24.0, 0.0, 11.0, 0.0, 0.0, 0.0, 11.0, 3.0, 0.0, 5.0, 0.0, 0.0, 5.0, 19.0, 26.0, 0.0, 4.0, 16.0, 5.0, 16.0, 4.0, 0.0, 0.0, 0.0, 4.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 17.0, 17.0, 21.0, 25.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 12.0, 4.0, 112.0, 8.0, 0.0, 10.0, 0.0, 3.0, 0.0, 0.0, 0.0, 8.0, 17.0, 1.0, 11.0, 9.0, 0.0, 0.0, 17.0, 9.0, 0.0, 0.0, 24.0, 8.0, 3.0, 4.0, 0.0, 0.0, 0.0, 13.0, 10.0, 25.0, 1.0, 16.0, 17.0, 6.0, 6.0, 6.0, 0.0, 0.0, 17.0, 23.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 14.0, 16.0, 2.0, 48.0, 2.0, 0.0, 0.0, 0.0, 20.0, 1.0, 20.0, 0.0, 30.0, 4.0, 59.0, 4.0, 9.0, 0.0, 0.0, 0.0, 0.0, 14.0, 5.0, 14.0, 8.0, 0.0, 3.0, 1.0, 5.0, 0.0, 110.0, 0.0, 34.0, 5.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 6.0, 7.0, 0.0, 4.0, 79.0, 4.0, 5.0, 3.0, 30.0, 53.0, 0.0, 0.0, 0.0, 36.0, 0.0, 12.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 4.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 36.0, 0.0, 0.0, 0.0, 0.0, 83.0, 98.0, 0.0, 0.0, 2.0, 19.0, 0.0, 0.0, 40.0, 14.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.151531215291326, "mean_inference_ms": 5.073785395950621, "mean_action_processing_ms": 1.0137974971210664, "mean_env_wait_ms": 0.7764099631972602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020243525505065918, "StateBufferConnector_ms": 0.006959795951843262, "ViewRequirementAgentConnector_ms": 0.34588098526000977}, "num_episodes": 18, "episode_return_max": 42.0, "episode_return_min": -108.0, "episode_return_mean": -7.29, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 207.3611532439138, "num_env_steps_trained_throughput_per_sec": 207.3611532439138, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 20255.655, "restore_workers_time_ms": 0.021, "training_step_time_ms": 20255.589, "sample_time_ms": 2900.29, "learn_time_ms": 17327.731, "learn_throughput": 230.844, "synch_weights_time_ms": 21.463}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 21, "trial_id": "f6b99_00000", "date": "2024-08-13_19-53-01", "timestamp": 1723593181, "time_this_iter_s": 19.351860284805298, "time_total_s": 487.18722701072693, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b604f280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 487.18722701072693, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 79.7851851851852, "ram_util_percent": 83.72962962962964}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8873996784683889, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.18107229930708413, "policy_loss": -0.009543719950560777, "vf_loss": 0.18982292535793646, "vf_explained_var": -0.0225423880355068, "kl": 0.007930933864167735, "entropy": 1.3407101609719494, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8381670959175579, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.39679697301303757, "policy_loss": -0.010228959850907798, "vf_loss": 0.40662747565040946, "vf_explained_var": 0.03721117755723378, "kl": 0.007969148095809815, "entropy": 1.3204428504383754, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": -108.0, "episode_reward_mean": -7.83, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -218.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 18.0, "predator_policy": 112.0}, "policy_reward_mean": {"prey_policy": -13.0, "predator_policy": 9.085}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.0, -18.0, 8.0, 1.0, -7.0, 0.0, 17.0, 0.0, -6.0, -3.0, -3.0, 12.0, -5.0, 0.0, 0.0, -16.0, -95.0, -10.0, -3.0, 12.0, 2.0, -9.0, 11.0, 0.0, -11.0, 4.0, -17.0, -7.0, 17.0, -13.0, 3.0, -17.0, -3.0, -12.0, 0.0, 2.0, -25.0, 4.0, 0.0, -14.0, -29.0, -2.0, 0.0, -3.0, -19.0, -3.0, -47.0, 1.0, 0.0, -6.0, -18.0, -8.0, -2.0, -1.0, -108.0, -39.0, -6.0, 0.0, 0.0, 1.0, 5.0, -99.0, -8.0, -29.0, 0.0, -32.0, -12.0, 20.0, -3.0, 0.0, -11.0, 3.0, 9.0, 0.0, -25.0, 0.0, 0.0, -78.0, 0.0, 3.0, 0.0, -40.0, -9.0, 17.0, -8.0, 5.0, -14.0, -4.0, 0.0, -1.0, 0.0, 0.0, -18.0, 0.0, 9.0, 19.0, -10.0, 0.0, -4.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1.0, 0.0, 0.0, -38.0, 8.0, 0.0, -8.0, 5.0, 0.0, -14.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, -12.0, -43.0, 6.0, -4.0, -45.0, 10.0, 2.0, -13.0, 1.0, 0.0, 0.0, 0.0, 0.0, -8.0, -24.0, -204.0, -11.0, -20.0, 0.0, 0.0, -6.0, 0.0, 12.0, -6.0, 0.0, -25.0, -2.0, -22.0, 13.0, 0.0, 0.0, -14.0, -23.0, 0.0, 4.0, -22.0, -27.0, -8.0, -6.0, 8.0, 9.0, -26.0, 0.0, -32.0, 0.0, -2.0, -32.0, 0.0, -26.0, -24.0, 0.0, 0.0, 0.0, -41.0, 3.0, 0.0, -50.0, 4.0, 0.0, 0.0, 0.0, -44.0, 0.0, 8.0, -87.0, 0.0, -4.0, 0.0, 0.0, 4.0, -28.0, -10.0, -29.0, 18.0, -55.0, -110.0, 0.0, 1.0, -9.0, 0.0, 0.0, 0.0, -20.0, -28.0, -9.0, 0.0, -16.0, -6.0, 0.0, 0.0, -6.0, -218.0, 0.0, 0.0, -78.0, -14.0, -4.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, 9.0, -8.0, -50.0, -132.0, -16.0, 0.0, 0.0, -112.0, 0.0, 0.0, 0.0, -68.0, 0.0, -24.0, 2.0, 18.0, -14.0, 4.0, 0.0, 0.0, -19.0, -4.0, 3.0, 0.0, 9.0, 0.0, 0.0, 0.0, 5.0, -96.0, 0.0, 0.0, 0.0, 0.0, -72.0, -187.0, 0.0, 0.0, 14.0, -32.0, 0.0, 0.0, -94.0, 0.0, -18.0, 0.0, 0.0, 16.0, -27.0, 0.0, 5.0, 0.0, 2.0, -165.0, -2.0, -14.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, -16.0, -20.0, 0.0, 0.0, 9.0, 0.0, 11.0, 8.0, 0.0, -20.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0], "policy_predator_policy_reward": [16.0, 5.0, 16.0, 4.0, 0.0, 0.0, 0.0, 4.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 17.0, 17.0, 21.0, 25.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 12.0, 4.0, 112.0, 8.0, 0.0, 10.0, 0.0, 3.0, 0.0, 0.0, 0.0, 8.0, 17.0, 1.0, 11.0, 9.0, 0.0, 0.0, 17.0, 9.0, 0.0, 0.0, 24.0, 8.0, 3.0, 4.0, 0.0, 0.0, 0.0, 13.0, 10.0, 25.0, 1.0, 16.0, 17.0, 6.0, 6.0, 6.0, 0.0, 0.0, 17.0, 23.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 14.0, 16.0, 2.0, 48.0, 2.0, 0.0, 0.0, 0.0, 20.0, 1.0, 20.0, 0.0, 30.0, 4.0, 59.0, 4.0, 9.0, 0.0, 0.0, 0.0, 0.0, 14.0, 5.0, 14.0, 8.0, 0.0, 3.0, 1.0, 5.0, 0.0, 110.0, 0.0, 34.0, 5.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 6.0, 7.0, 0.0, 4.0, 79.0, 4.0, 5.0, 3.0, 30.0, 53.0, 0.0, 0.0, 0.0, 36.0, 0.0, 12.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 4.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 36.0, 0.0, 0.0, 0.0, 0.0, 83.0, 98.0, 0.0, 0.0, 2.0, 19.0, 0.0, 0.0, 40.0, 14.0, 9.0, 0.0, 1.0, 0.0, 3.0, 16.0, 0.0, 0.0, 73.0, 76.0, 11.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1204445563406797, "mean_inference_ms": 5.039416540122134, "mean_action_processing_ms": 0.9951550666566953, "mean_env_wait_ms": 0.7640187408066416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0208892822265625, "StateBufferConnector_ms": 0.006492137908935547, "ViewRequirementAgentConnector_ms": 0.3775264024734497}, "num_episodes": 18, "episode_return_max": 22.0, "episode_return_min": -108.0, "episode_return_mean": -7.83, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 194.04984019865395, "num_env_steps_trained_throughput_per_sec": 194.04984019865395, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 20308.73, "restore_workers_time_ms": 0.02, "training_step_time_ms": 20308.665, "sample_time_ms": 2982.272, "learn_time_ms": 17293.922, "learn_throughput": 231.295, "synch_weights_time_ms": 25.845}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 22, "trial_id": "f6b99_00000", "date": "2024-08-13_19-53-22", "timestamp": 1723593202, "time_this_iter_s": 20.74716591835022, "time_total_s": 507.93439292907715, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b324b3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 507.93439292907715, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 83.47241379310346, "ram_util_percent": 83.75172413793106}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0277920966110532, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.551430767774582, "policy_loss": -0.01369767976671004, "vf_loss": 1.5635962309976104, "vf_explained_var": 0.0027297103846514667, "kl": 0.015322209709695866, "entropy": 1.2650220400441892, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8083934448541157, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0596477088089737, "policy_loss": -0.014188550599412155, "vf_loss": 1.0730941432572547, "vf_explained_var": -0.027669490582097774, "kl": 0.01484228023997683, "entropy": 1.3308067116157087, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 20.0, "episode_reward_min": -108.0, "episode_reward_mean": -10.43, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -218.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 18.0, "predator_policy": 110.0}, "policy_reward_mean": {"prey_policy": -14.97, "predator_policy": 9.755}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.0, 17.0, -13.0, 3.0, -17.0, -3.0, -12.0, 0.0, 2.0, -25.0, 4.0, 0.0, -14.0, -29.0, -2.0, 0.0, -3.0, -19.0, -3.0, -47.0, 1.0, 0.0, -6.0, -18.0, -8.0, -2.0, -1.0, -108.0, -39.0, -6.0, 0.0, 0.0, 1.0, 5.0, -99.0, -8.0, -29.0, 0.0, -32.0, -12.0, 20.0, -3.0, 0.0, -11.0, 3.0, 9.0, 0.0, -25.0, 0.0, 0.0, -78.0, 0.0, 3.0, 0.0, -40.0, -9.0, 17.0, -8.0, 5.0, -14.0, -4.0, 0.0, -1.0, 0.0, 0.0, -18.0, 0.0, 9.0, 19.0, -10.0, 0.0, -4.0, 0.0, -10.0, -61.0, 0.0, -23.0, -18.0, 0.0, 5.0, -3.0, 8.0, 1.0, 3.0, 4.0, -41.0, -9.0, -24.0, 7.0, -11.0, -74.0, 8.0, -40.0, -25.0, 0.0, -64.0, 0.0, 2.0, 0.0, -9.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-8.0, -6.0, 8.0, 9.0, -26.0, 0.0, -32.0, 0.0, -2.0, -32.0, 0.0, -26.0, -24.0, 0.0, 0.0, 0.0, -41.0, 3.0, 0.0, -50.0, 4.0, 0.0, 0.0, 0.0, -44.0, 0.0, 8.0, -87.0, 0.0, -4.0, 0.0, 0.0, 4.0, -28.0, -10.0, -29.0, 18.0, -55.0, -110.0, 0.0, 1.0, -9.0, 0.0, 0.0, 0.0, -20.0, -28.0, -9.0, 0.0, -16.0, -6.0, 0.0, 0.0, -6.0, -218.0, 0.0, 0.0, -78.0, -14.0, -4.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, 9.0, -8.0, -50.0, -132.0, -16.0, 0.0, 0.0, -112.0, 0.0, 0.0, 0.0, -68.0, 0.0, -24.0, 2.0, 18.0, -14.0, 4.0, 0.0, 0.0, -19.0, -4.0, 3.0, 0.0, 9.0, 0.0, 0.0, 0.0, 5.0, -96.0, 0.0, 0.0, 0.0, 0.0, -72.0, -187.0, 0.0, 0.0, 14.0, -32.0, 0.0, 0.0, -94.0, 0.0, -18.0, 0.0, 0.0, 16.0, -27.0, 0.0, 5.0, 0.0, 2.0, -165.0, -2.0, -14.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, -16.0, -20.0, 0.0, 0.0, 9.0, 0.0, 11.0, 8.0, 0.0, -20.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, -8.0, -10.0, 0.0, -122.0, 0.0, 0.0, -20.0, -14.0, -56.0, 10.0, 0.0, 0.0, 5.0, 0.0, -6.0, 0.0, 0.0, 8.0, 1.0, 0.0, 0.0, 3.0, 4.0, 0.0, -34.0, -24.0, -20.0, 0.0, -10.0, -75.0, 0.0, 7.0, 0.0, -22.0, -194.0, 9.0, 0.0, 8.0, -22.0, -80.0, 0.0, -52.0, 0.0, 0.0, -147.0, -22.0, 0.0, 0.0, 5.0, -7.0, 0.0, 0.0, 0.0, -21.0], "policy_predator_policy_reward": [3.0, 4.0, 0.0, 0.0, 0.0, 13.0, 10.0, 25.0, 1.0, 16.0, 17.0, 6.0, 6.0, 6.0, 0.0, 0.0, 17.0, 23.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 14.0, 16.0, 2.0, 48.0, 2.0, 0.0, 0.0, 0.0, 20.0, 1.0, 20.0, 0.0, 30.0, 4.0, 59.0, 4.0, 9.0, 0.0, 0.0, 0.0, 0.0, 14.0, 5.0, 14.0, 8.0, 0.0, 3.0, 1.0, 5.0, 0.0, 110.0, 0.0, 34.0, 5.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 6.0, 7.0, 0.0, 4.0, 79.0, 4.0, 5.0, 3.0, 30.0, 53.0, 0.0, 0.0, 0.0, 36.0, 0.0, 12.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 4.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 36.0, 0.0, 0.0, 0.0, 0.0, 83.0, 98.0, 0.0, 0.0, 2.0, 19.0, 0.0, 0.0, 40.0, 14.0, 9.0, 0.0, 1.0, 0.0, 3.0, 16.0, 0.0, 0.0, 73.0, 76.0, 11.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 8.0, 55.0, 6.0, 0.0, 0.0, 11.0, 0.0, 0.0, 28.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 1.0, 10.0, 29.0, 32.0, 0.0, 0.0, 0.0, 11.0, 67.0, 44.0, 0.0, 0.0, 29.0, 33.0, 0.0, 27.0, 0.0, 0.0, 50.0, 55.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 12.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.066266433819497, "mean_inference_ms": 4.987806393657693, "mean_action_processing_ms": 0.9944762568100383, "mean_env_wait_ms": 0.7596899461128045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02126932144165039, "StateBufferConnector_ms": 0.026404976844787598, "ViewRequirementAgentConnector_ms": 0.3408167362213135}, "num_episodes": 27, "episode_return_max": 20.0, "episode_return_min": -108.0, "episode_return_mean": -10.43, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 175.71942415337912, "num_env_steps_trained_throughput_per_sec": 175.71942415337912, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 20439.98, "restore_workers_time_ms": 0.02, "training_step_time_ms": 20439.915, "sample_time_ms": 3169.783, "learn_time_ms": 17236.999, "learn_throughput": 232.059, "synch_weights_time_ms": 25.361}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 23, "trial_id": "f6b99_00000", "date": "2024-08-13_19-53-45", "timestamp": 1723593225, "time_this_iter_s": 22.838489055633545, "time_total_s": 530.7728819847107, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6028160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 530.7728819847107, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 86.103125, "ram_util_percent": 83.634375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8798193406569894, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.30405573572904343, "policy_loss": -0.00841772576261844, "vf_loss": 0.311652254220591, "vf_explained_var": 0.009904470424803476, "kl": 0.008212074240752069, "entropy": 1.2077475403351758, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7402073710447266, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3356429416383247, "policy_loss": -0.010414777068845022, "vf_loss": 0.34567809885635076, "vf_explained_var": -0.004110516694487718, "kl": 0.00759240108104803, "entropy": 1.2787261333415116, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 20.0, "episode_reward_min": -108.0, "episode_reward_mean": -9.66, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -218.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 22.0, "predator_policy": 110.0}, "policy_reward_mean": {"prey_policy": -13.635, "predator_policy": 8.805}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -47.0, 1.0, 0.0, -6.0, -18.0, -8.0, -2.0, -1.0, -108.0, -39.0, -6.0, 0.0, 0.0, 1.0, 5.0, -99.0, -8.0, -29.0, 0.0, -32.0, -12.0, 20.0, -3.0, 0.0, -11.0, 3.0, 9.0, 0.0, -25.0, 0.0, 0.0, -78.0, 0.0, 3.0, 0.0, -40.0, -9.0, 17.0, -8.0, 5.0, -14.0, -4.0, 0.0, -1.0, 0.0, 0.0, -18.0, 0.0, 9.0, 19.0, -10.0, 0.0, -4.0, 0.0, -10.0, -61.0, 0.0, -23.0, -18.0, 0.0, 5.0, -3.0, 8.0, 1.0, 3.0, 4.0, -41.0, -9.0, -24.0, 7.0, -11.0, -74.0, 8.0, -40.0, -25.0, 0.0, -64.0, 0.0, 2.0, 0.0, -9.0, -6.0, 3.0, 0.0, 14.0, 0.0, -30.0, -6.0, -4.0, 5.0, -9.0, 0.0, -4.0, -14.0, 0.0, 0.0, 0.0, -1.0, 11.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [18.0, -55.0, -110.0, 0.0, 1.0, -9.0, 0.0, 0.0, 0.0, -20.0, -28.0, -9.0, 0.0, -16.0, -6.0, 0.0, 0.0, -6.0, -218.0, 0.0, 0.0, -78.0, -14.0, -4.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, 9.0, -8.0, -50.0, -132.0, -16.0, 0.0, 0.0, -112.0, 0.0, 0.0, 0.0, -68.0, 0.0, -24.0, 2.0, 18.0, -14.0, 4.0, 0.0, 0.0, -19.0, -4.0, 3.0, 0.0, 9.0, 0.0, 0.0, 0.0, 5.0, -96.0, 0.0, 0.0, 0.0, 0.0, -72.0, -187.0, 0.0, 0.0, 14.0, -32.0, 0.0, 0.0, -94.0, 0.0, -18.0, 0.0, 0.0, 16.0, -27.0, 0.0, 5.0, 0.0, 2.0, -165.0, -2.0, -14.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, -16.0, -20.0, 0.0, 0.0, 9.0, 0.0, 11.0, 8.0, 0.0, -20.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, -8.0, -10.0, 0.0, -122.0, 0.0, 0.0, -20.0, -14.0, -56.0, 10.0, 0.0, 0.0, 5.0, 0.0, -6.0, 0.0, 0.0, 8.0, 1.0, 0.0, 0.0, 3.0, 4.0, 0.0, -34.0, -24.0, -20.0, 0.0, -10.0, -75.0, 0.0, 7.0, 0.0, -22.0, -194.0, 9.0, 0.0, 8.0, -22.0, -80.0, 0.0, -52.0, 0.0, 0.0, -147.0, -22.0, 0.0, 0.0, 5.0, -7.0, 0.0, 0.0, 0.0, -21.0, -21.0, -12.0, 0.0, 3.0, 0.0, 0.0, -16.0, 22.0, 0.0, 0.0, -18.0, -30.0, 0.0, -12.0, 0.0, -8.0, 0.0, 5.0, -18.0, 0.0, 0.0, 0.0, 0.0, -8.0, -40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 9.0], "policy_predator_policy_reward": [30.0, 4.0, 59.0, 4.0, 9.0, 0.0, 0.0, 0.0, 0.0, 14.0, 5.0, 14.0, 8.0, 0.0, 3.0, 1.0, 5.0, 0.0, 110.0, 0.0, 34.0, 5.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 6.0, 7.0, 0.0, 4.0, 79.0, 4.0, 5.0, 3.0, 30.0, 53.0, 0.0, 0.0, 0.0, 36.0, 0.0, 12.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 4.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 36.0, 0.0, 0.0, 0.0, 0.0, 83.0, 98.0, 0.0, 0.0, 2.0, 19.0, 0.0, 0.0, 40.0, 14.0, 9.0, 0.0, 1.0, 0.0, 3.0, 16.0, 0.0, 0.0, 73.0, 76.0, 11.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 8.0, 55.0, 6.0, 0.0, 0.0, 11.0, 0.0, 0.0, 28.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 1.0, 10.0, 29.0, 32.0, 0.0, 0.0, 0.0, 11.0, 67.0, 44.0, 0.0, 0.0, 29.0, 33.0, 0.0, 27.0, 0.0, 0.0, 50.0, 55.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 12.0, 3.0, 24.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 18.0, 6.0, 0.0, 0.0, 4.0, 0.0, 0.0, 8.0, 1.0, 0.0, 0.0, 4.0, 0.0, 12.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 2.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0481524409327703, "mean_inference_ms": 4.9578146979921724, "mean_action_processing_ms": 0.9526822925942936, "mean_env_wait_ms": 0.7349903867579022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0406566858291626, "StateBufferConnector_ms": 0.023758888244628906, "ViewRequirementAgentConnector_ms": 0.2602839469909668}, "num_episodes": 18, "episode_return_max": 20.0, "episode_return_min": -108.0, "episode_return_mean": -9.66, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 200.81926309891028, "num_env_steps_trained_throughput_per_sec": 200.81926309891028, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 20480.68, "restore_workers_time_ms": 0.021, "training_step_time_ms": 20480.614, "sample_time_ms": 3158.75, "learn_time_ms": 17289.167, "learn_throughput": 231.359, "synch_weights_time_ms": 25.668}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 24, "trial_id": "f6b99_00000", "date": "2024-08-13_19-54-05", "timestamp": 1723593245, "time_this_iter_s": 20.005290031433105, "time_total_s": 550.7781720161438, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6028ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 550.7781720161438, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 80.15862068965517, "ram_util_percent": 83.66551724137932}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7476920444892827, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2682236896640567, "policy_loss": -0.009380933895174946, "vf_loss": 0.2766887555819709, "vf_explained_var": 0.0025594278933509947, "kl": 0.009158674659066352, "entropy": 1.1543831075310076, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6044948127179864, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.24343654142476176, "policy_loss": -0.013119299494705739, "vf_loss": 0.25622322119004953, "vf_explained_var": -0.0602051248310735, "kl": 0.006652388979270787, "entropy": 1.2108144068844104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 20.0, "episode_reward_min": -78.0, "episode_reward_mean": -7.4, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -194.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 22.0, "predator_policy": 98.0}, "policy_reward_mean": {"prey_policy": -11.125, "predator_policy": 7.425}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29.0, 0.0, -32.0, -12.0, 20.0, -3.0, 0.0, -11.0, 3.0, 9.0, 0.0, -25.0, 0.0, 0.0, -78.0, 0.0, 3.0, 0.0, -40.0, -9.0, 17.0, -8.0, 5.0, -14.0, -4.0, 0.0, -1.0, 0.0, 0.0, -18.0, 0.0, 9.0, 19.0, -10.0, 0.0, -4.0, 0.0, -10.0, -61.0, 0.0, -23.0, -18.0, 0.0, 5.0, -3.0, 8.0, 1.0, 3.0, 4.0, -41.0, -9.0, -24.0, 7.0, -11.0, -74.0, 8.0, -40.0, -25.0, 0.0, -64.0, 0.0, 2.0, 0.0, -9.0, -6.0, 3.0, 0.0, 14.0, 0.0, -30.0, -6.0, -4.0, 5.0, -9.0, 0.0, -4.0, -14.0, 0.0, 0.0, 0.0, -1.0, 11.0, -14.0, 0.0, 0.0, 0.0, -20.0, -20.0, 0.0, -8.0, -15.0, -3.0, 3.0, -8.0, -36.0, -9.0, 0.0, 8.0, 10.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -112.0, 0.0, 0.0, 0.0, -68.0, 0.0, -24.0, 2.0, 18.0, -14.0, 4.0, 0.0, 0.0, -19.0, -4.0, 3.0, 0.0, 9.0, 0.0, 0.0, 0.0, 5.0, -96.0, 0.0, 0.0, 0.0, 0.0, -72.0, -187.0, 0.0, 0.0, 14.0, -32.0, 0.0, 0.0, -94.0, 0.0, -18.0, 0.0, 0.0, 16.0, -27.0, 0.0, 5.0, 0.0, 2.0, -165.0, -2.0, -14.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, -16.0, -20.0, 0.0, 0.0, 9.0, 0.0, 11.0, 8.0, 0.0, -20.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, -8.0, -10.0, 0.0, -122.0, 0.0, 0.0, -20.0, -14.0, -56.0, 10.0, 0.0, 0.0, 5.0, 0.0, -6.0, 0.0, 0.0, 8.0, 1.0, 0.0, 0.0, 3.0, 4.0, 0.0, -34.0, -24.0, -20.0, 0.0, -10.0, -75.0, 0.0, 7.0, 0.0, -22.0, -194.0, 9.0, 0.0, 8.0, -22.0, -80.0, 0.0, -52.0, 0.0, 0.0, -147.0, -22.0, 0.0, 0.0, 5.0, -7.0, 0.0, 0.0, 0.0, -21.0, -21.0, -12.0, 0.0, 3.0, 0.0, 0.0, -16.0, 22.0, 0.0, 0.0, -18.0, -30.0, 0.0, -12.0, 0.0, -8.0, 0.0, 5.0, -18.0, 0.0, 0.0, 0.0, 0.0, -8.0, -40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 9.0, -34.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -40.0, -40.0, 0.0, 0.0, 0.0, -19.0, 0.0, -40.0, 2.0, -6.0, 0.0, 3.0, 0.0, -18.0, -2.0, -34.0, -24.0, -20.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 3.0, 0.0, 0.0], "policy_predator_policy_reward": [30.0, 53.0, 0.0, 0.0, 0.0, 36.0, 0.0, 12.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 4.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 36.0, 0.0, 0.0, 0.0, 0.0, 83.0, 98.0, 0.0, 0.0, 2.0, 19.0, 0.0, 0.0, 40.0, 14.0, 9.0, 0.0, 1.0, 0.0, 3.0, 16.0, 0.0, 0.0, 73.0, 76.0, 11.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 8.0, 55.0, 6.0, 0.0, 0.0, 11.0, 0.0, 0.0, 28.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 1.0, 10.0, 29.0, 32.0, 0.0, 0.0, 0.0, 11.0, 67.0, 44.0, 0.0, 0.0, 29.0, 33.0, 0.0, 27.0, 0.0, 0.0, 50.0, 55.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 12.0, 3.0, 24.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 18.0, 6.0, 0.0, 0.0, 4.0, 0.0, 0.0, 8.0, 1.0, 0.0, 0.0, 4.0, 0.0, 12.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 2.0, 0.0, 14.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 20.0, 0.0, 0.0, 0.0, 11.0, 0.0, 23.0, 0.0, 0.0, 3.0, 0.0, 0.0, 12.0, 0.0, 22.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.018384819106117, "mean_inference_ms": 4.917678495895112, "mean_action_processing_ms": 0.9849889826380295, "mean_env_wait_ms": 0.723761736048745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026807188987731934, "StateBufferConnector_ms": 0.023776531219482422, "ViewRequirementAgentConnector_ms": 0.2667340040206909}, "num_episodes": 18, "episode_return_max": 20.0, "episode_return_min": -78.0, "episode_return_mean": -7.4, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 163.5491061932696, "num_env_steps_trained_throughput_per_sec": 163.5491061932696, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 20825.286, "restore_workers_time_ms": 0.022, "training_step_time_ms": 20825.219, "sample_time_ms": 3401.077, "learn_time_ms": 17388.481, "learn_throughput": 230.037, "synch_weights_time_ms": 28.646}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 25, "trial_id": "f6b99_00000", "date": "2024-08-13_19-54-29", "timestamp": 1723593269, "time_this_iter_s": 24.58479595184326, "time_total_s": 575.3629679679871, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b60479d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 575.3629679679871, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 85.96176470588236, "ram_util_percent": 83.88823529411764}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6949716397102863, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2014637304134864, "policy_loss": -0.008801697519676828, "vf_loss": 0.20968215809790072, "vf_explained_var": 0.01675819723063676, "kl": 0.005832700061958026, "entropy": 1.123588218007769, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.660533907264471, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3273895351121032, "policy_loss": -0.010686001446216353, "vf_loss": 0.3373196068564775, "vf_explained_var": 0.03949353524616787, "kl": 0.015118607603473224, "entropy": 1.2180356313311864, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 19.0, "episode_reward_min": -74.0, "episode_reward_mean": -6.94, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -194.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 22.0, "predator_policy": 76.0}, "policy_reward_mean": {"prey_policy": -9.725, "predator_policy": 6.255}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40.0, -9.0, 17.0, -8.0, 5.0, -14.0, -4.0, 0.0, -1.0, 0.0, 0.0, -18.0, 0.0, 9.0, 19.0, -10.0, 0.0, -4.0, 0.0, -10.0, -61.0, 0.0, -23.0, -18.0, 0.0, 5.0, -3.0, 8.0, 1.0, 3.0, 4.0, -41.0, -9.0, -24.0, 7.0, -11.0, -74.0, 8.0, -40.0, -25.0, 0.0, -64.0, 0.0, 2.0, 0.0, -9.0, -6.0, 3.0, 0.0, 14.0, 0.0, -30.0, -6.0, -4.0, 5.0, -9.0, 0.0, -4.0, -14.0, 0.0, 0.0, 0.0, -1.0, 11.0, -14.0, 0.0, 0.0, 0.0, -20.0, -20.0, 0.0, -8.0, -15.0, -3.0, 3.0, -8.0, -36.0, -9.0, 0.0, 8.0, 10.0, 0.0, 0.0, 17.0, 8.0, 0.0, -11.0, 0.0, -11.0, 0.0, -6.0, 9.0, -19.0, 0.0, 0.0, -33.0, -3.0, -17.0, -38.0, -5.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-94.0, 0.0, -18.0, 0.0, 0.0, 16.0, -27.0, 0.0, 5.0, 0.0, 2.0, -165.0, -2.0, -14.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, -16.0, -20.0, 0.0, 0.0, 9.0, 0.0, 11.0, 8.0, 0.0, -20.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, -8.0, -10.0, 0.0, -122.0, 0.0, 0.0, -20.0, -14.0, -56.0, 10.0, 0.0, 0.0, 5.0, 0.0, -6.0, 0.0, 0.0, 8.0, 1.0, 0.0, 0.0, 3.0, 4.0, 0.0, -34.0, -24.0, -20.0, 0.0, -10.0, -75.0, 0.0, 7.0, 0.0, -22.0, -194.0, 9.0, 0.0, 8.0, -22.0, -80.0, 0.0, -52.0, 0.0, 0.0, -147.0, -22.0, 0.0, 0.0, 5.0, -7.0, 0.0, 0.0, 0.0, -21.0, -21.0, -12.0, 0.0, 3.0, 0.0, 0.0, -16.0, 22.0, 0.0, 0.0, -18.0, -30.0, 0.0, -12.0, 0.0, -8.0, 0.0, 5.0, -18.0, 0.0, 0.0, 0.0, 0.0, -8.0, -40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 9.0, -34.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -40.0, -40.0, 0.0, 0.0, 0.0, -19.0, 0.0, -40.0, 2.0, -6.0, 0.0, 3.0, 0.0, -18.0, -2.0, -34.0, -24.0, -20.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, -22.0, 0.0, 0.0, -22.0, -2.0, 0.0, 0.0, -12.0, 0.0, 5.0, 4.0, -14.0, -18.0, 2.0, -4.0, 0.0, 0.0, -11.0, -48.0, 0.0, -28.0, -28.0, -4.0, -96.0, 0.0, -20.0, 0.0], "policy_predator_policy_reward": [40.0, 14.0, 9.0, 0.0, 1.0, 0.0, 3.0, 16.0, 0.0, 0.0, 73.0, 76.0, 11.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 8.0, 55.0, 6.0, 0.0, 0.0, 11.0, 0.0, 0.0, 28.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 1.0, 10.0, 29.0, 32.0, 0.0, 0.0, 0.0, 11.0, 67.0, 44.0, 0.0, 0.0, 29.0, 33.0, 0.0, 27.0, 0.0, 0.0, 50.0, 55.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 12.0, 3.0, 24.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 18.0, 6.0, 0.0, 0.0, 4.0, 0.0, 0.0, 8.0, 1.0, 0.0, 0.0, 4.0, 0.0, 12.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 2.0, 0.0, 14.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 20.0, 0.0, 0.0, 0.0, 11.0, 0.0, 23.0, 0.0, 0.0, 3.0, 0.0, 0.0, 12.0, 0.0, 22.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 13.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 26.0, 12.0, 13.0, 0.0, 15.0, 39.0, 19.0, 10.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9899763501449304, "mean_inference_ms": 4.881590531182232, "mean_action_processing_ms": 1.0166582486023388, "mean_env_wait_ms": 0.7134545929839939, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026877999305725098, "StateBufferConnector_ms": 0.023705482482910156, "ViewRequirementAgentConnector_ms": 0.2518761157989502}, "num_episodes": 18, "episode_return_max": 19.0, "episode_return_min": -74.0, "episode_return_mean": -6.94, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 202.6593757098936, "num_env_steps_trained_throughput_per_sec": 202.6593757098936, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 20713.224, "restore_workers_time_ms": 0.023, "training_step_time_ms": 20713.152, "sample_time_ms": 3311.029, "learn_time_ms": 17365.282, "learn_throughput": 230.345, "synch_weights_time_ms": 29.286}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 26, "trial_id": "f6b99_00000", "date": "2024-08-13_19-54-49", "timestamp": 1723593289, "time_this_iter_s": 19.802449941635132, "time_total_s": 595.1654179096222, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b602fdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 595.1654179096222, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 86.16071428571429, "ram_util_percent": 83.7464285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7034839424506697, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3148108457269334, "policy_loss": -0.0073552251721993485, "vf_loss": 0.32177960884340956, "vf_explained_var": 0.04641822690055484, "kl": 0.0038646129088528184, "entropy": 1.1146377577983513, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7783627078410179, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5848978723119698, "policy_loss": -0.010215972713317978, "vf_loss": 0.5944214826065396, "vf_explained_var": -0.014912190355321087, "kl": 0.013847264482867595, "entropy": 1.1999601007769347, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 17.0, "episode_reward_min": -74.0, "episode_reward_mean": -6.32, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -194.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 22.0, "predator_policy": 67.0}, "policy_reward_mean": {"prey_policy": -8.425, "predator_policy": 5.265}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0, -18.0, 0.0, 5.0, -3.0, 8.0, 1.0, 3.0, 4.0, -41.0, -9.0, -24.0, 7.0, -11.0, -74.0, 8.0, -40.0, -25.0, 0.0, -64.0, 0.0, 2.0, 0.0, -9.0, -6.0, 3.0, 0.0, 14.0, 0.0, -30.0, -6.0, -4.0, 5.0, -9.0, 0.0, -4.0, -14.0, 0.0, 0.0, 0.0, -1.0, 11.0, -14.0, 0.0, 0.0, 0.0, -20.0, -20.0, 0.0, -8.0, -15.0, -3.0, 3.0, -8.0, -36.0, -9.0, 0.0, 8.0, 10.0, 0.0, 0.0, 17.0, 8.0, 0.0, -11.0, 0.0, -11.0, 0.0, -6.0, 9.0, -19.0, 0.0, 0.0, -33.0, -3.0, -17.0, -38.0, -5.0, 0.0, -15.0, -21.0, -6.0, 0.0, 0.0, 5.0, 17.0, 0.0, -12.0, -16.0, -5.0, -14.0, -2.0, 1.0, 3.0, -1.0, -6.0, 0.0, 15.0, -10.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-20.0, -14.0, -56.0, 10.0, 0.0, 0.0, 5.0, 0.0, -6.0, 0.0, 0.0, 8.0, 1.0, 0.0, 0.0, 3.0, 4.0, 0.0, -34.0, -24.0, -20.0, 0.0, -10.0, -75.0, 0.0, 7.0, 0.0, -22.0, -194.0, 9.0, 0.0, 8.0, -22.0, -80.0, 0.0, -52.0, 0.0, 0.0, -147.0, -22.0, 0.0, 0.0, 5.0, -7.0, 0.0, 0.0, 0.0, -21.0, -21.0, -12.0, 0.0, 3.0, 0.0, 0.0, -16.0, 22.0, 0.0, 0.0, -18.0, -30.0, 0.0, -12.0, 0.0, -8.0, 0.0, 5.0, -18.0, 0.0, 0.0, 0.0, 0.0, -8.0, -40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 9.0, -34.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -40.0, -40.0, 0.0, 0.0, 0.0, -19.0, 0.0, -40.0, 2.0, -6.0, 0.0, 3.0, 0.0, -18.0, -2.0, -34.0, -24.0, -20.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, -22.0, 0.0, 0.0, -22.0, -2.0, 0.0, 0.0, -12.0, 0.0, 5.0, 4.0, -14.0, -18.0, 2.0, -4.0, 0.0, 0.0, -11.0, -48.0, 0.0, -28.0, -28.0, -4.0, -96.0, 0.0, -20.0, 0.0, 0.0, 0.0, -41.0, 0.0, -30.0, -30.0, 4.0, -28.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, -4.0, 19.0, 0.0, 0.0, -8.0, -16.0, -10.0, -22.0, -12.0, 0.0, -4.0, -20.0, -4.0, 0.0, -4.0, 3.0, 3.0, 0.0, -2.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 15.0, -16.0, -4.0, 0.0, 0.0], "policy_predator_policy_reward": [11.0, 0.0, 0.0, 28.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 1.0, 10.0, 29.0, 32.0, 0.0, 0.0, 0.0, 11.0, 67.0, 44.0, 0.0, 0.0, 29.0, 33.0, 0.0, 27.0, 0.0, 0.0, 50.0, 55.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 12.0, 3.0, 24.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 18.0, 6.0, 0.0, 0.0, 4.0, 0.0, 0.0, 8.0, 1.0, 0.0, 0.0, 4.0, 0.0, 12.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 2.0, 0.0, 14.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 20.0, 0.0, 0.0, 0.0, 11.0, 0.0, 23.0, 0.0, 0.0, 3.0, 0.0, 0.0, 12.0, 0.0, 22.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 13.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 26.0, 12.0, 13.0, 0.0, 15.0, 39.0, 19.0, 10.0, 5.0, 0.0, 0.0, 0.0, 26.0, 10.0, 29.0, 9.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 4.0, 8.0, 11.0, 5.0, 5.0, 2.0, 10.0, 0.0, 2.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 8.0, 2.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.952650296648163, "mean_inference_ms": 4.818706208986125, "mean_action_processing_ms": 1.0618436698262073, "mean_env_wait_ms": 0.7015219535984103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027840375900268555, "StateBufferConnector_ms": 0.023410797119140625, "ViewRequirementAgentConnector_ms": 0.2216585874557495}, "num_episodes": 22, "episode_return_max": 17.0, "episode_return_min": -74.0, "episode_return_mean": -6.32, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 211.4511371852537, "num_env_steps_trained_throughput_per_sec": 211.4511371852537, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 20727.402, "restore_workers_time_ms": 0.023, "training_step_time_ms": 20727.33, "sample_time_ms": 3309.956, "learn_time_ms": 17380.452, "learn_throughput": 230.144, "synch_weights_time_ms": 29.333}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 27, "trial_id": "f6b99_00000", "date": "2024-08-13_19-55-08", "timestamp": 1723593308, "time_this_iter_s": 18.982285022735596, "time_total_s": 614.1477029323578, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b318cdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 614.1477029323578, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 83.9925925925926, "ram_util_percent": 83.65925925925927}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9635251911780821, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4032383524551593, "policy_loss": -0.009288414538266364, "vf_loss": 0.41206722943674007, "vf_explained_var": 0.010237363816569091, "kl": 0.009190756716238433, "entropy": 1.0986024608057012, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0838908537118523, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6390591134893753, "policy_loss": -0.008523361500791181, "vf_loss": 0.647279462642061, "vf_explained_var": 0.09474854825665711, "kl": 0.0060602364591918, "entropy": 1.157671553054184, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 39.0, "episode_reward_min": -71.0, "episode_reward_mean": -3.08, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -104.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 43.0, "predator_policy": 60.0}, "policy_reward_mean": {"prey_policy": -5.29, "predator_policy": 3.75}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.0, -6.0, 3.0, 0.0, 14.0, 0.0, -30.0, -6.0, -4.0, 5.0, -9.0, 0.0, -4.0, -14.0, 0.0, 0.0, 0.0, -1.0, 11.0, -14.0, 0.0, 0.0, 0.0, -20.0, -20.0, 0.0, -8.0, -15.0, -3.0, 3.0, -8.0, -36.0, -9.0, 0.0, 8.0, 10.0, 0.0, 0.0, 17.0, 8.0, 0.0, -11.0, 0.0, -11.0, 0.0, -6.0, 9.0, -19.0, 0.0, 0.0, -33.0, -3.0, -17.0, -38.0, -5.0, 0.0, -15.0, -21.0, -6.0, 0.0, 0.0, 5.0, 17.0, 0.0, -12.0, -16.0, -5.0, -14.0, -2.0, 1.0, 3.0, -1.0, -6.0, 0.0, 15.0, -10.0, 0.0, -10.0, 23.0, 0.0, 0.0, 19.0, 39.0, -8.0, 0.0, 6.0, -23.0, 18.0, -3.0, 0.0, 8.0, -71.0, 0.0, 0.0, 0.0, -1.0, -5.0, 0.0, 36.0, 2.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -21.0, -21.0, -12.0, 0.0, 3.0, 0.0, 0.0, -16.0, 22.0, 0.0, 0.0, -18.0, -30.0, 0.0, -12.0, 0.0, -8.0, 0.0, 5.0, -18.0, 0.0, 0.0, 0.0, 0.0, -8.0, -40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 9.0, -34.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -40.0, -40.0, 0.0, 0.0, 0.0, -19.0, 0.0, -40.0, 2.0, -6.0, 0.0, 3.0, 0.0, -18.0, -2.0, -34.0, -24.0, -20.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, -22.0, 0.0, 0.0, -22.0, -2.0, 0.0, 0.0, -12.0, 0.0, 5.0, 4.0, -14.0, -18.0, 2.0, -4.0, 0.0, 0.0, -11.0, -48.0, 0.0, -28.0, -28.0, -4.0, -96.0, 0.0, -20.0, 0.0, 0.0, 0.0, -41.0, 0.0, -30.0, -30.0, 4.0, -28.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, -4.0, 19.0, 0.0, 0.0, -8.0, -16.0, -10.0, -22.0, -12.0, 0.0, -4.0, -20.0, -4.0, 0.0, -4.0, 3.0, 3.0, 0.0, -2.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 15.0, -16.0, -4.0, 0.0, 0.0, -20.0, 0.0, 8.0, -9.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, -16.0, 43.0, 0.0, -16.0, 0.0, 0.0, 6.0, 0.0, -20.0, -16.0, 18.0, 0.0, 0.0, -6.0, 0.0, 0.0, 8.0, 0.0, -27.0, -104.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, -10.0, 0.0, 0.0, 11.0, 19.0, 0.0, 2.0], "policy_predator_policy_reward": [0.0, 12.0, 3.0, 24.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 18.0, 6.0, 0.0, 0.0, 4.0, 0.0, 0.0, 8.0, 1.0, 0.0, 0.0, 4.0, 0.0, 12.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 2.0, 0.0, 14.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 20.0, 0.0, 0.0, 0.0, 11.0, 0.0, 23.0, 0.0, 0.0, 3.0, 0.0, 0.0, 12.0, 0.0, 22.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 13.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 26.0, 12.0, 13.0, 0.0, 15.0, 39.0, 19.0, 10.0, 5.0, 0.0, 0.0, 0.0, 26.0, 10.0, 29.0, 9.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 4.0, 8.0, 11.0, 5.0, 5.0, 2.0, 10.0, 0.0, 2.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 8.0, 2.0, 0.0, 0.0, 10.0, 0.0, 2.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 5.0, 7.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 60.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9137388575693433, "mean_inference_ms": 4.755858907894517, "mean_action_processing_ms": 1.0874310484136998, "mean_env_wait_ms": 0.6845866417818145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0295717716217041, "StateBufferConnector_ms": 0.0034540891647338867, "ViewRequirementAgentConnector_ms": 0.1712743043899536}, "num_episodes": 23, "episode_return_max": 39.0, "episode_return_min": -71.0, "episode_return_mean": -3.08, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 193.32353434427822, "num_env_steps_trained_throughput_per_sec": 193.32353434427822, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 20783.275, "restore_workers_time_ms": 0.023, "training_step_time_ms": 20783.204, "sample_time_ms": 3173.728, "learn_time_ms": 17573.516, "learn_throughput": 227.615, "synch_weights_time_ms": 28.443}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 28, "trial_id": "f6b99_00000", "date": "2024-08-13_19-55-29", "timestamp": 1723593329, "time_this_iter_s": 20.767458200454712, "time_total_s": 634.9151611328125, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6036430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 634.9151611328125, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 86.68275862068967, "ram_util_percent": 83.71034482758618}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7893527917761021, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.24222263184489395, "policy_loss": -0.005705450626001472, "vf_loss": 0.24759437132111833, "vf_explained_var": -0.013573877552829723, "kl": 0.00667420856344848, "entropy": 1.1378355822865924, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6357755766954845, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.22605135945491456, "policy_loss": -0.01825106693912179, "vf_loss": 0.2436074547722773, "vf_explained_var": -0.07824452402730467, "kl": 0.013899407302615241, "entropy": 1.1189662237015983, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 39.0, "episode_reward_min": -71.0, "episode_reward_mean": -2.85, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -104.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 43.0, "predator_policy": 60.0}, "policy_reward_mean": {"prey_policy": -5.19, "predator_policy": 3.765}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.0, -14.0, 0.0, 0.0, 0.0, -20.0, -20.0, 0.0, -8.0, -15.0, -3.0, 3.0, -8.0, -36.0, -9.0, 0.0, 8.0, 10.0, 0.0, 0.0, 17.0, 8.0, 0.0, -11.0, 0.0, -11.0, 0.0, -6.0, 9.0, -19.0, 0.0, 0.0, -33.0, -3.0, -17.0, -38.0, -5.0, 0.0, -15.0, -21.0, -6.0, 0.0, 0.0, 5.0, 17.0, 0.0, -12.0, -16.0, -5.0, -14.0, -2.0, 1.0, 3.0, -1.0, -6.0, 0.0, 15.0, -10.0, 0.0, -10.0, 23.0, 0.0, 0.0, 19.0, 39.0, -8.0, 0.0, 6.0, -23.0, 18.0, -3.0, 0.0, 8.0, -71.0, 0.0, 0.0, 0.0, -1.0, -5.0, 0.0, 36.0, 2.0, -4.0, 0.0, 6.0, -6.0, -28.0, 0.0, 0.0, 0.0, -2.0, -2.0, -11.0, -5.0, 17.0, 0.0, -27.0, 0.0, 7.0, 17.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 9.0, -34.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -40.0, -40.0, 0.0, 0.0, 0.0, -19.0, 0.0, -40.0, 2.0, -6.0, 0.0, 3.0, 0.0, -18.0, -2.0, -34.0, -24.0, -20.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, -22.0, 0.0, 0.0, -22.0, -2.0, 0.0, 0.0, -12.0, 0.0, 5.0, 4.0, -14.0, -18.0, 2.0, -4.0, 0.0, 0.0, -11.0, -48.0, 0.0, -28.0, -28.0, -4.0, -96.0, 0.0, -20.0, 0.0, 0.0, 0.0, -41.0, 0.0, -30.0, -30.0, 4.0, -28.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, -4.0, 19.0, 0.0, 0.0, -8.0, -16.0, -10.0, -22.0, -12.0, 0.0, -4.0, -20.0, -4.0, 0.0, -4.0, 3.0, 3.0, 0.0, -2.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 15.0, -16.0, -4.0, 0.0, 0.0, -20.0, 0.0, 8.0, -9.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, -16.0, 43.0, 0.0, -16.0, 0.0, 0.0, 6.0, 0.0, -20.0, -16.0, 18.0, 0.0, 0.0, -6.0, 0.0, 0.0, 8.0, 0.0, -27.0, -104.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, -10.0, 0.0, 0.0, 11.0, 19.0, 0.0, 2.0, -8.0, 0.0, 0.0, 0.0, 6.0, 0.0, -2.0, -10.0, -67.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -4.0, 0.0, -14.0, 5.0, -22.0, -1.0, -10.0, 0.0, 17.0, 0.0, 0.0, 0.0, -27.0, -20.0, 0.0, 0.0, 7.0, 0.0, 0.0, -6.0], "policy_predator_policy_reward": [2.0, 0.0, 14.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 20.0, 0.0, 0.0, 0.0, 11.0, 0.0, 23.0, 0.0, 0.0, 3.0, 0.0, 0.0, 12.0, 0.0, 22.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 13.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 26.0, 12.0, 13.0, 0.0, 15.0, 39.0, 19.0, 10.0, 5.0, 0.0, 0.0, 0.0, 26.0, 10.0, 29.0, 9.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 4.0, 8.0, 11.0, 5.0, 5.0, 2.0, 10.0, 0.0, 2.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 8.0, 2.0, 0.0, 0.0, 10.0, 0.0, 2.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 5.0, 7.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 60.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 1.0, 5.0, 33.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 7.0, 0.0, 0.0, 12.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 9.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8825703090580561, "mean_inference_ms": 4.700052456897783, "mean_action_processing_ms": 1.1139376565798467, "mean_env_wait_ms": 0.6727090522341865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011685609817504883, "StateBufferConnector_ms": 0.00346982479095459, "ViewRequirementAgentConnector_ms": 0.1818099021911621}, "num_episodes": 18, "episode_return_max": 39.0, "episode_return_min": -71.0, "episode_return_mean": -2.85, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 214.37891960523456, "num_env_steps_trained_throughput_per_sec": 214.37891960523456, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 20476.773, "restore_workers_time_ms": 0.023, "training_step_time_ms": 20476.7, "sample_time_ms": 2925.925, "learn_time_ms": 17514.413, "learn_throughput": 228.383, "synch_weights_time_ms": 28.614}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 29, "trial_id": "f6b99_00000", "date": "2024-08-13_19-55-48", "timestamp": 1723593348, "time_this_iter_s": 18.7177472114563, "time_total_s": 653.6329083442688, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6053670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 653.6329083442688, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 82.48076923076923, "ram_util_percent": 83.52692307692307}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9406836385134036, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9672881382798392, "policy_loss": -0.01156978560660882, "vf_loss": 0.9781698261540402, "vf_explained_var": 0.0057148100837828624, "kl": 0.013761971242929416, "entropy": 1.105572747616541, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.120343868946903, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1499889440795101, "policy_loss": -0.009552054821326343, "vf_loss": 1.1590712602964786, "vf_explained_var": 0.09729744309470767, "kl": 0.009394723605398017, "entropy": 1.1008326703278477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 39.0, "episode_reward_min": -71.0, "episode_reward_mean": -1.74, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -104.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 43.0, "predator_policy": 60.0}, "policy_reward_mean": {"prey_policy": -4.61, "predator_policy": 3.74}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 17.0, 8.0, 0.0, -11.0, 0.0, -11.0, 0.0, -6.0, 9.0, -19.0, 0.0, 0.0, -33.0, -3.0, -17.0, -38.0, -5.0, 0.0, -15.0, -21.0, -6.0, 0.0, 0.0, 5.0, 17.0, 0.0, -12.0, -16.0, -5.0, -14.0, -2.0, 1.0, 3.0, -1.0, -6.0, 0.0, 15.0, -10.0, 0.0, -10.0, 23.0, 0.0, 0.0, 19.0, 39.0, -8.0, 0.0, 6.0, -23.0, 18.0, -3.0, 0.0, 8.0, -71.0, 0.0, 0.0, 0.0, -1.0, -5.0, 0.0, 36.0, 2.0, -4.0, 0.0, 6.0, -6.0, -28.0, 0.0, 0.0, 0.0, -2.0, -2.0, -11.0, -5.0, 17.0, 0.0, -27.0, 0.0, 7.0, 17.0, 0.0, -1.0, 0.0, 0.0, 6.0, 3.0, 0.0, 20.0, -12.0, -46.0, -12.0, 5.0, 33.0, 7.0, -1.0, 27.0, -10.0, -9.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, -22.0, 0.0, 0.0, -22.0, -2.0, 0.0, 0.0, -12.0, 0.0, 5.0, 4.0, -14.0, -18.0, 2.0, -4.0, 0.0, 0.0, -11.0, -48.0, 0.0, -28.0, -28.0, -4.0, -96.0, 0.0, -20.0, 0.0, 0.0, 0.0, -41.0, 0.0, -30.0, -30.0, 4.0, -28.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, -4.0, 19.0, 0.0, 0.0, -8.0, -16.0, -10.0, -22.0, -12.0, 0.0, -4.0, -20.0, -4.0, 0.0, -4.0, 3.0, 3.0, 0.0, -2.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 15.0, -16.0, -4.0, 0.0, 0.0, -20.0, 0.0, 8.0, -9.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, -16.0, 43.0, 0.0, -16.0, 0.0, 0.0, 6.0, 0.0, -20.0, -16.0, 18.0, 0.0, 0.0, -6.0, 0.0, 0.0, 8.0, 0.0, -27.0, -104.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, -10.0, 0.0, 0.0, 11.0, 19.0, 0.0, 2.0, -8.0, 0.0, 0.0, 0.0, 6.0, 0.0, -2.0, -10.0, -67.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -4.0, 0.0, -14.0, 5.0, -22.0, -1.0, -10.0, 0.0, 17.0, 0.0, 0.0, 0.0, -27.0, -20.0, 0.0, 0.0, 7.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, 0.0, -11.0, 0.0, 3.0, 0.0, 0.0, -14.0, 0.0, -24.0, 0.0, -16.0, -77.0, -12.0, -10.0, 5.0, 0.0, 33.0, 0.0, 10.0, -6.0, -2.0, 0.0, 27.0, 0.0, -22.0, 0.0, -18.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 4.0, 9.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 13.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 26.0, 12.0, 13.0, 0.0, 15.0, 39.0, 19.0, 10.0, 5.0, 0.0, 0.0, 0.0, 26.0, 10.0, 29.0, 9.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 4.0, 8.0, 11.0, 5.0, 5.0, 2.0, 10.0, 0.0, 2.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 8.0, 2.0, 0.0, 0.0, 10.0, 0.0, 2.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 5.0, 7.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 60.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 1.0, 5.0, 33.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 7.0, 0.0, 0.0, 12.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 9.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 12.0, 5.0, 0.0, 0.0, 0.0, 0.0, 17.0, 17.0, 12.0, 0.0, 39.0, 8.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 8.0, 4.0, 9.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8539656622792302, "mean_inference_ms": 4.64849512245203, "mean_action_processing_ms": 1.0932706902939762, "mean_env_wait_ms": 0.6614159670397082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018267512321472168, "StateBufferConnector_ms": 0.0035355091094970703, "ViewRequirementAgentConnector_ms": 0.1661437749862671}, "num_episodes": 18, "episode_return_max": 39.0, "episode_return_min": -71.0, "episode_return_mean": -1.74, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 195.41988602427782, "num_env_steps_trained_throughput_per_sec": 195.41988602427782, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 20551.53, "restore_workers_time_ms": 0.018, "training_step_time_ms": 20551.464, "sample_time_ms": 2946.976, "learn_time_ms": 17564.965, "learn_throughput": 227.726, "synch_weights_time_ms": 31.992}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 30, "trial_id": "f6b99_00000", "date": "2024-08-13_19-56-09", "timestamp": 1723593369, "time_this_iter_s": 20.54406499862671, "time_total_s": 674.1769733428955, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b604f280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 674.1769733428955, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 82.3551724137931, "ram_util_percent": 83.63793103448275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9811121491055009, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9620615759223857, "policy_loss": -0.012989298372268282, "vf_loss": 0.9744197731926327, "vf_explained_var": 0.00901966653172932, "kl": 0.012622004034558367, "entropy": 1.0193217210038, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0789091777706903, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4807945752427691, "policy_loss": -0.012379285312016253, "vf_loss": 1.4924874876226697, "vf_explained_var": 0.09747473272697005, "kl": 0.013727482086435195, "entropy": 1.0697918633304575, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 62.0, "episode_reward_min": -71.0, "episode_reward_mean": -1.93, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -115.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 43.0, "predator_policy": 60.0}, "policy_reward_mean": {"prey_policy": -5.95, "predator_policy": 4.985}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.0, 0.0, -15.0, -21.0, -6.0, 0.0, 0.0, 5.0, 17.0, 0.0, -12.0, -16.0, -5.0, -14.0, -2.0, 1.0, 3.0, -1.0, -6.0, 0.0, 15.0, -10.0, 0.0, -10.0, 23.0, 0.0, 0.0, 19.0, 39.0, -8.0, 0.0, 6.0, -23.0, 18.0, -3.0, 0.0, 8.0, -71.0, 0.0, 0.0, 0.0, -1.0, -5.0, 0.0, 36.0, 2.0, -4.0, 0.0, 6.0, -6.0, -28.0, 0.0, 0.0, 0.0, -2.0, -2.0, -11.0, -5.0, 17.0, 0.0, -27.0, 0.0, 7.0, 17.0, 0.0, -1.0, 0.0, 0.0, 6.0, 3.0, 0.0, 20.0, -12.0, -46.0, -12.0, 5.0, 33.0, 7.0, -1.0, 27.0, -10.0, -9.0, -16.0, 0.0, -40.0, -40.0, -10.0, -10.0, 62.0, -7.0, -7.0, 5.0, -3.0, -15.0, -10.0, 4.0, 6.0, -32.0, -10.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-20.0, 0.0, 0.0, 0.0, -41.0, 0.0, -30.0, -30.0, 4.0, -28.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, -4.0, 19.0, 0.0, 0.0, -8.0, -16.0, -10.0, -22.0, -12.0, 0.0, -4.0, -20.0, -4.0, 0.0, -4.0, 3.0, 3.0, 0.0, -2.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 15.0, -16.0, -4.0, 0.0, 0.0, -20.0, 0.0, 8.0, -9.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, -16.0, 43.0, 0.0, -16.0, 0.0, 0.0, 6.0, 0.0, -20.0, -16.0, 18.0, 0.0, 0.0, -6.0, 0.0, 0.0, 8.0, 0.0, -27.0, -104.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, -10.0, 0.0, 0.0, 11.0, 19.0, 0.0, 2.0, -8.0, 0.0, 0.0, 0.0, 6.0, 0.0, -2.0, -10.0, -67.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -4.0, 0.0, -14.0, 5.0, -22.0, -1.0, -10.0, 0.0, 17.0, 0.0, 0.0, 0.0, -27.0, -20.0, 0.0, 0.0, 7.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, 0.0, -11.0, 0.0, 3.0, 0.0, 0.0, -14.0, 0.0, -24.0, 0.0, -16.0, -77.0, -12.0, -10.0, 5.0, 0.0, 33.0, 0.0, 10.0, -6.0, -2.0, 0.0, 27.0, 0.0, -22.0, 0.0, -18.0, 0.0, -115.0, 0.0, 0.0, 0.0, -28.0, -46.0, -2.0, -80.0, 0.0, -20.0, 0.0, -23.0, -2.0, -23.0, 2.0, -20.0, 0.0, -14.0, 0.0, 5.0, 0.0, -12.0, -36.0, -10.0, 0.0, -26.0, -2.0, 0.0, -2.0, 7.0, -64.0, 0.0, -19.0, -11.0, 0.0, 0.0], "policy_predator_policy_reward": [10.0, 5.0, 0.0, 0.0, 0.0, 26.0, 10.0, 29.0, 9.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 4.0, 8.0, 11.0, 5.0, 5.0, 2.0, 10.0, 0.0, 2.0, 0.0, 0.0, 2.0, 0.0, 0.0, 1.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 8.0, 2.0, 0.0, 0.0, 10.0, 0.0, 2.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 5.0, 7.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 60.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 1.0, 5.0, 33.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 7.0, 0.0, 0.0, 12.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 9.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 12.0, 5.0, 0.0, 0.0, 0.0, 0.0, 17.0, 17.0, 12.0, 0.0, 39.0, 8.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 8.0, 4.0, 9.0, 0.0, 49.0, 50.0, 0.0, 0.0, 34.0, 0.0, 2.0, 40.0, 8.0, 2.0, 0.0, 13.0, 57.0, 30.0, 10.0, 1.0, 0.0, 7.0, 0.0, 0.0, 8.0, 1.0, 25.0, 6.0, 13.0, 3.0, 0.0, 6.0, 0.0, 1.0, 32.0, 0.0, 12.0, 8.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8272122975650649, "mean_inference_ms": 4.598663171740515, "mean_action_processing_ms": 1.071456885204274, "mean_env_wait_ms": 0.6511305603501344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017868518829345703, "StateBufferConnector_ms": 0.003610849380493164, "ViewRequirementAgentConnector_ms": 0.17749524116516113}, "num_episodes": 18, "episode_return_max": 62.0, "episode_return_min": -71.0, "episode_return_mean": -1.93, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 202.15297801048052, "num_env_steps_trained_throughput_per_sec": 202.15297801048052, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 20601.228, "restore_workers_time_ms": 0.019, "training_step_time_ms": 20601.162, "sample_time_ms": 2923.629, "learn_time_ms": 17640.134, "learn_throughput": 226.756, "synch_weights_time_ms": 30.989}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 31, "trial_id": "f6b99_00000", "date": "2024-08-13_19-56-28", "timestamp": 1723593388, "time_this_iter_s": 19.821151971817017, "time_total_s": 693.9981253147125, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b602f700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 693.9981253147125, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 83.92857142857142, "ram_util_percent": 83.58928571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.079087530305146, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5767887882454685, "policy_loss": -0.008309439847137404, "vf_loss": 3.5846206831553626, "vf_explained_var": 0.0025603729581076, "kl": 0.00955115766126871, "entropy": 0.9561321281566821, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0801216444010457, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9812747163747355, "policy_loss": -0.009792282478391099, "vf_loss": 2.9902739656665336, "vf_explained_var": 0.05124246837600829, "kl": 0.015860643915710976, "entropy": 1.1704685212443116, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 114.0, "episode_reward_min": -259.0, "episode_reward_mean": -4.98, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -312.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 104.0, "predator_policy": 133.0}, "policy_reward_mean": {"prey_policy": -12.225, "predator_policy": 9.735}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.0, 39.0, -8.0, 0.0, 6.0, -23.0, 18.0, -3.0, 0.0, 8.0, -71.0, 0.0, 0.0, 0.0, -1.0, -5.0, 0.0, 36.0, 2.0, -4.0, 0.0, 6.0, -6.0, -28.0, 0.0, 0.0, 0.0, -2.0, -2.0, -11.0, -5.0, 17.0, 0.0, -27.0, 0.0, 7.0, 17.0, 0.0, -1.0, 0.0, 0.0, 6.0, 3.0, 0.0, 20.0, -12.0, -46.0, -12.0, 5.0, 33.0, 7.0, -1.0, 27.0, -10.0, -9.0, -16.0, 0.0, -40.0, -40.0, -10.0, -10.0, 62.0, -7.0, -7.0, 5.0, -3.0, -15.0, -10.0, 4.0, 6.0, -32.0, -10.0, 0.0, -38.0, -53.0, 114.0, -12.0, 0.0, -35.0, 1.0, 43.0, -50.0, 58.0, -138.0, -20.0, -2.0, -7.0, -47.0, 113.0, 46.0, -259.0, -24.0, 32.0, -60.0, -19.0, 4.0, -12.0, 1.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.0, 0.0, -16.0, 43.0, 0.0, -16.0, 0.0, 0.0, 6.0, 0.0, -20.0, -16.0, 18.0, 0.0, 0.0, -6.0, 0.0, 0.0, 8.0, 0.0, -27.0, -104.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, -10.0, 0.0, 0.0, 11.0, 19.0, 0.0, 2.0, -8.0, 0.0, 0.0, 0.0, 6.0, 0.0, -2.0, -10.0, -67.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -4.0, 0.0, -14.0, 5.0, -22.0, -1.0, -10.0, 0.0, 17.0, 0.0, 0.0, 0.0, -27.0, -20.0, 0.0, 0.0, 7.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, 0.0, -11.0, 0.0, 3.0, 0.0, 0.0, -14.0, 0.0, -24.0, 0.0, -16.0, -77.0, -12.0, -10.0, 5.0, 0.0, 33.0, 0.0, 10.0, -6.0, -2.0, 0.0, 27.0, 0.0, -22.0, 0.0, -18.0, 0.0, -115.0, 0.0, 0.0, 0.0, -28.0, -46.0, -2.0, -80.0, 0.0, -20.0, 0.0, -23.0, -2.0, -23.0, 2.0, -20.0, 0.0, -14.0, 0.0, 5.0, 0.0, -12.0, -36.0, -10.0, 0.0, -26.0, -2.0, 0.0, -2.0, 7.0, -64.0, 0.0, -19.0, -11.0, 0.0, 0.0, -147.0, 29.0, -194.0, 0.0, 104.0, 0.0, 0.0, -24.0, 0.0, 0.0, 34.0, -138.0, 0.0, 0.0, 33.0, 10.0, -12.0, -88.0, 62.0, -39.0, -272.0, -4.0, 22.0, -158.0, -4.0, 0.0, 0.0, -26.0, 0.0, -104.0, 98.0, 0.0, 17.0, 0.0, -312.0, -124.0, 19.0, -86.0, 32.0, 0.0, 33.0, -186.0, -12.0, -36.0, -12.0, 1.0, 0.0, -24.0, 7.0, -14.0, 0.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 6.0, 5.0, 7.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 60.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 1.0, 5.0, 33.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 7.0, 0.0, 0.0, 12.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 9.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 12.0, 5.0, 0.0, 0.0, 0.0, 0.0, 17.0, 17.0, 12.0, 0.0, 39.0, 8.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 8.0, 4.0, 9.0, 0.0, 49.0, 50.0, 0.0, 0.0, 34.0, 0.0, 2.0, 40.0, 8.0, 2.0, 0.0, 13.0, 57.0, 30.0, 10.0, 1.0, 0.0, 7.0, 0.0, 0.0, 8.0, 1.0, 25.0, 6.0, 13.0, 3.0, 0.0, 6.0, 0.0, 1.0, 32.0, 0.0, 12.0, 8.0, 0.0, 0.0, 80.0, 0.0, 44.0, 97.0, 10.0, 0.0, 0.0, 12.0, 0.0, 0.0, 34.0, 35.0, 0.0, 1.0, 0.0, 0.0, 44.0, 6.0, 22.0, 13.0, 104.0, 34.0, 76.0, 40.0, 0.0, 2.0, 7.0, 12.0, 44.0, 13.0, 0.0, 15.0, 0.0, 29.0, 133.0, 44.0, 0.0, 43.0, 0.0, 0.0, 0.0, 93.0, 15.0, 14.0, 9.0, 6.0, 12.0, 0.0, 7.0, 1.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7808096925455306, "mean_inference_ms": 4.520172045957126, "mean_action_processing_ms": 1.0599484707022375, "mean_env_wait_ms": 0.6453567033571107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01630997657775879, "StateBufferConnector_ms": 0.0036951303482055664, "ViewRequirementAgentConnector_ms": 0.17054569721221924}, "num_episodes": 27, "episode_return_max": 114.0, "episode_return_min": -259.0, "episode_return_mean": -4.98, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.6145742530218, "num_env_steps_trained_throughput_per_sec": 210.6145742530218, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 20439.107, "restore_workers_time_ms": 0.02, "training_step_time_ms": 20439.039, "sample_time_ms": 2836.187, "learn_time_ms": 17571.899, "learn_throughput": 227.636, "synch_weights_time_ms": 25.162}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 32, "trial_id": "f6b99_00000", "date": "2024-08-13_19-56-48", "timestamp": 1723593408, "time_this_iter_s": 19.058088302612305, "time_total_s": 713.0562136173248, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6028670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 713.0562136173248, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 78.04814814814816, "ram_util_percent": 83.67037037037036}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9162520548023244, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.920988866324147, "policy_loss": -0.008149686395116741, "vf_loss": 2.9286605051585606, "vf_explained_var": 0.00018479433009233425, "kl": 0.009560941772364986, "entropy": 0.9672938848614062, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0923183775295024, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4720255582420916, "policy_loss": -0.01033872916343469, "vf_loss": 2.4815790020599566, "vf_explained_var": 0.058187155464969616, "kl": 0.01570570354057124, "entropy": 1.2176692594926823, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 114.0, "episode_reward_min": -259.0, "episode_reward_mean": -9.01, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -339.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 104.0, "predator_policy": 170.0}, "policy_reward_mean": {"prey_policy": -19.045, "predator_policy": 14.54}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, -4.0, 0.0, 6.0, -6.0, -28.0, 0.0, 0.0, 0.0, -2.0, -2.0, -11.0, -5.0, 17.0, 0.0, -27.0, 0.0, 7.0, 17.0, 0.0, -1.0, 0.0, 0.0, 6.0, 3.0, 0.0, 20.0, -12.0, -46.0, -12.0, 5.0, 33.0, 7.0, -1.0, 27.0, -10.0, -9.0, -16.0, 0.0, -40.0, -40.0, -10.0, -10.0, 62.0, -7.0, -7.0, 5.0, -3.0, -15.0, -10.0, 4.0, 6.0, -32.0, -10.0, 0.0, -38.0, -53.0, 114.0, -12.0, 0.0, -35.0, 1.0, 43.0, -50.0, 58.0, -138.0, -20.0, -2.0, -7.0, -47.0, 113.0, 46.0, -259.0, -24.0, 32.0, -60.0, -19.0, 4.0, -12.0, 1.0, 0.0, 0.0, -3.0, 0.0, -108.0, -37.0, 10.0, 0.0, 0.0, 0.0, 0.0, -186.0, -186.0, 29.0, 32.0, 4.0, 11.0, -2.0, 9.0, 39.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 2.0, -8.0, 0.0, 0.0, 0.0, 6.0, 0.0, -2.0, -10.0, -67.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -4.0, 0.0, -14.0, 5.0, -22.0, -1.0, -10.0, 0.0, 17.0, 0.0, 0.0, 0.0, -27.0, -20.0, 0.0, 0.0, 7.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, 0.0, -11.0, 0.0, 3.0, 0.0, 0.0, -14.0, 0.0, -24.0, 0.0, -16.0, -77.0, -12.0, -10.0, 5.0, 0.0, 33.0, 0.0, 10.0, -6.0, -2.0, 0.0, 27.0, 0.0, -22.0, 0.0, -18.0, 0.0, -115.0, 0.0, 0.0, 0.0, -28.0, -46.0, -2.0, -80.0, 0.0, -20.0, 0.0, -23.0, -2.0, -23.0, 2.0, -20.0, 0.0, -14.0, 0.0, 5.0, 0.0, -12.0, -36.0, -10.0, 0.0, -26.0, -2.0, 0.0, -2.0, 7.0, -64.0, 0.0, -19.0, -11.0, 0.0, 0.0, -147.0, 29.0, -194.0, 0.0, 104.0, 0.0, 0.0, -24.0, 0.0, 0.0, 34.0, -138.0, 0.0, 0.0, 33.0, 10.0, -12.0, -88.0, 62.0, -39.0, -272.0, -4.0, 22.0, -158.0, -4.0, 0.0, 0.0, -26.0, 0.0, -104.0, 98.0, 0.0, 17.0, 0.0, -312.0, -124.0, 19.0, -86.0, 32.0, 0.0, 33.0, -186.0, -12.0, -36.0, -12.0, 1.0, 0.0, -24.0, 7.0, -14.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, -339.0, 10.0, -90.0, 0.0, 1.0, -9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -158.0, -202.0, -160.0, -332.0, 29.0, 0.0, -132.0, 64.0, 4.0, -4.0, 32.0, -204.0, -15.0, 0.0, 0.0, 9.0, 0.0, 39.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 1.0, 5.0, 33.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 7.0, 0.0, 0.0, 12.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 9.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 12.0, 5.0, 0.0, 0.0, 0.0, 0.0, 17.0, 17.0, 12.0, 0.0, 39.0, 8.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 8.0, 4.0, 9.0, 0.0, 49.0, 50.0, 0.0, 0.0, 34.0, 0.0, 2.0, 40.0, 8.0, 2.0, 0.0, 13.0, 57.0, 30.0, 10.0, 1.0, 0.0, 7.0, 0.0, 0.0, 8.0, 1.0, 25.0, 6.0, 13.0, 3.0, 0.0, 6.0, 0.0, 1.0, 32.0, 0.0, 12.0, 8.0, 0.0, 0.0, 80.0, 0.0, 44.0, 97.0, 10.0, 0.0, 0.0, 12.0, 0.0, 0.0, 34.0, 35.0, 0.0, 1.0, 0.0, 0.0, 44.0, 6.0, 22.0, 13.0, 104.0, 34.0, 76.0, 40.0, 0.0, 2.0, 7.0, 12.0, 44.0, 13.0, 0.0, 15.0, 0.0, 29.0, 133.0, 44.0, 0.0, 43.0, 0.0, 0.0, 0.0, 93.0, 15.0, 14.0, 9.0, 6.0, 12.0, 0.0, 7.0, 1.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 151.0, 70.0, 45.0, 8.0, 0.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 57.0, 117.0, 170.0, 136.0, 0.0, 0.0, 32.0, 68.0, 2.0, 2.0, 83.0, 100.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.76847779352293, "mean_inference_ms": 4.486926575970392, "mean_action_processing_ms": 1.0234618563403557, "mean_env_wait_ms": 0.6284421018243267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014063358306884766, "StateBufferConnector_ms": 0.00451505184173584, "ViewRequirementAgentConnector_ms": 0.17591381072998047}, "num_episodes": 18, "episode_return_max": 114.0, "episode_return_min": -259.0, "episode_return_mean": -9.01, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 204.34244205111375, "num_env_steps_trained_throughput_per_sec": 204.34244205111375, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 20120.249, "restore_workers_time_ms": 0.02, "training_step_time_ms": 20120.181, "sample_time_ms": 2605.647, "learn_time_ms": 17483.918, "learn_throughput": 228.782, "synch_weights_time_ms": 25.78}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 33, "trial_id": "f6b99_00000", "date": "2024-08-13_19-57-07", "timestamp": 1723593427, "time_this_iter_s": 19.616715908050537, "time_total_s": 732.6729295253754, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b60533a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 732.6729295253754, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 81.28214285714286, "ram_util_percent": 83.55714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8593457297042564, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3535382553383157, "policy_loss": -0.008131776254860655, "vf_loss": 2.3611989339823447, "vf_explained_var": 0.002316876410176514, "kl": 0.009421924561802622, "entropy": 0.9844022554379922, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.235449960512459, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9541278342721324, "policy_loss": -0.01209324839791017, "vf_loss": 1.965748390823445, "vf_explained_var": 0.06112664241008658, "kl": 0.009453907510092025, "entropy": 1.209372215611594, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 124.0, "episode_reward_min": -259.0, "episode_reward_mean": -8.45, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -339.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 124.0, "predator_policy": 170.0}, "policy_reward_mean": {"prey_policy": -21.285, "predator_policy": 17.06}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.0, 0.0, -1.0, 0.0, 0.0, 6.0, 3.0, 0.0, 20.0, -12.0, -46.0, -12.0, 5.0, 33.0, 7.0, -1.0, 27.0, -10.0, -9.0, -16.0, 0.0, -40.0, -40.0, -10.0, -10.0, 62.0, -7.0, -7.0, 5.0, -3.0, -15.0, -10.0, 4.0, 6.0, -32.0, -10.0, 0.0, -38.0, -53.0, 114.0, -12.0, 0.0, -35.0, 1.0, 43.0, -50.0, 58.0, -138.0, -20.0, -2.0, -7.0, -47.0, 113.0, 46.0, -259.0, -24.0, 32.0, -60.0, -19.0, 4.0, -12.0, 1.0, 0.0, 0.0, -3.0, 0.0, -108.0, -37.0, 10.0, 0.0, 0.0, 0.0, 0.0, -186.0, -186.0, 29.0, 32.0, 4.0, 11.0, -2.0, 9.0, 39.0, -9.0, 0.0, -2.0, -103.0, 108.0, 0.0, 0.0, 2.0, 75.0, 0.0, -19.0, -5.0, -145.0, -4.0, 124.0, -36.0, 54.0, -37.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -6.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, 0.0, -11.0, 0.0, 3.0, 0.0, 0.0, -14.0, 0.0, -24.0, 0.0, -16.0, -77.0, -12.0, -10.0, 5.0, 0.0, 33.0, 0.0, 10.0, -6.0, -2.0, 0.0, 27.0, 0.0, -22.0, 0.0, -18.0, 0.0, -115.0, 0.0, 0.0, 0.0, -28.0, -46.0, -2.0, -80.0, 0.0, -20.0, 0.0, -23.0, -2.0, -23.0, 2.0, -20.0, 0.0, -14.0, 0.0, 5.0, 0.0, -12.0, -36.0, -10.0, 0.0, -26.0, -2.0, 0.0, -2.0, 7.0, -64.0, 0.0, -19.0, -11.0, 0.0, 0.0, -147.0, 29.0, -194.0, 0.0, 104.0, 0.0, 0.0, -24.0, 0.0, 0.0, 34.0, -138.0, 0.0, 0.0, 33.0, 10.0, -12.0, -88.0, 62.0, -39.0, -272.0, -4.0, 22.0, -158.0, -4.0, 0.0, 0.0, -26.0, 0.0, -104.0, 98.0, 0.0, 17.0, 0.0, -312.0, -124.0, 19.0, -86.0, 32.0, 0.0, 33.0, -186.0, -12.0, -36.0, -12.0, 1.0, 0.0, -24.0, 7.0, -14.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, -339.0, 10.0, -90.0, 0.0, 1.0, -9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -158.0, -202.0, -160.0, -332.0, 29.0, 0.0, -132.0, 64.0, 4.0, -4.0, 32.0, -204.0, -15.0, 0.0, 0.0, 9.0, 0.0, 39.0, -40.0, 0.0, 0.0, 0.0, -7.0, 0.0, -214.0, 0.0, 0.0, 108.0, 0.0, 0.0, 0.0, 0.0, -13.0, 0.0, 76.0, -2.0, 0.0, 0.0, -12.0, -68.0, -10.0, 0.0, 0.0, -299.0, 0.0, -8.0, 124.0, -14.0, -198.0, 15.0, 52.0, 0.0, -2.0, -84.0], "policy_predator_policy_reward": [14.0, 9.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 12.0, 5.0, 0.0, 0.0, 0.0, 0.0, 17.0, 17.0, 12.0, 0.0, 39.0, 8.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 8.0, 4.0, 9.0, 0.0, 49.0, 50.0, 0.0, 0.0, 34.0, 0.0, 2.0, 40.0, 8.0, 2.0, 0.0, 13.0, 57.0, 30.0, 10.0, 1.0, 0.0, 7.0, 0.0, 0.0, 8.0, 1.0, 25.0, 6.0, 13.0, 3.0, 0.0, 6.0, 0.0, 1.0, 32.0, 0.0, 12.0, 8.0, 0.0, 0.0, 80.0, 0.0, 44.0, 97.0, 10.0, 0.0, 0.0, 12.0, 0.0, 0.0, 34.0, 35.0, 0.0, 1.0, 0.0, 0.0, 44.0, 6.0, 22.0, 13.0, 104.0, 34.0, 76.0, 40.0, 0.0, 2.0, 7.0, 12.0, 44.0, 13.0, 0.0, 15.0, 0.0, 29.0, 133.0, 44.0, 0.0, 43.0, 0.0, 0.0, 0.0, 93.0, 15.0, 14.0, 9.0, 6.0, 12.0, 0.0, 7.0, 1.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 151.0, 70.0, 45.0, 8.0, 0.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 57.0, 117.0, 170.0, 136.0, 0.0, 0.0, 32.0, 68.0, 2.0, 2.0, 83.0, 100.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 18.0, 0.0, 0.0, 0.0, 5.0, 97.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 11.0, 0.0, 1.0, 0.0, 0.0, 25.0, 36.0, 0.0, 5.0, 116.0, 38.0, 0.0, 4.0, 7.0, 7.0, 78.0, 69.0, 2.0, 0.0, 31.0, 18.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7490498165166704, "mean_inference_ms": 4.45305519448671, "mean_action_processing_ms": 1.0064713802569905, "mean_env_wait_ms": 0.620713138287041, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013920068740844727, "StateBufferConnector_ms": 0.02680051326751709, "ViewRequirementAgentConnector_ms": 0.18676352500915527}, "num_episodes": 18, "episode_return_max": 124.0, "episode_return_min": -259.0, "episode_return_mean": -8.45, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 187.7264364339414, "num_env_steps_trained_throughput_per_sec": 187.7264364339414, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 20259.168, "restore_workers_time_ms": 0.019, "training_step_time_ms": 20259.102, "sample_time_ms": 2716.01, "learn_time_ms": 17512.817, "learn_throughput": 228.404, "synch_weights_time_ms": 25.639}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 34, "trial_id": "f6b99_00000", "date": "2024-08-13_19-57-29", "timestamp": 1723593449, "time_this_iter_s": 21.37273907661438, "time_total_s": 754.0456686019897, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b60a7700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 754.0456686019897, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 85.23666666666668, "ram_util_percent": 83.09333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9444627987013923, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2930850303677655, "policy_loss": -0.012088724514765163, "vf_loss": 1.3046941096347475, "vf_explained_var": 0.005524175381534314, "kl": 0.009592970650563087, "entropy": 0.996752333704126, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2373855270721295, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4143415051083716, "policy_loss": -0.006196437964016306, "vf_loss": 1.4203371932424564, "vf_explained_var": 0.2231150834964066, "kl": 0.004015035767467612, "entropy": 1.1938178809862288, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 128.0, "episode_reward_min": -259.0, "episode_reward_mean": -7.18, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -339.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 124.0, "predator_policy": 170.0}, "policy_reward_mean": {"prey_policy": -21.705, "predator_policy": 18.115}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.0, -16.0, 0.0, -40.0, -40.0, -10.0, -10.0, 62.0, -7.0, -7.0, 5.0, -3.0, -15.0, -10.0, 4.0, 6.0, -32.0, -10.0, 0.0, -38.0, -53.0, 114.0, -12.0, 0.0, -35.0, 1.0, 43.0, -50.0, 58.0, -138.0, -20.0, -2.0, -7.0, -47.0, 113.0, 46.0, -259.0, -24.0, 32.0, -60.0, -19.0, 4.0, -12.0, 1.0, 0.0, 0.0, -3.0, 0.0, -108.0, -37.0, 10.0, 0.0, 0.0, 0.0, 0.0, -186.0, -186.0, 29.0, 32.0, 4.0, 11.0, -2.0, 9.0, 39.0, -9.0, 0.0, -2.0, -103.0, 108.0, 0.0, 0.0, 2.0, 75.0, 0.0, -19.0, -5.0, -145.0, -4.0, 124.0, -36.0, 54.0, -37.0, -32.0, 16.0, 0.0, -3.0, 128.0, 0.0, -10.0, 5.0, 20.0, 0.0, 0.0, 33.0, -18.0, 86.0, -50.0, -23.0, 8.0, 3.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-18.0, 0.0, -115.0, 0.0, 0.0, 0.0, -28.0, -46.0, -2.0, -80.0, 0.0, -20.0, 0.0, -23.0, -2.0, -23.0, 2.0, -20.0, 0.0, -14.0, 0.0, 5.0, 0.0, -12.0, -36.0, -10.0, 0.0, -26.0, -2.0, 0.0, -2.0, 7.0, -64.0, 0.0, -19.0, -11.0, 0.0, 0.0, -147.0, 29.0, -194.0, 0.0, 104.0, 0.0, 0.0, -24.0, 0.0, 0.0, 34.0, -138.0, 0.0, 0.0, 33.0, 10.0, -12.0, -88.0, 62.0, -39.0, -272.0, -4.0, 22.0, -158.0, -4.0, 0.0, 0.0, -26.0, 0.0, -104.0, 98.0, 0.0, 17.0, 0.0, -312.0, -124.0, 19.0, -86.0, 32.0, 0.0, 33.0, -186.0, -12.0, -36.0, -12.0, 1.0, 0.0, -24.0, 7.0, -14.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, -339.0, 10.0, -90.0, 0.0, 1.0, -9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -158.0, -202.0, -160.0, -332.0, 29.0, 0.0, -132.0, 64.0, 4.0, -4.0, 32.0, -204.0, -15.0, 0.0, 0.0, 9.0, 0.0, 39.0, -40.0, 0.0, 0.0, 0.0, -7.0, 0.0, -214.0, 0.0, 0.0, 108.0, 0.0, 0.0, 0.0, 0.0, -13.0, 0.0, 76.0, -2.0, 0.0, 0.0, -12.0, -68.0, -10.0, 0.0, 0.0, -299.0, 0.0, -8.0, 124.0, -14.0, -198.0, 15.0, 52.0, 0.0, -2.0, -84.0, -97.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, -6.0, 118.0, 0.0, 0.0, 0.0, -8.0, -12.0, 0.0, 2.0, 27.0, -14.0, 0.0, 0.0, 0.0, 0.0, 33.0, 0.0, -14.0, -18.0, 29.0, 0.0, -100.0, 0.0, 24.0, -119.0, -14.0, -26.0, -8.0, -21.0], "policy_predator_policy_reward": [9.0, 0.0, 49.0, 50.0, 0.0, 0.0, 34.0, 0.0, 2.0, 40.0, 8.0, 2.0, 0.0, 13.0, 57.0, 30.0, 10.0, 1.0, 0.0, 7.0, 0.0, 0.0, 8.0, 1.0, 25.0, 6.0, 13.0, 3.0, 0.0, 6.0, 0.0, 1.0, 32.0, 0.0, 12.0, 8.0, 0.0, 0.0, 80.0, 0.0, 44.0, 97.0, 10.0, 0.0, 0.0, 12.0, 0.0, 0.0, 34.0, 35.0, 0.0, 1.0, 0.0, 0.0, 44.0, 6.0, 22.0, 13.0, 104.0, 34.0, 76.0, 40.0, 0.0, 2.0, 7.0, 12.0, 44.0, 13.0, 0.0, 15.0, 0.0, 29.0, 133.0, 44.0, 0.0, 43.0, 0.0, 0.0, 0.0, 93.0, 15.0, 14.0, 9.0, 6.0, 12.0, 0.0, 7.0, 1.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 151.0, 70.0, 45.0, 8.0, 0.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 57.0, 117.0, 170.0, 136.0, 0.0, 0.0, 32.0, 68.0, 2.0, 2.0, 83.0, 100.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 18.0, 0.0, 0.0, 0.0, 5.0, 97.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 11.0, 0.0, 1.0, 0.0, 0.0, 25.0, 36.0, 0.0, 5.0, 116.0, 38.0, 0.0, 4.0, 7.0, 7.0, 78.0, 69.0, 2.0, 0.0, 31.0, 18.0, 30.0, 35.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 1.0, 9.0, 0.0, 0.0, 0.0, 10.0, 3.0, 0.0, 6.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 57.0, 32.0, 18.0, 32.0, 40.0, 12.0, 36.0, 16.0, 16.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7299286240189666, "mean_inference_ms": 4.41994067170288, "mean_action_processing_ms": 0.9901973216394027, "mean_env_wait_ms": 0.6134120525099707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005356788635253906, "StateBufferConnector_ms": 0.026701807975769043, "ViewRequirementAgentConnector_ms": 0.18374764919281006}, "num_episodes": 18, "episode_return_max": 128.0, "episode_return_min": -259.0, "episode_return_mean": -7.18, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 217.3840472457289, "num_env_steps_trained_throughput_per_sec": 217.3840472457289, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 19653.482, "restore_workers_time_ms": 0.02, "training_step_time_ms": 19653.414, "sample_time_ms": 2370.416, "learn_time_ms": 17255.332, "learn_throughput": 231.812, "synch_weights_time_ms": 22.971}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 35, "trial_id": "f6b99_00000", "date": "2024-08-13_19-57-47", "timestamp": 1723593467, "time_this_iter_s": 18.459483861923218, "time_total_s": 772.505152463913, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6028f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 772.505152463913, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 81.48076923076923, "ram_util_percent": 83.61153846153846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0572091126883472, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.259198779403848, "policy_loss": -0.00945297040762232, "vf_loss": 1.2681627722486617, "vf_explained_var": 0.0014489206056746225, "kl": 0.009779566153484274, "entropy": 0.9740405446007139, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4523216917558952, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.68910671396861, "policy_loss": -0.007638159317577938, "vf_loss": 1.6965549905148765, "vf_explained_var": 0.2540200372536977, "kl": 0.007595226995781137, "entropy": 1.153737096685581, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 205.0, "episode_reward_min": -259.0, "episode_reward_mean": -2.07, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -339.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 142.0, "predator_policy": 170.0}, "policy_reward_mean": {"prey_policy": -17.7, "predator_policy": 16.665}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, 0.0, -35.0, 1.0, 43.0, -50.0, 58.0, -138.0, -20.0, -2.0, -7.0, -47.0, 113.0, 46.0, -259.0, -24.0, 32.0, -60.0, -19.0, 4.0, -12.0, 1.0, 0.0, 0.0, -3.0, 0.0, -108.0, -37.0, 10.0, 0.0, 0.0, 0.0, 0.0, -186.0, -186.0, 29.0, 32.0, 4.0, 11.0, -2.0, 9.0, 39.0, -9.0, 0.0, -2.0, -103.0, 108.0, 0.0, 0.0, 2.0, 75.0, 0.0, -19.0, -5.0, -145.0, -4.0, 124.0, -36.0, 54.0, -37.0, -32.0, 16.0, 0.0, -3.0, 128.0, 0.0, -10.0, 5.0, 20.0, 0.0, 0.0, 33.0, -18.0, 86.0, -50.0, -23.0, 8.0, 3.0, -26.0, 4.0, -6.0, 0.0, -5.0, 6.0, -4.0, 205.0, -3.0, 0.0, -2.0, -5.0, 40.0, 18.0, 96.0, -23.0, 0.0, 53.0, 2.0, 0.0, 57.0, -5.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -24.0, 0.0, 0.0, 34.0, -138.0, 0.0, 0.0, 33.0, 10.0, -12.0, -88.0, 62.0, -39.0, -272.0, -4.0, 22.0, -158.0, -4.0, 0.0, 0.0, -26.0, 0.0, -104.0, 98.0, 0.0, 17.0, 0.0, -312.0, -124.0, 19.0, -86.0, 32.0, 0.0, 33.0, -186.0, -12.0, -36.0, -12.0, 1.0, 0.0, -24.0, 7.0, -14.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, -339.0, 10.0, -90.0, 0.0, 1.0, -9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -158.0, -202.0, -160.0, -332.0, 29.0, 0.0, -132.0, 64.0, 4.0, -4.0, 32.0, -204.0, -15.0, 0.0, 0.0, 9.0, 0.0, 39.0, -40.0, 0.0, 0.0, 0.0, -7.0, 0.0, -214.0, 0.0, 0.0, 108.0, 0.0, 0.0, 0.0, 0.0, -13.0, 0.0, 76.0, -2.0, 0.0, 0.0, -12.0, -68.0, -10.0, 0.0, 0.0, -299.0, 0.0, -8.0, 124.0, -14.0, -198.0, 15.0, 52.0, 0.0, -2.0, -84.0, -97.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, -6.0, 118.0, 0.0, 0.0, 0.0, -8.0, -12.0, 0.0, 2.0, 27.0, -14.0, 0.0, 0.0, 0.0, 0.0, 33.0, 0.0, -14.0, -18.0, 29.0, 0.0, -100.0, 0.0, 24.0, -119.0, -14.0, -26.0, -8.0, -21.0, 0.0, -52.0, 4.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, -10.0, -6.0, 2.0, -8.0, 0.0, 142.0, 36.0, 0.0, -6.0, 0.0, 0.0, 0.0, -4.0, 0.0, -10.0, 0.0, -27.0, -26.0, -6.0, 99.0, -20.0, -50.0, 0.0, 0.0, 0.0, 95.0, -128.0, -19.0, 0.0, 0.0, 0.0, 52.0, 0.0, 0.0, -12.0], "policy_predator_policy_reward": [0.0, 12.0, 0.0, 0.0, 34.0, 35.0, 0.0, 1.0, 0.0, 0.0, 44.0, 6.0, 22.0, 13.0, 104.0, 34.0, 76.0, 40.0, 0.0, 2.0, 7.0, 12.0, 44.0, 13.0, 0.0, 15.0, 0.0, 29.0, 133.0, 44.0, 0.0, 43.0, 0.0, 0.0, 0.0, 93.0, 15.0, 14.0, 9.0, 6.0, 12.0, 0.0, 7.0, 1.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 151.0, 70.0, 45.0, 8.0, 0.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 57.0, 117.0, 170.0, 136.0, 0.0, 0.0, 32.0, 68.0, 2.0, 2.0, 83.0, 100.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 18.0, 0.0, 0.0, 0.0, 5.0, 97.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 11.0, 0.0, 1.0, 0.0, 0.0, 25.0, 36.0, 0.0, 5.0, 116.0, 38.0, 0.0, 4.0, 7.0, 7.0, 78.0, 69.0, 2.0, 0.0, 31.0, 18.0, 30.0, 35.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 1.0, 9.0, 0.0, 0.0, 0.0, 10.0, 3.0, 0.0, 6.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 57.0, 32.0, 18.0, 32.0, 40.0, 12.0, 36.0, 16.0, 16.0, 0.0, 26.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 0.0, 0.0, 10.0, 0.0, 4.0, 14.0, 13.0, 0.0, 3.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 38.0, 29.0, 40.0, 10.0, 17.0, 0.0, 15.0, 12.0, 0.0, 0.0, 70.0, 16.0, 0.0, 21.0, 0.0, 0.0, 5.0, 0.0, 1.0, 6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.710576918632736, "mean_inference_ms": 4.381308215652419, "mean_action_processing_ms": 0.979402569883756, "mean_env_wait_ms": 0.6072240789505036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03009331226348877, "StateBufferConnector_ms": 0.02670884132385254, "ViewRequirementAgentConnector_ms": 0.17583608627319336}, "num_episodes": 22, "episode_return_max": 205.0, "episode_return_min": -259.0, "episode_return_mean": -2.07, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 188.2707265199397, "num_env_steps_trained_throughput_per_sec": 188.2707265199397, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 19804.325, "restore_workers_time_ms": 0.019, "training_step_time_ms": 19804.262, "sample_time_ms": 2463.105, "learn_time_ms": 17313.72, "learn_throughput": 231.031, "synch_weights_time_ms": 23.219}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 36, "trial_id": "f6b99_00000", "date": "2024-08-13_19-58-09", "timestamp": 1723593489, "time_this_iter_s": 21.396939992904663, "time_total_s": 793.9020924568176, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b602f940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 793.9020924568176, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 85.73333333333333, "ram_util_percent": 83.62333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0197380807506975, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8695393144138276, "policy_loss": -0.009480347190909679, "vf_loss": 0.8785613422829007, "vf_explained_var": 0.01703975970152194, "kl": 0.009166392817362532, "entropy": 0.9150597525967492, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8279267226892804, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.677174308249559, "policy_loss": -0.005991746828812494, "vf_loss": 2.6826757828394574, "vf_explained_var": 0.4146381511890068, "kl": 0.019610879905720444, "entropy": 1.0544493658517404, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 230.0, "episode_reward_min": -186.0, "episode_reward_mean": 16.89, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -339.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 170.0}, "policy_reward_mean": {"prey_policy": -5.385, "predator_policy": 13.83}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -3.0, 0.0, -108.0, -37.0, 10.0, 0.0, 0.0, 0.0, 0.0, -186.0, -186.0, 29.0, 32.0, 4.0, 11.0, -2.0, 9.0, 39.0, -9.0, 0.0, -2.0, -103.0, 108.0, 0.0, 0.0, 2.0, 75.0, 0.0, -19.0, -5.0, -145.0, -4.0, 124.0, -36.0, 54.0, -37.0, -32.0, 16.0, 0.0, -3.0, 128.0, 0.0, -10.0, 5.0, 20.0, 0.0, 0.0, 33.0, -18.0, 86.0, -50.0, -23.0, 8.0, 3.0, -26.0, 4.0, -6.0, 0.0, -5.0, 6.0, -4.0, 205.0, -3.0, 0.0, -2.0, -5.0, 40.0, 18.0, 96.0, -23.0, 0.0, 53.0, 2.0, 0.0, 57.0, -5.0, 0.0, 198.0, 87.0, -9.0, 217.0, -54.0, 95.0, -2.0, -13.0, 144.0, -5.0, 17.0, 115.0, 61.0, -13.0, 0.0, -2.0, 170.0, 108.0, 19.0, -38.0, 184.0, 230.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, -6.0, 0.0, 0.0, -339.0, 10.0, -90.0, 0.0, 1.0, -9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -158.0, -202.0, -160.0, -332.0, 29.0, 0.0, -132.0, 64.0, 4.0, -4.0, 32.0, -204.0, -15.0, 0.0, 0.0, 9.0, 0.0, 39.0, -40.0, 0.0, 0.0, 0.0, -7.0, 0.0, -214.0, 0.0, 0.0, 108.0, 0.0, 0.0, 0.0, 0.0, -13.0, 0.0, 76.0, -2.0, 0.0, 0.0, -12.0, -68.0, -10.0, 0.0, 0.0, -299.0, 0.0, -8.0, 124.0, -14.0, -198.0, 15.0, 52.0, 0.0, -2.0, -84.0, -97.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, -6.0, 118.0, 0.0, 0.0, 0.0, -8.0, -12.0, 0.0, 2.0, 27.0, -14.0, 0.0, 0.0, 0.0, 0.0, 33.0, 0.0, -14.0, -18.0, 29.0, 0.0, -100.0, 0.0, 24.0, -119.0, -14.0, -26.0, -8.0, -21.0, 0.0, -52.0, 4.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, -10.0, -6.0, 2.0, -8.0, 0.0, 142.0, 36.0, 0.0, -6.0, 0.0, 0.0, 0.0, -4.0, 0.0, -10.0, 0.0, -27.0, -26.0, -6.0, 99.0, -20.0, -50.0, 0.0, 0.0, 0.0, 95.0, -128.0, -19.0, 0.0, 0.0, 0.0, 52.0, 0.0, 0.0, -12.0, 0.0, 0.0, 197.0, 0.0, 10.0, 69.0, 0.0, -18.0, 200.0, 11.0, -94.0, -28.0, 0.0, 92.0, 0.0, -4.0, -126.0, 50.0, 129.0, 0.0, -22.0, 0.0, 0.0, -4.0, 0.0, 115.0, 22.0, 34.0, 0.0, -33.0, 0.0, 0.0, -4.0, 0.0, 0.0, 155.0, 15.0, 82.0, 19.0, 0.0, -72.0, -16.0, 155.0, -8.0, 30.0, 200.0], "policy_predator_policy_reward": [0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 151.0, 70.0, 45.0, 8.0, 0.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 57.0, 117.0, 170.0, 136.0, 0.0, 0.0, 32.0, 68.0, 2.0, 2.0, 83.0, 100.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 18.0, 0.0, 0.0, 0.0, 5.0, 97.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 11.0, 0.0, 1.0, 0.0, 0.0, 25.0, 36.0, 0.0, 5.0, 116.0, 38.0, 0.0, 4.0, 7.0, 7.0, 78.0, 69.0, 2.0, 0.0, 31.0, 18.0, 30.0, 35.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 1.0, 9.0, 0.0, 0.0, 0.0, 10.0, 3.0, 0.0, 6.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 57.0, 32.0, 18.0, 32.0, 40.0, 12.0, 36.0, 16.0, 16.0, 0.0, 26.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 0.0, 0.0, 10.0, 0.0, 4.0, 14.0, 13.0, 0.0, 3.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 38.0, 29.0, 40.0, 10.0, 17.0, 0.0, 15.0, 12.0, 0.0, 0.0, 70.0, 16.0, 0.0, 21.0, 0.0, 0.0, 5.0, 0.0, 1.0, 6.0, 0.0, 0.0, 1.0, 0.0, 0.0, 8.0, 0.0, 9.0, 0.0, 6.0, 22.0, 46.0, 3.0, 0.0, 2.0, 0.0, 63.0, 0.0, 8.0, 7.0, 8.0, 9.0, 9.0, 12.0, 0.0, 0.0, 0.0, 5.0, 16.0, 4.0, 0.0, 0.0, 0.0, 2.0, 15.0, 0.0, 11.0, 0.0, 0.0, 0.0, 25.0, 25.0, 11.0, 26.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6993762537221326, "mean_inference_ms": 4.370312757210805, "mean_action_processing_ms": 0.9572367820347079, "mean_env_wait_ms": 0.6003569888337302, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02990734577178955, "StateBufferConnector_ms": 0.026648283004760742, "ViewRequirementAgentConnector_ms": 0.20767486095428467}, "num_episodes": 23, "episode_return_max": 230.0, "episode_return_min": -186.0, "episode_return_mean": 16.89, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 183.11722406463116, "num_env_steps_trained_throughput_per_sec": 183.11722406463116, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 20097.029, "restore_workers_time_ms": 0.019, "training_step_time_ms": 20096.965, "sample_time_ms": 2587.243, "learn_time_ms": 17476.517, "learn_throughput": 228.879, "synch_weights_time_ms": 27.965}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 37, "trial_id": "f6b99_00000", "date": "2024-08-13_19-58-31", "timestamp": 1723593511, "time_this_iter_s": 21.946274042129517, "time_total_s": 815.8483664989471, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b604f0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 815.8483664989471, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 88.46451612903225, "ram_util_percent": 83.48064516129033}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.883031167941434, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7576401646332765, "policy_loss": -0.010203704745976856, "vf_loss": 0.7674102332462709, "vf_explained_var": 0.008051902907235281, "kl": 0.008672731853981791, "entropy": 0.9043956162122192, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6561149190027247, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.712394012786724, "policy_loss": -0.008204465062313137, "vf_loss": 2.720177850962947, "vf_explained_var": 0.4216493670271818, "kl": 0.016825379964479546, "entropy": 0.9872039611062045, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 230.0, "episode_reward_min": -145.0, "episode_reward_mean": 36.19, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -299.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 116.0}, "policy_reward_mean": {"prey_policy": 8.225, "predator_policy": 9.87}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.0, -9.0, 0.0, -2.0, -103.0, 108.0, 0.0, 0.0, 2.0, 75.0, 0.0, -19.0, -5.0, -145.0, -4.0, 124.0, -36.0, 54.0, -37.0, -32.0, 16.0, 0.0, -3.0, 128.0, 0.0, -10.0, 5.0, 20.0, 0.0, 0.0, 33.0, -18.0, 86.0, -50.0, -23.0, 8.0, 3.0, -26.0, 4.0, -6.0, 0.0, -5.0, 6.0, -4.0, 205.0, -3.0, 0.0, -2.0, -5.0, 40.0, 18.0, 96.0, -23.0, 0.0, 53.0, 2.0, 0.0, 57.0, -5.0, 0.0, 198.0, 87.0, -9.0, 217.0, -54.0, 95.0, -2.0, -13.0, 144.0, -5.0, 17.0, 115.0, 61.0, -13.0, 0.0, -2.0, 170.0, 108.0, 19.0, -38.0, 184.0, 230.0, 190.0, 99.0, 53.0, 17.0, 190.0, 94.0, 100.0, 52.0, 202.0, 87.0, 0.0, 198.0, 48.0, 0.0, 36.0, -11.0, 148.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 39.0, -40.0, 0.0, 0.0, 0.0, -7.0, 0.0, -214.0, 0.0, 0.0, 108.0, 0.0, 0.0, 0.0, 0.0, -13.0, 0.0, 76.0, -2.0, 0.0, 0.0, -12.0, -68.0, -10.0, 0.0, 0.0, -299.0, 0.0, -8.0, 124.0, -14.0, -198.0, 15.0, 52.0, 0.0, -2.0, -84.0, -97.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, -6.0, 118.0, 0.0, 0.0, 0.0, -8.0, -12.0, 0.0, 2.0, 27.0, -14.0, 0.0, 0.0, 0.0, 0.0, 33.0, 0.0, -14.0, -18.0, 29.0, 0.0, -100.0, 0.0, 24.0, -119.0, -14.0, -26.0, -8.0, -21.0, 0.0, -52.0, 4.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, -10.0, -6.0, 2.0, -8.0, 0.0, 142.0, 36.0, 0.0, -6.0, 0.0, 0.0, 0.0, -4.0, 0.0, -10.0, 0.0, -27.0, -26.0, -6.0, 99.0, -20.0, -50.0, 0.0, 0.0, 0.0, 95.0, -128.0, -19.0, 0.0, 0.0, 0.0, 52.0, 0.0, 0.0, -12.0, 0.0, 0.0, 197.0, 0.0, 10.0, 69.0, 0.0, -18.0, 200.0, 11.0, -94.0, -28.0, 0.0, 92.0, 0.0, -4.0, -126.0, 50.0, 129.0, 0.0, -22.0, 0.0, 0.0, -4.0, 0.0, 115.0, 22.0, 34.0, 0.0, -33.0, 0.0, 0.0, -4.0, 0.0, 0.0, 155.0, 15.0, 82.0, 19.0, 0.0, -72.0, -16.0, 155.0, -8.0, 30.0, 200.0, -2.0, 190.0, 96.0, 0.0, 4.0, 0.0, 13.0, -14.0, 0.0, 185.0, 58.0, -8.0, 26.0, 0.0, 52.0, 0.0, 149.0, 10.0, 41.0, 46.0, 0.0, 0.0, 0.0, 197.0, 25.0, 23.0, 0.0, 0.0, 0.0, 11.0, 0.0, -30.0, 20.0, 128.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 13.0, 18.0, 0.0, 0.0, 0.0, 5.0, 97.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 11.0, 0.0, 1.0, 0.0, 0.0, 25.0, 36.0, 0.0, 5.0, 116.0, 38.0, 0.0, 4.0, 7.0, 7.0, 78.0, 69.0, 2.0, 0.0, 31.0, 18.0, 30.0, 35.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 1.0, 9.0, 0.0, 0.0, 0.0, 10.0, 3.0, 0.0, 6.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 57.0, 32.0, 18.0, 32.0, 40.0, 12.0, 36.0, 16.0, 16.0, 0.0, 26.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 0.0, 0.0, 10.0, 0.0, 4.0, 14.0, 13.0, 0.0, 3.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 38.0, 29.0, 40.0, 10.0, 17.0, 0.0, 15.0, 12.0, 0.0, 0.0, 70.0, 16.0, 0.0, 21.0, 0.0, 0.0, 5.0, 0.0, 1.0, 6.0, 0.0, 0.0, 1.0, 0.0, 0.0, 8.0, 0.0, 9.0, 0.0, 6.0, 22.0, 46.0, 3.0, 0.0, 2.0, 0.0, 63.0, 0.0, 8.0, 7.0, 8.0, 9.0, 9.0, 12.0, 0.0, 0.0, 0.0, 5.0, 16.0, 4.0, 0.0, 0.0, 0.0, 2.0, 15.0, 0.0, 11.0, 0.0, 0.0, 0.0, 25.0, 25.0, 11.0, 26.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 43.0, 6.0, 0.0, 18.0, 5.0, 0.0, 20.0, 24.0, 36.0, 38.0, 0.0, 0.0, 28.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 25.0, 0.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6965753192745847, "mean_inference_ms": 4.372654850726713, "mean_action_processing_ms": 0.9480574996611653, "mean_env_wait_ms": 0.5976300039961825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02994704246520996, "StateBufferConnector_ms": 0.025806307792663574, "ViewRequirementAgentConnector_ms": 0.25769031047821045}, "num_episodes": 18, "episode_return_max": 230.0, "episode_return_min": -145.0, "episode_return_mean": 36.19, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 184.8164363049099, "num_env_steps_trained_throughput_per_sec": 184.8164363049099, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 20192.268, "restore_workers_time_ms": 0.019, "training_step_time_ms": 20192.206, "sample_time_ms": 2851.567, "learn_time_ms": 17307.122, "learn_throughput": 231.119, "synch_weights_time_ms": 28.58}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 38, "trial_id": "f6b99_00000", "date": "2024-08-13_19-58-52", "timestamp": 1723593532, "time_this_iter_s": 21.727346181869507, "time_total_s": 837.5757126808167, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6036430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 837.5757126808167, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 86.57419354838709, "ram_util_percent": 82.96451612903226}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1036131065516246, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6627884680001194, "policy_loss": -0.007399078694827579, "vf_loss": 0.6697503721193662, "vf_explained_var": 0.016835759934924897, "kl": 0.008743487909048598, "entropy": 0.9558810862599226, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.774812491230233, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2478795824858246, "policy_loss": -0.007297164719507453, "vf_loss": 3.254922223974157, "vf_explained_var": 0.4359330237542511, "kl": 0.01018081224362445, "entropy": 0.8982487628384243, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 308.0, "episode_reward_min": -54.0, "episode_reward_mean": 51.08, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -128.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 70.0}, "policy_reward_mean": {"prey_policy": 17.19, "predator_policy": 8.35}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-37.0, -32.0, 16.0, 0.0, -3.0, 128.0, 0.0, -10.0, 5.0, 20.0, 0.0, 0.0, 33.0, -18.0, 86.0, -50.0, -23.0, 8.0, 3.0, -26.0, 4.0, -6.0, 0.0, -5.0, 6.0, -4.0, 205.0, -3.0, 0.0, -2.0, -5.0, 40.0, 18.0, 96.0, -23.0, 0.0, 53.0, 2.0, 0.0, 57.0, -5.0, 0.0, 198.0, 87.0, -9.0, 217.0, -54.0, 95.0, -2.0, -13.0, 144.0, -5.0, 17.0, 115.0, 61.0, -13.0, 0.0, -2.0, 170.0, 108.0, 19.0, -38.0, 184.0, 230.0, 190.0, 99.0, 53.0, 17.0, 190.0, 94.0, 100.0, 52.0, 202.0, 87.0, 0.0, 198.0, 48.0, 0.0, 36.0, -11.0, 148.0, 0.0, -7.0, -7.0, 75.0, 232.0, -15.0, 0.0, 0.0, -19.0, 0.0, 151.0, 191.0, 308.0, 205.0, 124.0, 0.0, 187.0, 0.0, 143.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.0, -84.0, -97.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, -6.0, 118.0, 0.0, 0.0, 0.0, -8.0, -12.0, 0.0, 2.0, 27.0, -14.0, 0.0, 0.0, 0.0, 0.0, 33.0, 0.0, -14.0, -18.0, 29.0, 0.0, -100.0, 0.0, 24.0, -119.0, -14.0, -26.0, -8.0, -21.0, 0.0, -52.0, 4.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, -10.0, -6.0, 2.0, -8.0, 0.0, 142.0, 36.0, 0.0, -6.0, 0.0, 0.0, 0.0, -4.0, 0.0, -10.0, 0.0, -27.0, -26.0, -6.0, 99.0, -20.0, -50.0, 0.0, 0.0, 0.0, 95.0, -128.0, -19.0, 0.0, 0.0, 0.0, 52.0, 0.0, 0.0, -12.0, 0.0, 0.0, 197.0, 0.0, 10.0, 69.0, 0.0, -18.0, 200.0, 11.0, -94.0, -28.0, 0.0, 92.0, 0.0, -4.0, -126.0, 50.0, 129.0, 0.0, -22.0, 0.0, 0.0, -4.0, 0.0, 115.0, 22.0, 34.0, 0.0, -33.0, 0.0, 0.0, -4.0, 0.0, 0.0, 155.0, 15.0, 82.0, 19.0, 0.0, -72.0, -16.0, 155.0, -8.0, 30.0, 200.0, -2.0, 190.0, 96.0, 0.0, 4.0, 0.0, 13.0, -14.0, 0.0, 185.0, 58.0, -8.0, 26.0, 0.0, 52.0, 0.0, 149.0, 10.0, 41.0, 46.0, 0.0, 0.0, 0.0, 197.0, 25.0, 23.0, 0.0, 0.0, 0.0, 11.0, 0.0, -30.0, 20.0, 128.0, 0.0, 0.0, -40.0, 0.0, -14.0, 0.0, 56.0, 0.0, 66.0, 135.0, -12.0, -10.0, 0.0, 0.0, 0.0, 0.0, -20.0, -18.0, 0.0, 0.0, 0.0, 128.0, 196.0, -10.0, 124.0, 152.0, 21.0, 168.0, 0.0, 95.0, 0.0, 0.0, 95.0, 67.0, 0.0, 0.0, 0.0, 143.0], "policy_predator_policy_reward": [31.0, 18.0, 30.0, 35.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 1.0, 9.0, 0.0, 0.0, 0.0, 10.0, 3.0, 0.0, 6.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 57.0, 32.0, 18.0, 32.0, 40.0, 12.0, 36.0, 16.0, 16.0, 0.0, 26.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 0.0, 0.0, 10.0, 0.0, 4.0, 14.0, 13.0, 0.0, 3.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 38.0, 29.0, 40.0, 10.0, 17.0, 0.0, 15.0, 12.0, 0.0, 0.0, 70.0, 16.0, 0.0, 21.0, 0.0, 0.0, 5.0, 0.0, 1.0, 6.0, 0.0, 0.0, 1.0, 0.0, 0.0, 8.0, 0.0, 9.0, 0.0, 6.0, 22.0, 46.0, 3.0, 0.0, 2.0, 0.0, 63.0, 0.0, 8.0, 7.0, 8.0, 9.0, 9.0, 12.0, 0.0, 0.0, 0.0, 5.0, 16.0, 4.0, 0.0, 0.0, 0.0, 2.0, 15.0, 0.0, 11.0, 0.0, 0.0, 0.0, 25.0, 25.0, 11.0, 26.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 43.0, 6.0, 0.0, 18.0, 5.0, 0.0, 20.0, 24.0, 36.0, 38.0, 0.0, 0.0, 28.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 25.0, 0.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 21.0, 12.0, 0.0, 7.0, 9.0, 10.0, 16.0, 15.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 9.0, 10.0, 0.0, 0.0, 23.0, 0.0, 0.0, 5.0, 17.0, 15.0, 7.0, 9.0, 29.0, 0.0, 0.0, 0.0, 12.0, 13.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6933439860939954, "mean_inference_ms": 4.373417125468686, "mean_action_processing_ms": 0.9390847195622968, "mean_env_wait_ms": 0.5952850967194611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02987492084503174, "StateBufferConnector_ms": 0.010405898094177246, "ViewRequirementAgentConnector_ms": 0.2824658155441284}, "num_episodes": 18, "episode_return_max": 308.0, "episode_return_min": -54.0, "episode_return_mean": 51.08, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 162.06130281796703, "num_env_steps_trained_throughput_per_sec": 162.06130281796703, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 20794.615, "restore_workers_time_ms": 0.019, "training_step_time_ms": 20794.554, "sample_time_ms": 2921.816, "learn_time_ms": 17839.586, "learn_throughput": 224.22, "synch_weights_time_ms": 28.491}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 39, "trial_id": "f6b99_00000", "date": "2024-08-13_19-59-17", "timestamp": 1723593557, "time_this_iter_s": 24.756069898605347, "time_total_s": 862.331782579422, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6050310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 862.331782579422, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 87.58, "ram_util_percent": 82.92857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1055803370381159, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1002654753664813, "policy_loss": -0.009178908158059197, "vf_loss": 1.1089258094470968, "vf_explained_var": 0.017401920960693762, "kl": 0.010371440294221866, "entropy": 0.9230223860374834, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.955228076504652, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.215863929917573, "policy_loss": -0.0026847463241586136, "vf_loss": 3.218324347526308, "vf_explained_var": 0.381103666087307, "kl": 0.008973241722805803, "entropy": 0.7930211417889469, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 353.0, "episode_reward_min": -70.0, "episode_reward_mean": 67.15, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -205.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 123.0}, "policy_reward_mean": {"prey_policy": 24.91, "predator_policy": 8.665}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -5.0, 6.0, -4.0, 205.0, -3.0, 0.0, -2.0, -5.0, 40.0, 18.0, 96.0, -23.0, 0.0, 53.0, 2.0, 0.0, 57.0, -5.0, 0.0, 198.0, 87.0, -9.0, 217.0, -54.0, 95.0, -2.0, -13.0, 144.0, -5.0, 17.0, 115.0, 61.0, -13.0, 0.0, -2.0, 170.0, 108.0, 19.0, -38.0, 184.0, 230.0, 190.0, 99.0, 53.0, 17.0, 190.0, 94.0, 100.0, 52.0, 202.0, 87.0, 0.0, 198.0, 48.0, 0.0, 36.0, -11.0, 148.0, 0.0, -7.0, -7.0, 75.0, 232.0, -15.0, 0.0, 0.0, -19.0, 0.0, 151.0, 191.0, 308.0, 205.0, 124.0, 0.0, 187.0, 0.0, 143.0, 353.0, 169.0, 102.0, 0.0, 142.0, 23.0, 0.0, 0.0, -8.0, 40.0, 170.0, 127.0, 0.0, 0.0, 68.0, 133.0, 0.0, -70.0, 176.0, 116.0, 175.0, -11.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, -10.0, -6.0, 2.0, -8.0, 0.0, 142.0, 36.0, 0.0, -6.0, 0.0, 0.0, 0.0, -4.0, 0.0, -10.0, 0.0, -27.0, -26.0, -6.0, 99.0, -20.0, -50.0, 0.0, 0.0, 0.0, 95.0, -128.0, -19.0, 0.0, 0.0, 0.0, 52.0, 0.0, 0.0, -12.0, 0.0, 0.0, 197.0, 0.0, 10.0, 69.0, 0.0, -18.0, 200.0, 11.0, -94.0, -28.0, 0.0, 92.0, 0.0, -4.0, -126.0, 50.0, 129.0, 0.0, -22.0, 0.0, 0.0, -4.0, 0.0, 115.0, 22.0, 34.0, 0.0, -33.0, 0.0, 0.0, -4.0, 0.0, 0.0, 155.0, 15.0, 82.0, 19.0, 0.0, -72.0, -16.0, 155.0, -8.0, 30.0, 200.0, -2.0, 190.0, 96.0, 0.0, 4.0, 0.0, 13.0, -14.0, 0.0, 185.0, 58.0, -8.0, 26.0, 0.0, 52.0, 0.0, 149.0, 10.0, 41.0, 46.0, 0.0, 0.0, 0.0, 197.0, 25.0, 23.0, 0.0, 0.0, 0.0, 11.0, 0.0, -30.0, 20.0, 128.0, 0.0, 0.0, -40.0, 0.0, -14.0, 0.0, 56.0, 0.0, 66.0, 135.0, -12.0, -10.0, 0.0, 0.0, 0.0, 0.0, -20.0, -18.0, 0.0, 0.0, 0.0, 128.0, 196.0, -10.0, 124.0, 152.0, 21.0, 168.0, 0.0, 95.0, 0.0, 0.0, 95.0, 67.0, 0.0, 0.0, 0.0, 143.0, 170.0, 167.0, 0.0, 159.0, 0.0, 96.0, 0.0, 0.0, 0.0, 113.0, -44.0, -18.0, 0.0, 0.0, 0.0, 0.0, 0.0, -16.0, 25.0, 0.0, 166.0, -14.0, 82.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 115.0, -10.0, 0.0, 0.0, -205.0, 0.0, 166.0, 0.0, 0.0, 74.0, 167.0, 8.0, -22.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 5.0, 0.0, 0.0, 10.0, 0.0, 4.0, 14.0, 13.0, 0.0, 3.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 38.0, 29.0, 40.0, 10.0, 17.0, 0.0, 15.0, 12.0, 0.0, 0.0, 70.0, 16.0, 0.0, 21.0, 0.0, 0.0, 5.0, 0.0, 1.0, 6.0, 0.0, 0.0, 1.0, 0.0, 0.0, 8.0, 0.0, 9.0, 0.0, 6.0, 22.0, 46.0, 3.0, 0.0, 2.0, 0.0, 63.0, 0.0, 8.0, 7.0, 8.0, 9.0, 9.0, 12.0, 0.0, 0.0, 0.0, 5.0, 16.0, 4.0, 0.0, 0.0, 0.0, 2.0, 15.0, 0.0, 11.0, 0.0, 0.0, 0.0, 25.0, 25.0, 11.0, 26.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 43.0, 6.0, 0.0, 18.0, 5.0, 0.0, 20.0, 24.0, 36.0, 38.0, 0.0, 0.0, 28.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 25.0, 0.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 21.0, 12.0, 0.0, 7.0, 9.0, 10.0, 16.0, 15.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 9.0, 10.0, 0.0, 0.0, 23.0, 0.0, 0.0, 5.0, 17.0, 15.0, 7.0, 9.0, 29.0, 0.0, 0.0, 0.0, 12.0, 13.0, 0.0, 0.0, 0.0, 0.0, 5.0, 11.0, 5.0, 5.0, 6.0, 0.0, 0.0, 0.0, 0.0, 29.0, 0.0, 85.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 4.0, 11.0, 11.0, 7.0, 0.0, 38.0, 0.0, 0.0, 0.0, 0.0, 4.0, 60.0, 5.0, 23.0, 0.0, 0.0, 123.0, 12.0, 4.0, 6.0, 0.0, 42.0, 0.0, 0.0, 0.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6906675538729332, "mean_inference_ms": 4.369857248188046, "mean_action_processing_ms": 0.93544033685621, "mean_env_wait_ms": 0.5939417929182353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029369831085205078, "StateBufferConnector_ms": 0.010369062423706055, "ViewRequirementAgentConnector_ms": 0.2915337085723877}, "num_episodes": 22, "episode_return_max": 353.0, "episode_return_min": -70.0, "episode_return_mean": 67.15, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.56846025041523, "num_env_steps_trained_throughput_per_sec": 210.56846025041523, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 20647.361, "restore_workers_time_ms": 0.02, "training_step_time_ms": 20647.298, "sample_time_ms": 2950.318, "learn_time_ms": 17667.828, "learn_throughput": 226.4, "synch_weights_time_ms": 24.89}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 40, "trial_id": "f6b99_00000", "date": "2024-08-13_19-59-36", "timestamp": 1723593576, "time_this_iter_s": 19.083157062530518, "time_total_s": 881.4149396419525, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b60a7af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 881.4149396419525, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 80.36666666666667, "ram_util_percent": 82.87777777777775}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.120911030100767, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1597820794140852, "policy_loss": -0.006769382380313738, "vf_loss": 1.1661155533538294, "vf_explained_var": 0.006715047201782307, "kl": 0.008718094198171437, "entropy": 0.9564747227878166, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4228853848087724, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7257205501435293, "policy_loss": -0.00519111950736414, "vf_loss": 3.7307240095088092, "vf_explained_var": 0.1260561365929861, "kl": 0.007506013815086213, "entropy": 0.9117886542958558, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 382.0, "episode_reward_min": -70.0, "episode_reward_mean": 83.04, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -280.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 166.0}, "policy_reward_mean": {"prey_policy": 31.73, "predator_policy": 9.79}, "custom_metrics": {}, "hist_stats": {"episode_reward": [217.0, -54.0, 95.0, -2.0, -13.0, 144.0, -5.0, 17.0, 115.0, 61.0, -13.0, 0.0, -2.0, 170.0, 108.0, 19.0, -38.0, 184.0, 230.0, 190.0, 99.0, 53.0, 17.0, 190.0, 94.0, 100.0, 52.0, 202.0, 87.0, 0.0, 198.0, 48.0, 0.0, 36.0, -11.0, 148.0, 0.0, -7.0, -7.0, 75.0, 232.0, -15.0, 0.0, 0.0, -19.0, 0.0, 151.0, 191.0, 308.0, 205.0, 124.0, 0.0, 187.0, 0.0, 143.0, 353.0, 169.0, 102.0, 0.0, 142.0, 23.0, 0.0, 0.0, -8.0, 40.0, 170.0, 127.0, 0.0, 0.0, 68.0, 133.0, 0.0, -70.0, 176.0, 116.0, 175.0, -11.0, 251.0, 13.0, 133.0, 176.0, 251.0, 13.0, 75.0, -11.0, 382.0, -7.0, 88.0, 0.0, 60.0, -22.0, 298.0, 34.0, 199.0, 0.0, 336.0, 55.0, -25.0, -4.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 11.0, -94.0, -28.0, 0.0, 92.0, 0.0, -4.0, -126.0, 50.0, 129.0, 0.0, -22.0, 0.0, 0.0, -4.0, 0.0, 115.0, 22.0, 34.0, 0.0, -33.0, 0.0, 0.0, -4.0, 0.0, 0.0, 155.0, 15.0, 82.0, 19.0, 0.0, -72.0, -16.0, 155.0, -8.0, 30.0, 200.0, -2.0, 190.0, 96.0, 0.0, 4.0, 0.0, 13.0, -14.0, 0.0, 185.0, 58.0, -8.0, 26.0, 0.0, 52.0, 0.0, 149.0, 10.0, 41.0, 46.0, 0.0, 0.0, 0.0, 197.0, 25.0, 23.0, 0.0, 0.0, 0.0, 11.0, 0.0, -30.0, 20.0, 128.0, 0.0, 0.0, -40.0, 0.0, -14.0, 0.0, 56.0, 0.0, 66.0, 135.0, -12.0, -10.0, 0.0, 0.0, 0.0, 0.0, -20.0, -18.0, 0.0, 0.0, 0.0, 128.0, 196.0, -10.0, 124.0, 152.0, 21.0, 168.0, 0.0, 95.0, 0.0, 0.0, 95.0, 67.0, 0.0, 0.0, 0.0, 143.0, 170.0, 167.0, 0.0, 159.0, 0.0, 96.0, 0.0, 0.0, 0.0, 113.0, -44.0, -18.0, 0.0, 0.0, 0.0, 0.0, 0.0, -16.0, 25.0, 0.0, 166.0, -14.0, 82.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 115.0, -10.0, 0.0, 0.0, -205.0, 0.0, 166.0, 0.0, 0.0, 74.0, 167.0, 8.0, -22.0, 0.0, 59.0, 192.0, 3.0, 0.0, -22.0, 76.0, 176.0, 0.0, 118.0, 129.0, 13.0, 0.0, -259.0, 181.0, 0.0, -22.0, 173.0, 200.0, -14.0, 0.0, 29.0, 59.0, 0.0, 0.0, 64.0, -8.0, -16.0, -85.0, 87.0, 200.0, -280.0, 140.0, 151.0, 45.0, 0.0, 0.0, 136.0, 200.0, -24.0, 67.0, -6.0, -38.0, 0.0, -8.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 6.0, 22.0, 46.0, 3.0, 0.0, 2.0, 0.0, 63.0, 0.0, 8.0, 7.0, 8.0, 9.0, 9.0, 12.0, 0.0, 0.0, 0.0, 5.0, 16.0, 4.0, 0.0, 0.0, 0.0, 2.0, 15.0, 0.0, 11.0, 0.0, 0.0, 0.0, 25.0, 25.0, 11.0, 26.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 43.0, 6.0, 0.0, 18.0, 5.0, 0.0, 20.0, 24.0, 36.0, 38.0, 0.0, 0.0, 28.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 25.0, 0.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 21.0, 12.0, 0.0, 7.0, 9.0, 10.0, 16.0, 15.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 9.0, 10.0, 0.0, 0.0, 23.0, 0.0, 0.0, 5.0, 17.0, 15.0, 7.0, 9.0, 29.0, 0.0, 0.0, 0.0, 12.0, 13.0, 0.0, 0.0, 0.0, 0.0, 5.0, 11.0, 5.0, 5.0, 6.0, 0.0, 0.0, 0.0, 0.0, 29.0, 0.0, 85.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 4.0, 11.0, 11.0, 7.0, 0.0, 38.0, 0.0, 0.0, 0.0, 0.0, 4.0, 60.0, 5.0, 23.0, 0.0, 0.0, 123.0, 12.0, 4.0, 6.0, 0.0, 42.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 8.0, 2.0, 79.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 153.0, 10.0, 1.0, 9.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 57.0, 22.0, 0.0, 11.0, 166.0, 8.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 19.0, 0.0, 4.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6899509508629778, "mean_inference_ms": 4.397219155221136, "mean_action_processing_ms": 0.9377856477370152, "mean_env_wait_ms": 0.6002117452143615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00515294075012207, "StateBufferConnector_ms": 0.010424613952636719, "ViewRequirementAgentConnector_ms": 0.3240652084350586}, "num_episodes": 23, "episode_return_max": 382.0, "episode_return_min": -70.0, "episode_return_mean": 83.04, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 148.10101971407786, "num_env_steps_trained_throughput_per_sec": 148.10101971407786, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 21369.52, "restore_workers_time_ms": 0.019, "training_step_time_ms": 21369.457, "sample_time_ms": 3329.866, "learn_time_ms": 18009.181, "learn_throughput": 222.109, "synch_weights_time_ms": 25.695}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 41, "trial_id": "f6b99_00000", "date": "2024-08-13_20-00-04", "timestamp": 1723593604, "time_this_iter_s": 27.111425638198853, "time_total_s": 908.5263652801514, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b324b940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 908.5263652801514, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 86.1657894736842, "ram_util_percent": 83.66842105263159}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0724032742636544, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6680108900423403, "policy_loss": -0.006998277734718704, "vf_loss": 1.6744894469856586, "vf_explained_var": 0.0063559201343980415, "kl": 0.010394399877609348, "entropy": 0.9892367141902763, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2130297642851633, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3217044385652694, "policy_loss": -0.003906741536594435, "vf_loss": 3.325453683182045, "vf_explained_var": 0.06582171771892165, "kl": 0.006300334779603863, "entropy": 0.9310597669510614, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 382.0, "episode_reward_min": -136.0, "episode_reward_mean": 84.05, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -349.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 168.0}, "policy_reward_mean": {"prey_policy": 29.655, "predator_policy": 12.37}, "custom_metrics": {}, "hist_stats": {"episode_reward": [230.0, 190.0, 99.0, 53.0, 17.0, 190.0, 94.0, 100.0, 52.0, 202.0, 87.0, 0.0, 198.0, 48.0, 0.0, 36.0, -11.0, 148.0, 0.0, -7.0, -7.0, 75.0, 232.0, -15.0, 0.0, 0.0, -19.0, 0.0, 151.0, 191.0, 308.0, 205.0, 124.0, 0.0, 187.0, 0.0, 143.0, 353.0, 169.0, 102.0, 0.0, 142.0, 23.0, 0.0, 0.0, -8.0, 40.0, 170.0, 127.0, 0.0, 0.0, 68.0, 133.0, 0.0, -70.0, 176.0, 116.0, 175.0, -11.0, 251.0, 13.0, 133.0, 176.0, 251.0, 13.0, 75.0, -11.0, 382.0, -7.0, 88.0, 0.0, 60.0, -22.0, 298.0, 34.0, 199.0, 0.0, 336.0, 55.0, -25.0, -4.0, 0.0, 200.0, 17.0, -58.0, 184.0, 0.0, -136.0, 52.0, 172.0, 45.0, 56.0, 134.0, 0.0, -3.0, 0.0, 177.0, 180.0, 62.0, 22.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [30.0, 200.0, -2.0, 190.0, 96.0, 0.0, 4.0, 0.0, 13.0, -14.0, 0.0, 185.0, 58.0, -8.0, 26.0, 0.0, 52.0, 0.0, 149.0, 10.0, 41.0, 46.0, 0.0, 0.0, 0.0, 197.0, 25.0, 23.0, 0.0, 0.0, 0.0, 11.0, 0.0, -30.0, 20.0, 128.0, 0.0, 0.0, -40.0, 0.0, -14.0, 0.0, 56.0, 0.0, 66.0, 135.0, -12.0, -10.0, 0.0, 0.0, 0.0, 0.0, -20.0, -18.0, 0.0, 0.0, 0.0, 128.0, 196.0, -10.0, 124.0, 152.0, 21.0, 168.0, 0.0, 95.0, 0.0, 0.0, 95.0, 67.0, 0.0, 0.0, 0.0, 143.0, 170.0, 167.0, 0.0, 159.0, 0.0, 96.0, 0.0, 0.0, 0.0, 113.0, -44.0, -18.0, 0.0, 0.0, 0.0, 0.0, 0.0, -16.0, 25.0, 0.0, 166.0, -14.0, 82.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 115.0, -10.0, 0.0, 0.0, -205.0, 0.0, 166.0, 0.0, 0.0, 74.0, 167.0, 8.0, -22.0, 0.0, 59.0, 192.0, 3.0, 0.0, -22.0, 76.0, 176.0, 0.0, 118.0, 129.0, 13.0, 0.0, -259.0, 181.0, 0.0, -22.0, 173.0, 200.0, -14.0, 0.0, 29.0, 59.0, 0.0, 0.0, 64.0, -8.0, -16.0, -85.0, 87.0, 200.0, -280.0, 140.0, 151.0, 45.0, 0.0, 0.0, 136.0, 200.0, -24.0, 67.0, -6.0, -38.0, 0.0, -8.0, 0.0, 0.0, 0.0, 200.0, 17.0, 0.0, 0.0, -158.0, 176.0, 0.0, 0.0, 0.0, 0.0, -304.0, 43.0, 0.0, -1.0, 146.0, 30.0, 0.0, 56.0, 0.0, -6.0, 76.0, 0.0, 0.0, -2.0, -2.0, 0.0, 0.0, 153.0, 0.0, -18.0, 187.0, -349.0, 112.0, -103.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 43.0, 6.0, 0.0, 18.0, 5.0, 0.0, 20.0, 24.0, 36.0, 38.0, 0.0, 0.0, 28.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 25.0, 0.0, 8.0, 11.0, 0.0, 0.0, 0.0, 0.0, 21.0, 12.0, 0.0, 7.0, 9.0, 10.0, 16.0, 15.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 9.0, 10.0, 0.0, 0.0, 23.0, 0.0, 0.0, 5.0, 17.0, 15.0, 7.0, 9.0, 29.0, 0.0, 0.0, 0.0, 12.0, 13.0, 0.0, 0.0, 0.0, 0.0, 5.0, 11.0, 5.0, 5.0, 6.0, 0.0, 0.0, 0.0, 0.0, 29.0, 0.0, 85.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 4.0, 11.0, 11.0, 7.0, 0.0, 38.0, 0.0, 0.0, 0.0, 0.0, 4.0, 60.0, 5.0, 23.0, 0.0, 0.0, 123.0, 12.0, 4.0, 6.0, 0.0, 42.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 8.0, 2.0, 79.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 153.0, 10.0, 1.0, 9.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 57.0, 22.0, 0.0, 11.0, 166.0, 8.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 19.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 99.0, 8.0, 0.0, 0.0, 0.0, 168.0, 0.0, 9.0, 0.0, 9.0, 18.0, 8.0, 7.0, 0.0, 0.0, 25.0, 39.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 11.0, 13.0, 0.0, 11.0, 159.0, 140.0, 76.0, 49.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.702999965562636, "mean_inference_ms": 4.435873099781, "mean_action_processing_ms": 0.9210794345259586, "mean_env_wait_ms": 0.5962106166936858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00617372989654541, "StateBufferConnector_ms": 0.010494351387023926, "ViewRequirementAgentConnector_ms": 0.3292574882507324}, "num_episodes": 18, "episode_return_max": 382.0, "episode_return_min": -136.0, "episode_return_mean": 84.05, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 149.93169067141, "num_env_steps_trained_throughput_per_sec": 149.93169067141, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 22138.197, "restore_workers_time_ms": 0.018, "training_step_time_ms": 22138.136, "sample_time_ms": 3588.725, "learn_time_ms": 18519.4, "learn_throughput": 215.99, "synch_weights_time_ms": 25.345}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 42, "trial_id": "f6b99_00000", "date": "2024-08-13_20-00-30", "timestamp": 1723593630, "time_this_iter_s": 26.77058696746826, "time_total_s": 935.2969522476196, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6053b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 935.2969522476196, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 92.31842105263159, "ram_util_percent": 84.02894736842104}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.961439229603167, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.608499760153117, "policy_loss": -0.005453133785101787, "vf_loss": 0.6135309589957749, "vf_explained_var": 0.00924220567657834, "kl": 0.008438715477548795, "entropy": 0.9991690747636967, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4695858352556432, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.615863273509596, "policy_loss": -0.005089403669443474, "vf_loss": 3.620692752404188, "vf_explained_var": 0.5421096140114718, "kl": 0.01039646612380065, "entropy": 0.9246503276168985, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 382.0, "episode_reward_min": -136.0, "episode_reward_mean": 85.87, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -349.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 168.0}, "policy_reward_mean": {"prey_policy": 30.195, "predator_policy": 12.74}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -7.0, -7.0, 75.0, 232.0, -15.0, 0.0, 0.0, -19.0, 0.0, 151.0, 191.0, 308.0, 205.0, 124.0, 0.0, 187.0, 0.0, 143.0, 353.0, 169.0, 102.0, 0.0, 142.0, 23.0, 0.0, 0.0, -8.0, 40.0, 170.0, 127.0, 0.0, 0.0, 68.0, 133.0, 0.0, -70.0, 176.0, 116.0, 175.0, -11.0, 251.0, 13.0, 133.0, 176.0, 251.0, 13.0, 75.0, -11.0, 382.0, -7.0, 88.0, 0.0, 60.0, -22.0, 298.0, 34.0, 199.0, 0.0, 336.0, 55.0, -25.0, -4.0, 0.0, 200.0, 17.0, -58.0, 184.0, 0.0, -136.0, 52.0, 172.0, 45.0, 56.0, 134.0, 0.0, -3.0, 0.0, 177.0, 180.0, 62.0, 22.0, 118.0, 168.0, 46.0, 170.0, 11.0, 318.0, -80.0, 143.0, 145.0, 0.0, -2.0, 0.0, 311.0, 200.0, 141.0, 51.0, 175.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -40.0, 0.0, -14.0, 0.0, 56.0, 0.0, 66.0, 135.0, -12.0, -10.0, 0.0, 0.0, 0.0, 0.0, -20.0, -18.0, 0.0, 0.0, 0.0, 128.0, 196.0, -10.0, 124.0, 152.0, 21.0, 168.0, 0.0, 95.0, 0.0, 0.0, 95.0, 67.0, 0.0, 0.0, 0.0, 143.0, 170.0, 167.0, 0.0, 159.0, 0.0, 96.0, 0.0, 0.0, 0.0, 113.0, -44.0, -18.0, 0.0, 0.0, 0.0, 0.0, 0.0, -16.0, 25.0, 0.0, 166.0, -14.0, 82.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 115.0, -10.0, 0.0, 0.0, -205.0, 0.0, 166.0, 0.0, 0.0, 74.0, 167.0, 8.0, -22.0, 0.0, 59.0, 192.0, 3.0, 0.0, -22.0, 76.0, 176.0, 0.0, 118.0, 129.0, 13.0, 0.0, -259.0, 181.0, 0.0, -22.0, 173.0, 200.0, -14.0, 0.0, 29.0, 59.0, 0.0, 0.0, 64.0, -8.0, -16.0, -85.0, 87.0, 200.0, -280.0, 140.0, 151.0, 45.0, 0.0, 0.0, 136.0, 200.0, -24.0, 67.0, -6.0, -38.0, 0.0, -8.0, 0.0, 0.0, 0.0, 200.0, 17.0, 0.0, 0.0, -158.0, 176.0, 0.0, 0.0, 0.0, 0.0, -304.0, 43.0, 0.0, -1.0, 146.0, 30.0, 0.0, 56.0, 0.0, -6.0, 76.0, 0.0, 0.0, -2.0, -2.0, 0.0, 0.0, 153.0, 0.0, -18.0, 187.0, -349.0, 112.0, -103.0, 0.0, 0.0, 84.0, 168.0, 0.0, 0.0, 25.0, 162.0, -2.0, -8.0, 15.0, 148.0, 152.0, 0.0, -211.0, 116.0, 0.0, 145.0, 0.0, 0.0, 0.0, 0.0, -4.0, 0.0, 0.0, 188.0, 105.0, 0.0, 200.0, -12.0, 139.0, -23.0, 0.0, 179.0, -8.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 21.0, 12.0, 0.0, 7.0, 9.0, 10.0, 16.0, 15.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 9.0, 10.0, 0.0, 0.0, 23.0, 0.0, 0.0, 5.0, 17.0, 15.0, 7.0, 9.0, 29.0, 0.0, 0.0, 0.0, 12.0, 13.0, 0.0, 0.0, 0.0, 0.0, 5.0, 11.0, 5.0, 5.0, 6.0, 0.0, 0.0, 0.0, 0.0, 29.0, 0.0, 85.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 4.0, 11.0, 11.0, 7.0, 0.0, 38.0, 0.0, 0.0, 0.0, 0.0, 4.0, 60.0, 5.0, 23.0, 0.0, 0.0, 123.0, 12.0, 4.0, 6.0, 0.0, 42.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 8.0, 2.0, 79.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 153.0, 10.0, 1.0, 9.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 57.0, 22.0, 0.0, 11.0, 166.0, 8.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 19.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 99.0, 8.0, 0.0, 0.0, 0.0, 168.0, 0.0, 9.0, 0.0, 9.0, 18.0, 8.0, 7.0, 0.0, 0.0, 25.0, 39.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 11.0, 13.0, 0.0, 11.0, 159.0, 140.0, 76.0, 49.0, 34.0, 0.0, 0.0, 0.0, 12.0, 9.0, 10.0, 0.0, 4.0, 0.0, 1.0, 17.0, 0.0, 131.0, 19.0, 8.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 7.0, 11.0, 0.0, 0.0, 8.0, 6.0, 0.0, 74.0, 4.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7037005418852749, "mean_inference_ms": 4.455457381585579, "mean_action_processing_ms": 0.915956724752928, "mean_env_wait_ms": 0.5971060788196726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006099224090576172, "StateBufferConnector_ms": 0.010889768600463867, "ViewRequirementAgentConnector_ms": 0.2937178611755371}, "num_episodes": 18, "episode_return_max": 382.0, "episode_return_min": -136.0, "episode_return_mean": 85.87, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 91.75024488474224, "num_env_steps_trained_throughput_per_sec": 91.75024488474224, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 24540.361, "restore_workers_time_ms": 0.018, "training_step_time_ms": 24540.299, "sample_time_ms": 3685.725, "learn_time_ms": 20823.043, "learn_throughput": 192.095, "synch_weights_time_ms": 27.144}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 43, "trial_id": "f6b99_00000", "date": "2024-08-13_20-01-14", "timestamp": 1723593674, "time_this_iter_s": 43.68546009063721, "time_total_s": 978.9824123382568, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6050550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 978.9824123382568, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 97.59016393442623, "ram_util_percent": 84.12459016393443}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1861062876761905, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5845580473148002, "policy_loss": -0.0057100939237951205, "vf_loss": 1.589840450078722, "vf_explained_var": 0.00914615102545925, "kl": 0.008553790809664431, "entropy": 0.9820372466687803, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5218359560089767, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6955379610969907, "policy_loss": -0.0037047649003200665, "vf_loss": 3.6991024477771983, "vf_explained_var": 0.2885134367400376, "kl": 0.005611483625749469, "entropy": 0.9566570114837122, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 382.0, "episode_reward_min": -136.0, "episode_reward_mean": 91.52, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -349.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 168.0}, "policy_reward_mean": {"prey_policy": 31.505, "predator_policy": 14.255}, "custom_metrics": {}, "hist_stats": {"episode_reward": [143.0, 353.0, 169.0, 102.0, 0.0, 142.0, 23.0, 0.0, 0.0, -8.0, 40.0, 170.0, 127.0, 0.0, 0.0, 68.0, 133.0, 0.0, -70.0, 176.0, 116.0, 175.0, -11.0, 251.0, 13.0, 133.0, 176.0, 251.0, 13.0, 75.0, -11.0, 382.0, -7.0, 88.0, 0.0, 60.0, -22.0, 298.0, 34.0, 199.0, 0.0, 336.0, 55.0, -25.0, -4.0, 0.0, 200.0, 17.0, -58.0, 184.0, 0.0, -136.0, 52.0, 172.0, 45.0, 56.0, 134.0, 0.0, -3.0, 0.0, 177.0, 180.0, 62.0, 22.0, 118.0, 168.0, 46.0, 170.0, 11.0, 318.0, -80.0, 143.0, 145.0, 0.0, -2.0, 0.0, 311.0, 200.0, 141.0, 51.0, 175.0, 0.0, 196.0, 22.0, 0.0, 311.0, 366.0, 184.0, 78.0, 0.0, 181.0, 76.0, 0.0, -35.0, 57.0, -25.0, 175.0, 156.0, -5.0, 253.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 143.0, 170.0, 167.0, 0.0, 159.0, 0.0, 96.0, 0.0, 0.0, 0.0, 113.0, -44.0, -18.0, 0.0, 0.0, 0.0, 0.0, 0.0, -16.0, 25.0, 0.0, 166.0, -14.0, 82.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 115.0, -10.0, 0.0, 0.0, -205.0, 0.0, 166.0, 0.0, 0.0, 74.0, 167.0, 8.0, -22.0, 0.0, 59.0, 192.0, 3.0, 0.0, -22.0, 76.0, 176.0, 0.0, 118.0, 129.0, 13.0, 0.0, -259.0, 181.0, 0.0, -22.0, 173.0, 200.0, -14.0, 0.0, 29.0, 59.0, 0.0, 0.0, 64.0, -8.0, -16.0, -85.0, 87.0, 200.0, -280.0, 140.0, 151.0, 45.0, 0.0, 0.0, 136.0, 200.0, -24.0, 67.0, -6.0, -38.0, 0.0, -8.0, 0.0, 0.0, 0.0, 200.0, 17.0, 0.0, 0.0, -158.0, 176.0, 0.0, 0.0, 0.0, 0.0, -304.0, 43.0, 0.0, -1.0, 146.0, 30.0, 0.0, 56.0, 0.0, -6.0, 76.0, 0.0, 0.0, -2.0, -2.0, 0.0, 0.0, 153.0, 0.0, -18.0, 187.0, -349.0, 112.0, -103.0, 0.0, 0.0, 84.0, 168.0, 0.0, 0.0, 25.0, 162.0, -2.0, -8.0, 15.0, 148.0, 152.0, 0.0, -211.0, 116.0, 0.0, 145.0, 0.0, 0.0, 0.0, 0.0, -4.0, 0.0, 0.0, 188.0, 105.0, 0.0, 200.0, -12.0, 139.0, -23.0, 0.0, 179.0, -8.0, 0.0, 0.0, 196.0, 0.0, 0.0, 22.0, 0.0, 0.0, 200.0, 111.0, 182.0, 176.0, 0.0, 179.0, 0.0, 70.0, 0.0, 0.0, 0.0, 175.0, 0.0, 7.0, 0.0, 0.0, -304.0, 101.0, 0.0, -12.0, -202.0, -8.0, 169.0, 0.0, -6.0, 159.0, -10.0, 0.0, 200.0, 36.0], "policy_predator_policy_reward": [0.0, 0.0, 5.0, 11.0, 5.0, 5.0, 6.0, 0.0, 0.0, 0.0, 0.0, 29.0, 0.0, 85.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 4.0, 11.0, 11.0, 7.0, 0.0, 38.0, 0.0, 0.0, 0.0, 0.0, 4.0, 60.0, 5.0, 23.0, 0.0, 0.0, 123.0, 12.0, 4.0, 6.0, 0.0, 42.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 8.0, 2.0, 79.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 153.0, 10.0, 1.0, 9.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 57.0, 22.0, 0.0, 11.0, 166.0, 8.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 19.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 99.0, 8.0, 0.0, 0.0, 0.0, 168.0, 0.0, 9.0, 0.0, 9.0, 18.0, 8.0, 7.0, 0.0, 0.0, 25.0, 39.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 11.0, 13.0, 0.0, 11.0, 159.0, 140.0, 76.0, 49.0, 34.0, 0.0, 0.0, 0.0, 12.0, 9.0, 10.0, 0.0, 4.0, 0.0, 1.0, 17.0, 0.0, 131.0, 19.0, 8.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 7.0, 11.0, 0.0, 0.0, 8.0, 6.0, 0.0, 74.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 5.0, 0.0, 8.0, 0.0, 0.0, 0.0, 6.0, 9.0, 60.0, 0.0, 0.0, 0.0, 168.0, 69.0, 0.0, 98.0, 87.0, 4.0, 2.0, 3.0, 0.0, 5.0, 0.0, 8.0, 9.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7053720604560039, "mean_inference_ms": 4.477702733149832, "mean_action_processing_ms": 0.9116236927746906, "mean_env_wait_ms": 0.5979538486162981, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006348252296447754, "StateBufferConnector_ms": 0.004440903663635254, "ViewRequirementAgentConnector_ms": 0.2934274673461914}, "num_episodes": 18, "episode_return_max": 382.0, "episode_return_min": -136.0, "episode_return_mean": 91.52, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.0674080173307, "num_env_steps_trained_throughput_per_sec": 154.0674080173307, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 25005.867, "restore_workers_time_ms": 0.018, "training_step_time_ms": 25005.804, "sample_time_ms": 3701.393, "learn_time_ms": 21272.3, "learn_throughput": 188.038, "synch_weights_time_ms": 26.747}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 44, "trial_id": "f6b99_00000", "date": "2024-08-13_20-01-40", "timestamp": 1723593700, "time_this_iter_s": 26.073402881622314, "time_total_s": 1005.0558152198792, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b602fc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1005.0558152198792, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 87.66756756756757, "ram_util_percent": 84.18378378378378}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3120397833446977, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.676183042828999, "policy_loss": -0.007090962795471703, "vf_loss": 2.6827409211920683, "vf_explained_var": 0.008389149740259484, "kl": 0.01066166254984979, "entropy": 0.9443307840950275, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.366939995749287, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.128886107162193, "policy_loss": -0.00854551481999575, "vf_loss": 5.137186151837546, "vf_explained_var": 0.07280190706883789, "kl": 0.009819436922525964, "entropy": 0.8702768642750998, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 394.0, "episode_reward_min": -136.0, "episode_reward_mean": 92.23, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -349.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 168.0}, "policy_reward_mean": {"prey_policy": 29.58, "predator_policy": 16.535}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.0, 251.0, 13.0, 133.0, 176.0, 251.0, 13.0, 75.0, -11.0, 382.0, -7.0, 88.0, 0.0, 60.0, -22.0, 298.0, 34.0, 199.0, 0.0, 336.0, 55.0, -25.0, -4.0, 0.0, 200.0, 17.0, -58.0, 184.0, 0.0, -136.0, 52.0, 172.0, 45.0, 56.0, 134.0, 0.0, -3.0, 0.0, 177.0, 180.0, 62.0, 22.0, 118.0, 168.0, 46.0, 170.0, 11.0, 318.0, -80.0, 143.0, 145.0, 0.0, -2.0, 0.0, 311.0, 200.0, 141.0, 51.0, 175.0, 0.0, 196.0, 22.0, 0.0, 311.0, 366.0, 184.0, 78.0, 0.0, 181.0, 76.0, 0.0, -35.0, 57.0, -25.0, 175.0, 156.0, -5.0, 253.0, 0.0, 262.0, 48.0, 184.0, 91.0, 45.0, -12.0, 290.0, -100.0, 83.0, 394.0, 131.0, 215.0, 0.0, 32.0, 0.0, 155.0, 4.0, -1.0, 119.0, -10.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-22.0, 0.0, 59.0, 192.0, 3.0, 0.0, -22.0, 76.0, 176.0, 0.0, 118.0, 129.0, 13.0, 0.0, -259.0, 181.0, 0.0, -22.0, 173.0, 200.0, -14.0, 0.0, 29.0, 59.0, 0.0, 0.0, 64.0, -8.0, -16.0, -85.0, 87.0, 200.0, -280.0, 140.0, 151.0, 45.0, 0.0, 0.0, 136.0, 200.0, -24.0, 67.0, -6.0, -38.0, 0.0, -8.0, 0.0, 0.0, 0.0, 200.0, 17.0, 0.0, 0.0, -158.0, 176.0, 0.0, 0.0, 0.0, 0.0, -304.0, 43.0, 0.0, -1.0, 146.0, 30.0, 0.0, 56.0, 0.0, -6.0, 76.0, 0.0, 0.0, -2.0, -2.0, 0.0, 0.0, 153.0, 0.0, -18.0, 187.0, -349.0, 112.0, -103.0, 0.0, 0.0, 84.0, 168.0, 0.0, 0.0, 25.0, 162.0, -2.0, -8.0, 15.0, 148.0, 152.0, 0.0, -211.0, 116.0, 0.0, 145.0, 0.0, 0.0, 0.0, 0.0, -4.0, 0.0, 0.0, 188.0, 105.0, 0.0, 200.0, -12.0, 139.0, -23.0, 0.0, 179.0, -8.0, 0.0, 0.0, 196.0, 0.0, 0.0, 22.0, 0.0, 0.0, 200.0, 111.0, 182.0, 176.0, 0.0, 179.0, 0.0, 70.0, 0.0, 0.0, 0.0, 175.0, 0.0, 7.0, 0.0, 0.0, -304.0, 101.0, 0.0, -12.0, -202.0, -8.0, 169.0, 0.0, -6.0, 159.0, -10.0, 0.0, 200.0, 36.0, 0.0, 0.0, 69.0, 155.0, -287.0, 172.0, 0.0, 184.0, 164.0, -168.0, -31.0, -2.0, 0.0, -24.0, 117.0, 146.0, -132.0, -64.0, 73.0, 0.0, 194.0, 200.0, 131.0, 0.0, 142.0, 8.0, 0.0, 0.0, 26.0, -145.0, 0.0, 0.0, 0.0, 147.0, 128.0, -300.0, 0.0, -2.0, 0.0, 119.0, -4.0, -46.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 11.0, 0.0, 0.0, 8.0, 2.0, 79.0, 0.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 0.0, 153.0, 10.0, 1.0, 9.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 57.0, 22.0, 0.0, 11.0, 166.0, 8.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 19.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 99.0, 8.0, 0.0, 0.0, 0.0, 168.0, 0.0, 9.0, 0.0, 9.0, 18.0, 8.0, 7.0, 0.0, 0.0, 25.0, 39.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 11.0, 13.0, 0.0, 11.0, 159.0, 140.0, 76.0, 49.0, 34.0, 0.0, 0.0, 0.0, 12.0, 9.0, 10.0, 0.0, 4.0, 0.0, 1.0, 17.0, 0.0, 131.0, 19.0, 8.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 7.0, 11.0, 0.0, 0.0, 8.0, 6.0, 0.0, 74.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 5.0, 0.0, 8.0, 0.0, 0.0, 0.0, 6.0, 9.0, 60.0, 0.0, 0.0, 0.0, 168.0, 69.0, 0.0, 98.0, 87.0, 4.0, 2.0, 3.0, 0.0, 5.0, 0.0, 8.0, 9.0, 0.0, 0.0, 0.0, 38.0, 2.0, 161.0, 0.0, 0.0, 95.0, 0.0, 0.0, 78.0, 0.0, 12.0, 11.0, 16.0, 96.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 1.0, 64.0, 0.0, 0.0, 95.0, 56.0, 0.0, 0.0, 8.0, 0.0, 23.0, 153.0, 1.0, 0.0, 0.0, 0.0, 8.0, 32.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7146934465546155, "mean_inference_ms": 4.527898475150265, "mean_action_processing_ms": 0.9096089648763156, "mean_env_wait_ms": 0.6013942546300977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008378982543945312, "StateBufferConnector_ms": 0.0064688920974731445, "ViewRequirementAgentConnector_ms": 0.3660893440246582}, "num_episodes": 22, "episode_return_max": 394.0, "episode_return_min": -136.0, "episode_return_mean": 92.23, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 131.186767924001, "num_env_steps_trained_throughput_per_sec": 131.186767924001, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 26214.892, "restore_workers_time_ms": 0.017, "training_step_time_ms": 26214.832, "sample_time_ms": 4127.705, "learn_time_ms": 22053.4, "learn_throughput": 181.378, "synch_weights_time_ms": 28.297}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 45, "trial_id": "f6b99_00000", "date": "2024-08-13_20-02-11", "timestamp": 1723593731, "time_this_iter_s": 30.54081392288208, "time_total_s": 1035.5966291427612, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b60a7f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1035.5966291427612, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 91.64186046511627, "ram_util_percent": 84.01627906976744}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.101909112898761, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9607183577680083, "policy_loss": -0.00563268381338468, "vf_loss": 0.9658513027208823, "vf_explained_var": 0.006740599397629026, "kl": 0.009994674091836112, "entropy": 0.972861312842243, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.706657606867886, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.100209082371343, "policy_loss": -0.005531099010086446, "vf_loss": 5.105224085232568, "vf_explained_var": 0.462318209397099, "kl": 0.020644114931782306, "entropy": 0.9335262708878391, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 394.0, "episode_reward_min": -136.0, "episode_reward_mean": 103.12, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -349.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 188.0}, "policy_reward_mean": {"prey_policy": 33.02, "predator_policy": 18.54}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 200.0, 17.0, -58.0, 184.0, 0.0, -136.0, 52.0, 172.0, 45.0, 56.0, 134.0, 0.0, -3.0, 0.0, 177.0, 180.0, 62.0, 22.0, 118.0, 168.0, 46.0, 170.0, 11.0, 318.0, -80.0, 143.0, 145.0, 0.0, -2.0, 0.0, 311.0, 200.0, 141.0, 51.0, 175.0, 0.0, 196.0, 22.0, 0.0, 311.0, 366.0, 184.0, 78.0, 0.0, 181.0, 76.0, 0.0, -35.0, 57.0, -25.0, 175.0, 156.0, -5.0, 253.0, 0.0, 262.0, 48.0, 184.0, 91.0, 45.0, -12.0, 290.0, -100.0, 83.0, 394.0, 131.0, 215.0, 0.0, 32.0, 0.0, 155.0, 4.0, -1.0, 119.0, -10.0, 0.0, 88.0, 277.0, 177.0, 177.0, 314.0, 268.0, 176.0, 183.0, -119.0, -121.0, 192.0, 99.0, 0.0, 0.0, 190.0, 130.0, 178.0, 98.0, 186.0, 180.0, 197.0, 327.0, 176.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 200.0, 17.0, 0.0, 0.0, -158.0, 176.0, 0.0, 0.0, 0.0, 0.0, -304.0, 43.0, 0.0, -1.0, 146.0, 30.0, 0.0, 56.0, 0.0, -6.0, 76.0, 0.0, 0.0, -2.0, -2.0, 0.0, 0.0, 153.0, 0.0, -18.0, 187.0, -349.0, 112.0, -103.0, 0.0, 0.0, 84.0, 168.0, 0.0, 0.0, 25.0, 162.0, -2.0, -8.0, 15.0, 148.0, 152.0, 0.0, -211.0, 116.0, 0.0, 145.0, 0.0, 0.0, 0.0, 0.0, -4.0, 0.0, 0.0, 188.0, 105.0, 0.0, 200.0, -12.0, 139.0, -23.0, 0.0, 179.0, -8.0, 0.0, 0.0, 196.0, 0.0, 0.0, 22.0, 0.0, 0.0, 200.0, 111.0, 182.0, 176.0, 0.0, 179.0, 0.0, 70.0, 0.0, 0.0, 0.0, 175.0, 0.0, 7.0, 0.0, 0.0, -304.0, 101.0, 0.0, -12.0, -202.0, -8.0, 169.0, 0.0, -6.0, 159.0, -10.0, 0.0, 200.0, 36.0, 0.0, 0.0, 69.0, 155.0, -287.0, 172.0, 0.0, 184.0, 164.0, -168.0, -31.0, -2.0, 0.0, -24.0, 117.0, 146.0, -132.0, -64.0, 73.0, 0.0, 194.0, 200.0, 131.0, 0.0, 142.0, 8.0, 0.0, 0.0, 26.0, -145.0, 0.0, 0.0, 0.0, 147.0, 128.0, -300.0, 0.0, -2.0, 0.0, 119.0, -4.0, -46.0, 0.0, 0.0, 76.0, 0.0, 127.0, 126.0, 0.0, 177.0, 177.0, 0.0, 162.0, 128.0, 149.0, 99.0, 164.0, 0.0, 0.0, 183.0, -349.0, -57.0, 0.0, -281.0, 0.0, 192.0, 57.0, 0.0, 0.0, 0.0, 0.0, 0.0, 189.0, -292.0, 0.0, 105.0, 172.0, -2.0, -20.0, 83.0, 170.0, 6.0, 177.0, -2.0, 0.0, 197.0, 117.0, 188.0, 164.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 99.0, 8.0, 0.0, 0.0, 0.0, 168.0, 0.0, 9.0, 0.0, 9.0, 18.0, 8.0, 7.0, 0.0, 0.0, 25.0, 39.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 11.0, 13.0, 0.0, 11.0, 159.0, 140.0, 76.0, 49.0, 34.0, 0.0, 0.0, 0.0, 12.0, 9.0, 10.0, 0.0, 4.0, 0.0, 1.0, 17.0, 0.0, 131.0, 19.0, 8.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 7.0, 11.0, 0.0, 0.0, 8.0, 6.0, 0.0, 74.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 5.0, 0.0, 8.0, 0.0, 0.0, 0.0, 6.0, 9.0, 60.0, 0.0, 0.0, 0.0, 168.0, 69.0, 0.0, 98.0, 87.0, 4.0, 2.0, 3.0, 0.0, 5.0, 0.0, 8.0, 9.0, 0.0, 0.0, 0.0, 38.0, 2.0, 161.0, 0.0, 0.0, 95.0, 0.0, 0.0, 78.0, 0.0, 12.0, 11.0, 16.0, 96.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 1.0, 64.0, 0.0, 0.0, 95.0, 56.0, 0.0, 0.0, 8.0, 0.0, 23.0, 153.0, 1.0, 0.0, 0.0, 0.0, 8.0, 32.0, 0.0, 0.0, 12.0, 0.0, 19.0, 5.0, 0.0, 0.0, 0.0, 0.0, 24.0, 0.0, 15.0, 5.0, 0.0, 12.0, 0.0, 0.0, 188.0, 99.0, 160.0, 0.0, 0.0, 0.0, 0.0, 42.0, 0.0, 0.0, 0.0, 0.0, 145.0, 148.0, 6.0, 19.0, 0.0, 8.0, 22.0, 13.0, 1.0, 9.0, 4.0, 1.0, 0.0, 0.0, 0.0, 22.0, 12.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7184103873159717, "mean_inference_ms": 4.56488840943695, "mean_action_processing_ms": 0.9045506126383482, "mean_env_wait_ms": 0.601822162506058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02454829216003418, "StateBufferConnector_ms": 0.0066280364990234375, "ViewRequirementAgentConnector_ms": 0.36500847339630127}, "num_episodes": 23, "episode_return_max": 394.0, "episode_return_min": -136.0, "episode_return_mean": 103.12, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 160.7416374394253, "num_env_steps_trained_throughput_per_sec": 160.7416374394253, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 26578.757, "restore_workers_time_ms": 0.017, "training_step_time_ms": 26578.697, "sample_time_ms": 4182.409, "learn_time_ms": 22362.847, "learn_throughput": 178.868, "synch_weights_time_ms": 27.881}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 46, "trial_id": "f6b99_00000", "date": "2024-08-13_20-02-36", "timestamp": 1723593756, "time_this_iter_s": 24.97073531150818, "time_total_s": 1060.5673644542694, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b60a7820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1060.5673644542694, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 91.54285714285714, "ram_util_percent": 83.88285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3302094624156044, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2803853168058648, "policy_loss": -0.006943247044981314, "vf_loss": 1.286839084256263, "vf_explained_var": 0.0077391971356023555, "kl": 0.00978955626248328, "entropy": 0.914687991142273, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.541503880421321, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.590010728533306, "policy_loss": -0.003957006518073656, "vf_loss": 6.593652970954855, "vf_explained_var": 0.4799944972865796, "kl": 0.008394075954173493, "entropy": 0.8179500134218307, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 394.0, "episode_reward_min": -121.0, "episode_reward_mean": 133.85, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -349.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 188.0}, "policy_reward_mean": {"prey_policy": 49.43, "predator_policy": 17.495}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.0, 118.0, 168.0, 46.0, 170.0, 11.0, 318.0, -80.0, 143.0, 145.0, 0.0, -2.0, 0.0, 311.0, 200.0, 141.0, 51.0, 175.0, 0.0, 196.0, 22.0, 0.0, 311.0, 366.0, 184.0, 78.0, 0.0, 181.0, 76.0, 0.0, -35.0, 57.0, -25.0, 175.0, 156.0, -5.0, 253.0, 0.0, 262.0, 48.0, 184.0, 91.0, 45.0, -12.0, 290.0, -100.0, 83.0, 394.0, 131.0, 215.0, 0.0, 32.0, 0.0, 155.0, 4.0, -1.0, 119.0, -10.0, 0.0, 88.0, 277.0, 177.0, 177.0, 314.0, 268.0, 176.0, 183.0, -119.0, -121.0, 192.0, 99.0, 0.0, 0.0, 190.0, 130.0, 178.0, 98.0, 186.0, 180.0, 197.0, 327.0, 176.0, 128.0, 71.0, 327.0, 146.0, 378.0, 380.0, 238.0, 343.0, 170.0, 370.0, 378.0, 388.0, -13.0, 380.0, -5.0, 0.0, 167.0, 309.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-103.0, 0.0, 0.0, 84.0, 168.0, 0.0, 0.0, 25.0, 162.0, -2.0, -8.0, 15.0, 148.0, 152.0, 0.0, -211.0, 116.0, 0.0, 145.0, 0.0, 0.0, 0.0, 0.0, -4.0, 0.0, 0.0, 188.0, 105.0, 0.0, 200.0, -12.0, 139.0, -23.0, 0.0, 179.0, -8.0, 0.0, 0.0, 196.0, 0.0, 0.0, 22.0, 0.0, 0.0, 200.0, 111.0, 182.0, 176.0, 0.0, 179.0, 0.0, 70.0, 0.0, 0.0, 0.0, 175.0, 0.0, 7.0, 0.0, 0.0, -304.0, 101.0, 0.0, -12.0, -202.0, -8.0, 169.0, 0.0, -6.0, 159.0, -10.0, 0.0, 200.0, 36.0, 0.0, 0.0, 69.0, 155.0, -287.0, 172.0, 0.0, 184.0, 164.0, -168.0, -31.0, -2.0, 0.0, -24.0, 117.0, 146.0, -132.0, -64.0, 73.0, 0.0, 194.0, 200.0, 131.0, 0.0, 142.0, 8.0, 0.0, 0.0, 26.0, -145.0, 0.0, 0.0, 0.0, 147.0, 128.0, -300.0, 0.0, -2.0, 0.0, 119.0, -4.0, -46.0, 0.0, 0.0, 76.0, 0.0, 127.0, 126.0, 0.0, 177.0, 177.0, 0.0, 162.0, 128.0, 149.0, 99.0, 164.0, 0.0, 0.0, 183.0, -349.0, -57.0, 0.0, -281.0, 0.0, 192.0, 57.0, 0.0, 0.0, 0.0, 0.0, 0.0, 189.0, -292.0, 0.0, 105.0, 172.0, -2.0, -20.0, 83.0, 170.0, 6.0, 177.0, -2.0, 0.0, 197.0, 117.0, 188.0, 164.0, 0.0, 0.0, 96.0, -297.0, 151.0, 175.0, 130.0, 139.0, -14.0, 182.0, 195.0, 180.0, 200.0, 62.0, 104.0, 153.0, 167.0, 156.0, 0.0, 157.0, 200.0, 192.0, 185.0, 184.0, 200.0, 0.0, -26.0, 200.0, 180.0, -10.0, 0.0, 0.0, 0.0, 152.0, 0.0, 128.0, 117.0], "policy_predator_policy_reward": [76.0, 49.0, 34.0, 0.0, 0.0, 0.0, 12.0, 9.0, 10.0, 0.0, 4.0, 0.0, 1.0, 17.0, 0.0, 131.0, 19.0, 8.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 7.0, 11.0, 0.0, 0.0, 8.0, 6.0, 0.0, 74.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 5.0, 0.0, 8.0, 0.0, 0.0, 0.0, 6.0, 9.0, 60.0, 0.0, 0.0, 0.0, 168.0, 69.0, 0.0, 98.0, 87.0, 4.0, 2.0, 3.0, 0.0, 5.0, 0.0, 8.0, 9.0, 0.0, 0.0, 0.0, 38.0, 2.0, 161.0, 0.0, 0.0, 95.0, 0.0, 0.0, 78.0, 0.0, 12.0, 11.0, 16.0, 96.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 1.0, 64.0, 0.0, 0.0, 95.0, 56.0, 0.0, 0.0, 8.0, 0.0, 23.0, 153.0, 1.0, 0.0, 0.0, 0.0, 8.0, 32.0, 0.0, 0.0, 12.0, 0.0, 19.0, 5.0, 0.0, 0.0, 0.0, 0.0, 24.0, 0.0, 15.0, 5.0, 0.0, 12.0, 0.0, 0.0, 188.0, 99.0, 160.0, 0.0, 0.0, 0.0, 0.0, 42.0, 0.0, 0.0, 0.0, 0.0, 145.0, 148.0, 6.0, 19.0, 0.0, 8.0, 22.0, 13.0, 1.0, 9.0, 4.0, 1.0, 0.0, 0.0, 0.0, 22.0, 12.0, 0.0, 0.0, 32.0, 68.0, 149.0, 11.0, 11.0, 14.0, 7.0, 1.0, 0.0, 0.0, 0.0, 71.0, 1.0, 5.0, 18.0, 0.0, 14.0, 13.0, 0.0, 1.0, 0.0, 0.0, 4.0, 0.0, 13.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 15.0, 0.0, 35.0, 29.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7195983084680153, "mean_inference_ms": 4.583896643509901, "mean_action_processing_ms": 0.9007078854054333, "mean_env_wait_ms": 0.6014722666490033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02483844757080078, "StateBufferConnector_ms": 0.006642699241638184, "ViewRequirementAgentConnector_ms": 0.3280951976776123}, "num_episodes": 18, "episode_return_max": 394.0, "episode_return_min": -121.0, "episode_return_mean": 133.85, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 166.24956666865646, "num_env_steps_trained_throughput_per_sec": 166.24956666865646, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 26800.385, "restore_workers_time_ms": 0.017, "training_step_time_ms": 26800.326, "sample_time_ms": 4199.297, "learn_time_ms": 22573.145, "learn_throughput": 177.202, "synch_weights_time_ms": 23.659}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 47, "trial_id": "f6b99_00000", "date": "2024-08-13_20-03-00", "timestamp": 1723593780, "time_this_iter_s": 24.108454942703247, "time_total_s": 1084.6758193969727, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b607e0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1084.6758193969727, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 89.08529411764705, "ram_util_percent": 80.11176470588235}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2616933314100145, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7458228017918016, "policy_loss": -0.006198145647621936, "vf_loss": 1.7514684792548891, "vf_explained_var": 0.010692768248300703, "kl": 0.011049279403739105, "entropy": 0.9061625576523876, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8320023000240324, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.804234875320757, "policy_loss": -0.003531037365633344, "vf_loss": 5.807499765466761, "vf_explained_var": 0.6083436693148638, "kl": 0.007096988626323974, "entropy": 0.8506987853025002, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 394.0, "episode_reward_min": -121.0, "episode_reward_mean": 149.89, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -349.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 188.0}, "policy_reward_mean": {"prey_policy": 57.525, "predator_policy": 17.42}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 196.0, 22.0, 0.0, 311.0, 366.0, 184.0, 78.0, 0.0, 181.0, 76.0, 0.0, -35.0, 57.0, -25.0, 175.0, 156.0, -5.0, 253.0, 0.0, 262.0, 48.0, 184.0, 91.0, 45.0, -12.0, 290.0, -100.0, 83.0, 394.0, 131.0, 215.0, 0.0, 32.0, 0.0, 155.0, 4.0, -1.0, 119.0, -10.0, 0.0, 88.0, 277.0, 177.0, 177.0, 314.0, 268.0, 176.0, 183.0, -119.0, -121.0, 192.0, 99.0, 0.0, 0.0, 190.0, 130.0, 178.0, 98.0, 186.0, 180.0, 197.0, 327.0, 176.0, 128.0, 71.0, 327.0, 146.0, 378.0, 380.0, 238.0, 343.0, 170.0, 370.0, 378.0, 388.0, -13.0, 380.0, -5.0, 0.0, 167.0, 309.0, 174.0, 181.0, 0.0, 385.0, 345.0, 200.0, 359.0, 173.0, 77.0, 0.0, 362.0, 85.0, 202.0, 236.0, 178.0, 159.0, 106.0, 319.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 196.0, 0.0, 0.0, 22.0, 0.0, 0.0, 200.0, 111.0, 182.0, 176.0, 0.0, 179.0, 0.0, 70.0, 0.0, 0.0, 0.0, 175.0, 0.0, 7.0, 0.0, 0.0, -304.0, 101.0, 0.0, -12.0, -202.0, -8.0, 169.0, 0.0, -6.0, 159.0, -10.0, 0.0, 200.0, 36.0, 0.0, 0.0, 69.0, 155.0, -287.0, 172.0, 0.0, 184.0, 164.0, -168.0, -31.0, -2.0, 0.0, -24.0, 117.0, 146.0, -132.0, -64.0, 73.0, 0.0, 194.0, 200.0, 131.0, 0.0, 142.0, 8.0, 0.0, 0.0, 26.0, -145.0, 0.0, 0.0, 0.0, 147.0, 128.0, -300.0, 0.0, -2.0, 0.0, 119.0, -4.0, -46.0, 0.0, 0.0, 76.0, 0.0, 127.0, 126.0, 0.0, 177.0, 177.0, 0.0, 162.0, 128.0, 149.0, 99.0, 164.0, 0.0, 0.0, 183.0, -349.0, -57.0, 0.0, -281.0, 0.0, 192.0, 57.0, 0.0, 0.0, 0.0, 0.0, 0.0, 189.0, -292.0, 0.0, 105.0, 172.0, -2.0, -20.0, 83.0, 170.0, 6.0, 177.0, -2.0, 0.0, 197.0, 117.0, 188.0, 164.0, 0.0, 0.0, 96.0, -297.0, 151.0, 175.0, 130.0, 139.0, -14.0, 182.0, 195.0, 180.0, 200.0, 62.0, 104.0, 153.0, 167.0, 156.0, 0.0, 157.0, 200.0, 192.0, 185.0, 184.0, 200.0, 0.0, -26.0, 200.0, 180.0, -10.0, 0.0, 0.0, 0.0, 152.0, 0.0, 128.0, 117.0, 0.0, 161.0, 160.0, 0.0, 0.0, 0.0, 184.0, 200.0, 187.0, 137.0, 200.0, 0.0, 167.0, 181.0, -6.0, 171.0, -274.0, 193.0, 0.0, 0.0, 185.0, 140.0, 0.0, 20.0, 200.0, 2.0, 28.0, 180.0, 167.0, 0.0, 0.0, 129.0, 0.0, 62.0, 200.0, 100.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 5.0, 0.0, 8.0, 0.0, 0.0, 0.0, 6.0, 9.0, 60.0, 0.0, 0.0, 0.0, 168.0, 69.0, 0.0, 98.0, 87.0, 4.0, 2.0, 3.0, 0.0, 5.0, 0.0, 8.0, 9.0, 0.0, 0.0, 0.0, 38.0, 2.0, 161.0, 0.0, 0.0, 95.0, 0.0, 0.0, 78.0, 0.0, 12.0, 11.0, 16.0, 96.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 1.0, 64.0, 0.0, 0.0, 95.0, 56.0, 0.0, 0.0, 8.0, 0.0, 23.0, 153.0, 1.0, 0.0, 0.0, 0.0, 8.0, 32.0, 0.0, 0.0, 12.0, 0.0, 19.0, 5.0, 0.0, 0.0, 0.0, 0.0, 24.0, 0.0, 15.0, 5.0, 0.0, 12.0, 0.0, 0.0, 188.0, 99.0, 160.0, 0.0, 0.0, 0.0, 0.0, 42.0, 0.0, 0.0, 0.0, 0.0, 145.0, 148.0, 6.0, 19.0, 0.0, 8.0, 22.0, 13.0, 1.0, 9.0, 4.0, 1.0, 0.0, 0.0, 0.0, 22.0, 12.0, 0.0, 0.0, 32.0, 68.0, 149.0, 11.0, 11.0, 14.0, 7.0, 1.0, 0.0, 0.0, 0.0, 71.0, 1.0, 5.0, 18.0, 0.0, 14.0, 13.0, 0.0, 1.0, 0.0, 0.0, 4.0, 0.0, 13.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 15.0, 0.0, 35.0, 29.0, 13.0, 0.0, 12.0, 9.0, 0.0, 0.0, 1.0, 0.0, 16.0, 5.0, 0.0, 0.0, 0.0, 11.0, 8.0, 0.0, 0.0, 158.0, 0.0, 0.0, 20.0, 17.0, 27.0, 38.0, 0.0, 0.0, 0.0, 28.0, 2.0, 9.0, 13.0, 17.0, 31.0, 13.0, 8.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.719168287895692, "mean_inference_ms": 4.597139307962882, "mean_action_processing_ms": 0.896650230338874, "mean_env_wait_ms": 0.600499497963275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025315523147583008, "StateBufferConnector_ms": 0.0062018632888793945, "ViewRequirementAgentConnector_ms": 0.3097437620162964}, "num_episodes": 18, "episode_return_max": 394.0, "episode_return_min": -121.0, "episode_return_mean": 149.89, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.42831376597243, "num_env_steps_trained_throughput_per_sec": 155.42831376597243, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 27209.609, "restore_workers_time_ms": 0.016, "training_step_time_ms": 27209.55, "sample_time_ms": 3919.127, "learn_time_ms": 23259.372, "learn_throughput": 171.974, "synch_weights_time_ms": 26.652}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 48, "trial_id": "f6b99_00000", "date": "2024-08-13_20-03-26", "timestamp": 1723593806, "time_this_iter_s": 25.92430090904236, "time_total_s": 1110.600120306015, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6096040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1110.600120306015, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 87.675, "ram_util_percent": 78.66944444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4479567604405539, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8953143184620237, "policy_loss": -0.006777282193470647, "vf_loss": 0.9014365172260022, "vf_explained_var": 0.004294650359128518, "kl": 0.013101694630637154, "entropy": 0.9518303883769524, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0902392936762046, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.316515798795791, "policy_loss": 0.0016975305702231784, "vf_loss": 5.314415814258434, "vf_explained_var": 0.734370870880349, "kl": 0.010732105321958193, "entropy": 0.924745952105396, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 394.0, "episode_reward_min": -121.0, "episode_reward_mean": 170.18, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -349.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 188.0}, "policy_reward_mean": {"prey_policy": 69.01, "predator_policy": 16.08}, "custom_metrics": {}, "hist_stats": {"episode_reward": [184.0, 91.0, 45.0, -12.0, 290.0, -100.0, 83.0, 394.0, 131.0, 215.0, 0.0, 32.0, 0.0, 155.0, 4.0, -1.0, 119.0, -10.0, 0.0, 88.0, 277.0, 177.0, 177.0, 314.0, 268.0, 176.0, 183.0, -119.0, -121.0, 192.0, 99.0, 0.0, 0.0, 190.0, 130.0, 178.0, 98.0, 186.0, 180.0, 197.0, 327.0, 176.0, 128.0, 71.0, 327.0, 146.0, 378.0, 380.0, 238.0, 343.0, 170.0, 370.0, 378.0, 388.0, -13.0, 380.0, -5.0, 0.0, 167.0, 309.0, 174.0, 181.0, 0.0, 385.0, 345.0, 200.0, 359.0, 173.0, 77.0, 0.0, 362.0, 85.0, 202.0, 236.0, 178.0, 159.0, 106.0, 319.0, 142.0, 0.0, 132.0, 0.0, 168.0, 361.0, 359.0, 189.0, 192.0, 249.0, 315.0, -15.0, 122.0, 0.0, 176.0, 288.0, 196.0, 360.0, 171.0, 347.0, 377.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 184.0, 164.0, -168.0, -31.0, -2.0, 0.0, -24.0, 117.0, 146.0, -132.0, -64.0, 73.0, 0.0, 194.0, 200.0, 131.0, 0.0, 142.0, 8.0, 0.0, 0.0, 26.0, -145.0, 0.0, 0.0, 0.0, 147.0, 128.0, -300.0, 0.0, -2.0, 0.0, 119.0, -4.0, -46.0, 0.0, 0.0, 76.0, 0.0, 127.0, 126.0, 0.0, 177.0, 177.0, 0.0, 162.0, 128.0, 149.0, 99.0, 164.0, 0.0, 0.0, 183.0, -349.0, -57.0, 0.0, -281.0, 0.0, 192.0, 57.0, 0.0, 0.0, 0.0, 0.0, 0.0, 189.0, -292.0, 0.0, 105.0, 172.0, -2.0, -20.0, 83.0, 170.0, 6.0, 177.0, -2.0, 0.0, 197.0, 117.0, 188.0, 164.0, 0.0, 0.0, 96.0, -297.0, 151.0, 175.0, 130.0, 139.0, -14.0, 182.0, 195.0, 180.0, 200.0, 62.0, 104.0, 153.0, 167.0, 156.0, 0.0, 157.0, 200.0, 192.0, 185.0, 184.0, 200.0, 0.0, -26.0, 200.0, 180.0, -10.0, 0.0, 0.0, 0.0, 152.0, 0.0, 128.0, 117.0, 0.0, 161.0, 160.0, 0.0, 0.0, 0.0, 184.0, 200.0, 187.0, 137.0, 200.0, 0.0, 167.0, 181.0, -6.0, 171.0, -274.0, 193.0, 0.0, 0.0, 185.0, 140.0, 0.0, 20.0, 200.0, 2.0, 28.0, 180.0, 167.0, 0.0, 0.0, 129.0, 0.0, 62.0, 200.0, 100.0, 0.0, 115.0, 0.0, 0.0, 98.0, 0.0, 0.0, 0.0, 0.0, 164.0, 154.0, 192.0, 181.0, 167.0, 189.0, 0.0, 179.0, -76.0, 173.0, -16.0, 142.0, 146.0, -16.0, -14.0, 85.0, 0.0, 0.0, 0.0, -4.0, 178.0, 152.0, 70.0, 186.0, -3.0, 141.0, 200.0, 0.0, 164.0, 158.0, 175.0, 185.0, 182.0, 200.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 95.0, 0.0, 0.0, 78.0, 0.0, 12.0, 11.0, 16.0, 96.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 1.0, 64.0, 0.0, 0.0, 95.0, 56.0, 0.0, 0.0, 8.0, 0.0, 23.0, 153.0, 1.0, 0.0, 0.0, 0.0, 8.0, 32.0, 0.0, 0.0, 12.0, 0.0, 19.0, 5.0, 0.0, 0.0, 0.0, 0.0, 24.0, 0.0, 15.0, 5.0, 0.0, 12.0, 0.0, 0.0, 188.0, 99.0, 160.0, 0.0, 0.0, 0.0, 0.0, 42.0, 0.0, 0.0, 0.0, 0.0, 145.0, 148.0, 6.0, 19.0, 0.0, 8.0, 22.0, 13.0, 1.0, 9.0, 4.0, 1.0, 0.0, 0.0, 0.0, 22.0, 12.0, 0.0, 0.0, 32.0, 68.0, 149.0, 11.0, 11.0, 14.0, 7.0, 1.0, 0.0, 0.0, 0.0, 71.0, 1.0, 5.0, 18.0, 0.0, 14.0, 13.0, 0.0, 1.0, 0.0, 0.0, 4.0, 0.0, 13.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 15.0, 0.0, 35.0, 29.0, 13.0, 0.0, 12.0, 9.0, 0.0, 0.0, 1.0, 0.0, 16.0, 5.0, 0.0, 0.0, 0.0, 11.0, 8.0, 0.0, 0.0, 158.0, 0.0, 0.0, 20.0, 17.0, 27.0, 38.0, 0.0, 0.0, 0.0, 28.0, 2.0, 9.0, 13.0, 17.0, 31.0, 13.0, 8.0, 11.0, 11.0, 16.0, 0.0, 0.0, 34.0, 0.0, 0.0, 0.0, 4.0, 0.0, 1.0, 14.0, 0.0, 11.0, 0.0, 0.0, 0.0, 89.0, 21.0, 71.0, 21.0, 6.0, 15.0, 0.0, 5.0, 32.0, 0.0, 0.0, 0.0, 2.0, 37.0, 29.0, 13.0, 0.0, 5.0, 14.0, 0.0, 7.0, 14.0, 0.0, 0.0, 10.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7344813486007111, "mean_inference_ms": 4.6566849377384925, "mean_action_processing_ms": 0.9029301058747383, "mean_env_wait_ms": 0.6060516788431028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0492548942565918, "StateBufferConnector_ms": 0.008134126663208008, "ViewRequirementAgentConnector_ms": 0.47515738010406494}, "num_episodes": 22, "episode_return_max": 394.0, "episode_return_min": -121.0, "episode_return_mean": 170.18, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.2874120715374, "num_env_steps_trained_throughput_per_sec": 81.2874120715374, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 29662.22, "restore_workers_time_ms": 0.017, "training_step_time_ms": 29662.157, "sample_time_ms": 5069.211, "learn_time_ms": 24560.796, "learn_throughput": 162.861, "synch_weights_time_ms": 26.518}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 49, "trial_id": "f6b99_00000", "date": "2024-08-13_20-04-16", "timestamp": 1723593856, "time_this_iter_s": 49.809911251068115, "time_total_s": 1160.4100315570831, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b602f1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1160.4100315570831, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 94.3623188405797, "ram_util_percent": 84.1536231884058}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3512786681374545, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0719464263588034, "policy_loss": -0.008612835196847165, "vf_loss": 2.0800232247700765, "vf_explained_var": 0.006648002225885946, "kl": 0.010720877223338714, "entropy": 0.8907693521055595, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.858403814879675, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.656242226040552, "policy_loss": -0.00041173449372527776, "vf_loss": 6.656155620554768, "vf_explained_var": 0.41125189933196576, "kl": 0.013288833816786081, "entropy": 0.8805262441988344, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 389.0, "episode_reward_min": -121.0, "episode_reward_mean": 194.12, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -349.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 188.0}, "policy_reward_mean": {"prey_policy": 80.565, "predator_policy": 16.495}, "custom_metrics": {}, "hist_stats": {"episode_reward": [314.0, 268.0, 176.0, 183.0, -119.0, -121.0, 192.0, 99.0, 0.0, 0.0, 190.0, 130.0, 178.0, 98.0, 186.0, 180.0, 197.0, 327.0, 176.0, 128.0, 71.0, 327.0, 146.0, 378.0, 380.0, 238.0, 343.0, 170.0, 370.0, 378.0, 388.0, -13.0, 380.0, -5.0, 0.0, 167.0, 309.0, 174.0, 181.0, 0.0, 385.0, 345.0, 200.0, 359.0, 173.0, 77.0, 0.0, 362.0, 85.0, 202.0, 236.0, 178.0, 159.0, 106.0, 319.0, 142.0, 0.0, 132.0, 0.0, 168.0, 361.0, 359.0, 189.0, 192.0, 249.0, 315.0, -15.0, 122.0, 0.0, 176.0, 288.0, 196.0, 360.0, 171.0, 347.0, 377.0, 200.0, 200.0, 42.0, 165.0, 210.0, 154.0, 178.0, 321.0, 175.0, 0.0, 374.0, 176.0, 389.0, 182.0, 104.0, 186.0, 373.0, 186.0, 180.0, 386.0, 374.0, 0.0, 193.0, 185.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [162.0, 128.0, 149.0, 99.0, 164.0, 0.0, 0.0, 183.0, -349.0, -57.0, 0.0, -281.0, 0.0, 192.0, 57.0, 0.0, 0.0, 0.0, 0.0, 0.0, 189.0, -292.0, 0.0, 105.0, 172.0, -2.0, -20.0, 83.0, 170.0, 6.0, 177.0, -2.0, 0.0, 197.0, 117.0, 188.0, 164.0, 0.0, 0.0, 96.0, -297.0, 151.0, 175.0, 130.0, 139.0, -14.0, 182.0, 195.0, 180.0, 200.0, 62.0, 104.0, 153.0, 167.0, 156.0, 0.0, 157.0, 200.0, 192.0, 185.0, 184.0, 200.0, 0.0, -26.0, 200.0, 180.0, -10.0, 0.0, 0.0, 0.0, 152.0, 0.0, 128.0, 117.0, 0.0, 161.0, 160.0, 0.0, 0.0, 0.0, 184.0, 200.0, 187.0, 137.0, 200.0, 0.0, 167.0, 181.0, -6.0, 171.0, -274.0, 193.0, 0.0, 0.0, 185.0, 140.0, 0.0, 20.0, 200.0, 2.0, 28.0, 180.0, 167.0, 0.0, 0.0, 129.0, 0.0, 62.0, 200.0, 100.0, 0.0, 115.0, 0.0, 0.0, 98.0, 0.0, 0.0, 0.0, 0.0, 164.0, 154.0, 192.0, 181.0, 167.0, 189.0, 0.0, 179.0, -76.0, 173.0, -16.0, 142.0, 146.0, -16.0, -14.0, 85.0, 0.0, 0.0, 0.0, -4.0, 178.0, 152.0, 70.0, 186.0, -3.0, 141.0, 200.0, 0.0, 164.0, 158.0, 175.0, 185.0, 182.0, 200.0, 0.0, 189.0, -4.0, -64.0, 0.0, 161.0, -16.0, 60.0, 128.0, 40.0, -97.0, 172.0, 0.0, 198.0, 83.0, 0.0, 163.0, 0.0, 0.0, 189.0, 185.0, 180.0, -12.0, 189.0, 200.0, -16.0, 185.0, -295.0, 146.0, 184.0, 0.0, 182.0, 184.0, 189.0, -10.0, 184.0, -12.0, 186.0, 200.0, 163.0, 200.0, 0.0, 0.0, -14.0, 200.0, 121.0, -66.0], "policy_predator_policy_reward": [24.0, 0.0, 15.0, 5.0, 0.0, 12.0, 0.0, 0.0, 188.0, 99.0, 160.0, 0.0, 0.0, 0.0, 0.0, 42.0, 0.0, 0.0, 0.0, 0.0, 145.0, 148.0, 6.0, 19.0, 0.0, 8.0, 22.0, 13.0, 1.0, 9.0, 4.0, 1.0, 0.0, 0.0, 0.0, 22.0, 12.0, 0.0, 0.0, 32.0, 68.0, 149.0, 11.0, 11.0, 14.0, 7.0, 1.0, 0.0, 0.0, 0.0, 71.0, 1.0, 5.0, 18.0, 0.0, 14.0, 13.0, 0.0, 1.0, 0.0, 0.0, 4.0, 0.0, 13.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 15.0, 0.0, 35.0, 29.0, 13.0, 0.0, 12.0, 9.0, 0.0, 0.0, 1.0, 0.0, 16.0, 5.0, 0.0, 0.0, 0.0, 11.0, 8.0, 0.0, 0.0, 158.0, 0.0, 0.0, 20.0, 17.0, 27.0, 38.0, 0.0, 0.0, 0.0, 28.0, 2.0, 9.0, 13.0, 17.0, 31.0, 13.0, 8.0, 11.0, 11.0, 16.0, 0.0, 0.0, 34.0, 0.0, 0.0, 0.0, 4.0, 0.0, 1.0, 14.0, 0.0, 11.0, 0.0, 0.0, 0.0, 89.0, 21.0, 71.0, 21.0, 6.0, 15.0, 0.0, 5.0, 32.0, 0.0, 0.0, 0.0, 2.0, 37.0, 29.0, 13.0, 0.0, 5.0, 14.0, 0.0, 7.0, 14.0, 0.0, 0.0, 10.0, 0.0, 0.0, 13.0, 2.0, 42.0, 64.0, 0.0, 20.0, 5.0, 17.0, 118.0, 93.0, 6.0, 0.0, 37.0, 3.0, 4.0, 8.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 11.0, 2.0, 82.0, 171.0, 0.0, 2.0, 0.0, 7.0, 5.0, 2.0, 6.0, 2.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 7.0, 0.0, 75.0, 55.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.739874112156751, "mean_inference_ms": 4.710682289111362, "mean_action_processing_ms": 0.9091215644298924, "mean_env_wait_ms": 0.6147786822411746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04920971393585205, "StateBufferConnector_ms": 0.006279587745666504, "ViewRequirementAgentConnector_ms": 0.40850818157196045}, "num_episodes": 23, "episode_return_max": 389.0, "episode_return_min": -121.0, "episode_return_mean": 194.12, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 142.0007360887537, "num_env_steps_trained_throughput_per_sec": 142.0007360887537, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 30579.489, "restore_workers_time_ms": 0.021, "training_step_time_ms": 30579.417, "sample_time_ms": 5178.271, "learn_time_ms": 25368.039, "learn_throughput": 157.679, "synch_weights_time_ms": 27.436}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 50, "trial_id": "f6b99_00000", "date": "2024-08-13_20-04-45", "timestamp": 1723593885, "time_this_iter_s": 28.30257296562195, "time_total_s": 1188.712604522705, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6053ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1188.712604522705, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 87.68205128205129, "ram_util_percent": 84.02051282051282}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1415870628659688, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4540767348001873, "policy_loss": -0.00910037781060156, "vf_loss": 1.4626201489615063, "vf_explained_var": 0.011860803447703206, "kl": 0.011139347627455007, "entropy": 0.9488375186289429, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.019953044476332, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.48053105066693, "policy_loss": -0.0007143152653481122, "vf_loss": 5.480946491130445, "vf_explained_var": 0.6739404460109731, "kl": 0.007970131305551655, "entropy": 0.9242855448571462, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 389.0, "episode_reward_min": -15.0, "episode_reward_mean": 202.45, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -297.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 171.0}, "policy_reward_mean": {"prey_policy": 87.37, "predator_policy": 13.855}, "custom_metrics": {}, "hist_stats": {"episode_reward": [176.0, 128.0, 71.0, 327.0, 146.0, 378.0, 380.0, 238.0, 343.0, 170.0, 370.0, 378.0, 388.0, -13.0, 380.0, -5.0, 0.0, 167.0, 309.0, 174.0, 181.0, 0.0, 385.0, 345.0, 200.0, 359.0, 173.0, 77.0, 0.0, 362.0, 85.0, 202.0, 236.0, 178.0, 159.0, 106.0, 319.0, 142.0, 0.0, 132.0, 0.0, 168.0, 361.0, 359.0, 189.0, 192.0, 249.0, 315.0, -15.0, 122.0, 0.0, 176.0, 288.0, 196.0, 360.0, 171.0, 347.0, 377.0, 200.0, 200.0, 42.0, 165.0, 210.0, 154.0, 178.0, 321.0, 175.0, 0.0, 374.0, 176.0, 389.0, 182.0, 104.0, 186.0, 373.0, 186.0, 180.0, 386.0, 374.0, 0.0, 193.0, 185.0, 323.0, 174.0, 358.0, 347.0, 161.0, -8.0, 375.0, 298.0, 27.0, 346.0, 200.0, 159.0, -4.0, 191.0, 107.0, 76.0, 137.0, 44.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [164.0, 0.0, 0.0, 96.0, -297.0, 151.0, 175.0, 130.0, 139.0, -14.0, 182.0, 195.0, 180.0, 200.0, 62.0, 104.0, 153.0, 167.0, 156.0, 0.0, 157.0, 200.0, 192.0, 185.0, 184.0, 200.0, 0.0, -26.0, 200.0, 180.0, -10.0, 0.0, 0.0, 0.0, 152.0, 0.0, 128.0, 117.0, 0.0, 161.0, 160.0, 0.0, 0.0, 0.0, 184.0, 200.0, 187.0, 137.0, 200.0, 0.0, 167.0, 181.0, -6.0, 171.0, -274.0, 193.0, 0.0, 0.0, 185.0, 140.0, 0.0, 20.0, 200.0, 2.0, 28.0, 180.0, 167.0, 0.0, 0.0, 129.0, 0.0, 62.0, 200.0, 100.0, 0.0, 115.0, 0.0, 0.0, 98.0, 0.0, 0.0, 0.0, 0.0, 164.0, 154.0, 192.0, 181.0, 167.0, 189.0, 0.0, 179.0, -76.0, 173.0, -16.0, 142.0, 146.0, -16.0, -14.0, 85.0, 0.0, 0.0, 0.0, -4.0, 178.0, 152.0, 70.0, 186.0, -3.0, 141.0, 200.0, 0.0, 164.0, 158.0, 175.0, 185.0, 182.0, 200.0, 0.0, 189.0, -4.0, -64.0, 0.0, 161.0, -16.0, 60.0, 128.0, 40.0, -97.0, 172.0, 0.0, 198.0, 83.0, 0.0, 163.0, 0.0, 0.0, 189.0, 185.0, 180.0, -12.0, 189.0, 200.0, -16.0, 185.0, -295.0, 146.0, 184.0, 0.0, 182.0, 184.0, 189.0, -10.0, 184.0, -12.0, 186.0, 200.0, 163.0, 200.0, 0.0, 0.0, -14.0, 200.0, 121.0, -66.0, 174.0, 135.0, 0.0, 169.0, 172.0, 186.0, 165.0, 182.0, 154.0, 0.0, -16.0, 0.0, 185.0, 187.0, 116.0, 171.0, -76.0, 0.0, 178.0, 159.0, 1.0, 159.0, 159.0, -14.0, -10.0, 1.0, 191.0, 0.0, 99.0, 0.0, 76.0, 0.0, -155.0, 173.0, -4.0, -21.0], "policy_predator_policy_reward": [12.0, 0.0, 0.0, 32.0, 68.0, 149.0, 11.0, 11.0, 14.0, 7.0, 1.0, 0.0, 0.0, 0.0, 71.0, 1.0, 5.0, 18.0, 0.0, 14.0, 13.0, 0.0, 1.0, 0.0, 0.0, 4.0, 0.0, 13.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 15.0, 0.0, 35.0, 29.0, 13.0, 0.0, 12.0, 9.0, 0.0, 0.0, 1.0, 0.0, 16.0, 5.0, 0.0, 0.0, 0.0, 11.0, 8.0, 0.0, 0.0, 158.0, 0.0, 0.0, 20.0, 17.0, 27.0, 38.0, 0.0, 0.0, 0.0, 28.0, 2.0, 9.0, 13.0, 17.0, 31.0, 13.0, 8.0, 11.0, 11.0, 16.0, 0.0, 0.0, 34.0, 0.0, 0.0, 0.0, 4.0, 0.0, 1.0, 14.0, 0.0, 11.0, 0.0, 0.0, 0.0, 89.0, 21.0, 71.0, 21.0, 6.0, 15.0, 0.0, 5.0, 32.0, 0.0, 0.0, 0.0, 2.0, 37.0, 29.0, 13.0, 0.0, 5.0, 14.0, 0.0, 7.0, 14.0, 0.0, 0.0, 10.0, 0.0, 0.0, 13.0, 2.0, 42.0, 64.0, 0.0, 20.0, 5.0, 17.0, 118.0, 93.0, 6.0, 0.0, 37.0, 3.0, 4.0, 8.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 11.0, 2.0, 82.0, 171.0, 0.0, 2.0, 0.0, 7.0, 5.0, 2.0, 6.0, 2.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 7.0, 0.0, 75.0, 55.0, 11.0, 3.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 8.0, 0.0, 3.0, 0.0, 11.0, 0.0, 42.0, 61.0, 0.0, 9.0, 14.0, 26.0, 7.0, 7.0, 0.0, 5.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 25.0, 94.0, 69.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7531038076435663, "mean_inference_ms": 4.751791106068736, "mean_action_processing_ms": 0.8973935237047089, "mean_env_wait_ms": 0.6132725476879126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038365960121154785, "StateBufferConnector_ms": 0.006295204162597656, "ViewRequirementAgentConnector_ms": 0.42455029487609863}, "num_episodes": 18, "episode_return_max": 389.0, "episode_return_min": -15.0, "episode_return_mean": 202.45, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 177.02327416162748, "num_env_steps_trained_throughput_per_sec": 177.02327416162748, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 30138.221, "restore_workers_time_ms": 0.022, "training_step_time_ms": 30138.147, "sample_time_ms": 4882.884, "learn_time_ms": 25222.935, "learn_throughput": 158.586, "synch_weights_time_ms": 26.984}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 51, "trial_id": "f6b99_00000", "date": "2024-08-13_20-05-07", "timestamp": 1723593907, "time_this_iter_s": 22.636338233947754, "time_total_s": 1211.3489427566528, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b60873a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1211.3489427566528, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 84.04375, "ram_util_percent": 83.821875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.159325911065258, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4392713785171507, "policy_loss": -0.008208053327096556, "vf_loss": 2.4468866331236705, "vf_explained_var": 0.011774862159496892, "kl": 0.011855903670509217, "entropy": 0.877590918257123, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2079834167919463, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.574859275262822, "policy_loss": -0.0022331592784553926, "vf_loss": 5.576804401004125, "vf_explained_var": 0.594446789429932, "kl": 0.007680619916571392, "entropy": 0.904792265128837, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 389.0, "episode_reward_min": -34.0, "episode_reward_mean": 188.1, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -295.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 171.0}, "policy_reward_mean": {"prey_policy": 78.93, "predator_policy": 15.12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [309.0, 174.0, 181.0, 0.0, 385.0, 345.0, 200.0, 359.0, 173.0, 77.0, 0.0, 362.0, 85.0, 202.0, 236.0, 178.0, 159.0, 106.0, 319.0, 142.0, 0.0, 132.0, 0.0, 168.0, 361.0, 359.0, 189.0, 192.0, 249.0, 315.0, -15.0, 122.0, 0.0, 176.0, 288.0, 196.0, 360.0, 171.0, 347.0, 377.0, 200.0, 200.0, 42.0, 165.0, 210.0, 154.0, 178.0, 321.0, 175.0, 0.0, 374.0, 176.0, 389.0, 182.0, 104.0, 186.0, 373.0, 186.0, 180.0, 386.0, 374.0, 0.0, 193.0, 185.0, 323.0, 174.0, 358.0, 347.0, 161.0, -8.0, 375.0, 298.0, 27.0, 346.0, 200.0, 159.0, -4.0, 191.0, 107.0, 76.0, 137.0, 44.0, 178.0, 325.0, 84.0, 355.0, -34.0, 82.0, 121.0, 337.0, 0.0, 273.0, 281.0, 139.0, 0.0, 185.0, 134.0, 99.0, 0.0, 28.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [128.0, 117.0, 0.0, 161.0, 160.0, 0.0, 0.0, 0.0, 184.0, 200.0, 187.0, 137.0, 200.0, 0.0, 167.0, 181.0, -6.0, 171.0, -274.0, 193.0, 0.0, 0.0, 185.0, 140.0, 0.0, 20.0, 200.0, 2.0, 28.0, 180.0, 167.0, 0.0, 0.0, 129.0, 0.0, 62.0, 200.0, 100.0, 0.0, 115.0, 0.0, 0.0, 98.0, 0.0, 0.0, 0.0, 0.0, 164.0, 154.0, 192.0, 181.0, 167.0, 189.0, 0.0, 179.0, -76.0, 173.0, -16.0, 142.0, 146.0, -16.0, -14.0, 85.0, 0.0, 0.0, 0.0, -4.0, 178.0, 152.0, 70.0, 186.0, -3.0, 141.0, 200.0, 0.0, 164.0, 158.0, 175.0, 185.0, 182.0, 200.0, 0.0, 189.0, -4.0, -64.0, 0.0, 161.0, -16.0, 60.0, 128.0, 40.0, -97.0, 172.0, 0.0, 198.0, 83.0, 0.0, 163.0, 0.0, 0.0, 189.0, 185.0, 180.0, -12.0, 189.0, 200.0, -16.0, 185.0, -295.0, 146.0, 184.0, 0.0, 182.0, 184.0, 189.0, -10.0, 184.0, -12.0, 186.0, 200.0, 163.0, 200.0, 0.0, 0.0, -14.0, 200.0, 121.0, -66.0, 174.0, 135.0, 0.0, 169.0, 172.0, 186.0, 165.0, 182.0, 154.0, 0.0, -16.0, 0.0, 185.0, 187.0, 116.0, 171.0, -76.0, 0.0, 178.0, 159.0, 1.0, 159.0, 159.0, -14.0, -10.0, 1.0, 191.0, 0.0, 99.0, 0.0, 76.0, 0.0, -155.0, 173.0, -4.0, -21.0, 49.0, 49.0, 152.0, 167.0, 0.0, 28.0, 166.0, 180.0, -118.0, -48.0, -25.0, 0.0, 94.0, 0.0, 169.0, 155.0, 0.0, 0.0, 131.0, 78.0, 137.0, 126.0, 0.0, 130.0, 0.0, 0.0, -2.0, 180.0, 100.0, -6.0, 0.0, 41.0, 0.0, 0.0, 0.0, -64.0], "policy_predator_policy_reward": [35.0, 29.0, 13.0, 0.0, 12.0, 9.0, 0.0, 0.0, 1.0, 0.0, 16.0, 5.0, 0.0, 0.0, 0.0, 11.0, 8.0, 0.0, 0.0, 158.0, 0.0, 0.0, 20.0, 17.0, 27.0, 38.0, 0.0, 0.0, 0.0, 28.0, 2.0, 9.0, 13.0, 17.0, 31.0, 13.0, 8.0, 11.0, 11.0, 16.0, 0.0, 0.0, 34.0, 0.0, 0.0, 0.0, 4.0, 0.0, 1.0, 14.0, 0.0, 11.0, 0.0, 0.0, 0.0, 89.0, 21.0, 71.0, 21.0, 6.0, 15.0, 0.0, 5.0, 32.0, 0.0, 0.0, 0.0, 2.0, 37.0, 29.0, 13.0, 0.0, 5.0, 14.0, 0.0, 7.0, 14.0, 0.0, 0.0, 10.0, 0.0, 0.0, 13.0, 2.0, 42.0, 64.0, 0.0, 20.0, 5.0, 17.0, 118.0, 93.0, 6.0, 0.0, 37.0, 3.0, 4.0, 8.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 11.0, 2.0, 82.0, 171.0, 0.0, 2.0, 0.0, 7.0, 5.0, 2.0, 6.0, 2.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 7.0, 0.0, 75.0, 55.0, 11.0, 3.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 8.0, 0.0, 3.0, 0.0, 11.0, 0.0, 42.0, 61.0, 0.0, 9.0, 14.0, 26.0, 7.0, 7.0, 0.0, 5.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 25.0, 94.0, 69.0, 0.0, 49.0, 31.0, 6.0, 0.0, 31.0, 25.0, 0.0, 9.0, 132.0, 0.0, 51.0, 56.0, 14.0, 13.0, 8.0, 5.0, 0.0, 0.0, 38.0, 26.0, 0.0, 18.0, 9.0, 0.0, 0.0, 0.0, 7.0, 0.0, 27.0, 13.0, 19.0, 39.0, 0.0, 0.0, 33.0, 59.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.758616561321518, "mean_inference_ms": 4.784823344509024, "mean_action_processing_ms": 0.8961216913181089, "mean_env_wait_ms": 0.615823839749908, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03688359260559082, "StateBufferConnector_ms": 0.006209611892700195, "ViewRequirementAgentConnector_ms": 0.4247472286224365}, "num_episodes": 18, "episode_return_max": 389.0, "episode_return_min": -34.0, "episode_return_mean": 188.1, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 159.28979068411772, "num_env_steps_trained_throughput_per_sec": 159.28979068411772, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 29981.486, "restore_workers_time_ms": 0.022, "training_step_time_ms": 29981.412, "sample_time_ms": 4745.09, "learn_time_ms": 25200.849, "learn_throughput": 158.725, "synch_weights_time_ms": 27.768}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 52, "trial_id": "f6b99_00000", "date": "2024-08-13_20-05-33", "timestamp": 1723593933, "time_this_iter_s": 25.786253213882446, "time_total_s": 1237.1351959705353, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6053c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1237.1351959705353, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 89.25405405405405, "ram_util_percent": 83.71081081081081}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3496626639492297, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6652572768705862, "policy_loss": -0.007344236084082652, "vf_loss": 1.6721133521309606, "vf_explained_var": 0.012007998442523694, "kl": 0.009763146105386247, "entropy": 0.8772489293542488, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.630002175783985, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.5975718621854424, "policy_loss": -0.004662343554405702, "vf_loss": 5.6019621273827935, "vf_explained_var": 0.7220838505439657, "kl": 0.007255016880596904, "entropy": 0.8738678763467799, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "env_runners": {"episode_reward_max": 389.0, "episode_reward_min": -49.0, "episode_reward_mean": 181.22, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -295.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 171.0}, "policy_reward_mean": {"prey_policy": 75.1, "predator_policy": 15.51}, "custom_metrics": {}, "hist_stats": {"episode_reward": [319.0, 142.0, 0.0, 132.0, 0.0, 168.0, 361.0, 359.0, 189.0, 192.0, 249.0, 315.0, -15.0, 122.0, 0.0, 176.0, 288.0, 196.0, 360.0, 171.0, 347.0, 377.0, 200.0, 200.0, 42.0, 165.0, 210.0, 154.0, 178.0, 321.0, 175.0, 0.0, 374.0, 176.0, 389.0, 182.0, 104.0, 186.0, 373.0, 186.0, 180.0, 386.0, 374.0, 0.0, 193.0, 185.0, 323.0, 174.0, 358.0, 347.0, 161.0, -8.0, 375.0, 298.0, 27.0, 346.0, 200.0, 159.0, -4.0, 191.0, 107.0, 76.0, 137.0, 44.0, 178.0, 325.0, 84.0, 355.0, -34.0, 82.0, 121.0, 337.0, 0.0, 273.0, 281.0, 139.0, 0.0, 185.0, 134.0, 99.0, 0.0, 28.0, 82.0, 147.0, 115.0, 166.0, 309.0, 181.0, 158.0, -49.0, 0.0, 0.0, 286.0, 264.0, 120.0, 204.0, 306.0, 286.0, 109.0, 159.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 100.0, 0.0, 115.0, 0.0, 0.0, 98.0, 0.0, 0.0, 0.0, 0.0, 164.0, 154.0, 192.0, 181.0, 167.0, 189.0, 0.0, 179.0, -76.0, 173.0, -16.0, 142.0, 146.0, -16.0, -14.0, 85.0, 0.0, 0.0, 0.0, -4.0, 178.0, 152.0, 70.0, 186.0, -3.0, 141.0, 200.0, 0.0, 164.0, 158.0, 175.0, 185.0, 182.0, 200.0, 0.0, 189.0, -4.0, -64.0, 0.0, 161.0, -16.0, 60.0, 128.0, 40.0, -97.0, 172.0, 0.0, 198.0, 83.0, 0.0, 163.0, 0.0, 0.0, 189.0, 185.0, 180.0, -12.0, 189.0, 200.0, -16.0, 185.0, -295.0, 146.0, 184.0, 0.0, 182.0, 184.0, 189.0, -10.0, 184.0, -12.0, 186.0, 200.0, 163.0, 200.0, 0.0, 0.0, -14.0, 200.0, 121.0, -66.0, 174.0, 135.0, 0.0, 169.0, 172.0, 186.0, 165.0, 182.0, 154.0, 0.0, -16.0, 0.0, 185.0, 187.0, 116.0, 171.0, -76.0, 0.0, 178.0, 159.0, 1.0, 159.0, 159.0, -14.0, -10.0, 1.0, 191.0, 0.0, 99.0, 0.0, 76.0, 0.0, -155.0, 173.0, -4.0, -21.0, 49.0, 49.0, 152.0, 167.0, 0.0, 28.0, 166.0, 180.0, -118.0, -48.0, -25.0, 0.0, 94.0, 0.0, 169.0, 155.0, 0.0, 0.0, 131.0, 78.0, 137.0, 126.0, 0.0, 130.0, 0.0, 0.0, -2.0, 180.0, 100.0, -6.0, 0.0, 41.0, 0.0, 0.0, 0.0, -64.0, 76.0, 0.0, 81.0, 55.0, 0.0, 114.0, 138.0, 0.0, 123.0, 157.0, 0.0, 177.0, -82.0, 147.0, -53.0, -106.0, 0.0, 0.0, 0.0, 0.0, 164.0, 76.0, -4.0, 200.0, -4.0, 85.0, 54.0, 56.0, 178.0, 128.0, 153.0, 108.0, 86.0, 0.0, 168.0, -22.0], "policy_predator_policy_reward": [8.0, 11.0, 11.0, 16.0, 0.0, 0.0, 34.0, 0.0, 0.0, 0.0, 4.0, 0.0, 1.0, 14.0, 0.0, 11.0, 0.0, 0.0, 0.0, 89.0, 21.0, 71.0, 21.0, 6.0, 15.0, 0.0, 5.0, 32.0, 0.0, 0.0, 0.0, 2.0, 37.0, 29.0, 13.0, 0.0, 5.0, 14.0, 0.0, 7.0, 14.0, 0.0, 0.0, 10.0, 0.0, 0.0, 13.0, 2.0, 42.0, 64.0, 0.0, 20.0, 5.0, 17.0, 118.0, 93.0, 6.0, 0.0, 37.0, 3.0, 4.0, 8.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 11.0, 2.0, 82.0, 171.0, 0.0, 2.0, 0.0, 7.0, 5.0, 2.0, 6.0, 2.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 7.0, 0.0, 75.0, 55.0, 11.0, 3.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 8.0, 0.0, 3.0, 0.0, 11.0, 0.0, 42.0, 61.0, 0.0, 9.0, 14.0, 26.0, 7.0, 7.0, 0.0, 5.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 25.0, 94.0, 69.0, 0.0, 49.0, 31.0, 6.0, 0.0, 31.0, 25.0, 0.0, 9.0, 132.0, 0.0, 51.0, 56.0, 14.0, 13.0, 8.0, 5.0, 0.0, 0.0, 38.0, 26.0, 0.0, 18.0, 9.0, 0.0, 0.0, 0.0, 7.0, 0.0, 27.0, 13.0, 19.0, 39.0, 0.0, 0.0, 33.0, 59.0, 1.0, 5.0, 11.0, 0.0, 0.0, 1.0, 12.0, 16.0, 6.0, 23.0, 1.0, 3.0, 86.0, 7.0, 34.0, 76.0, 0.0, 0.0, 0.0, 0.0, 0.0, 46.0, 68.0, 0.0, 19.0, 20.0, 54.0, 40.0, 0.0, 0.0, 5.0, 20.0, 4.0, 19.0, 9.0, 4.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7671232253213944, "mean_inference_ms": 4.823812765273825, "mean_action_processing_ms": 0.895695243182193, "mean_env_wait_ms": 0.619851394482099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037122368812561035, "StateBufferConnector_ms": 0.006447553634643555, "ViewRequirementAgentConnector_ms": 0.4547353982925415}, "num_episodes": 18, "episode_return_max": 389.0, "episode_return_min": -49.0, "episode_return_mean": 181.22, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 151.62063672997294, "num_env_steps_trained_throughput_per_sec": 151.62063672997294, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 28259.992, "restore_workers_time_ms": 0.039, "training_step_time_ms": 28259.896, "sample_time_ms": 4858.76, "learn_time_ms": 23365.798, "learn_throughput": 171.19, "synch_weights_time_ms": 25.842}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "training_iteration": 53, "trial_id": "f6b99_00000", "date": "2024-08-13_20-06-00", "timestamp": 1723593960, "time_this_iter_s": 26.45362687110901, "time_total_s": 1263.5888228416443, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6028670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1263.5888228416443, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 94.72894736842103, "ram_util_percent": 83.80263157894737}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3978707016460479, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.273805172859676, "policy_loss": -0.005622722333415397, "vf_loss": 3.2790144478833234, "vf_explained_var": 0.004551969224183017, "kl": 0.008268939536481088, "entropy": 0.8657030919241526, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.4641114667925255, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.5798762064131475, "policy_loss": -0.0024024200083678044, "vf_loss": 6.581982810408981, "vf_explained_var": 0.313502054460465, "kl": 0.007889002644306673, "entropy": 0.7663850234614478, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 389.0, "episode_reward_min": -49.0, "episode_reward_mean": 174.03, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -295.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 171.0}, "policy_reward_mean": {"prey_policy": 68.19, "predator_policy": 18.825}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 200.0, 42.0, 165.0, 210.0, 154.0, 178.0, 321.0, 175.0, 0.0, 374.0, 176.0, 389.0, 182.0, 104.0, 186.0, 373.0, 186.0, 180.0, 386.0, 374.0, 0.0, 193.0, 185.0, 323.0, 174.0, 358.0, 347.0, 161.0, -8.0, 375.0, 298.0, 27.0, 346.0, 200.0, 159.0, -4.0, 191.0, 107.0, 76.0, 137.0, 44.0, 178.0, 325.0, 84.0, 355.0, -34.0, 82.0, 121.0, 337.0, 0.0, 273.0, 281.0, 139.0, 0.0, 185.0, 134.0, 99.0, 0.0, 28.0, 82.0, 147.0, 115.0, 166.0, 309.0, 181.0, 158.0, -49.0, 0.0, 0.0, 286.0, 264.0, 120.0, 204.0, 306.0, 286.0, 109.0, 159.0, 158.0, 374.0, 303.0, 0.0, 180.0, 0.0, 165.0, -12.0, 350.0, 121.0, 151.0, 66.0, 323.0, 43.0, 338.0, 104.0, 142.0, 200.0, 356.0, 192.0, 175.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 0.0, 189.0, -4.0, -64.0, 0.0, 161.0, -16.0, 60.0, 128.0, 40.0, -97.0, 172.0, 0.0, 198.0, 83.0, 0.0, 163.0, 0.0, 0.0, 189.0, 185.0, 180.0, -12.0, 189.0, 200.0, -16.0, 185.0, -295.0, 146.0, 184.0, 0.0, 182.0, 184.0, 189.0, -10.0, 184.0, -12.0, 186.0, 200.0, 163.0, 200.0, 0.0, 0.0, -14.0, 200.0, 121.0, -66.0, 174.0, 135.0, 0.0, 169.0, 172.0, 186.0, 165.0, 182.0, 154.0, 0.0, -16.0, 0.0, 185.0, 187.0, 116.0, 171.0, -76.0, 0.0, 178.0, 159.0, 1.0, 159.0, 159.0, -14.0, -10.0, 1.0, 191.0, 0.0, 99.0, 0.0, 76.0, 0.0, -155.0, 173.0, -4.0, -21.0, 49.0, 49.0, 152.0, 167.0, 0.0, 28.0, 166.0, 180.0, -118.0, -48.0, -25.0, 0.0, 94.0, 0.0, 169.0, 155.0, 0.0, 0.0, 131.0, 78.0, 137.0, 126.0, 0.0, 130.0, 0.0, 0.0, -2.0, 180.0, 100.0, -6.0, 0.0, 41.0, 0.0, 0.0, 0.0, -64.0, 76.0, 0.0, 81.0, 55.0, 0.0, 114.0, 138.0, 0.0, 123.0, 157.0, 0.0, 177.0, -82.0, 147.0, -53.0, -106.0, 0.0, 0.0, 0.0, 0.0, 164.0, 76.0, -4.0, 200.0, -4.0, 85.0, 54.0, 56.0, 178.0, 128.0, 153.0, 108.0, 86.0, 0.0, 168.0, -22.0, 0.0, 137.0, 189.0, 181.0, 74.0, 173.0, 0.0, 0.0, 116.0, -136.0, 0.0, 0.0, 161.0, 0.0, 15.0, -175.0, 155.0, 174.0, 47.0, 0.0, -106.0, 155.0, 1.0, 1.0, 92.0, 200.0, -40.0, -27.0, 153.0, 170.0, 32.0, -71.0, 132.0, 0.0, 0.0, 200.0, 180.0, 164.0, -124.0, 176.0, 166.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 13.0, 2.0, 42.0, 64.0, 0.0, 20.0, 5.0, 17.0, 118.0, 93.0, 6.0, 0.0, 37.0, 3.0, 4.0, 8.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 11.0, 2.0, 82.0, 171.0, 0.0, 2.0, 0.0, 7.0, 5.0, 2.0, 6.0, 2.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 7.0, 0.0, 75.0, 55.0, 11.0, 3.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 8.0, 0.0, 3.0, 0.0, 11.0, 0.0, 42.0, 61.0, 0.0, 9.0, 14.0, 26.0, 7.0, 7.0, 0.0, 5.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 25.0, 94.0, 69.0, 0.0, 49.0, 31.0, 6.0, 0.0, 31.0, 25.0, 0.0, 9.0, 132.0, 0.0, 51.0, 56.0, 14.0, 13.0, 8.0, 5.0, 0.0, 0.0, 38.0, 26.0, 0.0, 18.0, 9.0, 0.0, 0.0, 0.0, 7.0, 0.0, 27.0, 13.0, 19.0, 39.0, 0.0, 0.0, 33.0, 59.0, 1.0, 5.0, 11.0, 0.0, 0.0, 1.0, 12.0, 16.0, 6.0, 23.0, 1.0, 3.0, 86.0, 7.0, 34.0, 76.0, 0.0, 0.0, 0.0, 0.0, 0.0, 46.0, 68.0, 0.0, 19.0, 20.0, 54.0, 40.0, 0.0, 0.0, 5.0, 20.0, 4.0, 19.0, 9.0, 4.0, 0.0, 21.0, 4.0, 0.0, 26.0, 30.0, 0.0, 0.0, 110.0, 90.0, 0.0, 0.0, 1.0, 3.0, 88.0, 60.0, 10.0, 11.0, 32.0, 42.0, 0.0, 102.0, 0.0, 64.0, 26.0, 5.0, 38.0, 72.0, 0.0, 15.0, 72.0, 71.0, 0.0, 10.0, 0.0, 0.0, 11.0, 1.0, 69.0, 71.0, 9.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7594982298232282, "mean_inference_ms": 4.816116458294523, "mean_action_processing_ms": 0.8889027387794411, "mean_env_wait_ms": 0.6181828087991467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013366222381591797, "StateBufferConnector_ms": 0.0052602291107177734, "ViewRequirementAgentConnector_ms": 0.23781096935272217}, "num_episodes": 22, "episode_return_max": 389.0, "episode_return_min": -49.0, "episode_return_mean": 174.03, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.23278761465377, "num_env_steps_trained_throughput_per_sec": 155.23278761465377, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 28240.501, "restore_workers_time_ms": 0.039, "training_step_time_ms": 28240.404, "sample_time_ms": 4822.224, "learn_time_ms": 23383.272, "learn_throughput": 171.062, "synch_weights_time_ms": 25.958}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 54, "trial_id": "f6b99_00000", "date": "2024-08-13_20-06-26", "timestamp": 1723593986, "time_this_iter_s": 25.8269259929657, "time_total_s": 1289.41574883461, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b60a7820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1289.41574883461, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 89.73055555555555, "ram_util_percent": 83.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3717879756417855, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2603502776256943, "policy_loss": -0.0071283287447556935, "vf_loss": 2.2670548301525217, "vf_explained_var": 0.015622200253148559, "kl": 0.008475570626422478, "entropy": 0.8457693981745886, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.038414131522809, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.555021805233426, "policy_loss": -0.002774526570460429, "vf_loss": 4.557645166235626, "vf_explained_var": 0.6855139762951583, "kl": 0.0040309268043125885, "entropy": 0.9723545447859184, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 375.0, "episode_reward_min": -49.0, "episode_reward_mean": 165.36, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -175.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 132.0}, "policy_reward_mean": {"prey_policy": 63.34, "predator_policy": 19.34}, "custom_metrics": {}, "hist_stats": {"episode_reward": [185.0, 323.0, 174.0, 358.0, 347.0, 161.0, -8.0, 375.0, 298.0, 27.0, 346.0, 200.0, 159.0, -4.0, 191.0, 107.0, 76.0, 137.0, 44.0, 178.0, 325.0, 84.0, 355.0, -34.0, 82.0, 121.0, 337.0, 0.0, 273.0, 281.0, 139.0, 0.0, 185.0, 134.0, 99.0, 0.0, 28.0, 82.0, 147.0, 115.0, 166.0, 309.0, 181.0, 158.0, -49.0, 0.0, 0.0, 286.0, 264.0, 120.0, 204.0, 306.0, 286.0, 109.0, 159.0, 158.0, 374.0, 303.0, 0.0, 180.0, 0.0, 165.0, -12.0, 350.0, 121.0, 151.0, 66.0, 323.0, 43.0, 338.0, 104.0, 142.0, 200.0, 356.0, 192.0, 175.0, 0.0, 372.0, -12.0, 84.0, 195.0, 192.0, 77.0, 150.0, 312.0, 108.0, 39.0, 178.0, 235.0, 318.0, 0.0, 207.0, 181.0, -29.0, 286.0, 200.0, 177.0, 370.0, 41.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [121.0, -66.0, 174.0, 135.0, 0.0, 169.0, 172.0, 186.0, 165.0, 182.0, 154.0, 0.0, -16.0, 0.0, 185.0, 187.0, 116.0, 171.0, -76.0, 0.0, 178.0, 159.0, 1.0, 159.0, 159.0, -14.0, -10.0, 1.0, 191.0, 0.0, 99.0, 0.0, 76.0, 0.0, -155.0, 173.0, -4.0, -21.0, 49.0, 49.0, 152.0, 167.0, 0.0, 28.0, 166.0, 180.0, -118.0, -48.0, -25.0, 0.0, 94.0, 0.0, 169.0, 155.0, 0.0, 0.0, 131.0, 78.0, 137.0, 126.0, 0.0, 130.0, 0.0, 0.0, -2.0, 180.0, 100.0, -6.0, 0.0, 41.0, 0.0, 0.0, 0.0, -64.0, 76.0, 0.0, 81.0, 55.0, 0.0, 114.0, 138.0, 0.0, 123.0, 157.0, 0.0, 177.0, -82.0, 147.0, -53.0, -106.0, 0.0, 0.0, 0.0, 0.0, 164.0, 76.0, -4.0, 200.0, -4.0, 85.0, 54.0, 56.0, 178.0, 128.0, 153.0, 108.0, 86.0, 0.0, 168.0, -22.0, 0.0, 137.0, 189.0, 181.0, 74.0, 173.0, 0.0, 0.0, 116.0, -136.0, 0.0, 0.0, 161.0, 0.0, 15.0, -175.0, 155.0, 174.0, 47.0, 0.0, -106.0, 155.0, 1.0, 1.0, 92.0, 200.0, -40.0, -27.0, 153.0, 170.0, 32.0, -71.0, 132.0, 0.0, 0.0, 200.0, 180.0, 164.0, -124.0, 176.0, 166.0, 0.0, 0.0, 0.0, 195.0, 177.0, -24.0, 0.0, 84.0, 0.0, 0.0, 194.0, 100.0, -10.0, 32.0, -14.0, 124.0, 0.0, 104.0, 173.0, 108.0, 0.0, -6.0, -36.0, 0.0, 167.0, 59.0, 126.0, 189.0, 58.0, 0.0, 0.0, 149.0, -94.0, 0.0, 174.0, 0.0, -139.0, 177.0, 109.0, 0.0, 200.0, 177.0, 0.0, 200.0, 158.0, -81.0, 0.0, 0.0, 200.0], "policy_predator_policy_reward": [75.0, 55.0, 11.0, 3.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 8.0, 0.0, 3.0, 0.0, 11.0, 0.0, 42.0, 61.0, 0.0, 9.0, 14.0, 26.0, 7.0, 7.0, 0.0, 5.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 25.0, 94.0, 69.0, 0.0, 49.0, 31.0, 6.0, 0.0, 31.0, 25.0, 0.0, 9.0, 132.0, 0.0, 51.0, 56.0, 14.0, 13.0, 8.0, 5.0, 0.0, 0.0, 38.0, 26.0, 0.0, 18.0, 9.0, 0.0, 0.0, 0.0, 7.0, 0.0, 27.0, 13.0, 19.0, 39.0, 0.0, 0.0, 33.0, 59.0, 1.0, 5.0, 11.0, 0.0, 0.0, 1.0, 12.0, 16.0, 6.0, 23.0, 1.0, 3.0, 86.0, 7.0, 34.0, 76.0, 0.0, 0.0, 0.0, 0.0, 0.0, 46.0, 68.0, 0.0, 19.0, 20.0, 54.0, 40.0, 0.0, 0.0, 5.0, 20.0, 4.0, 19.0, 9.0, 4.0, 0.0, 21.0, 4.0, 0.0, 26.0, 30.0, 0.0, 0.0, 110.0, 90.0, 0.0, 0.0, 1.0, 3.0, 88.0, 60.0, 10.0, 11.0, 32.0, 42.0, 0.0, 102.0, 0.0, 64.0, 26.0, 5.0, 38.0, 72.0, 0.0, 15.0, 72.0, 71.0, 0.0, 10.0, 0.0, 0.0, 11.0, 1.0, 69.0, 71.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 1.0, 0.0, 32.0, 70.0, 6.0, 53.0, 3.0, 23.0, 30.0, 5.0, 0.0, 0.0, 10.0, 71.0, 11.0, 0.0, 0.0, 50.0, 39.0, 32.0, 0.0, 0.0, 72.0, 80.0, 0.0, 7.0, 1.0, 109.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 5.0, 66.0, 56.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7496255424729383, "mean_inference_ms": 4.79859593983766, "mean_action_processing_ms": 0.8806998183732381, "mean_env_wait_ms": 0.6150556784287057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01085805892944336, "StateBufferConnector_ms": 0.0063141584396362305, "ViewRequirementAgentConnector_ms": 0.22304213047027588}, "num_episodes": 23, "episode_return_max": 375.0, "episode_return_min": -49.0, "episode_return_mean": 165.36, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 190.15708935934094, "num_env_steps_trained_throughput_per_sec": 190.15708935934094, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 27294.938, "restore_workers_time_ms": 0.041, "training_step_time_ms": 27294.837, "sample_time_ms": 4432.421, "learn_time_ms": 22828.299, "learn_throughput": 175.221, "synch_weights_time_ms": 24.765}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 55, "trial_id": "f6b99_00000", "date": "2024-08-13_20-06-47", "timestamp": 1723594007, "time_this_iter_s": 21.11645007133484, "time_total_s": 1310.5321989059448, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b60968b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1310.5321989059448, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 83.75333333333333, "ram_util_percent": 82.49000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3866720061453561, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9093633898351556, "policy_loss": -0.005572075602997627, "vf_loss": 2.914474997949348, "vf_explained_var": 0.0076653286578163265, "kl": 0.009209379274759202, "entropy": 0.7258091224879815, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.077551639300806, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.510491812670672, "policy_loss": -0.00032487492404740165, "vf_loss": 5.510626892564158, "vf_explained_var": 0.21209984768635382, "kl": 0.010122753203665078, "entropy": 0.890928282056536, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 396.0, "episode_reward_min": -138.0, "episode_reward_mean": 152.63, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -301.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 167.0}, "policy_reward_mean": {"prey_policy": 52.245, "predator_policy": 24.07}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.0, 178.0, 325.0, 84.0, 355.0, -34.0, 82.0, 121.0, 337.0, 0.0, 273.0, 281.0, 139.0, 0.0, 185.0, 134.0, 99.0, 0.0, 28.0, 82.0, 147.0, 115.0, 166.0, 309.0, 181.0, 158.0, -49.0, 0.0, 0.0, 286.0, 264.0, 120.0, 204.0, 306.0, 286.0, 109.0, 159.0, 158.0, 374.0, 303.0, 0.0, 180.0, 0.0, 165.0, -12.0, 350.0, 121.0, 151.0, 66.0, 323.0, 43.0, 338.0, 104.0, 142.0, 200.0, 356.0, 192.0, 175.0, 0.0, 372.0, -12.0, 84.0, 195.0, 192.0, 77.0, 150.0, 312.0, 108.0, 39.0, 178.0, 235.0, 318.0, 0.0, 207.0, 181.0, -29.0, 286.0, 200.0, 177.0, 370.0, 41.0, 200.0, 375.0, 26.0, -2.0, 56.0, 154.0, 43.0, 156.0, -134.0, 261.0, 317.0, 82.0, 110.0, 123.0, 396.0, -14.0, 372.0, -138.0, -4.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-4.0, -21.0, 49.0, 49.0, 152.0, 167.0, 0.0, 28.0, 166.0, 180.0, -118.0, -48.0, -25.0, 0.0, 94.0, 0.0, 169.0, 155.0, 0.0, 0.0, 131.0, 78.0, 137.0, 126.0, 0.0, 130.0, 0.0, 0.0, -2.0, 180.0, 100.0, -6.0, 0.0, 41.0, 0.0, 0.0, 0.0, -64.0, 76.0, 0.0, 81.0, 55.0, 0.0, 114.0, 138.0, 0.0, 123.0, 157.0, 0.0, 177.0, -82.0, 147.0, -53.0, -106.0, 0.0, 0.0, 0.0, 0.0, 164.0, 76.0, -4.0, 200.0, -4.0, 85.0, 54.0, 56.0, 178.0, 128.0, 153.0, 108.0, 86.0, 0.0, 168.0, -22.0, 0.0, 137.0, 189.0, 181.0, 74.0, 173.0, 0.0, 0.0, 116.0, -136.0, 0.0, 0.0, 161.0, 0.0, 15.0, -175.0, 155.0, 174.0, 47.0, 0.0, -106.0, 155.0, 1.0, 1.0, 92.0, 200.0, -40.0, -27.0, 153.0, 170.0, 32.0, -71.0, 132.0, 0.0, 0.0, 200.0, 180.0, 164.0, -124.0, 176.0, 166.0, 0.0, 0.0, 0.0, 195.0, 177.0, -24.0, 0.0, 84.0, 0.0, 0.0, 194.0, 100.0, -10.0, 32.0, -14.0, 124.0, 0.0, 104.0, 173.0, 108.0, 0.0, -6.0, -36.0, 0.0, 167.0, 59.0, 126.0, 189.0, 58.0, 0.0, 0.0, 149.0, -94.0, 0.0, 174.0, 0.0, -139.0, 177.0, 109.0, 0.0, 200.0, 177.0, 0.0, 200.0, 158.0, -81.0, 0.0, 0.0, 200.0, 185.0, 187.0, -64.0, -50.0, 0.0, -4.0, 2.0, -20.0, -278.0, 178.0, -170.0, 47.0, 0.0, 128.0, -19.0, -301.0, 162.0, 38.0, 164.0, 132.0, 0.0, 2.0, 61.0, -34.0, 0.0, 122.0, 194.0, 200.0, -160.0, 0.0, 197.0, 175.0, -8.0, -297.0, -16.0, 4.0], "policy_predator_policy_reward": [69.0, 0.0, 49.0, 31.0, 6.0, 0.0, 31.0, 25.0, 0.0, 9.0, 132.0, 0.0, 51.0, 56.0, 14.0, 13.0, 8.0, 5.0, 0.0, 0.0, 38.0, 26.0, 0.0, 18.0, 9.0, 0.0, 0.0, 0.0, 7.0, 0.0, 27.0, 13.0, 19.0, 39.0, 0.0, 0.0, 33.0, 59.0, 1.0, 5.0, 11.0, 0.0, 0.0, 1.0, 12.0, 16.0, 6.0, 23.0, 1.0, 3.0, 86.0, 7.0, 34.0, 76.0, 0.0, 0.0, 0.0, 0.0, 0.0, 46.0, 68.0, 0.0, 19.0, 20.0, 54.0, 40.0, 0.0, 0.0, 5.0, 20.0, 4.0, 19.0, 9.0, 4.0, 0.0, 21.0, 4.0, 0.0, 26.0, 30.0, 0.0, 0.0, 110.0, 90.0, 0.0, 0.0, 1.0, 3.0, 88.0, 60.0, 10.0, 11.0, 32.0, 42.0, 0.0, 102.0, 0.0, 64.0, 26.0, 5.0, 38.0, 72.0, 0.0, 15.0, 72.0, 71.0, 0.0, 10.0, 0.0, 0.0, 11.0, 1.0, 69.0, 71.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 1.0, 0.0, 32.0, 70.0, 6.0, 53.0, 3.0, 23.0, 30.0, 5.0, 0.0, 0.0, 10.0, 71.0, 11.0, 0.0, 0.0, 50.0, 39.0, 32.0, 0.0, 0.0, 72.0, 80.0, 0.0, 7.0, 1.0, 109.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 5.0, 66.0, 56.0, 0.0, 0.0, 0.0, 3.0, 71.0, 69.0, 0.0, 2.0, 62.0, 12.0, 138.0, 116.0, 128.0, 38.0, 14.0, 14.0, 19.0, 167.0, 61.0, 0.0, 0.0, 21.0, 20.0, 60.0, 71.0, 12.0, 0.0, 1.0, 0.0, 2.0, 104.0, 42.0, 0.0, 0.0, 163.0, 4.0, 0.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7437668060303975, "mean_inference_ms": 4.792243251654908, "mean_action_processing_ms": 0.875471426780341, "mean_env_wait_ms": 0.6138810413926978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005473971366882324, "StateBufferConnector_ms": 0.0066986083984375, "ViewRequirementAgentConnector_ms": 0.1988525390625}, "num_episodes": 18, "episode_return_max": 396.0, "episode_return_min": -138.0, "episode_return_mean": 152.63, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 148.02739035261706, "num_env_steps_trained_throughput_per_sec": 148.02739035261706, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 27508.677, "restore_workers_time_ms": 0.053, "training_step_time_ms": 27508.56, "sample_time_ms": 4567.352, "learn_time_ms": 22907.16, "learn_throughput": 174.618, "synch_weights_time_ms": 24.64}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 56, "trial_id": "f6b99_00000", "date": "2024-08-13_20-07-14", "timestamp": 1723594034, "time_this_iter_s": 27.083513975143433, "time_total_s": 1337.6157128810883, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b60a79d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1337.6157128810883, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 90.03589743589743, "ram_util_percent": 83.56666666666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4042425356214008, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.003019885915928, "policy_loss": -0.0034247243212703516, "vf_loss": 3.0061207366368126, "vf_explained_var": 0.00823275916790836, "kl": 0.006477351579594621, "entropy": 0.7287454328839741, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.72637152041077, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.039644156688105, "policy_loss": -0.001237599460146927, "vf_loss": 4.040663788558314, "vf_explained_var": 0.32534946565905576, "kl": 0.011624446672456564, "entropy": 0.97216986581762, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 396.0, "episode_reward_min": -138.0, "episode_reward_mean": 151.98, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -301.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 167.0}, "policy_reward_mean": {"prey_policy": 51.065, "predator_policy": 24.925}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.0, 82.0, 147.0, 115.0, 166.0, 309.0, 181.0, 158.0, -49.0, 0.0, 0.0, 286.0, 264.0, 120.0, 204.0, 306.0, 286.0, 109.0, 159.0, 158.0, 374.0, 303.0, 0.0, 180.0, 0.0, 165.0, -12.0, 350.0, 121.0, 151.0, 66.0, 323.0, 43.0, 338.0, 104.0, 142.0, 200.0, 356.0, 192.0, 175.0, 0.0, 372.0, -12.0, 84.0, 195.0, 192.0, 77.0, 150.0, 312.0, 108.0, 39.0, 178.0, 235.0, 318.0, 0.0, 207.0, 181.0, -29.0, 286.0, 200.0, 177.0, 370.0, 41.0, 200.0, 375.0, 26.0, -2.0, 56.0, 154.0, 43.0, 156.0, -134.0, 261.0, 317.0, 82.0, 110.0, 123.0, 396.0, -14.0, 372.0, -138.0, -4.0, 262.0, 288.0, 172.0, 62.0, 42.0, 6.0, 176.0, 0.0, 179.0, 0.0, 135.0, -113.0, 240.0, 178.0, 381.0, 263.0, 85.0, 182.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -64.0, 76.0, 0.0, 81.0, 55.0, 0.0, 114.0, 138.0, 0.0, 123.0, 157.0, 0.0, 177.0, -82.0, 147.0, -53.0, -106.0, 0.0, 0.0, 0.0, 0.0, 164.0, 76.0, -4.0, 200.0, -4.0, 85.0, 54.0, 56.0, 178.0, 128.0, 153.0, 108.0, 86.0, 0.0, 168.0, -22.0, 0.0, 137.0, 189.0, 181.0, 74.0, 173.0, 0.0, 0.0, 116.0, -136.0, 0.0, 0.0, 161.0, 0.0, 15.0, -175.0, 155.0, 174.0, 47.0, 0.0, -106.0, 155.0, 1.0, 1.0, 92.0, 200.0, -40.0, -27.0, 153.0, 170.0, 32.0, -71.0, 132.0, 0.0, 0.0, 200.0, 180.0, 164.0, -124.0, 176.0, 166.0, 0.0, 0.0, 0.0, 195.0, 177.0, -24.0, 0.0, 84.0, 0.0, 0.0, 194.0, 100.0, -10.0, 32.0, -14.0, 124.0, 0.0, 104.0, 173.0, 108.0, 0.0, -6.0, -36.0, 0.0, 167.0, 59.0, 126.0, 189.0, 58.0, 0.0, 0.0, 149.0, -94.0, 0.0, 174.0, 0.0, -139.0, 177.0, 109.0, 0.0, 200.0, 177.0, 0.0, 200.0, 158.0, -81.0, 0.0, 0.0, 200.0, 185.0, 187.0, -64.0, -50.0, 0.0, -4.0, 2.0, -20.0, -278.0, 178.0, -170.0, 47.0, 0.0, 128.0, -19.0, -301.0, 162.0, 38.0, 164.0, 132.0, 0.0, 2.0, 61.0, -34.0, 0.0, 122.0, 194.0, 200.0, -160.0, 0.0, 197.0, 175.0, -8.0, -297.0, -16.0, 4.0, 34.0, 167.0, 187.0, 43.0, 147.0, 0.0, 0.0, 1.0, -3.0, -22.0, 0.0, -89.0, 173.0, 0.0, 0.0, 0.0, 0.0, 171.0, 0.0, 0.0, -106.0, 116.0, -79.0, -260.0, 62.0, 123.0, 0.0, 178.0, 188.0, 193.0, 29.0, 175.0, 0.0, 68.0, 0.0, 176.0], "policy_predator_policy_reward": [33.0, 59.0, 1.0, 5.0, 11.0, 0.0, 0.0, 1.0, 12.0, 16.0, 6.0, 23.0, 1.0, 3.0, 86.0, 7.0, 34.0, 76.0, 0.0, 0.0, 0.0, 0.0, 0.0, 46.0, 68.0, 0.0, 19.0, 20.0, 54.0, 40.0, 0.0, 0.0, 5.0, 20.0, 4.0, 19.0, 9.0, 4.0, 0.0, 21.0, 4.0, 0.0, 26.0, 30.0, 0.0, 0.0, 110.0, 90.0, 0.0, 0.0, 1.0, 3.0, 88.0, 60.0, 10.0, 11.0, 32.0, 42.0, 0.0, 102.0, 0.0, 64.0, 26.0, 5.0, 38.0, 72.0, 0.0, 15.0, 72.0, 71.0, 0.0, 10.0, 0.0, 0.0, 11.0, 1.0, 69.0, 71.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 1.0, 0.0, 32.0, 70.0, 6.0, 53.0, 3.0, 23.0, 30.0, 5.0, 0.0, 0.0, 10.0, 71.0, 11.0, 0.0, 0.0, 50.0, 39.0, 32.0, 0.0, 0.0, 72.0, 80.0, 0.0, 7.0, 1.0, 109.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 5.0, 66.0, 56.0, 0.0, 0.0, 0.0, 3.0, 71.0, 69.0, 0.0, 2.0, 62.0, 12.0, 138.0, 116.0, 128.0, 38.0, 14.0, 14.0, 19.0, 167.0, 61.0, 0.0, 0.0, 21.0, 20.0, 60.0, 71.0, 12.0, 0.0, 1.0, 0.0, 2.0, 104.0, 42.0, 0.0, 0.0, 163.0, 4.0, 0.0, 8.0, 5.0, 56.0, 38.0, 20.0, 10.0, 15.0, 61.0, 0.0, 58.0, 9.0, 0.0, 95.0, 3.0, 0.0, 0.0, 0.0, 7.0, 1.0, 0.0, 0.0, 15.0, 110.0, 89.0, 137.0, 10.0, 45.0, 0.0, 0.0, 0.0, 0.0, 29.0, 30.0, 0.0, 17.0, 6.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7391535618090064, "mean_inference_ms": 4.787020851033169, "mean_action_processing_ms": 0.8706635874519658, "mean_env_wait_ms": 0.6129232286231749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01062154769897461, "StateBufferConnector_ms": 0.0074340105056762695, "ViewRequirementAgentConnector_ms": 0.22084295749664307}, "num_episodes": 18, "episode_return_max": 396.0, "episode_return_min": -138.0, "episode_return_mean": 151.98, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 185.1972303584788, "num_env_steps_trained_throughput_per_sec": 185.1972303584788, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 27262.516, "restore_workers_time_ms": 0.054, "training_step_time_ms": 27262.387, "sample_time_ms": 4561.982, "learn_time_ms": 22666.359, "learn_throughput": 176.473, "synch_weights_time_ms": 24.128}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 57, "trial_id": "f6b99_00000", "date": "2024-08-13_20-07-36", "timestamp": 1723594056, "time_this_iter_s": 21.633265018463135, "time_total_s": 1359.2489778995514, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6024ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1359.2489778995514, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 83.58333333333333, "ram_util_percent": 83.61}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3353947659964285, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.133633807632658, "policy_loss": -0.004447884528858282, "vf_loss": 2.1376702177461495, "vf_explained_var": 0.0065139998834599895, "kl": 0.008229395041827514, "entropy": 0.6908345826088436, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.607405116129174, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.511379184924736, "policy_loss": -0.0037726679678868366, "vf_loss": 3.515032071663589, "vf_explained_var": 0.24022394204265857, "kl": 0.006388663573755381, "entropy": 1.0259378053208508, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 396.0, "episode_reward_min": -138.0, "episode_reward_mean": 136.59, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -331.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 173.0}, "policy_reward_mean": {"prey_policy": 41.57, "predator_policy": 26.725}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 180.0, 0.0, 165.0, -12.0, 350.0, 121.0, 151.0, 66.0, 323.0, 43.0, 338.0, 104.0, 142.0, 200.0, 356.0, 192.0, 175.0, 0.0, 372.0, -12.0, 84.0, 195.0, 192.0, 77.0, 150.0, 312.0, 108.0, 39.0, 178.0, 235.0, 318.0, 0.0, 207.0, 181.0, -29.0, 286.0, 200.0, 177.0, 370.0, 41.0, 200.0, 375.0, 26.0, -2.0, 56.0, 154.0, 43.0, 156.0, -134.0, 261.0, 317.0, 82.0, 110.0, 123.0, 396.0, -14.0, 372.0, -138.0, -4.0, 262.0, 288.0, 172.0, 62.0, 42.0, 6.0, 176.0, 0.0, 179.0, 0.0, 135.0, -113.0, 240.0, 178.0, 381.0, 263.0, 85.0, 182.0, 126.0, 152.0, -7.0, 161.0, 137.0, 177.0, 248.0, 78.0, 242.0, 0.0, 203.0, -42.0, 146.0, 60.0, 148.0, -29.0, 66.0, 153.0, -13.0, -3.0, -108.0, 272.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 116.0, -136.0, 0.0, 0.0, 161.0, 0.0, 15.0, -175.0, 155.0, 174.0, 47.0, 0.0, -106.0, 155.0, 1.0, 1.0, 92.0, 200.0, -40.0, -27.0, 153.0, 170.0, 32.0, -71.0, 132.0, 0.0, 0.0, 200.0, 180.0, 164.0, -124.0, 176.0, 166.0, 0.0, 0.0, 0.0, 195.0, 177.0, -24.0, 0.0, 84.0, 0.0, 0.0, 194.0, 100.0, -10.0, 32.0, -14.0, 124.0, 0.0, 104.0, 173.0, 108.0, 0.0, -6.0, -36.0, 0.0, 167.0, 59.0, 126.0, 189.0, 58.0, 0.0, 0.0, 149.0, -94.0, 0.0, 174.0, 0.0, -139.0, 177.0, 109.0, 0.0, 200.0, 177.0, 0.0, 200.0, 158.0, -81.0, 0.0, 0.0, 200.0, 185.0, 187.0, -64.0, -50.0, 0.0, -4.0, 2.0, -20.0, -278.0, 178.0, -170.0, 47.0, 0.0, 128.0, -19.0, -301.0, 162.0, 38.0, 164.0, 132.0, 0.0, 2.0, 61.0, -34.0, 0.0, 122.0, 194.0, 200.0, -160.0, 0.0, 197.0, 175.0, -8.0, -297.0, -16.0, 4.0, 34.0, 167.0, 187.0, 43.0, 147.0, 0.0, 0.0, 1.0, -3.0, -22.0, 0.0, -89.0, 173.0, 0.0, 0.0, 0.0, 0.0, 171.0, 0.0, 0.0, -106.0, 116.0, -79.0, -260.0, 62.0, 123.0, 0.0, 178.0, 188.0, 193.0, 29.0, 175.0, 0.0, 68.0, 0.0, 176.0, 0.0, 74.0, 148.0, -1.0, -14.0, 0.0, -60.0, 116.0, -4.0, 112.0, 0.0, 158.0, 74.0, 83.0, -76.0, 30.0, 29.0, 139.0, 0.0, 0.0, 164.0, -37.0, 82.0, -286.0, 144.0, 2.0, 41.0, 0.0, 122.0, -4.0, -20.0, -24.0, 0.0, -4.0, -6.0, 152.0, -12.0, -14.0, -6.0, 0.0, -331.0, 1.0, 84.0, 188.0], "policy_predator_policy_reward": [0.0, 0.0, 110.0, 90.0, 0.0, 0.0, 1.0, 3.0, 88.0, 60.0, 10.0, 11.0, 32.0, 42.0, 0.0, 102.0, 0.0, 64.0, 26.0, 5.0, 38.0, 72.0, 0.0, 15.0, 72.0, 71.0, 0.0, 10.0, 0.0, 0.0, 11.0, 1.0, 69.0, 71.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 1.0, 0.0, 32.0, 70.0, 6.0, 53.0, 3.0, 23.0, 30.0, 5.0, 0.0, 0.0, 10.0, 71.0, 11.0, 0.0, 0.0, 50.0, 39.0, 32.0, 0.0, 0.0, 72.0, 80.0, 0.0, 7.0, 1.0, 109.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 5.0, 66.0, 56.0, 0.0, 0.0, 0.0, 3.0, 71.0, 69.0, 0.0, 2.0, 62.0, 12.0, 138.0, 116.0, 128.0, 38.0, 14.0, 14.0, 19.0, 167.0, 61.0, 0.0, 0.0, 21.0, 20.0, 60.0, 71.0, 12.0, 0.0, 1.0, 0.0, 2.0, 104.0, 42.0, 0.0, 0.0, 163.0, 4.0, 0.0, 8.0, 5.0, 56.0, 38.0, 20.0, 10.0, 15.0, 61.0, 0.0, 58.0, 9.0, 0.0, 95.0, 3.0, 0.0, 0.0, 0.0, 7.0, 1.0, 0.0, 0.0, 15.0, 110.0, 89.0, 137.0, 10.0, 45.0, 0.0, 0.0, 0.0, 0.0, 29.0, 30.0, 0.0, 17.0, 6.0, 0.0, 42.0, 10.0, 5.0, 0.0, 0.0, 7.0, 95.0, 10.0, 27.0, 2.0, 9.0, 10.0, 52.0, 39.0, 13.0, 111.0, 58.0, 16.0, 0.0, 0.0, 26.0, 50.0, 162.0, 0.0, 0.0, 0.0, 17.0, 2.0, 15.0, 15.0, 0.0, 15.0, 24.0, 46.0, 4.0, 3.0, 6.0, 7.0, 0.0, 3.0, 173.0, 49.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7328124866331496, "mean_inference_ms": 4.782036747546432, "mean_action_processing_ms": 0.8702419082703247, "mean_env_wait_ms": 0.6125919338006572, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009691119194030762, "StateBufferConnector_ms": 0.007306814193725586, "ViewRequirementAgentConnector_ms": 0.21605277061462402}, "num_episodes": 22, "episode_return_max": 396.0, "episode_return_min": -138.0, "episode_return_mean": 136.59, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 163.43157268936454, "num_env_steps_trained_throughput_per_sec": 163.43157268936454, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 27136.49, "restore_workers_time_ms": 0.055, "training_step_time_ms": 27136.36, "sample_time_ms": 4684.923, "learn_time_ms": 22412.63, "learn_throughput": 178.471, "synch_weights_time_ms": 28.711}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 58, "trial_id": "f6b99_00000", "date": "2024-08-13_20-08-01", "timestamp": 1723594081, "time_this_iter_s": 24.690075874328613, "time_total_s": 1383.93905377388, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6087d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1383.93905377388, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 84.3457142857143, "ram_util_percent": 83.80571428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7225896635383524, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.271260035731805, "policy_loss": -0.007543840915058301, "vf_loss": 5.278264403343201, "vf_explained_var": 0.012987190642684856, "kl": 0.010789777073429605, "entropy": 0.6633717825803808, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.575153477860506, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.7531576673820535, "policy_loss": -0.008230807569380555, "vf_loss": 5.7610985786195785, "vf_explained_var": -0.022394855154885186, "kl": 0.015461526467978002, "entropy": 0.8745173104541012, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "env_runners": {"episode_reward_max": 396.0, "episode_reward_min": -138.0, "episode_reward_mean": 123.62, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -364.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 173.0}, "policy_reward_mean": {"prey_policy": 31.95, "predator_policy": 29.86}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 372.0, -12.0, 84.0, 195.0, 192.0, 77.0, 150.0, 312.0, 108.0, 39.0, 178.0, 235.0, 318.0, 0.0, 207.0, 181.0, -29.0, 286.0, 200.0, 177.0, 370.0, 41.0, 200.0, 375.0, 26.0, -2.0, 56.0, 154.0, 43.0, 156.0, -134.0, 261.0, 317.0, 82.0, 110.0, 123.0, 396.0, -14.0, 372.0, -138.0, -4.0, 262.0, 288.0, 172.0, 62.0, 42.0, 6.0, 176.0, 0.0, 179.0, 0.0, 135.0, -113.0, 240.0, 178.0, 381.0, 263.0, 85.0, 182.0, 126.0, 152.0, -7.0, 161.0, 137.0, 177.0, 248.0, 78.0, 242.0, 0.0, 203.0, -42.0, 146.0, 60.0, 148.0, -29.0, 66.0, 153.0, -13.0, -3.0, -108.0, 272.0, 15.0, -113.0, 250.0, 179.0, 79.0, 10.0, 276.0, 157.0, 0.0, 1.0, 168.0, 140.0, 166.0, 106.0, -55.0, 219.0, 57.0, -58.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 195.0, 177.0, -24.0, 0.0, 84.0, 0.0, 0.0, 194.0, 100.0, -10.0, 32.0, -14.0, 124.0, 0.0, 104.0, 173.0, 108.0, 0.0, -6.0, -36.0, 0.0, 167.0, 59.0, 126.0, 189.0, 58.0, 0.0, 0.0, 149.0, -94.0, 0.0, 174.0, 0.0, -139.0, 177.0, 109.0, 0.0, 200.0, 177.0, 0.0, 200.0, 158.0, -81.0, 0.0, 0.0, 200.0, 185.0, 187.0, -64.0, -50.0, 0.0, -4.0, 2.0, -20.0, -278.0, 178.0, -170.0, 47.0, 0.0, 128.0, -19.0, -301.0, 162.0, 38.0, 164.0, 132.0, 0.0, 2.0, 61.0, -34.0, 0.0, 122.0, 194.0, 200.0, -160.0, 0.0, 197.0, 175.0, -8.0, -297.0, -16.0, 4.0, 34.0, 167.0, 187.0, 43.0, 147.0, 0.0, 0.0, 1.0, -3.0, -22.0, 0.0, -89.0, 173.0, 0.0, 0.0, 0.0, 0.0, 171.0, 0.0, 0.0, -106.0, 116.0, -79.0, -260.0, 62.0, 123.0, 0.0, 178.0, 188.0, 193.0, 29.0, 175.0, 0.0, 68.0, 0.0, 176.0, 0.0, 74.0, 148.0, -1.0, -14.0, 0.0, -60.0, 116.0, -4.0, 112.0, 0.0, 158.0, 74.0, 83.0, -76.0, 30.0, 29.0, 139.0, 0.0, 0.0, 164.0, -37.0, 82.0, -286.0, 144.0, 2.0, 41.0, 0.0, 122.0, -4.0, -20.0, -24.0, 0.0, -4.0, -6.0, 152.0, -12.0, -14.0, -6.0, 0.0, -331.0, 1.0, 84.0, 188.0, -92.0, 1.0, -25.0, -361.0, 164.0, 11.0, 0.0, 179.0, 0.0, 13.0, -364.0, 57.0, 182.0, 88.0, 11.0, 63.0, 0.0, 0.0, 6.0, -127.0, 170.0, -22.0, 0.0, 110.0, 129.0, -73.0, -1.0, 54.0, 0.0, -180.0, 138.0, -21.0, -38.0, 14.0, -199.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 1.0, 0.0, 32.0, 70.0, 6.0, 53.0, 3.0, 23.0, 30.0, 5.0, 0.0, 0.0, 10.0, 71.0, 11.0, 0.0, 0.0, 50.0, 39.0, 32.0, 0.0, 0.0, 72.0, 80.0, 0.0, 7.0, 1.0, 109.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 5.0, 66.0, 56.0, 0.0, 0.0, 0.0, 3.0, 71.0, 69.0, 0.0, 2.0, 62.0, 12.0, 138.0, 116.0, 128.0, 38.0, 14.0, 14.0, 19.0, 167.0, 61.0, 0.0, 0.0, 21.0, 20.0, 60.0, 71.0, 12.0, 0.0, 1.0, 0.0, 2.0, 104.0, 42.0, 0.0, 0.0, 163.0, 4.0, 0.0, 8.0, 5.0, 56.0, 38.0, 20.0, 10.0, 15.0, 61.0, 0.0, 58.0, 9.0, 0.0, 95.0, 3.0, 0.0, 0.0, 0.0, 7.0, 1.0, 0.0, 0.0, 15.0, 110.0, 89.0, 137.0, 10.0, 45.0, 0.0, 0.0, 0.0, 0.0, 29.0, 30.0, 0.0, 17.0, 6.0, 0.0, 42.0, 10.0, 5.0, 0.0, 0.0, 7.0, 95.0, 10.0, 27.0, 2.0, 9.0, 10.0, 52.0, 39.0, 13.0, 111.0, 58.0, 16.0, 0.0, 0.0, 26.0, 50.0, 162.0, 0.0, 0.0, 0.0, 17.0, 2.0, 15.0, 15.0, 0.0, 15.0, 24.0, 46.0, 4.0, 3.0, 6.0, 7.0, 0.0, 3.0, 173.0, 49.0, 0.0, 0.0, 70.0, 36.0, 134.0, 139.0, 12.0, 63.0, 0.0, 0.0, 22.0, 44.0, 152.0, 165.0, 6.0, 0.0, 2.0, 81.0, 0.0, 0.0, 13.0, 109.0, 9.0, 11.0, 10.0, 20.0, 67.0, 43.0, 15.0, 38.0, 20.0, 105.0, 42.0, 60.0, 42.0, 39.0, 78.0, 63.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.725788963676311, "mean_inference_ms": 4.769669616447615, "mean_action_processing_ms": 0.8606170115069756, "mean_env_wait_ms": 0.60943970073594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010084271430969238, "StateBufferConnector_ms": 0.009567499160766602, "ViewRequirementAgentConnector_ms": 0.31172192096710205}, "num_episodes": 18, "episode_return_max": 396.0, "episode_return_min": -138.0, "episode_return_mean": 123.62, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 117.02870285729045, "num_env_steps_trained_throughput_per_sec": 117.02870285729045, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 25633.643, "restore_workers_time_ms": 0.054, "training_step_time_ms": 25633.517, "sample_time_ms": 3553.132, "learn_time_ms": 22040.933, "learn_throughput": 181.481, "synch_weights_time_ms": 29.861}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "training_iteration": 59, "trial_id": "f6b99_00000", "date": "2024-08-13_20-08-35", "timestamp": 1723594115, "time_this_iter_s": 34.365498065948486, "time_total_s": 1418.3045518398285, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b605bb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1418.3045518398285, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 94.47291666666665, "ram_util_percent": 83.86041666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.42136237094642, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.005074652288326, "policy_loss": -0.004900539650276264, "vf_loss": 4.009486026234097, "vf_explained_var": 0.01097354907838125, "kl": 0.009783320214258493, "entropy": 0.6483277768685074, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.988606390845838, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.4124292846709965, "policy_loss": -0.0031116923659783666, "vf_loss": 5.415373999984176, "vf_explained_var": 0.028347649492283977, "kl": 0.008905124712934245, "entropy": 0.7875149049456157, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 396.0, "episode_reward_min": -163.0, "episode_reward_mean": 102.97, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -364.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 173.0}, "policy_reward_mean": {"prey_policy": 14.915, "predator_policy": 36.57}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 375.0, 26.0, -2.0, 56.0, 154.0, 43.0, 156.0, -134.0, 261.0, 317.0, 82.0, 110.0, 123.0, 396.0, -14.0, 372.0, -138.0, -4.0, 262.0, 288.0, 172.0, 62.0, 42.0, 6.0, 176.0, 0.0, 179.0, 0.0, 135.0, -113.0, 240.0, 178.0, 381.0, 263.0, 85.0, 182.0, 126.0, 152.0, -7.0, 161.0, 137.0, 177.0, 248.0, 78.0, 242.0, 0.0, 203.0, -42.0, 146.0, 60.0, 148.0, -29.0, 66.0, 153.0, -13.0, -3.0, -108.0, 272.0, 15.0, -113.0, 250.0, 179.0, 79.0, 10.0, 276.0, 157.0, 0.0, 1.0, 168.0, 140.0, 166.0, 106.0, -55.0, 219.0, 57.0, -58.0, 278.0, 168.0, 162.0, 10.0, 123.0, 67.0, 294.0, 34.0, -84.0, -163.0, 100.0, 26.0, 64.0, 26.0, 146.0, 135.0, -53.0, 225.0, -27.0, -78.0, 36.0, -112.0, 239.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 200.0, 185.0, 187.0, -64.0, -50.0, 0.0, -4.0, 2.0, -20.0, -278.0, 178.0, -170.0, 47.0, 0.0, 128.0, -19.0, -301.0, 162.0, 38.0, 164.0, 132.0, 0.0, 2.0, 61.0, -34.0, 0.0, 122.0, 194.0, 200.0, -160.0, 0.0, 197.0, 175.0, -8.0, -297.0, -16.0, 4.0, 34.0, 167.0, 187.0, 43.0, 147.0, 0.0, 0.0, 1.0, -3.0, -22.0, 0.0, -89.0, 173.0, 0.0, 0.0, 0.0, 0.0, 171.0, 0.0, 0.0, -106.0, 116.0, -79.0, -260.0, 62.0, 123.0, 0.0, 178.0, 188.0, 193.0, 29.0, 175.0, 0.0, 68.0, 0.0, 176.0, 0.0, 74.0, 148.0, -1.0, -14.0, 0.0, -60.0, 116.0, -4.0, 112.0, 0.0, 158.0, 74.0, 83.0, -76.0, 30.0, 29.0, 139.0, 0.0, 0.0, 164.0, -37.0, 82.0, -286.0, 144.0, 2.0, 41.0, 0.0, 122.0, -4.0, -20.0, -24.0, 0.0, -4.0, -6.0, 152.0, -12.0, -14.0, -6.0, 0.0, -331.0, 1.0, 84.0, 188.0, -92.0, 1.0, -25.0, -361.0, 164.0, 11.0, 0.0, 179.0, 0.0, 13.0, -364.0, 57.0, 182.0, 88.0, 11.0, 63.0, 0.0, 0.0, 6.0, -127.0, 170.0, -22.0, 0.0, 110.0, 129.0, -73.0, -1.0, 54.0, 0.0, -180.0, 138.0, -21.0, -38.0, 14.0, -199.0, 0.0, 98.0, 167.0, -78.0, 116.0, 141.0, 0.0, -179.0, -37.0, 88.0, 0.0, 39.0, -91.0, 161.0, 89.0, 0.0, 34.0, -226.0, 0.0, -230.0, -96.0, -29.0, 55.0, -61.0, 0.0, 0.0, -4.0, 0.0, -62.0, 131.0, 0.0, 0.0, 119.0, -17.0, -144.0, 62.0, 110.0, -22.0, -127.0, -227.0, 12.0, -52.0, -50.0, -280.0, -26.0, 200.0, -161.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 3.0, 71.0, 69.0, 0.0, 2.0, 62.0, 12.0, 138.0, 116.0, 128.0, 38.0, 14.0, 14.0, 19.0, 167.0, 61.0, 0.0, 0.0, 21.0, 20.0, 60.0, 71.0, 12.0, 0.0, 1.0, 0.0, 2.0, 104.0, 42.0, 0.0, 0.0, 163.0, 4.0, 0.0, 8.0, 5.0, 56.0, 38.0, 20.0, 10.0, 15.0, 61.0, 0.0, 58.0, 9.0, 0.0, 95.0, 3.0, 0.0, 0.0, 0.0, 7.0, 1.0, 0.0, 0.0, 15.0, 110.0, 89.0, 137.0, 10.0, 45.0, 0.0, 0.0, 0.0, 0.0, 29.0, 30.0, 0.0, 17.0, 6.0, 0.0, 42.0, 10.0, 5.0, 0.0, 0.0, 7.0, 95.0, 10.0, 27.0, 2.0, 9.0, 10.0, 52.0, 39.0, 13.0, 111.0, 58.0, 16.0, 0.0, 0.0, 26.0, 50.0, 162.0, 0.0, 0.0, 0.0, 17.0, 2.0, 15.0, 15.0, 0.0, 15.0, 24.0, 46.0, 4.0, 3.0, 6.0, 7.0, 0.0, 3.0, 173.0, 49.0, 0.0, 0.0, 70.0, 36.0, 134.0, 139.0, 12.0, 63.0, 0.0, 0.0, 22.0, 44.0, 152.0, 165.0, 6.0, 0.0, 2.0, 81.0, 0.0, 0.0, 13.0, 109.0, 9.0, 11.0, 10.0, 20.0, 67.0, 43.0, 15.0, 38.0, 20.0, 105.0, 42.0, 60.0, 42.0, 39.0, 78.0, 63.0, 0.0, 13.0, 30.0, 100.0, 9.0, 12.0, 149.0, 77.0, 20.0, 15.0, 81.0, 38.0, 31.0, 13.0, 0.0, 0.0, 2.0, 140.0, 22.0, 141.0, 0.0, 74.0, 76.0, 11.0, 38.0, 30.0, 26.0, 62.0, 15.0, 0.0, 16.0, 0.0, 73.0, 35.0, 43.0, 10.0, 101.0, 21.0, 131.0, 6.0, 73.0, 65.0, 127.0, 67.0, 97.0, 103.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7195314000097708, "mean_inference_ms": 4.761355388505595, "mean_action_processing_ms": 0.8550745578903435, "mean_env_wait_ms": 0.6071893023034941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014656782150268555, "StateBufferConnector_ms": 0.01075279712677002, "ViewRequirementAgentConnector_ms": 0.3330620527267456}, "num_episodes": 23, "episode_return_max": 396.0, "episode_return_min": -163.0, "episode_return_mean": 102.97, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 183.0392017311181, "num_env_steps_trained_throughput_per_sec": 183.0392017311181, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 25002.077, "restore_workers_time_ms": 0.049, "training_step_time_ms": 25001.961, "sample_time_ms": 3452.867, "learn_time_ms": 21510.631, "learn_throughput": 185.955, "synch_weights_time_ms": 28.775}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 60, "trial_id": "f6b99_00000", "date": "2024-08-13_20-08-57", "timestamp": 1723594137, "time_this_iter_s": 21.907469034194946, "time_total_s": 1440.2120208740234, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6087e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1440.2120208740234, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 85.70322580645161, "ram_util_percent": 84.05806451612902}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4959042935932756, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5763561880777752, "policy_loss": -0.004317680248256438, "vf_loss": 2.5803353289447766, "vf_explained_var": 0.01702920258360565, "kl": 0.006770894996910977, "entropy": 0.675719057977515, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.479219191572653, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.273238888871733, "policy_loss": -0.003914597755909045, "vf_loss": 4.277017873809451, "vf_explained_var": 0.6098261366445551, "kl": 0.007232775518440619, "entropy": 0.8376441964396724, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "env_runners": {"episode_reward_max": 381.0, "episode_reward_min": -163.0, "episode_reward_mean": 99.96, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -364.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 173.0}, "policy_reward_mean": {"prey_policy": 16.53, "predator_policy": 33.45}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, 262.0, 288.0, 172.0, 62.0, 42.0, 6.0, 176.0, 0.0, 179.0, 0.0, 135.0, -113.0, 240.0, 178.0, 381.0, 263.0, 85.0, 182.0, 126.0, 152.0, -7.0, 161.0, 137.0, 177.0, 248.0, 78.0, 242.0, 0.0, 203.0, -42.0, 146.0, 60.0, 148.0, -29.0, 66.0, 153.0, -13.0, -3.0, -108.0, 272.0, 15.0, -113.0, 250.0, 179.0, 79.0, 10.0, 276.0, 157.0, 0.0, 1.0, 168.0, 140.0, 166.0, 106.0, -55.0, 219.0, 57.0, -58.0, 278.0, 168.0, 162.0, 10.0, 123.0, 67.0, 294.0, 34.0, -84.0, -163.0, 100.0, 26.0, 64.0, 26.0, 146.0, 135.0, -53.0, 225.0, -27.0, -78.0, 36.0, -112.0, 239.0, 154.0, 142.0, 146.0, 325.0, -13.0, 217.0, 243.0, 100.0, 139.0, 146.0, -18.0, -34.0, -1.0, 64.0, 0.0, 134.0, 116.0, 222.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-16.0, 4.0, 34.0, 167.0, 187.0, 43.0, 147.0, 0.0, 0.0, 1.0, -3.0, -22.0, 0.0, -89.0, 173.0, 0.0, 0.0, 0.0, 0.0, 171.0, 0.0, 0.0, -106.0, 116.0, -79.0, -260.0, 62.0, 123.0, 0.0, 178.0, 188.0, 193.0, 29.0, 175.0, 0.0, 68.0, 0.0, 176.0, 0.0, 74.0, 148.0, -1.0, -14.0, 0.0, -60.0, 116.0, -4.0, 112.0, 0.0, 158.0, 74.0, 83.0, -76.0, 30.0, 29.0, 139.0, 0.0, 0.0, 164.0, -37.0, 82.0, -286.0, 144.0, 2.0, 41.0, 0.0, 122.0, -4.0, -20.0, -24.0, 0.0, -4.0, -6.0, 152.0, -12.0, -14.0, -6.0, 0.0, -331.0, 1.0, 84.0, 188.0, -92.0, 1.0, -25.0, -361.0, 164.0, 11.0, 0.0, 179.0, 0.0, 13.0, -364.0, 57.0, 182.0, 88.0, 11.0, 63.0, 0.0, 0.0, 6.0, -127.0, 170.0, -22.0, 0.0, 110.0, 129.0, -73.0, -1.0, 54.0, 0.0, -180.0, 138.0, -21.0, -38.0, 14.0, -199.0, 0.0, 98.0, 167.0, -78.0, 116.0, 141.0, 0.0, -179.0, -37.0, 88.0, 0.0, 39.0, -91.0, 161.0, 89.0, 0.0, 34.0, -226.0, 0.0, -230.0, -96.0, -29.0, 55.0, -61.0, 0.0, 0.0, -4.0, 0.0, -62.0, 131.0, 0.0, 0.0, 119.0, -17.0, -144.0, 62.0, 110.0, -22.0, -127.0, -227.0, 12.0, -52.0, -50.0, -280.0, -26.0, 200.0, -161.0, 0.0, 143.0, -20.0, 123.0, 0.0, 120.0, 152.0, 162.0, -103.0, -25.0, 24.0, 110.0, 146.0, 39.0, 106.0, -18.0, 112.0, 0.0, 104.0, 0.0, -126.0, 0.0, 0.0, -135.0, -21.0, -6.0, -12.0, 53.0, 0.0, 0.0, 138.0, -20.0, -16.0, 120.0, 95.0, 47.0], "policy_predator_policy_reward": [0.0, 8.0, 5.0, 56.0, 38.0, 20.0, 10.0, 15.0, 61.0, 0.0, 58.0, 9.0, 0.0, 95.0, 3.0, 0.0, 0.0, 0.0, 7.0, 1.0, 0.0, 0.0, 15.0, 110.0, 89.0, 137.0, 10.0, 45.0, 0.0, 0.0, 0.0, 0.0, 29.0, 30.0, 0.0, 17.0, 6.0, 0.0, 42.0, 10.0, 5.0, 0.0, 0.0, 7.0, 95.0, 10.0, 27.0, 2.0, 9.0, 10.0, 52.0, 39.0, 13.0, 111.0, 58.0, 16.0, 0.0, 0.0, 26.0, 50.0, 162.0, 0.0, 0.0, 0.0, 17.0, 2.0, 15.0, 15.0, 0.0, 15.0, 24.0, 46.0, 4.0, 3.0, 6.0, 7.0, 0.0, 3.0, 173.0, 49.0, 0.0, 0.0, 70.0, 36.0, 134.0, 139.0, 12.0, 63.0, 0.0, 0.0, 22.0, 44.0, 152.0, 165.0, 6.0, 0.0, 2.0, 81.0, 0.0, 0.0, 13.0, 109.0, 9.0, 11.0, 10.0, 20.0, 67.0, 43.0, 15.0, 38.0, 20.0, 105.0, 42.0, 60.0, 42.0, 39.0, 78.0, 63.0, 0.0, 13.0, 30.0, 100.0, 9.0, 12.0, 149.0, 77.0, 20.0, 15.0, 81.0, 38.0, 31.0, 13.0, 0.0, 0.0, 2.0, 140.0, 22.0, 141.0, 0.0, 74.0, 76.0, 11.0, 38.0, 30.0, 26.0, 62.0, 15.0, 0.0, 16.0, 0.0, 73.0, 35.0, 43.0, 10.0, 101.0, 21.0, 131.0, 6.0, 73.0, 65.0, 127.0, 67.0, 97.0, 103.0, 0.0, 11.0, 12.0, 27.0, 21.0, 5.0, 0.0, 11.0, 89.0, 26.0, 57.0, 26.0, 23.0, 35.0, 4.0, 8.0, 12.0, 15.0, 24.0, 18.0, 3.0, 105.0, 101.0, 0.0, 11.0, 15.0, 6.0, 17.0, 0.0, 0.0, 16.0, 0.0, 8.0, 4.0, 48.0, 32.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7126812741050434, "mean_inference_ms": 4.746866087109985, "mean_action_processing_ms": 0.8498794274800077, "mean_env_wait_ms": 0.6045115314967372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014829874038696289, "StateBufferConnector_ms": 0.010168194770812988, "ViewRequirementAgentConnector_ms": 0.31736481189727783}, "num_episodes": 18, "episode_return_max": 381.0, "episode_return_min": -163.0, "episode_return_mean": 99.96, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 166.84784297167806, "num_env_steps_trained_throughput_per_sec": 166.84784297167806, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 25139.881, "restore_workers_time_ms": 0.048, "training_step_time_ms": 25139.764, "sample_time_ms": 3418.432, "learn_time_ms": 21681.622, "learn_throughput": 184.488, "synch_weights_time_ms": 29.559}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "training_iteration": 61, "trial_id": "f6b99_00000", "date": "2024-08-13_20-09-21", "timestamp": 1723594161, "time_this_iter_s": 24.047990083694458, "time_total_s": 1464.260010957718, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6087b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1464.260010957718, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 87.39117647058823, "ram_util_percent": 83.55882352941177}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2761991639143575, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.450632250372064, "policy_loss": -0.003942788324550425, "vf_loss": 2.454196527143004, "vf_explained_var": 0.010306449825801547, "kl": 0.007570243506013229, "entropy": 0.5433406092975506, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.1258890855249275, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.156845905793407, "policy_loss": -0.003200577358744802, "vf_loss": 4.159828144911105, "vf_explained_var": 0.3146106739838918, "kl": 0.011645140417368211, "entropy": 0.8730420908915303, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 325.0, "episode_reward_min": -163.0, "episode_reward_mean": 93.89, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -364.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 173.0}, "policy_reward_mean": {"prey_policy": 10.75, "predator_policy": 36.195}, "custom_metrics": {}, "hist_stats": {"episode_reward": [182.0, 126.0, 152.0, -7.0, 161.0, 137.0, 177.0, 248.0, 78.0, 242.0, 0.0, 203.0, -42.0, 146.0, 60.0, 148.0, -29.0, 66.0, 153.0, -13.0, -3.0, -108.0, 272.0, 15.0, -113.0, 250.0, 179.0, 79.0, 10.0, 276.0, 157.0, 0.0, 1.0, 168.0, 140.0, 166.0, 106.0, -55.0, 219.0, 57.0, -58.0, 278.0, 168.0, 162.0, 10.0, 123.0, 67.0, 294.0, 34.0, -84.0, -163.0, 100.0, 26.0, 64.0, 26.0, 146.0, 135.0, -53.0, 225.0, -27.0, -78.0, 36.0, -112.0, 239.0, 154.0, 142.0, 146.0, 325.0, -13.0, 217.0, 243.0, 100.0, 139.0, 146.0, -18.0, -34.0, -1.0, 64.0, 0.0, 134.0, 116.0, 222.0, 77.0, 166.0, 161.0, 85.0, 4.0, 160.0, 9.0, 295.0, -13.0, 154.0, 43.0, 160.0, -81.0, 65.0, 160.0, -5.0, 118.0, 187.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 176.0, 0.0, 74.0, 148.0, -1.0, -14.0, 0.0, -60.0, 116.0, -4.0, 112.0, 0.0, 158.0, 74.0, 83.0, -76.0, 30.0, 29.0, 139.0, 0.0, 0.0, 164.0, -37.0, 82.0, -286.0, 144.0, 2.0, 41.0, 0.0, 122.0, -4.0, -20.0, -24.0, 0.0, -4.0, -6.0, 152.0, -12.0, -14.0, -6.0, 0.0, -331.0, 1.0, 84.0, 188.0, -92.0, 1.0, -25.0, -361.0, 164.0, 11.0, 0.0, 179.0, 0.0, 13.0, -364.0, 57.0, 182.0, 88.0, 11.0, 63.0, 0.0, 0.0, 6.0, -127.0, 170.0, -22.0, 0.0, 110.0, 129.0, -73.0, -1.0, 54.0, 0.0, -180.0, 138.0, -21.0, -38.0, 14.0, -199.0, 0.0, 98.0, 167.0, -78.0, 116.0, 141.0, 0.0, -179.0, -37.0, 88.0, 0.0, 39.0, -91.0, 161.0, 89.0, 0.0, 34.0, -226.0, 0.0, -230.0, -96.0, -29.0, 55.0, -61.0, 0.0, 0.0, -4.0, 0.0, -62.0, 131.0, 0.0, 0.0, 119.0, -17.0, -144.0, 62.0, 110.0, -22.0, -127.0, -227.0, 12.0, -52.0, -50.0, -280.0, -26.0, 200.0, -161.0, 0.0, 143.0, -20.0, 123.0, 0.0, 120.0, 152.0, 162.0, -103.0, -25.0, 24.0, 110.0, 146.0, 39.0, 106.0, -18.0, 112.0, 0.0, 104.0, 0.0, -126.0, 0.0, 0.0, -135.0, -21.0, -6.0, -12.0, 53.0, 0.0, 0.0, 138.0, -20.0, -16.0, 120.0, 95.0, 47.0, -14.0, 22.0, 0.0, 149.0, -151.0, 191.0, 0.0, -51.0, 3.0, 0.0, 152.0, -16.0, -54.0, -63.0, 150.0, 124.0, -14.0, -12.0, -305.0, 200.0, -181.0, 9.0, 159.0, -6.0, 0.0, -277.0, -10.0, 0.0, -6.0, 154.0, -10.0, 0.0, -163.0, 161.0, 187.0, 0.0], "policy_predator_policy_reward": [6.0, 0.0, 42.0, 10.0, 5.0, 0.0, 0.0, 7.0, 95.0, 10.0, 27.0, 2.0, 9.0, 10.0, 52.0, 39.0, 13.0, 111.0, 58.0, 16.0, 0.0, 0.0, 26.0, 50.0, 162.0, 0.0, 0.0, 0.0, 17.0, 2.0, 15.0, 15.0, 0.0, 15.0, 24.0, 46.0, 4.0, 3.0, 6.0, 7.0, 0.0, 3.0, 173.0, 49.0, 0.0, 0.0, 70.0, 36.0, 134.0, 139.0, 12.0, 63.0, 0.0, 0.0, 22.0, 44.0, 152.0, 165.0, 6.0, 0.0, 2.0, 81.0, 0.0, 0.0, 13.0, 109.0, 9.0, 11.0, 10.0, 20.0, 67.0, 43.0, 15.0, 38.0, 20.0, 105.0, 42.0, 60.0, 42.0, 39.0, 78.0, 63.0, 0.0, 13.0, 30.0, 100.0, 9.0, 12.0, 149.0, 77.0, 20.0, 15.0, 81.0, 38.0, 31.0, 13.0, 0.0, 0.0, 2.0, 140.0, 22.0, 141.0, 0.0, 74.0, 76.0, 11.0, 38.0, 30.0, 26.0, 62.0, 15.0, 0.0, 16.0, 0.0, 73.0, 35.0, 43.0, 10.0, 101.0, 21.0, 131.0, 6.0, 73.0, 65.0, 127.0, 67.0, 97.0, 103.0, 0.0, 11.0, 12.0, 27.0, 21.0, 5.0, 0.0, 11.0, 89.0, 26.0, 57.0, 26.0, 23.0, 35.0, 4.0, 8.0, 12.0, 15.0, 24.0, 18.0, 3.0, 105.0, 101.0, 0.0, 11.0, 15.0, 6.0, 17.0, 0.0, 0.0, 16.0, 0.0, 8.0, 4.0, 48.0, 32.0, 22.0, 47.0, 17.0, 0.0, 21.0, 100.0, 78.0, 58.0, 0.0, 1.0, 16.0, 8.0, 58.0, 68.0, 16.0, 5.0, 7.0, 6.0, 117.0, 142.0, 73.0, 142.0, 3.0, 4.0, 52.0, 144.0, 8.0, 67.0, 12.0, 0.0, 5.0, 0.0, 115.0, 5.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7043381453619681, "mean_inference_ms": 4.729266704371936, "mean_action_processing_ms": 0.8442333793233628, "mean_env_wait_ms": 0.6016804894425599, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00993359088897705, "StateBufferConnector_ms": 0.009668350219726562, "ViewRequirementAgentConnector_ms": 0.30413818359375}, "num_episodes": 18, "episode_return_max": 325.0, "episode_return_min": -163.0, "episode_return_mean": 93.89, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 207.91195879021657, "num_env_steps_trained_throughput_per_sec": 207.91195879021657, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 24552.626, "restore_workers_time_ms": 0.05, "training_step_time_ms": 24552.507, "sample_time_ms": 3341.762, "learn_time_ms": 21173.811, "learn_throughput": 188.913, "synch_weights_time_ms": 29.004}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 62, "trial_id": "f6b99_00000", "date": "2024-08-13_20-09-41", "timestamp": 1723594181, "time_this_iter_s": 19.26053500175476, "time_total_s": 1483.5205459594727, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6024a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1483.5205459594727, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 79.05185185185185, "ram_util_percent": 83.17037037037038}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5438212658047046, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8391096137818836, "policy_loss": -0.004988147474815527, "vf_loss": 2.84373718102773, "vf_explained_var": 0.02220502975125792, "kl": 0.0072113925665098074, "entropy": 0.7419201872966907, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.722685712796671, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.805275060007812, "policy_loss": -0.0032328308882714108, "vf_loss": 3.8082063999125566, "vf_explained_var": 0.061505038082284275, "kl": 0.016079063315990277, "entropy": 0.9055682087386095, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 325.0, "episode_reward_min": -282.0, "episode_reward_mean": 91.34, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -367.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 191.0}, "policy_reward_mean": {"prey_policy": 6.98, "predator_policy": 38.69}, "custom_metrics": {}, "hist_stats": {"episode_reward": [272.0, 15.0, -113.0, 250.0, 179.0, 79.0, 10.0, 276.0, 157.0, 0.0, 1.0, 168.0, 140.0, 166.0, 106.0, -55.0, 219.0, 57.0, -58.0, 278.0, 168.0, 162.0, 10.0, 123.0, 67.0, 294.0, 34.0, -84.0, -163.0, 100.0, 26.0, 64.0, 26.0, 146.0, 135.0, -53.0, 225.0, -27.0, -78.0, 36.0, -112.0, 239.0, 154.0, 142.0, 146.0, 325.0, -13.0, 217.0, 243.0, 100.0, 139.0, 146.0, -18.0, -34.0, -1.0, 64.0, 0.0, 134.0, 116.0, 222.0, 77.0, 166.0, 161.0, 85.0, 4.0, 160.0, 9.0, 295.0, -13.0, 154.0, 43.0, 160.0, -81.0, 65.0, 160.0, -5.0, 118.0, 187.0, 142.0, -6.0, 8.0, -1.0, 43.0, 185.0, 164.0, 32.0, 151.0, 176.0, 205.0, -1.0, 0.0, -282.0, 57.0, 13.0, 146.0, 306.0, 49.0, 279.0, 0.0, 156.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [84.0, 188.0, -92.0, 1.0, -25.0, -361.0, 164.0, 11.0, 0.0, 179.0, 0.0, 13.0, -364.0, 57.0, 182.0, 88.0, 11.0, 63.0, 0.0, 0.0, 6.0, -127.0, 170.0, -22.0, 0.0, 110.0, 129.0, -73.0, -1.0, 54.0, 0.0, -180.0, 138.0, -21.0, -38.0, 14.0, -199.0, 0.0, 98.0, 167.0, -78.0, 116.0, 141.0, 0.0, -179.0, -37.0, 88.0, 0.0, 39.0, -91.0, 161.0, 89.0, 0.0, 34.0, -226.0, 0.0, -230.0, -96.0, -29.0, 55.0, -61.0, 0.0, 0.0, -4.0, 0.0, -62.0, 131.0, 0.0, 0.0, 119.0, -17.0, -144.0, 62.0, 110.0, -22.0, -127.0, -227.0, 12.0, -52.0, -50.0, -280.0, -26.0, 200.0, -161.0, 0.0, 143.0, -20.0, 123.0, 0.0, 120.0, 152.0, 162.0, -103.0, -25.0, 24.0, 110.0, 146.0, 39.0, 106.0, -18.0, 112.0, 0.0, 104.0, 0.0, -126.0, 0.0, 0.0, -135.0, -21.0, -6.0, -12.0, 53.0, 0.0, 0.0, 138.0, -20.0, -16.0, 120.0, 95.0, 47.0, -14.0, 22.0, 0.0, 149.0, -151.0, 191.0, 0.0, -51.0, 3.0, 0.0, 152.0, -16.0, -54.0, -63.0, 150.0, 124.0, -14.0, -12.0, -305.0, 200.0, -181.0, 9.0, 159.0, -6.0, 0.0, -277.0, -10.0, 0.0, -6.0, 154.0, -10.0, 0.0, -163.0, 161.0, 187.0, 0.0, -237.0, 110.0, 0.0, -12.0, 0.0, -33.0, -99.0, 0.0, 56.0, -182.0, -196.0, 175.0, 166.0, -4.0, 0.0, -124.0, 129.0, 0.0, 107.0, 69.0, 176.0, -83.0, 0.0, -2.0, 0.0, 0.0, -367.0, -106.0, -28.0, 0.0, -87.0, 0.0, 0.0, 143.0, 179.0, 82.0, 5.0, -22.0, 58.0, 184.0, 0.0, 0.0, -22.0, 159.0], "policy_predator_policy_reward": [0.0, 0.0, 70.0, 36.0, 134.0, 139.0, 12.0, 63.0, 0.0, 0.0, 22.0, 44.0, 152.0, 165.0, 6.0, 0.0, 2.0, 81.0, 0.0, 0.0, 13.0, 109.0, 9.0, 11.0, 10.0, 20.0, 67.0, 43.0, 15.0, 38.0, 20.0, 105.0, 42.0, 60.0, 42.0, 39.0, 78.0, 63.0, 0.0, 13.0, 30.0, 100.0, 9.0, 12.0, 149.0, 77.0, 20.0, 15.0, 81.0, 38.0, 31.0, 13.0, 0.0, 0.0, 2.0, 140.0, 22.0, 141.0, 0.0, 74.0, 76.0, 11.0, 38.0, 30.0, 26.0, 62.0, 15.0, 0.0, 16.0, 0.0, 73.0, 35.0, 43.0, 10.0, 101.0, 21.0, 131.0, 6.0, 73.0, 65.0, 127.0, 67.0, 97.0, 103.0, 0.0, 11.0, 12.0, 27.0, 21.0, 5.0, 0.0, 11.0, 89.0, 26.0, 57.0, 26.0, 23.0, 35.0, 4.0, 8.0, 12.0, 15.0, 24.0, 18.0, 3.0, 105.0, 101.0, 0.0, 11.0, 15.0, 6.0, 17.0, 0.0, 0.0, 16.0, 0.0, 8.0, 4.0, 48.0, 32.0, 22.0, 47.0, 17.0, 0.0, 21.0, 100.0, 78.0, 58.0, 0.0, 1.0, 16.0, 8.0, 58.0, 68.0, 16.0, 5.0, 7.0, 6.0, 117.0, 142.0, 73.0, 142.0, 3.0, 4.0, 52.0, 144.0, 8.0, 67.0, 12.0, 0.0, 5.0, 0.0, 115.0, 5.0, 0.0, 0.0, 141.0, 128.0, 6.0, 0.0, 0.0, 41.0, 8.0, 90.0, 52.0, 117.0, 117.0, 89.0, 0.0, 2.0, 102.0, 54.0, 22.0, 0.0, 0.0, 0.0, 32.0, 80.0, 0.0, 1.0, 0.0, 0.0, 0.0, 191.0, 9.0, 76.0, 91.0, 9.0, 0.0, 3.0, 38.0, 7.0, 55.0, 11.0, 37.0, 0.0, 0.0, 0.0, 3.0, 16.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.692940416858013, "mean_inference_ms": 4.7038294329248185, "mean_action_processing_ms": 0.8371557633409384, "mean_env_wait_ms": 0.5976638897044075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010329127311706543, "StateBufferConnector_ms": 0.009640097618103027, "ViewRequirementAgentConnector_ms": 0.2713909149169922}, "num_episodes": 22, "episode_return_max": 325.0, "episode_return_min": -282.0, "episode_return_mean": 91.34, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 246.68888362329355, "num_env_steps_trained_throughput_per_sec": 246.68888362329355, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 23535.935, "restore_workers_time_ms": 0.033, "training_step_time_ms": 23535.838, "sample_time_ms": 3129.243, "learn_time_ms": 20372.182, "learn_throughput": 196.346, "synch_weights_time_ms": 28.316}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 63, "trial_id": "f6b99_00000", "date": "2024-08-13_20-09-57", "timestamp": 1723594197, "time_this_iter_s": 16.248091220855713, "time_total_s": 1499.7686371803284, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b60968b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1499.7686371803284, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 67.79999999999998, "ram_util_percent": 80.28695652173914}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.066487119784431, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1597714801314014, "policy_loss": -0.004321032832992613, "vf_loss": 3.1637473383908548, "vf_explained_var": 0.02591324013376993, "kl": 0.006903420221594894, "entropy": 0.6603441544941493, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.377648970248207, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.588993775529206, "policy_loss": -0.003780787402182502, "vf_loss": 5.592540341836435, "vf_explained_var": -0.04047010941480202, "kl": 0.01249113422454948, "entropy": 0.8417727788604756, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 367.0, "episode_reward_min": -282.0, "episode_reward_mean": 95.35, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -367.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 191.0}, "policy_reward_mean": {"prey_policy": 12.295, "predator_policy": 35.38}, "custom_metrics": {}, "hist_stats": {"episode_reward": [123.0, 67.0, 294.0, 34.0, -84.0, -163.0, 100.0, 26.0, 64.0, 26.0, 146.0, 135.0, -53.0, 225.0, -27.0, -78.0, 36.0, -112.0, 239.0, 154.0, 142.0, 146.0, 325.0, -13.0, 217.0, 243.0, 100.0, 139.0, 146.0, -18.0, -34.0, -1.0, 64.0, 0.0, 134.0, 116.0, 222.0, 77.0, 166.0, 161.0, 85.0, 4.0, 160.0, 9.0, 295.0, -13.0, 154.0, 43.0, 160.0, -81.0, 65.0, 160.0, -5.0, 118.0, 187.0, 142.0, -6.0, 8.0, -1.0, 43.0, 185.0, 164.0, 32.0, 151.0, 176.0, 205.0, -1.0, 0.0, -282.0, 57.0, 13.0, 146.0, 306.0, 49.0, 279.0, 0.0, 156.0, 130.0, -27.0, -16.0, 177.0, 132.0, 367.0, 149.0, 143.0, 58.0, 144.0, 97.0, 294.0, 233.0, 95.0, 182.0, 174.0, 195.0, 0.0, 141.0, 46.0, 20.0, 38.0, 116.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [88.0, 0.0, 39.0, -91.0, 161.0, 89.0, 0.0, 34.0, -226.0, 0.0, -230.0, -96.0, -29.0, 55.0, -61.0, 0.0, 0.0, -4.0, 0.0, -62.0, 131.0, 0.0, 0.0, 119.0, -17.0, -144.0, 62.0, 110.0, -22.0, -127.0, -227.0, 12.0, -52.0, -50.0, -280.0, -26.0, 200.0, -161.0, 0.0, 143.0, -20.0, 123.0, 0.0, 120.0, 152.0, 162.0, -103.0, -25.0, 24.0, 110.0, 146.0, 39.0, 106.0, -18.0, 112.0, 0.0, 104.0, 0.0, -126.0, 0.0, 0.0, -135.0, -21.0, -6.0, -12.0, 53.0, 0.0, 0.0, 138.0, -20.0, -16.0, 120.0, 95.0, 47.0, -14.0, 22.0, 0.0, 149.0, -151.0, 191.0, 0.0, -51.0, 3.0, 0.0, 152.0, -16.0, -54.0, -63.0, 150.0, 124.0, -14.0, -12.0, -305.0, 200.0, -181.0, 9.0, 159.0, -6.0, 0.0, -277.0, -10.0, 0.0, -6.0, 154.0, -10.0, 0.0, -163.0, 161.0, 187.0, 0.0, -237.0, 110.0, 0.0, -12.0, 0.0, -33.0, -99.0, 0.0, 56.0, -182.0, -196.0, 175.0, 166.0, -4.0, 0.0, -124.0, 129.0, 0.0, 107.0, 69.0, 176.0, -83.0, 0.0, -2.0, 0.0, 0.0, -367.0, -106.0, -28.0, 0.0, -87.0, 0.0, 0.0, 143.0, 179.0, 82.0, 5.0, -22.0, 58.0, 184.0, 0.0, 0.0, -22.0, 159.0, 96.0, 0.0, 0.0, -138.0, -40.0, 0.0, -70.0, 157.0, 0.0, 91.0, 182.0, 183.0, -11.0, 75.0, -129.0, 156.0, 0.0, -1.0, 2.0, 136.0, -148.0, 19.0, 122.0, 146.0, 185.0, -12.0, 0.0, 48.0, 180.0, 0.0, 60.0, 105.0, 0.0, 194.0, 0.0, 0.0, 123.0, 13.0, 0.0, 27.0, -58.0, 0.0, 0.0, -76.0, -253.0, 86.0], "policy_predator_policy_reward": [20.0, 15.0, 81.0, 38.0, 31.0, 13.0, 0.0, 0.0, 2.0, 140.0, 22.0, 141.0, 0.0, 74.0, 76.0, 11.0, 38.0, 30.0, 26.0, 62.0, 15.0, 0.0, 16.0, 0.0, 73.0, 35.0, 43.0, 10.0, 101.0, 21.0, 131.0, 6.0, 73.0, 65.0, 127.0, 67.0, 97.0, 103.0, 0.0, 11.0, 12.0, 27.0, 21.0, 5.0, 0.0, 11.0, 89.0, 26.0, 57.0, 26.0, 23.0, 35.0, 4.0, 8.0, 12.0, 15.0, 24.0, 18.0, 3.0, 105.0, 101.0, 0.0, 11.0, 15.0, 6.0, 17.0, 0.0, 0.0, 16.0, 0.0, 8.0, 4.0, 48.0, 32.0, 22.0, 47.0, 17.0, 0.0, 21.0, 100.0, 78.0, 58.0, 0.0, 1.0, 16.0, 8.0, 58.0, 68.0, 16.0, 5.0, 7.0, 6.0, 117.0, 142.0, 73.0, 142.0, 3.0, 4.0, 52.0, 144.0, 8.0, 67.0, 12.0, 0.0, 5.0, 0.0, 115.0, 5.0, 0.0, 0.0, 141.0, 128.0, 6.0, 0.0, 0.0, 41.0, 8.0, 90.0, 52.0, 117.0, 117.0, 89.0, 0.0, 2.0, 102.0, 54.0, 22.0, 0.0, 0.0, 0.0, 32.0, 80.0, 0.0, 1.0, 0.0, 0.0, 0.0, 191.0, 9.0, 76.0, 91.0, 9.0, 0.0, 3.0, 38.0, 7.0, 55.0, 11.0, 37.0, 0.0, 0.0, 0.0, 3.0, 16.0, 30.0, 4.0, 0.0, 111.0, 10.0, 14.0, 0.0, 90.0, 14.0, 27.0, 0.0, 2.0, 60.0, 25.0, 60.0, 56.0, 2.0, 57.0, 4.0, 2.0, 99.0, 127.0, 20.0, 6.0, 0.0, 60.0, 2.0, 45.0, 2.0, 0.0, 6.0, 3.0, 0.0, 1.0, 0.0, 0.0, 2.0, 3.0, 9.0, 10.0, 49.0, 29.0, 89.0, 25.0, 150.0, 133.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6788786253864512, "mean_inference_ms": 4.684906756969482, "mean_action_processing_ms": 0.8399891376774896, "mean_env_wait_ms": 0.5987292576625307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009887933731079102, "StateBufferConnector_ms": 0.015242695808410645, "ViewRequirementAgentConnector_ms": 0.2124650478363037}, "num_episodes": 23, "episode_return_max": 367.0, "episode_return_min": -282.0, "episode_return_mean": 95.35, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 195.392757037365, "num_env_steps_trained_throughput_per_sec": 195.392757037365, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 23006.318, "restore_workers_time_ms": 0.032, "training_step_time_ms": 23006.223, "sample_time_ms": 3192.551, "learn_time_ms": 19778.951, "learn_throughput": 202.235, "synch_weights_time_ms": 29.207}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 64, "trial_id": "f6b99_00000", "date": "2024-08-13_20-10-17", "timestamp": 1723594217, "time_this_iter_s": 20.53485894203186, "time_total_s": 1520.3034961223602, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b625d700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1520.3034961223602, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 77.21333333333332, "ram_util_percent": 82.48333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2039267827751776, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0740292139785, "policy_loss": -0.004871395148864144, "vf_loss": 2.0785560597818367, "vf_explained_var": 0.019449712233568627, "kl": 0.0068909375591068986, "entropy": 0.7063267323075149, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.996269108315624, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.168559522729702, "policy_loss": -0.0023410462601869196, "vf_loss": 5.170714806627344, "vf_explained_var": 0.6648391025406973, "kl": 0.009906779193278741, "entropy": 0.8496684437390989, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 367.0, "episode_reward_min": -282.0, "episode_reward_mean": 116.63, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -367.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 191.0}, "policy_reward_mean": {"prey_policy": 26.675, "predator_policy": 31.64}, "custom_metrics": {}, "hist_stats": {"episode_reward": [239.0, 154.0, 142.0, 146.0, 325.0, -13.0, 217.0, 243.0, 100.0, 139.0, 146.0, -18.0, -34.0, -1.0, 64.0, 0.0, 134.0, 116.0, 222.0, 77.0, 166.0, 161.0, 85.0, 4.0, 160.0, 9.0, 295.0, -13.0, 154.0, 43.0, 160.0, -81.0, 65.0, 160.0, -5.0, 118.0, 187.0, 142.0, -6.0, 8.0, -1.0, 43.0, 185.0, 164.0, 32.0, 151.0, 176.0, 205.0, -1.0, 0.0, -282.0, 57.0, 13.0, 146.0, 306.0, 49.0, 279.0, 0.0, 156.0, 130.0, -27.0, -16.0, 177.0, 132.0, 367.0, 149.0, 143.0, 58.0, 144.0, 97.0, 294.0, 233.0, 95.0, 182.0, 174.0, 195.0, 0.0, 141.0, 46.0, 20.0, 38.0, 116.0, 163.0, -4.0, 232.0, 209.0, 284.0, 278.0, 114.0, 171.0, 223.0, 88.0, 168.0, 160.0, 0.0, 40.0, 240.0, 234.0, 231.0, 56.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, -161.0, 0.0, 143.0, -20.0, 123.0, 0.0, 120.0, 152.0, 162.0, -103.0, -25.0, 24.0, 110.0, 146.0, 39.0, 106.0, -18.0, 112.0, 0.0, 104.0, 0.0, -126.0, 0.0, 0.0, -135.0, -21.0, -6.0, -12.0, 53.0, 0.0, 0.0, 138.0, -20.0, -16.0, 120.0, 95.0, 47.0, -14.0, 22.0, 0.0, 149.0, -151.0, 191.0, 0.0, -51.0, 3.0, 0.0, 152.0, -16.0, -54.0, -63.0, 150.0, 124.0, -14.0, -12.0, -305.0, 200.0, -181.0, 9.0, 159.0, -6.0, 0.0, -277.0, -10.0, 0.0, -6.0, 154.0, -10.0, 0.0, -163.0, 161.0, 187.0, 0.0, -237.0, 110.0, 0.0, -12.0, 0.0, -33.0, -99.0, 0.0, 56.0, -182.0, -196.0, 175.0, 166.0, -4.0, 0.0, -124.0, 129.0, 0.0, 107.0, 69.0, 176.0, -83.0, 0.0, -2.0, 0.0, 0.0, -367.0, -106.0, -28.0, 0.0, -87.0, 0.0, 0.0, 143.0, 179.0, 82.0, 5.0, -22.0, 58.0, 184.0, 0.0, 0.0, -22.0, 159.0, 96.0, 0.0, 0.0, -138.0, -40.0, 0.0, -70.0, 157.0, 0.0, 91.0, 182.0, 183.0, -11.0, 75.0, -129.0, 156.0, 0.0, -1.0, 2.0, 136.0, -148.0, 19.0, 122.0, 146.0, 185.0, -12.0, 0.0, 48.0, 180.0, 0.0, 60.0, 105.0, 0.0, 194.0, 0.0, 0.0, 123.0, 13.0, 0.0, 27.0, -58.0, 0.0, 0.0, -76.0, -253.0, 86.0, -29.0, 152.0, -14.0, -83.0, 45.0, 180.0, 159.0, 29.0, 170.0, 63.0, 112.0, 130.0, -64.0, -23.0, 151.0, 0.0, 5.0, 150.0, 39.0, -4.0, 0.0, 157.0, -12.0, 164.0, 0.0, 0.0, 0.0, -41.0, 136.0, 86.0, 122.0, 93.0, 100.0, 112.0, 0.0, -53.0], "policy_predator_policy_reward": [97.0, 103.0, 0.0, 11.0, 12.0, 27.0, 21.0, 5.0, 0.0, 11.0, 89.0, 26.0, 57.0, 26.0, 23.0, 35.0, 4.0, 8.0, 12.0, 15.0, 24.0, 18.0, 3.0, 105.0, 101.0, 0.0, 11.0, 15.0, 6.0, 17.0, 0.0, 0.0, 16.0, 0.0, 8.0, 4.0, 48.0, 32.0, 22.0, 47.0, 17.0, 0.0, 21.0, 100.0, 78.0, 58.0, 0.0, 1.0, 16.0, 8.0, 58.0, 68.0, 16.0, 5.0, 7.0, 6.0, 117.0, 142.0, 73.0, 142.0, 3.0, 4.0, 52.0, 144.0, 8.0, 67.0, 12.0, 0.0, 5.0, 0.0, 115.0, 5.0, 0.0, 0.0, 141.0, 128.0, 6.0, 0.0, 0.0, 41.0, 8.0, 90.0, 52.0, 117.0, 117.0, 89.0, 0.0, 2.0, 102.0, 54.0, 22.0, 0.0, 0.0, 0.0, 32.0, 80.0, 0.0, 1.0, 0.0, 0.0, 0.0, 191.0, 9.0, 76.0, 91.0, 9.0, 0.0, 3.0, 38.0, 7.0, 55.0, 11.0, 37.0, 0.0, 0.0, 0.0, 3.0, 16.0, 30.0, 4.0, 0.0, 111.0, 10.0, 14.0, 0.0, 90.0, 14.0, 27.0, 0.0, 2.0, 60.0, 25.0, 60.0, 56.0, 2.0, 57.0, 4.0, 2.0, 99.0, 127.0, 20.0, 6.0, 0.0, 60.0, 2.0, 45.0, 2.0, 0.0, 6.0, 3.0, 0.0, 1.0, 0.0, 0.0, 2.0, 3.0, 9.0, 10.0, 49.0, 29.0, 89.0, 25.0, 150.0, 133.0, 40.0, 0.0, 76.0, 17.0, 2.0, 5.0, 7.0, 14.0, 15.0, 36.0, 8.0, 28.0, 107.0, 94.0, 14.0, 6.0, 18.0, 50.0, 24.0, 29.0, 0.0, 11.0, 2.0, 6.0, 0.0, 0.0, 76.0, 5.0, 18.0, 0.0, 0.0, 19.0, 19.0, 0.0, 39.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6825570842270798, "mean_inference_ms": 4.690921935915547, "mean_action_processing_ms": 0.8278273314441242, "mean_env_wait_ms": 0.593632457040884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006910204887390137, "StateBufferConnector_ms": 0.012936234474182129, "ViewRequirementAgentConnector_ms": 0.2240302562713623}, "num_episodes": 18, "episode_return_max": 367.0, "episode_return_min": -282.0, "episode_return_mean": 116.63, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 137.34585230485305, "num_env_steps_trained_throughput_per_sec": 137.34585230485305, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 23815.148, "restore_workers_time_ms": 0.03, "training_step_time_ms": 23815.058, "sample_time_ms": 4071.647, "learn_time_ms": 19709.791, "learn_throughput": 202.945, "synch_weights_time_ms": 28.435}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 65, "trial_id": "f6b99_00000", "date": "2024-08-13_20-10-47", "timestamp": 1723594247, "time_this_iter_s": 29.184458017349243, "time_total_s": 1549.4879541397095, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6096430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1549.4879541397095, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 86.9780487804878, "ram_util_percent": 83.34390243902439}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1572950134990077, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.058441355051818, "policy_loss": -0.00666156181838935, "vf_loss": 2.0647851293679897, "vf_explained_var": 0.01367537505412228, "kl": 0.006355815849230691, "entropy": 0.5722904604421091, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.531808053374921, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.563733177336435, "policy_loss": -0.004346072996187974, "vf_loss": 4.567985196088357, "vf_explained_var": 0.5055607760394061, "kl": 0.005015537383458276, "entropy": 0.7806270696183361, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 367.0, "episode_reward_min": -282.0, "episode_reward_mean": 122.26, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -367.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 191.0}, "policy_reward_mean": {"prey_policy": 30.9, "predator_policy": 30.23}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.0, 77.0, 166.0, 161.0, 85.0, 4.0, 160.0, 9.0, 295.0, -13.0, 154.0, 43.0, 160.0, -81.0, 65.0, 160.0, -5.0, 118.0, 187.0, 142.0, -6.0, 8.0, -1.0, 43.0, 185.0, 164.0, 32.0, 151.0, 176.0, 205.0, -1.0, 0.0, -282.0, 57.0, 13.0, 146.0, 306.0, 49.0, 279.0, 0.0, 156.0, 130.0, -27.0, -16.0, 177.0, 132.0, 367.0, 149.0, 143.0, 58.0, 144.0, 97.0, 294.0, 233.0, 95.0, 182.0, 174.0, 195.0, 0.0, 141.0, 46.0, 20.0, 38.0, 116.0, 163.0, -4.0, 232.0, 209.0, 284.0, 278.0, 114.0, 171.0, 223.0, 88.0, 168.0, 160.0, 0.0, 40.0, 240.0, 234.0, 231.0, 56.0, 164.0, 112.0, 134.0, 186.0, 159.0, 104.0, 0.0, 224.0, 0.0, 84.0, 160.0, 0.0, 319.0, 321.0, 312.0, 186.0, 192.0, 5.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [95.0, 47.0, -14.0, 22.0, 0.0, 149.0, -151.0, 191.0, 0.0, -51.0, 3.0, 0.0, 152.0, -16.0, -54.0, -63.0, 150.0, 124.0, -14.0, -12.0, -305.0, 200.0, -181.0, 9.0, 159.0, -6.0, 0.0, -277.0, -10.0, 0.0, -6.0, 154.0, -10.0, 0.0, -163.0, 161.0, 187.0, 0.0, -237.0, 110.0, 0.0, -12.0, 0.0, -33.0, -99.0, 0.0, 56.0, -182.0, -196.0, 175.0, 166.0, -4.0, 0.0, -124.0, 129.0, 0.0, 107.0, 69.0, 176.0, -83.0, 0.0, -2.0, 0.0, 0.0, -367.0, -106.0, -28.0, 0.0, -87.0, 0.0, 0.0, 143.0, 179.0, 82.0, 5.0, -22.0, 58.0, 184.0, 0.0, 0.0, -22.0, 159.0, 96.0, 0.0, 0.0, -138.0, -40.0, 0.0, -70.0, 157.0, 0.0, 91.0, 182.0, 183.0, -11.0, 75.0, -129.0, 156.0, 0.0, -1.0, 2.0, 136.0, -148.0, 19.0, 122.0, 146.0, 185.0, -12.0, 0.0, 48.0, 180.0, 0.0, 60.0, 105.0, 0.0, 194.0, 0.0, 0.0, 123.0, 13.0, 0.0, 27.0, -58.0, 0.0, 0.0, -76.0, -253.0, 86.0, -29.0, 152.0, -14.0, -83.0, 45.0, 180.0, 159.0, 29.0, 170.0, 63.0, 112.0, 130.0, -64.0, -23.0, 151.0, 0.0, 5.0, 150.0, 39.0, -4.0, 0.0, 157.0, -12.0, 164.0, 0.0, 0.0, 0.0, -41.0, 136.0, 86.0, 122.0, 93.0, 100.0, 112.0, 0.0, -53.0, 146.0, 0.0, 75.0, 0.0, 26.0, 46.0, 0.0, 179.0, 75.0, 31.0, 0.0, -28.0, 0.0, 0.0, -14.0, 197.0, 0.0, 0.0, 29.0, -4.0, -4.0, 136.0, 0.0, 0.0, 166.0, 146.0, 87.0, 200.0, 88.0, 184.0, -6.0, 187.0, 0.0, 192.0, 0.0, -100.0], "policy_predator_policy_reward": [48.0, 32.0, 22.0, 47.0, 17.0, 0.0, 21.0, 100.0, 78.0, 58.0, 0.0, 1.0, 16.0, 8.0, 58.0, 68.0, 16.0, 5.0, 7.0, 6.0, 117.0, 142.0, 73.0, 142.0, 3.0, 4.0, 52.0, 144.0, 8.0, 67.0, 12.0, 0.0, 5.0, 0.0, 115.0, 5.0, 0.0, 0.0, 141.0, 128.0, 6.0, 0.0, 0.0, 41.0, 8.0, 90.0, 52.0, 117.0, 117.0, 89.0, 0.0, 2.0, 102.0, 54.0, 22.0, 0.0, 0.0, 0.0, 32.0, 80.0, 0.0, 1.0, 0.0, 0.0, 0.0, 191.0, 9.0, 76.0, 91.0, 9.0, 0.0, 3.0, 38.0, 7.0, 55.0, 11.0, 37.0, 0.0, 0.0, 0.0, 3.0, 16.0, 30.0, 4.0, 0.0, 111.0, 10.0, 14.0, 0.0, 90.0, 14.0, 27.0, 0.0, 2.0, 60.0, 25.0, 60.0, 56.0, 2.0, 57.0, 4.0, 2.0, 99.0, 127.0, 20.0, 6.0, 0.0, 60.0, 2.0, 45.0, 2.0, 0.0, 6.0, 3.0, 0.0, 1.0, 0.0, 0.0, 2.0, 3.0, 9.0, 10.0, 49.0, 29.0, 89.0, 25.0, 150.0, 133.0, 40.0, 0.0, 76.0, 17.0, 2.0, 5.0, 7.0, 14.0, 15.0, 36.0, 8.0, 28.0, 107.0, 94.0, 14.0, 6.0, 18.0, 50.0, 24.0, 29.0, 0.0, 11.0, 2.0, 6.0, 0.0, 0.0, 76.0, 5.0, 18.0, 0.0, 0.0, 19.0, 19.0, 0.0, 39.0, 70.0, 1.0, 17.0, 37.0, 0.0, 41.0, 21.0, 0.0, 7.0, 51.0, 2.0, 60.0, 72.0, 0.0, 0.0, 0.0, 41.0, 0.0, 0.0, 2.0, 57.0, 8.0, 20.0, 0.0, 0.0, 0.0, 7.0, 0.0, 34.0, 10.0, 30.0, 2.0, 3.0, 0.0, 0.0, 15.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6844055013926333, "mean_inference_ms": 4.703523023250959, "mean_action_processing_ms": 0.825879943095507, "mean_env_wait_ms": 0.5935897486409928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007096290588378906, "StateBufferConnector_ms": 0.012943863868713379, "ViewRequirementAgentConnector_ms": 0.26109910011291504}, "num_episodes": 18, "episode_return_max": 367.0, "episode_return_min": -282.0, "episode_return_mean": 122.26, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 151.31385216694395, "num_env_steps_trained_throughput_per_sec": 151.31385216694395, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 23756.457, "restore_workers_time_ms": 0.018, "training_step_time_ms": 23756.373, "sample_time_ms": 3965.345, "learn_time_ms": 19735.054, "learn_throughput": 202.685, "synch_weights_time_ms": 46.511}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 66, "trial_id": "f6b99_00000", "date": "2024-08-13_20-11-14", "timestamp": 1723594274, "time_this_iter_s": 26.90815281867981, "time_total_s": 1576.3961069583893, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6087280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1576.3961069583893, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 79.53714285714287, "ram_util_percent": 82.99714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3136178448559745, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8727655957300195, "policy_loss": -0.004924561982732956, "vf_loss": 1.8773050293089852, "vf_explained_var": 0.024773927435042368, "kl": 0.00770256320228798, "entropy": 0.6273909961735761, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.671034350723186, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.813603267593989, "policy_loss": -0.004529814955670012, "vf_loss": 4.817856832786843, "vf_explained_var": 0.5959733412063942, "kl": 0.014733544516759393, "entropy": 0.8771114176227933, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "env_runners": {"episode_reward_max": 367.0, "episode_reward_min": -282.0, "episode_reward_mean": 136.92, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -367.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 191.0}, "policy_reward_mean": {"prey_policy": 42.42, "predator_policy": 26.04}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 43.0, 185.0, 164.0, 32.0, 151.0, 176.0, 205.0, -1.0, 0.0, -282.0, 57.0, 13.0, 146.0, 306.0, 49.0, 279.0, 0.0, 156.0, 130.0, -27.0, -16.0, 177.0, 132.0, 367.0, 149.0, 143.0, 58.0, 144.0, 97.0, 294.0, 233.0, 95.0, 182.0, 174.0, 195.0, 0.0, 141.0, 46.0, 20.0, 38.0, 116.0, 163.0, -4.0, 232.0, 209.0, 284.0, 278.0, 114.0, 171.0, 223.0, 88.0, 168.0, 160.0, 0.0, 40.0, 240.0, 234.0, 231.0, 56.0, 164.0, 112.0, 134.0, 186.0, 159.0, 104.0, 0.0, 224.0, 0.0, 84.0, 160.0, 0.0, 319.0, 321.0, 312.0, 186.0, 192.0, 5.0, 152.0, 147.0, 54.0, 198.0, 111.0, 157.0, 225.0, 190.0, 160.0, 353.0, 19.0, 274.0, 182.0, -36.0, -99.0, 52.0, 299.0, 123.0, 320.0, 323.0, 280.0, 93.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-99.0, 0.0, 56.0, -182.0, -196.0, 175.0, 166.0, -4.0, 0.0, -124.0, 129.0, 0.0, 107.0, 69.0, 176.0, -83.0, 0.0, -2.0, 0.0, 0.0, -367.0, -106.0, -28.0, 0.0, -87.0, 0.0, 0.0, 143.0, 179.0, 82.0, 5.0, -22.0, 58.0, 184.0, 0.0, 0.0, -22.0, 159.0, 96.0, 0.0, 0.0, -138.0, -40.0, 0.0, -70.0, 157.0, 0.0, 91.0, 182.0, 183.0, -11.0, 75.0, -129.0, 156.0, 0.0, -1.0, 2.0, 136.0, -148.0, 19.0, 122.0, 146.0, 185.0, -12.0, 0.0, 48.0, 180.0, 0.0, 60.0, 105.0, 0.0, 194.0, 0.0, 0.0, 123.0, 13.0, 0.0, 27.0, -58.0, 0.0, 0.0, -76.0, -253.0, 86.0, -29.0, 152.0, -14.0, -83.0, 45.0, 180.0, 159.0, 29.0, 170.0, 63.0, 112.0, 130.0, -64.0, -23.0, 151.0, 0.0, 5.0, 150.0, 39.0, -4.0, 0.0, 157.0, -12.0, 164.0, 0.0, 0.0, 0.0, -41.0, 136.0, 86.0, 122.0, 93.0, 100.0, 112.0, 0.0, -53.0, 146.0, 0.0, 75.0, 0.0, 26.0, 46.0, 0.0, 179.0, 75.0, 31.0, 0.0, -28.0, 0.0, 0.0, -14.0, 197.0, 0.0, 0.0, 29.0, -4.0, -4.0, 136.0, 0.0, 0.0, 166.0, 146.0, 87.0, 200.0, 88.0, 184.0, -6.0, 187.0, 0.0, 192.0, 0.0, -100.0, 163.0, -158.0, 0.0, 142.0, 24.0, -14.0, 0.0, 197.0, 106.0, 0.0, 0.0, 145.0, -43.0, 191.0, 72.0, 52.0, 0.0, 135.0, 188.0, 160.0, 0.0, -57.0, 181.0, 42.0, 173.0, 0.0, -28.0, -22.0, -337.0, 32.0, -2.0, -1.0, 131.0, 162.0, 70.0, 0.0, 142.0, 154.0, 148.0, 172.0, 47.0, 182.0, -3.0, 56.0], "policy_predator_policy_reward": [8.0, 90.0, 52.0, 117.0, 117.0, 89.0, 0.0, 2.0, 102.0, 54.0, 22.0, 0.0, 0.0, 0.0, 32.0, 80.0, 0.0, 1.0, 0.0, 0.0, 0.0, 191.0, 9.0, 76.0, 91.0, 9.0, 0.0, 3.0, 38.0, 7.0, 55.0, 11.0, 37.0, 0.0, 0.0, 0.0, 3.0, 16.0, 30.0, 4.0, 0.0, 111.0, 10.0, 14.0, 0.0, 90.0, 14.0, 27.0, 0.0, 2.0, 60.0, 25.0, 60.0, 56.0, 2.0, 57.0, 4.0, 2.0, 99.0, 127.0, 20.0, 6.0, 0.0, 60.0, 2.0, 45.0, 2.0, 0.0, 6.0, 3.0, 0.0, 1.0, 0.0, 0.0, 2.0, 3.0, 9.0, 10.0, 49.0, 29.0, 89.0, 25.0, 150.0, 133.0, 40.0, 0.0, 76.0, 17.0, 2.0, 5.0, 7.0, 14.0, 15.0, 36.0, 8.0, 28.0, 107.0, 94.0, 14.0, 6.0, 18.0, 50.0, 24.0, 29.0, 0.0, 11.0, 2.0, 6.0, 0.0, 0.0, 76.0, 5.0, 18.0, 0.0, 0.0, 19.0, 19.0, 0.0, 39.0, 70.0, 1.0, 17.0, 37.0, 0.0, 41.0, 21.0, 0.0, 7.0, 51.0, 2.0, 60.0, 72.0, 0.0, 0.0, 0.0, 41.0, 0.0, 0.0, 2.0, 57.0, 8.0, 20.0, 0.0, 0.0, 0.0, 7.0, 0.0, 34.0, 10.0, 30.0, 2.0, 3.0, 0.0, 0.0, 15.0, 90.0, 115.0, 32.0, 5.0, 0.0, 37.0, 7.0, 1.0, 0.0, 5.0, 0.0, 12.0, 0.0, 0.0, 77.0, 18.0, 48.0, 16.0, 9.0, 4.0, 1.0, 26.0, 50.0, 44.0, 7.0, 9.0, 0.0, 0.0, 14.0, 27.0, 179.0, 52.0, 3.0, 0.0, 6.0, 30.0, 23.0, 10.0, 14.0, 0.0, 3.0, 51.0, 0.0, 0.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6947530161850872, "mean_inference_ms": 4.741934250332535, "mean_action_processing_ms": 0.8310681258880817, "mean_env_wait_ms": 0.5977402736233246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007265329360961914, "StateBufferConnector_ms": 0.012926816940307617, "ViewRequirementAgentConnector_ms": 0.28221964836120605}, "num_episodes": 22, "episode_return_max": 367.0, "episode_return_min": -282.0, "episode_return_mean": 136.92, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 200.5331097571937, "num_env_steps_trained_throughput_per_sec": 200.5331097571937, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 23591.293, "restore_workers_time_ms": 0.036, "training_step_time_ms": 23591.177, "sample_time_ms": 4274.893, "learn_time_ms": 19255.864, "learn_throughput": 207.729, "synch_weights_time_ms": 49.751}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "training_iteration": 67, "trial_id": "f6b99_00000", "date": "2024-08-13_20-11-34", "timestamp": 1723594294, "time_this_iter_s": 20.194125175476074, "time_total_s": 1596.5902321338654, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b605b280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1596.5902321338654, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 74.54137931034484, "ram_util_percent": 84.0448275862069}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2034685199853605, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.469927976497266, "policy_loss": -0.006097065927657895, "vf_loss": 5.4756071209276795, "vf_explained_var": 0.029209488062631517, "kl": 0.008358543692148857, "entropy": 0.5343445680444203, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.817698714436677, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.048312970065566, "policy_loss": -0.00436157508970056, "vf_loss": 6.052456049944358, "vf_explained_var": -0.31377556642527304, "kl": 0.011653641412023675, "entropy": 0.9195485193262656, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "env_runners": {"episode_reward_max": 367.0, "episode_reward_min": -277.0, "episode_reward_mean": 134.14, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -337.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 179.0}, "policy_reward_mean": {"prey_policy": 39.9, "predator_policy": 27.17}, "custom_metrics": {}, "hist_stats": {"episode_reward": [156.0, 130.0, -27.0, -16.0, 177.0, 132.0, 367.0, 149.0, 143.0, 58.0, 144.0, 97.0, 294.0, 233.0, 95.0, 182.0, 174.0, 195.0, 0.0, 141.0, 46.0, 20.0, 38.0, 116.0, 163.0, -4.0, 232.0, 209.0, 284.0, 278.0, 114.0, 171.0, 223.0, 88.0, 168.0, 160.0, 0.0, 40.0, 240.0, 234.0, 231.0, 56.0, 164.0, 112.0, 134.0, 186.0, 159.0, 104.0, 0.0, 224.0, 0.0, 84.0, 160.0, 0.0, 319.0, 321.0, 312.0, 186.0, 192.0, 5.0, 152.0, 147.0, 54.0, 198.0, 111.0, 157.0, 225.0, 190.0, 160.0, 353.0, 19.0, 274.0, 182.0, -36.0, -99.0, 52.0, 299.0, 123.0, 320.0, 323.0, 280.0, 93.0, -277.0, 196.0, 121.0, 79.0, 43.0, -2.0, 2.0, 289.0, 39.0, 56.0, 218.0, 75.0, -16.0, -247.0, 120.0, 254.0, 208.0, 86.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-22.0, 159.0, 96.0, 0.0, 0.0, -138.0, -40.0, 0.0, -70.0, 157.0, 0.0, 91.0, 182.0, 183.0, -11.0, 75.0, -129.0, 156.0, 0.0, -1.0, 2.0, 136.0, -148.0, 19.0, 122.0, 146.0, 185.0, -12.0, 0.0, 48.0, 180.0, 0.0, 60.0, 105.0, 0.0, 194.0, 0.0, 0.0, 123.0, 13.0, 0.0, 27.0, -58.0, 0.0, 0.0, -76.0, -253.0, 86.0, -29.0, 152.0, -14.0, -83.0, 45.0, 180.0, 159.0, 29.0, 170.0, 63.0, 112.0, 130.0, -64.0, -23.0, 151.0, 0.0, 5.0, 150.0, 39.0, -4.0, 0.0, 157.0, -12.0, 164.0, 0.0, 0.0, 0.0, -41.0, 136.0, 86.0, 122.0, 93.0, 100.0, 112.0, 0.0, -53.0, 146.0, 0.0, 75.0, 0.0, 26.0, 46.0, 0.0, 179.0, 75.0, 31.0, 0.0, -28.0, 0.0, 0.0, -14.0, 197.0, 0.0, 0.0, 29.0, -4.0, -4.0, 136.0, 0.0, 0.0, 166.0, 146.0, 87.0, 200.0, 88.0, 184.0, -6.0, 187.0, 0.0, 192.0, 0.0, -100.0, 163.0, -158.0, 0.0, 142.0, 24.0, -14.0, 0.0, 197.0, 106.0, 0.0, 0.0, 145.0, -43.0, 191.0, 72.0, 52.0, 0.0, 135.0, 188.0, 160.0, 0.0, -57.0, 181.0, 42.0, 173.0, 0.0, -28.0, -22.0, -337.0, 32.0, -2.0, -1.0, 131.0, 162.0, 70.0, 0.0, 142.0, 154.0, 148.0, 172.0, 47.0, 182.0, -3.0, 56.0, -247.0, -217.0, -153.0, 121.0, 0.0, 121.0, 21.0, 0.0, -69.0, -6.0, -4.0, 0.0, 0.0, -97.0, 182.0, -16.0, -179.0, 90.0, 13.0, 0.0, 107.0, -8.0, 26.0, 43.0, 0.0, -32.0, -237.0, -230.0, -10.0, 124.0, 92.0, 138.0, 81.0, 80.0, 19.0, -28.0], "policy_predator_policy_reward": [3.0, 16.0, 30.0, 4.0, 0.0, 111.0, 10.0, 14.0, 0.0, 90.0, 14.0, 27.0, 0.0, 2.0, 60.0, 25.0, 60.0, 56.0, 2.0, 57.0, 4.0, 2.0, 99.0, 127.0, 20.0, 6.0, 0.0, 60.0, 2.0, 45.0, 2.0, 0.0, 6.0, 3.0, 0.0, 1.0, 0.0, 0.0, 2.0, 3.0, 9.0, 10.0, 49.0, 29.0, 89.0, 25.0, 150.0, 133.0, 40.0, 0.0, 76.0, 17.0, 2.0, 5.0, 7.0, 14.0, 15.0, 36.0, 8.0, 28.0, 107.0, 94.0, 14.0, 6.0, 18.0, 50.0, 24.0, 29.0, 0.0, 11.0, 2.0, 6.0, 0.0, 0.0, 76.0, 5.0, 18.0, 0.0, 0.0, 19.0, 19.0, 0.0, 39.0, 70.0, 1.0, 17.0, 37.0, 0.0, 41.0, 21.0, 0.0, 7.0, 51.0, 2.0, 60.0, 72.0, 0.0, 0.0, 0.0, 41.0, 0.0, 0.0, 2.0, 57.0, 8.0, 20.0, 0.0, 0.0, 0.0, 7.0, 0.0, 34.0, 10.0, 30.0, 2.0, 3.0, 0.0, 0.0, 15.0, 90.0, 115.0, 32.0, 5.0, 0.0, 37.0, 7.0, 1.0, 0.0, 5.0, 0.0, 12.0, 0.0, 0.0, 77.0, 18.0, 48.0, 16.0, 9.0, 4.0, 1.0, 26.0, 50.0, 44.0, 7.0, 9.0, 0.0, 0.0, 14.0, 27.0, 179.0, 52.0, 3.0, 0.0, 6.0, 30.0, 23.0, 10.0, 14.0, 0.0, 3.0, 51.0, 0.0, 0.0, 40.0, 25.0, 162.0, 117.0, 111.0, 0.0, 0.0, 0.0, 58.0, 79.0, 39.0, 0.0, 2.0, 92.0, 7.0, 59.0, 64.0, 15.0, 113.0, 28.0, 15.0, 57.0, 62.0, 6.0, 0.0, 16.0, 0.0, 127.0, 93.0, 1.0, 5.0, 24.0, 0.0, 40.0, 7.0, 16.0, 79.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7024564903396249, "mean_inference_ms": 4.773002170953329, "mean_action_processing_ms": 0.8272614272683235, "mean_env_wait_ms": 0.598909832616777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00969851016998291, "StateBufferConnector_ms": 0.013253331184387207, "ViewRequirementAgentConnector_ms": 0.34728431701660156}, "num_episodes": 18, "episode_return_max": 367.0, "episode_return_min": -277.0, "episode_return_mean": 134.14, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.4211130263236, "num_env_steps_trained_throughput_per_sec": 155.4211130263236, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 23717.439, "restore_workers_time_ms": 0.036, "training_step_time_ms": 23717.323, "sample_time_ms": 4618.394, "learn_time_ms": 19043.944, "learn_throughput": 210.041, "synch_weights_time_ms": 43.553}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "training_iteration": 68, "trial_id": "f6b99_00000", "date": "2024-08-13_20-12-01", "timestamp": 1723594321, "time_this_iter_s": 25.97998809814453, "time_total_s": 1622.57022023201, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b605be50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1622.57022023201, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 82.5027027027027, "ram_util_percent": 83.32702702702704}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1376844930270362, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.411904041981571, "policy_loss": -0.0034452376633429182, "vf_loss": 3.415053697994777, "vf_explained_var": 0.015816568697571122, "kl": 0.005911451795867516, "entropy": 0.577193104526984, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.702739516200212, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.734028333835501, "policy_loss": -0.003223591283574779, "vf_loss": 4.737122917049145, "vf_explained_var": 0.23186820165190117, "kl": 0.006880514569250074, "entropy": 0.882949403543321, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 382.0, "episode_reward_min": -277.0, "episode_reward_mean": 128.91, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 179.0}, "policy_reward_mean": {"prey_policy": 33.575, "predator_policy": 30.88}, "custom_metrics": {}, "hist_stats": {"episode_reward": [116.0, 163.0, -4.0, 232.0, 209.0, 284.0, 278.0, 114.0, 171.0, 223.0, 88.0, 168.0, 160.0, 0.0, 40.0, 240.0, 234.0, 231.0, 56.0, 164.0, 112.0, 134.0, 186.0, 159.0, 104.0, 0.0, 224.0, 0.0, 84.0, 160.0, 0.0, 319.0, 321.0, 312.0, 186.0, 192.0, 5.0, 152.0, 147.0, 54.0, 198.0, 111.0, 157.0, 225.0, 190.0, 160.0, 353.0, 19.0, 274.0, 182.0, -36.0, -99.0, 52.0, 299.0, 123.0, 320.0, 323.0, 280.0, 93.0, -277.0, 196.0, 121.0, 79.0, 43.0, -2.0, 2.0, 289.0, 39.0, 56.0, 218.0, 75.0, -16.0, -247.0, 120.0, 254.0, 208.0, 86.0, -200.0, 40.0, 0.0, 195.0, 113.0, 193.0, 140.0, -5.0, -67.0, 174.0, 224.0, 219.0, -61.0, -6.0, 150.0, 194.0, 8.0, 59.0, 104.0, 200.0, 74.0, 275.0, 382.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-253.0, 86.0, -29.0, 152.0, -14.0, -83.0, 45.0, 180.0, 159.0, 29.0, 170.0, 63.0, 112.0, 130.0, -64.0, -23.0, 151.0, 0.0, 5.0, 150.0, 39.0, -4.0, 0.0, 157.0, -12.0, 164.0, 0.0, 0.0, 0.0, -41.0, 136.0, 86.0, 122.0, 93.0, 100.0, 112.0, 0.0, -53.0, 146.0, 0.0, 75.0, 0.0, 26.0, 46.0, 0.0, 179.0, 75.0, 31.0, 0.0, -28.0, 0.0, 0.0, -14.0, 197.0, 0.0, 0.0, 29.0, -4.0, -4.0, 136.0, 0.0, 0.0, 166.0, 146.0, 87.0, 200.0, 88.0, 184.0, -6.0, 187.0, 0.0, 192.0, 0.0, -100.0, 163.0, -158.0, 0.0, 142.0, 24.0, -14.0, 0.0, 197.0, 106.0, 0.0, 0.0, 145.0, -43.0, 191.0, 72.0, 52.0, 0.0, 135.0, 188.0, 160.0, 0.0, -57.0, 181.0, 42.0, 173.0, 0.0, -28.0, -22.0, -337.0, 32.0, -2.0, -1.0, 131.0, 162.0, 70.0, 0.0, 142.0, 154.0, 148.0, 172.0, 47.0, 182.0, -3.0, 56.0, -247.0, -217.0, -153.0, 121.0, 0.0, 121.0, 21.0, 0.0, -69.0, -6.0, -4.0, 0.0, 0.0, -97.0, 182.0, -16.0, -179.0, 90.0, 13.0, 0.0, 107.0, -8.0, 26.0, 43.0, 0.0, -32.0, -237.0, -230.0, -10.0, 124.0, 92.0, 138.0, 81.0, 80.0, 19.0, -28.0, 0.0, -400.0, -8.0, -30.0, 0.0, 0.0, 195.0, 0.0, 0.0, 22.0, -64.0, 92.0, 150.0, -220.0, 0.0, -10.0, -280.0, -76.0, -18.0, 124.0, 138.0, -16.0, 104.0, 75.0, -229.0, 0.0, 0.0, -12.0, -12.0, 138.0, 194.0, 0.0, -19.0, -86.0, 168.0, -275.0, 0.0, 52.0, 200.0, 0.0, 8.0, 0.0, 185.0, 33.0, 169.0, 197.0], "policy_predator_policy_reward": [150.0, 133.0, 40.0, 0.0, 76.0, 17.0, 2.0, 5.0, 7.0, 14.0, 15.0, 36.0, 8.0, 28.0, 107.0, 94.0, 14.0, 6.0, 18.0, 50.0, 24.0, 29.0, 0.0, 11.0, 2.0, 6.0, 0.0, 0.0, 76.0, 5.0, 18.0, 0.0, 0.0, 19.0, 19.0, 0.0, 39.0, 70.0, 1.0, 17.0, 37.0, 0.0, 41.0, 21.0, 0.0, 7.0, 51.0, 2.0, 60.0, 72.0, 0.0, 0.0, 0.0, 41.0, 0.0, 0.0, 2.0, 57.0, 8.0, 20.0, 0.0, 0.0, 0.0, 7.0, 0.0, 34.0, 10.0, 30.0, 2.0, 3.0, 0.0, 0.0, 15.0, 90.0, 115.0, 32.0, 5.0, 0.0, 37.0, 7.0, 1.0, 0.0, 5.0, 0.0, 12.0, 0.0, 0.0, 77.0, 18.0, 48.0, 16.0, 9.0, 4.0, 1.0, 26.0, 50.0, 44.0, 7.0, 9.0, 0.0, 0.0, 14.0, 27.0, 179.0, 52.0, 3.0, 0.0, 6.0, 30.0, 23.0, 10.0, 14.0, 0.0, 3.0, 51.0, 0.0, 0.0, 40.0, 25.0, 162.0, 117.0, 111.0, 0.0, 0.0, 0.0, 58.0, 79.0, 39.0, 0.0, 2.0, 92.0, 7.0, 59.0, 64.0, 15.0, 113.0, 28.0, 15.0, 57.0, 62.0, 6.0, 0.0, 16.0, 0.0, 127.0, 93.0, 1.0, 5.0, 24.0, 0.0, 40.0, 7.0, 16.0, 79.0, 21.0, 179.0, 8.0, 70.0, 0.0, 0.0, 0.0, 0.0, 54.0, 37.0, 102.0, 63.0, 123.0, 87.0, 5.0, 0.0, 158.0, 131.0, 29.0, 39.0, 67.0, 35.0, 5.0, 35.0, 76.0, 92.0, 0.0, 6.0, 17.0, 7.0, 0.0, 0.0, 1.0, 112.0, 7.0, 159.0, 3.0, 49.0, 0.0, 0.0, 59.0, 7.0, 33.0, 24.0, 10.0, 6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.715080898101645, "mean_inference_ms": 4.823541992075395, "mean_action_processing_ms": 0.8289471173843829, "mean_env_wait_ms": 0.6030491364457928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016541123390197754, "StateBufferConnector_ms": 0.008516311645507812, "ViewRequirementAgentConnector_ms": 0.3559737205505371}, "num_episodes": 23, "episode_return_max": 382.0, "episode_return_min": -277.0, "episode_return_mean": 128.91, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 236.53951418057068, "num_env_steps_trained_throughput_per_sec": 236.53951418057068, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 21990.526, "restore_workers_time_ms": 0.04, "training_step_time_ms": 21990.404, "sample_time_ms": 4647.384, "learn_time_ms": 17290.504, "learn_throughput": 231.341, "synch_weights_time_ms": 41.804}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 69, "trial_id": "f6b99_00000", "date": "2024-08-13_20-12-18", "timestamp": 1723594338, "time_this_iter_s": 16.92276883125305, "time_total_s": 1639.492989063263, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6087d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1639.492989063263, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 62.8125, "ram_util_percent": 80.16250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4821553838000727, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3546104733590727, "policy_loss": -0.005928187159496168, "vf_loss": 1.360142495518639, "vf_explained_var": 0.005429885627100707, "kl": 0.007923224149256447, "entropy": 0.5963367501106211, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.978379003333036, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.107781222762254, "policy_loss": -0.006799996108132065, "vf_loss": 5.11444837252299, "vf_explained_var": 0.6038072813124884, "kl": 0.00708504359700739, "entropy": 0.7837000978686822, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 382.0, "episode_reward_min": -277.0, "episode_reward_mean": 126.45, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 179.0}, "policy_reward_mean": {"prey_policy": 33.425, "predator_policy": 29.8}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.0, 164.0, 112.0, 134.0, 186.0, 159.0, 104.0, 0.0, 224.0, 0.0, 84.0, 160.0, 0.0, 319.0, 321.0, 312.0, 186.0, 192.0, 5.0, 152.0, 147.0, 54.0, 198.0, 111.0, 157.0, 225.0, 190.0, 160.0, 353.0, 19.0, 274.0, 182.0, -36.0, -99.0, 52.0, 299.0, 123.0, 320.0, 323.0, 280.0, 93.0, -277.0, 196.0, 121.0, 79.0, 43.0, -2.0, 2.0, 289.0, 39.0, 56.0, 218.0, 75.0, -16.0, -247.0, 120.0, 254.0, 208.0, 86.0, -200.0, 40.0, 0.0, 195.0, 113.0, 193.0, 140.0, -5.0, -67.0, 174.0, 224.0, 219.0, -61.0, -6.0, 150.0, 194.0, 8.0, 59.0, 104.0, 200.0, 74.0, 275.0, 382.0, 182.0, 132.0, 312.0, -21.0, -13.0, 236.0, 192.0, 55.0, 237.0, 216.0, 67.0, 200.0, 200.0, 308.0, 114.0, 183.0, 14.0, 87.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -53.0, 146.0, 0.0, 75.0, 0.0, 26.0, 46.0, 0.0, 179.0, 75.0, 31.0, 0.0, -28.0, 0.0, 0.0, -14.0, 197.0, 0.0, 0.0, 29.0, -4.0, -4.0, 136.0, 0.0, 0.0, 166.0, 146.0, 87.0, 200.0, 88.0, 184.0, -6.0, 187.0, 0.0, 192.0, 0.0, -100.0, 163.0, -158.0, 0.0, 142.0, 24.0, -14.0, 0.0, 197.0, 106.0, 0.0, 0.0, 145.0, -43.0, 191.0, 72.0, 52.0, 0.0, 135.0, 188.0, 160.0, 0.0, -57.0, 181.0, 42.0, 173.0, 0.0, -28.0, -22.0, -337.0, 32.0, -2.0, -1.0, 131.0, 162.0, 70.0, 0.0, 142.0, 154.0, 148.0, 172.0, 47.0, 182.0, -3.0, 56.0, -247.0, -217.0, -153.0, 121.0, 0.0, 121.0, 21.0, 0.0, -69.0, -6.0, -4.0, 0.0, 0.0, -97.0, 182.0, -16.0, -179.0, 90.0, 13.0, 0.0, 107.0, -8.0, 26.0, 43.0, 0.0, -32.0, -237.0, -230.0, -10.0, 124.0, 92.0, 138.0, 81.0, 80.0, 19.0, -28.0, 0.0, -400.0, -8.0, -30.0, 0.0, 0.0, 195.0, 0.0, 0.0, 22.0, -64.0, 92.0, 150.0, -220.0, 0.0, -10.0, -280.0, -76.0, -18.0, 124.0, 138.0, -16.0, 104.0, 75.0, -229.0, 0.0, 0.0, -12.0, -12.0, 138.0, 194.0, 0.0, -19.0, -86.0, 168.0, -275.0, 0.0, 52.0, 200.0, 0.0, 8.0, 0.0, 185.0, 33.0, 169.0, 197.0, -30.0, 116.0, 132.0, 0.0, 146.0, 166.0, -10.0, -105.0, 87.0, -249.0, 179.0, -12.0, 200.0, -16.0, -16.0, 17.0, -1.0, 141.0, 123.0, 87.0, 11.0, -6.0, 200.0, 0.0, 200.0, 0.0, 161.0, 147.0, 103.0, 0.0, 36.0, 66.0, -12.0, 0.0, 0.0, 27.0], "policy_predator_policy_reward": [39.0, 70.0, 1.0, 17.0, 37.0, 0.0, 41.0, 21.0, 0.0, 7.0, 51.0, 2.0, 60.0, 72.0, 0.0, 0.0, 0.0, 41.0, 0.0, 0.0, 2.0, 57.0, 8.0, 20.0, 0.0, 0.0, 0.0, 7.0, 0.0, 34.0, 10.0, 30.0, 2.0, 3.0, 0.0, 0.0, 15.0, 90.0, 115.0, 32.0, 5.0, 0.0, 37.0, 7.0, 1.0, 0.0, 5.0, 0.0, 12.0, 0.0, 0.0, 77.0, 18.0, 48.0, 16.0, 9.0, 4.0, 1.0, 26.0, 50.0, 44.0, 7.0, 9.0, 0.0, 0.0, 14.0, 27.0, 179.0, 52.0, 3.0, 0.0, 6.0, 30.0, 23.0, 10.0, 14.0, 0.0, 3.0, 51.0, 0.0, 0.0, 40.0, 25.0, 162.0, 117.0, 111.0, 0.0, 0.0, 0.0, 58.0, 79.0, 39.0, 0.0, 2.0, 92.0, 7.0, 59.0, 64.0, 15.0, 113.0, 28.0, 15.0, 57.0, 62.0, 6.0, 0.0, 16.0, 0.0, 127.0, 93.0, 1.0, 5.0, 24.0, 0.0, 40.0, 7.0, 16.0, 79.0, 21.0, 179.0, 8.0, 70.0, 0.0, 0.0, 0.0, 0.0, 54.0, 37.0, 102.0, 63.0, 123.0, 87.0, 5.0, 0.0, 158.0, 131.0, 29.0, 39.0, 67.0, 35.0, 5.0, 35.0, 76.0, 92.0, 0.0, 6.0, 17.0, 7.0, 0.0, 0.0, 1.0, 112.0, 7.0, 159.0, 3.0, 49.0, 0.0, 0.0, 59.0, 7.0, 33.0, 24.0, 10.0, 6.0, 31.0, 65.0, 0.0, 0.0, 0.0, 0.0, 10.0, 84.0, 143.0, 6.0, 25.0, 44.0, 2.0, 6.0, 5.0, 49.0, 63.0, 34.0, 2.0, 4.0, 3.0, 59.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 4.0, 40.0, 41.0, 26.0, 0.0, 39.0, 21.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7164772283371916, "mean_inference_ms": 4.834790941192379, "mean_action_processing_ms": 0.8271604804360713, "mean_env_wait_ms": 0.6033411729304713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015511631965637207, "StateBufferConnector_ms": 0.008363842964172363, "ViewRequirementAgentConnector_ms": 0.31907451152801514}, "num_episodes": 18, "episode_return_max": 382.0, "episode_return_min": -277.0, "episode_return_mean": 126.45, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.8191273389485, "num_env_steps_trained_throughput_per_sec": 269.8191273389485, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 21287.676, "restore_workers_time_ms": 0.039, "training_step_time_ms": 21287.555, "sample_time_ms": 4550.417, "learn_time_ms": 16684.526, "learn_throughput": 239.743, "synch_weights_time_ms": 41.921}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 70, "trial_id": "f6b99_00000", "date": "2024-08-13_20-12-33", "timestamp": 1723594353, "time_this_iter_s": 14.880546808242798, "time_total_s": 1654.3735358715057, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6087f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1654.3735358715057, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 60.36190476190477, "ram_util_percent": 79.70952380952382}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4833628564915329, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.833055247579302, "policy_loss": -0.006124314210973877, "vf_loss": 1.8387828580286136, "vf_explained_var": 0.021577434722708646, "kl": 0.007934022853584743, "entropy": 0.6027239470570176, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.06942622497599, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9486188079944995, "policy_loss": -0.005191410004245068, "vf_loss": 3.953639802604756, "vf_explained_var": 0.474722049192146, "kl": 0.009088589648944443, "entropy": 0.8534116105112449, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "env_runners": {"episode_reward_max": 382.0, "episode_reward_min": -277.0, "episode_reward_mean": 124.09, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 179.0}, "policy_reward_mean": {"prey_policy": 32.145, "predator_policy": 29.9}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.0, 152.0, 147.0, 54.0, 198.0, 111.0, 157.0, 225.0, 190.0, 160.0, 353.0, 19.0, 274.0, 182.0, -36.0, -99.0, 52.0, 299.0, 123.0, 320.0, 323.0, 280.0, 93.0, -277.0, 196.0, 121.0, 79.0, 43.0, -2.0, 2.0, 289.0, 39.0, 56.0, 218.0, 75.0, -16.0, -247.0, 120.0, 254.0, 208.0, 86.0, -200.0, 40.0, 0.0, 195.0, 113.0, 193.0, 140.0, -5.0, -67.0, 174.0, 224.0, 219.0, -61.0, -6.0, 150.0, 194.0, 8.0, 59.0, 104.0, 200.0, 74.0, 275.0, 382.0, 182.0, 132.0, 312.0, -21.0, -13.0, 236.0, 192.0, 55.0, 237.0, 216.0, 67.0, 200.0, 200.0, 308.0, 114.0, 183.0, 14.0, 87.0, 180.0, 130.0, 163.0, 300.0, -4.0, -57.0, 150.0, 178.0, 76.0, 99.0, 249.0, 141.0, 198.0, 35.0, -10.0, 318.0, 144.0, 187.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -100.0, 163.0, -158.0, 0.0, 142.0, 24.0, -14.0, 0.0, 197.0, 106.0, 0.0, 0.0, 145.0, -43.0, 191.0, 72.0, 52.0, 0.0, 135.0, 188.0, 160.0, 0.0, -57.0, 181.0, 42.0, 173.0, 0.0, -28.0, -22.0, -337.0, 32.0, -2.0, -1.0, 131.0, 162.0, 70.0, 0.0, 142.0, 154.0, 148.0, 172.0, 47.0, 182.0, -3.0, 56.0, -247.0, -217.0, -153.0, 121.0, 0.0, 121.0, 21.0, 0.0, -69.0, -6.0, -4.0, 0.0, 0.0, -97.0, 182.0, -16.0, -179.0, 90.0, 13.0, 0.0, 107.0, -8.0, 26.0, 43.0, 0.0, -32.0, -237.0, -230.0, -10.0, 124.0, 92.0, 138.0, 81.0, 80.0, 19.0, -28.0, 0.0, -400.0, -8.0, -30.0, 0.0, 0.0, 195.0, 0.0, 0.0, 22.0, -64.0, 92.0, 150.0, -220.0, 0.0, -10.0, -280.0, -76.0, -18.0, 124.0, 138.0, -16.0, 104.0, 75.0, -229.0, 0.0, 0.0, -12.0, -12.0, 138.0, 194.0, 0.0, -19.0, -86.0, 168.0, -275.0, 0.0, 52.0, 200.0, 0.0, 8.0, 0.0, 185.0, 33.0, 169.0, 197.0, -30.0, 116.0, 132.0, 0.0, 146.0, 166.0, -10.0, -105.0, 87.0, -249.0, 179.0, -12.0, 200.0, -16.0, -16.0, 17.0, -1.0, 141.0, 123.0, 87.0, 11.0, -6.0, 200.0, 0.0, 200.0, 0.0, 161.0, 147.0, 103.0, 0.0, 36.0, 66.0, -12.0, 0.0, 0.0, 27.0, 95.0, 7.0, 0.0, 108.0, 0.0, 163.0, 84.0, 178.0, -8.0, 0.0, -136.0, 0.0, 0.0, 139.0, 176.0, 0.0, 64.0, 12.0, 99.0, 0.0, 59.0, 143.0, -14.0, 130.0, 58.0, 57.0, 5.0, -120.0, 0.0, -20.0, 122.0, 191.0, 0.0, 138.0, -12.0, 107.0], "policy_predator_policy_reward": [15.0, 90.0, 115.0, 32.0, 5.0, 0.0, 37.0, 7.0, 1.0, 0.0, 5.0, 0.0, 12.0, 0.0, 0.0, 77.0, 18.0, 48.0, 16.0, 9.0, 4.0, 1.0, 26.0, 50.0, 44.0, 7.0, 9.0, 0.0, 0.0, 14.0, 27.0, 179.0, 52.0, 3.0, 0.0, 6.0, 30.0, 23.0, 10.0, 14.0, 0.0, 3.0, 51.0, 0.0, 0.0, 40.0, 25.0, 162.0, 117.0, 111.0, 0.0, 0.0, 0.0, 58.0, 79.0, 39.0, 0.0, 2.0, 92.0, 7.0, 59.0, 64.0, 15.0, 113.0, 28.0, 15.0, 57.0, 62.0, 6.0, 0.0, 16.0, 0.0, 127.0, 93.0, 1.0, 5.0, 24.0, 0.0, 40.0, 7.0, 16.0, 79.0, 21.0, 179.0, 8.0, 70.0, 0.0, 0.0, 0.0, 0.0, 54.0, 37.0, 102.0, 63.0, 123.0, 87.0, 5.0, 0.0, 158.0, 131.0, 29.0, 39.0, 67.0, 35.0, 5.0, 35.0, 76.0, 92.0, 0.0, 6.0, 17.0, 7.0, 0.0, 0.0, 1.0, 112.0, 7.0, 159.0, 3.0, 49.0, 0.0, 0.0, 59.0, 7.0, 33.0, 24.0, 10.0, 6.0, 31.0, 65.0, 0.0, 0.0, 0.0, 0.0, 10.0, 84.0, 143.0, 6.0, 25.0, 44.0, 2.0, 6.0, 5.0, 49.0, 63.0, 34.0, 2.0, 4.0, 3.0, 59.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 4.0, 40.0, 41.0, 26.0, 0.0, 39.0, 21.0, 43.0, 35.0, 22.0, 0.0, 0.0, 0.0, 0.0, 38.0, 0.0, 4.0, 17.0, 62.0, 0.0, 11.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 47.0, 0.0, 16.0, 9.0, 39.0, 44.0, 124.0, 26.0, 10.0, 0.0, 5.0, 0.0, 3.0, 3.0, 18.0, 74.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7146387575173776, "mean_inference_ms": 4.83768974850632, "mean_action_processing_ms": 0.8243785526041892, "mean_env_wait_ms": 0.6029164263818685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01584005355834961, "StateBufferConnector_ms": 0.008315205574035645, "ViewRequirementAgentConnector_ms": 0.27981138229370117}, "num_episodes": 18, "episode_return_max": 382.0, "episode_return_min": -277.0, "episode_return_mean": 124.09, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 273.6616759218701, "num_env_steps_trained_throughput_per_sec": 273.6616759218701, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 1136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 20351.941, "restore_workers_time_ms": 0.039, "training_step_time_ms": 20351.824, "sample_time_ms": 4432.304, "learn_time_ms": 15868.626, "learn_throughput": 252.07, "synch_weights_time_ms": 40.831}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "done": false, "training_iteration": 71, "trial_id": "f6b99_00000", "date": "2024-08-13_20-12-47", "timestamp": 1723594367, "time_this_iter_s": 14.678712844848633, "time_total_s": 1669.0522487163544, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b60a73a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1669.0522487163544, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 54.18095238095238, "ram_util_percent": 79.86666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7461989625894203, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2347437921024504, "policy_loss": -0.0036648187249228754, "vf_loss": 1.238013535611844, "vf_explained_var": 0.035301008773228476, "kl": 0.00790149681383054, "entropy": 0.5835291739021029, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.014220881209802, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.359938293537765, "policy_loss": -0.005881612774393664, "vf_loss": 4.365643404400537, "vf_explained_var": 0.8330779611748993, "kl": 0.009413525384308778, "entropy": 0.875186819153488, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 382.0, "episode_reward_min": -277.0, "episode_reward_mean": 123.8, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 179.0}, "policy_reward_mean": {"prey_policy": 32.965, "predator_policy": 28.935}, "custom_metrics": {}, "hist_stats": {"episode_reward": [93.0, -277.0, 196.0, 121.0, 79.0, 43.0, -2.0, 2.0, 289.0, 39.0, 56.0, 218.0, 75.0, -16.0, -247.0, 120.0, 254.0, 208.0, 86.0, -200.0, 40.0, 0.0, 195.0, 113.0, 193.0, 140.0, -5.0, -67.0, 174.0, 224.0, 219.0, -61.0, -6.0, 150.0, 194.0, 8.0, 59.0, 104.0, 200.0, 74.0, 275.0, 382.0, 182.0, 132.0, 312.0, -21.0, -13.0, 236.0, 192.0, 55.0, 237.0, 216.0, 67.0, 200.0, 200.0, 308.0, 114.0, 183.0, 14.0, 87.0, 180.0, 130.0, 163.0, 300.0, -4.0, -57.0, 150.0, 178.0, 76.0, 99.0, 249.0, 141.0, 198.0, 35.0, -10.0, 318.0, 144.0, 187.0, 273.0, 178.0, 188.0, 153.0, 347.0, 137.0, 0.0, 120.0, 125.0, 145.0, 165.0, 163.0, 166.0, 266.0, 36.0, 197.0, 183.0, 166.0, 75.0, 141.0, 106.0, 130.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-3.0, 56.0, -247.0, -217.0, -153.0, 121.0, 0.0, 121.0, 21.0, 0.0, -69.0, -6.0, -4.0, 0.0, 0.0, -97.0, 182.0, -16.0, -179.0, 90.0, 13.0, 0.0, 107.0, -8.0, 26.0, 43.0, 0.0, -32.0, -237.0, -230.0, -10.0, 124.0, 92.0, 138.0, 81.0, 80.0, 19.0, -28.0, 0.0, -400.0, -8.0, -30.0, 0.0, 0.0, 195.0, 0.0, 0.0, 22.0, -64.0, 92.0, 150.0, -220.0, 0.0, -10.0, -280.0, -76.0, -18.0, 124.0, 138.0, -16.0, 104.0, 75.0, -229.0, 0.0, 0.0, -12.0, -12.0, 138.0, 194.0, 0.0, -19.0, -86.0, 168.0, -275.0, 0.0, 52.0, 200.0, 0.0, 8.0, 0.0, 185.0, 33.0, 169.0, 197.0, -30.0, 116.0, 132.0, 0.0, 146.0, 166.0, -10.0, -105.0, 87.0, -249.0, 179.0, -12.0, 200.0, -16.0, -16.0, 17.0, -1.0, 141.0, 123.0, 87.0, 11.0, -6.0, 200.0, 0.0, 200.0, 0.0, 161.0, 147.0, 103.0, 0.0, 36.0, 66.0, -12.0, 0.0, 0.0, 27.0, 95.0, 7.0, 0.0, 108.0, 0.0, 163.0, 84.0, 178.0, -8.0, 0.0, -136.0, 0.0, 0.0, 139.0, 176.0, 0.0, 64.0, 12.0, 99.0, 0.0, 59.0, 143.0, -14.0, 130.0, 58.0, 57.0, 5.0, -120.0, 0.0, -20.0, 122.0, 191.0, 0.0, 138.0, -12.0, 107.0, 164.0, 2.0, 0.0, 167.0, 0.0, 188.0, 0.0, 143.0, 164.0, 180.0, 137.0, 0.0, 0.0, 0.0, 119.0, -8.0, -16.0, 116.0, 151.0, -12.0, 0.0, 154.0, 0.0, 163.0, 0.0, 166.0, 144.0, 45.0, -46.0, 0.0, 106.0, -91.0, 165.0, 2.0, 167.0, -2.0, 0.0, -108.0, 98.0, 0.0, 59.0, 0.0, 0.0, 96.0], "policy_predator_policy_reward": [0.0, 40.0, 25.0, 162.0, 117.0, 111.0, 0.0, 0.0, 0.0, 58.0, 79.0, 39.0, 0.0, 2.0, 92.0, 7.0, 59.0, 64.0, 15.0, 113.0, 28.0, 15.0, 57.0, 62.0, 6.0, 0.0, 16.0, 0.0, 127.0, 93.0, 1.0, 5.0, 24.0, 0.0, 40.0, 7.0, 16.0, 79.0, 21.0, 179.0, 8.0, 70.0, 0.0, 0.0, 0.0, 0.0, 54.0, 37.0, 102.0, 63.0, 123.0, 87.0, 5.0, 0.0, 158.0, 131.0, 29.0, 39.0, 67.0, 35.0, 5.0, 35.0, 76.0, 92.0, 0.0, 6.0, 17.0, 7.0, 0.0, 0.0, 1.0, 112.0, 7.0, 159.0, 3.0, 49.0, 0.0, 0.0, 59.0, 7.0, 33.0, 24.0, 10.0, 6.0, 31.0, 65.0, 0.0, 0.0, 0.0, 0.0, 10.0, 84.0, 143.0, 6.0, 25.0, 44.0, 2.0, 6.0, 5.0, 49.0, 63.0, 34.0, 2.0, 4.0, 3.0, 59.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 4.0, 40.0, 41.0, 26.0, 0.0, 39.0, 21.0, 43.0, 35.0, 22.0, 0.0, 0.0, 0.0, 0.0, 38.0, 0.0, 4.0, 17.0, 62.0, 0.0, 11.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 47.0, 0.0, 16.0, 9.0, 39.0, 44.0, 124.0, 26.0, 10.0, 0.0, 5.0, 0.0, 3.0, 3.0, 18.0, 74.0, 42.0, 65.0, 11.0, 0.0, 0.0, 0.0, 10.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 4.0, 14.0, 11.0, 0.0, 6.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 38.0, 39.0, 82.0, 0.0, 91.0, 91.0, 0.0, 16.0, 1.0, 0.0, 91.0, 92.0, 23.0, 20.0, 47.0, 0.0, 19.0, 15.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7066216003892487, "mean_inference_ms": 4.82411766550984, "mean_action_processing_ms": 0.818886557263745, "mean_env_wait_ms": 0.6003075288416431, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016293048858642578, "StateBufferConnector_ms": 0.00817108154296875, "ViewRequirementAgentConnector_ms": 0.2445201873779297}, "num_episodes": 22, "episode_return_max": 382.0, "episode_return_min": -277.0, "episode_return_mean": 123.8, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.9920993730503, "num_env_steps_trained_throughput_per_sec": 277.9920993730503, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 19866.938, "restore_workers_time_ms": 0.038, "training_step_time_ms": 19866.825, "sample_time_ms": 4336.107, "learn_time_ms": 15480.282, "learn_throughput": 258.393, "synch_weights_time_ms": 40.494}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 72, "trial_id": "f6b99_00000", "date": "2024-08-13_20-13-02", "timestamp": 1723594382, "time_this_iter_s": 14.433963060379028, "time_total_s": 1683.4862117767334, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b625d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1683.4862117767334, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 57.375, "ram_util_percent": 80.205}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5628213096232642, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3411185485345345, "policy_loss": -0.00700467924621922, "vf_loss": 3.3477977770346183, "vf_explained_var": 0.025761500552848534, "kl": 0.0065090455968948415, "entropy": 0.604912924561551, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.378872712137838, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.698897890186815, "policy_loss": -0.009175211415138274, "vf_loss": 4.7078383470969225, "vf_explained_var": 0.27051717153301946, "kl": 0.0125202043729411, "entropy": 0.8967033094829984, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "env_runners": {"episode_reward_max": 398.0, "episode_reward_min": -108.0, "episode_reward_mean": 142.98, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -292.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 160.0}, "policy_reward_mean": {"prey_policy": 44.58, "predator_policy": 26.91}, "custom_metrics": {}, "hist_stats": {"episode_reward": [113.0, 193.0, 140.0, -5.0, -67.0, 174.0, 224.0, 219.0, -61.0, -6.0, 150.0, 194.0, 8.0, 59.0, 104.0, 200.0, 74.0, 275.0, 382.0, 182.0, 132.0, 312.0, -21.0, -13.0, 236.0, 192.0, 55.0, 237.0, 216.0, 67.0, 200.0, 200.0, 308.0, 114.0, 183.0, 14.0, 87.0, 180.0, 130.0, 163.0, 300.0, -4.0, -57.0, 150.0, 178.0, 76.0, 99.0, 249.0, 141.0, 198.0, 35.0, -10.0, 318.0, 144.0, 187.0, 273.0, 178.0, 188.0, 153.0, 347.0, 137.0, 0.0, 120.0, 125.0, 145.0, 165.0, 163.0, 166.0, 266.0, 36.0, 197.0, 183.0, 166.0, 75.0, 141.0, 106.0, 130.0, 118.0, 176.0, 47.0, 159.0, 398.0, -108.0, -2.0, 132.0, 378.0, 226.0, 251.0, 151.0, 90.0, 153.0, 331.0, 151.0, -11.0, 125.0, -13.0, 305.0, -9.0, 121.0, 121.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 22.0, -64.0, 92.0, 150.0, -220.0, 0.0, -10.0, -280.0, -76.0, -18.0, 124.0, 138.0, -16.0, 104.0, 75.0, -229.0, 0.0, 0.0, -12.0, -12.0, 138.0, 194.0, 0.0, -19.0, -86.0, 168.0, -275.0, 0.0, 52.0, 200.0, 0.0, 8.0, 0.0, 185.0, 33.0, 169.0, 197.0, -30.0, 116.0, 132.0, 0.0, 146.0, 166.0, -10.0, -105.0, 87.0, -249.0, 179.0, -12.0, 200.0, -16.0, -16.0, 17.0, -1.0, 141.0, 123.0, 87.0, 11.0, -6.0, 200.0, 0.0, 200.0, 0.0, 161.0, 147.0, 103.0, 0.0, 36.0, 66.0, -12.0, 0.0, 0.0, 27.0, 95.0, 7.0, 0.0, 108.0, 0.0, 163.0, 84.0, 178.0, -8.0, 0.0, -136.0, 0.0, 0.0, 139.0, 176.0, 0.0, 64.0, 12.0, 99.0, 0.0, 59.0, 143.0, -14.0, 130.0, 58.0, 57.0, 5.0, -120.0, 0.0, -20.0, 122.0, 191.0, 0.0, 138.0, -12.0, 107.0, 164.0, 2.0, 0.0, 167.0, 0.0, 188.0, 0.0, 143.0, 164.0, 180.0, 137.0, 0.0, 0.0, 0.0, 119.0, -8.0, -16.0, 116.0, 151.0, -12.0, 0.0, 154.0, 0.0, 163.0, 0.0, 166.0, 144.0, 45.0, -46.0, 0.0, 106.0, -91.0, 165.0, 2.0, 167.0, -2.0, 0.0, -108.0, 98.0, 0.0, 59.0, 0.0, 0.0, 96.0, -292.0, 95.0, 11.0, 94.0, 0.0, -19.0, 0.0, 159.0, 200.0, 198.0, -169.0, -63.0, 0.0, -4.0, 99.0, -10.0, 173.0, 195.0, -109.0, 175.0, 163.0, 5.0, 136.0, 0.0, 86.0, 0.0, -12.0, 144.0, 139.0, 174.0, 9.0, 105.0, -6.0, -10.0, 103.0, 0.0, 0.0, -163.0, 49.0, 200.0, -18.0, 0.0, 60.0, -16.0, 137.0, -160.0], "policy_predator_policy_reward": [54.0, 37.0, 102.0, 63.0, 123.0, 87.0, 5.0, 0.0, 158.0, 131.0, 29.0, 39.0, 67.0, 35.0, 5.0, 35.0, 76.0, 92.0, 0.0, 6.0, 17.0, 7.0, 0.0, 0.0, 1.0, 112.0, 7.0, 159.0, 3.0, 49.0, 0.0, 0.0, 59.0, 7.0, 33.0, 24.0, 10.0, 6.0, 31.0, 65.0, 0.0, 0.0, 0.0, 0.0, 10.0, 84.0, 143.0, 6.0, 25.0, 44.0, 2.0, 6.0, 5.0, 49.0, 63.0, 34.0, 2.0, 4.0, 3.0, 59.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 4.0, 40.0, 41.0, 26.0, 0.0, 39.0, 21.0, 43.0, 35.0, 22.0, 0.0, 0.0, 0.0, 0.0, 38.0, 0.0, 4.0, 17.0, 62.0, 0.0, 11.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 47.0, 0.0, 16.0, 9.0, 39.0, 44.0, 124.0, 26.0, 10.0, 0.0, 5.0, 0.0, 3.0, 3.0, 18.0, 74.0, 42.0, 65.0, 11.0, 0.0, 0.0, 0.0, 10.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 4.0, 14.0, 11.0, 0.0, 6.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 38.0, 39.0, 82.0, 0.0, 91.0, 91.0, 0.0, 16.0, 1.0, 0.0, 91.0, 92.0, 23.0, 20.0, 47.0, 0.0, 19.0, 15.0, 160.0, 155.0, 26.0, 45.0, 66.0, 0.0, 0.0, 0.0, 0.0, 0.0, 108.0, 16.0, 0.0, 2.0, 23.0, 20.0, 2.0, 8.0, 74.0, 86.0, 65.0, 18.0, 15.0, 0.0, 4.0, 0.0, 13.0, 8.0, 18.0, 0.0, 14.0, 23.0, 0.0, 5.0, 17.0, 5.0, 78.0, 72.0, 14.0, 42.0, 0.0, 9.0, 45.0, 32.0, 115.0, 29.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6918221782906482, "mean_inference_ms": 4.799224023754, "mean_action_processing_ms": 0.8207475057688538, "mean_env_wait_ms": 0.6002545514881114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01330423355102539, "StateBufferConnector_ms": 0.007547616958618164, "ViewRequirementAgentConnector_ms": 0.16195011138916016}, "num_episodes": 23, "episode_return_max": 398.0, "episode_return_min": -108.0, "episode_return_mean": 142.98, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.59363790919235, "num_env_steps_trained_throughput_per_sec": 274.59363790919235, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 1168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 19702.16, "restore_workers_time_ms": 0.038, "training_step_time_ms": 19702.046, "sample_time_ms": 4310.263, "learn_time_ms": 15340.935, "learn_throughput": 260.74, "synch_weights_time_ms": 40.663}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "done": false, "training_iteration": 73, "trial_id": "f6b99_00000", "date": "2024-08-13_20-13-16", "timestamp": 1723594396, "time_this_iter_s": 14.632322788238525, "time_total_s": 1698.118534564972, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b62985e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1698.118534564972, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 54.01428571428572, "ram_util_percent": 79.29523809523809}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0329180982062425, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0435991927114114, "policy_loss": -0.004102593604425983, "vf_loss": 1.047266742342679, "vf_explained_var": 0.037044705537261156, "kl": 0.008700852806854436, "entropy": 0.665234708722937, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.438224438573949, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.33105086523389, "policy_loss": -0.00483048226642447, "vf_loss": 4.33569516605801, "vf_explained_var": 0.4933036366783122, "kl": 0.00992935521926005, "entropy": 0.9457456996831944, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "env_runners": {"episode_reward_max": 398.0, "episode_reward_min": -154.0, "episode_reward_mean": 141.33, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -292.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 160.0}, "policy_reward_mean": {"prey_policy": 48.82, "predator_policy": 21.845}, "custom_metrics": {}, "hist_stats": {"episode_reward": [382.0, 182.0, 132.0, 312.0, -21.0, -13.0, 236.0, 192.0, 55.0, 237.0, 216.0, 67.0, 200.0, 200.0, 308.0, 114.0, 183.0, 14.0, 87.0, 180.0, 130.0, 163.0, 300.0, -4.0, -57.0, 150.0, 178.0, 76.0, 99.0, 249.0, 141.0, 198.0, 35.0, -10.0, 318.0, 144.0, 187.0, 273.0, 178.0, 188.0, 153.0, 347.0, 137.0, 0.0, 120.0, 125.0, 145.0, 165.0, 163.0, 166.0, 266.0, 36.0, 197.0, 183.0, 166.0, 75.0, 141.0, 106.0, 130.0, 118.0, 176.0, 47.0, 159.0, 398.0, -108.0, -2.0, 132.0, 378.0, 226.0, 251.0, 151.0, 90.0, 153.0, 331.0, 151.0, -11.0, 125.0, -13.0, 305.0, -9.0, 121.0, 121.0, 141.0, 51.0, -38.0, 174.0, 225.0, 0.0, 184.0, 138.0, 57.0, -154.0, 67.0, 127.0, 89.0, -9.0, 206.0, -21.0, 298.0, 288.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [169.0, 197.0, -30.0, 116.0, 132.0, 0.0, 146.0, 166.0, -10.0, -105.0, 87.0, -249.0, 179.0, -12.0, 200.0, -16.0, -16.0, 17.0, -1.0, 141.0, 123.0, 87.0, 11.0, -6.0, 200.0, 0.0, 200.0, 0.0, 161.0, 147.0, 103.0, 0.0, 36.0, 66.0, -12.0, 0.0, 0.0, 27.0, 95.0, 7.0, 0.0, 108.0, 0.0, 163.0, 84.0, 178.0, -8.0, 0.0, -136.0, 0.0, 0.0, 139.0, 176.0, 0.0, 64.0, 12.0, 99.0, 0.0, 59.0, 143.0, -14.0, 130.0, 58.0, 57.0, 5.0, -120.0, 0.0, -20.0, 122.0, 191.0, 0.0, 138.0, -12.0, 107.0, 164.0, 2.0, 0.0, 167.0, 0.0, 188.0, 0.0, 143.0, 164.0, 180.0, 137.0, 0.0, 0.0, 0.0, 119.0, -8.0, -16.0, 116.0, 151.0, -12.0, 0.0, 154.0, 0.0, 163.0, 0.0, 166.0, 144.0, 45.0, -46.0, 0.0, 106.0, -91.0, 165.0, 2.0, 167.0, -2.0, 0.0, -108.0, 98.0, 0.0, 59.0, 0.0, 0.0, 96.0, -292.0, 95.0, 11.0, 94.0, 0.0, -19.0, 0.0, 159.0, 200.0, 198.0, -169.0, -63.0, 0.0, -4.0, 99.0, -10.0, 173.0, 195.0, -109.0, 175.0, 163.0, 5.0, 136.0, 0.0, 86.0, 0.0, -12.0, 144.0, 139.0, 174.0, 9.0, 105.0, -6.0, -10.0, 103.0, 0.0, 0.0, -163.0, 49.0, 200.0, -18.0, 0.0, 60.0, -16.0, 137.0, -160.0, 0.0, 95.0, 0.0, -28.0, -18.0, -48.0, 174.0, 0.0, 112.0, 36.0, 0.0, 0.0, 0.0, 170.0, 73.0, -8.0, 2.0, 0.0, -148.0, -125.0, 0.0, 41.0, 128.0, -2.0, 0.0, 89.0, 0.0, -18.0, 84.0, 83.0, -22.0, -10.0, 188.0, 110.0, 110.0, 146.0], "policy_predator_policy_reward": [10.0, 6.0, 31.0, 65.0, 0.0, 0.0, 0.0, 0.0, 10.0, 84.0, 143.0, 6.0, 25.0, 44.0, 2.0, 6.0, 5.0, 49.0, 63.0, 34.0, 2.0, 4.0, 3.0, 59.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 4.0, 40.0, 41.0, 26.0, 0.0, 39.0, 21.0, 43.0, 35.0, 22.0, 0.0, 0.0, 0.0, 0.0, 38.0, 0.0, 4.0, 17.0, 62.0, 0.0, 11.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 47.0, 0.0, 16.0, 9.0, 39.0, 44.0, 124.0, 26.0, 10.0, 0.0, 5.0, 0.0, 3.0, 3.0, 18.0, 74.0, 42.0, 65.0, 11.0, 0.0, 0.0, 0.0, 10.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 4.0, 14.0, 11.0, 0.0, 6.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 38.0, 39.0, 82.0, 0.0, 91.0, 91.0, 0.0, 16.0, 1.0, 0.0, 91.0, 92.0, 23.0, 20.0, 47.0, 0.0, 19.0, 15.0, 160.0, 155.0, 26.0, 45.0, 66.0, 0.0, 0.0, 0.0, 0.0, 0.0, 108.0, 16.0, 0.0, 2.0, 23.0, 20.0, 2.0, 8.0, 74.0, 86.0, 65.0, 18.0, 15.0, 0.0, 4.0, 0.0, 13.0, 8.0, 18.0, 0.0, 14.0, 23.0, 0.0, 5.0, 17.0, 5.0, 78.0, 72.0, 14.0, 42.0, 0.0, 9.0, 45.0, 32.0, 115.0, 29.0, 22.0, 24.0, 70.0, 9.0, 20.0, 8.0, 0.0, 0.0, 41.0, 36.0, 0.0, 0.0, 10.0, 4.0, 11.0, 62.0, 23.0, 32.0, 20.0, 99.0, 0.0, 26.0, 0.0, 1.0, 0.0, 0.0, 9.0, 0.0, 15.0, 24.0, 0.0, 11.0, 0.0, 0.0, 30.0, 2.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6811117656567955, "mean_inference_ms": 4.7597241047231655, "mean_action_processing_ms": 0.8048145313805665, "mean_env_wait_ms": 0.5911852878610445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007126927375793457, "StateBufferConnector_ms": 0.0036214590072631836, "ViewRequirementAgentConnector_ms": 0.12796080112457275}, "num_episodes": 18, "episode_return_max": 398.0, "episode_return_min": -154.0, "episode_return_mean": 141.33, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 258.5876162309551, "num_env_steps_trained_throughput_per_sec": 258.5876162309551, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 1184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 19201.866, "restore_workers_time_ms": 0.038, "training_step_time_ms": 19201.751, "sample_time_ms": 4089.151, "learn_time_ms": 15062.828, "learn_throughput": 265.554, "synch_weights_time_ms": 39.662}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "training_iteration": 74, "trial_id": "f6b99_00000", "date": "2024-08-13_20-13-32", "timestamp": 1723594412, "time_this_iter_s": 15.525921821594238, "time_total_s": 1713.6444563865662, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b607bf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1713.6444563865662, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 61.15, "ram_util_percent": 81.03636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.415405184850491, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1938308421423827, "policy_loss": -0.00714373049084787, "vf_loss": 1.2006041910282519, "vf_explained_var": 0.029715429727362578, "kl": 0.00740756437343306, "entropy": 0.6461717789450651, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.250722162811845, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.989578337896438, "policy_loss": -0.004195101158545603, "vf_loss": 3.9936450838411925, "vf_explained_var": 0.7376245409723312, "kl": 0.0068455347042172005, "entropy": 0.8979981775006289, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 398.0, "episode_reward_min": -154.0, "episode_reward_mean": 136.1, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -292.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 160.0}, "policy_reward_mean": {"prey_policy": 47.335, "predator_policy": 20.715}, "custom_metrics": {}, "hist_stats": {"episode_reward": [87.0, 180.0, 130.0, 163.0, 300.0, -4.0, -57.0, 150.0, 178.0, 76.0, 99.0, 249.0, 141.0, 198.0, 35.0, -10.0, 318.0, 144.0, 187.0, 273.0, 178.0, 188.0, 153.0, 347.0, 137.0, 0.0, 120.0, 125.0, 145.0, 165.0, 163.0, 166.0, 266.0, 36.0, 197.0, 183.0, 166.0, 75.0, 141.0, 106.0, 130.0, 118.0, 176.0, 47.0, 159.0, 398.0, -108.0, -2.0, 132.0, 378.0, 226.0, 251.0, 151.0, 90.0, 153.0, 331.0, 151.0, -11.0, 125.0, -13.0, 305.0, -9.0, 121.0, 121.0, 141.0, 51.0, -38.0, 174.0, 225.0, 0.0, 184.0, 138.0, 57.0, -154.0, 67.0, 127.0, 89.0, -9.0, 206.0, -21.0, 298.0, 288.0, -70.0, 43.0, 169.0, 83.0, 154.0, 101.0, 161.0, 113.0, 150.0, 123.0, 181.0, 158.0, -7.0, 219.0, 288.0, 189.0, 333.0, 85.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 27.0, 95.0, 7.0, 0.0, 108.0, 0.0, 163.0, 84.0, 178.0, -8.0, 0.0, -136.0, 0.0, 0.0, 139.0, 176.0, 0.0, 64.0, 12.0, 99.0, 0.0, 59.0, 143.0, -14.0, 130.0, 58.0, 57.0, 5.0, -120.0, 0.0, -20.0, 122.0, 191.0, 0.0, 138.0, -12.0, 107.0, 164.0, 2.0, 0.0, 167.0, 0.0, 188.0, 0.0, 143.0, 164.0, 180.0, 137.0, 0.0, 0.0, 0.0, 119.0, -8.0, -16.0, 116.0, 151.0, -12.0, 0.0, 154.0, 0.0, 163.0, 0.0, 166.0, 144.0, 45.0, -46.0, 0.0, 106.0, -91.0, 165.0, 2.0, 167.0, -2.0, 0.0, -108.0, 98.0, 0.0, 59.0, 0.0, 0.0, 96.0, -292.0, 95.0, 11.0, 94.0, 0.0, -19.0, 0.0, 159.0, 200.0, 198.0, -169.0, -63.0, 0.0, -4.0, 99.0, -10.0, 173.0, 195.0, -109.0, 175.0, 163.0, 5.0, 136.0, 0.0, 86.0, 0.0, -12.0, 144.0, 139.0, 174.0, 9.0, 105.0, -6.0, -10.0, 103.0, 0.0, 0.0, -163.0, 49.0, 200.0, -18.0, 0.0, 60.0, -16.0, 137.0, -160.0, 0.0, 95.0, 0.0, -28.0, -18.0, -48.0, 174.0, 0.0, 112.0, 36.0, 0.0, 0.0, 0.0, 170.0, 73.0, -8.0, 2.0, 0.0, -148.0, -125.0, 0.0, 41.0, 128.0, -2.0, 0.0, 89.0, 0.0, -18.0, 84.0, 83.0, -22.0, -10.0, 188.0, 110.0, 110.0, 146.0, 0.0, -195.0, 37.0, 2.0, 0.0, 157.0, 70.0, 0.0, 0.0, 131.0, 114.0, -108.0, 154.0, 0.0, 76.0, -10.0, 125.0, 0.0, 108.0, 0.0, 178.0, 0.0, 107.0, 0.0, -14.0, 0.0, 20.0, 141.0, 62.0, 180.0, 0.0, 189.0, 159.0, 174.0, 85.0, -12.0], "policy_predator_policy_reward": [39.0, 21.0, 43.0, 35.0, 22.0, 0.0, 0.0, 0.0, 0.0, 38.0, 0.0, 4.0, 17.0, 62.0, 0.0, 11.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 47.0, 0.0, 16.0, 9.0, 39.0, 44.0, 124.0, 26.0, 10.0, 0.0, 5.0, 0.0, 3.0, 3.0, 18.0, 74.0, 42.0, 65.0, 11.0, 0.0, 0.0, 0.0, 10.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 4.0, 14.0, 11.0, 0.0, 6.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 38.0, 39.0, 82.0, 0.0, 91.0, 91.0, 0.0, 16.0, 1.0, 0.0, 91.0, 92.0, 23.0, 20.0, 47.0, 0.0, 19.0, 15.0, 160.0, 155.0, 26.0, 45.0, 66.0, 0.0, 0.0, 0.0, 0.0, 0.0, 108.0, 16.0, 0.0, 2.0, 23.0, 20.0, 2.0, 8.0, 74.0, 86.0, 65.0, 18.0, 15.0, 0.0, 4.0, 0.0, 13.0, 8.0, 18.0, 0.0, 14.0, 23.0, 0.0, 5.0, 17.0, 5.0, 78.0, 72.0, 14.0, 42.0, 0.0, 9.0, 45.0, 32.0, 115.0, 29.0, 22.0, 24.0, 70.0, 9.0, 20.0, 8.0, 0.0, 0.0, 41.0, 36.0, 0.0, 0.0, 10.0, 4.0, 11.0, 62.0, 23.0, 32.0, 20.0, 99.0, 0.0, 26.0, 0.0, 1.0, 0.0, 0.0, 9.0, 0.0, 15.0, 24.0, 0.0, 11.0, 0.0, 0.0, 30.0, 2.0, 0.0, 125.0, 0.0, 4.0, 0.0, 12.0, 0.0, 13.0, 0.0, 23.0, 75.0, 20.0, 0.0, 7.0, 30.0, 17.0, 0.0, 25.0, 6.0, 9.0, 3.0, 0.0, 26.0, 25.0, 7.0, 0.0, 6.0, 52.0, 8.0, 38.0, 0.0, 0.0, 0.0, 0.0, 6.0, 6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6709845371838008, "mean_inference_ms": 4.734442302270914, "mean_action_processing_ms": 0.7990216598087673, "mean_env_wait_ms": 0.5875553311715352, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007025480270385742, "StateBufferConnector_ms": 0.003765702247619629, "ViewRequirementAgentConnector_ms": 0.13899743556976318}, "num_episodes": 18, "episode_return_max": 398.0, "episode_return_min": -154.0, "episode_return_mean": 136.1, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 248.49276643863203, "num_env_steps_trained_throughput_per_sec": 248.49276643863203, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 17899.215, "restore_workers_time_ms": 0.038, "training_step_time_ms": 17899.1, "sample_time_ms": 3322.967, "learn_time_ms": 14526.806, "learn_throughput": 275.353, "synch_weights_time_ms": 39.358}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 75, "trial_id": "f6b99_00000", "date": "2024-08-13_20-13-48", "timestamp": 1723594428, "time_this_iter_s": 16.12433886528015, "time_total_s": 1729.7687952518463, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b625de50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1729.7687952518463, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 58.9, "ram_util_percent": 82.76956521739133}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6321454666594348, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3209258850920138, "policy_loss": -0.004340814586935772, "vf_loss": 1.3250207104537852, "vf_explained_var": 0.023110963806273446, "kl": 0.004919825408771044, "entropy": 0.5003908973206919, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8990619385053242, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7350368118790724, "policy_loss": -0.0037804211179415384, "vf_loss": 2.738664381340067, "vf_explained_var": 0.7280883051730969, "kl": 0.008152393761455014, "entropy": 0.9708432678192381, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "env_runners": {"episode_reward_max": 398.0, "episode_reward_min": -154.0, "episode_reward_mean": 137.95, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -292.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 160.0}, "policy_reward_mean": {"prey_policy": 48.475, "predator_policy": 20.5}, "custom_metrics": {}, "hist_stats": {"episode_reward": [153.0, 347.0, 137.0, 0.0, 120.0, 125.0, 145.0, 165.0, 163.0, 166.0, 266.0, 36.0, 197.0, 183.0, 166.0, 75.0, 141.0, 106.0, 130.0, 118.0, 176.0, 47.0, 159.0, 398.0, -108.0, -2.0, 132.0, 378.0, 226.0, 251.0, 151.0, 90.0, 153.0, 331.0, 151.0, -11.0, 125.0, -13.0, 305.0, -9.0, 121.0, 121.0, 141.0, 51.0, -38.0, 174.0, 225.0, 0.0, 184.0, 138.0, 57.0, -154.0, 67.0, 127.0, 89.0, -9.0, 206.0, -21.0, 298.0, 288.0, -70.0, 43.0, 169.0, 83.0, 154.0, 101.0, 161.0, 113.0, 150.0, 123.0, 181.0, 158.0, -7.0, 219.0, 288.0, 189.0, 333.0, 85.0, 293.0, 159.0, 219.0, 146.0, -5.0, 115.0, 206.0, 127.0, -11.0, 84.0, 373.0, 177.0, 158.0, 25.0, 140.0, 20.0, 273.0, 290.0, 0.0, 77.0, 340.0, 182.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 143.0, 164.0, 180.0, 137.0, 0.0, 0.0, 0.0, 119.0, -8.0, -16.0, 116.0, 151.0, -12.0, 0.0, 154.0, 0.0, 163.0, 0.0, 166.0, 144.0, 45.0, -46.0, 0.0, 106.0, -91.0, 165.0, 2.0, 167.0, -2.0, 0.0, -108.0, 98.0, 0.0, 59.0, 0.0, 0.0, 96.0, -292.0, 95.0, 11.0, 94.0, 0.0, -19.0, 0.0, 159.0, 200.0, 198.0, -169.0, -63.0, 0.0, -4.0, 99.0, -10.0, 173.0, 195.0, -109.0, 175.0, 163.0, 5.0, 136.0, 0.0, 86.0, 0.0, -12.0, 144.0, 139.0, 174.0, 9.0, 105.0, -6.0, -10.0, 103.0, 0.0, 0.0, -163.0, 49.0, 200.0, -18.0, 0.0, 60.0, -16.0, 137.0, -160.0, 0.0, 95.0, 0.0, -28.0, -18.0, -48.0, 174.0, 0.0, 112.0, 36.0, 0.0, 0.0, 0.0, 170.0, 73.0, -8.0, 2.0, 0.0, -148.0, -125.0, 0.0, 41.0, 128.0, -2.0, 0.0, 89.0, 0.0, -18.0, 84.0, 83.0, -22.0, -10.0, 188.0, 110.0, 110.0, 146.0, 0.0, -195.0, 37.0, 2.0, 0.0, 157.0, 70.0, 0.0, 0.0, 131.0, 114.0, -108.0, 154.0, 0.0, 76.0, -10.0, 125.0, 0.0, 108.0, 0.0, 178.0, 0.0, 107.0, 0.0, -14.0, 0.0, 20.0, 141.0, 62.0, 180.0, 0.0, 189.0, 159.0, 174.0, 85.0, -12.0, 200.0, 34.0, -4.0, 144.0, 113.0, -61.0, 0.0, 143.0, -11.0, 0.0, 0.0, 50.0, 47.0, 125.0, 101.0, -4.0, -10.0, -16.0, 90.0, -12.0, 152.0, 200.0, -6.0, 180.0, 0.0, 101.0, -43.0, 0.0, 127.0, 0.0, 0.0, 20.0, 110.0, 104.0, 36.0, 171.0, 0.0, 0.0, 19.0, 0.0, 154.0, 174.0, 173.0, 0.0], "policy_predator_policy_reward": [10.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 4.0, 14.0, 11.0, 0.0, 6.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 38.0, 39.0, 82.0, 0.0, 91.0, 91.0, 0.0, 16.0, 1.0, 0.0, 91.0, 92.0, 23.0, 20.0, 47.0, 0.0, 19.0, 15.0, 160.0, 155.0, 26.0, 45.0, 66.0, 0.0, 0.0, 0.0, 0.0, 0.0, 108.0, 16.0, 0.0, 2.0, 23.0, 20.0, 2.0, 8.0, 74.0, 86.0, 65.0, 18.0, 15.0, 0.0, 4.0, 0.0, 13.0, 8.0, 18.0, 0.0, 14.0, 23.0, 0.0, 5.0, 17.0, 5.0, 78.0, 72.0, 14.0, 42.0, 0.0, 9.0, 45.0, 32.0, 115.0, 29.0, 22.0, 24.0, 70.0, 9.0, 20.0, 8.0, 0.0, 0.0, 41.0, 36.0, 0.0, 0.0, 10.0, 4.0, 11.0, 62.0, 23.0, 32.0, 20.0, 99.0, 0.0, 26.0, 0.0, 1.0, 0.0, 0.0, 9.0, 0.0, 15.0, 24.0, 0.0, 11.0, 0.0, 0.0, 30.0, 2.0, 0.0, 125.0, 0.0, 4.0, 0.0, 12.0, 0.0, 13.0, 0.0, 23.0, 75.0, 20.0, 0.0, 7.0, 30.0, 17.0, 0.0, 25.0, 6.0, 9.0, 3.0, 0.0, 26.0, 25.0, 7.0, 0.0, 6.0, 52.0, 8.0, 38.0, 0.0, 0.0, 0.0, 0.0, 6.0, 6.0, 35.0, 24.0, 18.0, 1.0, 73.0, 94.0, 3.0, 0.0, 0.0, 6.0, 15.0, 50.0, 19.0, 15.0, 27.0, 3.0, 7.0, 8.0, 6.0, 0.0, 15.0, 6.0, 0.0, 3.0, 29.0, 28.0, 62.0, 6.0, 0.0, 13.0, 0.0, 0.0, 53.0, 6.0, 33.0, 50.0, 0.0, 0.0, 1.0, 57.0, 12.0, 0.0, 0.0, 9.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6655016832650396, "mean_inference_ms": 4.722993322968666, "mean_action_processing_ms": 0.7981245666229827, "mean_env_wait_ms": 0.5863598861691766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0063658952713012695, "StateBufferConnector_ms": 0.004130959510803223, "ViewRequirementAgentConnector_ms": 0.16967976093292236}, "num_episodes": 22, "episode_return_max": 398.0, "episode_return_min": -154.0, "episode_return_mean": 137.95, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 273.5557811977164, "num_env_steps_trained_throughput_per_sec": 273.5557811977164, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 1216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1216000, "timers": {"training_iteration_time_ms": 16717.927, "restore_workers_time_ms": 0.038, "training_step_time_ms": 16717.821, "sample_time_ms": 3093.187, "learn_time_ms": 13597.826, "learn_throughput": 294.165, "synch_weights_time_ms": 21.05}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "done": false, "training_iteration": 76, "trial_id": "f6b99_00000", "date": "2024-08-13_20-14-03", "timestamp": 1723594443, "time_this_iter_s": 14.666702032089233, "time_total_s": 1744.4354972839355, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b60a7a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1744.4354972839355, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 58.03809523809524, "ram_util_percent": 83.08571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.182479159289567, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6426006789245302, "policy_loss": -0.004198199657664176, "vf_loss": 1.6465928711273052, "vf_explained_var": 0.025217238305106995, "kl": 0.008240136431656235, "entropy": 0.5738202029908145, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.606980364221744, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7192005305063156, "policy_loss": -0.0047413117720415355, "vf_loss": 3.7237848657779593, "vf_explained_var": 0.5428745713814226, "kl": 0.008371978884343137, "entropy": 0.9766372927597591, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "env_runners": {"episode_reward_max": 398.0, "episode_reward_min": -154.0, "episode_reward_mean": 133.92, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -292.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 160.0}, "policy_reward_mean": {"prey_policy": 46.245, "predator_policy": 20.715}, "custom_metrics": {}, "hist_stats": {"episode_reward": [130.0, 118.0, 176.0, 47.0, 159.0, 398.0, -108.0, -2.0, 132.0, 378.0, 226.0, 251.0, 151.0, 90.0, 153.0, 331.0, 151.0, -11.0, 125.0, -13.0, 305.0, -9.0, 121.0, 121.0, 141.0, 51.0, -38.0, 174.0, 225.0, 0.0, 184.0, 138.0, 57.0, -154.0, 67.0, 127.0, 89.0, -9.0, 206.0, -21.0, 298.0, 288.0, -70.0, 43.0, 169.0, 83.0, 154.0, 101.0, 161.0, 113.0, 150.0, 123.0, 181.0, 158.0, -7.0, 219.0, 288.0, 189.0, 333.0, 85.0, 293.0, 159.0, 219.0, 146.0, -5.0, 115.0, 206.0, 127.0, -11.0, 84.0, 373.0, 177.0, 158.0, 25.0, 140.0, 20.0, 273.0, 290.0, 0.0, 77.0, 340.0, 182.0, 260.0, 124.0, -17.0, -16.0, 189.0, 185.0, 192.0, 152.0, 72.0, 139.0, 189.0, -117.0, 115.0, 344.0, 0.0, 191.0, 121.0, 165.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 96.0, -292.0, 95.0, 11.0, 94.0, 0.0, -19.0, 0.0, 159.0, 200.0, 198.0, -169.0, -63.0, 0.0, -4.0, 99.0, -10.0, 173.0, 195.0, -109.0, 175.0, 163.0, 5.0, 136.0, 0.0, 86.0, 0.0, -12.0, 144.0, 139.0, 174.0, 9.0, 105.0, -6.0, -10.0, 103.0, 0.0, 0.0, -163.0, 49.0, 200.0, -18.0, 0.0, 60.0, -16.0, 137.0, -160.0, 0.0, 95.0, 0.0, -28.0, -18.0, -48.0, 174.0, 0.0, 112.0, 36.0, 0.0, 0.0, 0.0, 170.0, 73.0, -8.0, 2.0, 0.0, -148.0, -125.0, 0.0, 41.0, 128.0, -2.0, 0.0, 89.0, 0.0, -18.0, 84.0, 83.0, -22.0, -10.0, 188.0, 110.0, 110.0, 146.0, 0.0, -195.0, 37.0, 2.0, 0.0, 157.0, 70.0, 0.0, 0.0, 131.0, 114.0, -108.0, 154.0, 0.0, 76.0, -10.0, 125.0, 0.0, 108.0, 0.0, 178.0, 0.0, 107.0, 0.0, -14.0, 0.0, 20.0, 141.0, 62.0, 180.0, 0.0, 189.0, 159.0, 174.0, 85.0, -12.0, 200.0, 34.0, -4.0, 144.0, 113.0, -61.0, 0.0, 143.0, -11.0, 0.0, 0.0, 50.0, 47.0, 125.0, 101.0, -4.0, -10.0, -16.0, 90.0, -12.0, 152.0, 200.0, -6.0, 180.0, 0.0, 101.0, -43.0, 0.0, 127.0, 0.0, 0.0, 20.0, 110.0, 104.0, 36.0, 171.0, 0.0, 0.0, 19.0, 0.0, 154.0, 174.0, 173.0, 0.0, 158.0, 32.0, 0.0, 52.0, -190.0, 12.0, -18.0, -17.0, 0.0, 188.0, 187.0, -4.0, 0.0, 188.0, 0.0, 146.0, 72.0, 0.0, 132.0, -8.0, 31.0, 106.0, -272.0, 0.0, 0.0, 105.0, 191.0, 141.0, 0.0, 0.0, -19.0, 66.0, 121.0, 0.0, 150.0, 0.0], "policy_predator_policy_reward": [19.0, 15.0, 160.0, 155.0, 26.0, 45.0, 66.0, 0.0, 0.0, 0.0, 0.0, 0.0, 108.0, 16.0, 0.0, 2.0, 23.0, 20.0, 2.0, 8.0, 74.0, 86.0, 65.0, 18.0, 15.0, 0.0, 4.0, 0.0, 13.0, 8.0, 18.0, 0.0, 14.0, 23.0, 0.0, 5.0, 17.0, 5.0, 78.0, 72.0, 14.0, 42.0, 0.0, 9.0, 45.0, 32.0, 115.0, 29.0, 22.0, 24.0, 70.0, 9.0, 20.0, 8.0, 0.0, 0.0, 41.0, 36.0, 0.0, 0.0, 10.0, 4.0, 11.0, 62.0, 23.0, 32.0, 20.0, 99.0, 0.0, 26.0, 0.0, 1.0, 0.0, 0.0, 9.0, 0.0, 15.0, 24.0, 0.0, 11.0, 0.0, 0.0, 30.0, 2.0, 0.0, 125.0, 0.0, 4.0, 0.0, 12.0, 0.0, 13.0, 0.0, 23.0, 75.0, 20.0, 0.0, 7.0, 30.0, 17.0, 0.0, 25.0, 6.0, 9.0, 3.0, 0.0, 26.0, 25.0, 7.0, 0.0, 6.0, 52.0, 8.0, 38.0, 0.0, 0.0, 0.0, 0.0, 6.0, 6.0, 35.0, 24.0, 18.0, 1.0, 73.0, 94.0, 3.0, 0.0, 0.0, 6.0, 15.0, 50.0, 19.0, 15.0, 27.0, 3.0, 7.0, 8.0, 6.0, 0.0, 15.0, 6.0, 0.0, 3.0, 29.0, 28.0, 62.0, 6.0, 0.0, 13.0, 0.0, 0.0, 53.0, 6.0, 33.0, 50.0, 0.0, 0.0, 1.0, 57.0, 12.0, 0.0, 0.0, 9.0, 56.0, 14.0, 30.0, 42.0, 146.0, 15.0, 0.0, 19.0, 0.0, 1.0, 2.0, 0.0, 3.0, 1.0, 0.0, 6.0, 0.0, 0.0, 11.0, 4.0, 35.0, 17.0, 155.0, 0.0, 10.0, 0.0, 0.0, 12.0, 0.0, 0.0, 70.0, 74.0, 0.0, 0.0, 10.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6512307773828903, "mean_inference_ms": 4.683192185866561, "mean_action_processing_ms": 0.7871725191011495, "mean_env_wait_ms": 0.5801504657656381, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005692481994628906, "StateBufferConnector_ms": 0.004204273223876953, "ViewRequirementAgentConnector_ms": 0.16700506210327148}, "num_episodes": 18, "episode_return_max": 398.0, "episode_return_min": -154.0, "episode_return_mean": 133.92, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 278.14462137116254, "num_env_steps_trained_throughput_per_sec": 278.14462137116254, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 1232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1232000, "timers": {"training_iteration_time_ms": 16161.331, "restore_workers_time_ms": 0.019, "training_step_time_ms": 16161.27, "sample_time_ms": 2606.873, "learn_time_ms": 13532.578, "learn_throughput": 295.583, "synch_weights_time_ms": 17.487}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "done": false, "training_iteration": 77, "trial_id": "f6b99_00000", "date": "2024-08-13_20-14-17", "timestamp": 1723594457, "time_this_iter_s": 14.42386794090271, "time_total_s": 1758.8593652248383, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b605b280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1758.8593652248383, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 56.54, "ram_util_percent": 82.28}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9591520299829503, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0340224955447768, "policy_loss": -0.004466622368131996, "vf_loss": 1.0382301824039253, "vf_explained_var": 0.0321008960721354, "kl": 0.010357476174949498, "entropy": 0.5435450987368033, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.297505490994327, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2114100543279496, "policy_loss": -0.00587436463141804, "vf_loss": 3.2169639549558124, "vf_explained_var": 0.6430683210413292, "kl": 0.017092004131131145, "entropy": 0.9274248123799682, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 373.0, "episode_reward_min": -154.0, "episode_reward_mean": 127.94, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -272.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 155.0}, "policy_reward_mean": {"prey_policy": 46.65, "predator_policy": 17.32}, "custom_metrics": {}, "hist_stats": {"episode_reward": [121.0, 141.0, 51.0, -38.0, 174.0, 225.0, 0.0, 184.0, 138.0, 57.0, -154.0, 67.0, 127.0, 89.0, -9.0, 206.0, -21.0, 298.0, 288.0, -70.0, 43.0, 169.0, 83.0, 154.0, 101.0, 161.0, 113.0, 150.0, 123.0, 181.0, 158.0, -7.0, 219.0, 288.0, 189.0, 333.0, 85.0, 293.0, 159.0, 219.0, 146.0, -5.0, 115.0, 206.0, 127.0, -11.0, 84.0, 373.0, 177.0, 158.0, 25.0, 140.0, 20.0, 273.0, 290.0, 0.0, 77.0, 340.0, 182.0, 260.0, 124.0, -17.0, -16.0, 189.0, 185.0, 192.0, 152.0, 72.0, 139.0, 189.0, -117.0, 115.0, 344.0, 0.0, 191.0, 121.0, 165.0, 69.0, 114.0, 159.0, 354.0, 162.0, -15.0, 0.0, -13.0, 328.0, 110.0, 0.0, 148.0, 68.0, -4.0, 266.0, -16.0, 185.0, 109.0, -17.0, 325.0, 161.0, 91.0, 117.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [137.0, -160.0, 0.0, 95.0, 0.0, -28.0, -18.0, -48.0, 174.0, 0.0, 112.0, 36.0, 0.0, 0.0, 0.0, 170.0, 73.0, -8.0, 2.0, 0.0, -148.0, -125.0, 0.0, 41.0, 128.0, -2.0, 0.0, 89.0, 0.0, -18.0, 84.0, 83.0, -22.0, -10.0, 188.0, 110.0, 110.0, 146.0, 0.0, -195.0, 37.0, 2.0, 0.0, 157.0, 70.0, 0.0, 0.0, 131.0, 114.0, -108.0, 154.0, 0.0, 76.0, -10.0, 125.0, 0.0, 108.0, 0.0, 178.0, 0.0, 107.0, 0.0, -14.0, 0.0, 20.0, 141.0, 62.0, 180.0, 0.0, 189.0, 159.0, 174.0, 85.0, -12.0, 200.0, 34.0, -4.0, 144.0, 113.0, -61.0, 0.0, 143.0, -11.0, 0.0, 0.0, 50.0, 47.0, 125.0, 101.0, -4.0, -10.0, -16.0, 90.0, -12.0, 152.0, 200.0, -6.0, 180.0, 0.0, 101.0, -43.0, 0.0, 127.0, 0.0, 0.0, 20.0, 110.0, 104.0, 36.0, 171.0, 0.0, 0.0, 19.0, 0.0, 154.0, 174.0, 173.0, 0.0, 158.0, 32.0, 0.0, 52.0, -190.0, 12.0, -18.0, -17.0, 0.0, 188.0, 187.0, -4.0, 0.0, 188.0, 0.0, 146.0, 72.0, 0.0, 132.0, -8.0, 31.0, 106.0, -272.0, 0.0, 0.0, 105.0, 191.0, 141.0, 0.0, 0.0, -19.0, 66.0, 121.0, 0.0, 150.0, 0.0, -14.0, 52.0, -8.0, 107.0, 159.0, 0.0, 179.0, 167.0, 143.0, 0.0, 0.0, -30.0, 0.0, 0.0, -14.0, -12.0, 137.0, 170.0, 90.0, 0.0, 0.0, 0.0, 0.0, 148.0, -14.0, 0.0, 0.0, -8.0, 165.0, 77.0, -10.0, -14.0, -18.0, 194.0, 103.0, -16.0, -128.0, 0.0, 134.0, 179.0, 0.0, 121.0, -113.0, 109.0, -69.0, 92.0], "policy_predator_policy_reward": [115.0, 29.0, 22.0, 24.0, 70.0, 9.0, 20.0, 8.0, 0.0, 0.0, 41.0, 36.0, 0.0, 0.0, 10.0, 4.0, 11.0, 62.0, 23.0, 32.0, 20.0, 99.0, 0.0, 26.0, 0.0, 1.0, 0.0, 0.0, 9.0, 0.0, 15.0, 24.0, 0.0, 11.0, 0.0, 0.0, 30.0, 2.0, 0.0, 125.0, 0.0, 4.0, 0.0, 12.0, 0.0, 13.0, 0.0, 23.0, 75.0, 20.0, 0.0, 7.0, 30.0, 17.0, 0.0, 25.0, 6.0, 9.0, 3.0, 0.0, 26.0, 25.0, 7.0, 0.0, 6.0, 52.0, 8.0, 38.0, 0.0, 0.0, 0.0, 0.0, 6.0, 6.0, 35.0, 24.0, 18.0, 1.0, 73.0, 94.0, 3.0, 0.0, 0.0, 6.0, 15.0, 50.0, 19.0, 15.0, 27.0, 3.0, 7.0, 8.0, 6.0, 0.0, 15.0, 6.0, 0.0, 3.0, 29.0, 28.0, 62.0, 6.0, 0.0, 13.0, 0.0, 0.0, 53.0, 6.0, 33.0, 50.0, 0.0, 0.0, 1.0, 57.0, 12.0, 0.0, 0.0, 9.0, 56.0, 14.0, 30.0, 42.0, 146.0, 15.0, 0.0, 19.0, 0.0, 1.0, 2.0, 0.0, 3.0, 1.0, 0.0, 6.0, 0.0, 0.0, 11.0, 4.0, 35.0, 17.0, 155.0, 0.0, 10.0, 0.0, 0.0, 12.0, 0.0, 0.0, 70.0, 74.0, 0.0, 0.0, 10.0, 5.0, 13.0, 18.0, 13.0, 2.0, 0.0, 0.0, 8.0, 0.0, 1.0, 18.0, 15.0, 0.0, 0.0, 0.0, 0.0, 13.0, 11.0, 10.0, 3.0, 17.0, 0.0, 0.0, 0.0, 0.0, 47.0, 35.0, 0.0, 4.0, 0.0, 24.0, 0.0, 8.0, 0.0, 9.0, 20.0, 2.0, 7.0, 104.0, 0.0, 12.0, 25.0, 15.0, 1.0, 94.0, 62.0, 32.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6401971425200366, "mean_inference_ms": 4.654961463548257, "mean_action_processing_ms": 0.7803539326188897, "mean_env_wait_ms": 0.5760017816302923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005200862884521484, "StateBufferConnector_ms": 0.004360556602478027, "ViewRequirementAgentConnector_ms": 0.16417932510375977}, "num_episodes": 23, "episode_return_max": 373.0, "episode_return_min": -154.0, "episode_return_mean": 127.94, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 275.5793275688165, "num_env_steps_trained_throughput_per_sec": 275.5793275688165, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 15039.166, "restore_workers_time_ms": 0.018, "training_step_time_ms": 15039.106, "sample_time_ms": 2113.651, "learn_time_ms": 12906.045, "learn_throughput": 309.932, "synch_weights_time_ms": 15.836}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 78, "trial_id": "f6b99_00000", "date": "2024-08-13_20-14-32", "timestamp": 1723594472, "time_this_iter_s": 14.545387744903564, "time_total_s": 1773.4047529697418, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6298b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1773.4047529697418, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 57.31904761904762, "ram_util_percent": 83.18095238095238}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1506480347227168, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8537073964006686, "policy_loss": -0.005406996886191702, "vf_loss": 0.8589431612461648, "vf_explained_var": 0.05480916563165251, "kl": 0.006849350506238003, "entropy": 0.5079295676694345, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.857523156347729, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.541856983603624, "policy_loss": -0.00570410844985711, "vf_loss": 3.547400485775458, "vf_explained_var": 0.8201950790390136, "kl": 0.008565383627975785, "entropy": 0.8581166466077169, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "env_runners": {"episode_reward_max": 373.0, "episode_reward_min": -117.0, "episode_reward_mean": 137.45, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -272.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 155.0}, "policy_reward_mean": {"prey_policy": 53.165, "predator_policy": 15.56}, "custom_metrics": {}, "hist_stats": {"episode_reward": [288.0, -70.0, 43.0, 169.0, 83.0, 154.0, 101.0, 161.0, 113.0, 150.0, 123.0, 181.0, 158.0, -7.0, 219.0, 288.0, 189.0, 333.0, 85.0, 293.0, 159.0, 219.0, 146.0, -5.0, 115.0, 206.0, 127.0, -11.0, 84.0, 373.0, 177.0, 158.0, 25.0, 140.0, 20.0, 273.0, 290.0, 0.0, 77.0, 340.0, 182.0, 260.0, 124.0, -17.0, -16.0, 189.0, 185.0, 192.0, 152.0, 72.0, 139.0, 189.0, -117.0, 115.0, 344.0, 0.0, 191.0, 121.0, 165.0, 69.0, 114.0, 159.0, 354.0, 162.0, -15.0, 0.0, -13.0, 328.0, 110.0, 0.0, 148.0, 68.0, -4.0, 266.0, -16.0, 185.0, 109.0, -17.0, 325.0, 161.0, 91.0, 117.0, 119.0, 132.0, 105.0, 188.0, -6.0, 372.0, 121.0, 272.0, 0.0, 138.0, 142.0, 120.0, 54.0, 225.0, 113.0, -19.0, 353.0, 178.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [110.0, 146.0, 0.0, -195.0, 37.0, 2.0, 0.0, 157.0, 70.0, 0.0, 0.0, 131.0, 114.0, -108.0, 154.0, 0.0, 76.0, -10.0, 125.0, 0.0, 108.0, 0.0, 178.0, 0.0, 107.0, 0.0, -14.0, 0.0, 20.0, 141.0, 62.0, 180.0, 0.0, 189.0, 159.0, 174.0, 85.0, -12.0, 200.0, 34.0, -4.0, 144.0, 113.0, -61.0, 0.0, 143.0, -11.0, 0.0, 0.0, 50.0, 47.0, 125.0, 101.0, -4.0, -10.0, -16.0, 90.0, -12.0, 152.0, 200.0, -6.0, 180.0, 0.0, 101.0, -43.0, 0.0, 127.0, 0.0, 0.0, 20.0, 110.0, 104.0, 36.0, 171.0, 0.0, 0.0, 19.0, 0.0, 154.0, 174.0, 173.0, 0.0, 158.0, 32.0, 0.0, 52.0, -190.0, 12.0, -18.0, -17.0, 0.0, 188.0, 187.0, -4.0, 0.0, 188.0, 0.0, 146.0, 72.0, 0.0, 132.0, -8.0, 31.0, 106.0, -272.0, 0.0, 0.0, 105.0, 191.0, 141.0, 0.0, 0.0, -19.0, 66.0, 121.0, 0.0, 150.0, 0.0, -14.0, 52.0, -8.0, 107.0, 159.0, 0.0, 179.0, 167.0, 143.0, 0.0, 0.0, -30.0, 0.0, 0.0, -14.0, -12.0, 137.0, 170.0, 90.0, 0.0, 0.0, 0.0, 0.0, 148.0, -14.0, 0.0, 0.0, -8.0, 165.0, 77.0, -10.0, -14.0, -18.0, 194.0, 103.0, -16.0, -128.0, 0.0, 134.0, 179.0, 0.0, 121.0, -113.0, 109.0, -69.0, 92.0, 6.0, 113.0, 0.0, 111.0, 0.0, -42.0, 182.0, 0.0, -12.0, 0.0, 200.0, 170.0, 99.0, 0.0, 122.0, 98.0, 0.0, 0.0, 146.0, -20.0, -32.0, 156.0, -10.0, 106.0, 54.0, 0.0, 132.0, 82.0, 109.0, 0.0, -40.0, 0.0, 156.0, 185.0, 167.0, 0.0], "policy_predator_policy_reward": [30.0, 2.0, 0.0, 125.0, 0.0, 4.0, 0.0, 12.0, 0.0, 13.0, 0.0, 23.0, 75.0, 20.0, 0.0, 7.0, 30.0, 17.0, 0.0, 25.0, 6.0, 9.0, 3.0, 0.0, 26.0, 25.0, 7.0, 0.0, 6.0, 52.0, 8.0, 38.0, 0.0, 0.0, 0.0, 0.0, 6.0, 6.0, 35.0, 24.0, 18.0, 1.0, 73.0, 94.0, 3.0, 0.0, 0.0, 6.0, 15.0, 50.0, 19.0, 15.0, 27.0, 3.0, 7.0, 8.0, 6.0, 0.0, 15.0, 6.0, 0.0, 3.0, 29.0, 28.0, 62.0, 6.0, 0.0, 13.0, 0.0, 0.0, 53.0, 6.0, 33.0, 50.0, 0.0, 0.0, 1.0, 57.0, 12.0, 0.0, 0.0, 9.0, 56.0, 14.0, 30.0, 42.0, 146.0, 15.0, 0.0, 19.0, 0.0, 1.0, 2.0, 0.0, 3.0, 1.0, 0.0, 6.0, 0.0, 0.0, 11.0, 4.0, 35.0, 17.0, 155.0, 0.0, 10.0, 0.0, 0.0, 12.0, 0.0, 0.0, 70.0, 74.0, 0.0, 0.0, 10.0, 5.0, 13.0, 18.0, 13.0, 2.0, 0.0, 0.0, 8.0, 0.0, 1.0, 18.0, 15.0, 0.0, 0.0, 0.0, 0.0, 13.0, 11.0, 10.0, 3.0, 17.0, 0.0, 0.0, 0.0, 0.0, 47.0, 35.0, 0.0, 4.0, 0.0, 24.0, 0.0, 8.0, 0.0, 9.0, 20.0, 2.0, 7.0, 104.0, 0.0, 12.0, 25.0, 15.0, 1.0, 94.0, 62.0, 32.0, 0.0, 0.0, 21.0, 0.0, 69.0, 78.0, 0.0, 6.0, 6.0, 0.0, 2.0, 0.0, 22.0, 0.0, 13.0, 39.0, 0.0, 0.0, 12.0, 0.0, 18.0, 0.0, 2.0, 22.0, 0.0, 0.0, 0.0, 11.0, 4.0, 0.0, 0.0, 21.0, 2.0, 10.0, 11.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6317487462287648, "mean_inference_ms": 4.633057223511191, "mean_action_processing_ms": 0.7752322290979798, "mean_env_wait_ms": 0.5728593511279696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005203723907470703, "StateBufferConnector_ms": 0.004104733467102051, "ViewRequirementAgentConnector_ms": 0.16554737091064453}, "num_episodes": 18, "episode_return_max": 373.0, "episode_return_min": -117.0, "episode_return_mean": 137.45, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.7565119062113, "num_env_steps_trained_throughput_per_sec": 269.7565119062113, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 1264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1264000, "timers": {"training_iteration_time_ms": 14830.932, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14830.88, "sample_time_ms": 1930.205, "learn_time_ms": 12880.294, "learn_throughput": 310.552, "synch_weights_time_ms": 16.317}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "done": false, "training_iteration": 79, "trial_id": "f6b99_00000", "date": "2024-08-13_20-14-47", "timestamp": 1723594487, "time_this_iter_s": 14.885428190231323, "time_total_s": 1788.2901811599731, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b379d280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1788.2901811599731, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 56.8, "ram_util_percent": 83.61904761904762}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7165722865906974, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0106802815009677, "policy_loss": -0.00427870508628311, "vf_loss": 1.0147909910038666, "vf_explained_var": 0.06960107047091085, "kl": 0.006719739044540912, "entropy": 0.5826535066441884, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.99368945987767, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2570568174912187, "policy_loss": -0.005381078333914201, "vf_loss": 2.2622617218544874, "vf_explained_var": 0.7779081176197719, "kl": 0.009395686194202144, "entropy": 0.9370744087077953, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 373.0, "episode_reward_min": -117.0, "episode_reward_mean": 140.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -272.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 155.0}, "policy_reward_mean": {"prey_policy": 55.475, "predator_policy": 14.525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [146.0, -5.0, 115.0, 206.0, 127.0, -11.0, 84.0, 373.0, 177.0, 158.0, 25.0, 140.0, 20.0, 273.0, 290.0, 0.0, 77.0, 340.0, 182.0, 260.0, 124.0, -17.0, -16.0, 189.0, 185.0, 192.0, 152.0, 72.0, 139.0, 189.0, -117.0, 115.0, 344.0, 0.0, 191.0, 121.0, 165.0, 69.0, 114.0, 159.0, 354.0, 162.0, -15.0, 0.0, -13.0, 328.0, 110.0, 0.0, 148.0, 68.0, -4.0, 266.0, -16.0, 185.0, 109.0, -17.0, 325.0, 161.0, 91.0, 117.0, 119.0, 132.0, 105.0, 188.0, -6.0, 372.0, 121.0, 272.0, 0.0, 138.0, 142.0, 120.0, 54.0, 225.0, 113.0, -19.0, 353.0, 178.0, 250.0, 0.0, 178.0, 256.0, 241.0, 15.0, 0.0, 186.0, 266.0, 89.0, 265.0, 180.0, 159.0, 253.0, 305.0, 1.0, 298.0, 108.0, 0.0, 176.0, 202.0, 259.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 143.0, -11.0, 0.0, 0.0, 50.0, 47.0, 125.0, 101.0, -4.0, -10.0, -16.0, 90.0, -12.0, 152.0, 200.0, -6.0, 180.0, 0.0, 101.0, -43.0, 0.0, 127.0, 0.0, 0.0, 20.0, 110.0, 104.0, 36.0, 171.0, 0.0, 0.0, 19.0, 0.0, 154.0, 174.0, 173.0, 0.0, 158.0, 32.0, 0.0, 52.0, -190.0, 12.0, -18.0, -17.0, 0.0, 188.0, 187.0, -4.0, 0.0, 188.0, 0.0, 146.0, 72.0, 0.0, 132.0, -8.0, 31.0, 106.0, -272.0, 0.0, 0.0, 105.0, 191.0, 141.0, 0.0, 0.0, -19.0, 66.0, 121.0, 0.0, 150.0, 0.0, -14.0, 52.0, -8.0, 107.0, 159.0, 0.0, 179.0, 167.0, 143.0, 0.0, 0.0, -30.0, 0.0, 0.0, -14.0, -12.0, 137.0, 170.0, 90.0, 0.0, 0.0, 0.0, 0.0, 148.0, -14.0, 0.0, 0.0, -8.0, 165.0, 77.0, -10.0, -14.0, -18.0, 194.0, 103.0, -16.0, -128.0, 0.0, 134.0, 179.0, 0.0, 121.0, -113.0, 109.0, -69.0, 92.0, 6.0, 113.0, 0.0, 111.0, 0.0, -42.0, 182.0, 0.0, -12.0, 0.0, 200.0, 170.0, 99.0, 0.0, 122.0, 98.0, 0.0, 0.0, 146.0, -20.0, -32.0, 156.0, -10.0, 106.0, 54.0, 0.0, 132.0, 82.0, 109.0, 0.0, -40.0, 0.0, 156.0, 185.0, 167.0, 0.0, 74.0, 107.0, 0.0, 0.0, 0.0, 167.0, 172.0, 33.0, 90.0, 100.0, -10.0, 20.0, 0.0, 0.0, 186.0, 0.0, 141.0, 52.0, 83.0, -4.0, 179.0, 81.0, 0.0, 170.0, 140.0, 0.0, 144.0, 32.0, 155.0, 116.0, 1.0, 0.0, 24.0, 185.0, 97.0, -10.0, 0.0, 0.0, 0.0, 149.0, 78.0, 80.0, 91.0, 151.0], "policy_predator_policy_reward": [3.0, 0.0, 0.0, 6.0, 15.0, 50.0, 19.0, 15.0, 27.0, 3.0, 7.0, 8.0, 6.0, 0.0, 15.0, 6.0, 0.0, 3.0, 29.0, 28.0, 62.0, 6.0, 0.0, 13.0, 0.0, 0.0, 53.0, 6.0, 33.0, 50.0, 0.0, 0.0, 1.0, 57.0, 12.0, 0.0, 0.0, 9.0, 56.0, 14.0, 30.0, 42.0, 146.0, 15.0, 0.0, 19.0, 0.0, 1.0, 2.0, 0.0, 3.0, 1.0, 0.0, 6.0, 0.0, 0.0, 11.0, 4.0, 35.0, 17.0, 155.0, 0.0, 10.0, 0.0, 0.0, 12.0, 0.0, 0.0, 70.0, 74.0, 0.0, 0.0, 10.0, 5.0, 13.0, 18.0, 13.0, 2.0, 0.0, 0.0, 8.0, 0.0, 1.0, 18.0, 15.0, 0.0, 0.0, 0.0, 0.0, 13.0, 11.0, 10.0, 3.0, 17.0, 0.0, 0.0, 0.0, 0.0, 47.0, 35.0, 0.0, 4.0, 0.0, 24.0, 0.0, 8.0, 0.0, 9.0, 20.0, 2.0, 7.0, 104.0, 0.0, 12.0, 25.0, 15.0, 1.0, 94.0, 62.0, 32.0, 0.0, 0.0, 21.0, 0.0, 69.0, 78.0, 0.0, 6.0, 6.0, 0.0, 2.0, 0.0, 22.0, 0.0, 13.0, 39.0, 0.0, 0.0, 12.0, 0.0, 18.0, 0.0, 2.0, 22.0, 0.0, 0.0, 0.0, 11.0, 4.0, 0.0, 0.0, 21.0, 2.0, 10.0, 11.0, 0.0, 32.0, 37.0, 0.0, 0.0, 11.0, 0.0, 2.0, 49.0, 35.0, 16.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 24.0, 49.0, 2.0, 8.0, 0.0, 5.0, 0.0, 10.0, 0.0, 19.0, 35.0, 42.0, 21.0, 13.0, 0.0, 0.0, 34.0, 55.0, 0.0, 21.0, 0.0, 0.0, 10.0, 17.0, 16.0, 28.0, 13.0, 4.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.625188220275873, "mean_inference_ms": 4.618096044830215, "mean_action_processing_ms": 0.7741842768228103, "mean_env_wait_ms": 0.571345984691351, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004601836204528809, "StateBufferConnector_ms": 0.00399935245513916, "ViewRequirementAgentConnector_ms": 0.15913641452789307}, "num_episodes": 22, "episode_return_max": 373.0, "episode_return_min": -117.0, "episode_return_mean": 140.0, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.69095154541975, "num_env_steps_trained_throughput_per_sec": 266.69095154541975, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 14848.321, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14848.269, "sample_time_ms": 1922.11, "learn_time_ms": 12905.244, "learn_throughput": 309.952, "synch_weights_time_ms": 16.466}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 80, "trial_id": "f6b99_00000", "date": "2024-08-13_20-15-02", "timestamp": 1723594502, "time_this_iter_s": 15.082727909088135, "time_total_s": 1803.3729090690613, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3788b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1803.3729090690613, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 58.618181818181824, "ram_util_percent": 83.51818181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9505045995983497, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.364221489555621, "policy_loss": -0.006138498029577984, "vf_loss": 2.3701020440727314, "vf_explained_var": 0.024941794960587113, "kl": 0.01031771866375166, "entropy": 0.4772922453899232, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0710044862732055, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5987752359380165, "policy_loss": -0.00924610331045986, "vf_loss": 3.607493168084079, "vf_explained_var": 0.4034606963869125, "kl": 0.028169123519086906, "entropy": 0.8917830798676405, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 372.0, "episode_reward_min": -191.0, "episode_reward_mean": 135.92, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -272.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 155.0}, "policy_reward_mean": {"prey_policy": 52.12, "predator_policy": 15.84}, "custom_metrics": {}, "hist_stats": {"episode_reward": [182.0, 260.0, 124.0, -17.0, -16.0, 189.0, 185.0, 192.0, 152.0, 72.0, 139.0, 189.0, -117.0, 115.0, 344.0, 0.0, 191.0, 121.0, 165.0, 69.0, 114.0, 159.0, 354.0, 162.0, -15.0, 0.0, -13.0, 328.0, 110.0, 0.0, 148.0, 68.0, -4.0, 266.0, -16.0, 185.0, 109.0, -17.0, 325.0, 161.0, 91.0, 117.0, 119.0, 132.0, 105.0, 188.0, -6.0, 372.0, 121.0, 272.0, 0.0, 138.0, 142.0, 120.0, 54.0, 225.0, 113.0, -19.0, 353.0, 178.0, 250.0, 0.0, 178.0, 256.0, 241.0, 15.0, 0.0, 186.0, 266.0, 89.0, 265.0, 180.0, 159.0, 253.0, 305.0, 1.0, 298.0, 108.0, 0.0, 176.0, 202.0, 259.0, 322.0, 268.0, 193.0, -8.0, 63.0, 220.0, 246.0, -19.0, 172.0, -5.0, 142.0, 130.0, 0.0, 69.0, 162.0, 363.0, 0.0, -191.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [173.0, 0.0, 158.0, 32.0, 0.0, 52.0, -190.0, 12.0, -18.0, -17.0, 0.0, 188.0, 187.0, -4.0, 0.0, 188.0, 0.0, 146.0, 72.0, 0.0, 132.0, -8.0, 31.0, 106.0, -272.0, 0.0, 0.0, 105.0, 191.0, 141.0, 0.0, 0.0, -19.0, 66.0, 121.0, 0.0, 150.0, 0.0, -14.0, 52.0, -8.0, 107.0, 159.0, 0.0, 179.0, 167.0, 143.0, 0.0, 0.0, -30.0, 0.0, 0.0, -14.0, -12.0, 137.0, 170.0, 90.0, 0.0, 0.0, 0.0, 0.0, 148.0, -14.0, 0.0, 0.0, -8.0, 165.0, 77.0, -10.0, -14.0, -18.0, 194.0, 103.0, -16.0, -128.0, 0.0, 134.0, 179.0, 0.0, 121.0, -113.0, 109.0, -69.0, 92.0, 6.0, 113.0, 0.0, 111.0, 0.0, -42.0, 182.0, 0.0, -12.0, 0.0, 200.0, 170.0, 99.0, 0.0, 122.0, 98.0, 0.0, 0.0, 146.0, -20.0, -32.0, 156.0, -10.0, 106.0, 54.0, 0.0, 132.0, 82.0, 109.0, 0.0, -40.0, 0.0, 156.0, 185.0, 167.0, 0.0, 74.0, 107.0, 0.0, 0.0, 0.0, 167.0, 172.0, 33.0, 90.0, 100.0, -10.0, 20.0, 0.0, 0.0, 186.0, 0.0, 141.0, 52.0, 83.0, -4.0, 179.0, 81.0, 0.0, 170.0, 140.0, 0.0, 144.0, 32.0, 155.0, 116.0, 1.0, 0.0, 24.0, 185.0, 97.0, -10.0, 0.0, 0.0, 0.0, 149.0, 78.0, 80.0, 91.0, 151.0, 191.0, 99.0, 121.0, 101.0, 0.0, 193.0, -140.0, 16.0, 0.0, 63.0, 11.0, 127.0, 161.0, 24.0, -16.0, -14.0, 23.0, 128.0, 0.0, -100.0, 0.0, 115.0, 122.0, 0.0, 0.0, 0.0, 49.0, -83.0, 6.0, 133.0, 185.0, 173.0, 0.0, 0.0, -134.0, -223.0], "policy_predator_policy_reward": [0.0, 9.0, 56.0, 14.0, 30.0, 42.0, 146.0, 15.0, 0.0, 19.0, 0.0, 1.0, 2.0, 0.0, 3.0, 1.0, 0.0, 6.0, 0.0, 0.0, 11.0, 4.0, 35.0, 17.0, 155.0, 0.0, 10.0, 0.0, 0.0, 12.0, 0.0, 0.0, 70.0, 74.0, 0.0, 0.0, 10.0, 5.0, 13.0, 18.0, 13.0, 2.0, 0.0, 0.0, 8.0, 0.0, 1.0, 18.0, 15.0, 0.0, 0.0, 0.0, 0.0, 13.0, 11.0, 10.0, 3.0, 17.0, 0.0, 0.0, 0.0, 0.0, 47.0, 35.0, 0.0, 4.0, 0.0, 24.0, 0.0, 8.0, 0.0, 9.0, 20.0, 2.0, 7.0, 104.0, 0.0, 12.0, 25.0, 15.0, 1.0, 94.0, 62.0, 32.0, 0.0, 0.0, 21.0, 0.0, 69.0, 78.0, 0.0, 6.0, 6.0, 0.0, 2.0, 0.0, 22.0, 0.0, 13.0, 39.0, 0.0, 0.0, 12.0, 0.0, 18.0, 0.0, 2.0, 22.0, 0.0, 0.0, 0.0, 11.0, 4.0, 0.0, 0.0, 21.0, 2.0, 10.0, 11.0, 0.0, 32.0, 37.0, 0.0, 0.0, 11.0, 0.0, 2.0, 49.0, 35.0, 16.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 24.0, 49.0, 2.0, 8.0, 0.0, 5.0, 0.0, 10.0, 0.0, 19.0, 35.0, 42.0, 21.0, 13.0, 0.0, 0.0, 34.0, 55.0, 0.0, 21.0, 0.0, 0.0, 10.0, 17.0, 16.0, 28.0, 13.0, 4.0, 8.0, 24.0, 46.0, 0.0, 0.0, 0.0, 107.0, 9.0, 0.0, 0.0, 30.0, 52.0, 0.0, 61.0, 11.0, 0.0, 14.0, 7.0, 47.0, 48.0, 0.0, 27.0, 8.0, 0.0, 0.0, 0.0, 17.0, 86.0, 6.0, 17.0, 0.0, 5.0, 0.0, 0.0, 144.0, 22.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6095805088165835, "mean_inference_ms": 4.57483803534836, "mean_action_processing_ms": 0.7633064212326324, "mean_env_wait_ms": 0.5648670274015264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047512054443359375, "StateBufferConnector_ms": 0.003907680511474609, "ViewRequirementAgentConnector_ms": 0.1320093870162964}, "num_episodes": 18, "episode_return_max": 372.0, "episode_return_min": -191.0, "episode_return_mean": 135.92, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.19039634782007, "num_env_steps_trained_throughput_per_sec": 281.19039634782007, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 14809.186, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14809.129, "sample_time_ms": 1930.754, "learn_time_ms": 12856.73, "learn_throughput": 311.121, "synch_weights_time_ms": 16.415}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 81, "trial_id": "f6b99_00000", "date": "2024-08-13_20-15-16", "timestamp": 1723594516, "time_this_iter_s": 14.28140902519226, "time_total_s": 1817.6543180942535, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6087c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1817.6543180942535, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 57.985, "ram_util_percent": 83.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6392904215704196, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.356525137815526, "policy_loss": -0.003063597340412714, "vf_loss": 2.3594614339883995, "vf_explained_var": 0.021995365493512026, "kl": 0.005091806951480318, "entropy": 0.4581099521546137, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.044369686438293, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.807810612708803, "policy_loss": -0.006658752834444087, "vf_loss": 3.814280827083285, "vf_explained_var": 0.4896455222967441, "kl": 0.006703663059292007, "entropy": 0.9083767945804293, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "env_runners": {"episode_reward_max": 372.0, "episode_reward_min": -191.0, "episode_reward_mean": 123.63, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -335.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 176.0}, "policy_reward_mean": {"prey_policy": 44.455, "predator_policy": 17.36}, "custom_metrics": {}, "hist_stats": {"episode_reward": [162.0, -15.0, 0.0, -13.0, 328.0, 110.0, 0.0, 148.0, 68.0, -4.0, 266.0, -16.0, 185.0, 109.0, -17.0, 325.0, 161.0, 91.0, 117.0, 119.0, 132.0, 105.0, 188.0, -6.0, 372.0, 121.0, 272.0, 0.0, 138.0, 142.0, 120.0, 54.0, 225.0, 113.0, -19.0, 353.0, 178.0, 250.0, 0.0, 178.0, 256.0, 241.0, 15.0, 0.0, 186.0, 266.0, 89.0, 265.0, 180.0, 159.0, 253.0, 305.0, 1.0, 298.0, 108.0, 0.0, 176.0, 202.0, 259.0, 322.0, 268.0, 193.0, -8.0, 63.0, 220.0, 246.0, -19.0, 172.0, -5.0, 142.0, 130.0, 0.0, 69.0, 162.0, 363.0, 0.0, -191.0, 129.0, 237.0, 116.0, -6.0, 118.0, -29.0, 133.0, -4.0, 141.0, -15.0, 132.0, 0.0, 15.0, 180.0, 0.0, 222.0, 164.0, 57.0, 175.0, 144.0, -30.0, -12.0, 70.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [143.0, 0.0, 0.0, -30.0, 0.0, 0.0, -14.0, -12.0, 137.0, 170.0, 90.0, 0.0, 0.0, 0.0, 0.0, 148.0, -14.0, 0.0, 0.0, -8.0, 165.0, 77.0, -10.0, -14.0, -18.0, 194.0, 103.0, -16.0, -128.0, 0.0, 134.0, 179.0, 0.0, 121.0, -113.0, 109.0, -69.0, 92.0, 6.0, 113.0, 0.0, 111.0, 0.0, -42.0, 182.0, 0.0, -12.0, 0.0, 200.0, 170.0, 99.0, 0.0, 122.0, 98.0, 0.0, 0.0, 146.0, -20.0, -32.0, 156.0, -10.0, 106.0, 54.0, 0.0, 132.0, 82.0, 109.0, 0.0, -40.0, 0.0, 156.0, 185.0, 167.0, 0.0, 74.0, 107.0, 0.0, 0.0, 0.0, 167.0, 172.0, 33.0, 90.0, 100.0, -10.0, 20.0, 0.0, 0.0, 186.0, 0.0, 141.0, 52.0, 83.0, -4.0, 179.0, 81.0, 0.0, 170.0, 140.0, 0.0, 144.0, 32.0, 155.0, 116.0, 1.0, 0.0, 24.0, 185.0, 97.0, -10.0, 0.0, 0.0, 0.0, 149.0, 78.0, 80.0, 91.0, 151.0, 191.0, 99.0, 121.0, 101.0, 0.0, 193.0, -140.0, 16.0, 0.0, 63.0, 11.0, 127.0, 161.0, 24.0, -16.0, -14.0, 23.0, 128.0, 0.0, -100.0, 0.0, 115.0, 122.0, 0.0, 0.0, 0.0, 49.0, -83.0, 6.0, 133.0, 185.0, 173.0, 0.0, 0.0, -134.0, -223.0, -12.0, 135.0, 125.0, 84.0, 0.0, 87.0, -12.0, 0.0, 44.0, 0.0, -335.0, 92.0, 0.0, 80.0, -8.0, 0.0, 0.0, 117.0, -8.0, -14.0, 41.0, 32.0, 0.0, 0.0, -69.0, 0.0, -8.0, 89.0, 0.0, 0.0, 74.0, 100.0, 51.0, 35.0, 0.0, -18.0, 168.0, 0.0, 0.0, 116.0, 0.0, -143.0, -12.0, -6.0, 7.0, 0.0], "policy_predator_policy_reward": [1.0, 18.0, 15.0, 0.0, 0.0, 0.0, 0.0, 13.0, 11.0, 10.0, 3.0, 17.0, 0.0, 0.0, 0.0, 0.0, 47.0, 35.0, 0.0, 4.0, 0.0, 24.0, 0.0, 8.0, 0.0, 9.0, 20.0, 2.0, 7.0, 104.0, 0.0, 12.0, 25.0, 15.0, 1.0, 94.0, 62.0, 32.0, 0.0, 0.0, 21.0, 0.0, 69.0, 78.0, 0.0, 6.0, 6.0, 0.0, 2.0, 0.0, 22.0, 0.0, 13.0, 39.0, 0.0, 0.0, 12.0, 0.0, 18.0, 0.0, 2.0, 22.0, 0.0, 0.0, 0.0, 11.0, 4.0, 0.0, 0.0, 21.0, 2.0, 10.0, 11.0, 0.0, 32.0, 37.0, 0.0, 0.0, 11.0, 0.0, 2.0, 49.0, 35.0, 16.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 24.0, 49.0, 2.0, 8.0, 0.0, 5.0, 0.0, 10.0, 0.0, 19.0, 35.0, 42.0, 21.0, 13.0, 0.0, 0.0, 34.0, 55.0, 0.0, 21.0, 0.0, 0.0, 10.0, 17.0, 16.0, 28.0, 13.0, 4.0, 8.0, 24.0, 46.0, 0.0, 0.0, 0.0, 107.0, 9.0, 0.0, 0.0, 30.0, 52.0, 0.0, 61.0, 11.0, 0.0, 14.0, 7.0, 47.0, 48.0, 0.0, 27.0, 8.0, 0.0, 0.0, 0.0, 17.0, 86.0, 6.0, 17.0, 0.0, 5.0, 0.0, 0.0, 144.0, 22.0, 0.0, 6.0, 28.0, 0.0, 0.0, 29.0, 6.0, 0.0, 35.0, 39.0, 176.0, 38.0, 14.0, 39.0, 0.0, 4.0, 0.0, 24.0, 0.0, 7.0, 0.0, 59.0, 0.0, 0.0, 83.0, 1.0, 53.0, 46.0, 0.0, 0.0, 19.0, 29.0, 35.0, 43.0, 51.0, 24.0, 0.0, 7.0, 13.0, 15.0, 4.0, 109.0, 0.0, 6.0, 54.0, 9.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.595890170191127, "mean_inference_ms": 4.550330534419034, "mean_action_processing_ms": 0.7650863186351912, "mean_env_wait_ms": 0.5646691563428061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004790306091308594, "StateBufferConnector_ms": 0.0037993192672729492, "ViewRequirementAgentConnector_ms": 0.13036346435546875}, "num_episodes": 23, "episode_return_max": 372.0, "episode_return_min": -191.0, "episode_return_mean": 123.63, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 286.15506590623886, "num_env_steps_trained_throughput_per_sec": 286.15506590623886, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 1312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1312000, "timers": {"training_iteration_time_ms": 14768.139, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14768.082, "sample_time_ms": 1926.237, "learn_time_ms": 12819.612, "learn_throughput": 312.022, "synch_weights_time_ms": 16.505}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "done": false, "training_iteration": 82, "trial_id": "f6b99_00000", "date": "2024-08-13_20-15-30", "timestamp": 1723594530, "time_this_iter_s": 14.013165712356567, "time_total_s": 1831.66748380661, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b324b0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1831.66748380661, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 55.28000000000001, "ram_util_percent": 83.66}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.367935588277837, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2420177364160143, "policy_loss": -0.004613772490820675, "vf_loss": 1.2463002029077086, "vf_explained_var": 0.03062573851100982, "kl": 0.01325231312266488, "entropy": 0.5168879010847637, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4797832653005285, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2314015746747375, "policy_loss": -0.0013179278666419641, "vf_loss": 3.232589743566261, "vf_explained_var": 0.7095131879130369, "kl": 0.00461380594887632, "entropy": 0.8194068397163714, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "env_runners": {"episode_reward_max": 372.0, "episode_reward_min": -191.0, "episode_reward_mean": 126.73, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -335.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 176.0}, "policy_reward_mean": {"prey_policy": 44.31, "predator_policy": 19.055}, "custom_metrics": {}, "hist_stats": {"episode_reward": [117.0, 119.0, 132.0, 105.0, 188.0, -6.0, 372.0, 121.0, 272.0, 0.0, 138.0, 142.0, 120.0, 54.0, 225.0, 113.0, -19.0, 353.0, 178.0, 250.0, 0.0, 178.0, 256.0, 241.0, 15.0, 0.0, 186.0, 266.0, 89.0, 265.0, 180.0, 159.0, 253.0, 305.0, 1.0, 298.0, 108.0, 0.0, 176.0, 202.0, 259.0, 322.0, 268.0, 193.0, -8.0, 63.0, 220.0, 246.0, -19.0, 172.0, -5.0, 142.0, 130.0, 0.0, 69.0, 162.0, 363.0, 0.0, -191.0, 129.0, 237.0, 116.0, -6.0, 118.0, -29.0, 133.0, -4.0, 141.0, -15.0, 132.0, 0.0, 15.0, 180.0, 0.0, 222.0, 164.0, 57.0, 175.0, 144.0, -30.0, -12.0, 70.0, 19.0, 0.0, 88.0, 90.0, 165.0, 320.0, 261.0, 87.0, 117.0, 136.0, 148.0, 0.0, 39.0, 148.0, -11.0, 141.0, 353.0, 97.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-69.0, 92.0, 6.0, 113.0, 0.0, 111.0, 0.0, -42.0, 182.0, 0.0, -12.0, 0.0, 200.0, 170.0, 99.0, 0.0, 122.0, 98.0, 0.0, 0.0, 146.0, -20.0, -32.0, 156.0, -10.0, 106.0, 54.0, 0.0, 132.0, 82.0, 109.0, 0.0, -40.0, 0.0, 156.0, 185.0, 167.0, 0.0, 74.0, 107.0, 0.0, 0.0, 0.0, 167.0, 172.0, 33.0, 90.0, 100.0, -10.0, 20.0, 0.0, 0.0, 186.0, 0.0, 141.0, 52.0, 83.0, -4.0, 179.0, 81.0, 0.0, 170.0, 140.0, 0.0, 144.0, 32.0, 155.0, 116.0, 1.0, 0.0, 24.0, 185.0, 97.0, -10.0, 0.0, 0.0, 0.0, 149.0, 78.0, 80.0, 91.0, 151.0, 191.0, 99.0, 121.0, 101.0, 0.0, 193.0, -140.0, 16.0, 0.0, 63.0, 11.0, 127.0, 161.0, 24.0, -16.0, -14.0, 23.0, 128.0, 0.0, -100.0, 0.0, 115.0, 122.0, 0.0, 0.0, 0.0, 49.0, -83.0, 6.0, 133.0, 185.0, 173.0, 0.0, 0.0, -134.0, -223.0, -12.0, 135.0, 125.0, 84.0, 0.0, 87.0, -12.0, 0.0, 44.0, 0.0, -335.0, 92.0, 0.0, 80.0, -8.0, 0.0, 0.0, 117.0, -8.0, -14.0, 41.0, 32.0, 0.0, 0.0, -69.0, 0.0, -8.0, 89.0, 0.0, 0.0, 74.0, 100.0, 51.0, 35.0, 0.0, -18.0, 168.0, 0.0, 0.0, 116.0, 0.0, -143.0, -12.0, -6.0, 7.0, 0.0, 3.0, -96.0, 0.0, 0.0, 33.0, -28.0, 58.0, 11.0, -46.0, 98.0, 129.0, 170.0, 104.0, 125.0, 87.0, 0.0, -37.0, 39.0, -14.0, 129.0, 0.0, 122.0, 0.0, 0.0, -26.0, 0.0, 134.0, 2.0, -12.0, -8.0, -10.0, 85.0, 134.0, 197.0, -19.0, 0.0], "policy_predator_policy_reward": [62.0, 32.0, 0.0, 0.0, 21.0, 0.0, 69.0, 78.0, 0.0, 6.0, 6.0, 0.0, 2.0, 0.0, 22.0, 0.0, 13.0, 39.0, 0.0, 0.0, 12.0, 0.0, 18.0, 0.0, 2.0, 22.0, 0.0, 0.0, 0.0, 11.0, 4.0, 0.0, 0.0, 21.0, 2.0, 10.0, 11.0, 0.0, 32.0, 37.0, 0.0, 0.0, 11.0, 0.0, 2.0, 49.0, 35.0, 16.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 24.0, 49.0, 2.0, 8.0, 0.0, 5.0, 0.0, 10.0, 0.0, 19.0, 35.0, 42.0, 21.0, 13.0, 0.0, 0.0, 34.0, 55.0, 0.0, 21.0, 0.0, 0.0, 10.0, 17.0, 16.0, 28.0, 13.0, 4.0, 8.0, 24.0, 46.0, 0.0, 0.0, 0.0, 107.0, 9.0, 0.0, 0.0, 30.0, 52.0, 0.0, 61.0, 11.0, 0.0, 14.0, 7.0, 47.0, 48.0, 0.0, 27.0, 8.0, 0.0, 0.0, 0.0, 17.0, 86.0, 6.0, 17.0, 0.0, 5.0, 0.0, 0.0, 144.0, 22.0, 0.0, 6.0, 28.0, 0.0, 0.0, 29.0, 6.0, 0.0, 35.0, 39.0, 176.0, 38.0, 14.0, 39.0, 0.0, 4.0, 0.0, 24.0, 0.0, 7.0, 0.0, 59.0, 0.0, 0.0, 83.0, 1.0, 53.0, 46.0, 0.0, 0.0, 19.0, 29.0, 35.0, 43.0, 51.0, 24.0, 0.0, 7.0, 13.0, 15.0, 4.0, 109.0, 0.0, 6.0, 54.0, 9.0, 91.0, 21.0, 0.0, 0.0, 0.0, 83.0, 10.0, 11.0, 65.0, 48.0, 0.0, 21.0, 0.0, 32.0, 0.0, 0.0, 89.0, 26.0, 14.0, 7.0, 26.0, 0.0, 0.0, 0.0, 65.0, 0.0, 12.0, 0.0, 0.0, 9.0, 66.0, 0.0, 2.0, 20.0, 73.0, 43.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.586898151135771, "mean_inference_ms": 4.5164627464799345, "mean_action_processing_ms": 0.7514703481286741, "mean_env_wait_ms": 0.5567733822364104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004621148109436035, "StateBufferConnector_ms": 0.0036301612854003906, "ViewRequirementAgentConnector_ms": 0.12777209281921387}, "num_episodes": 18, "episode_return_max": 372.0, "episode_return_min": -191.0, "episode_return_mean": 126.73, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 234.2681606872619, "num_env_steps_trained_throughput_per_sec": 234.2681606872619, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 1328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1328000, "timers": {"training_iteration_time_ms": 15018.886, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15018.83, "sample_time_ms": 1913.171, "learn_time_ms": 13079.088, "learn_throughput": 305.832, "synch_weights_time_ms": 20.832}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "done": false, "training_iteration": 83, "trial_id": "f6b99_00000", "date": "2024-08-13_20-15-47", "timestamp": 1723594547, "time_this_iter_s": 17.13833999633789, "time_total_s": 1848.805823802948, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b379d160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1848.805823802948, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 64.79166666666667, "ram_util_percent": 83.72500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.553354472079605, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8866773142385735, "policy_loss": -0.006417849313999926, "vf_loss": 1.892795050459564, "vf_explained_var": 0.024064233000316317, "kl": 0.012004512051772952, "entropy": 0.550048525418554, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6708773109017225, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9529909804384546, "policy_loss": -0.005960719206582301, "vf_loss": 2.9588184112594242, "vf_explained_var": 0.36563333402235043, "kl": 0.00947883793515465, "entropy": 0.8795133131206351, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 363.0, "episode_reward_min": -191.0, "episode_reward_mean": 121.14, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -335.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 176.0}, "policy_reward_mean": {"prey_policy": 39.055, "predator_policy": 21.515}, "custom_metrics": {}, "hist_stats": {"episode_reward": [178.0, 250.0, 0.0, 178.0, 256.0, 241.0, 15.0, 0.0, 186.0, 266.0, 89.0, 265.0, 180.0, 159.0, 253.0, 305.0, 1.0, 298.0, 108.0, 0.0, 176.0, 202.0, 259.0, 322.0, 268.0, 193.0, -8.0, 63.0, 220.0, 246.0, -19.0, 172.0, -5.0, 142.0, 130.0, 0.0, 69.0, 162.0, 363.0, 0.0, -191.0, 129.0, 237.0, 116.0, -6.0, 118.0, -29.0, 133.0, -4.0, 141.0, -15.0, 132.0, 0.0, 15.0, 180.0, 0.0, 222.0, 164.0, 57.0, 175.0, 144.0, -30.0, -12.0, 70.0, 19.0, 0.0, 88.0, 90.0, 165.0, 320.0, 261.0, 87.0, 117.0, 136.0, 148.0, 0.0, 39.0, 148.0, -11.0, 141.0, 353.0, 97.0, 253.0, 11.0, 139.0, -30.0, 199.0, 23.0, 0.0, 324.0, 179.0, -15.0, 78.0, -10.0, 288.0, 146.0, 152.0, 137.0, 144.0, -31.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [167.0, 0.0, 74.0, 107.0, 0.0, 0.0, 0.0, 167.0, 172.0, 33.0, 90.0, 100.0, -10.0, 20.0, 0.0, 0.0, 186.0, 0.0, 141.0, 52.0, 83.0, -4.0, 179.0, 81.0, 0.0, 170.0, 140.0, 0.0, 144.0, 32.0, 155.0, 116.0, 1.0, 0.0, 24.0, 185.0, 97.0, -10.0, 0.0, 0.0, 0.0, 149.0, 78.0, 80.0, 91.0, 151.0, 191.0, 99.0, 121.0, 101.0, 0.0, 193.0, -140.0, 16.0, 0.0, 63.0, 11.0, 127.0, 161.0, 24.0, -16.0, -14.0, 23.0, 128.0, 0.0, -100.0, 0.0, 115.0, 122.0, 0.0, 0.0, 0.0, 49.0, -83.0, 6.0, 133.0, 185.0, 173.0, 0.0, 0.0, -134.0, -223.0, -12.0, 135.0, 125.0, 84.0, 0.0, 87.0, -12.0, 0.0, 44.0, 0.0, -335.0, 92.0, 0.0, 80.0, -8.0, 0.0, 0.0, 117.0, -8.0, -14.0, 41.0, 32.0, 0.0, 0.0, -69.0, 0.0, -8.0, 89.0, 0.0, 0.0, 74.0, 100.0, 51.0, 35.0, 0.0, -18.0, 168.0, 0.0, 0.0, 116.0, 0.0, -143.0, -12.0, -6.0, 7.0, 0.0, 3.0, -96.0, 0.0, 0.0, 33.0, -28.0, 58.0, 11.0, -46.0, 98.0, 129.0, 170.0, 104.0, 125.0, 87.0, 0.0, -37.0, 39.0, -14.0, 129.0, 0.0, 122.0, 0.0, 0.0, -26.0, 0.0, 134.0, 2.0, -12.0, -8.0, -10.0, 85.0, 134.0, 197.0, -19.0, 0.0, 34.0, 147.0, 0.0, -77.0, 0.0, 115.0, 0.0, -294.0, 0.0, 199.0, -2.0, -58.0, 0.0, 0.0, 170.0, 149.0, 177.0, 0.0, -14.0, -8.0, 15.0, -72.0, -6.0, -8.0, 92.0, 154.0, 122.0, -7.0, 152.0, 0.0, -14.0, 131.0, 101.0, -12.0, -143.0, 0.0], "policy_predator_policy_reward": [11.0, 0.0, 32.0, 37.0, 0.0, 0.0, 11.0, 0.0, 2.0, 49.0, 35.0, 16.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 24.0, 49.0, 2.0, 8.0, 0.0, 5.0, 0.0, 10.0, 0.0, 19.0, 35.0, 42.0, 21.0, 13.0, 0.0, 0.0, 34.0, 55.0, 0.0, 21.0, 0.0, 0.0, 10.0, 17.0, 16.0, 28.0, 13.0, 4.0, 8.0, 24.0, 46.0, 0.0, 0.0, 0.0, 107.0, 9.0, 0.0, 0.0, 30.0, 52.0, 0.0, 61.0, 11.0, 0.0, 14.0, 7.0, 47.0, 48.0, 0.0, 27.0, 8.0, 0.0, 0.0, 0.0, 17.0, 86.0, 6.0, 17.0, 0.0, 5.0, 0.0, 0.0, 144.0, 22.0, 0.0, 6.0, 28.0, 0.0, 0.0, 29.0, 6.0, 0.0, 35.0, 39.0, 176.0, 38.0, 14.0, 39.0, 0.0, 4.0, 0.0, 24.0, 0.0, 7.0, 0.0, 59.0, 0.0, 0.0, 83.0, 1.0, 53.0, 46.0, 0.0, 0.0, 19.0, 29.0, 35.0, 43.0, 51.0, 24.0, 0.0, 7.0, 13.0, 15.0, 4.0, 109.0, 0.0, 6.0, 54.0, 9.0, 91.0, 21.0, 0.0, 0.0, 0.0, 83.0, 10.0, 11.0, 65.0, 48.0, 0.0, 21.0, 0.0, 32.0, 0.0, 0.0, 89.0, 26.0, 14.0, 7.0, 26.0, 0.0, 0.0, 0.0, 65.0, 0.0, 12.0, 0.0, 0.0, 9.0, 66.0, 0.0, 2.0, 20.0, 73.0, 43.0, 52.0, 20.0, 88.0, 0.0, 0.0, 24.0, 154.0, 110.0, 0.0, 0.0, 2.0, 81.0, 0.0, 0.0, 1.0, 4.0, 0.0, 2.0, 0.0, 7.0, 75.0, 60.0, 4.0, 0.0, 42.0, 0.0, 26.0, 5.0, 0.0, 0.0, 20.0, 0.0, 23.0, 32.0, 13.0, 99.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.57729729289305, "mean_inference_ms": 4.491799010799642, "mean_action_processing_ms": 0.7465339085900876, "mean_env_wait_ms": 0.55332658982376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004825115203857422, "StateBufferConnector_ms": 0.003755807876586914, "ViewRequirementAgentConnector_ms": 0.1308581829071045}, "num_episodes": 18, "episode_return_max": 363.0, "episode_return_min": -191.0, "episode_return_mean": 121.14, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 264.2243164852826, "num_env_steps_trained_throughput_per_sec": 264.2243164852826, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 14985.887, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14985.831, "sample_time_ms": 1943.345, "learn_time_ms": 13015.273, "learn_throughput": 307.331, "synch_weights_time_ms": 20.901}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 84, "trial_id": "f6b99_00000", "date": "2024-08-13_20-16-03", "timestamp": 1723594563, "time_this_iter_s": 15.174057960510254, "time_total_s": 1863.9798817634583, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b607bf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1863.9798817634583, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 58.67272727272728, "ram_util_percent": 83.23636363636362}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9546396365083714, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.179043387546741, "policy_loss": -0.0032537986270630014, "vf_loss": 2.1821134391285124, "vf_explained_var": 0.012288155726024083, "kl": 0.007349792621168668, "entropy": 0.37435642543135494, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8116974654336455, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8194705472421395, "policy_loss": -0.012408523793731417, "vf_loss": 3.8315643296670663, "vf_explained_var": 0.506887223575481, "kl": 0.022381511073030963, "entropy": 0.765248683047673, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 375.0, "episode_reward_min": -256.0, "episode_reward_mean": 104.82, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -335.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 176.0}, "policy_reward_mean": {"prey_policy": 27.6, "predator_policy": 24.81}, "custom_metrics": {}, "hist_stats": {"episode_reward": [259.0, 322.0, 268.0, 193.0, -8.0, 63.0, 220.0, 246.0, -19.0, 172.0, -5.0, 142.0, 130.0, 0.0, 69.0, 162.0, 363.0, 0.0, -191.0, 129.0, 237.0, 116.0, -6.0, 118.0, -29.0, 133.0, -4.0, 141.0, -15.0, 132.0, 0.0, 15.0, 180.0, 0.0, 222.0, 164.0, 57.0, 175.0, 144.0, -30.0, -12.0, 70.0, 19.0, 0.0, 88.0, 90.0, 165.0, 320.0, 261.0, 87.0, 117.0, 136.0, 148.0, 0.0, 39.0, 148.0, -11.0, 141.0, 353.0, 97.0, 253.0, 11.0, 139.0, -30.0, 199.0, 23.0, 0.0, 324.0, 179.0, -15.0, 78.0, -10.0, 288.0, 146.0, 152.0, 137.0, 144.0, -31.0, 72.0, 182.0, -7.0, 7.0, 280.0, -16.0, 119.0, 115.0, 174.0, 4.0, 194.0, -256.0, -131.0, 152.0, -23.0, 59.0, 92.0, 38.0, 186.0, 172.0, 375.0, 186.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [91.0, 151.0, 191.0, 99.0, 121.0, 101.0, 0.0, 193.0, -140.0, 16.0, 0.0, 63.0, 11.0, 127.0, 161.0, 24.0, -16.0, -14.0, 23.0, 128.0, 0.0, -100.0, 0.0, 115.0, 122.0, 0.0, 0.0, 0.0, 49.0, -83.0, 6.0, 133.0, 185.0, 173.0, 0.0, 0.0, -134.0, -223.0, -12.0, 135.0, 125.0, 84.0, 0.0, 87.0, -12.0, 0.0, 44.0, 0.0, -335.0, 92.0, 0.0, 80.0, -8.0, 0.0, 0.0, 117.0, -8.0, -14.0, 41.0, 32.0, 0.0, 0.0, -69.0, 0.0, -8.0, 89.0, 0.0, 0.0, 74.0, 100.0, 51.0, 35.0, 0.0, -18.0, 168.0, 0.0, 0.0, 116.0, 0.0, -143.0, -12.0, -6.0, 7.0, 0.0, 3.0, -96.0, 0.0, 0.0, 33.0, -28.0, 58.0, 11.0, -46.0, 98.0, 129.0, 170.0, 104.0, 125.0, 87.0, 0.0, -37.0, 39.0, -14.0, 129.0, 0.0, 122.0, 0.0, 0.0, -26.0, 0.0, 134.0, 2.0, -12.0, -8.0, -10.0, 85.0, 134.0, 197.0, -19.0, 0.0, 34.0, 147.0, 0.0, -77.0, 0.0, 115.0, 0.0, -294.0, 0.0, 199.0, -2.0, -58.0, 0.0, 0.0, 170.0, 149.0, 177.0, 0.0, -14.0, -8.0, 15.0, -72.0, -6.0, -8.0, 92.0, 154.0, 122.0, -7.0, 152.0, 0.0, -14.0, 131.0, 101.0, -12.0, -143.0, 0.0, 0.0, 69.0, 173.0, 0.0, -2.0, -14.0, -83.0, 0.0, 148.0, 107.0, -37.0, 0.0, -47.0, 59.0, 122.0, -26.0, 0.0, 161.0, 0.0, 0.0, 194.0, 0.0, -255.0, -229.0, 0.0, -291.0, -6.0, 138.0, -9.0, -130.0, -7.0, -6.0, 40.0, -49.0, 16.0, -161.0, -14.0, 187.0, -6.0, 174.0, 173.0, 190.0, 88.0, 41.0], "policy_predator_policy_reward": [13.0, 4.0, 8.0, 24.0, 46.0, 0.0, 0.0, 0.0, 107.0, 9.0, 0.0, 0.0, 30.0, 52.0, 0.0, 61.0, 11.0, 0.0, 14.0, 7.0, 47.0, 48.0, 0.0, 27.0, 8.0, 0.0, 0.0, 0.0, 17.0, 86.0, 6.0, 17.0, 0.0, 5.0, 0.0, 0.0, 144.0, 22.0, 0.0, 6.0, 28.0, 0.0, 0.0, 29.0, 6.0, 0.0, 35.0, 39.0, 176.0, 38.0, 14.0, 39.0, 0.0, 4.0, 0.0, 24.0, 0.0, 7.0, 0.0, 59.0, 0.0, 0.0, 83.0, 1.0, 53.0, 46.0, 0.0, 0.0, 19.0, 29.0, 35.0, 43.0, 51.0, 24.0, 0.0, 7.0, 13.0, 15.0, 4.0, 109.0, 0.0, 6.0, 54.0, 9.0, 91.0, 21.0, 0.0, 0.0, 0.0, 83.0, 10.0, 11.0, 65.0, 48.0, 0.0, 21.0, 0.0, 32.0, 0.0, 0.0, 89.0, 26.0, 14.0, 7.0, 26.0, 0.0, 0.0, 0.0, 65.0, 0.0, 12.0, 0.0, 0.0, 9.0, 66.0, 0.0, 2.0, 20.0, 73.0, 43.0, 52.0, 20.0, 88.0, 0.0, 0.0, 24.0, 154.0, 110.0, 0.0, 0.0, 2.0, 81.0, 0.0, 0.0, 1.0, 4.0, 0.0, 2.0, 0.0, 7.0, 75.0, 60.0, 4.0, 0.0, 42.0, 0.0, 26.0, 5.0, 0.0, 0.0, 20.0, 0.0, 23.0, 32.0, 13.0, 99.0, 1.0, 2.0, 9.0, 0.0, 0.0, 9.0, 90.0, 0.0, 15.0, 10.0, 6.0, 15.0, 21.0, 86.0, 10.0, 9.0, 0.0, 13.0, 4.0, 0.0, 0.0, 0.0, 156.0, 72.0, 3.0, 157.0, 4.0, 16.0, 8.0, 108.0, 52.0, 20.0, 55.0, 46.0, 122.0, 61.0, 13.0, 0.0, 3.0, 1.0, 4.0, 8.0, 12.0, 45.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5659647013819116, "mean_inference_ms": 4.462210324117784, "mean_action_processing_ms": 0.7407026635594086, "mean_env_wait_ms": 0.5492967822014464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052852630615234375, "StateBufferConnector_ms": 0.004718661308288574, "ViewRequirementAgentConnector_ms": 0.12134337425231934}, "num_episodes": 22, "episode_return_max": 375.0, "episode_return_min": -256.0, "episode_return_mean": 104.82, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 279.5858776037214, "num_env_steps_trained_throughput_per_sec": 279.5858776037214, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 14806.873, "restore_workers_time_ms": 0.017, "training_step_time_ms": 14806.809, "sample_time_ms": 1753.203, "learn_time_ms": 13025.68, "learn_throughput": 307.086, "synch_weights_time_ms": 21.389}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 85, "trial_id": "f6b99_00000", "date": "2024-08-13_20-16-17", "timestamp": 1723594577, "time_this_iter_s": 14.401013135910034, "time_total_s": 1878.3808948993683, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b623d700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1878.3808948993683, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 55.50500000000001, "ram_util_percent": 82.925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9658447145469604, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8916275305722756, "policy_loss": -0.003974278968704677, "vf_loss": 1.8954805708751477, "vf_explained_var": 0.012165156968686947, "kl": 0.004849456495353148, "entropy": 0.34022783984740573, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0209921187509305, "cur_kl_coeff": 0.02109375, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.680444496018546, "policy_loss": -0.006866400064801965, "vf_loss": 3.6869075307139645, "vf_explained_var": 0.40700720267951807, "kl": 0.01912262270144127, "entropy": 0.6386391163503051, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "env_runners": {"episode_reward_max": 375.0, "episode_reward_min": -256.0, "episode_reward_mean": 100.74, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -335.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 176.0}, "policy_reward_mean": {"prey_policy": 24.13, "predator_policy": 26.24}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-191.0, 129.0, 237.0, 116.0, -6.0, 118.0, -29.0, 133.0, -4.0, 141.0, -15.0, 132.0, 0.0, 15.0, 180.0, 0.0, 222.0, 164.0, 57.0, 175.0, 144.0, -30.0, -12.0, 70.0, 19.0, 0.0, 88.0, 90.0, 165.0, 320.0, 261.0, 87.0, 117.0, 136.0, 148.0, 0.0, 39.0, 148.0, -11.0, 141.0, 353.0, 97.0, 253.0, 11.0, 139.0, -30.0, 199.0, 23.0, 0.0, 324.0, 179.0, -15.0, 78.0, -10.0, 288.0, 146.0, 152.0, 137.0, 144.0, -31.0, 72.0, 182.0, -7.0, 7.0, 280.0, -16.0, 119.0, 115.0, 174.0, 4.0, 194.0, -256.0, -131.0, 152.0, -23.0, 59.0, 92.0, 38.0, 186.0, 172.0, 375.0, 186.0, 230.0, 101.0, 198.0, 58.0, 149.0, 132.0, 60.0, 217.0, 103.0, -157.0, 240.0, 0.0, 15.0, 259.0, 225.0, -15.0, 181.0, 173.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-134.0, -223.0, -12.0, 135.0, 125.0, 84.0, 0.0, 87.0, -12.0, 0.0, 44.0, 0.0, -335.0, 92.0, 0.0, 80.0, -8.0, 0.0, 0.0, 117.0, -8.0, -14.0, 41.0, 32.0, 0.0, 0.0, -69.0, 0.0, -8.0, 89.0, 0.0, 0.0, 74.0, 100.0, 51.0, 35.0, 0.0, -18.0, 168.0, 0.0, 0.0, 116.0, 0.0, -143.0, -12.0, -6.0, 7.0, 0.0, 3.0, -96.0, 0.0, 0.0, 33.0, -28.0, 58.0, 11.0, -46.0, 98.0, 129.0, 170.0, 104.0, 125.0, 87.0, 0.0, -37.0, 39.0, -14.0, 129.0, 0.0, 122.0, 0.0, 0.0, -26.0, 0.0, 134.0, 2.0, -12.0, -8.0, -10.0, 85.0, 134.0, 197.0, -19.0, 0.0, 34.0, 147.0, 0.0, -77.0, 0.0, 115.0, 0.0, -294.0, 0.0, 199.0, -2.0, -58.0, 0.0, 0.0, 170.0, 149.0, 177.0, 0.0, -14.0, -8.0, 15.0, -72.0, -6.0, -8.0, 92.0, 154.0, 122.0, -7.0, 152.0, 0.0, -14.0, 131.0, 101.0, -12.0, -143.0, 0.0, 0.0, 69.0, 173.0, 0.0, -2.0, -14.0, -83.0, 0.0, 148.0, 107.0, -37.0, 0.0, -47.0, 59.0, 122.0, -26.0, 0.0, 161.0, 0.0, 0.0, 194.0, 0.0, -255.0, -229.0, 0.0, -291.0, -6.0, 138.0, -9.0, -130.0, -7.0, -6.0, 40.0, -49.0, 16.0, -161.0, -14.0, 187.0, -6.0, 174.0, 173.0, 190.0, 88.0, 41.0, 124.0, 102.0, 47.0, -82.0, 182.0, 10.0, 58.0, 0.0, -85.0, 139.0, 132.0, 0.0, 0.0, 60.0, 98.0, 45.0, -187.0, 170.0, -122.0, -168.0, 29.0, 146.0, 0.0, 0.0, -67.0, 18.0, -6.0, 200.0, 62.0, 159.0, 0.0, -182.0, 0.0, 181.0, 0.0, 173.0], "policy_predator_policy_reward": [144.0, 22.0, 0.0, 6.0, 28.0, 0.0, 0.0, 29.0, 6.0, 0.0, 35.0, 39.0, 176.0, 38.0, 14.0, 39.0, 0.0, 4.0, 0.0, 24.0, 0.0, 7.0, 0.0, 59.0, 0.0, 0.0, 83.0, 1.0, 53.0, 46.0, 0.0, 0.0, 19.0, 29.0, 35.0, 43.0, 51.0, 24.0, 0.0, 7.0, 13.0, 15.0, 4.0, 109.0, 0.0, 6.0, 54.0, 9.0, 91.0, 21.0, 0.0, 0.0, 0.0, 83.0, 10.0, 11.0, 65.0, 48.0, 0.0, 21.0, 0.0, 32.0, 0.0, 0.0, 89.0, 26.0, 14.0, 7.0, 26.0, 0.0, 0.0, 0.0, 65.0, 0.0, 12.0, 0.0, 0.0, 9.0, 66.0, 0.0, 2.0, 20.0, 73.0, 43.0, 52.0, 20.0, 88.0, 0.0, 0.0, 24.0, 154.0, 110.0, 0.0, 0.0, 2.0, 81.0, 0.0, 0.0, 1.0, 4.0, 0.0, 2.0, 0.0, 7.0, 75.0, 60.0, 4.0, 0.0, 42.0, 0.0, 26.0, 5.0, 0.0, 0.0, 20.0, 0.0, 23.0, 32.0, 13.0, 99.0, 1.0, 2.0, 9.0, 0.0, 0.0, 9.0, 90.0, 0.0, 15.0, 10.0, 6.0, 15.0, 21.0, 86.0, 10.0, 9.0, 0.0, 13.0, 4.0, 0.0, 0.0, 0.0, 156.0, 72.0, 3.0, 157.0, 4.0, 16.0, 8.0, 108.0, 52.0, 20.0, 55.0, 46.0, 122.0, 61.0, 13.0, 0.0, 3.0, 1.0, 4.0, 8.0, 12.0, 45.0, 0.0, 4.0, 46.0, 90.0, 6.0, 0.0, 0.0, 0.0, 12.0, 83.0, 0.0, 0.0, 0.0, 0.0, 43.0, 31.0, 104.0, 16.0, 116.0, 17.0, 53.0, 12.0, 0.0, 0.0, 63.0, 1.0, 34.0, 31.0, 2.0, 2.0, 52.0, 115.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5569179058107696, "mean_inference_ms": 4.438949236041529, "mean_action_processing_ms": 0.7360269460506109, "mean_env_wait_ms": 0.5460490737853868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005069613456726074, "StateBufferConnector_ms": 0.004928946495056152, "ViewRequirementAgentConnector_ms": 0.12367355823516846}, "num_episodes": 18, "episode_return_max": 375.0, "episode_return_min": -256.0, "episode_return_mean": 100.74, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 284.79689644129155, "num_env_steps_trained_throughput_per_sec": 284.79689644129155, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1376000, "timers": {"training_iteration_time_ms": 14749.158, "restore_workers_time_ms": 0.017, "training_step_time_ms": 14749.095, "sample_time_ms": 1752.147, "learn_time_ms": 12969.469, "learn_throughput": 308.417, "synch_weights_time_ms": 21.485}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "done": false, "training_iteration": 86, "trial_id": "f6b99_00000", "date": "2024-08-13_20-16-31", "timestamp": 1723594591, "time_this_iter_s": 14.093347072601318, "time_total_s": 1892.4742419719696, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b379df70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1892.4742419719696, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 54.55499999999999, "ram_util_percent": 83.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.628714619647889, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2672133679743167, "policy_loss": -0.004600330809175613, "vf_loss": 2.2717413582499066, "vf_explained_var": 0.02365653981607427, "kl": 0.005787450721598488, "entropy": 0.3502885106537077, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1451993875402624, "cur_kl_coeff": 0.02109375, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2786096192541576, "policy_loss": -0.006582463568288379, "vf_loss": 3.28504758246992, "vf_explained_var": 0.25613449111817377, "kl": 0.006850648425901286, "entropy": 0.599153389060308, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 375.0, "episode_reward_min": -288.0, "episode_reward_mean": 102.4, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -323.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 168.0}, "policy_reward_mean": {"prey_policy": 25.335, "predator_policy": 25.865}, "custom_metrics": {}, "hist_stats": {"episode_reward": [70.0, 19.0, 0.0, 88.0, 90.0, 165.0, 320.0, 261.0, 87.0, 117.0, 136.0, 148.0, 0.0, 39.0, 148.0, -11.0, 141.0, 353.0, 97.0, 253.0, 11.0, 139.0, -30.0, 199.0, 23.0, 0.0, 324.0, 179.0, -15.0, 78.0, -10.0, 288.0, 146.0, 152.0, 137.0, 144.0, -31.0, 72.0, 182.0, -7.0, 7.0, 280.0, -16.0, 119.0, 115.0, 174.0, 4.0, 194.0, -256.0, -131.0, 152.0, -23.0, 59.0, 92.0, 38.0, 186.0, 172.0, 375.0, 186.0, 230.0, 101.0, 198.0, 58.0, 149.0, 132.0, 60.0, 217.0, 103.0, -157.0, 240.0, 0.0, 15.0, 259.0, 225.0, -15.0, 181.0, 173.0, -6.0, -2.0, 89.0, 192.0, 114.0, 14.0, 128.0, 78.0, 120.0, 0.0, 127.0, 283.0, 82.0, 16.0, 0.0, 20.0, -288.0, 116.0, 191.0, 227.0, 69.0, 171.0, 101.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [7.0, 0.0, 3.0, -96.0, 0.0, 0.0, 33.0, -28.0, 58.0, 11.0, -46.0, 98.0, 129.0, 170.0, 104.0, 125.0, 87.0, 0.0, -37.0, 39.0, -14.0, 129.0, 0.0, 122.0, 0.0, 0.0, -26.0, 0.0, 134.0, 2.0, -12.0, -8.0, -10.0, 85.0, 134.0, 197.0, -19.0, 0.0, 34.0, 147.0, 0.0, -77.0, 0.0, 115.0, 0.0, -294.0, 0.0, 199.0, -2.0, -58.0, 0.0, 0.0, 170.0, 149.0, 177.0, 0.0, -14.0, -8.0, 15.0, -72.0, -6.0, -8.0, 92.0, 154.0, 122.0, -7.0, 152.0, 0.0, -14.0, 131.0, 101.0, -12.0, -143.0, 0.0, 0.0, 69.0, 173.0, 0.0, -2.0, -14.0, -83.0, 0.0, 148.0, 107.0, -37.0, 0.0, -47.0, 59.0, 122.0, -26.0, 0.0, 161.0, 0.0, 0.0, 194.0, 0.0, -255.0, -229.0, 0.0, -291.0, -6.0, 138.0, -9.0, -130.0, -7.0, -6.0, 40.0, -49.0, 16.0, -161.0, -14.0, 187.0, -6.0, 174.0, 173.0, 190.0, 88.0, 41.0, 124.0, 102.0, 47.0, -82.0, 182.0, 10.0, 58.0, 0.0, -85.0, 139.0, 132.0, 0.0, 0.0, 60.0, 98.0, 45.0, -187.0, 170.0, -122.0, -168.0, 29.0, 146.0, 0.0, 0.0, -67.0, 18.0, -6.0, 200.0, 62.0, 159.0, 0.0, -182.0, 0.0, 181.0, 0.0, 173.0, -12.0, 0.0, -4.0, 0.0, 89.0, 0.0, 188.0, 0.0, 43.0, 3.0, 14.0, 0.0, -127.0, 101.0, 78.0, 0.0, 2.0, 102.0, 0.0, 0.0, -64.0, -9.0, 138.0, 144.0, 0.0, 28.0, 0.0, -99.0, 0.0, 0.0, 27.0, -14.0, -188.0, -323.0, 0.0, 116.0, 155.0, 21.0, -64.0, 142.0, -2.0, -18.0, 152.0, 0.0, 90.0, 0.0], "policy_predator_policy_reward": [54.0, 9.0, 91.0, 21.0, 0.0, 0.0, 0.0, 83.0, 10.0, 11.0, 65.0, 48.0, 0.0, 21.0, 0.0, 32.0, 0.0, 0.0, 89.0, 26.0, 14.0, 7.0, 26.0, 0.0, 0.0, 0.0, 65.0, 0.0, 12.0, 0.0, 0.0, 9.0, 66.0, 0.0, 2.0, 20.0, 73.0, 43.0, 52.0, 20.0, 88.0, 0.0, 0.0, 24.0, 154.0, 110.0, 0.0, 0.0, 2.0, 81.0, 0.0, 0.0, 1.0, 4.0, 0.0, 2.0, 0.0, 7.0, 75.0, 60.0, 4.0, 0.0, 42.0, 0.0, 26.0, 5.0, 0.0, 0.0, 20.0, 0.0, 23.0, 32.0, 13.0, 99.0, 1.0, 2.0, 9.0, 0.0, 0.0, 9.0, 90.0, 0.0, 15.0, 10.0, 6.0, 15.0, 21.0, 86.0, 10.0, 9.0, 0.0, 13.0, 4.0, 0.0, 0.0, 0.0, 156.0, 72.0, 3.0, 157.0, 4.0, 16.0, 8.0, 108.0, 52.0, 20.0, 55.0, 46.0, 122.0, 61.0, 13.0, 0.0, 3.0, 1.0, 4.0, 8.0, 12.0, 45.0, 0.0, 4.0, 46.0, 90.0, 6.0, 0.0, 0.0, 0.0, 12.0, 83.0, 0.0, 0.0, 0.0, 0.0, 43.0, 31.0, 104.0, 16.0, 116.0, 17.0, 53.0, 12.0, 0.0, 0.0, 63.0, 1.0, 34.0, 31.0, 2.0, 2.0, 52.0, 115.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 2.0, 0.0, 0.0, 0.0, 4.0, 0.0, 27.0, 41.0, 0.0, 0.0, 62.0, 92.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 112.0, 88.0, 1.0, 0.0, 0.0, 54.0, 22.0, 93.0, 0.0, 0.0, 0.0, 7.0, 55.0, 168.0, 0.0, 0.0, 0.0, 15.0, 68.0, 81.0, 59.0, 30.0, 12.0, 7.0, 0.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5453257200726132, "mean_inference_ms": 4.4096874918060935, "mean_action_processing_ms": 0.7300645032668482, "mean_env_wait_ms": 0.5419257607629508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004862785339355469, "StateBufferConnector_ms": 0.0050934553146362305, "ViewRequirementAgentConnector_ms": 0.12045037746429443}, "num_episodes": 23, "episode_return_max": 375.0, "episode_return_min": -288.0, "episode_return_mean": 102.4, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.5092594832934, "num_env_steps_trained_throughput_per_sec": 281.5092594832934, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 14731.969, "restore_workers_time_ms": 0.016, "training_step_time_ms": 14731.897, "sample_time_ms": 1727.167, "learn_time_ms": 12976.605, "learn_throughput": 308.247, "synch_weights_time_ms": 22.299}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 87, "trial_id": "f6b99_00000", "date": "2024-08-13_20-16-46", "timestamp": 1723594606, "time_this_iter_s": 14.250812768936157, "time_total_s": 1906.7250547409058, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b60a79d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1906.7250547409058, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 53.671428571428564, "ram_util_percent": 83.72857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2563280200359053, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8903118472092997, "policy_loss": -0.004789099370858696, "vf_loss": 0.8949668999465685, "vf_explained_var": 0.03660272873898662, "kl": 0.010723741307791048, "entropy": 0.3330851624645884, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.589671135831762, "cur_kl_coeff": 0.02109375, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6631532337930466, "policy_loss": -0.009635621262837457, "vf_loss": 2.6726431418978978, "vf_explained_var": 0.7653427162498393, "kl": 0.006907947666713593, "entropy": 0.5714503615936904, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "env_runners": {"episode_reward_max": 375.0, "episode_reward_min": -288.0, "episode_reward_mean": 96.77, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -323.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 168.0}, "policy_reward_mean": {"prey_policy": 23.655, "predator_policy": 24.73}, "custom_metrics": {}, "hist_stats": {"episode_reward": [97.0, 253.0, 11.0, 139.0, -30.0, 199.0, 23.0, 0.0, 324.0, 179.0, -15.0, 78.0, -10.0, 288.0, 146.0, 152.0, 137.0, 144.0, -31.0, 72.0, 182.0, -7.0, 7.0, 280.0, -16.0, 119.0, 115.0, 174.0, 4.0, 194.0, -256.0, -131.0, 152.0, -23.0, 59.0, 92.0, 38.0, 186.0, 172.0, 375.0, 186.0, 230.0, 101.0, 198.0, 58.0, 149.0, 132.0, 60.0, 217.0, 103.0, -157.0, 240.0, 0.0, 15.0, 259.0, 225.0, -15.0, 181.0, 173.0, -6.0, -2.0, 89.0, 192.0, 114.0, 14.0, 128.0, 78.0, 120.0, 0.0, 127.0, 283.0, 82.0, 16.0, 0.0, 20.0, -288.0, 116.0, 191.0, 227.0, 69.0, 171.0, 101.0, 0.0, 85.0, 115.0, 104.0, 185.0, 65.0, 105.0, 55.0, 86.0, 78.0, 115.0, -2.0, 0.0, 190.0, 193.0, -3.0, 87.0, 150.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-19.0, 0.0, 34.0, 147.0, 0.0, -77.0, 0.0, 115.0, 0.0, -294.0, 0.0, 199.0, -2.0, -58.0, 0.0, 0.0, 170.0, 149.0, 177.0, 0.0, -14.0, -8.0, 15.0, -72.0, -6.0, -8.0, 92.0, 154.0, 122.0, -7.0, 152.0, 0.0, -14.0, 131.0, 101.0, -12.0, -143.0, 0.0, 0.0, 69.0, 173.0, 0.0, -2.0, -14.0, -83.0, 0.0, 148.0, 107.0, -37.0, 0.0, -47.0, 59.0, 122.0, -26.0, 0.0, 161.0, 0.0, 0.0, 194.0, 0.0, -255.0, -229.0, 0.0, -291.0, -6.0, 138.0, -9.0, -130.0, -7.0, -6.0, 40.0, -49.0, 16.0, -161.0, -14.0, 187.0, -6.0, 174.0, 173.0, 190.0, 88.0, 41.0, 124.0, 102.0, 47.0, -82.0, 182.0, 10.0, 58.0, 0.0, -85.0, 139.0, 132.0, 0.0, 0.0, 60.0, 98.0, 45.0, -187.0, 170.0, -122.0, -168.0, 29.0, 146.0, 0.0, 0.0, -67.0, 18.0, -6.0, 200.0, 62.0, 159.0, 0.0, -182.0, 0.0, 181.0, 0.0, 173.0, -12.0, 0.0, -4.0, 0.0, 89.0, 0.0, 188.0, 0.0, 43.0, 3.0, 14.0, 0.0, -127.0, 101.0, 78.0, 0.0, 2.0, 102.0, 0.0, 0.0, -64.0, -9.0, 138.0, 144.0, 0.0, 28.0, 0.0, -99.0, 0.0, 0.0, 27.0, -14.0, -188.0, -323.0, 0.0, 116.0, 155.0, 21.0, -64.0, 142.0, -2.0, -18.0, 152.0, 0.0, 90.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 109.0, 0.0, 104.0, -26.0, 198.0, -37.0, 0.0, 111.0, -12.0, 55.0, 0.0, 7.0, 79.0, 15.0, 18.0, 68.0, 0.0, 0.0, -4.0, 0.0, 0.0, 200.0, -20.0, 81.0, 71.0, -18.0, 0.0, 92.0, -148.0, -54.0, 146.0], "policy_predator_policy_reward": [73.0, 43.0, 52.0, 20.0, 88.0, 0.0, 0.0, 24.0, 154.0, 110.0, 0.0, 0.0, 2.0, 81.0, 0.0, 0.0, 1.0, 4.0, 0.0, 2.0, 0.0, 7.0, 75.0, 60.0, 4.0, 0.0, 42.0, 0.0, 26.0, 5.0, 0.0, 0.0, 20.0, 0.0, 23.0, 32.0, 13.0, 99.0, 1.0, 2.0, 9.0, 0.0, 0.0, 9.0, 90.0, 0.0, 15.0, 10.0, 6.0, 15.0, 21.0, 86.0, 10.0, 9.0, 0.0, 13.0, 4.0, 0.0, 0.0, 0.0, 156.0, 72.0, 3.0, 157.0, 4.0, 16.0, 8.0, 108.0, 52.0, 20.0, 55.0, 46.0, 122.0, 61.0, 13.0, 0.0, 3.0, 1.0, 4.0, 8.0, 12.0, 45.0, 0.0, 4.0, 46.0, 90.0, 6.0, 0.0, 0.0, 0.0, 12.0, 83.0, 0.0, 0.0, 0.0, 0.0, 43.0, 31.0, 104.0, 16.0, 116.0, 17.0, 53.0, 12.0, 0.0, 0.0, 63.0, 1.0, 34.0, 31.0, 2.0, 2.0, 52.0, 115.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 2.0, 0.0, 0.0, 0.0, 4.0, 0.0, 27.0, 41.0, 0.0, 0.0, 62.0, 92.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 112.0, 88.0, 1.0, 0.0, 0.0, 54.0, 22.0, 93.0, 0.0, 0.0, 0.0, 7.0, 55.0, 168.0, 0.0, 0.0, 0.0, 15.0, 68.0, 81.0, 59.0, 30.0, 12.0, 7.0, 0.0, 11.0, 0.0, 0.0, 28.0, 38.0, 6.0, 0.0, 0.0, 0.0, 0.0, 13.0, 51.0, 51.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 8.0, 37.0, 41.0, 6.0, 0.0, 2.0, 0.0, 0.0, 0.0, 10.0, 17.0, 24.0, 9.0, 6.0, 70.0, 73.0, 34.0, 24.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5365048144546416, "mean_inference_ms": 4.387009025383466, "mean_action_processing_ms": 0.7255394144110567, "mean_env_wait_ms": 0.5387818383292905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005030274391174316, "StateBufferConnector_ms": 0.005092620849609375, "ViewRequirementAgentConnector_ms": 0.12099504470825195}, "num_episodes": 18, "episode_return_max": 375.0, "episode_return_min": -288.0, "episode_return_mean": 96.77, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.9873942184903, "num_env_steps_trained_throughput_per_sec": 305.9873942184903, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1408000, "timers": {"training_iteration_time_ms": 14587.725, "restore_workers_time_ms": 0.016, "training_step_time_ms": 14587.651, "sample_time_ms": 1699.987, "learn_time_ms": 12859.581, "learn_throughput": 311.052, "synch_weights_time_ms": 22.335}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "done": false, "training_iteration": 88, "trial_id": "f6b99_00000", "date": "2024-08-13_20-16-59", "timestamp": 1723594619, "time_this_iter_s": 13.12381911277771, "time_total_s": 1919.8488738536835, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6096430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1919.8488738536835, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 51.294444444444444, "ram_util_percent": 83.69444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.695977102496006, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8283452338642543, "policy_loss": -0.0033653866226178784, "vf_loss": 2.8316488570637173, "vf_explained_var": 0.023351146525176114, "kl": 0.004940562898486008, "entropy": 0.35424456381923936, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.2614426881863325, "cur_kl_coeff": 0.02109375, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5826760460459997, "policy_loss": -0.00488265748061831, "vf_loss": 3.5874230246064522, "vf_explained_var": 0.5664413213729859, "kl": 0.006432306680000823, "entropy": 0.5785615618424441, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "env_runners": {"episode_reward_max": 375.0, "episode_reward_min": -288.0, "episode_reward_mean": 105.62, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -323.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 168.0}, "policy_reward_mean": {"prey_policy": 29.695, "predator_policy": 23.115}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.0, 280.0, -16.0, 119.0, 115.0, 174.0, 4.0, 194.0, -256.0, -131.0, 152.0, -23.0, 59.0, 92.0, 38.0, 186.0, 172.0, 375.0, 186.0, 230.0, 101.0, 198.0, 58.0, 149.0, 132.0, 60.0, 217.0, 103.0, -157.0, 240.0, 0.0, 15.0, 259.0, 225.0, -15.0, 181.0, 173.0, -6.0, -2.0, 89.0, 192.0, 114.0, 14.0, 128.0, 78.0, 120.0, 0.0, 127.0, 283.0, 82.0, 16.0, 0.0, 20.0, -288.0, 116.0, 191.0, 227.0, 69.0, 171.0, 101.0, 0.0, 85.0, 115.0, 104.0, 185.0, 65.0, 105.0, 55.0, 86.0, 78.0, 115.0, -2.0, 0.0, 190.0, 193.0, -3.0, 87.0, 150.0, 113.0, -4.0, 35.0, 107.0, 287.0, 200.0, 347.0, 183.0, 273.0, 302.0, -4.0, 42.0, 250.0, 115.0, 33.0, 210.0, 165.0, 197.0, 125.0, 0.0, 158.0, 82.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-83.0, 0.0, 148.0, 107.0, -37.0, 0.0, -47.0, 59.0, 122.0, -26.0, 0.0, 161.0, 0.0, 0.0, 194.0, 0.0, -255.0, -229.0, 0.0, -291.0, -6.0, 138.0, -9.0, -130.0, -7.0, -6.0, 40.0, -49.0, 16.0, -161.0, -14.0, 187.0, -6.0, 174.0, 173.0, 190.0, 88.0, 41.0, 124.0, 102.0, 47.0, -82.0, 182.0, 10.0, 58.0, 0.0, -85.0, 139.0, 132.0, 0.0, 0.0, 60.0, 98.0, 45.0, -187.0, 170.0, -122.0, -168.0, 29.0, 146.0, 0.0, 0.0, -67.0, 18.0, -6.0, 200.0, 62.0, 159.0, 0.0, -182.0, 0.0, 181.0, 0.0, 173.0, -12.0, 0.0, -4.0, 0.0, 89.0, 0.0, 188.0, 0.0, 43.0, 3.0, 14.0, 0.0, -127.0, 101.0, 78.0, 0.0, 2.0, 102.0, 0.0, 0.0, -64.0, -9.0, 138.0, 144.0, 0.0, 28.0, 0.0, -99.0, 0.0, 0.0, 27.0, -14.0, -188.0, -323.0, 0.0, 116.0, 155.0, 21.0, -64.0, 142.0, -2.0, -18.0, 152.0, 0.0, 90.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 109.0, 0.0, 104.0, -26.0, 198.0, -37.0, 0.0, 111.0, -12.0, 55.0, 0.0, 7.0, 79.0, 15.0, 18.0, 68.0, 0.0, 0.0, -4.0, 0.0, 0.0, 200.0, -20.0, 81.0, 71.0, -18.0, 0.0, 92.0, -148.0, -54.0, 146.0, 105.0, 0.0, 0.0, -52.0, 0.0, -84.0, 104.0, -16.0, 86.0, 163.0, 0.0, 200.0, 170.0, 157.0, 60.0, 75.0, 93.0, 180.0, 129.0, 156.0, -8.0, 0.0, -51.0, -12.0, 148.0, 92.0, 167.0, -244.0, 33.0, 0.0, 104.0, 63.0, 0.0, 155.0, -18.0, 166.0, 55.0, 58.0, 0.0, 0.0, 163.0, -10.0, 71.0, 0.0], "policy_predator_policy_reward": [90.0, 0.0, 15.0, 10.0, 6.0, 15.0, 21.0, 86.0, 10.0, 9.0, 0.0, 13.0, 4.0, 0.0, 0.0, 0.0, 156.0, 72.0, 3.0, 157.0, 4.0, 16.0, 8.0, 108.0, 52.0, 20.0, 55.0, 46.0, 122.0, 61.0, 13.0, 0.0, 3.0, 1.0, 4.0, 8.0, 12.0, 45.0, 0.0, 4.0, 46.0, 90.0, 6.0, 0.0, 0.0, 0.0, 12.0, 83.0, 0.0, 0.0, 0.0, 0.0, 43.0, 31.0, 104.0, 16.0, 116.0, 17.0, 53.0, 12.0, 0.0, 0.0, 63.0, 1.0, 34.0, 31.0, 2.0, 2.0, 52.0, 115.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 2.0, 0.0, 0.0, 0.0, 4.0, 0.0, 27.0, 41.0, 0.0, 0.0, 62.0, 92.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 112.0, 88.0, 1.0, 0.0, 0.0, 54.0, 22.0, 93.0, 0.0, 0.0, 0.0, 7.0, 55.0, 168.0, 0.0, 0.0, 0.0, 15.0, 68.0, 81.0, 59.0, 30.0, 12.0, 7.0, 0.0, 11.0, 0.0, 0.0, 28.0, 38.0, 6.0, 0.0, 0.0, 0.0, 0.0, 13.0, 51.0, 51.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 8.0, 37.0, 41.0, 6.0, 0.0, 2.0, 0.0, 0.0, 0.0, 10.0, 17.0, 24.0, 9.0, 6.0, 70.0, 73.0, 34.0, 24.0, 8.0, 0.0, 3.0, 45.0, 68.0, 51.0, 10.0, 9.0, 26.0, 12.0, 0.0, 0.0, 10.0, 10.0, 31.0, 17.0, 0.0, 0.0, 0.0, 17.0, 0.0, 4.0, 61.0, 44.0, 4.0, 6.0, 137.0, 55.0, 0.0, 0.0, 43.0, 0.0, 0.0, 10.0, 14.0, 35.0, 0.0, 12.0, 0.0, 0.0, 0.0, 5.0, 10.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.531170523290803, "mean_inference_ms": 4.375383204444223, "mean_action_processing_ms": 0.7250965836295336, "mean_env_wait_ms": 0.5377082176104266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0049735307693481445, "StateBufferConnector_ms": 0.005034804344177246, "ViewRequirementAgentConnector_ms": 0.13205385208129883}, "num_episodes": 22, "episode_return_max": 375.0, "episode_return_min": -288.0, "episode_return_mean": 105.62, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 249.78145334726287, "num_env_steps_trained_throughput_per_sec": 249.78145334726287, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 1424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1424000, "timers": {"training_iteration_time_ms": 14706.306, "restore_workers_time_ms": 0.016, "training_step_time_ms": 14706.232, "sample_time_ms": 1687.16, "learn_time_ms": 12991.759, "learn_throughput": 307.887, "synch_weights_time_ms": 21.978}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "done": false, "training_iteration": 89, "trial_id": "f6b99_00000", "date": "2024-08-13_20-17-15", "timestamp": 1723594635, "time_this_iter_s": 16.05928611755371, "time_total_s": 1935.9081599712372, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6087e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1935.9081599712372, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 61.386956521739144, "ram_util_percent": 83.46086956521737}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2762531232739251, "cur_kl_coeff": 0.00625, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9954106654281969, "policy_loss": -0.005087332068154066, "vf_loss": 1.0004594681262182, "vf_explained_var": 0.014963076385871443, "kl": 0.006164644780720764, "entropy": 0.25278475233329034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.0429494918654205, "cur_kl_coeff": 0.02109375, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.164960341983371, "policy_loss": -0.006327045382192684, "vf_loss": 3.1711965215269218, "vf_explained_var": 0.6801828789647925, "kl": 0.004307821373860558, "entropy": 0.528817599286478, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 347.0, "episode_reward_min": -288.0, "episode_reward_mean": 113.38, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -323.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 168.0}, "policy_reward_mean": {"prey_policy": 36.985, "predator_policy": 19.705}, "custom_metrics": {}, "hist_stats": {"episode_reward": [186.0, 230.0, 101.0, 198.0, 58.0, 149.0, 132.0, 60.0, 217.0, 103.0, -157.0, 240.0, 0.0, 15.0, 259.0, 225.0, -15.0, 181.0, 173.0, -6.0, -2.0, 89.0, 192.0, 114.0, 14.0, 128.0, 78.0, 120.0, 0.0, 127.0, 283.0, 82.0, 16.0, 0.0, 20.0, -288.0, 116.0, 191.0, 227.0, 69.0, 171.0, 101.0, 0.0, 85.0, 115.0, 104.0, 185.0, 65.0, 105.0, 55.0, 86.0, 78.0, 115.0, -2.0, 0.0, 190.0, 193.0, -3.0, 87.0, 150.0, 113.0, -4.0, 35.0, 107.0, 287.0, 200.0, 347.0, 183.0, 273.0, 302.0, -4.0, 42.0, 250.0, 115.0, 33.0, 210.0, 165.0, 197.0, 125.0, 0.0, 158.0, 82.0, 289.0, -2.0, 28.0, 171.0, 24.0, 59.0, -59.0, 293.0, 86.0, -3.0, 113.0, 253.0, 223.0, 115.0, 201.0, 179.0, 198.0, 149.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [88.0, 41.0, 124.0, 102.0, 47.0, -82.0, 182.0, 10.0, 58.0, 0.0, -85.0, 139.0, 132.0, 0.0, 0.0, 60.0, 98.0, 45.0, -187.0, 170.0, -122.0, -168.0, 29.0, 146.0, 0.0, 0.0, -67.0, 18.0, -6.0, 200.0, 62.0, 159.0, 0.0, -182.0, 0.0, 181.0, 0.0, 173.0, -12.0, 0.0, -4.0, 0.0, 89.0, 0.0, 188.0, 0.0, 43.0, 3.0, 14.0, 0.0, -127.0, 101.0, 78.0, 0.0, 2.0, 102.0, 0.0, 0.0, -64.0, -9.0, 138.0, 144.0, 0.0, 28.0, 0.0, -99.0, 0.0, 0.0, 27.0, -14.0, -188.0, -323.0, 0.0, 116.0, 155.0, 21.0, -64.0, 142.0, -2.0, -18.0, 152.0, 0.0, 90.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 109.0, 0.0, 104.0, -26.0, 198.0, -37.0, 0.0, 111.0, -12.0, 55.0, 0.0, 7.0, 79.0, 15.0, 18.0, 68.0, 0.0, 0.0, -4.0, 0.0, 0.0, 200.0, -20.0, 81.0, 71.0, -18.0, 0.0, 92.0, -148.0, -54.0, 146.0, 105.0, 0.0, 0.0, -52.0, 0.0, -84.0, 104.0, -16.0, 86.0, 163.0, 0.0, 200.0, 170.0, 157.0, 60.0, 75.0, 93.0, 180.0, 129.0, 156.0, -8.0, 0.0, -51.0, -12.0, 148.0, 92.0, 167.0, -244.0, 33.0, 0.0, 104.0, 63.0, 0.0, 155.0, -18.0, 166.0, 55.0, 58.0, 0.0, 0.0, 163.0, -10.0, 71.0, 0.0, 122.0, 161.0, 0.0, -16.0, -16.0, 26.0, 101.0, 66.0, 29.0, -10.0, -63.0, 49.0, -126.0, 0.0, 113.0, 167.0, 60.0, -10.0, -6.0, 0.0, 0.0, 113.0, 183.0, 63.0, 68.0, 111.0, 0.0, 95.0, -49.0, 99.0, 187.0, -16.0, 44.0, 133.0, 0.0, 133.0], "policy_predator_policy_reward": [12.0, 45.0, 0.0, 4.0, 46.0, 90.0, 6.0, 0.0, 0.0, 0.0, 12.0, 83.0, 0.0, 0.0, 0.0, 0.0, 43.0, 31.0, 104.0, 16.0, 116.0, 17.0, 53.0, 12.0, 0.0, 0.0, 63.0, 1.0, 34.0, 31.0, 2.0, 2.0, 52.0, 115.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 2.0, 0.0, 0.0, 0.0, 4.0, 0.0, 27.0, 41.0, 0.0, 0.0, 62.0, 92.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 112.0, 88.0, 1.0, 0.0, 0.0, 54.0, 22.0, 93.0, 0.0, 0.0, 0.0, 7.0, 55.0, 168.0, 0.0, 0.0, 0.0, 15.0, 68.0, 81.0, 59.0, 30.0, 12.0, 7.0, 0.0, 11.0, 0.0, 0.0, 28.0, 38.0, 6.0, 0.0, 0.0, 0.0, 0.0, 13.0, 51.0, 51.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 8.0, 37.0, 41.0, 6.0, 0.0, 2.0, 0.0, 0.0, 0.0, 10.0, 17.0, 24.0, 9.0, 6.0, 70.0, 73.0, 34.0, 24.0, 8.0, 0.0, 3.0, 45.0, 68.0, 51.0, 10.0, 9.0, 26.0, 12.0, 0.0, 0.0, 10.0, 10.0, 31.0, 17.0, 0.0, 0.0, 0.0, 17.0, 0.0, 4.0, 61.0, 44.0, 4.0, 6.0, 137.0, 55.0, 0.0, 0.0, 43.0, 0.0, 0.0, 10.0, 14.0, 35.0, 0.0, 12.0, 0.0, 0.0, 0.0, 5.0, 10.0, 1.0, 6.0, 0.0, 0.0, 14.0, 11.0, 7.0, 0.0, 4.0, 5.0, 0.0, 29.0, 44.0, 59.0, 8.0, 6.0, 7.0, 22.0, 14.0, 0.0, 3.0, 0.0, 0.0, 7.0, 0.0, 44.0, 0.0, 0.0, 20.0, 68.0, 83.0, 8.0, 0.0, 15.0, 6.0, 13.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5175155376743732, "mean_inference_ms": 4.337391895529197, "mean_action_processing_ms": 0.7156184384347247, "mean_env_wait_ms": 0.5320016328076709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004479408264160156, "StateBufferConnector_ms": 0.003955841064453125, "ViewRequirementAgentConnector_ms": 0.14828705787658691}, "num_episodes": 18, "episode_return_max": 347.0, "episode_return_min": -288.0, "episode_return_mean": 113.38, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 285.1532908232591, "num_env_steps_trained_throughput_per_sec": 285.1532908232591, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 14609.197, "restore_workers_time_ms": 0.017, "training_step_time_ms": 14609.113, "sample_time_ms": 1710.186, "learn_time_ms": 12871.996, "learn_throughput": 310.752, "synch_weights_time_ms": 22.12}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 90, "trial_id": "f6b99_00000", "date": "2024-08-13_20-17-29", "timestamp": 1723594649, "time_this_iter_s": 14.066429853439331, "time_total_s": 1949.9745898246765, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b623d940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1949.9745898246765, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 51.645, "ram_util_percent": 82.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3599869611086668, "cur_kl_coeff": 0.00625, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8582440685973596, "policy_loss": -0.0033941933587094937, "vf_loss": 1.8616061032764495, "vf_explained_var": 0.05149736338191562, "kl": 0.005144847368082486, "entropy": 0.22013954582510803, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2721234126065775, "cur_kl_coeff": 0.010546875, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.601910345264213, "policy_loss": -0.006353478737313439, "vf_loss": 2.6081934242652207, "vf_explained_var": 0.6715859681525559, "kl": 0.006674602133687495, "entropy": 0.5434173003548668, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "env_runners": {"episode_reward_max": 356.0, "episode_reward_min": -288.0, "episode_reward_mean": 119.41, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -323.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 168.0}, "policy_reward_mean": {"prey_policy": 40.78, "predator_policy": 18.925}, "custom_metrics": {}, "hist_stats": {"episode_reward": [114.0, 14.0, 128.0, 78.0, 120.0, 0.0, 127.0, 283.0, 82.0, 16.0, 0.0, 20.0, -288.0, 116.0, 191.0, 227.0, 69.0, 171.0, 101.0, 0.0, 85.0, 115.0, 104.0, 185.0, 65.0, 105.0, 55.0, 86.0, 78.0, 115.0, -2.0, 0.0, 190.0, 193.0, -3.0, 87.0, 150.0, 113.0, -4.0, 35.0, 107.0, 287.0, 200.0, 347.0, 183.0, 273.0, 302.0, -4.0, 42.0, 250.0, 115.0, 33.0, 210.0, 165.0, 197.0, 125.0, 0.0, 158.0, 82.0, 289.0, -2.0, 28.0, 171.0, 24.0, 59.0, -59.0, 293.0, 86.0, -3.0, 113.0, 253.0, 223.0, 115.0, 201.0, 179.0, 198.0, 149.0, 98.0, 5.0, 201.0, 90.0, 200.0, 181.0, 323.0, -9.0, -7.0, 225.0, 116.0, 300.0, 19.0, 234.0, 172.0, 118.0, 177.0, 7.0, 128.0, 166.0, 132.0, 356.0, -1.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [43.0, 3.0, 14.0, 0.0, -127.0, 101.0, 78.0, 0.0, 2.0, 102.0, 0.0, 0.0, -64.0, -9.0, 138.0, 144.0, 0.0, 28.0, 0.0, -99.0, 0.0, 0.0, 27.0, -14.0, -188.0, -323.0, 0.0, 116.0, 155.0, 21.0, -64.0, 142.0, -2.0, -18.0, 152.0, 0.0, 90.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 109.0, 0.0, 104.0, -26.0, 198.0, -37.0, 0.0, 111.0, -12.0, 55.0, 0.0, 7.0, 79.0, 15.0, 18.0, 68.0, 0.0, 0.0, -4.0, 0.0, 0.0, 200.0, -20.0, 81.0, 71.0, -18.0, 0.0, 92.0, -148.0, -54.0, 146.0, 105.0, 0.0, 0.0, -52.0, 0.0, -84.0, 104.0, -16.0, 86.0, 163.0, 0.0, 200.0, 170.0, 157.0, 60.0, 75.0, 93.0, 180.0, 129.0, 156.0, -8.0, 0.0, -51.0, -12.0, 148.0, 92.0, 167.0, -244.0, 33.0, 0.0, 104.0, 63.0, 0.0, 155.0, -18.0, 166.0, 55.0, 58.0, 0.0, 0.0, 163.0, -10.0, 71.0, 0.0, 122.0, 161.0, 0.0, -16.0, -16.0, 26.0, 101.0, 66.0, 29.0, -10.0, -63.0, 49.0, -126.0, 0.0, 113.0, 167.0, 60.0, -10.0, -6.0, 0.0, 0.0, 113.0, 183.0, 63.0, 68.0, 111.0, 0.0, 95.0, -49.0, 99.0, 187.0, -16.0, 44.0, 133.0, 0.0, 133.0, 0.0, 98.0, 0.0, 5.0, 101.0, -76.0, 76.0, 0.0, 200.0, 0.0, -35.0, 102.0, 194.0, 80.0, -18.0, 0.0, 0.0, -14.0, 115.0, 37.0, 0.0, 86.0, 143.0, 140.0, 0.0, -89.0, 44.0, 141.0, 0.0, 172.0, 83.0, 0.0, 183.0, -12.0, -49.0, 0.0, 71.0, 0.0, 166.0, 0.0, 120.0, -22.0, 174.0, 171.0, -2.0, 0.0], "policy_predator_policy_reward": [27.0, 41.0, 0.0, 0.0, 62.0, 92.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 112.0, 88.0, 1.0, 0.0, 0.0, 54.0, 22.0, 93.0, 0.0, 0.0, 0.0, 7.0, 55.0, 168.0, 0.0, 0.0, 0.0, 15.0, 68.0, 81.0, 59.0, 30.0, 12.0, 7.0, 0.0, 11.0, 0.0, 0.0, 28.0, 38.0, 6.0, 0.0, 0.0, 0.0, 0.0, 13.0, 51.0, 51.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 8.0, 37.0, 41.0, 6.0, 0.0, 2.0, 0.0, 0.0, 0.0, 10.0, 17.0, 24.0, 9.0, 6.0, 70.0, 73.0, 34.0, 24.0, 8.0, 0.0, 3.0, 45.0, 68.0, 51.0, 10.0, 9.0, 26.0, 12.0, 0.0, 0.0, 10.0, 10.0, 31.0, 17.0, 0.0, 0.0, 0.0, 17.0, 0.0, 4.0, 61.0, 44.0, 4.0, 6.0, 137.0, 55.0, 0.0, 0.0, 43.0, 0.0, 0.0, 10.0, 14.0, 35.0, 0.0, 12.0, 0.0, 0.0, 0.0, 5.0, 10.0, 1.0, 6.0, 0.0, 0.0, 14.0, 11.0, 7.0, 0.0, 4.0, 5.0, 0.0, 29.0, 44.0, 59.0, 8.0, 6.0, 7.0, 22.0, 14.0, 0.0, 3.0, 0.0, 0.0, 7.0, 0.0, 44.0, 0.0, 0.0, 20.0, 68.0, 83.0, 8.0, 0.0, 15.0, 6.0, 13.0, 3.0, 0.0, 0.0, 0.0, 0.0, 95.0, 81.0, 3.0, 11.0, 0.0, 0.0, 72.0, 42.0, 20.0, 29.0, 9.0, 0.0, 7.0, 0.0, 39.0, 34.0, 30.0, 0.0, 17.0, 0.0, 60.0, 48.0, 49.0, 0.0, 0.0, 0.0, 0.0, 35.0, 0.0, 6.0, 0.0, 56.0, 30.0, 27.0, 0.0, 0.0, 15.0, 19.0, 9.0, 2.0, 0.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5062573402761743, "mean_inference_ms": 4.317409620057074, "mean_action_processing_ms": 0.7175420875917815, "mean_env_wait_ms": 0.5320878429044266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0049506425857543945, "StateBufferConnector_ms": 0.00348055362701416, "ViewRequirementAgentConnector_ms": 0.1521230936050415}, "num_episodes": 23, "episode_return_max": 356.0, "episode_return_min": -288.0, "episode_return_mean": 119.41, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 263.3230949885851, "num_env_steps_trained_throughput_per_sec": 263.3230949885851, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 1456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1456000, "timers": {"training_iteration_time_ms": 14705.72, "restore_workers_time_ms": 0.017, "training_step_time_ms": 14705.639, "sample_time_ms": 1684.904, "learn_time_ms": 12994.174, "learn_throughput": 307.83, "synch_weights_time_ms": 22.436}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "done": false, "training_iteration": 91, "trial_id": "f6b99_00000", "date": "2024-08-13_20-17-44", "timestamp": 1723594664, "time_this_iter_s": 15.243062973022461, "time_total_s": 1965.217652797699, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b623dd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1965.217652797699, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 58.6, "ram_util_percent": 83.01363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6817550070386715, "cur_kl_coeff": 0.00625, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6228121049189694, "policy_loss": -0.003713794060485073, "vf_loss": 1.626493954090845, "vf_explained_var": 0.0173500761153206, "kl": 0.005111445600152842, "entropy": 0.23948993642651845, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.361191472616145, "cur_kl_coeff": 0.010546875, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.810852456849719, "policy_loss": -0.009858012494813434, "vf_loss": 2.820650792374182, "vf_explained_var": 0.7355317380377855, "kl": 0.005658189260158807, "entropy": 0.4963309495537369, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "env_runners": {"episode_reward_max": 373.0, "episode_reward_min": -59.0, "episode_reward_mean": 133.46, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -244.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 137.0}, "policy_reward_mean": {"prey_policy": 50.845, "predator_policy": 15.885}, "custom_metrics": {}, "hist_stats": {"episode_reward": [101.0, 0.0, 85.0, 115.0, 104.0, 185.0, 65.0, 105.0, 55.0, 86.0, 78.0, 115.0, -2.0, 0.0, 190.0, 193.0, -3.0, 87.0, 150.0, 113.0, -4.0, 35.0, 107.0, 287.0, 200.0, 347.0, 183.0, 273.0, 302.0, -4.0, 42.0, 250.0, 115.0, 33.0, 210.0, 165.0, 197.0, 125.0, 0.0, 158.0, 82.0, 289.0, -2.0, 28.0, 171.0, 24.0, 59.0, -59.0, 293.0, 86.0, -3.0, 113.0, 253.0, 223.0, 115.0, 201.0, 179.0, 198.0, 149.0, 98.0, 5.0, 201.0, 90.0, 200.0, 181.0, 323.0, -9.0, -7.0, 225.0, 116.0, 300.0, 19.0, 234.0, 172.0, 118.0, 177.0, 7.0, 128.0, 166.0, 132.0, 356.0, -1.0, 149.0, 0.0, 62.0, 234.0, 196.0, 373.0, 324.0, 47.0, 121.0, 2.0, 105.0, 330.0, 157.0, 188.0, 198.0, 166.0, -4.0, 225.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [90.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 109.0, 0.0, 104.0, -26.0, 198.0, -37.0, 0.0, 111.0, -12.0, 55.0, 0.0, 7.0, 79.0, 15.0, 18.0, 68.0, 0.0, 0.0, -4.0, 0.0, 0.0, 200.0, -20.0, 81.0, 71.0, -18.0, 0.0, 92.0, -148.0, -54.0, 146.0, 105.0, 0.0, 0.0, -52.0, 0.0, -84.0, 104.0, -16.0, 86.0, 163.0, 0.0, 200.0, 170.0, 157.0, 60.0, 75.0, 93.0, 180.0, 129.0, 156.0, -8.0, 0.0, -51.0, -12.0, 148.0, 92.0, 167.0, -244.0, 33.0, 0.0, 104.0, 63.0, 0.0, 155.0, -18.0, 166.0, 55.0, 58.0, 0.0, 0.0, 163.0, -10.0, 71.0, 0.0, 122.0, 161.0, 0.0, -16.0, -16.0, 26.0, 101.0, 66.0, 29.0, -10.0, -63.0, 49.0, -126.0, 0.0, 113.0, 167.0, 60.0, -10.0, -6.0, 0.0, 0.0, 113.0, 183.0, 63.0, 68.0, 111.0, 0.0, 95.0, -49.0, 99.0, 187.0, -16.0, 44.0, 133.0, 0.0, 133.0, 0.0, 98.0, 0.0, 5.0, 101.0, -76.0, 76.0, 0.0, 200.0, 0.0, -35.0, 102.0, 194.0, 80.0, -18.0, 0.0, 0.0, -14.0, 115.0, 37.0, 0.0, 86.0, 143.0, 140.0, 0.0, -89.0, 44.0, 141.0, 0.0, 172.0, 83.0, 0.0, 183.0, -12.0, -49.0, 0.0, 71.0, 0.0, 166.0, 0.0, 120.0, -22.0, 174.0, 171.0, -2.0, 0.0, -82.0, 150.0, 0.0, 0.0, 0.0, 46.0, 167.0, 14.0, -8.0, 200.0, 184.0, 186.0, 200.0, 82.0, 0.0, 47.0, 129.0, -16.0, -86.0, 0.0, 79.0, -72.0, 194.0, 134.0, 0.0, 140.0, 0.0, 182.0, 0.0, 197.0, 152.0, 0.0, -6.0, -2.0, 19.0, 141.0], "policy_predator_policy_reward": [0.0, 11.0, 0.0, 0.0, 28.0, 38.0, 6.0, 0.0, 0.0, 0.0, 0.0, 13.0, 51.0, 51.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 8.0, 37.0, 41.0, 6.0, 0.0, 2.0, 0.0, 0.0, 0.0, 10.0, 17.0, 24.0, 9.0, 6.0, 70.0, 73.0, 34.0, 24.0, 8.0, 0.0, 3.0, 45.0, 68.0, 51.0, 10.0, 9.0, 26.0, 12.0, 0.0, 0.0, 10.0, 10.0, 31.0, 17.0, 0.0, 0.0, 0.0, 17.0, 0.0, 4.0, 61.0, 44.0, 4.0, 6.0, 137.0, 55.0, 0.0, 0.0, 43.0, 0.0, 0.0, 10.0, 14.0, 35.0, 0.0, 12.0, 0.0, 0.0, 0.0, 5.0, 10.0, 1.0, 6.0, 0.0, 0.0, 14.0, 11.0, 7.0, 0.0, 4.0, 5.0, 0.0, 29.0, 44.0, 59.0, 8.0, 6.0, 7.0, 22.0, 14.0, 0.0, 3.0, 0.0, 0.0, 7.0, 0.0, 44.0, 0.0, 0.0, 20.0, 68.0, 83.0, 8.0, 0.0, 15.0, 6.0, 13.0, 3.0, 0.0, 0.0, 0.0, 0.0, 95.0, 81.0, 3.0, 11.0, 0.0, 0.0, 72.0, 42.0, 20.0, 29.0, 9.0, 0.0, 7.0, 0.0, 39.0, 34.0, 30.0, 0.0, 17.0, 0.0, 60.0, 48.0, 49.0, 0.0, 0.0, 0.0, 0.0, 35.0, 0.0, 6.0, 0.0, 56.0, 30.0, 27.0, 0.0, 0.0, 15.0, 19.0, 9.0, 2.0, 0.0, 1.0, 27.0, 54.0, 0.0, 0.0, 16.0, 0.0, 31.0, 22.0, 0.0, 4.0, 0.0, 3.0, 16.0, 26.0, 0.0, 0.0, 0.0, 8.0, 49.0, 39.0, 19.0, 79.0, 0.0, 2.0, 17.0, 0.0, 6.0, 0.0, 0.0, 1.0, 12.0, 2.0, 0.0, 4.0, 49.0, 16.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4988750340108374, "mean_inference_ms": 4.287917117702666, "mean_action_processing_ms": 0.7056308851367064, "mean_env_wait_ms": 0.525204065306426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005414724349975586, "StateBufferConnector_ms": 0.003256559371948242, "ViewRequirementAgentConnector_ms": 0.1401526927947998}, "num_episodes": 18, "episode_return_max": 373.0, "episode_return_min": -59.0, "episode_return_mean": 133.46, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 247.9699632826792, "num_env_steps_trained_throughput_per_sec": 247.9699632826792, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1472000, "timers": {"training_iteration_time_ms": 14920.975, "restore_workers_time_ms": 0.017, "training_step_time_ms": 14920.895, "sample_time_ms": 1686.302, "learn_time_ms": 13208.141, "learn_throughput": 302.844, "synch_weights_time_ms": 22.829}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "done": false, "training_iteration": 92, "trial_id": "f6b99_00000", "date": "2024-08-13_20-18-00", "timestamp": 1723594680, "time_this_iter_s": 16.19537591934204, "time_total_s": 1981.413028717041, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3788040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1981.413028717041, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 62.41739130434783, "ram_util_percent": 82.28695652173914}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3064949259240792, "cur_kl_coeff": 0.00625, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6331605776750221, "policy_loss": -0.0028697187908821634, "vf_loss": 0.63599779565656, "vf_explained_var": 0.07096191193691637, "kl": 0.005200113297572331, "entropy": 0.19587250835996456, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.60787022014459, "cur_kl_coeff": 0.010546875, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.555063742966879, "policy_loss": -0.004267190486222269, "vf_loss": 1.559290008412467, "vf_explained_var": 0.9065198084980092, "kl": 0.003879753743862541, "entropy": 0.4097900880707635, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 373.0, "episode_reward_min": -59.0, "episode_reward_mean": 152.94, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -244.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 137.0}, "policy_reward_mean": {"prey_policy": 60.79, "predator_policy": 15.68}, "custom_metrics": {}, "hist_stats": {"episode_reward": [150.0, 113.0, -4.0, 35.0, 107.0, 287.0, 200.0, 347.0, 183.0, 273.0, 302.0, -4.0, 42.0, 250.0, 115.0, 33.0, 210.0, 165.0, 197.0, 125.0, 0.0, 158.0, 82.0, 289.0, -2.0, 28.0, 171.0, 24.0, 59.0, -59.0, 293.0, 86.0, -3.0, 113.0, 253.0, 223.0, 115.0, 201.0, 179.0, 198.0, 149.0, 98.0, 5.0, 201.0, 90.0, 200.0, 181.0, 323.0, -9.0, -7.0, 225.0, 116.0, 300.0, 19.0, 234.0, 172.0, 118.0, 177.0, 7.0, 128.0, 166.0, 132.0, 356.0, -1.0, 149.0, 0.0, 62.0, 234.0, 196.0, 373.0, 324.0, 47.0, 121.0, 2.0, 105.0, 330.0, 157.0, 188.0, 198.0, 166.0, -4.0, 225.0, 121.0, 368.0, 370.0, 326.0, 348.0, 340.0, 185.0, 178.0, 120.0, 150.0, 137.0, 158.0, 315.0, -11.0, 200.0, 105.0, 104.0, -7.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-54.0, 146.0, 105.0, 0.0, 0.0, -52.0, 0.0, -84.0, 104.0, -16.0, 86.0, 163.0, 0.0, 200.0, 170.0, 157.0, 60.0, 75.0, 93.0, 180.0, 129.0, 156.0, -8.0, 0.0, -51.0, -12.0, 148.0, 92.0, 167.0, -244.0, 33.0, 0.0, 104.0, 63.0, 0.0, 155.0, -18.0, 166.0, 55.0, 58.0, 0.0, 0.0, 163.0, -10.0, 71.0, 0.0, 122.0, 161.0, 0.0, -16.0, -16.0, 26.0, 101.0, 66.0, 29.0, -10.0, -63.0, 49.0, -126.0, 0.0, 113.0, 167.0, 60.0, -10.0, -6.0, 0.0, 0.0, 113.0, 183.0, 63.0, 68.0, 111.0, 0.0, 95.0, -49.0, 99.0, 187.0, -16.0, 44.0, 133.0, 0.0, 133.0, 0.0, 98.0, 0.0, 5.0, 101.0, -76.0, 76.0, 0.0, 200.0, 0.0, -35.0, 102.0, 194.0, 80.0, -18.0, 0.0, 0.0, -14.0, 115.0, 37.0, 0.0, 86.0, 143.0, 140.0, 0.0, -89.0, 44.0, 141.0, 0.0, 172.0, 83.0, 0.0, 183.0, -12.0, -49.0, 0.0, 71.0, 0.0, 166.0, 0.0, 120.0, -22.0, 174.0, 171.0, -2.0, 0.0, -82.0, 150.0, 0.0, 0.0, 0.0, 46.0, 167.0, 14.0, -8.0, 200.0, 184.0, 186.0, 200.0, 82.0, 0.0, 47.0, 129.0, -16.0, -86.0, 0.0, 79.0, -72.0, 194.0, 134.0, 0.0, 140.0, 0.0, 182.0, 0.0, 197.0, 152.0, 0.0, -6.0, -2.0, 19.0, 141.0, 0.0, 68.0, 182.0, 167.0, 192.0, 178.0, 156.0, 152.0, 156.0, 188.0, 185.0, 138.0, 44.0, 113.0, 112.0, 43.0, 80.0, -10.0, 0.0, 110.0, 89.0, 0.0, 137.0, 0.0, 96.0, 167.0, -4.0, -18.0, 0.0, 200.0, -8.0, 78.0, 82.0, -22.0, -6.0, -4.0], "policy_predator_policy_reward": [34.0, 24.0, 8.0, 0.0, 3.0, 45.0, 68.0, 51.0, 10.0, 9.0, 26.0, 12.0, 0.0, 0.0, 10.0, 10.0, 31.0, 17.0, 0.0, 0.0, 0.0, 17.0, 0.0, 4.0, 61.0, 44.0, 4.0, 6.0, 137.0, 55.0, 0.0, 0.0, 43.0, 0.0, 0.0, 10.0, 14.0, 35.0, 0.0, 12.0, 0.0, 0.0, 0.0, 5.0, 10.0, 1.0, 6.0, 0.0, 0.0, 14.0, 11.0, 7.0, 0.0, 4.0, 5.0, 0.0, 29.0, 44.0, 59.0, 8.0, 6.0, 7.0, 22.0, 14.0, 0.0, 3.0, 0.0, 0.0, 7.0, 0.0, 44.0, 0.0, 0.0, 20.0, 68.0, 83.0, 8.0, 0.0, 15.0, 6.0, 13.0, 3.0, 0.0, 0.0, 0.0, 0.0, 95.0, 81.0, 3.0, 11.0, 0.0, 0.0, 72.0, 42.0, 20.0, 29.0, 9.0, 0.0, 7.0, 0.0, 39.0, 34.0, 30.0, 0.0, 17.0, 0.0, 60.0, 48.0, 49.0, 0.0, 0.0, 0.0, 0.0, 35.0, 0.0, 6.0, 0.0, 56.0, 30.0, 27.0, 0.0, 0.0, 15.0, 19.0, 9.0, 2.0, 0.0, 1.0, 27.0, 54.0, 0.0, 0.0, 16.0, 0.0, 31.0, 22.0, 0.0, 4.0, 0.0, 3.0, 16.0, 26.0, 0.0, 0.0, 0.0, 8.0, 49.0, 39.0, 19.0, 79.0, 0.0, 2.0, 17.0, 0.0, 6.0, 0.0, 0.0, 1.0, 12.0, 2.0, 0.0, 4.0, 49.0, 16.0, 10.0, 43.0, 10.0, 9.0, 0.0, 0.0, 10.0, 8.0, 0.0, 4.0, 5.0, 12.0, 15.0, 13.0, 0.0, 23.0, 40.0, 10.0, 24.0, 16.0, 22.0, 26.0, 21.0, 0.0, 37.0, 15.0, 11.0, 0.0, 0.0, 0.0, 4.0, 31.0, 12.0, 32.0, 3.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4908539813554986, "mean_inference_ms": 4.266427282308463, "mean_action_processing_ms": 0.7013220313439618, "mean_env_wait_ms": 0.5223014752288087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005770683288574219, "StateBufferConnector_ms": 0.0033022165298461914, "ViewRequirementAgentConnector_ms": 0.14730417728424072}, "num_episodes": 18, "episode_return_max": 373.0, "episode_return_min": -59.0, "episode_return_mean": 152.94, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.8385229330935, "num_env_steps_trained_throughput_per_sec": 297.8385229330935, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 14556.54, "restore_workers_time_ms": 0.017, "training_step_time_ms": 14556.458, "sample_time_ms": 1681.399, "learn_time_ms": 12853.477, "learn_throughput": 311.2, "synch_weights_time_ms": 18.286}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 93, "trial_id": "f6b99_00000", "date": "2024-08-13_20-18-14", "timestamp": 1723594694, "time_this_iter_s": 13.477260112762451, "time_total_s": 1994.8902888298035, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3788b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1994.8902888298035, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 51.38947368421052, "ram_util_percent": 81.96315789473684}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0451583373720053, "cur_kl_coeff": 0.00625, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7716581387652292, "policy_loss": -0.006376729749152979, "vf_loss": 0.7780013730128607, "vf_explained_var": 0.016468274467205876, "kl": 0.0053593045351359855, "entropy": 0.18578727455445068, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9246784206105287, "cur_kl_coeff": 0.0052734375, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8904064817403359, "policy_loss": 0.0006440417743756105, "vf_loss": 1.889605066542903, "vf_explained_var": 0.8904047527325847, "kl": 0.029841653158823492, "entropy": 0.5709032502596971, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "env_runners": {"episode_reward_max": 391.0, "episode_reward_min": -59.0, "episode_reward_mean": 160.05, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -126.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 95.0}, "policy_reward_mean": {"prey_policy": 66.565, "predator_policy": 13.46}, "custom_metrics": {}, "hist_stats": {"episode_reward": [82.0, 289.0, -2.0, 28.0, 171.0, 24.0, 59.0, -59.0, 293.0, 86.0, -3.0, 113.0, 253.0, 223.0, 115.0, 201.0, 179.0, 198.0, 149.0, 98.0, 5.0, 201.0, 90.0, 200.0, 181.0, 323.0, -9.0, -7.0, 225.0, 116.0, 300.0, 19.0, 234.0, 172.0, 118.0, 177.0, 7.0, 128.0, 166.0, 132.0, 356.0, -1.0, 149.0, 0.0, 62.0, 234.0, 196.0, 373.0, 324.0, 47.0, 121.0, 2.0, 105.0, 330.0, 157.0, 188.0, 198.0, 166.0, -4.0, 225.0, 121.0, 368.0, 370.0, 326.0, 348.0, 340.0, 185.0, 178.0, 120.0, 150.0, 137.0, 158.0, 315.0, -11.0, 200.0, 105.0, 104.0, -7.0, 144.0, 84.0, 184.0, 314.0, 170.0, 391.0, 157.0, 55.0, 323.0, 258.0, 298.0, 27.0, -14.0, 360.0, 0.0, 70.0, 0.0, 166.0, 200.0, 358.0, 270.0, 180.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [71.0, 0.0, 122.0, 161.0, 0.0, -16.0, -16.0, 26.0, 101.0, 66.0, 29.0, -10.0, -63.0, 49.0, -126.0, 0.0, 113.0, 167.0, 60.0, -10.0, -6.0, 0.0, 0.0, 113.0, 183.0, 63.0, 68.0, 111.0, 0.0, 95.0, -49.0, 99.0, 187.0, -16.0, 44.0, 133.0, 0.0, 133.0, 0.0, 98.0, 0.0, 5.0, 101.0, -76.0, 76.0, 0.0, 200.0, 0.0, -35.0, 102.0, 194.0, 80.0, -18.0, 0.0, 0.0, -14.0, 115.0, 37.0, 0.0, 86.0, 143.0, 140.0, 0.0, -89.0, 44.0, 141.0, 0.0, 172.0, 83.0, 0.0, 183.0, -12.0, -49.0, 0.0, 71.0, 0.0, 166.0, 0.0, 120.0, -22.0, 174.0, 171.0, -2.0, 0.0, -82.0, 150.0, 0.0, 0.0, 0.0, 46.0, 167.0, 14.0, -8.0, 200.0, 184.0, 186.0, 200.0, 82.0, 0.0, 47.0, 129.0, -16.0, -86.0, 0.0, 79.0, -72.0, 194.0, 134.0, 0.0, 140.0, 0.0, 182.0, 0.0, 197.0, 152.0, 0.0, -6.0, -2.0, 19.0, 141.0, 0.0, 68.0, 182.0, 167.0, 192.0, 178.0, 156.0, 152.0, 156.0, 188.0, 185.0, 138.0, 44.0, 113.0, 112.0, 43.0, 80.0, -10.0, 0.0, 110.0, 89.0, 0.0, 137.0, 0.0, 96.0, 167.0, -4.0, -18.0, 0.0, 200.0, -8.0, 78.0, 82.0, -22.0, -6.0, -4.0, 140.0, 0.0, 18.0, 0.0, 193.0, -18.0, 173.0, 132.0, -4.0, 98.0, 199.0, 192.0, 149.0, 0.0, -2.0, 53.0, 147.0, 162.0, 63.0, 175.0, 54.0, 200.0, 34.0, -14.0, -12.0, -8.0, 182.0, 172.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 153.0, -4.0, 200.0, 0.0, 192.0, 164.0, 77.0, 164.0, 0.0, 180.0], "policy_predator_policy_reward": [10.0, 1.0, 6.0, 0.0, 0.0, 14.0, 11.0, 7.0, 0.0, 4.0, 5.0, 0.0, 29.0, 44.0, 59.0, 8.0, 6.0, 7.0, 22.0, 14.0, 0.0, 3.0, 0.0, 0.0, 7.0, 0.0, 44.0, 0.0, 0.0, 20.0, 68.0, 83.0, 8.0, 0.0, 15.0, 6.0, 13.0, 3.0, 0.0, 0.0, 0.0, 0.0, 95.0, 81.0, 3.0, 11.0, 0.0, 0.0, 72.0, 42.0, 20.0, 29.0, 9.0, 0.0, 7.0, 0.0, 39.0, 34.0, 30.0, 0.0, 17.0, 0.0, 60.0, 48.0, 49.0, 0.0, 0.0, 0.0, 0.0, 35.0, 0.0, 6.0, 0.0, 56.0, 30.0, 27.0, 0.0, 0.0, 15.0, 19.0, 9.0, 2.0, 0.0, 1.0, 27.0, 54.0, 0.0, 0.0, 16.0, 0.0, 31.0, 22.0, 0.0, 4.0, 0.0, 3.0, 16.0, 26.0, 0.0, 0.0, 0.0, 8.0, 49.0, 39.0, 19.0, 79.0, 0.0, 2.0, 17.0, 0.0, 6.0, 0.0, 0.0, 1.0, 12.0, 2.0, 0.0, 4.0, 49.0, 16.0, 10.0, 43.0, 10.0, 9.0, 0.0, 0.0, 10.0, 8.0, 0.0, 4.0, 5.0, 12.0, 15.0, 13.0, 0.0, 23.0, 40.0, 10.0, 24.0, 16.0, 22.0, 26.0, 21.0, 0.0, 37.0, 15.0, 11.0, 0.0, 0.0, 0.0, 4.0, 31.0, 12.0, 32.0, 3.0, 0.0, 0.0, 4.0, 33.0, 33.0, 9.0, 0.0, 8.0, 1.0, 8.0, 68.0, 0.0, 0.0, 8.0, 0.0, 0.0, 4.0, 0.0, 14.0, 2.0, 18.0, 28.0, 16.0, 7.0, 0.0, 6.0, 0.0, 6.0, 0.0, 0.0, 0.0, 16.0, 24.0, 0.0, 0.0, 2.0, 15.0, 0.0, 0.0, 2.0, 0.0, 17.0, 12.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4815677371309517, "mean_inference_ms": 4.241456392017437, "mean_action_processing_ms": 0.6964058268151456, "mean_env_wait_ms": 0.5189504539130536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008644819259643555, "StateBufferConnector_ms": 0.004226207733154297, "ViewRequirementAgentConnector_ms": 0.13380050659179688}, "num_episodes": 22, "episode_return_max": 391.0, "episode_return_min": -59.0, "episode_return_mean": 160.05, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 220.61410776246984, "num_env_steps_trained_throughput_per_sec": 220.61410776246984, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1504000, "timers": {"training_iteration_time_ms": 14855.795, "restore_workers_time_ms": 0.017, "training_step_time_ms": 14855.69, "sample_time_ms": 1664.49, "learn_time_ms": 13168.727, "learn_throughput": 303.75, "synch_weights_time_ms": 19.308}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "done": false, "training_iteration": 94, "trial_id": "f6b99_00000", "date": "2024-08-13_20-18-32", "timestamp": 1723594712, "time_this_iter_s": 18.189109086990356, "time_total_s": 2013.0793979167938, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b60a7550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2013.0793979167938, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 78.5423076923077, "ram_util_percent": 83.3153846153846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3611496668959422, "cur_kl_coeff": 0.00625, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0307162078757766, "policy_loss": -0.002487165272413265, "vf_loss": 1.0331790823469718, "vf_explained_var": 0.009353410882293862, "kl": 0.003887072328697883, "entropy": 0.1610735359054709, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4114977504210495, "cur_kl_coeff": 0.007910156249999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8153134614071518, "policy_loss": -0.003747669088028411, "vf_loss": 1.8189986064951256, "vf_explained_var": 0.604545500637993, "kl": 0.007904055798821207, "entropy": 0.6220737623789954, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 391.0, "episode_reward_min": -14.0, "episode_reward_mean": 178.34, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -89.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 95.0}, "policy_reward_mean": {"prey_policy": 76.35, "predator_policy": 12.82}, "custom_metrics": {}, "hist_stats": {"episode_reward": [149.0, 98.0, 5.0, 201.0, 90.0, 200.0, 181.0, 323.0, -9.0, -7.0, 225.0, 116.0, 300.0, 19.0, 234.0, 172.0, 118.0, 177.0, 7.0, 128.0, 166.0, 132.0, 356.0, -1.0, 149.0, 0.0, 62.0, 234.0, 196.0, 373.0, 324.0, 47.0, 121.0, 2.0, 105.0, 330.0, 157.0, 188.0, 198.0, 166.0, -4.0, 225.0, 121.0, 368.0, 370.0, 326.0, 348.0, 340.0, 185.0, 178.0, 120.0, 150.0, 137.0, 158.0, 315.0, -11.0, 200.0, 105.0, 104.0, -7.0, 144.0, 84.0, 184.0, 314.0, 170.0, 391.0, 157.0, 55.0, 323.0, 258.0, 298.0, 27.0, -14.0, 360.0, 0.0, 70.0, 0.0, 166.0, 200.0, 358.0, 270.0, 180.0, 356.0, 321.0, 345.0, 277.0, 129.0, 182.0, 332.0, 234.0, 177.0, 360.0, 164.0, 356.0, 0.0, 106.0, 0.0, 0.0, 355.0, 385.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 133.0, 0.0, 98.0, 0.0, 5.0, 101.0, -76.0, 76.0, 0.0, 200.0, 0.0, -35.0, 102.0, 194.0, 80.0, -18.0, 0.0, 0.0, -14.0, 115.0, 37.0, 0.0, 86.0, 143.0, 140.0, 0.0, -89.0, 44.0, 141.0, 0.0, 172.0, 83.0, 0.0, 183.0, -12.0, -49.0, 0.0, 71.0, 0.0, 166.0, 0.0, 120.0, -22.0, 174.0, 171.0, -2.0, 0.0, -82.0, 150.0, 0.0, 0.0, 0.0, 46.0, 167.0, 14.0, -8.0, 200.0, 184.0, 186.0, 200.0, 82.0, 0.0, 47.0, 129.0, -16.0, -86.0, 0.0, 79.0, -72.0, 194.0, 134.0, 0.0, 140.0, 0.0, 182.0, 0.0, 197.0, 152.0, 0.0, -6.0, -2.0, 19.0, 141.0, 0.0, 68.0, 182.0, 167.0, 192.0, 178.0, 156.0, 152.0, 156.0, 188.0, 185.0, 138.0, 44.0, 113.0, 112.0, 43.0, 80.0, -10.0, 0.0, 110.0, 89.0, 0.0, 137.0, 0.0, 96.0, 167.0, -4.0, -18.0, 0.0, 200.0, -8.0, 78.0, 82.0, -22.0, -6.0, -4.0, 140.0, 0.0, 18.0, 0.0, 193.0, -18.0, 173.0, 132.0, -4.0, 98.0, 199.0, 192.0, 149.0, 0.0, -2.0, 53.0, 147.0, 162.0, 63.0, 175.0, 54.0, 200.0, 34.0, -14.0, -12.0, -8.0, 182.0, 172.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 153.0, -4.0, 200.0, 0.0, 192.0, 164.0, 77.0, 164.0, 0.0, 180.0, 113.0, 197.0, 113.0, 172.0, 158.0, 176.0, 65.0, 152.0, 103.0, 0.0, 173.0, 0.0, 159.0, 160.0, 64.0, 113.0, 178.0, -2.0, 189.0, 155.0, 159.0, -6.0, 164.0, 170.0, 0.0, 0.0, 59.0, 0.0, 0.0, 0.0, 0.0, 0.0, 152.0, 185.0, 200.0, 185.0], "policy_predator_policy_reward": [13.0, 3.0, 0.0, 0.0, 0.0, 0.0, 95.0, 81.0, 3.0, 11.0, 0.0, 0.0, 72.0, 42.0, 20.0, 29.0, 9.0, 0.0, 7.0, 0.0, 39.0, 34.0, 30.0, 0.0, 17.0, 0.0, 60.0, 48.0, 49.0, 0.0, 0.0, 0.0, 0.0, 35.0, 0.0, 6.0, 0.0, 56.0, 30.0, 27.0, 0.0, 0.0, 15.0, 19.0, 9.0, 2.0, 0.0, 1.0, 27.0, 54.0, 0.0, 0.0, 16.0, 0.0, 31.0, 22.0, 0.0, 4.0, 0.0, 3.0, 16.0, 26.0, 0.0, 0.0, 0.0, 8.0, 49.0, 39.0, 19.0, 79.0, 0.0, 2.0, 17.0, 0.0, 6.0, 0.0, 0.0, 1.0, 12.0, 2.0, 0.0, 4.0, 49.0, 16.0, 10.0, 43.0, 10.0, 9.0, 0.0, 0.0, 10.0, 8.0, 0.0, 4.0, 5.0, 12.0, 15.0, 13.0, 0.0, 23.0, 40.0, 10.0, 24.0, 16.0, 22.0, 26.0, 21.0, 0.0, 37.0, 15.0, 11.0, 0.0, 0.0, 0.0, 4.0, 31.0, 12.0, 32.0, 3.0, 0.0, 0.0, 4.0, 33.0, 33.0, 9.0, 0.0, 8.0, 1.0, 8.0, 68.0, 0.0, 0.0, 8.0, 0.0, 0.0, 4.0, 0.0, 14.0, 2.0, 18.0, 28.0, 16.0, 7.0, 0.0, 6.0, 0.0, 6.0, 0.0, 0.0, 0.0, 16.0, 24.0, 0.0, 0.0, 2.0, 15.0, 0.0, 0.0, 2.0, 0.0, 17.0, 12.0, 0.0, 0.0, 29.0, 17.0, 15.0, 21.0, 2.0, 9.0, 45.0, 15.0, 17.0, 9.0, 9.0, 0.0, 0.0, 13.0, 12.0, 45.0, 0.0, 1.0, 1.0, 15.0, 3.0, 8.0, 10.0, 12.0, 0.0, 0.0, 47.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.47424783857833, "mean_inference_ms": 4.222476290410586, "mean_action_processing_ms": 0.692654284406265, "mean_env_wait_ms": 0.5163935726503643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009779214859008789, "StateBufferConnector_ms": 0.004493236541748047, "ViewRequirementAgentConnector_ms": 0.1369870901107788}, "num_episodes": 18, "episode_return_max": 391.0, "episode_return_min": -14.0, "episode_return_mean": 178.34, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 259.2130136513903, "num_env_steps_trained_throughput_per_sec": 259.2130136513903, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 14968.237, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14968.138, "sample_time_ms": 1736.233, "learn_time_ms": 13209.326, "learn_throughput": 302.816, "synch_weights_time_ms": 19.33}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 95, "trial_id": "f6b99_00000", "date": "2024-08-13_20-18-48", "timestamp": 1723594728, "time_this_iter_s": 15.471418142318726, "time_total_s": 2028.5508160591125, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b62a7790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2028.5508160591125, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 59.49545454545455, "ram_util_percent": 83.86818181818181}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5887186537028621, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8365774788553753, "policy_loss": -0.0035492067373106406, "vf_loss": 0.8401005184997327, "vf_explained_var": 0.0899521633746132, "kl": 0.008372837353611521, "entropy": 0.20362914064652704, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.518776481807547, "cur_kl_coeff": 0.007910156249999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4051063913674582, "policy_loss": -0.007451815872389094, "vf_loss": 1.412501991741241, "vf_explained_var": 0.9507456248714811, "kl": 0.007106382621002285, "entropy": 0.5299086891469501, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 391.0, "episode_reward_min": -374.0, "episode_reward_mean": 191.17, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -290.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 161.0}, "policy_reward_mean": {"prey_policy": 83.57, "predator_policy": 12.015}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 149.0, 0.0, 62.0, 234.0, 196.0, 373.0, 324.0, 47.0, 121.0, 2.0, 105.0, 330.0, 157.0, 188.0, 198.0, 166.0, -4.0, 225.0, 121.0, 368.0, 370.0, 326.0, 348.0, 340.0, 185.0, 178.0, 120.0, 150.0, 137.0, 158.0, 315.0, -11.0, 200.0, 105.0, 104.0, -7.0, 144.0, 84.0, 184.0, 314.0, 170.0, 391.0, 157.0, 55.0, 323.0, 258.0, 298.0, 27.0, -14.0, 360.0, 0.0, 70.0, 0.0, 166.0, 200.0, 358.0, 270.0, 180.0, 356.0, 321.0, 345.0, 277.0, 129.0, 182.0, 332.0, 234.0, 177.0, 360.0, 164.0, 356.0, 0.0, 106.0, 0.0, 0.0, 355.0, 385.0, 335.0, 189.0, 157.0, 272.0, 386.0, 167.0, 354.0, 300.0, 164.0, 156.0, 317.0, 76.0, 200.0, 113.0, 193.0, 179.0, 281.0, -374.0, 346.0, 182.0, 198.0, 312.0, 161.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.0, 0.0, -82.0, 150.0, 0.0, 0.0, 0.0, 46.0, 167.0, 14.0, -8.0, 200.0, 184.0, 186.0, 200.0, 82.0, 0.0, 47.0, 129.0, -16.0, -86.0, 0.0, 79.0, -72.0, 194.0, 134.0, 0.0, 140.0, 0.0, 182.0, 0.0, 197.0, 152.0, 0.0, -6.0, -2.0, 19.0, 141.0, 0.0, 68.0, 182.0, 167.0, 192.0, 178.0, 156.0, 152.0, 156.0, 188.0, 185.0, 138.0, 44.0, 113.0, 112.0, 43.0, 80.0, -10.0, 0.0, 110.0, 89.0, 0.0, 137.0, 0.0, 96.0, 167.0, -4.0, -18.0, 0.0, 200.0, -8.0, 78.0, 82.0, -22.0, -6.0, -4.0, 140.0, 0.0, 18.0, 0.0, 193.0, -18.0, 173.0, 132.0, -4.0, 98.0, 199.0, 192.0, 149.0, 0.0, -2.0, 53.0, 147.0, 162.0, 63.0, 175.0, 54.0, 200.0, 34.0, -14.0, -12.0, -8.0, 182.0, 172.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 153.0, -4.0, 200.0, 0.0, 192.0, 164.0, 77.0, 164.0, 0.0, 180.0, 113.0, 197.0, 113.0, 172.0, 158.0, 176.0, 65.0, 152.0, 103.0, 0.0, 173.0, 0.0, 159.0, 160.0, 64.0, 113.0, 178.0, -2.0, 189.0, 155.0, 159.0, -6.0, 164.0, 170.0, 0.0, 0.0, 59.0, 0.0, 0.0, 0.0, 0.0, 0.0, 152.0, 185.0, 200.0, 185.0, 156.0, 155.0, 189.0, 0.0, 122.0, 0.0, 126.0, 97.0, 198.0, 188.0, 0.0, 151.0, 140.0, 194.0, 107.0, 161.0, 0.0, 146.0, 159.0, -10.0, 159.0, 128.0, 0.0, 17.0, 200.0, 0.0, 72.0, 0.0, -14.0, 200.0, 175.0, 0.0, 179.0, 47.0, -289.0, -290.0, 174.0, 147.0, 173.0, 0.0, 0.0, 198.0, 167.0, 100.0, 142.0, 0.0], "policy_predator_policy_reward": [0.0, 1.0, 27.0, 54.0, 0.0, 0.0, 16.0, 0.0, 31.0, 22.0, 0.0, 4.0, 0.0, 3.0, 16.0, 26.0, 0.0, 0.0, 0.0, 8.0, 49.0, 39.0, 19.0, 79.0, 0.0, 2.0, 17.0, 0.0, 6.0, 0.0, 0.0, 1.0, 12.0, 2.0, 0.0, 4.0, 49.0, 16.0, 10.0, 43.0, 10.0, 9.0, 0.0, 0.0, 10.0, 8.0, 0.0, 4.0, 5.0, 12.0, 15.0, 13.0, 0.0, 23.0, 40.0, 10.0, 24.0, 16.0, 22.0, 26.0, 21.0, 0.0, 37.0, 15.0, 11.0, 0.0, 0.0, 0.0, 4.0, 31.0, 12.0, 32.0, 3.0, 0.0, 0.0, 4.0, 33.0, 33.0, 9.0, 0.0, 8.0, 1.0, 8.0, 68.0, 0.0, 0.0, 8.0, 0.0, 0.0, 4.0, 0.0, 14.0, 2.0, 18.0, 28.0, 16.0, 7.0, 0.0, 6.0, 0.0, 6.0, 0.0, 0.0, 0.0, 16.0, 24.0, 0.0, 0.0, 2.0, 15.0, 0.0, 0.0, 2.0, 0.0, 17.0, 12.0, 0.0, 0.0, 29.0, 17.0, 15.0, 21.0, 2.0, 9.0, 45.0, 15.0, 17.0, 9.0, 9.0, 0.0, 0.0, 13.0, 12.0, 45.0, 0.0, 1.0, 1.0, 15.0, 3.0, 8.0, 10.0, 12.0, 0.0, 0.0, 47.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 0.0, 0.0, 24.0, 0.0, 0.0, 0.0, 12.0, 23.0, 36.0, 13.0, 0.0, 0.0, 10.0, 6.0, 2.0, 18.0, 24.0, 8.0, 18.0, 0.0, 7.0, 0.0, 0.0, 30.0, 1.0, 58.0, 0.0, 0.0, 18.0, 23.0, 0.0, 7.0, 4.0, 0.0, 42.0, 13.0, 44.0, 161.0, 8.0, 17.0, 9.0, 0.0, 0.0, 0.0, 29.0, 16.0, 0.0, 19.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4651656925285068, "mean_inference_ms": 4.198980143333602, "mean_action_processing_ms": 0.6879027141391301, "mean_env_wait_ms": 0.5131378432306896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009240388870239258, "StateBufferConnector_ms": 0.004424929618835449, "ViewRequirementAgentConnector_ms": 0.1289290189743042}, "num_episodes": 23, "episode_return_max": 391.0, "episode_return_min": -374.0, "episode_return_mean": 191.17, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 284.48743415833627, "num_env_steps_trained_throughput_per_sec": 284.48743415833627, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 14969.765, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14969.666, "sample_time_ms": 1712.297, "learn_time_ms": 13234.827, "learn_throughput": 302.233, "synch_weights_time_ms": 19.227}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 96, "trial_id": "f6b99_00000", "date": "2024-08-13_20-19-02", "timestamp": 1723594742, "time_this_iter_s": 14.097641944885254, "time_total_s": 2042.6484580039978, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3788b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2042.6484580039978, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 54.49000000000001, "ram_util_percent": 83.835}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5088824663843428, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9956854423044851, "policy_loss": -0.0046608439384264845, "vf_loss": 1.0003327099892196, "vf_explained_var": 0.0726303830033257, "kl": 0.004343746958789269, "entropy": 0.1933778950028003, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6685244270260373, "cur_kl_coeff": 0.007910156249999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7185078239945508, "policy_loss": -0.00318609225174422, "vf_loss": 1.721662218703164, "vf_explained_var": 0.808563686930944, "kl": 0.004007829490439141, "entropy": 0.4834331024576117, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "env_runners": {"episode_reward_max": 391.0, "episode_reward_min": -374.0, "episode_reward_mean": 203.68, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -290.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 161.0}, "policy_reward_mean": {"prey_policy": 90.865, "predator_policy": 10.975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [225.0, 121.0, 368.0, 370.0, 326.0, 348.0, 340.0, 185.0, 178.0, 120.0, 150.0, 137.0, 158.0, 315.0, -11.0, 200.0, 105.0, 104.0, -7.0, 144.0, 84.0, 184.0, 314.0, 170.0, 391.0, 157.0, 55.0, 323.0, 258.0, 298.0, 27.0, -14.0, 360.0, 0.0, 70.0, 0.0, 166.0, 200.0, 358.0, 270.0, 180.0, 356.0, 321.0, 345.0, 277.0, 129.0, 182.0, 332.0, 234.0, 177.0, 360.0, 164.0, 356.0, 0.0, 106.0, 0.0, 0.0, 355.0, 385.0, 335.0, 189.0, 157.0, 272.0, 386.0, 167.0, 354.0, 300.0, 164.0, 156.0, 317.0, 76.0, 200.0, 113.0, 193.0, 179.0, 281.0, -374.0, 346.0, 182.0, 198.0, 312.0, 161.0, 381.0, 298.0, 191.0, 359.0, 347.0, 205.0, 168.0, 200.0, 174.0, 316.0, -1.0, 125.0, 199.0, 146.0, 177.0, 0.0, 230.0, 383.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [19.0, 141.0, 0.0, 68.0, 182.0, 167.0, 192.0, 178.0, 156.0, 152.0, 156.0, 188.0, 185.0, 138.0, 44.0, 113.0, 112.0, 43.0, 80.0, -10.0, 0.0, 110.0, 89.0, 0.0, 137.0, 0.0, 96.0, 167.0, -4.0, -18.0, 0.0, 200.0, -8.0, 78.0, 82.0, -22.0, -6.0, -4.0, 140.0, 0.0, 18.0, 0.0, 193.0, -18.0, 173.0, 132.0, -4.0, 98.0, 199.0, 192.0, 149.0, 0.0, -2.0, 53.0, 147.0, 162.0, 63.0, 175.0, 54.0, 200.0, 34.0, -14.0, -12.0, -8.0, 182.0, 172.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 153.0, -4.0, 200.0, 0.0, 192.0, 164.0, 77.0, 164.0, 0.0, 180.0, 113.0, 197.0, 113.0, 172.0, 158.0, 176.0, 65.0, 152.0, 103.0, 0.0, 173.0, 0.0, 159.0, 160.0, 64.0, 113.0, 178.0, -2.0, 189.0, 155.0, 159.0, -6.0, 164.0, 170.0, 0.0, 0.0, 59.0, 0.0, 0.0, 0.0, 0.0, 0.0, 152.0, 185.0, 200.0, 185.0, 156.0, 155.0, 189.0, 0.0, 122.0, 0.0, 126.0, 97.0, 198.0, 188.0, 0.0, 151.0, 140.0, 194.0, 107.0, 161.0, 0.0, 146.0, 159.0, -10.0, 159.0, 128.0, 0.0, 17.0, 200.0, 0.0, 72.0, 0.0, -14.0, 200.0, 175.0, 0.0, 179.0, 47.0, -289.0, -290.0, 174.0, 147.0, 173.0, 0.0, 0.0, 198.0, 167.0, 100.0, 142.0, 0.0, 185.0, 196.0, 149.0, 108.0, -14.0, 197.0, 168.0, 165.0, 158.0, 188.0, 142.0, 43.0, 169.0, -4.0, 200.0, 0.0, 0.0, 166.0, 194.0, 53.0, -2.0, 0.0, 137.0, -24.0, 200.0, -2.0, 146.0, 0.0, 0.0, 168.0, 0.0, 0.0, 15.0, 200.0, 167.0, 200.0], "policy_predator_policy_reward": [49.0, 16.0, 10.0, 43.0, 10.0, 9.0, 0.0, 0.0, 10.0, 8.0, 0.0, 4.0, 5.0, 12.0, 15.0, 13.0, 0.0, 23.0, 40.0, 10.0, 24.0, 16.0, 22.0, 26.0, 21.0, 0.0, 37.0, 15.0, 11.0, 0.0, 0.0, 0.0, 4.0, 31.0, 12.0, 32.0, 3.0, 0.0, 0.0, 4.0, 33.0, 33.0, 9.0, 0.0, 8.0, 1.0, 8.0, 68.0, 0.0, 0.0, 8.0, 0.0, 0.0, 4.0, 0.0, 14.0, 2.0, 18.0, 28.0, 16.0, 7.0, 0.0, 6.0, 0.0, 6.0, 0.0, 0.0, 0.0, 16.0, 24.0, 0.0, 0.0, 2.0, 15.0, 0.0, 0.0, 2.0, 0.0, 17.0, 12.0, 0.0, 0.0, 29.0, 17.0, 15.0, 21.0, 2.0, 9.0, 45.0, 15.0, 17.0, 9.0, 9.0, 0.0, 0.0, 13.0, 12.0, 45.0, 0.0, 1.0, 1.0, 15.0, 3.0, 8.0, 10.0, 12.0, 0.0, 0.0, 47.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 0.0, 0.0, 24.0, 0.0, 0.0, 0.0, 12.0, 23.0, 36.0, 13.0, 0.0, 0.0, 10.0, 6.0, 2.0, 18.0, 24.0, 8.0, 18.0, 0.0, 7.0, 0.0, 0.0, 30.0, 1.0, 58.0, 0.0, 0.0, 18.0, 23.0, 0.0, 7.0, 4.0, 0.0, 42.0, 13.0, 44.0, 161.0, 8.0, 17.0, 9.0, 0.0, 0.0, 0.0, 29.0, 16.0, 0.0, 19.0, 0.0, 0.0, 7.0, 34.0, 7.0, 1.0, 20.0, 6.0, 1.0, 0.0, 13.0, 7.0, 0.0, 3.0, 0.0, 0.0, 0.0, 8.0, 30.0, 39.0, 0.0, 1.0, 0.0, 12.0, 0.0, 1.0, 0.0, 0.0, 3.0, 6.0, 0.0, 0.0, 15.0, 0.0, 9.0, 7.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4597227050904946, "mean_inference_ms": 4.185641421436122, "mean_action_processing_ms": 0.6848441282100481, "mean_env_wait_ms": 0.5114413374301879, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009064078330993652, "StateBufferConnector_ms": 0.004468083381652832, "ViewRequirementAgentConnector_ms": 0.13849866390228271}, "num_episodes": 18, "episode_return_max": 391.0, "episode_return_min": -374.0, "episode_return_mean": 203.68, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 214.68504885490347, "num_env_steps_trained_throughput_per_sec": 214.68504885490347, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 1552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1552000, "timers": {"training_iteration_time_ms": 15412.048, "restore_workers_time_ms": 0.016, "training_step_time_ms": 15411.957, "sample_time_ms": 1939.299, "learn_time_ms": 13450.284, "learn_throughput": 297.391, "synch_weights_time_ms": 18.483}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "done": false, "training_iteration": 97, "trial_id": "f6b99_00000", "date": "2024-08-13_20-19-21", "timestamp": 1723594761, "time_this_iter_s": 18.68218183517456, "time_total_s": 2061.3306398391724, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b379dd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2061.3306398391724, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 69.86538461538463, "ram_util_percent": 83.97307692307692}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7281468538064806, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.848953115908557, "policy_loss": -0.005444359807199034, "vf_loss": 1.854366150041106, "vf_explained_var": 0.0349619432101174, "kl": 0.020048217805572463, "entropy": 0.33068027337865225, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2009734372770975, "cur_kl_coeff": 0.003955078124999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4203256126434085, "policy_loss": -0.004188681435377076, "vf_loss": 2.4244938680734585, "vf_explained_var": 0.4110608676438609, "kl": 0.005166671218407756, "entropy": 0.5317262715132779, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "env_runners": {"episode_reward_max": 391.0, "episode_reward_min": -374.0, "episode_reward_mean": 198.47, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -328.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 179.0}, "policy_reward_mean": {"prey_policy": 86.425, "predator_policy": 12.81}, "custom_metrics": {}, "hist_stats": {"episode_reward": [314.0, 170.0, 391.0, 157.0, 55.0, 323.0, 258.0, 298.0, 27.0, -14.0, 360.0, 0.0, 70.0, 0.0, 166.0, 200.0, 358.0, 270.0, 180.0, 356.0, 321.0, 345.0, 277.0, 129.0, 182.0, 332.0, 234.0, 177.0, 360.0, 164.0, 356.0, 0.0, 106.0, 0.0, 0.0, 355.0, 385.0, 335.0, 189.0, 157.0, 272.0, 386.0, 167.0, 354.0, 300.0, 164.0, 156.0, 317.0, 76.0, 200.0, 113.0, 193.0, 179.0, 281.0, -374.0, 346.0, 182.0, 198.0, 312.0, 161.0, 381.0, 298.0, 191.0, 359.0, 347.0, 205.0, 168.0, 200.0, 174.0, 316.0, -1.0, 125.0, 199.0, 146.0, 177.0, 0.0, 230.0, 383.0, 387.0, 271.0, 200.0, 202.0, -155.0, 255.0, 214.0, 141.0, 162.0, 353.0, 0.0, 0.0, 380.0, -103.0, 174.0, -5.0, 163.0, 274.0, 181.0, 350.0, 99.0, 80.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [173.0, 132.0, -4.0, 98.0, 199.0, 192.0, 149.0, 0.0, -2.0, 53.0, 147.0, 162.0, 63.0, 175.0, 54.0, 200.0, 34.0, -14.0, -12.0, -8.0, 182.0, 172.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 153.0, -4.0, 200.0, 0.0, 192.0, 164.0, 77.0, 164.0, 0.0, 180.0, 113.0, 197.0, 113.0, 172.0, 158.0, 176.0, 65.0, 152.0, 103.0, 0.0, 173.0, 0.0, 159.0, 160.0, 64.0, 113.0, 178.0, -2.0, 189.0, 155.0, 159.0, -6.0, 164.0, 170.0, 0.0, 0.0, 59.0, 0.0, 0.0, 0.0, 0.0, 0.0, 152.0, 185.0, 200.0, 185.0, 156.0, 155.0, 189.0, 0.0, 122.0, 0.0, 126.0, 97.0, 198.0, 188.0, 0.0, 151.0, 140.0, 194.0, 107.0, 161.0, 0.0, 146.0, 159.0, -10.0, 159.0, 128.0, 0.0, 17.0, 200.0, 0.0, 72.0, 0.0, -14.0, 200.0, 175.0, 0.0, 179.0, 47.0, -289.0, -290.0, 174.0, 147.0, 173.0, 0.0, 0.0, 198.0, 167.0, 100.0, 142.0, 0.0, 185.0, 196.0, 149.0, 108.0, -14.0, 197.0, 168.0, 165.0, 158.0, 188.0, 142.0, 43.0, 169.0, -4.0, 200.0, 0.0, 0.0, 166.0, 194.0, 53.0, -2.0, 0.0, 137.0, -24.0, 200.0, -2.0, 146.0, 0.0, 0.0, 168.0, 0.0, 0.0, 15.0, 200.0, 167.0, 200.0, 194.0, 193.0, 134.0, 100.0, 0.0, 200.0, 153.0, -34.0, -328.0, -6.0, 177.0, 25.0, 178.0, -46.0, 116.0, -6.0, 155.0, -16.0, 113.0, 200.0, 0.0, 0.0, 0.0, 0.0, 198.0, 173.0, -205.0, -16.0, 165.0, 0.0, 0.0, -10.0, 0.0, 144.0, 68.0, 143.0, -6.0, 176.0, 157.0, 186.0, 161.0, -210.0, 20.0, 0.0], "policy_predator_policy_reward": [8.0, 1.0, 8.0, 68.0, 0.0, 0.0, 8.0, 0.0, 0.0, 4.0, 0.0, 14.0, 2.0, 18.0, 28.0, 16.0, 7.0, 0.0, 6.0, 0.0, 6.0, 0.0, 0.0, 0.0, 16.0, 24.0, 0.0, 0.0, 2.0, 15.0, 0.0, 0.0, 2.0, 0.0, 17.0, 12.0, 0.0, 0.0, 29.0, 17.0, 15.0, 21.0, 2.0, 9.0, 45.0, 15.0, 17.0, 9.0, 9.0, 0.0, 0.0, 13.0, 12.0, 45.0, 0.0, 1.0, 1.0, 15.0, 3.0, 8.0, 10.0, 12.0, 0.0, 0.0, 47.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 0.0, 0.0, 24.0, 0.0, 0.0, 0.0, 12.0, 23.0, 36.0, 13.0, 0.0, 0.0, 10.0, 6.0, 2.0, 18.0, 24.0, 8.0, 18.0, 0.0, 7.0, 0.0, 0.0, 30.0, 1.0, 58.0, 0.0, 0.0, 18.0, 23.0, 0.0, 7.0, 4.0, 0.0, 42.0, 13.0, 44.0, 161.0, 8.0, 17.0, 9.0, 0.0, 0.0, 0.0, 29.0, 16.0, 0.0, 19.0, 0.0, 0.0, 7.0, 34.0, 7.0, 1.0, 20.0, 6.0, 1.0, 0.0, 13.0, 7.0, 0.0, 3.0, 0.0, 0.0, 0.0, 8.0, 30.0, 39.0, 0.0, 1.0, 0.0, 12.0, 0.0, 1.0, 0.0, 0.0, 3.0, 6.0, 0.0, 0.0, 15.0, 0.0, 9.0, 7.0, 0.0, 0.0, 37.0, 0.0, 0.0, 0.0, 78.0, 5.0, 179.0, 0.0, 7.0, 46.0, 82.0, 0.0, 3.0, 28.0, 17.0, 6.0, 17.0, 23.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 10.0, 108.0, 0.0, 9.0, 5.0, 0.0, 6.0, 13.0, 17.0, 46.0, 11.0, 0.0, 7.0, 0.0, 12.0, 136.0, 60.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4609675590756057, "mean_inference_ms": 4.191960568313536, "mean_action_processing_ms": 0.6866124831721068, "mean_env_wait_ms": 0.5127799056298288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008595943450927734, "StateBufferConnector_ms": 0.008957624435424805, "ViewRequirementAgentConnector_ms": 0.1700444221496582}, "num_episodes": 22, "episode_return_max": 391.0, "episode_return_min": -374.0, "episode_return_mean": 198.47, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 244.45278752509245, "num_env_steps_trained_throughput_per_sec": 244.45278752509245, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 1568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1568000, "timers": {"training_iteration_time_ms": 15741.112, "restore_workers_time_ms": 0.016, "training_step_time_ms": 15741.022, "sample_time_ms": 2158.718, "learn_time_ms": 13559.939, "learn_throughput": 294.987, "synch_weights_time_ms": 18.656}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "done": false, "training_iteration": 98, "trial_id": "f6b99_00000", "date": "2024-08-13_20-19-37", "timestamp": 1723594777, "time_this_iter_s": 16.424015045166016, "time_total_s": 2077.7546548843384, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6087c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2077.7546548843384, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 59.44782608695652, "ram_util_percent": 83.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9906178703699162, "cur_kl_coeff": 0.0023437499999999995, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.006462547640321, "policy_loss": -0.005285123319034933, "vf_loss": 3.011722758396593, "vf_explained_var": 0.03906473284045225, "kl": 0.01063101586119763, "entropy": 0.5599164114900367, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6841535651809956, "cur_kl_coeff": 0.003955078124999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4348043528814163, "policy_loss": -0.004577060304729948, "vf_loss": 3.439349738882963, "vf_explained_var": 0.33795452436442097, "kl": 0.00800827113959337, "entropy": 0.5836051655667168, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 387.0, "episode_reward_min": -374.0, "episode_reward_mean": 201.38, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -328.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 179.0}, "policy_reward_mean": {"prey_policy": 84.705, "predator_policy": 15.985}, "custom_metrics": {}, "hist_stats": {"episode_reward": [180.0, 356.0, 321.0, 345.0, 277.0, 129.0, 182.0, 332.0, 234.0, 177.0, 360.0, 164.0, 356.0, 0.0, 106.0, 0.0, 0.0, 355.0, 385.0, 335.0, 189.0, 157.0, 272.0, 386.0, 167.0, 354.0, 300.0, 164.0, 156.0, 317.0, 76.0, 200.0, 113.0, 193.0, 179.0, 281.0, -374.0, 346.0, 182.0, 198.0, 312.0, 161.0, 381.0, 298.0, 191.0, 359.0, 347.0, 205.0, 168.0, 200.0, 174.0, 316.0, -1.0, 125.0, 199.0, 146.0, 177.0, 0.0, 230.0, 383.0, 387.0, 271.0, 200.0, 202.0, -155.0, 255.0, 214.0, 141.0, 162.0, 353.0, 0.0, 0.0, 380.0, -103.0, 174.0, -5.0, 163.0, 274.0, 181.0, 350.0, 99.0, 80.0, 317.0, 359.0, 168.0, 306.0, 0.0, 145.0, 162.0, 298.0, 222.0, 302.0, 371.0, 253.0, 158.0, -84.0, 190.0, 188.0, 180.0, 159.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 180.0, 113.0, 197.0, 113.0, 172.0, 158.0, 176.0, 65.0, 152.0, 103.0, 0.0, 173.0, 0.0, 159.0, 160.0, 64.0, 113.0, 178.0, -2.0, 189.0, 155.0, 159.0, -6.0, 164.0, 170.0, 0.0, 0.0, 59.0, 0.0, 0.0, 0.0, 0.0, 0.0, 152.0, 185.0, 200.0, 185.0, 156.0, 155.0, 189.0, 0.0, 122.0, 0.0, 126.0, 97.0, 198.0, 188.0, 0.0, 151.0, 140.0, 194.0, 107.0, 161.0, 0.0, 146.0, 159.0, -10.0, 159.0, 128.0, 0.0, 17.0, 200.0, 0.0, 72.0, 0.0, -14.0, 200.0, 175.0, 0.0, 179.0, 47.0, -289.0, -290.0, 174.0, 147.0, 173.0, 0.0, 0.0, 198.0, 167.0, 100.0, 142.0, 0.0, 185.0, 196.0, 149.0, 108.0, -14.0, 197.0, 168.0, 165.0, 158.0, 188.0, 142.0, 43.0, 169.0, -4.0, 200.0, 0.0, 0.0, 166.0, 194.0, 53.0, -2.0, 0.0, 137.0, -24.0, 200.0, -2.0, 146.0, 0.0, 0.0, 168.0, 0.0, 0.0, 15.0, 200.0, 167.0, 200.0, 194.0, 193.0, 134.0, 100.0, 0.0, 200.0, 153.0, -34.0, -328.0, -6.0, 177.0, 25.0, 178.0, -46.0, 116.0, -6.0, 155.0, -16.0, 113.0, 200.0, 0.0, 0.0, 0.0, 0.0, 198.0, 173.0, -205.0, -16.0, 165.0, 0.0, 0.0, -10.0, 0.0, 144.0, 68.0, 143.0, -6.0, 176.0, 157.0, 186.0, 161.0, -210.0, 20.0, 0.0, 119.0, 162.0, 188.0, 162.0, 0.0, 154.0, 95.0, 167.0, 0.0, 0.0, 95.0, -58.0, -160.0, 125.0, 92.0, 171.0, 200.0, 14.0, 99.0, 160.0, 182.0, 179.0, 100.0, 95.0, 144.0, -99.0, -178.0, -130.0, 185.0, 0.0, 182.0, 0.0, -10.0, 183.0, 0.0, 159.0], "policy_predator_policy_reward": [0.0, 0.0, 29.0, 17.0, 15.0, 21.0, 2.0, 9.0, 45.0, 15.0, 17.0, 9.0, 9.0, 0.0, 0.0, 13.0, 12.0, 45.0, 0.0, 1.0, 1.0, 15.0, 3.0, 8.0, 10.0, 12.0, 0.0, 0.0, 47.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 0.0, 0.0, 24.0, 0.0, 0.0, 0.0, 12.0, 23.0, 36.0, 13.0, 0.0, 0.0, 10.0, 6.0, 2.0, 18.0, 24.0, 8.0, 18.0, 0.0, 7.0, 0.0, 0.0, 30.0, 1.0, 58.0, 0.0, 0.0, 18.0, 23.0, 0.0, 7.0, 4.0, 0.0, 42.0, 13.0, 44.0, 161.0, 8.0, 17.0, 9.0, 0.0, 0.0, 0.0, 29.0, 16.0, 0.0, 19.0, 0.0, 0.0, 7.0, 34.0, 7.0, 1.0, 20.0, 6.0, 1.0, 0.0, 13.0, 7.0, 0.0, 3.0, 0.0, 0.0, 0.0, 8.0, 30.0, 39.0, 0.0, 1.0, 0.0, 12.0, 0.0, 1.0, 0.0, 0.0, 3.0, 6.0, 0.0, 0.0, 15.0, 0.0, 9.0, 7.0, 0.0, 0.0, 37.0, 0.0, 0.0, 0.0, 78.0, 5.0, 179.0, 0.0, 7.0, 46.0, 82.0, 0.0, 3.0, 28.0, 17.0, 6.0, 17.0, 23.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 10.0, 108.0, 0.0, 9.0, 5.0, 0.0, 6.0, 13.0, 17.0, 46.0, 11.0, 0.0, 7.0, 0.0, 12.0, 136.0, 60.0, 0.0, 11.0, 25.0, 0.0, 9.0, 14.0, 0.0, 11.0, 33.0, 0.0, 0.0, 86.0, 22.0, 98.0, 99.0, 15.0, 20.0, 0.0, 8.0, 33.0, 10.0, 9.0, 1.0, 33.0, 25.0, 99.0, 14.0, 105.0, 119.0, 5.0, 0.0, 1.0, 5.0, 2.0, 5.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4527421650081251, "mean_inference_ms": 4.169616839818698, "mean_action_processing_ms": 0.6795773969536206, "mean_env_wait_ms": 0.5093580958728361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005857348442077637, "StateBufferConnector_ms": 0.008042573928833008, "ViewRequirementAgentConnector_ms": 0.16855239868164062}, "num_episodes": 18, "episode_return_max": 387.0, "episode_return_min": -374.0, "episode_return_mean": 201.38, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 282.3948335590286, "num_env_steps_trained_throughput_per_sec": 282.3948335590286, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 15556.169, "restore_workers_time_ms": 0.016, "training_step_time_ms": 15556.079, "sample_time_ms": 2207.456, "learn_time_ms": 13325.845, "learn_throughput": 300.169, "synch_weights_time_ms": 18.84}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 99, "trial_id": "f6b99_00000", "date": "2024-08-13_20-19-51", "timestamp": 1723594791, "time_this_iter_s": 14.214561939239502, "time_total_s": 2091.969216823578, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b379de50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2091.969216823578, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 53.5, "ram_util_percent": 83.02380952380952}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2467691413309208, "cur_kl_coeff": 0.0023437499999999995, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7251035247530258, "policy_loss": -0.0027672941304334297, "vf_loss": 2.727852181215135, "vf_explained_var": 0.05865440337115495, "kl": 0.007954661742779784, "entropy": 0.42914116415712567, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.339925229202503, "cur_kl_coeff": 0.003955078124999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.100180724436644, "policy_loss": -0.004844694733668966, "vf_loss": 3.104999844233195, "vf_explained_var": 0.42968229074326775, "kl": 0.0064686221403564715, "entropy": 0.4260457948402122, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 387.0, "episode_reward_min": -374.0, "episode_reward_mean": 196.46, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -343.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 179.0}, "policy_reward_mean": {"prey_policy": 78.545, "predator_policy": 19.685}, "custom_metrics": {}, "hist_stats": {"episode_reward": [386.0, 167.0, 354.0, 300.0, 164.0, 156.0, 317.0, 76.0, 200.0, 113.0, 193.0, 179.0, 281.0, -374.0, 346.0, 182.0, 198.0, 312.0, 161.0, 381.0, 298.0, 191.0, 359.0, 347.0, 205.0, 168.0, 200.0, 174.0, 316.0, -1.0, 125.0, 199.0, 146.0, 177.0, 0.0, 230.0, 383.0, 387.0, 271.0, 200.0, 202.0, -155.0, 255.0, 214.0, 141.0, 162.0, 353.0, 0.0, 0.0, 380.0, -103.0, 174.0, -5.0, 163.0, 274.0, 181.0, 350.0, 99.0, 80.0, 317.0, 359.0, 168.0, 306.0, 0.0, 145.0, 162.0, 298.0, 222.0, 302.0, 371.0, 253.0, 158.0, -84.0, 190.0, 188.0, 180.0, 159.0, 289.0, 170.0, 354.0, 200.0, 380.0, 160.0, 193.0, 130.0, 150.0, 324.0, 365.0, 183.0, 28.0, 300.0, 127.0, 180.0, 121.0, 243.0, 320.0, 162.0, 330.0, -155.0, 166.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [198.0, 188.0, 0.0, 151.0, 140.0, 194.0, 107.0, 161.0, 0.0, 146.0, 159.0, -10.0, 159.0, 128.0, 0.0, 17.0, 200.0, 0.0, 72.0, 0.0, -14.0, 200.0, 175.0, 0.0, 179.0, 47.0, -289.0, -290.0, 174.0, 147.0, 173.0, 0.0, 0.0, 198.0, 167.0, 100.0, 142.0, 0.0, 185.0, 196.0, 149.0, 108.0, -14.0, 197.0, 168.0, 165.0, 158.0, 188.0, 142.0, 43.0, 169.0, -4.0, 200.0, 0.0, 0.0, 166.0, 194.0, 53.0, -2.0, 0.0, 137.0, -24.0, 200.0, -2.0, 146.0, 0.0, 0.0, 168.0, 0.0, 0.0, 15.0, 200.0, 167.0, 200.0, 194.0, 193.0, 134.0, 100.0, 0.0, 200.0, 153.0, -34.0, -328.0, -6.0, 177.0, 25.0, 178.0, -46.0, 116.0, -6.0, 155.0, -16.0, 113.0, 200.0, 0.0, 0.0, 0.0, 0.0, 198.0, 173.0, -205.0, -16.0, 165.0, 0.0, 0.0, -10.0, 0.0, 144.0, 68.0, 143.0, -6.0, 176.0, 157.0, 186.0, 161.0, -210.0, 20.0, 0.0, 119.0, 162.0, 188.0, 162.0, 0.0, 154.0, 95.0, 167.0, 0.0, 0.0, 95.0, -58.0, -160.0, 125.0, 92.0, 171.0, 200.0, 14.0, 99.0, 160.0, 182.0, 179.0, 100.0, 95.0, 144.0, -99.0, -178.0, -130.0, 185.0, 0.0, 182.0, 0.0, -10.0, 183.0, 0.0, 159.0, 167.0, 102.0, 0.0, 155.0, 185.0, 158.0, 0.0, 200.0, 179.0, 194.0, -12.0, 151.0, 0.0, 193.0, -128.0, 128.0, -253.0, 146.0, 44.0, 198.0, 134.0, 200.0, -10.0, 182.0, 0.0, -73.0, 106.0, 191.0, -2.0, 118.0, -8.0, 184.0, 0.0, 80.0, 152.0, -61.0, 179.0, 117.0, 0.0, 151.0, 153.0, 161.0, -343.0, 0.0, -46.0, 127.0], "policy_predator_policy_reward": [0.0, 0.0, 10.0, 6.0, 2.0, 18.0, 24.0, 8.0, 18.0, 0.0, 7.0, 0.0, 0.0, 30.0, 1.0, 58.0, 0.0, 0.0, 18.0, 23.0, 0.0, 7.0, 4.0, 0.0, 42.0, 13.0, 44.0, 161.0, 8.0, 17.0, 9.0, 0.0, 0.0, 0.0, 29.0, 16.0, 0.0, 19.0, 0.0, 0.0, 7.0, 34.0, 7.0, 1.0, 20.0, 6.0, 1.0, 0.0, 13.0, 7.0, 0.0, 3.0, 0.0, 0.0, 0.0, 8.0, 30.0, 39.0, 0.0, 1.0, 0.0, 12.0, 0.0, 1.0, 0.0, 0.0, 3.0, 6.0, 0.0, 0.0, 15.0, 0.0, 9.0, 7.0, 0.0, 0.0, 37.0, 0.0, 0.0, 0.0, 78.0, 5.0, 179.0, 0.0, 7.0, 46.0, 82.0, 0.0, 3.0, 28.0, 17.0, 6.0, 17.0, 23.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 10.0, 108.0, 0.0, 9.0, 5.0, 0.0, 6.0, 13.0, 17.0, 46.0, 11.0, 0.0, 7.0, 0.0, 12.0, 136.0, 60.0, 0.0, 11.0, 25.0, 0.0, 9.0, 14.0, 0.0, 11.0, 33.0, 0.0, 0.0, 86.0, 22.0, 98.0, 99.0, 15.0, 20.0, 0.0, 8.0, 33.0, 10.0, 9.0, 1.0, 33.0, 25.0, 99.0, 14.0, 105.0, 119.0, 5.0, 0.0, 1.0, 5.0, 2.0, 5.0, 0.0, 0.0, 9.0, 11.0, 15.0, 0.0, 11.0, 0.0, 0.0, 0.0, 3.0, 4.0, 0.0, 21.0, 0.0, 0.0, 109.0, 21.0, 132.0, 125.0, 35.0, 47.0, 12.0, 19.0, 11.0, 0.0, 40.0, 61.0, 3.0, 0.0, 9.0, 2.0, 4.0, 0.0, 11.0, 30.0, 68.0, 84.0, 0.0, 24.0, 0.0, 11.0, 3.0, 13.0, 15.0, 173.0, 68.0, 17.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4487638838161958, "mean_inference_ms": 4.169854353146729, "mean_action_processing_ms": 0.6835194192511321, "mean_env_wait_ms": 0.511853178687061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004996538162231445, "StateBufferConnector_ms": 0.007881999015808105, "ViewRequirementAgentConnector_ms": 0.15932345390319824}, "num_episodes": 23, "episode_return_max": 387.0, "episode_return_min": -374.0, "episode_return_mean": 196.46, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 282.50071457767933, "num_env_steps_trained_throughput_per_sec": 282.50071457767933, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 15569.34, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15569.262, "sample_time_ms": 2261.162, "learn_time_ms": 13286.111, "learn_throughput": 301.066, "synch_weights_time_ms": 18.23}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": false, "training_iteration": 100, "trial_id": "f6b99_00000", "date": "2024-08-13_20-20-06", "timestamp": 1723594806, "time_this_iter_s": 14.205841064453125, "time_total_s": 2106.175057888031, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6298430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2106.175057888031, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 52.025, "ram_util_percent": 82.11}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.203826338841171, "cur_kl_coeff": 0.0023437499999999995, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7836454329982636, "policy_loss": -0.0022531188718935167, "vf_loss": 0.7858557878111405, "vf_explained_var": 0.18449422146277453, "kl": 0.018246334604016888, "entropy": 0.5217033281055077, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 189945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2859322700866316, "cur_kl_coeff": 0.003955078124999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6563707697013068, "policy_loss": -0.004181697970827815, "vf_loss": 1.6605388426906849, "vf_explained_var": 0.7467850230358265, "kl": 0.0034455298711820385, "entropy": 0.4015726281063897, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 189945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 1616000, "num_agent_steps_trained": 1616000}, "env_runners": {"episode_reward_max": 394.0, "episode_reward_min": -155.0, "episode_reward_mean": 197.24, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -343.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 179.0}, "policy_reward_mean": {"prey_policy": 79.78, "predator_policy": 18.84}, "custom_metrics": {}, "hist_stats": {"episode_reward": [161.0, 381.0, 298.0, 191.0, 359.0, 347.0, 205.0, 168.0, 200.0, 174.0, 316.0, -1.0, 125.0, 199.0, 146.0, 177.0, 0.0, 230.0, 383.0, 387.0, 271.0, 200.0, 202.0, -155.0, 255.0, 214.0, 141.0, 162.0, 353.0, 0.0, 0.0, 380.0, -103.0, 174.0, -5.0, 163.0, 274.0, 181.0, 350.0, 99.0, 80.0, 317.0, 359.0, 168.0, 306.0, 0.0, 145.0, 162.0, 298.0, 222.0, 302.0, 371.0, 253.0, 158.0, -84.0, 190.0, 188.0, 180.0, 159.0, 289.0, 170.0, 354.0, 200.0, 380.0, 160.0, 193.0, 130.0, 150.0, 324.0, 365.0, 183.0, 28.0, 300.0, 127.0, 180.0, 121.0, 243.0, 320.0, 162.0, 330.0, -155.0, 166.0, 158.0, 0.0, 286.0, 0.0, 279.0, 173.0, 171.0, 0.0, 336.0, 394.0, 363.0, 284.0, 358.0, 193.0, 146.0, 391.0, 158.0, -62.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [142.0, 0.0, 185.0, 196.0, 149.0, 108.0, -14.0, 197.0, 168.0, 165.0, 158.0, 188.0, 142.0, 43.0, 169.0, -4.0, 200.0, 0.0, 0.0, 166.0, 194.0, 53.0, -2.0, 0.0, 137.0, -24.0, 200.0, -2.0, 146.0, 0.0, 0.0, 168.0, 0.0, 0.0, 15.0, 200.0, 167.0, 200.0, 194.0, 193.0, 134.0, 100.0, 0.0, 200.0, 153.0, -34.0, -328.0, -6.0, 177.0, 25.0, 178.0, -46.0, 116.0, -6.0, 155.0, -16.0, 113.0, 200.0, 0.0, 0.0, 0.0, 0.0, 198.0, 173.0, -205.0, -16.0, 165.0, 0.0, 0.0, -10.0, 0.0, 144.0, 68.0, 143.0, -6.0, 176.0, 157.0, 186.0, 161.0, -210.0, 20.0, 0.0, 119.0, 162.0, 188.0, 162.0, 0.0, 154.0, 95.0, 167.0, 0.0, 0.0, 95.0, -58.0, -160.0, 125.0, 92.0, 171.0, 200.0, 14.0, 99.0, 160.0, 182.0, 179.0, 100.0, 95.0, 144.0, -99.0, -178.0, -130.0, 185.0, 0.0, 182.0, 0.0, -10.0, 183.0, 0.0, 159.0, 167.0, 102.0, 0.0, 155.0, 185.0, 158.0, 0.0, 200.0, 179.0, 194.0, -12.0, 151.0, 0.0, 193.0, -128.0, 128.0, -253.0, 146.0, 44.0, 198.0, 134.0, 200.0, -10.0, 182.0, 0.0, -73.0, 106.0, 191.0, -2.0, 118.0, -8.0, 184.0, 0.0, 80.0, 152.0, -61.0, 179.0, 117.0, 0.0, 151.0, 153.0, 161.0, -343.0, 0.0, -46.0, 127.0, 0.0, 148.0, 0.0, 0.0, 98.0, 160.0, 0.0, 0.0, 147.0, 92.0, 0.0, 160.0, -10.0, 163.0, 0.0, 0.0, 119.0, 192.0, 200.0, 194.0, 197.0, 152.0, 163.0, 57.0, 146.0, 194.0, -8.0, 197.0, 0.0, 146.0, 192.0, 197.0, 0.0, 158.0, 80.0, -310.0], "policy_predator_policy_reward": [0.0, 19.0, 0.0, 0.0, 7.0, 34.0, 7.0, 1.0, 20.0, 6.0, 1.0, 0.0, 13.0, 7.0, 0.0, 3.0, 0.0, 0.0, 0.0, 8.0, 30.0, 39.0, 0.0, 1.0, 0.0, 12.0, 0.0, 1.0, 0.0, 0.0, 3.0, 6.0, 0.0, 0.0, 15.0, 0.0, 9.0, 7.0, 0.0, 0.0, 37.0, 0.0, 0.0, 0.0, 78.0, 5.0, 179.0, 0.0, 7.0, 46.0, 82.0, 0.0, 3.0, 28.0, 17.0, 6.0, 17.0, 23.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 10.0, 108.0, 0.0, 9.0, 5.0, 0.0, 6.0, 13.0, 17.0, 46.0, 11.0, 0.0, 7.0, 0.0, 12.0, 136.0, 60.0, 0.0, 11.0, 25.0, 0.0, 9.0, 14.0, 0.0, 11.0, 33.0, 0.0, 0.0, 86.0, 22.0, 98.0, 99.0, 15.0, 20.0, 0.0, 8.0, 33.0, 10.0, 9.0, 1.0, 33.0, 25.0, 99.0, 14.0, 105.0, 119.0, 5.0, 0.0, 1.0, 5.0, 2.0, 5.0, 0.0, 0.0, 9.0, 11.0, 15.0, 0.0, 11.0, 0.0, 0.0, 0.0, 3.0, 4.0, 0.0, 21.0, 0.0, 0.0, 109.0, 21.0, 132.0, 125.0, 35.0, 47.0, 12.0, 19.0, 11.0, 0.0, 40.0, 61.0, 3.0, 0.0, 9.0, 2.0, 4.0, 0.0, 11.0, 30.0, 68.0, 84.0, 0.0, 24.0, 0.0, 11.0, 3.0, 13.0, 15.0, 173.0, 68.0, 17.0, 10.0, 0.0, 0.0, 0.0, 3.0, 25.0, 0.0, 0.0, 40.0, 0.0, 13.0, 0.0, 10.0, 8.0, 0.0, 0.0, 9.0, 16.0, 0.0, 0.0, 0.0, 14.0, 31.0, 33.0, 18.0, 0.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 168.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.447296914448991, "mean_inference_ms": 4.157569182238265, "mean_action_processing_ms": 0.6745187852424062, "mean_env_wait_ms": 0.5074705300294937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00735628604888916, "StateBufferConnector_ms": 0.007943511009216309, "ViewRequirementAgentConnector_ms": 0.17109298706054688}, "num_episodes": 18, "episode_return_max": 394.0, "episode_return_min": -155.0, "episode_return_mean": 197.24, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1616000, "num_agent_steps_trained": 1616000, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 276.36230514789287, "num_env_steps_trained_throughput_per_sec": 276.36230514789287, "timesteps_total": 404000, "num_env_steps_sampled_lifetime": 404000, "num_agent_steps_sampled_lifetime": 1616000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1616000, "timers": {"training_iteration_time_ms": 15497.669, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15497.591, "sample_time_ms": 2368.616, "learn_time_ms": 13106.608, "learn_throughput": 305.19, "synch_weights_time_ms": 18.52}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 1616000, "num_agent_steps_trained": 1616000}, "done": false, "training_iteration": 101, "trial_id": "f6b99_00000", "date": "2024-08-13_20-20-20", "timestamp": 1723594820, "time_this_iter_s": 14.52511477470398, "time_total_s": 2120.700172662735, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6d1e820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2120.700172662735, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 50.605, "ram_util_percent": 82.675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2470208003407435, "cur_kl_coeff": 0.0023437499999999995, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.205970716161072, "policy_loss": -0.0034451891718649125, "vf_loss": 2.2093941894157854, "vf_explained_var": 0.21552061593091046, "kl": 0.009266953966749526, "entropy": 0.5084232035768095, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 191835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8596890919738345, "cur_kl_coeff": 0.0019775390624999995, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.671748730303749, "policy_loss": -0.006527074900943609, "vf_loss": 2.6782447454159852, "vf_explained_var": 0.38039196729660035, "kl": 0.015707806216316955, "entropy": 0.3994734758264804, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 191835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000}, "env_runners": {"episode_reward_max": 394.0, "episode_reward_min": -188.0, "episode_reward_mean": 182.68, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 189.0}, "policy_reward_mean": {"prey_policy": 69.785, "predator_policy": 21.555}, "custom_metrics": {}, "hist_stats": {"episode_reward": [383.0, 387.0, 271.0, 200.0, 202.0, -155.0, 255.0, 214.0, 141.0, 162.0, 353.0, 0.0, 0.0, 380.0, -103.0, 174.0, -5.0, 163.0, 274.0, 181.0, 350.0, 99.0, 80.0, 317.0, 359.0, 168.0, 306.0, 0.0, 145.0, 162.0, 298.0, 222.0, 302.0, 371.0, 253.0, 158.0, -84.0, 190.0, 188.0, 180.0, 159.0, 289.0, 170.0, 354.0, 200.0, 380.0, 160.0, 193.0, 130.0, 150.0, 324.0, 365.0, 183.0, 28.0, 300.0, 127.0, 180.0, 121.0, 243.0, 320.0, 162.0, 330.0, -155.0, 166.0, 158.0, 0.0, 286.0, 0.0, 279.0, 173.0, 171.0, 0.0, 336.0, 394.0, 363.0, 284.0, 358.0, 193.0, 146.0, 391.0, 158.0, -62.0, 0.0, 168.0, -6.0, 169.0, 295.0, 176.0, 200.0, 3.0, 128.0, 168.0, -107.0, 359.0, 107.0, 110.0, 306.0, -2.0, 334.0, -188.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [167.0, 200.0, 194.0, 193.0, 134.0, 100.0, 0.0, 200.0, 153.0, -34.0, -328.0, -6.0, 177.0, 25.0, 178.0, -46.0, 116.0, -6.0, 155.0, -16.0, 113.0, 200.0, 0.0, 0.0, 0.0, 0.0, 198.0, 173.0, -205.0, -16.0, 165.0, 0.0, 0.0, -10.0, 0.0, 144.0, 68.0, 143.0, -6.0, 176.0, 157.0, 186.0, 161.0, -210.0, 20.0, 0.0, 119.0, 162.0, 188.0, 162.0, 0.0, 154.0, 95.0, 167.0, 0.0, 0.0, 95.0, -58.0, -160.0, 125.0, 92.0, 171.0, 200.0, 14.0, 99.0, 160.0, 182.0, 179.0, 100.0, 95.0, 144.0, -99.0, -178.0, -130.0, 185.0, 0.0, 182.0, 0.0, -10.0, 183.0, 0.0, 159.0, 167.0, 102.0, 0.0, 155.0, 185.0, 158.0, 0.0, 200.0, 179.0, 194.0, -12.0, 151.0, 0.0, 193.0, -128.0, 128.0, -253.0, 146.0, 44.0, 198.0, 134.0, 200.0, -10.0, 182.0, 0.0, -73.0, 106.0, 191.0, -2.0, 118.0, -8.0, 184.0, 0.0, 80.0, 152.0, -61.0, 179.0, 117.0, 0.0, 151.0, 153.0, 161.0, -343.0, 0.0, -46.0, 127.0, 0.0, 148.0, 0.0, 0.0, 98.0, 160.0, 0.0, 0.0, 147.0, 92.0, 0.0, 160.0, -10.0, 163.0, 0.0, 0.0, 119.0, 192.0, 200.0, 194.0, 197.0, 152.0, 163.0, 57.0, 146.0, 194.0, -8.0, 197.0, 0.0, 146.0, 192.0, 197.0, 0.0, 158.0, 80.0, -310.0, 0.0, 0.0, 80.0, 28.0, 0.0, -12.0, 0.0, 169.0, 114.0, 145.0, 0.0, 161.0, 200.0, 0.0, 3.0, 0.0, 0.0, 128.0, 70.0, -4.0, -322.0, 1.0, 155.0, 200.0, -3.0, 30.0, -6.0, 103.0, 166.0, 134.0, 0.0, -4.0, 177.0, 131.0, -400.0, 0.0], "policy_predator_policy_reward": [9.0, 7.0, 0.0, 0.0, 37.0, 0.0, 0.0, 0.0, 78.0, 5.0, 179.0, 0.0, 7.0, 46.0, 82.0, 0.0, 3.0, 28.0, 17.0, 6.0, 17.0, 23.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 10.0, 108.0, 0.0, 9.0, 5.0, 0.0, 6.0, 13.0, 17.0, 46.0, 11.0, 0.0, 7.0, 0.0, 12.0, 136.0, 60.0, 0.0, 11.0, 25.0, 0.0, 9.0, 14.0, 0.0, 11.0, 33.0, 0.0, 0.0, 86.0, 22.0, 98.0, 99.0, 15.0, 20.0, 0.0, 8.0, 33.0, 10.0, 9.0, 1.0, 33.0, 25.0, 99.0, 14.0, 105.0, 119.0, 5.0, 0.0, 1.0, 5.0, 2.0, 5.0, 0.0, 0.0, 9.0, 11.0, 15.0, 0.0, 11.0, 0.0, 0.0, 0.0, 3.0, 4.0, 0.0, 21.0, 0.0, 0.0, 109.0, 21.0, 132.0, 125.0, 35.0, 47.0, 12.0, 19.0, 11.0, 0.0, 40.0, 61.0, 3.0, 0.0, 9.0, 2.0, 4.0, 0.0, 11.0, 30.0, 68.0, 84.0, 0.0, 24.0, 0.0, 11.0, 3.0, 13.0, 15.0, 173.0, 68.0, 17.0, 10.0, 0.0, 0.0, 0.0, 3.0, 25.0, 0.0, 0.0, 40.0, 0.0, 13.0, 0.0, 10.0, 8.0, 0.0, 0.0, 9.0, 16.0, 0.0, 0.0, 0.0, 14.0, 31.0, 33.0, 18.0, 0.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 168.0, 0.0, 0.0, 0.0, 43.0, 17.0, 6.0, 0.0, 0.0, 0.0, 14.0, 22.0, 13.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 68.0, 34.0, 174.0, 40.0, 4.0, 0.0, 66.0, 14.0, 0.0, 13.0, 6.0, 0.0, 2.0, 0.0, 8.0, 18.0, 23.0, 189.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4448152417747542, "mean_inference_ms": 4.152198428078607, "mean_action_processing_ms": 0.6724739202736969, "mean_env_wait_ms": 0.5064724899083474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0073931217193603516, "StateBufferConnector_ms": 0.008153080940246582, "ViewRequirementAgentConnector_ms": 0.1841660737991333}, "num_episodes": 18, "episode_return_max": 394.0, "episode_return_min": -188.0, "episode_return_mean": 182.68, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 272.86555267436023, "num_env_steps_trained_throughput_per_sec": 272.86555267436023, "timesteps_total": 408000, "num_env_steps_sampled_lifetime": 408000, "num_agent_steps_sampled_lifetime": 1632000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1632000, "timers": {"training_iteration_time_ms": 15350.494, "restore_workers_time_ms": 0.016, "training_step_time_ms": 15350.413, "sample_time_ms": 2535.252, "learn_time_ms": 12793.326, "learn_throughput": 312.663, "synch_weights_time_ms": 17.763}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000}, "done": false, "training_iteration": 102, "trial_id": "f6b99_00000", "date": "2024-08-13_20-20-35", "timestamp": 1723594835, "time_this_iter_s": 14.705076932907104, "time_total_s": 2135.405249595642, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b623d940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2135.405249595642, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 55.03809523809524, "ram_util_percent": 84.00952380952381}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8153866574247048, "cur_kl_coeff": 0.0023437499999999995, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6298497078595338, "policy_loss": -0.0037461946302009795, "vf_loss": 1.6335519869491537, "vf_explained_var": 0.18975538204586695, "kl": 0.01873752201297168, "entropy": 0.5223551826817648, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 193725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.841897779734677, "cur_kl_coeff": 0.0019775390624999995, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.718193411953235, "policy_loss": -0.006673263551090799, "vf_loss": 3.724837979059371, "vf_explained_var": 0.2561319996124853, "kl": 0.014509719389487493, "entropy": 0.5473585760309583, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 193725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 1648000, "num_agent_steps_trained": 1648000}, "env_runners": {"episode_reward_max": 394.0, "episode_reward_min": -461.0, "episode_reward_mean": 168.87, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": 62.655, "predator_policy": 21.78}, "custom_metrics": {}, "hist_stats": {"episode_reward": [80.0, 317.0, 359.0, 168.0, 306.0, 0.0, 145.0, 162.0, 298.0, 222.0, 302.0, 371.0, 253.0, 158.0, -84.0, 190.0, 188.0, 180.0, 159.0, 289.0, 170.0, 354.0, 200.0, 380.0, 160.0, 193.0, 130.0, 150.0, 324.0, 365.0, 183.0, 28.0, 300.0, 127.0, 180.0, 121.0, 243.0, 320.0, 162.0, 330.0, -155.0, 166.0, 158.0, 0.0, 286.0, 0.0, 279.0, 173.0, 171.0, 0.0, 336.0, 394.0, 363.0, 284.0, 358.0, 193.0, 146.0, 391.0, 158.0, -62.0, 0.0, 168.0, -6.0, 169.0, 295.0, 176.0, 200.0, 3.0, 128.0, 168.0, -107.0, 359.0, 107.0, 110.0, 306.0, -2.0, 334.0, -188.0, 188.0, -461.0, 295.0, 62.0, -25.0, 0.0, 280.0, 46.0, 373.0, 172.0, 161.0, 2.0, 180.0, 202.0, 175.0, 314.0, -10.0, -10.0, 244.0, 159.0, 32.0, 166.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [20.0, 0.0, 119.0, 162.0, 188.0, 162.0, 0.0, 154.0, 95.0, 167.0, 0.0, 0.0, 95.0, -58.0, -160.0, 125.0, 92.0, 171.0, 200.0, 14.0, 99.0, 160.0, 182.0, 179.0, 100.0, 95.0, 144.0, -99.0, -178.0, -130.0, 185.0, 0.0, 182.0, 0.0, -10.0, 183.0, 0.0, 159.0, 167.0, 102.0, 0.0, 155.0, 185.0, 158.0, 0.0, 200.0, 179.0, 194.0, -12.0, 151.0, 0.0, 193.0, -128.0, 128.0, -253.0, 146.0, 44.0, 198.0, 134.0, 200.0, -10.0, 182.0, 0.0, -73.0, 106.0, 191.0, -2.0, 118.0, -8.0, 184.0, 0.0, 80.0, 152.0, -61.0, 179.0, 117.0, 0.0, 151.0, 153.0, 161.0, -343.0, 0.0, -46.0, 127.0, 0.0, 148.0, 0.0, 0.0, 98.0, 160.0, 0.0, 0.0, 147.0, 92.0, 0.0, 160.0, -10.0, 163.0, 0.0, 0.0, 119.0, 192.0, 200.0, 194.0, 197.0, 152.0, 163.0, 57.0, 146.0, 194.0, -8.0, 197.0, 0.0, 146.0, 192.0, 197.0, 0.0, 158.0, 80.0, -310.0, 0.0, 0.0, 80.0, 28.0, 0.0, -12.0, 0.0, 169.0, 114.0, 145.0, 0.0, 161.0, 200.0, 0.0, 3.0, 0.0, 0.0, 128.0, 70.0, -4.0, -322.0, 1.0, 155.0, 200.0, -3.0, 30.0, -6.0, 103.0, 166.0, 134.0, 0.0, -4.0, 177.0, 131.0, -400.0, 0.0, 47.0, 54.0, -400.0, -261.0, 131.0, 103.0, -2.0, -12.0, 0.0, -146.0, 0.0, 0.0, 44.0, 176.0, -8.0, -22.0, 173.0, 192.0, 0.0, 131.0, -10.0, 163.0, 2.0, 0.0, 177.0, 0.0, 66.0, 87.0, 167.0, 0.0, 176.0, 117.0, -6.0, -14.0, 0.0, -20.0, 179.0, 61.0, -2.0, 160.0, -56.0, 0.0, 61.0, 59.0], "policy_predator_policy_reward": [60.0, 0.0, 11.0, 25.0, 0.0, 9.0, 14.0, 0.0, 11.0, 33.0, 0.0, 0.0, 86.0, 22.0, 98.0, 99.0, 15.0, 20.0, 0.0, 8.0, 33.0, 10.0, 9.0, 1.0, 33.0, 25.0, 99.0, 14.0, 105.0, 119.0, 5.0, 0.0, 1.0, 5.0, 2.0, 5.0, 0.0, 0.0, 9.0, 11.0, 15.0, 0.0, 11.0, 0.0, 0.0, 0.0, 3.0, 4.0, 0.0, 21.0, 0.0, 0.0, 109.0, 21.0, 132.0, 125.0, 35.0, 47.0, 12.0, 19.0, 11.0, 0.0, 40.0, 61.0, 3.0, 0.0, 9.0, 2.0, 4.0, 0.0, 11.0, 30.0, 68.0, 84.0, 0.0, 24.0, 0.0, 11.0, 3.0, 13.0, 15.0, 173.0, 68.0, 17.0, 10.0, 0.0, 0.0, 0.0, 3.0, 25.0, 0.0, 0.0, 40.0, 0.0, 13.0, 0.0, 10.0, 8.0, 0.0, 0.0, 9.0, 16.0, 0.0, 0.0, 0.0, 14.0, 31.0, 33.0, 18.0, 0.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 168.0, 0.0, 0.0, 0.0, 43.0, 17.0, 6.0, 0.0, 0.0, 0.0, 14.0, 22.0, 13.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 68.0, 34.0, 174.0, 40.0, 4.0, 0.0, 66.0, 14.0, 0.0, 13.0, 6.0, 0.0, 2.0, 0.0, 8.0, 18.0, 23.0, 189.0, 33.0, 54.0, 0.0, 200.0, 12.0, 49.0, 35.0, 41.0, 85.0, 36.0, 0.0, 0.0, 52.0, 8.0, 0.0, 76.0, 3.0, 5.0, 19.0, 22.0, 3.0, 5.0, 0.0, 0.0, 0.0, 3.0, 2.0, 47.0, 8.0, 0.0, 0.0, 21.0, 10.0, 0.0, 0.0, 10.0, 0.0, 4.0, 0.0, 1.0, 51.0, 37.0, 42.0, 4.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4405935530153315, "mean_inference_ms": 4.142004726487201, "mean_action_processing_ms": 0.6699187220677704, "mean_env_wait_ms": 0.5050245487824749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007590174674987793, "StateBufferConnector_ms": 0.004090428352355957, "ViewRequirementAgentConnector_ms": 0.18126213550567627}, "num_episodes": 22, "episode_return_max": 394.0, "episode_return_min": -461.0, "episode_return_mean": 168.87, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1648000, "num_agent_steps_trained": 1648000, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 247.95843361514588, "num_env_steps_trained_throughput_per_sec": 247.95843361514588, "timesteps_total": 412000, "num_env_steps_sampled_lifetime": 412000, "num_agent_steps_sampled_lifetime": 1648000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1648000, "timers": {"training_iteration_time_ms": 15620.658, "restore_workers_time_ms": 0.016, "training_step_time_ms": 15620.578, "sample_time_ms": 2659.285, "learn_time_ms": 12938.703, "learn_throughput": 309.15, "synch_weights_time_ms": 18.315}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 1648000, "num_agent_steps_trained": 1648000}, "done": false, "training_iteration": 103, "trial_id": "f6b99_00000", "date": "2024-08-13_20-20-51", "timestamp": 1723594851, "time_this_iter_s": 16.204726696014404, "time_total_s": 2151.6099762916565, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b623ddc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2151.6099762916565, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 57.5, "ram_util_percent": 83.81739130434785}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6200747058505103, "cur_kl_coeff": 0.0023437499999999995, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.985903956461205, "policy_loss": -0.00510237113198157, "vf_loss": 1.990931906050475, "vf_explained_var": 0.18942755113833795, "kl": 0.03175384840197772, "entropy": 0.6577457010430634, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 195615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.692682574791883, "cur_kl_coeff": 0.0019775390624999995, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.315247728206494, "policy_loss": -0.005084983408746738, "vf_loss": 4.320320915671252, "vf_explained_var": -0.10869796131023024, "kl": 0.005965064695078536, "entropy": 0.45605468450399933, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 195615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 1664000, "num_agent_steps_trained": 1664000}, "env_runners": {"episode_reward_max": 394.0, "episode_reward_min": -556.0, "episode_reward_mean": 138.6, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": 47.455, "predator_policy": 21.845}, "custom_metrics": {}, "hist_stats": {"episode_reward": [159.0, 289.0, 170.0, 354.0, 200.0, 380.0, 160.0, 193.0, 130.0, 150.0, 324.0, 365.0, 183.0, 28.0, 300.0, 127.0, 180.0, 121.0, 243.0, 320.0, 162.0, 330.0, -155.0, 166.0, 158.0, 0.0, 286.0, 0.0, 279.0, 173.0, 171.0, 0.0, 336.0, 394.0, 363.0, 284.0, 358.0, 193.0, 146.0, 391.0, 158.0, -62.0, 0.0, 168.0, -6.0, 169.0, 295.0, 176.0, 200.0, 3.0, 128.0, 168.0, -107.0, 359.0, 107.0, 110.0, 306.0, -2.0, 334.0, -188.0, 188.0, -461.0, 295.0, 62.0, -25.0, 0.0, 280.0, 46.0, 373.0, 172.0, 161.0, 2.0, 180.0, 202.0, 175.0, 314.0, -10.0, -10.0, 244.0, 159.0, 32.0, 166.0, 130.0, 0.0, -550.0, 143.0, 275.0, 253.0, 166.0, -122.0, 141.0, 182.0, 340.0, -556.0, -518.0, 264.0, 119.0, 142.0, 182.0, -3.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 159.0, 167.0, 102.0, 0.0, 155.0, 185.0, 158.0, 0.0, 200.0, 179.0, 194.0, -12.0, 151.0, 0.0, 193.0, -128.0, 128.0, -253.0, 146.0, 44.0, 198.0, 134.0, 200.0, -10.0, 182.0, 0.0, -73.0, 106.0, 191.0, -2.0, 118.0, -8.0, 184.0, 0.0, 80.0, 152.0, -61.0, 179.0, 117.0, 0.0, 151.0, 153.0, 161.0, -343.0, 0.0, -46.0, 127.0, 0.0, 148.0, 0.0, 0.0, 98.0, 160.0, 0.0, 0.0, 147.0, 92.0, 0.0, 160.0, -10.0, 163.0, 0.0, 0.0, 119.0, 192.0, 200.0, 194.0, 197.0, 152.0, 163.0, 57.0, 146.0, 194.0, -8.0, 197.0, 0.0, 146.0, 192.0, 197.0, 0.0, 158.0, 80.0, -310.0, 0.0, 0.0, 80.0, 28.0, 0.0, -12.0, 0.0, 169.0, 114.0, 145.0, 0.0, 161.0, 200.0, 0.0, 3.0, 0.0, 0.0, 128.0, 70.0, -4.0, -322.0, 1.0, 155.0, 200.0, -3.0, 30.0, -6.0, 103.0, 166.0, 134.0, 0.0, -4.0, 177.0, 131.0, -400.0, 0.0, 47.0, 54.0, -400.0, -261.0, 131.0, 103.0, -2.0, -12.0, 0.0, -146.0, 0.0, 0.0, 44.0, 176.0, -8.0, -22.0, 173.0, 192.0, 0.0, 131.0, -10.0, 163.0, 2.0, 0.0, 177.0, 0.0, 66.0, 87.0, 167.0, 0.0, 176.0, 117.0, -6.0, -14.0, 0.0, -20.0, 179.0, 61.0, -2.0, 160.0, -56.0, 0.0, 61.0, 59.0, 116.0, -10.0, 0.0, 0.0, -360.0, -381.0, 117.0, 0.0, 187.0, 41.0, 134.0, 118.0, 0.0, 144.0, -6.0, -270.0, 63.0, 27.0, 0.0, 173.0, 166.0, 157.0, -379.0, -374.0, -366.0, -343.0, 101.0, 140.0, 0.0, 106.0, 0.0, 127.0, 0.0, 176.0, -6.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 9.0, 11.0, 15.0, 0.0, 11.0, 0.0, 0.0, 0.0, 3.0, 4.0, 0.0, 21.0, 0.0, 0.0, 109.0, 21.0, 132.0, 125.0, 35.0, 47.0, 12.0, 19.0, 11.0, 0.0, 40.0, 61.0, 3.0, 0.0, 9.0, 2.0, 4.0, 0.0, 11.0, 30.0, 68.0, 84.0, 0.0, 24.0, 0.0, 11.0, 3.0, 13.0, 15.0, 173.0, 68.0, 17.0, 10.0, 0.0, 0.0, 0.0, 3.0, 25.0, 0.0, 0.0, 40.0, 0.0, 13.0, 0.0, 10.0, 8.0, 0.0, 0.0, 9.0, 16.0, 0.0, 0.0, 0.0, 14.0, 31.0, 33.0, 18.0, 0.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 168.0, 0.0, 0.0, 0.0, 43.0, 17.0, 6.0, 0.0, 0.0, 0.0, 14.0, 22.0, 13.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 68.0, 34.0, 174.0, 40.0, 4.0, 0.0, 66.0, 14.0, 0.0, 13.0, 6.0, 0.0, 2.0, 0.0, 8.0, 18.0, 23.0, 189.0, 33.0, 54.0, 0.0, 200.0, 12.0, 49.0, 35.0, 41.0, 85.0, 36.0, 0.0, 0.0, 52.0, 8.0, 0.0, 76.0, 3.0, 5.0, 19.0, 22.0, 3.0, 5.0, 0.0, 0.0, 0.0, 3.0, 2.0, 47.0, 8.0, 0.0, 0.0, 21.0, 10.0, 0.0, 0.0, 10.0, 0.0, 4.0, 0.0, 1.0, 51.0, 37.0, 42.0, 4.0, 5.0, 19.0, 0.0, 0.0, 0.0, 191.0, 18.0, 8.0, 22.0, 25.0, 0.0, 1.0, 8.0, 14.0, 151.0, 3.0, 51.0, 0.0, 9.0, 0.0, 17.0, 0.0, 189.0, 8.0, 7.0, 184.0, 0.0, 23.0, 13.0, 0.0, 15.0, 0.0, 6.0, 0.0, 3.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4379687469787883, "mean_inference_ms": 4.137743402761169, "mean_action_processing_ms": 0.6683550479014818, "mean_env_wait_ms": 0.5043575587606846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00806427001953125, "StateBufferConnector_ms": 0.004513263702392578, "ViewRequirementAgentConnector_ms": 0.2083427906036377}, "num_episodes": 18, "episode_return_max": 394.0, "episode_return_min": -556.0, "episode_return_mean": 138.6, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1664000, "num_agent_steps_trained": 1664000, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 238.37164637810548, "num_env_steps_trained_throughput_per_sec": 238.37164637810548, "timesteps_total": 416000, "num_env_steps_sampled_lifetime": 416000, "num_agent_steps_sampled_lifetime": 1664000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1664000, "timers": {"training_iteration_time_ms": 15485.589, "restore_workers_time_ms": 0.016, "training_step_time_ms": 15485.533, "sample_time_ms": 2865.505, "learn_time_ms": 12597.801, "learn_throughput": 317.516, "synch_weights_time_ms": 17.301}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 1664000, "num_agent_steps_trained": 1664000}, "done": false, "training_iteration": 104, "trial_id": "f6b99_00000", "date": "2024-08-13_20-21-08", "timestamp": 1723594868, "time_this_iter_s": 16.825852870941162, "time_total_s": 2168.4358291625977, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b62a7d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2168.4358291625977, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 61.725, "ram_util_percent": 83.02499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2531416369178308, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3512680547577993, "policy_loss": -0.003698239720145625, "vf_loss": 2.354883753874945, "vf_explained_var": 0.2034440860546455, "kl": 0.023477539078608452, "entropy": 0.5916875351358343, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 197505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.386462274682585, "cur_kl_coeff": 0.0019775390624999995, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.311223215716226, "policy_loss": -0.003420643853861346, "vf_loss": 3.314635397769787, "vf_explained_var": -0.07992746224479069, "kl": 0.0042797056127827976, "entropy": 0.4703320088209929, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 197505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "env_runners": {"episode_reward_max": 394.0, "episode_reward_min": -556.0, "episode_reward_mean": 112.56, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": 33.545, "predator_policy": 22.735}, "custom_metrics": {}, "hist_stats": {"episode_reward": [166.0, 158.0, 0.0, 286.0, 0.0, 279.0, 173.0, 171.0, 0.0, 336.0, 394.0, 363.0, 284.0, 358.0, 193.0, 146.0, 391.0, 158.0, -62.0, 0.0, 168.0, -6.0, 169.0, 295.0, 176.0, 200.0, 3.0, 128.0, 168.0, -107.0, 359.0, 107.0, 110.0, 306.0, -2.0, 334.0, -188.0, 188.0, -461.0, 295.0, 62.0, -25.0, 0.0, 280.0, 46.0, 373.0, 172.0, 161.0, 2.0, 180.0, 202.0, 175.0, 314.0, -10.0, -10.0, 244.0, 159.0, 32.0, 166.0, 130.0, 0.0, -550.0, 143.0, 275.0, 253.0, 166.0, -122.0, 141.0, 182.0, 340.0, -556.0, -518.0, 264.0, 119.0, 142.0, 182.0, -3.0, 0.0, 286.0, 166.0, -141.0, -3.0, -134.0, 25.0, 180.0, -159.0, 337.0, 198.0, 129.0, 95.0, -220.0, -160.0, 179.0, -88.0, 53.0, 351.0, 304.0, 341.0, 192.0, 178.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-46.0, 127.0, 0.0, 148.0, 0.0, 0.0, 98.0, 160.0, 0.0, 0.0, 147.0, 92.0, 0.0, 160.0, -10.0, 163.0, 0.0, 0.0, 119.0, 192.0, 200.0, 194.0, 197.0, 152.0, 163.0, 57.0, 146.0, 194.0, -8.0, 197.0, 0.0, 146.0, 192.0, 197.0, 0.0, 158.0, 80.0, -310.0, 0.0, 0.0, 80.0, 28.0, 0.0, -12.0, 0.0, 169.0, 114.0, 145.0, 0.0, 161.0, 200.0, 0.0, 3.0, 0.0, 0.0, 128.0, 70.0, -4.0, -322.0, 1.0, 155.0, 200.0, -3.0, 30.0, -6.0, 103.0, 166.0, 134.0, 0.0, -4.0, 177.0, 131.0, -400.0, 0.0, 47.0, 54.0, -400.0, -261.0, 131.0, 103.0, -2.0, -12.0, 0.0, -146.0, 0.0, 0.0, 44.0, 176.0, -8.0, -22.0, 173.0, 192.0, 0.0, 131.0, -10.0, 163.0, 2.0, 0.0, 177.0, 0.0, 66.0, 87.0, 167.0, 0.0, 176.0, 117.0, -6.0, -14.0, 0.0, -20.0, 179.0, 61.0, -2.0, 160.0, -56.0, 0.0, 61.0, 59.0, 116.0, -10.0, 0.0, 0.0, -360.0, -381.0, 117.0, 0.0, 187.0, 41.0, 134.0, 118.0, 0.0, 144.0, -6.0, -270.0, 63.0, 27.0, 0.0, 173.0, 166.0, 157.0, -379.0, -374.0, -366.0, -343.0, 101.0, 140.0, 0.0, 106.0, 0.0, 127.0, 0.0, 176.0, -6.0, 0.0, 0.0, 0.0, 91.0, 190.0, 154.0, 0.0, -317.0, 0.0, 0.0, -6.0, 52.0, -380.0, -12.0, 25.0, 170.0, 0.0, -8.0, -316.0, 165.0, 158.0, 0.0, 198.0, 129.0, 0.0, 0.0, 95.0, -80.0, -345.0, 0.0, -358.0, 0.0, 169.0, -232.0, 0.0, 0.0, -42.0, 129.0, 200.0, 90.0, 177.0, 177.0, 164.0, 0.0, 188.0, 170.0, 0.0], "policy_predator_policy_reward": [68.0, 17.0, 10.0, 0.0, 0.0, 0.0, 3.0, 25.0, 0.0, 0.0, 40.0, 0.0, 13.0, 0.0, 10.0, 8.0, 0.0, 0.0, 9.0, 16.0, 0.0, 0.0, 0.0, 14.0, 31.0, 33.0, 18.0, 0.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 168.0, 0.0, 0.0, 0.0, 43.0, 17.0, 6.0, 0.0, 0.0, 0.0, 14.0, 22.0, 13.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 68.0, 34.0, 174.0, 40.0, 4.0, 0.0, 66.0, 14.0, 0.0, 13.0, 6.0, 0.0, 2.0, 0.0, 8.0, 18.0, 23.0, 189.0, 33.0, 54.0, 0.0, 200.0, 12.0, 49.0, 35.0, 41.0, 85.0, 36.0, 0.0, 0.0, 52.0, 8.0, 0.0, 76.0, 3.0, 5.0, 19.0, 22.0, 3.0, 5.0, 0.0, 0.0, 0.0, 3.0, 2.0, 47.0, 8.0, 0.0, 0.0, 21.0, 10.0, 0.0, 0.0, 10.0, 0.0, 4.0, 0.0, 1.0, 51.0, 37.0, 42.0, 4.0, 5.0, 19.0, 0.0, 0.0, 0.0, 191.0, 18.0, 8.0, 22.0, 25.0, 0.0, 1.0, 8.0, 14.0, 151.0, 3.0, 51.0, 0.0, 9.0, 0.0, 17.0, 0.0, 189.0, 8.0, 7.0, 184.0, 0.0, 23.0, 13.0, 0.0, 15.0, 0.0, 6.0, 0.0, 3.0, 0.0, 0.0, 0.0, 4.0, 1.0, 12.0, 0.0, 167.0, 9.0, 3.0, 0.0, 193.0, 1.0, 6.0, 6.0, 10.0, 0.0, 160.0, 5.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 5.0, 12.0, 186.0, 10.0, 0.0, 8.0, 136.0, 62.0, 33.0, 22.0, 0.0, 10.0, 27.0, 0.0, 0.0, 0.0, 4.0, 8.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4340736018101996, "mean_inference_ms": 4.13094303788124, "mean_action_processing_ms": 0.6662128122608995, "mean_env_wait_ms": 0.5033807163852433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007829070091247559, "StateBufferConnector_ms": 0.004414916038513184, "ViewRequirementAgentConnector_ms": 0.20137131214141846}, "num_episodes": 23, "episode_return_max": 394.0, "episode_return_min": -556.0, "episode_return_mean": 112.56, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.9479419170003, "num_env_steps_trained_throughput_per_sec": 277.9479419170003, "timesteps_total": 420000, "num_env_steps_sampled_lifetime": 420000, "num_agent_steps_sampled_lifetime": 1680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1680000, "timers": {"training_iteration_time_ms": 15381.574, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15381.516, "sample_time_ms": 2798.983, "learn_time_ms": 12559.656, "learn_throughput": 318.48, "synch_weights_time_ms": 18.044}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "done": false, "training_iteration": 105, "trial_id": "f6b99_00000", "date": "2024-08-13_20-21-23", "timestamp": 1723594883, "time_this_iter_s": 14.44055700302124, "time_total_s": 2182.876386165619, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b623d940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2182.876386165619, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 57.355000000000004, "ram_util_percent": 83.235}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.349052728862359, "cur_kl_coeff": 0.0052734375, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.726002654827461, "policy_loss": -0.0015248520324430454, "vf_loss": 2.7273950336471438, "vf_explained_var": 0.19903797507286072, "kl": 0.0251211484750993, "entropy": 0.5805340734423784, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 199395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.893371880984811, "cur_kl_coeff": 0.0009887695312499997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.823629953116967, "policy_loss": -0.006798813099081002, "vf_loss": 2.830397494570919, "vf_explained_var": -0.16587425722646965, "kl": 0.03162632915929571, "entropy": 0.4233688340142921, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 199395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 1696000, "num_agent_steps_trained": 1696000}, "env_runners": {"episode_reward_max": 373.0, "episode_reward_min": -556.0, "episode_reward_mean": 69.68, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": 6.66, "predator_policy": 28.18}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-62.0, 0.0, 168.0, -6.0, 169.0, 295.0, 176.0, 200.0, 3.0, 128.0, 168.0, -107.0, 359.0, 107.0, 110.0, 306.0, -2.0, 334.0, -188.0, 188.0, -461.0, 295.0, 62.0, -25.0, 0.0, 280.0, 46.0, 373.0, 172.0, 161.0, 2.0, 180.0, 202.0, 175.0, 314.0, -10.0, -10.0, 244.0, 159.0, 32.0, 166.0, 130.0, 0.0, -550.0, 143.0, 275.0, 253.0, 166.0, -122.0, 141.0, 182.0, 340.0, -556.0, -518.0, 264.0, 119.0, 142.0, 182.0, -3.0, 0.0, 286.0, 166.0, -141.0, -3.0, -134.0, 25.0, 180.0, -159.0, 337.0, 198.0, 129.0, 95.0, -220.0, -160.0, 179.0, -88.0, 53.0, 351.0, 304.0, 341.0, 192.0, 178.0, -499.0, 0.0, -231.0, 0.0, -155.0, 0.0, -6.0, 198.0, 109.0, 169.0, -186.0, -1.0, -321.0, 192.0, 8.0, 358.0, 193.0, -260.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [80.0, -310.0, 0.0, 0.0, 80.0, 28.0, 0.0, -12.0, 0.0, 169.0, 114.0, 145.0, 0.0, 161.0, 200.0, 0.0, 3.0, 0.0, 0.0, 128.0, 70.0, -4.0, -322.0, 1.0, 155.0, 200.0, -3.0, 30.0, -6.0, 103.0, 166.0, 134.0, 0.0, -4.0, 177.0, 131.0, -400.0, 0.0, 47.0, 54.0, -400.0, -261.0, 131.0, 103.0, -2.0, -12.0, 0.0, -146.0, 0.0, 0.0, 44.0, 176.0, -8.0, -22.0, 173.0, 192.0, 0.0, 131.0, -10.0, 163.0, 2.0, 0.0, 177.0, 0.0, 66.0, 87.0, 167.0, 0.0, 176.0, 117.0, -6.0, -14.0, 0.0, -20.0, 179.0, 61.0, -2.0, 160.0, -56.0, 0.0, 61.0, 59.0, 116.0, -10.0, 0.0, 0.0, -360.0, -381.0, 117.0, 0.0, 187.0, 41.0, 134.0, 118.0, 0.0, 144.0, -6.0, -270.0, 63.0, 27.0, 0.0, 173.0, 166.0, 157.0, -379.0, -374.0, -366.0, -343.0, 101.0, 140.0, 0.0, 106.0, 0.0, 127.0, 0.0, 176.0, -6.0, 0.0, 0.0, 0.0, 91.0, 190.0, 154.0, 0.0, -317.0, 0.0, 0.0, -6.0, 52.0, -380.0, -12.0, 25.0, 170.0, 0.0, -8.0, -316.0, 165.0, 158.0, 0.0, 198.0, 129.0, 0.0, 0.0, 95.0, -80.0, -345.0, 0.0, -358.0, 0.0, 169.0, -232.0, 0.0, 0.0, -42.0, 129.0, 200.0, 90.0, 177.0, 177.0, 164.0, 0.0, 188.0, 170.0, 0.0, -328.0, -400.0, 0.0, 0.0, -400.0, -63.0, 0.0, 0.0, -317.0, -8.0, 0.0, 0.0, -17.0, 0.0, 198.0, 0.0, 72.0, 0.0, 148.0, 0.0, -8.0, -368.0, -109.0, 5.0, -337.0, -184.0, 0.0, 190.0, 0.0, 8.0, 200.0, 140.0, 0.0, 193.0, -391.0, -66.0], "policy_predator_policy_reward": [168.0, 0.0, 0.0, 0.0, 43.0, 17.0, 6.0, 0.0, 0.0, 0.0, 14.0, 22.0, 13.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 68.0, 34.0, 174.0, 40.0, 4.0, 0.0, 66.0, 14.0, 0.0, 13.0, 6.0, 0.0, 2.0, 0.0, 8.0, 18.0, 23.0, 189.0, 33.0, 54.0, 0.0, 200.0, 12.0, 49.0, 35.0, 41.0, 85.0, 36.0, 0.0, 0.0, 52.0, 8.0, 0.0, 76.0, 3.0, 5.0, 19.0, 22.0, 3.0, 5.0, 0.0, 0.0, 0.0, 3.0, 2.0, 47.0, 8.0, 0.0, 0.0, 21.0, 10.0, 0.0, 0.0, 10.0, 0.0, 4.0, 0.0, 1.0, 51.0, 37.0, 42.0, 4.0, 5.0, 19.0, 0.0, 0.0, 0.0, 191.0, 18.0, 8.0, 22.0, 25.0, 0.0, 1.0, 8.0, 14.0, 151.0, 3.0, 51.0, 0.0, 9.0, 0.0, 17.0, 0.0, 189.0, 8.0, 7.0, 184.0, 0.0, 23.0, 13.0, 0.0, 15.0, 0.0, 6.0, 0.0, 3.0, 0.0, 0.0, 0.0, 4.0, 1.0, 12.0, 0.0, 167.0, 9.0, 3.0, 0.0, 193.0, 1.0, 6.0, 6.0, 10.0, 0.0, 160.0, 5.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 5.0, 12.0, 186.0, 10.0, 0.0, 8.0, 136.0, 62.0, 33.0, 22.0, 0.0, 10.0, 27.0, 0.0, 0.0, 0.0, 4.0, 8.0, 0.0, 190.0, 39.0, 0.0, 0.0, 200.0, 32.0, 0.0, 0.0, 12.0, 158.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 37.0, 0.0, 7.0, 14.0, 17.0, 173.0, 100.0, 3.0, 0.0, 200.0, 0.0, 2.0, 0.0, 0.0, 1.0, 17.0, 0.0, 0.0, 197.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4304028607104424, "mean_inference_ms": 4.124262909892601, "mean_action_processing_ms": 0.671685204408449, "mean_env_wait_ms": 0.5024831627549585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0055779218673706055, "StateBufferConnector_ms": 0.0046923160552978516, "ViewRequirementAgentConnector_ms": 0.19164931774139404}, "num_episodes": 18, "episode_return_max": 373.0, "episode_return_min": -556.0, "episode_return_mean": 69.68, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1696000, "num_agent_steps_trained": 1696000, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 239.74562968935527, "num_env_steps_trained_throughput_per_sec": 239.74562968935527, "timesteps_total": 424000, "num_env_steps_sampled_lifetime": 424000, "num_agent_steps_sampled_lifetime": 1696000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1696000, "timers": {"training_iteration_time_ms": 15643.972, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15643.913, "sample_time_ms": 3009.56, "learn_time_ms": 12608.55, "learn_throughput": 317.245, "synch_weights_time_ms": 20.692}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 1696000, "num_agent_steps_trained": 1696000}, "done": false, "training_iteration": 106, "trial_id": "f6b99_00000", "date": "2024-08-13_20-21-39", "timestamp": 1723594899, "time_this_iter_s": 16.7794029712677, "time_total_s": 2199.6557891368866, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6219d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2199.6557891368866, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 58.51250000000001, "ram_util_percent": 83.90416666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2506753753102013, "cur_kl_coeff": 0.007910156249999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.455201346785934, "policy_loss": -0.004538681726809098, "vf_loss": 5.459639805460733, "vf_explained_var": -0.011795751222226985, "kl": 0.012670408333177723, "entropy": 0.6163406990980976, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 201285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1358024966149105, "cur_kl_coeff": 0.0014831542968750005, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.3299467342871205, "policy_loss": 0.0019455732393359381, "vf_loss": 5.327980105082194, "vf_explained_var": -0.35537134106197055, "kl": 0.014181232766660052, "entropy": 0.9360902020224818, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 201285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 1712000, "num_agent_steps_trained": 1712000}, "env_runners": {"episode_reward_max": 373.0, "episode_reward_min": -562.0, "episode_reward_mean": 48.36, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -9.805, "predator_policy": 33.985}, "custom_metrics": {}, "hist_stats": {"episode_reward": [62.0, -25.0, 0.0, 280.0, 46.0, 373.0, 172.0, 161.0, 2.0, 180.0, 202.0, 175.0, 314.0, -10.0, -10.0, 244.0, 159.0, 32.0, 166.0, 130.0, 0.0, -550.0, 143.0, 275.0, 253.0, 166.0, -122.0, 141.0, 182.0, 340.0, -556.0, -518.0, 264.0, 119.0, 142.0, 182.0, -3.0, 0.0, 286.0, 166.0, -141.0, -3.0, -134.0, 25.0, 180.0, -159.0, 337.0, 198.0, 129.0, 95.0, -220.0, -160.0, 179.0, -88.0, 53.0, 351.0, 304.0, 341.0, 192.0, 178.0, -499.0, 0.0, -231.0, 0.0, -155.0, 0.0, -6.0, 198.0, 109.0, 169.0, -186.0, -1.0, -321.0, 192.0, 8.0, 358.0, 193.0, -260.0, -62.0, -230.0, 0.0, -12.0, 36.0, 312.0, 349.0, 138.0, -76.0, 0.0, 137.0, -562.0, 337.0, -166.0, 262.0, -152.0, 0.0, -151.0, -3.0, -158.0, -7.0, 56.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.0, -12.0, 0.0, -146.0, 0.0, 0.0, 44.0, 176.0, -8.0, -22.0, 173.0, 192.0, 0.0, 131.0, -10.0, 163.0, 2.0, 0.0, 177.0, 0.0, 66.0, 87.0, 167.0, 0.0, 176.0, 117.0, -6.0, -14.0, 0.0, -20.0, 179.0, 61.0, -2.0, 160.0, -56.0, 0.0, 61.0, 59.0, 116.0, -10.0, 0.0, 0.0, -360.0, -381.0, 117.0, 0.0, 187.0, 41.0, 134.0, 118.0, 0.0, 144.0, -6.0, -270.0, 63.0, 27.0, 0.0, 173.0, 166.0, 157.0, -379.0, -374.0, -366.0, -343.0, 101.0, 140.0, 0.0, 106.0, 0.0, 127.0, 0.0, 176.0, -6.0, 0.0, 0.0, 0.0, 91.0, 190.0, 154.0, 0.0, -317.0, 0.0, 0.0, -6.0, 52.0, -380.0, -12.0, 25.0, 170.0, 0.0, -8.0, -316.0, 165.0, 158.0, 0.0, 198.0, 129.0, 0.0, 0.0, 95.0, -80.0, -345.0, 0.0, -358.0, 0.0, 169.0, -232.0, 0.0, 0.0, -42.0, 129.0, 200.0, 90.0, 177.0, 177.0, 164.0, 0.0, 188.0, 170.0, 0.0, -328.0, -400.0, 0.0, 0.0, -400.0, -63.0, 0.0, 0.0, -317.0, -8.0, 0.0, 0.0, -17.0, 0.0, 198.0, 0.0, 72.0, 0.0, 148.0, 0.0, -8.0, -368.0, -109.0, 5.0, -337.0, -184.0, 0.0, 190.0, 0.0, 8.0, 200.0, 140.0, 0.0, 193.0, -391.0, -66.0, 0.0, -200.0, -182.0, -301.0, 0.0, 0.0, -10.0, -29.0, 0.0, -47.0, 120.0, 173.0, 119.0, 192.0, 163.0, -166.0, 0.0, -291.0, 0.0, 0.0, 110.0, 0.0, -374.0, -388.0, 144.0, 175.0, -400.0, -160.0, 43.0, 156.0, -73.0, -343.0, 0.0, 0.0, -366.0, -8.0, 0.0, -6.0, -333.0, 0.0, -18.0, -101.0, 0.0, -4.0], "policy_predator_policy_reward": [35.0, 41.0, 85.0, 36.0, 0.0, 0.0, 52.0, 8.0, 0.0, 76.0, 3.0, 5.0, 19.0, 22.0, 3.0, 5.0, 0.0, 0.0, 0.0, 3.0, 2.0, 47.0, 8.0, 0.0, 0.0, 21.0, 10.0, 0.0, 0.0, 10.0, 0.0, 4.0, 0.0, 1.0, 51.0, 37.0, 42.0, 4.0, 5.0, 19.0, 0.0, 0.0, 0.0, 191.0, 18.0, 8.0, 22.0, 25.0, 0.0, 1.0, 8.0, 14.0, 151.0, 3.0, 51.0, 0.0, 9.0, 0.0, 17.0, 0.0, 189.0, 8.0, 7.0, 184.0, 0.0, 23.0, 13.0, 0.0, 15.0, 0.0, 6.0, 0.0, 3.0, 0.0, 0.0, 0.0, 4.0, 1.0, 12.0, 0.0, 167.0, 9.0, 3.0, 0.0, 193.0, 1.0, 6.0, 6.0, 10.0, 0.0, 160.0, 5.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 5.0, 12.0, 186.0, 10.0, 0.0, 8.0, 136.0, 62.0, 33.0, 22.0, 0.0, 10.0, 27.0, 0.0, 0.0, 0.0, 4.0, 8.0, 0.0, 190.0, 39.0, 0.0, 0.0, 200.0, 32.0, 0.0, 0.0, 12.0, 158.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 37.0, 0.0, 7.0, 14.0, 17.0, 173.0, 100.0, 3.0, 0.0, 200.0, 0.0, 2.0, 0.0, 0.0, 1.0, 17.0, 0.0, 0.0, 197.0, 0.0, 26.0, 112.0, 180.0, 73.0, 0.0, 0.0, 27.0, 0.0, 36.0, 47.0, 19.0, 0.0, 11.0, 27.0, 23.0, 118.0, 131.0, 84.0, 0.0, 0.0, 1.0, 26.0, 198.0, 2.0, 18.0, 0.0, 194.0, 200.0, 14.0, 49.0, 178.0, 86.0, 0.0, 0.0, 188.0, 35.0, 3.0, 0.0, 0.0, 175.0, 10.0, 102.0, 60.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4328250195594174, "mean_inference_ms": 4.134147203471422, "mean_action_processing_ms": 0.6830711181464197, "mean_env_wait_ms": 0.5042998066659077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005694985389709473, "StateBufferConnector_ms": 0.004660964012145996, "ViewRequirementAgentConnector_ms": 0.20719099044799805}, "num_episodes": 22, "episode_return_max": 373.0, "episode_return_min": -562.0, "episode_return_mean": 48.36, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1712000, "num_agent_steps_trained": 1712000, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 151.3001681838844, "num_env_steps_trained_throughput_per_sec": 151.3001681838844, "timesteps_total": 428000, "num_env_steps_sampled_lifetime": 428000, "num_agent_steps_sampled_lifetime": 1712000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1712000, "timers": {"training_iteration_time_ms": 16424.528, "restore_workers_time_ms": 0.015, "training_step_time_ms": 16424.471, "sample_time_ms": 3031.387, "learn_time_ms": 13367.107, "learn_throughput": 299.242, "synch_weights_time_ms": 20.78}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 1712000, "num_agent_steps_trained": 1712000}, "done": false, "training_iteration": 107, "trial_id": "f6b99_00000", "date": "2024-08-13_20-22-06", "timestamp": 1723594926, "time_this_iter_s": 26.585273265838623, "time_total_s": 2226.241062402725, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b62a7160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2226.241062402725, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 80.25483870967744, "ram_util_percent": 84.20645161290321}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2824575644321543, "cur_kl_coeff": 0.007910156249999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.532821112839633, "policy_loss": -0.004725556648410265, "vf_loss": 7.537488643959086, "vf_explained_var": 0.026533236263921022, "kl": 0.007333380284717591, "entropy": 0.4887912124710739, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 203175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1690204024157196, "cur_kl_coeff": 0.0014831542968750005, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.083357773634492, "policy_loss": -0.0041884853528004395, "vf_loss": 6.087521762191934, "vf_explained_var": -0.9514225032594469, "kl": 0.016517515190607922, "entropy": 0.9177779420973763, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 203175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000}, "env_runners": {"episode_reward_max": 358.0, "episode_reward_min": -562.0, "episode_reward_mean": 11.96, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -41.03, "predator_policy": 47.01}, "custom_metrics": {}, "hist_stats": {"episode_reward": [166.0, 130.0, 0.0, -550.0, 143.0, 275.0, 253.0, 166.0, -122.0, 141.0, 182.0, 340.0, -556.0, -518.0, 264.0, 119.0, 142.0, 182.0, -3.0, 0.0, 286.0, 166.0, -141.0, -3.0, -134.0, 25.0, 180.0, -159.0, 337.0, 198.0, 129.0, 95.0, -220.0, -160.0, 179.0, -88.0, 53.0, 351.0, 304.0, 341.0, 192.0, 178.0, -499.0, 0.0, -231.0, 0.0, -155.0, 0.0, -6.0, 198.0, 109.0, 169.0, -186.0, -1.0, -321.0, 192.0, 8.0, 358.0, 193.0, -260.0, -62.0, -230.0, 0.0, -12.0, 36.0, 312.0, 349.0, 138.0, -76.0, 0.0, 137.0, -562.0, 337.0, -166.0, 262.0, -152.0, 0.0, -151.0, -3.0, -158.0, -7.0, 56.0, 0.0, -9.0, -287.0, -124.0, -39.0, -102.0, -1.0, 0.0, -102.0, -211.0, -139.0, -4.0, 62.0, -9.0, -6.0, -440.0, 144.0, -16.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [61.0, 59.0, 116.0, -10.0, 0.0, 0.0, -360.0, -381.0, 117.0, 0.0, 187.0, 41.0, 134.0, 118.0, 0.0, 144.0, -6.0, -270.0, 63.0, 27.0, 0.0, 173.0, 166.0, 157.0, -379.0, -374.0, -366.0, -343.0, 101.0, 140.0, 0.0, 106.0, 0.0, 127.0, 0.0, 176.0, -6.0, 0.0, 0.0, 0.0, 91.0, 190.0, 154.0, 0.0, -317.0, 0.0, 0.0, -6.0, 52.0, -380.0, -12.0, 25.0, 170.0, 0.0, -8.0, -316.0, 165.0, 158.0, 0.0, 198.0, 129.0, 0.0, 0.0, 95.0, -80.0, -345.0, 0.0, -358.0, 0.0, 169.0, -232.0, 0.0, 0.0, -42.0, 129.0, 200.0, 90.0, 177.0, 177.0, 164.0, 0.0, 188.0, 170.0, 0.0, -328.0, -400.0, 0.0, 0.0, -400.0, -63.0, 0.0, 0.0, -317.0, -8.0, 0.0, 0.0, -17.0, 0.0, 198.0, 0.0, 72.0, 0.0, 148.0, 0.0, -8.0, -368.0, -109.0, 5.0, -337.0, -184.0, 0.0, 190.0, 0.0, 8.0, 200.0, 140.0, 0.0, 193.0, -391.0, -66.0, 0.0, -200.0, -182.0, -301.0, 0.0, 0.0, -10.0, -29.0, 0.0, -47.0, 120.0, 173.0, 119.0, 192.0, 163.0, -166.0, 0.0, -291.0, 0.0, 0.0, 110.0, 0.0, -374.0, -388.0, 144.0, 175.0, -400.0, -160.0, 43.0, 156.0, -73.0, -343.0, 0.0, 0.0, -366.0, -8.0, 0.0, -6.0, -333.0, 0.0, -18.0, -101.0, 0.0, -4.0, 0.0, 0.0, 0.0, -159.0, -333.0, -280.0, -337.0, 0.0, -283.0, 57.0, -61.0, -233.0, -133.0, 0.0, 0.0, 0.0, 0.0, -267.0, -268.0, -245.0, -349.0, -44.0, -305.0, 0.0, -25.0, 0.0, -18.0, 0.0, -181.0, -18.0, -367.0, -339.0, -12.0, 125.0, 0.0, -397.0], "policy_predator_policy_reward": [42.0, 4.0, 5.0, 19.0, 0.0, 0.0, 0.0, 191.0, 18.0, 8.0, 22.0, 25.0, 0.0, 1.0, 8.0, 14.0, 151.0, 3.0, 51.0, 0.0, 9.0, 0.0, 17.0, 0.0, 189.0, 8.0, 7.0, 184.0, 0.0, 23.0, 13.0, 0.0, 15.0, 0.0, 6.0, 0.0, 3.0, 0.0, 0.0, 0.0, 4.0, 1.0, 12.0, 0.0, 167.0, 9.0, 3.0, 0.0, 193.0, 1.0, 6.0, 6.0, 10.0, 0.0, 160.0, 5.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 5.0, 12.0, 186.0, 10.0, 0.0, 8.0, 136.0, 62.0, 33.0, 22.0, 0.0, 10.0, 27.0, 0.0, 0.0, 0.0, 4.0, 8.0, 0.0, 190.0, 39.0, 0.0, 0.0, 200.0, 32.0, 0.0, 0.0, 12.0, 158.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 37.0, 0.0, 7.0, 14.0, 17.0, 173.0, 100.0, 3.0, 0.0, 200.0, 0.0, 2.0, 0.0, 0.0, 1.0, 17.0, 0.0, 0.0, 197.0, 0.0, 26.0, 112.0, 180.0, 73.0, 0.0, 0.0, 27.0, 0.0, 36.0, 47.0, 19.0, 0.0, 11.0, 27.0, 23.0, 118.0, 131.0, 84.0, 0.0, 0.0, 1.0, 26.0, 198.0, 2.0, 18.0, 0.0, 194.0, 200.0, 14.0, 49.0, 178.0, 86.0, 0.0, 0.0, 188.0, 35.0, 3.0, 0.0, 0.0, 175.0, 10.0, 102.0, 60.0, 0.0, 0.0, 0.0, 66.0, 84.0, 151.0, 175.0, 161.0, 52.0, 29.0, 158.0, 75.0, 117.0, 107.0, 25.0, 0.0, 0.0, 153.0, 12.0, 161.0, 141.0, 70.0, 184.0, 147.0, 154.0, 21.0, 66.0, 0.0, 9.0, 126.0, 67.0, 81.0, 185.0, 23.0, 8.0, 189.0, 192.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4241343508586914, "mean_inference_ms": 4.111511145396414, "mean_action_processing_ms": 0.6837455269245614, "mean_env_wait_ms": 0.500780440261316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005350232124328613, "StateBufferConnector_ms": 0.004240870475769043, "ViewRequirementAgentConnector_ms": 0.17500543594360352}, "num_episodes": 18, "episode_return_max": 358.0, "episode_return_min": -562.0, "episode_return_mean": 11.96, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 246.4127990009784, "num_env_steps_trained_throughput_per_sec": 246.4127990009784, "timesteps_total": 432000, "num_env_steps_sampled_lifetime": 432000, "num_agent_steps_sampled_lifetime": 1728000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1728000, "timers": {"training_iteration_time_ms": 16411.513, "restore_workers_time_ms": 0.015, "training_step_time_ms": 16411.453, "sample_time_ms": 2840.107, "learn_time_ms": 13543.819, "learn_throughput": 295.338, "synch_weights_time_ms": 22.286}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000}, "done": false, "training_iteration": 108, "trial_id": "f6b99_00000", "date": "2024-08-13_20-22-23", "timestamp": 1723594943, "time_this_iter_s": 16.27172088623047, "time_total_s": 2242.5127832889557, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6087f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2242.5127832889557, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 63.58695652173914, "ram_util_percent": 83.87826086956522}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7537411411287924, "cur_kl_coeff": 0.007910156249999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.93546471267781, "policy_loss": -0.005227156520559989, "vf_loss": 8.940594558867197, "vf_explained_var": -0.022223097243637004, "kl": 0.01230215816110931, "entropy": 0.2891902025729891, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 205065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.326986962667218, "cur_kl_coeff": 0.0014831542968750005, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.3809115452741185, "policy_loss": -0.004147566692095506, "vf_loss": 6.385037764796504, "vf_explained_var": -0.970944097559288, "kl": 0.014393305735632272, "entropy": 0.9055272856402019, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 205065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 1744000, "num_agent_steps_trained": 1744000}, "env_runners": {"episode_reward_max": 358.0, "episode_reward_min": -562.0, "episode_reward_mean": -24.12, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -76.38, "predator_policy": 64.32}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, 0.0, 286.0, 166.0, -141.0, -3.0, -134.0, 25.0, 180.0, -159.0, 337.0, 198.0, 129.0, 95.0, -220.0, -160.0, 179.0, -88.0, 53.0, 351.0, 304.0, 341.0, 192.0, 178.0, -499.0, 0.0, -231.0, 0.0, -155.0, 0.0, -6.0, 198.0, 109.0, 169.0, -186.0, -1.0, -321.0, 192.0, 8.0, 358.0, 193.0, -260.0, -62.0, -230.0, 0.0, -12.0, 36.0, 312.0, 349.0, 138.0, -76.0, 0.0, 137.0, -562.0, 337.0, -166.0, 262.0, -152.0, 0.0, -151.0, -3.0, -158.0, -7.0, 56.0, 0.0, -9.0, -287.0, -124.0, -39.0, -102.0, -1.0, 0.0, -102.0, -211.0, -139.0, -4.0, 62.0, -9.0, -6.0, -440.0, 144.0, -16.0, -68.0, -398.0, -340.0, -42.0, 10.0, -24.0, -3.0, -1.0, -334.0, -47.0, 27.0, -355.0, 0.0, 69.0, -301.0, -408.0, -370.0, -266.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.0, 0.0, 0.0, 0.0, 91.0, 190.0, 154.0, 0.0, -317.0, 0.0, 0.0, -6.0, 52.0, -380.0, -12.0, 25.0, 170.0, 0.0, -8.0, -316.0, 165.0, 158.0, 0.0, 198.0, 129.0, 0.0, 0.0, 95.0, -80.0, -345.0, 0.0, -358.0, 0.0, 169.0, -232.0, 0.0, 0.0, -42.0, 129.0, 200.0, 90.0, 177.0, 177.0, 164.0, 0.0, 188.0, 170.0, 0.0, -328.0, -400.0, 0.0, 0.0, -400.0, -63.0, 0.0, 0.0, -317.0, -8.0, 0.0, 0.0, -17.0, 0.0, 198.0, 0.0, 72.0, 0.0, 148.0, 0.0, -8.0, -368.0, -109.0, 5.0, -337.0, -184.0, 0.0, 190.0, 0.0, 8.0, 200.0, 140.0, 0.0, 193.0, -391.0, -66.0, 0.0, -200.0, -182.0, -301.0, 0.0, 0.0, -10.0, -29.0, 0.0, -47.0, 120.0, 173.0, 119.0, 192.0, 163.0, -166.0, 0.0, -291.0, 0.0, 0.0, 110.0, 0.0, -374.0, -388.0, 144.0, 175.0, -400.0, -160.0, 43.0, 156.0, -73.0, -343.0, 0.0, 0.0, -366.0, -8.0, 0.0, -6.0, -333.0, 0.0, -18.0, -101.0, 0.0, -4.0, 0.0, 0.0, 0.0, -159.0, -333.0, -280.0, -337.0, 0.0, -283.0, 57.0, -61.0, -233.0, -133.0, 0.0, 0.0, 0.0, 0.0, -267.0, -268.0, -245.0, -349.0, -44.0, -305.0, 0.0, -25.0, 0.0, -18.0, 0.0, -181.0, -18.0, -367.0, -339.0, -12.0, 125.0, 0.0, -397.0, -8.0, -207.0, -398.0, -400.0, -397.0, -328.0, -28.0, -268.0, 0.0, -276.0, 0.0, -382.0, 0.0, -149.0, -155.0, 0.0, -373.0, -323.0, 4.0, -173.0, -76.0, 0.0, -350.0, -352.0, 0.0, 0.0, 0.0, -113.0, -394.0, -294.0, -376.0, -394.0, -340.0, -274.0, -367.0, -155.0], "policy_predator_policy_reward": [3.0, 0.0, 0.0, 0.0, 4.0, 1.0, 12.0, 0.0, 167.0, 9.0, 3.0, 0.0, 193.0, 1.0, 6.0, 6.0, 10.0, 0.0, 160.0, 5.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 5.0, 12.0, 186.0, 10.0, 0.0, 8.0, 136.0, 62.0, 33.0, 22.0, 0.0, 10.0, 27.0, 0.0, 0.0, 0.0, 4.0, 8.0, 0.0, 190.0, 39.0, 0.0, 0.0, 200.0, 32.0, 0.0, 0.0, 12.0, 158.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 37.0, 0.0, 7.0, 14.0, 17.0, 173.0, 100.0, 3.0, 0.0, 200.0, 0.0, 2.0, 0.0, 0.0, 1.0, 17.0, 0.0, 0.0, 197.0, 0.0, 26.0, 112.0, 180.0, 73.0, 0.0, 0.0, 27.0, 0.0, 36.0, 47.0, 19.0, 0.0, 11.0, 27.0, 23.0, 118.0, 131.0, 84.0, 0.0, 0.0, 1.0, 26.0, 198.0, 2.0, 18.0, 0.0, 194.0, 200.0, 14.0, 49.0, 178.0, 86.0, 0.0, 0.0, 188.0, 35.0, 3.0, 0.0, 0.0, 175.0, 10.0, 102.0, 60.0, 0.0, 0.0, 0.0, 66.0, 84.0, 151.0, 175.0, 161.0, 52.0, 29.0, 158.0, 75.0, 117.0, 107.0, 25.0, 0.0, 0.0, 153.0, 12.0, 161.0, 141.0, 70.0, 184.0, 147.0, 154.0, 21.0, 66.0, 0.0, 9.0, 126.0, 67.0, 81.0, 185.0, 23.0, 8.0, 189.0, 192.0, 132.0, 15.0, 200.0, 200.0, 194.0, 191.0, 109.0, 145.0, 155.0, 131.0, 177.0, 181.0, 37.0, 109.0, 108.0, 46.0, 191.0, 171.0, 53.0, 69.0, 65.0, 38.0, 175.0, 172.0, 0.0, 0.0, 85.0, 97.0, 197.0, 190.0, 200.0, 162.0, 178.0, 66.0, 71.0, 185.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.41991333310421, "mean_inference_ms": 4.100617115874624, "mean_action_processing_ms": 0.6883497561452954, "mean_env_wait_ms": 0.49928335331819, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005317807197570801, "StateBufferConnector_ms": 0.0037473440170288086, "ViewRequirementAgentConnector_ms": 0.1484529972076416}, "num_episodes": 18, "episode_return_max": 358.0, "episode_return_min": -562.0, "episode_return_mean": -24.12, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1744000, "num_agent_steps_trained": 1744000, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.77746131546326, "num_env_steps_trained_throughput_per_sec": 292.77746131546326, "timesteps_total": 436000, "num_env_steps_sampled_lifetime": 436000, "num_agent_steps_sampled_lifetime": 1744000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1744000, "timers": {"training_iteration_time_ms": 16361.282, "restore_workers_time_ms": 0.015, "training_step_time_ms": 16361.222, "sample_time_ms": 2800.728, "learn_time_ms": 13533.557, "learn_throughput": 295.562, "synch_weights_time_ms": 21.843}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 1744000, "num_agent_steps_trained": 1744000}, "done": false, "training_iteration": 109, "trial_id": "f6b99_00000", "date": "2024-08-13_20-22-36", "timestamp": 1723594956, "time_this_iter_s": 13.72192907333374, "time_total_s": 2256.2347123622894, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b623de50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2256.2347123622894, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 53.760000000000005, "ram_util_percent": 82.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6042681322842047, "cur_kl_coeff": 0.007910156249999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.75538631292878, "policy_loss": -0.003081764875068551, "vf_loss": 6.7584239765449805, "vf_explained_var": 0.013793559869130452, "kl": 0.005576660990283403, "entropy": 0.3010905879830557, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 206955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5563479425730529, "cur_kl_coeff": 0.0014831542968750005, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.182833090282622, "policy_loss": -0.004474657437660628, "vf_loss": 4.187290705322589, "vf_explained_var": -0.9981694616337933, "kl": 0.011485675917194448, "entropy": 0.5933540562315592, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 206955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000}, "env_runners": {"episode_reward_max": 358.0, "episode_reward_min": -562.0, "episode_reward_mean": -52.91, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -104.55, "predator_policy": 78.095}, "custom_metrics": {}, "hist_stats": {"episode_reward": [178.0, -499.0, 0.0, -231.0, 0.0, -155.0, 0.0, -6.0, 198.0, 109.0, 169.0, -186.0, -1.0, -321.0, 192.0, 8.0, 358.0, 193.0, -260.0, -62.0, -230.0, 0.0, -12.0, 36.0, 312.0, 349.0, 138.0, -76.0, 0.0, 137.0, -562.0, 337.0, -166.0, 262.0, -152.0, 0.0, -151.0, -3.0, -158.0, -7.0, 56.0, 0.0, -9.0, -287.0, -124.0, -39.0, -102.0, -1.0, 0.0, -102.0, -211.0, -139.0, -4.0, 62.0, -9.0, -6.0, -440.0, 144.0, -16.0, -68.0, -398.0, -340.0, -42.0, 10.0, -24.0, -3.0, -1.0, -334.0, -47.0, 27.0, -355.0, 0.0, 69.0, -301.0, -408.0, -370.0, -266.0, 0.0, -21.0, -79.0, 0.0, -58.0, 203.0, -170.0, 0.0, -41.0, -28.0, -63.0, -94.0, -9.0, -22.0, -74.0, -5.0, -51.0, -70.0, 3.0, -1.0, -315.0, -56.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [170.0, 0.0, -328.0, -400.0, 0.0, 0.0, -400.0, -63.0, 0.0, 0.0, -317.0, -8.0, 0.0, 0.0, -17.0, 0.0, 198.0, 0.0, 72.0, 0.0, 148.0, 0.0, -8.0, -368.0, -109.0, 5.0, -337.0, -184.0, 0.0, 190.0, 0.0, 8.0, 200.0, 140.0, 0.0, 193.0, -391.0, -66.0, 0.0, -200.0, -182.0, -301.0, 0.0, 0.0, -10.0, -29.0, 0.0, -47.0, 120.0, 173.0, 119.0, 192.0, 163.0, -166.0, 0.0, -291.0, 0.0, 0.0, 110.0, 0.0, -374.0, -388.0, 144.0, 175.0, -400.0, -160.0, 43.0, 156.0, -73.0, -343.0, 0.0, 0.0, -366.0, -8.0, 0.0, -6.0, -333.0, 0.0, -18.0, -101.0, 0.0, -4.0, 0.0, 0.0, 0.0, -159.0, -333.0, -280.0, -337.0, 0.0, -283.0, 57.0, -61.0, -233.0, -133.0, 0.0, 0.0, 0.0, 0.0, -267.0, -268.0, -245.0, -349.0, -44.0, -305.0, 0.0, -25.0, 0.0, -18.0, 0.0, -181.0, -18.0, -367.0, -339.0, -12.0, 125.0, 0.0, -397.0, -8.0, -207.0, -398.0, -400.0, -397.0, -328.0, -28.0, -268.0, 0.0, -276.0, 0.0, -382.0, 0.0, -149.0, -155.0, 0.0, -373.0, -323.0, 4.0, -173.0, -76.0, 0.0, -350.0, -352.0, 0.0, 0.0, 0.0, -113.0, -394.0, -294.0, -376.0, -394.0, -340.0, -274.0, -367.0, -155.0, 0.0, 0.0, 0.0, -340.0, -205.0, -18.0, 0.0, 0.0, 0.0, -367.0, 105.0, 52.0, -356.0, 0.0, 0.0, 0.0, -379.0, 0.0, -326.0, 0.0, -345.0, 0.0, -2.0, -385.0, -14.0, -4.0, 0.0, -285.0, 0.0, -228.0, -145.0, 0.0, -346.0, -4.0, -241.0, 0.0, -69.0, 0.0, -132.0, 0.0, -392.0, -241.0, 0.0, -348.0, 0.0, 0.0], "policy_predator_policy_reward": [8.0, 0.0, 190.0, 39.0, 0.0, 0.0, 200.0, 32.0, 0.0, 0.0, 12.0, 158.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 37.0, 0.0, 7.0, 14.0, 17.0, 173.0, 100.0, 3.0, 0.0, 200.0, 0.0, 2.0, 0.0, 0.0, 1.0, 17.0, 0.0, 0.0, 197.0, 0.0, 26.0, 112.0, 180.0, 73.0, 0.0, 0.0, 27.0, 0.0, 36.0, 47.0, 19.0, 0.0, 11.0, 27.0, 23.0, 118.0, 131.0, 84.0, 0.0, 0.0, 1.0, 26.0, 198.0, 2.0, 18.0, 0.0, 194.0, 200.0, 14.0, 49.0, 178.0, 86.0, 0.0, 0.0, 188.0, 35.0, 3.0, 0.0, 0.0, 175.0, 10.0, 102.0, 60.0, 0.0, 0.0, 0.0, 66.0, 84.0, 151.0, 175.0, 161.0, 52.0, 29.0, 158.0, 75.0, 117.0, 107.0, 25.0, 0.0, 0.0, 153.0, 12.0, 161.0, 141.0, 70.0, 184.0, 147.0, 154.0, 21.0, 66.0, 0.0, 9.0, 126.0, 67.0, 81.0, 185.0, 23.0, 8.0, 189.0, 192.0, 132.0, 15.0, 200.0, 200.0, 194.0, 191.0, 109.0, 145.0, 155.0, 131.0, 177.0, 181.0, 37.0, 109.0, 108.0, 46.0, 191.0, 171.0, 53.0, 69.0, 65.0, 38.0, 175.0, 172.0, 0.0, 0.0, 85.0, 97.0, 197.0, 190.0, 200.0, 162.0, 178.0, 66.0, 71.0, 185.0, 0.0, 0.0, 171.0, 148.0, 132.0, 12.0, 0.0, 0.0, 162.0, 147.0, 16.0, 30.0, 182.0, 4.0, 0.0, 0.0, 176.0, 162.0, 146.0, 152.0, 109.0, 173.0, 193.0, 100.0, 9.0, 0.0, 140.0, 123.0, 112.0, 42.0, 44.0, 96.0, 126.0, 173.0, 41.0, 130.0, 59.0, 13.0, 30.0, 101.0, 196.0, 122.0, 118.0, 174.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4145723338393674, "mean_inference_ms": 4.086568127093425, "mean_action_processing_ms": 0.6941698447773952, "mean_env_wait_ms": 0.49728202043449576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005653500556945801, "StateBufferConnector_ms": 0.004106760025024414, "ViewRequirementAgentConnector_ms": 0.15039372444152832}, "num_episodes": 23, "episode_return_max": 358.0, "episode_return_min": -562.0, "episode_return_mean": -52.91, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 254.14818825441176, "num_env_steps_trained_throughput_per_sec": 254.14818825441176, "timesteps_total": 440000, "num_env_steps_sampled_lifetime": 440000, "num_agent_steps_sampled_lifetime": 1760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1760000, "timers": {"training_iteration_time_ms": 16519.241, "restore_workers_time_ms": 0.015, "training_step_time_ms": 16519.181, "sample_time_ms": 2727.067, "learn_time_ms": 13764.504, "learn_throughput": 290.603, "synch_weights_time_ms": 22.1}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000}, "done": false, "training_iteration": 110, "trial_id": "f6b99_00000", "date": "2024-08-13_20-22-52", "timestamp": 1723594972, "time_this_iter_s": 15.842880010604858, "time_total_s": 2272.0775923728943, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b62a7160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2272.0775923728943, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 62.18636363636365, "ram_util_percent": 83.73181818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5950308393233668, "cur_kl_coeff": 0.007910156249999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.73157482576118, "policy_loss": -0.004751077683755842, "vf_loss": 5.736284461097112, "vf_explained_var": 0.030389497393653507, "kl": 0.005240967938909032, "entropy": 0.2845810106112843, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 208845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2413838741640566, "cur_kl_coeff": 0.0014831542968750005, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.61762836446207, "policy_loss": -0.0036067360644992537, "vf_loss": 4.621217122784367, "vf_explained_var": -0.9980961660859446, "kl": 0.012121292225882917, "entropy": 0.6528193615101002, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 208845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000}, "env_runners": {"episode_reward_max": 349.0, "episode_reward_min": -562.0, "episode_reward_mean": -71.86, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 192.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -125.155, "predator_policy": 89.225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-260.0, -62.0, -230.0, 0.0, -12.0, 36.0, 312.0, 349.0, 138.0, -76.0, 0.0, 137.0, -562.0, 337.0, -166.0, 262.0, -152.0, 0.0, -151.0, -3.0, -158.0, -7.0, 56.0, 0.0, -9.0, -287.0, -124.0, -39.0, -102.0, -1.0, 0.0, -102.0, -211.0, -139.0, -4.0, 62.0, -9.0, -6.0, -440.0, 144.0, -16.0, -68.0, -398.0, -340.0, -42.0, 10.0, -24.0, -3.0, -1.0, -334.0, -47.0, 27.0, -355.0, 0.0, 69.0, -301.0, -408.0, -370.0, -266.0, 0.0, -21.0, -79.0, 0.0, -58.0, 203.0, -170.0, 0.0, -41.0, -28.0, -63.0, -94.0, -9.0, -22.0, -74.0, -5.0, -51.0, -70.0, 3.0, -1.0, -315.0, -56.0, 0.0, -342.0, 0.0, -6.0, -56.0, -41.0, -153.0, -78.0, -107.0, 21.0, -62.0, -356.0, -242.0, 0.0, -159.0, -6.0, 2.0, -299.0, -5.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-391.0, -66.0, 0.0, -200.0, -182.0, -301.0, 0.0, 0.0, -10.0, -29.0, 0.0, -47.0, 120.0, 173.0, 119.0, 192.0, 163.0, -166.0, 0.0, -291.0, 0.0, 0.0, 110.0, 0.0, -374.0, -388.0, 144.0, 175.0, -400.0, -160.0, 43.0, 156.0, -73.0, -343.0, 0.0, 0.0, -366.0, -8.0, 0.0, -6.0, -333.0, 0.0, -18.0, -101.0, 0.0, -4.0, 0.0, 0.0, 0.0, -159.0, -333.0, -280.0, -337.0, 0.0, -283.0, 57.0, -61.0, -233.0, -133.0, 0.0, 0.0, 0.0, 0.0, -267.0, -268.0, -245.0, -349.0, -44.0, -305.0, 0.0, -25.0, 0.0, -18.0, 0.0, -181.0, -18.0, -367.0, -339.0, -12.0, 125.0, 0.0, -397.0, -8.0, -207.0, -398.0, -400.0, -397.0, -328.0, -28.0, -268.0, 0.0, -276.0, 0.0, -382.0, 0.0, -149.0, -155.0, 0.0, -373.0, -323.0, 4.0, -173.0, -76.0, 0.0, -350.0, -352.0, 0.0, 0.0, 0.0, -113.0, -394.0, -294.0, -376.0, -394.0, -340.0, -274.0, -367.0, -155.0, 0.0, 0.0, 0.0, -340.0, -205.0, -18.0, 0.0, 0.0, 0.0, -367.0, 105.0, 52.0, -356.0, 0.0, 0.0, 0.0, -379.0, 0.0, -326.0, 0.0, -345.0, 0.0, -2.0, -385.0, -14.0, -4.0, 0.0, -285.0, 0.0, -228.0, -145.0, 0.0, -346.0, -4.0, -241.0, 0.0, -69.0, 0.0, -132.0, 0.0, -392.0, -241.0, 0.0, -348.0, 0.0, 0.0, -236.0, -363.0, 0.0, 0.0, -10.0, -2.0, -318.0, 0.0, -355.0, -16.0, -249.0, -209.0, 0.0, -323.0, -226.0, -18.0, -277.0, 0.0, -205.0, 0.0, -400.0, -297.0, -325.0, -267.0, 0.0, 0.0, -396.0, 0.0, 0.0, -12.0, -226.0, 0.0, -279.0, -317.0, 0.0, -10.0], "policy_predator_policy_reward": [197.0, 0.0, 26.0, 112.0, 180.0, 73.0, 0.0, 0.0, 27.0, 0.0, 36.0, 47.0, 19.0, 0.0, 11.0, 27.0, 23.0, 118.0, 131.0, 84.0, 0.0, 0.0, 1.0, 26.0, 198.0, 2.0, 18.0, 0.0, 194.0, 200.0, 14.0, 49.0, 178.0, 86.0, 0.0, 0.0, 188.0, 35.0, 3.0, 0.0, 0.0, 175.0, 10.0, 102.0, 60.0, 0.0, 0.0, 0.0, 66.0, 84.0, 151.0, 175.0, 161.0, 52.0, 29.0, 158.0, 75.0, 117.0, 107.0, 25.0, 0.0, 0.0, 153.0, 12.0, 161.0, 141.0, 70.0, 184.0, 147.0, 154.0, 21.0, 66.0, 0.0, 9.0, 126.0, 67.0, 81.0, 185.0, 23.0, 8.0, 189.0, 192.0, 132.0, 15.0, 200.0, 200.0, 194.0, 191.0, 109.0, 145.0, 155.0, 131.0, 177.0, 181.0, 37.0, 109.0, 108.0, 46.0, 191.0, 171.0, 53.0, 69.0, 65.0, 38.0, 175.0, 172.0, 0.0, 0.0, 85.0, 97.0, 197.0, 190.0, 200.0, 162.0, 178.0, 66.0, 71.0, 185.0, 0.0, 0.0, 171.0, 148.0, 132.0, 12.0, 0.0, 0.0, 162.0, 147.0, 16.0, 30.0, 182.0, 4.0, 0.0, 0.0, 176.0, 162.0, 146.0, 152.0, 109.0, 173.0, 193.0, 100.0, 9.0, 0.0, 140.0, 123.0, 112.0, 42.0, 44.0, 96.0, 126.0, 173.0, 41.0, 130.0, 59.0, 13.0, 30.0, 101.0, 196.0, 122.0, 118.0, 174.0, 0.0, 0.0, 175.0, 82.0, 0.0, 0.0, 6.0, 0.0, 135.0, 127.0, 173.0, 157.0, 138.0, 167.0, 111.0, 134.0, 137.0, 0.0, 149.0, 149.0, 39.0, 104.0, 141.0, 200.0, 177.0, 173.0, 0.0, 0.0, 192.0, 45.0, 0.0, 6.0, 109.0, 119.0, 174.0, 123.0, 0.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4112332729616106, "mean_inference_ms": 4.07747590143429, "mean_action_processing_ms": 0.6919934532879634, "mean_env_wait_ms": 0.4959984091436199, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005729079246520996, "StateBufferConnector_ms": 0.004155993461608887, "ViewRequirementAgentConnector_ms": 0.16068899631500244}, "num_episodes": 18, "episode_return_max": 349.0, "episode_return_min": -562.0, "episode_return_mean": -71.86, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 35.68467377797311, "num_env_steps_trained_throughput_per_sec": 35.68467377797311, "timesteps_total": 444000, "num_env_steps_sampled_lifetime": 444000, "num_agent_steps_sampled_lifetime": 1776000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1776000, "timers": {"training_iteration_time_ms": 26281.16, "restore_workers_time_ms": 0.016, "training_step_time_ms": 26281.098, "sample_time_ms": 2729.804, "learn_time_ms": 23524.415, "learn_throughput": 170.036, "synch_weights_time_ms": 21.467}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000}, "done": false, "training_iteration": 111, "trial_id": "f6b99_00000", "date": "2024-08-13_20-24-45", "timestamp": 1723595085, "time_this_iter_s": 112.2846519947052, "time_total_s": 2384.3622443675995, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b623fee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2384.3622443675995, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 76.43793103448276, "ram_util_percent": 83.91379310344827}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.051324620038744, "cur_kl_coeff": 0.007910156249999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.6912121616343345, "policy_loss": -0.0034666594663615184, "vf_loss": 5.694644300521366, "vf_explained_var": 0.033817267039465526, "kl": 0.004364001054918248, "entropy": 0.19719108475973365, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 210735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0136236878772262, "cur_kl_coeff": 0.0014831542968750005, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.145104760089248, "policy_loss": -0.004834589093095727, "vf_loss": 4.149886447285849, "vf_explained_var": -0.9999563296635946, "kl": 0.0356730947425757, "entropy": 0.5399062561295019, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 210735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 1792000, "num_agent_steps_trained": 1792000}, "env_runners": {"episode_reward_max": 203.0, "episode_reward_min": -440.0, "episode_reward_mean": -78.48, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 125.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -128.91, "predator_policy": 89.67}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.0, 0.0, -9.0, -287.0, -124.0, -39.0, -102.0, -1.0, 0.0, -102.0, -211.0, -139.0, -4.0, 62.0, -9.0, -6.0, -440.0, 144.0, -16.0, -68.0, -398.0, -340.0, -42.0, 10.0, -24.0, -3.0, -1.0, -334.0, -47.0, 27.0, -355.0, 0.0, 69.0, -301.0, -408.0, -370.0, -266.0, 0.0, -21.0, -79.0, 0.0, -58.0, 203.0, -170.0, 0.0, -41.0, -28.0, -63.0, -94.0, -9.0, -22.0, -74.0, -5.0, -51.0, -70.0, 3.0, -1.0, -315.0, -56.0, 0.0, -342.0, 0.0, -6.0, -56.0, -41.0, -153.0, -78.0, -107.0, 21.0, -62.0, -356.0, -242.0, 0.0, -159.0, -6.0, 2.0, -299.0, -5.0, -2.0, -9.0, -15.0, 0.0, -132.0, 18.0, 138.0, 0.0, -150.0, 0.0, -40.0, -43.0, -193.0, -390.0, 77.0, 0.0, -121.0, -29.0, -2.0, -3.0, -6.0, -28.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -4.0, 0.0, 0.0, 0.0, -159.0, -333.0, -280.0, -337.0, 0.0, -283.0, 57.0, -61.0, -233.0, -133.0, 0.0, 0.0, 0.0, 0.0, -267.0, -268.0, -245.0, -349.0, -44.0, -305.0, 0.0, -25.0, 0.0, -18.0, 0.0, -181.0, -18.0, -367.0, -339.0, -12.0, 125.0, 0.0, -397.0, -8.0, -207.0, -398.0, -400.0, -397.0, -328.0, -28.0, -268.0, 0.0, -276.0, 0.0, -382.0, 0.0, -149.0, -155.0, 0.0, -373.0, -323.0, 4.0, -173.0, -76.0, 0.0, -350.0, -352.0, 0.0, 0.0, 0.0, -113.0, -394.0, -294.0, -376.0, -394.0, -340.0, -274.0, -367.0, -155.0, 0.0, 0.0, 0.0, -340.0, -205.0, -18.0, 0.0, 0.0, 0.0, -367.0, 105.0, 52.0, -356.0, 0.0, 0.0, 0.0, -379.0, 0.0, -326.0, 0.0, -345.0, 0.0, -2.0, -385.0, -14.0, -4.0, 0.0, -285.0, 0.0, -228.0, -145.0, 0.0, -346.0, -4.0, -241.0, 0.0, -69.0, 0.0, -132.0, 0.0, -392.0, -241.0, 0.0, -348.0, 0.0, 0.0, -236.0, -363.0, 0.0, 0.0, -10.0, -2.0, -318.0, 0.0, -355.0, -16.0, -249.0, -209.0, 0.0, -323.0, -226.0, -18.0, -277.0, 0.0, -205.0, 0.0, -400.0, -297.0, -325.0, -267.0, 0.0, 0.0, -396.0, 0.0, 0.0, -12.0, -226.0, 0.0, -279.0, -317.0, 0.0, -10.0, -4.0, 0.0, -16.0, -2.0, -148.0, -2.0, 0.0, 0.0, -329.0, 1.0, -223.0, 0.0, -20.0, 82.0, 0.0, 0.0, -126.0, -197.0, 0.0, 0.0, 0.0, -106.0, -14.0, -132.0, -284.0, -153.0, -378.0, -295.0, 77.0, 0.0, 0.0, 0.0, -290.0, -134.0, -250.0, 0.0, -299.0, 0.0, 0.0, -6.0, 0.0, -12.0, -12.0, -337.0], "policy_predator_policy_reward": [60.0, 0.0, 0.0, 0.0, 66.0, 84.0, 151.0, 175.0, 161.0, 52.0, 29.0, 158.0, 75.0, 117.0, 107.0, 25.0, 0.0, 0.0, 153.0, 12.0, 161.0, 141.0, 70.0, 184.0, 147.0, 154.0, 21.0, 66.0, 0.0, 9.0, 126.0, 67.0, 81.0, 185.0, 23.0, 8.0, 189.0, 192.0, 132.0, 15.0, 200.0, 200.0, 194.0, 191.0, 109.0, 145.0, 155.0, 131.0, 177.0, 181.0, 37.0, 109.0, 108.0, 46.0, 191.0, 171.0, 53.0, 69.0, 65.0, 38.0, 175.0, 172.0, 0.0, 0.0, 85.0, 97.0, 197.0, 190.0, 200.0, 162.0, 178.0, 66.0, 71.0, 185.0, 0.0, 0.0, 171.0, 148.0, 132.0, 12.0, 0.0, 0.0, 162.0, 147.0, 16.0, 30.0, 182.0, 4.0, 0.0, 0.0, 176.0, 162.0, 146.0, 152.0, 109.0, 173.0, 193.0, 100.0, 9.0, 0.0, 140.0, 123.0, 112.0, 42.0, 44.0, 96.0, 126.0, 173.0, 41.0, 130.0, 59.0, 13.0, 30.0, 101.0, 196.0, 122.0, 118.0, 174.0, 0.0, 0.0, 175.0, 82.0, 0.0, 0.0, 6.0, 0.0, 135.0, 127.0, 173.0, 157.0, 138.0, 167.0, 111.0, 134.0, 137.0, 0.0, 149.0, 149.0, 39.0, 104.0, 141.0, 200.0, 177.0, 173.0, 0.0, 0.0, 192.0, 45.0, 0.0, 6.0, 109.0, 119.0, 174.0, 123.0, 0.0, 5.0, 2.0, 0.0, 0.0, 9.0, 74.0, 61.0, 0.0, 0.0, 27.0, 169.0, 128.0, 113.0, 30.0, 46.0, 0.0, 0.0, 101.0, 72.0, 0.0, 0.0, 8.0, 58.0, 95.0, 8.0, 93.0, 151.0, 189.0, 94.0, 0.0, 0.0, 0.0, 0.0, 158.0, 145.0, 120.0, 101.0, 160.0, 137.0, 0.0, 3.0, 0.0, 6.0, 146.0, 175.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4059619266012584, "mean_inference_ms": 4.063752641872328, "mean_action_processing_ms": 0.6885498320863829, "mean_env_wait_ms": 0.49414169079495124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007788300514221191, "StateBufferConnector_ms": 0.004047989845275879, "ViewRequirementAgentConnector_ms": 0.14815843105316162}, "num_episodes": 22, "episode_return_max": 203.0, "episode_return_min": -440.0, "episode_return_mean": -78.48, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1792000, "num_agent_steps_trained": 1792000, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 270.1570566982589, "num_env_steps_trained_throughput_per_sec": 270.1570566982589, "timesteps_total": 448000, "num_env_steps_sampled_lifetime": 448000, "num_agent_steps_sampled_lifetime": 1792000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1792000, "timers": {"training_iteration_time_ms": 26295.856, "restore_workers_time_ms": 0.015, "training_step_time_ms": 26295.797, "sample_time_ms": 2657.143, "learn_time_ms": 23610.939, "learn_throughput": 169.413, "synch_weights_time_ms": 22.223}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 1792000, "num_agent_steps_trained": 1792000}, "done": false, "training_iteration": 112, "trial_id": "f6b99_00000", "date": "2024-08-13_20-24-59", "timestamp": 1723595099, "time_this_iter_s": 14.867067098617554, "time_total_s": 2399.229311466217, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b623de50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2399.229311466217, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 61.74761904761905, "ram_util_percent": 83.84285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.174874742415847, "cur_kl_coeff": 0.003955078124999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3990531003033673, "policy_loss": -0.0038432905083354662, "vf_loss": 2.4028685167983728, "vf_explained_var": 0.04994760549888409, "kl": 0.007049699816986073, "entropy": 0.14507916735278237, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 212625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7511505609466915, "cur_kl_coeff": 0.002224731445312499, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7671866801207659, "policy_loss": -0.008061364045977671, "vf_loss": 1.7752296691533749, "vf_explained_var": -1.0, "kl": 0.008261146560527021, "entropy": 0.2557545396307158, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 212625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 1808000, "num_agent_steps_trained": 1808000}, "env_runners": {"episode_reward_max": 203.0, "episode_reward_min": -408.0, "episode_reward_mean": -71.71, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 105.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -116.92, "predator_policy": 81.065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-16.0, -68.0, -398.0, -340.0, -42.0, 10.0, -24.0, -3.0, -1.0, -334.0, -47.0, 27.0, -355.0, 0.0, 69.0, -301.0, -408.0, -370.0, -266.0, 0.0, -21.0, -79.0, 0.0, -58.0, 203.0, -170.0, 0.0, -41.0, -28.0, -63.0, -94.0, -9.0, -22.0, -74.0, -5.0, -51.0, -70.0, 3.0, -1.0, -315.0, -56.0, 0.0, -342.0, 0.0, -6.0, -56.0, -41.0, -153.0, -78.0, -107.0, 21.0, -62.0, -356.0, -242.0, 0.0, -159.0, -6.0, 2.0, -299.0, -5.0, -2.0, -9.0, -15.0, 0.0, -132.0, 18.0, 138.0, 0.0, -150.0, 0.0, -40.0, -43.0, -193.0, -390.0, 77.0, 0.0, -121.0, -29.0, -2.0, -3.0, -6.0, -28.0, -36.0, 0.0, -6.0, -49.0, -12.0, 0.0, -54.0, 3.0, -9.0, -9.0, 12.0, -18.0, -271.0, 11.0, -24.0, 1.0, -77.0, 4.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -397.0, -8.0, -207.0, -398.0, -400.0, -397.0, -328.0, -28.0, -268.0, 0.0, -276.0, 0.0, -382.0, 0.0, -149.0, -155.0, 0.0, -373.0, -323.0, 4.0, -173.0, -76.0, 0.0, -350.0, -352.0, 0.0, 0.0, 0.0, -113.0, -394.0, -294.0, -376.0, -394.0, -340.0, -274.0, -367.0, -155.0, 0.0, 0.0, 0.0, -340.0, -205.0, -18.0, 0.0, 0.0, 0.0, -367.0, 105.0, 52.0, -356.0, 0.0, 0.0, 0.0, -379.0, 0.0, -326.0, 0.0, -345.0, 0.0, -2.0, -385.0, -14.0, -4.0, 0.0, -285.0, 0.0, -228.0, -145.0, 0.0, -346.0, -4.0, -241.0, 0.0, -69.0, 0.0, -132.0, 0.0, -392.0, -241.0, 0.0, -348.0, 0.0, 0.0, -236.0, -363.0, 0.0, 0.0, -10.0, -2.0, -318.0, 0.0, -355.0, -16.0, -249.0, -209.0, 0.0, -323.0, -226.0, -18.0, -277.0, 0.0, -205.0, 0.0, -400.0, -297.0, -325.0, -267.0, 0.0, 0.0, -396.0, 0.0, 0.0, -12.0, -226.0, 0.0, -279.0, -317.0, 0.0, -10.0, -4.0, 0.0, -16.0, -2.0, -148.0, -2.0, 0.0, 0.0, -329.0, 1.0, -223.0, 0.0, -20.0, 82.0, 0.0, 0.0, -126.0, -197.0, 0.0, 0.0, 0.0, -106.0, -14.0, -132.0, -284.0, -153.0, -378.0, -295.0, 77.0, 0.0, 0.0, 0.0, -290.0, -134.0, -250.0, 0.0, -299.0, 0.0, 0.0, -6.0, 0.0, -12.0, -12.0, -337.0, 0.0, -76.0, 0.0, 0.0, -12.0, -1.0, -35.0, -64.0, 0.0, -180.0, 0.0, 0.0, -65.0, -40.0, -37.0, 7.0, 0.0, -18.0, -50.0, -4.0, -260.0, 16.0, -12.0, -12.0, -189.0, -264.0, -32.0, 0.0, 0.0, -62.0, 0.0, 1.0, -274.0, 0.0, 0.0, -18.0], "policy_predator_policy_reward": [189.0, 192.0, 132.0, 15.0, 200.0, 200.0, 194.0, 191.0, 109.0, 145.0, 155.0, 131.0, 177.0, 181.0, 37.0, 109.0, 108.0, 46.0, 191.0, 171.0, 53.0, 69.0, 65.0, 38.0, 175.0, 172.0, 0.0, 0.0, 85.0, 97.0, 197.0, 190.0, 200.0, 162.0, 178.0, 66.0, 71.0, 185.0, 0.0, 0.0, 171.0, 148.0, 132.0, 12.0, 0.0, 0.0, 162.0, 147.0, 16.0, 30.0, 182.0, 4.0, 0.0, 0.0, 176.0, 162.0, 146.0, 152.0, 109.0, 173.0, 193.0, 100.0, 9.0, 0.0, 140.0, 123.0, 112.0, 42.0, 44.0, 96.0, 126.0, 173.0, 41.0, 130.0, 59.0, 13.0, 30.0, 101.0, 196.0, 122.0, 118.0, 174.0, 0.0, 0.0, 175.0, 82.0, 0.0, 0.0, 6.0, 0.0, 135.0, 127.0, 173.0, 157.0, 138.0, 167.0, 111.0, 134.0, 137.0, 0.0, 149.0, 149.0, 39.0, 104.0, 141.0, 200.0, 177.0, 173.0, 0.0, 0.0, 192.0, 45.0, 0.0, 6.0, 109.0, 119.0, 174.0, 123.0, 0.0, 5.0, 2.0, 0.0, 0.0, 9.0, 74.0, 61.0, 0.0, 0.0, 27.0, 169.0, 128.0, 113.0, 30.0, 46.0, 0.0, 0.0, 101.0, 72.0, 0.0, 0.0, 8.0, 58.0, 95.0, 8.0, 93.0, 151.0, 189.0, 94.0, 0.0, 0.0, 0.0, 0.0, 158.0, 145.0, 120.0, 101.0, 160.0, 137.0, 0.0, 3.0, 0.0, 6.0, 146.0, 175.0, 29.0, 11.0, 0.0, 0.0, 7.0, 0.0, 36.0, 14.0, 98.0, 70.0, 0.0, 0.0, 51.0, 0.0, 0.0, 33.0, 0.0, 9.0, 27.0, 18.0, 129.0, 127.0, 6.0, 0.0, 8.0, 174.0, 22.0, 21.0, 10.0, 28.0, 0.0, 0.0, 60.0, 137.0, 16.0, 6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.401316113572397, "mean_inference_ms": 4.051921810859735, "mean_action_processing_ms": 0.6856495874701681, "mean_env_wait_ms": 0.4924631297724889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007943034172058105, "StateBufferConnector_ms": 0.0041037797927856445, "ViewRequirementAgentConnector_ms": 0.14238083362579346}, "num_episodes": 18, "episode_return_max": 203.0, "episode_return_min": -408.0, "episode_return_mean": -71.71, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1808000, "num_agent_steps_trained": 1808000, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.7665624811014, "num_env_steps_trained_throughput_per_sec": 298.7665624811014, "timesteps_total": 452000, "num_env_steps_sampled_lifetime": 452000, "num_agent_steps_sampled_lifetime": 1808000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1808000, "timers": {"training_iteration_time_ms": 26021.52, "restore_workers_time_ms": 0.015, "training_step_time_ms": 26021.462, "sample_time_ms": 2523.021, "learn_time_ms": 23470.857, "learn_throughput": 170.424, "synch_weights_time_ms": 21.964}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 1808000, "num_agent_steps_trained": 1808000}, "done": false, "training_iteration": 113, "trial_id": "f6b99_00000", "date": "2024-08-13_20-25-13", "timestamp": 1723595113, "time_this_iter_s": 13.443477153778076, "time_total_s": 2412.672788619995, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b623faf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2412.672788619995, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 51.478947368421046, "ram_util_percent": 83.4421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.748015249248535, "cur_kl_coeff": 0.003955078124999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9278950729225047, "policy_loss": -0.0034524742540997014, "vf_loss": 0.9313322626645603, "vf_explained_var": 0.0630284360161534, "kl": 0.003865118189437204, "entropy": 0.1386267654321812, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 214515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2924965540686297, "cur_kl_coeff": 0.002224731445312499, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7993655149544042, "policy_loss": -0.017922487802724676, "vf_loss": 0.8172755449734352, "vf_explained_var": -0.9931294914591249, "kl": 0.005598301417463691, "entropy": 0.1578641917103182, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 214515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000}, "env_runners": {"episode_reward_max": 203.0, "episode_reward_min": -390.0, "episode_reward_mean": -43.95, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 105.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -80.29, "predator_policy": 58.315}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-58.0, 203.0, -170.0, 0.0, -41.0, -28.0, -63.0, -94.0, -9.0, -22.0, -74.0, -5.0, -51.0, -70.0, 3.0, -1.0, -315.0, -56.0, 0.0, -342.0, 0.0, -6.0, -56.0, -41.0, -153.0, -78.0, -107.0, 21.0, -62.0, -356.0, -242.0, 0.0, -159.0, -6.0, 2.0, -299.0, -5.0, -2.0, -9.0, -15.0, 0.0, -132.0, 18.0, 138.0, 0.0, -150.0, 0.0, -40.0, -43.0, -193.0, -390.0, 77.0, 0.0, -121.0, -29.0, -2.0, -3.0, -6.0, -28.0, -36.0, 0.0, -6.0, -49.0, -12.0, 0.0, -54.0, 3.0, -9.0, -9.0, 12.0, -18.0, -271.0, 11.0, -24.0, 1.0, -77.0, 4.0, -13.0, -7.0, -6.0, 0.0, 10.0, 0.0, -8.0, -50.0, -9.0, -39.0, 0.0, 0.0, 0.0, 6.0, -46.0, -16.0, -3.0, 10.0, -33.0, -11.0, -2.0, 31.0, -5.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -367.0, 105.0, 52.0, -356.0, 0.0, 0.0, 0.0, -379.0, 0.0, -326.0, 0.0, -345.0, 0.0, -2.0, -385.0, -14.0, -4.0, 0.0, -285.0, 0.0, -228.0, -145.0, 0.0, -346.0, -4.0, -241.0, 0.0, -69.0, 0.0, -132.0, 0.0, -392.0, -241.0, 0.0, -348.0, 0.0, 0.0, -236.0, -363.0, 0.0, 0.0, -10.0, -2.0, -318.0, 0.0, -355.0, -16.0, -249.0, -209.0, 0.0, -323.0, -226.0, -18.0, -277.0, 0.0, -205.0, 0.0, -400.0, -297.0, -325.0, -267.0, 0.0, 0.0, -396.0, 0.0, 0.0, -12.0, -226.0, 0.0, -279.0, -317.0, 0.0, -10.0, -4.0, 0.0, -16.0, -2.0, -148.0, -2.0, 0.0, 0.0, -329.0, 1.0, -223.0, 0.0, -20.0, 82.0, 0.0, 0.0, -126.0, -197.0, 0.0, 0.0, 0.0, -106.0, -14.0, -132.0, -284.0, -153.0, -378.0, -295.0, 77.0, 0.0, 0.0, 0.0, -290.0, -134.0, -250.0, 0.0, -299.0, 0.0, 0.0, -6.0, 0.0, -12.0, -12.0, -337.0, 0.0, -76.0, 0.0, 0.0, -12.0, -1.0, -35.0, -64.0, 0.0, -180.0, 0.0, 0.0, -65.0, -40.0, -37.0, 7.0, 0.0, -18.0, -50.0, -4.0, -260.0, 16.0, -12.0, -12.0, -189.0, -264.0, -32.0, 0.0, 0.0, -62.0, 0.0, 1.0, -274.0, 0.0, 0.0, -18.0, -27.0, 0.0, 0.0, -14.0, -22.0, 0.0, 0.0, 0.0, -82.0, 0.0, 0.0, 0.0, -6.0, -10.0, 0.0, -102.0, -2.0, -16.0, 4.0, -95.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, -56.0, -26.0, -155.0, -16.0, -20.0, 0.0, -88.0, -143.0, 0.0, 0.0, -68.0, -12.0, -10.0, 0.0, -4.0, 3.0, 28.0, -29.0, 0.0], "policy_predator_policy_reward": [162.0, 147.0, 16.0, 30.0, 182.0, 4.0, 0.0, 0.0, 176.0, 162.0, 146.0, 152.0, 109.0, 173.0, 193.0, 100.0, 9.0, 0.0, 140.0, 123.0, 112.0, 42.0, 44.0, 96.0, 126.0, 173.0, 41.0, 130.0, 59.0, 13.0, 30.0, 101.0, 196.0, 122.0, 118.0, 174.0, 0.0, 0.0, 175.0, 82.0, 0.0, 0.0, 6.0, 0.0, 135.0, 127.0, 173.0, 157.0, 138.0, 167.0, 111.0, 134.0, 137.0, 0.0, 149.0, 149.0, 39.0, 104.0, 141.0, 200.0, 177.0, 173.0, 0.0, 0.0, 192.0, 45.0, 0.0, 6.0, 109.0, 119.0, 174.0, 123.0, 0.0, 5.0, 2.0, 0.0, 0.0, 9.0, 74.0, 61.0, 0.0, 0.0, 27.0, 169.0, 128.0, 113.0, 30.0, 46.0, 0.0, 0.0, 101.0, 72.0, 0.0, 0.0, 8.0, 58.0, 95.0, 8.0, 93.0, 151.0, 189.0, 94.0, 0.0, 0.0, 0.0, 0.0, 158.0, 145.0, 120.0, 101.0, 160.0, 137.0, 0.0, 3.0, 0.0, 6.0, 146.0, 175.0, 29.0, 11.0, 0.0, 0.0, 7.0, 0.0, 36.0, 14.0, 98.0, 70.0, 0.0, 0.0, 51.0, 0.0, 0.0, 33.0, 0.0, 9.0, 27.0, 18.0, 129.0, 127.0, 6.0, 0.0, 8.0, 174.0, 22.0, 21.0, 10.0, 28.0, 0.0, 0.0, 60.0, 137.0, 16.0, 6.0, 14.0, 0.0, 7.0, 0.0, 0.0, 16.0, 0.0, 0.0, 45.0, 47.0, 0.0, 0.0, 8.0, 0.0, 21.0, 31.0, 9.0, 0.0, 38.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 33.0, 41.0, 48.0, 87.0, 9.0, 11.0, 41.0, 44.0, 76.0, 77.0, 34.0, 1.0, 0.0, 11.0, 2.0, 0.0, 0.0, 0.0, 14.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3955573440458815, "mean_inference_ms": 4.046012572906602, "mean_action_processing_ms": 0.6885632427262565, "mean_env_wait_ms": 0.4937791789150777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009094595909118652, "StateBufferConnector_ms": 0.004067182540893555, "ViewRequirementAgentConnector_ms": 0.14057421684265137}, "num_episodes": 23, "episode_return_max": 203.0, "episode_return_min": -390.0, "episode_return_mean": -43.95, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.8544198611888, "num_env_steps_trained_throughput_per_sec": 302.8544198611888, "timesteps_total": 456000, "num_env_steps_sampled_lifetime": 456000, "num_agent_steps_sampled_lifetime": 1824000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1824000, "timers": {"training_iteration_time_ms": 25664.235, "restore_workers_time_ms": 0.015, "training_step_time_ms": 25664.164, "sample_time_ms": 2284.009, "learn_time_ms": 23353.498, "learn_throughput": 171.281, "synch_weights_time_ms": 21.771}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000}, "done": false, "training_iteration": 114, "trial_id": "f6b99_00000", "date": "2024-08-13_20-25-26", "timestamp": 1723595126, "time_this_iter_s": 13.280097961425781, "time_total_s": 2425.952886581421, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6246af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2425.952886581421, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 49.68421052631579, "ram_util_percent": 82.29473684210525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4738901948014265, "cur_kl_coeff": 0.0019775390624999995, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.87361455555, "policy_loss": -0.00346822930517158, "vf_loss": 0.8770776858641988, "vf_explained_var": 0.0414038135891869, "kl": 0.0025784049396483087, "entropy": 0.10389162993856839, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 216405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1882832759193012, "cur_kl_coeff": 0.002224731445312499, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5633722338947423, "policy_loss": -0.010487776854760432, "vf_loss": 0.5738532099302762, "vf_explained_var": -0.9996628275624028, "kl": 0.0030566762702759153, "entropy": 0.14968818776585438, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 216405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000}, "env_runners": {"episode_reward_max": 138.0, "episode_reward_min": -390.0, "episode_reward_mean": -36.19, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 82.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -60.48, "predator_policy": 42.385}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -342.0, 0.0, -6.0, -56.0, -41.0, -153.0, -78.0, -107.0, 21.0, -62.0, -356.0, -242.0, 0.0, -159.0, -6.0, 2.0, -299.0, -5.0, -2.0, -9.0, -15.0, 0.0, -132.0, 18.0, 138.0, 0.0, -150.0, 0.0, -40.0, -43.0, -193.0, -390.0, 77.0, 0.0, -121.0, -29.0, -2.0, -3.0, -6.0, -28.0, -36.0, 0.0, -6.0, -49.0, -12.0, 0.0, -54.0, 3.0, -9.0, -9.0, 12.0, -18.0, -271.0, 11.0, -24.0, 1.0, -77.0, 4.0, -13.0, -7.0, -6.0, 0.0, 10.0, 0.0, -8.0, -50.0, -9.0, -39.0, 0.0, 0.0, 0.0, 6.0, -46.0, -16.0, -3.0, 10.0, -33.0, -11.0, -2.0, 31.0, -5.0, -12.0, 0.0, 0.0, -1.0, 2.0, 3.0, 0.0, 0.0, 0.0, -2.0, 9.0, -14.0, -13.0, -22.0, -2.0, 0.0, -4.0, -19.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -236.0, -363.0, 0.0, 0.0, -10.0, -2.0, -318.0, 0.0, -355.0, -16.0, -249.0, -209.0, 0.0, -323.0, -226.0, -18.0, -277.0, 0.0, -205.0, 0.0, -400.0, -297.0, -325.0, -267.0, 0.0, 0.0, -396.0, 0.0, 0.0, -12.0, -226.0, 0.0, -279.0, -317.0, 0.0, -10.0, -4.0, 0.0, -16.0, -2.0, -148.0, -2.0, 0.0, 0.0, -329.0, 1.0, -223.0, 0.0, -20.0, 82.0, 0.0, 0.0, -126.0, -197.0, 0.0, 0.0, 0.0, -106.0, -14.0, -132.0, -284.0, -153.0, -378.0, -295.0, 77.0, 0.0, 0.0, 0.0, -290.0, -134.0, -250.0, 0.0, -299.0, 0.0, 0.0, -6.0, 0.0, -12.0, -12.0, -337.0, 0.0, -76.0, 0.0, 0.0, -12.0, -1.0, -35.0, -64.0, 0.0, -180.0, 0.0, 0.0, -65.0, -40.0, -37.0, 7.0, 0.0, -18.0, -50.0, -4.0, -260.0, 16.0, -12.0, -12.0, -189.0, -264.0, -32.0, 0.0, 0.0, -62.0, 0.0, 1.0, -274.0, 0.0, 0.0, -18.0, -27.0, 0.0, 0.0, -14.0, -22.0, 0.0, 0.0, 0.0, -82.0, 0.0, 0.0, 0.0, -6.0, -10.0, 0.0, -102.0, -2.0, -16.0, 4.0, -95.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, -56.0, -26.0, -155.0, -16.0, -20.0, 0.0, -88.0, -143.0, 0.0, 0.0, -68.0, -12.0, -10.0, 0.0, -4.0, 3.0, 28.0, -29.0, 0.0, -12.0, -12.0, 0.0, 0.0, 0.0, 0.0, -26.0, 0.0, -34.0, 0.0, 0.0, -23.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -106.0, 9.0, 0.0, 0.0, -28.0, -71.0, 0.0, -24.0, -76.0, 0.0, -5.0, 0.0, 0.0, 0.0, -12.0, 4.0, -74.0], "policy_predator_policy_reward": [0.0, 0.0, 175.0, 82.0, 0.0, 0.0, 6.0, 0.0, 135.0, 127.0, 173.0, 157.0, 138.0, 167.0, 111.0, 134.0, 137.0, 0.0, 149.0, 149.0, 39.0, 104.0, 141.0, 200.0, 177.0, 173.0, 0.0, 0.0, 192.0, 45.0, 0.0, 6.0, 109.0, 119.0, 174.0, 123.0, 0.0, 5.0, 2.0, 0.0, 0.0, 9.0, 74.0, 61.0, 0.0, 0.0, 27.0, 169.0, 128.0, 113.0, 30.0, 46.0, 0.0, 0.0, 101.0, 72.0, 0.0, 0.0, 8.0, 58.0, 95.0, 8.0, 93.0, 151.0, 189.0, 94.0, 0.0, 0.0, 0.0, 0.0, 158.0, 145.0, 120.0, 101.0, 160.0, 137.0, 0.0, 3.0, 0.0, 6.0, 146.0, 175.0, 29.0, 11.0, 0.0, 0.0, 7.0, 0.0, 36.0, 14.0, 98.0, 70.0, 0.0, 0.0, 51.0, 0.0, 0.0, 33.0, 0.0, 9.0, 27.0, 18.0, 129.0, 127.0, 6.0, 0.0, 8.0, 174.0, 22.0, 21.0, 10.0, 28.0, 0.0, 0.0, 60.0, 137.0, 16.0, 6.0, 14.0, 0.0, 7.0, 0.0, 0.0, 16.0, 0.0, 0.0, 45.0, 47.0, 0.0, 0.0, 8.0, 0.0, 21.0, 31.0, 9.0, 0.0, 38.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 33.0, 41.0, 48.0, 87.0, 9.0, 11.0, 41.0, 44.0, 76.0, 77.0, 34.0, 1.0, 0.0, 11.0, 2.0, 0.0, 0.0, 0.0, 14.0, 10.0, 6.0, 6.0, 0.0, 0.0, 0.0, 0.0, 12.0, 13.0, 24.0, 12.0, 15.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 55.0, 49.0, 0.0, 0.0, 14.0, 0.0, 18.0, 40.0, 44.0, 34.0, 3.0, 0.0, 0.0, 0.0, 4.0, 4.0, 32.0, 19.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.5059758044695535, "mean_inference_ms": 4.790056515869193, "mean_action_processing_ms": 0.6800678643477339, "mean_env_wait_ms": 0.48980135742207254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0111311674118042, "StateBufferConnector_ms": 0.005678296089172363, "ViewRequirementAgentConnector_ms": 0.20430731773376465}, "num_episodes": 18, "episode_return_max": 138.0, "episode_return_min": -390.0, "episode_return_mean": -36.19, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 2.1004223213220135, "num_env_steps_trained_throughput_per_sec": 2.1004223213220135, "timesteps_total": 460000, "num_env_steps_sampled_lifetime": 460000, "num_agent_steps_sampled_lifetime": 1840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1840000, "timers": {"training_iteration_time_ms": 214663.01, "restore_workers_time_ms": 0.015, "training_step_time_ms": 214662.935, "sample_time_ms": 190786.996, "learn_time_ms": 23849.758, "learn_throughput": 167.717, "synch_weights_time_ms": 21.019}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000}, "done": false, "training_iteration": 115, "trial_id": "f6b99_00000", "date": "2024-08-13_20-57-11", "timestamp": 1723597031, "time_this_iter_s": 1904.4301400184631, "time_total_s": 4330.383026599884, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6265040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4330.383026599884, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 86.02424242424243, "ram_util_percent": 83.68181818181819}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.457282648515449, "cur_kl_coeff": 0.0009887695312499997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.005723673956735, "policy_loss": -0.0011112463714742155, "vf_loss": 3.00683254962245, "vf_explained_var": 0.007715725867205827, "kl": 0.0023980205516906917, "entropy": 0.110388332867512, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 218295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8725533611559995, "cur_kl_coeff": 0.0011123657226562494, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0414894007185778, "policy_loss": -0.01425436564533917, "vf_loss": 2.055725229164911, "vf_explained_var": -0.9951645903486424, "kl": 0.016661394368704296, "entropy": 0.35342284704326954, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 218295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 1856000, "num_agent_steps_trained": 1856000}, "env_runners": {"episode_reward_max": 138.0, "episode_reward_min": -390.0, "episode_reward_mean": -20.33, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 82.0, "predator_policy": 189.0}, "policy_reward_mean": {"prey_policy": -42.205, "predator_policy": 32.04}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -132.0, 18.0, 138.0, 0.0, -150.0, 0.0, -40.0, -43.0, -193.0, -390.0, 77.0, 0.0, -121.0, -29.0, -2.0, -3.0, -6.0, -28.0, -36.0, 0.0, -6.0, -49.0, -12.0, 0.0, -54.0, 3.0, -9.0, -9.0, 12.0, -18.0, -271.0, 11.0, -24.0, 1.0, -77.0, 4.0, -13.0, -7.0, -6.0, 0.0, 10.0, 0.0, -8.0, -50.0, -9.0, -39.0, 0.0, 0.0, 0.0, 6.0, -46.0, -16.0, -3.0, 10.0, -33.0, -11.0, -2.0, 31.0, -5.0, -12.0, 0.0, 0.0, -1.0, 2.0, 3.0, 0.0, 0.0, 0.0, -2.0, 9.0, -14.0, -13.0, -22.0, -2.0, 0.0, -4.0, -19.0, 2.0, 55.0, 0.0, 0.0, -50.0, 1.0, 0.0, -303.0, -54.0, -17.0, -1.0, -3.0, -13.0, -22.0, 26.0, 0.0, 9.0, 0.0, -9.0, 51.0, 0.0, -1.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -329.0, 1.0, -223.0, 0.0, -20.0, 82.0, 0.0, 0.0, -126.0, -197.0, 0.0, 0.0, 0.0, -106.0, -14.0, -132.0, -284.0, -153.0, -378.0, -295.0, 77.0, 0.0, 0.0, 0.0, -290.0, -134.0, -250.0, 0.0, -299.0, 0.0, 0.0, -6.0, 0.0, -12.0, -12.0, -337.0, 0.0, -76.0, 0.0, 0.0, -12.0, -1.0, -35.0, -64.0, 0.0, -180.0, 0.0, 0.0, -65.0, -40.0, -37.0, 7.0, 0.0, -18.0, -50.0, -4.0, -260.0, 16.0, -12.0, -12.0, -189.0, -264.0, -32.0, 0.0, 0.0, -62.0, 0.0, 1.0, -274.0, 0.0, 0.0, -18.0, -27.0, 0.0, 0.0, -14.0, -22.0, 0.0, 0.0, 0.0, -82.0, 0.0, 0.0, 0.0, -6.0, -10.0, 0.0, -102.0, -2.0, -16.0, 4.0, -95.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, -56.0, -26.0, -155.0, -16.0, -20.0, 0.0, -88.0, -143.0, 0.0, 0.0, -68.0, -12.0, -10.0, 0.0, -4.0, 3.0, 28.0, -29.0, 0.0, -12.0, -12.0, 0.0, 0.0, 0.0, 0.0, -26.0, 0.0, -34.0, 0.0, 0.0, -23.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -106.0, 9.0, 0.0, 0.0, -28.0, -71.0, 0.0, -24.0, -76.0, 0.0, -5.0, 0.0, 0.0, 0.0, -12.0, 4.0, -74.0, -8.0, 0.0, -188.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, -125.0, -18.0, -9.0, 0.0, 0.0, -400.0, -206.0, -364.0, -16.0, 0.0, -36.0, 0.0, -2.0, -6.0, 0.0, -119.0, 0.0, -102.0, -14.0, 0.0, 26.0, 0.0, 0.0, 0.0, -49.0, 0.0, 0.0, -6.0, -6.0, -199.0, 0.0, 0.0, 0.0, -10.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 27.0, 169.0, 128.0, 113.0, 30.0, 46.0, 0.0, 0.0, 101.0, 72.0, 0.0, 0.0, 8.0, 58.0, 95.0, 8.0, 93.0, 151.0, 189.0, 94.0, 0.0, 0.0, 0.0, 0.0, 158.0, 145.0, 120.0, 101.0, 160.0, 137.0, 0.0, 3.0, 0.0, 6.0, 146.0, 175.0, 29.0, 11.0, 0.0, 0.0, 7.0, 0.0, 36.0, 14.0, 98.0, 70.0, 0.0, 0.0, 51.0, 0.0, 0.0, 33.0, 0.0, 9.0, 27.0, 18.0, 129.0, 127.0, 6.0, 0.0, 8.0, 174.0, 22.0, 21.0, 10.0, 28.0, 0.0, 0.0, 60.0, 137.0, 16.0, 6.0, 14.0, 0.0, 7.0, 0.0, 0.0, 16.0, 0.0, 0.0, 45.0, 47.0, 0.0, 0.0, 8.0, 0.0, 21.0, 31.0, 9.0, 0.0, 38.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 33.0, 41.0, 48.0, 87.0, 9.0, 11.0, 41.0, 44.0, 76.0, 77.0, 34.0, 1.0, 0.0, 11.0, 2.0, 0.0, 0.0, 0.0, 14.0, 10.0, 6.0, 6.0, 0.0, 0.0, 0.0, 0.0, 12.0, 13.0, 24.0, 12.0, 15.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 55.0, 49.0, 0.0, 0.0, 14.0, 0.0, 18.0, 40.0, 44.0, 34.0, 3.0, 0.0, 0.0, 0.0, 4.0, 4.0, 32.0, 19.0, 5.0, 5.0, 117.0, 126.0, 0.0, 0.0, 0.0, 0.0, 21.0, 50.0, 8.0, 20.0, 0.0, 0.0, 119.0, 184.0, 183.0, 143.0, 18.0, 1.0, 1.0, 0.0, 3.0, 0.0, 61.0, 45.0, 38.0, 56.0, 0.0, 0.0, 0.0, 0.0, 28.0, 30.0, 0.0, 0.0, 0.0, 3.0, 125.0, 125.0, 0.0, 0.0, 4.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.661611596216677, "mean_inference_ms": 5.74195054631442, "mean_action_processing_ms": 0.6824855364935165, "mean_env_wait_ms": 0.49207580051074074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013289451599121094, "StateBufferConnector_ms": 0.010423541069030762, "ViewRequirementAgentConnector_ms": 0.2039247751235962}, "num_episodes": 22, "episode_return_max": 138.0, "episode_return_min": -390.0, "episode_return_mean": -20.33, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1856000, "num_agent_steps_trained": 1856000, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 214.4737505508467, "num_env_steps_trained_throughput_per_sec": 214.4737505508467, "timesteps_total": 464000, "num_env_steps_sampled_lifetime": 464000, "num_agent_steps_sampled_lifetime": 1856000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1856000, "timers": {"training_iteration_time_ms": 214859.605, "restore_workers_time_ms": 0.015, "training_step_time_ms": 214859.53, "sample_time_ms": 190808.11, "learn_time_ms": 24028.122, "learn_throughput": 166.472, "synch_weights_time_ms": 18.361}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 1856000, "num_agent_steps_trained": 1856000}, "done": false, "training_iteration": 116, "trial_id": "f6b99_00000", "date": "2024-08-13_20-57-29", "timestamp": 1723597049, "time_this_iter_s": 18.70007610321045, "time_total_s": 4349.0831027030945, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6265ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4349.0831027030945, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 76.69230769230768, "ram_util_percent": 83.92307692307692}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5703615419133, "cur_kl_coeff": 0.0004943847656249999, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.800408937060644, "policy_loss": -0.0023255462632588452, "vf_loss": 5.802733445041394, "vf_explained_var": 0.019162544371589783, "kl": 0.002073812391005297, "entropy": 0.11657416777754272, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 220185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.011553782934234, "cur_kl_coeff": 0.0011123657226562494, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2463927591288533, "policy_loss": -0.005693095313168313, "vf_loss": 3.252073393044648, "vf_explained_var": -0.9972387965394076, "kl": 0.011202567622938331, "entropy": 0.5157031643958319, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 220185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000}, "env_runners": {"episode_reward_max": 55.0, "episode_reward_min": -303.0, "episode_reward_mean": -13.87, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 28.0, "predator_policy": 184.0}, "policy_reward_mean": {"prey_policy": -37.28, "predator_policy": 30.345}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-28.0, -36.0, 0.0, -6.0, -49.0, -12.0, 0.0, -54.0, 3.0, -9.0, -9.0, 12.0, -18.0, -271.0, 11.0, -24.0, 1.0, -77.0, 4.0, -13.0, -7.0, -6.0, 0.0, 10.0, 0.0, -8.0, -50.0, -9.0, -39.0, 0.0, 0.0, 0.0, 6.0, -46.0, -16.0, -3.0, 10.0, -33.0, -11.0, -2.0, 31.0, -5.0, -12.0, 0.0, 0.0, -1.0, 2.0, 3.0, 0.0, 0.0, 0.0, -2.0, 9.0, -14.0, -13.0, -22.0, -2.0, 0.0, -4.0, -19.0, 2.0, 55.0, 0.0, 0.0, -50.0, 1.0, 0.0, -303.0, -54.0, -17.0, -1.0, -3.0, -13.0, -22.0, 26.0, 0.0, 9.0, 0.0, -9.0, 51.0, 0.0, -1.0, -18.0, 14.0, 48.0, 47.0, 11.0, -45.0, 2.0, 0.0, -48.0, 5.0, -117.0, -14.0, -6.0, -7.0, 0.0, -121.0, 1.0, 18.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-12.0, -337.0, 0.0, -76.0, 0.0, 0.0, -12.0, -1.0, -35.0, -64.0, 0.0, -180.0, 0.0, 0.0, -65.0, -40.0, -37.0, 7.0, 0.0, -18.0, -50.0, -4.0, -260.0, 16.0, -12.0, -12.0, -189.0, -264.0, -32.0, 0.0, 0.0, -62.0, 0.0, 1.0, -274.0, 0.0, 0.0, -18.0, -27.0, 0.0, 0.0, -14.0, -22.0, 0.0, 0.0, 0.0, -82.0, 0.0, 0.0, 0.0, -6.0, -10.0, 0.0, -102.0, -2.0, -16.0, 4.0, -95.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, -56.0, -26.0, -155.0, -16.0, -20.0, 0.0, -88.0, -143.0, 0.0, 0.0, -68.0, -12.0, -10.0, 0.0, -4.0, 3.0, 28.0, -29.0, 0.0, -12.0, -12.0, 0.0, 0.0, 0.0, 0.0, -26.0, 0.0, -34.0, 0.0, 0.0, -23.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -106.0, 9.0, 0.0, 0.0, -28.0, -71.0, 0.0, -24.0, -76.0, 0.0, -5.0, 0.0, 0.0, 0.0, -12.0, 4.0, -74.0, -8.0, 0.0, -188.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, -125.0, -18.0, -9.0, 0.0, 0.0, -400.0, -206.0, -364.0, -16.0, 0.0, -36.0, 0.0, -2.0, -6.0, 0.0, -119.0, 0.0, -102.0, -14.0, 0.0, 26.0, 0.0, 0.0, 0.0, -49.0, 0.0, 0.0, -6.0, -6.0, -199.0, 0.0, 0.0, 0.0, -10.0, 0.0, -36.0, 0.0, -172.0, 0.0, -45.0, -11.0, -147.0, 0.0, -116.0, 1.0, -266.0, -18.0, 0.0, 2.0, 0.0, 0.0, -225.0, -55.0, -186.0, -18.0, -272.0, 0.0, 0.0, -59.0, -10.0, -2.0, -14.0, 0.0, 0.0, 0.0, 0.0, -322.0, 1.0, 0.0, -65.0, -68.0], "policy_predator_policy_reward": [146.0, 175.0, 29.0, 11.0, 0.0, 0.0, 7.0, 0.0, 36.0, 14.0, 98.0, 70.0, 0.0, 0.0, 51.0, 0.0, 0.0, 33.0, 0.0, 9.0, 27.0, 18.0, 129.0, 127.0, 6.0, 0.0, 8.0, 174.0, 22.0, 21.0, 10.0, 28.0, 0.0, 0.0, 60.0, 137.0, 16.0, 6.0, 14.0, 0.0, 7.0, 0.0, 0.0, 16.0, 0.0, 0.0, 45.0, 47.0, 0.0, 0.0, 8.0, 0.0, 21.0, 31.0, 9.0, 0.0, 38.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 33.0, 41.0, 48.0, 87.0, 9.0, 11.0, 41.0, 44.0, 76.0, 77.0, 34.0, 1.0, 0.0, 11.0, 2.0, 0.0, 0.0, 0.0, 14.0, 10.0, 6.0, 6.0, 0.0, 0.0, 0.0, 0.0, 12.0, 13.0, 24.0, 12.0, 15.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 55.0, 49.0, 0.0, 0.0, 14.0, 0.0, 18.0, 40.0, 44.0, 34.0, 3.0, 0.0, 0.0, 0.0, 4.0, 4.0, 32.0, 19.0, 5.0, 5.0, 117.0, 126.0, 0.0, 0.0, 0.0, 0.0, 21.0, 50.0, 8.0, 20.0, 0.0, 0.0, 119.0, 184.0, 183.0, 143.0, 18.0, 1.0, 1.0, 0.0, 3.0, 0.0, 61.0, 45.0, 38.0, 56.0, 0.0, 0.0, 0.0, 0.0, 28.0, 30.0, 0.0, 0.0, 0.0, 3.0, 125.0, 125.0, 0.0, 0.0, 4.0, 5.0, 0.0, 18.0, 95.0, 91.0, 49.0, 55.0, 100.0, 94.0, 72.0, 54.0, 122.0, 117.0, 0.0, 0.0, 0.0, 0.0, 111.0, 121.0, 109.0, 100.0, 19.0, 136.0, 18.0, 27.0, 0.0, 6.0, 0.0, 7.0, 0.0, 0.0, 35.0, 166.0, 0.0, 0.0, 79.0, 72.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 17.67923655308574, "mean_inference_ms": 6.4663194344648245, "mean_action_processing_ms": 0.6761813440301636, "mean_env_wait_ms": 0.4890632361407171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012483835220336914, "StateBufferConnector_ms": 0.010113120079040527, "ViewRequirementAgentConnector_ms": 0.19127702713012695}, "num_episodes": 18, "episode_return_max": 55.0, "episode_return_min": -303.0, "episode_return_mean": -13.87, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.2218664855578, "num_env_steps_trained_throughput_per_sec": 295.2218664855578, "timesteps_total": 468000, "num_env_steps_sampled_lifetime": 468000, "num_agent_steps_sampled_lifetime": 1872000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1872000, "timers": {"training_iteration_time_ms": 213570.767, "restore_workers_time_ms": 0.015, "training_step_time_ms": 213570.692, "sample_time_ms": 190575.373, "learn_time_ms": 22972.483, "learn_throughput": 174.121, "synch_weights_time_ms": 18.601}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000}, "done": false, "training_iteration": 117, "trial_id": "f6b99_00000", "date": "2024-08-13_20-57-43", "timestamp": 1723597063, "time_this_iter_s": 13.613266944885254, "time_total_s": 4362.69636964798, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b62655e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4362.69636964798, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 50.84210526315789, "ram_util_percent": 83.83157894736843}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6788246848911204, "cur_kl_coeff": 0.00024719238281249993, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1915934920941713, "policy_loss": -0.002452473876081289, "vf_loss": 3.194045430264145, "vf_explained_var": 0.03005575461993142, "kl": 0.0021400823861719995, "entropy": 0.0812930892256123, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 222075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.078578228389144, "cur_kl_coeff": 0.0011123657226562494, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.104651803692813, "policy_loss": -0.005533489049658692, "vf_loss": 3.110174641596577, "vf_explained_var": -0.3892900801524914, "kl": 0.00956905800977789, "entropy": 0.4960095373411027, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 222075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 1888000, "num_agent_steps_trained": 1888000}, "env_runners": {"episode_reward_max": 165.0, "episode_reward_min": -494.0, "episode_reward_mean": -10.73, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 158.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -40.065, "predator_policy": 34.7}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.0, -13.0, -7.0, -6.0, 0.0, 10.0, 0.0, -8.0, -50.0, -9.0, -39.0, 0.0, 0.0, 0.0, 6.0, -46.0, -16.0, -3.0, 10.0, -33.0, -11.0, -2.0, 31.0, -5.0, -12.0, 0.0, 0.0, -1.0, 2.0, 3.0, 0.0, 0.0, 0.0, -2.0, 9.0, -14.0, -13.0, -22.0, -2.0, 0.0, -4.0, -19.0, 2.0, 55.0, 0.0, 0.0, -50.0, 1.0, 0.0, -303.0, -54.0, -17.0, -1.0, -3.0, -13.0, -22.0, 26.0, 0.0, 9.0, 0.0, -9.0, 51.0, 0.0, -1.0, -18.0, 14.0, 48.0, 47.0, 11.0, -45.0, 2.0, 0.0, -48.0, 5.0, -117.0, -14.0, -6.0, -7.0, 0.0, -121.0, 1.0, 18.0, 0.0, -53.0, 102.0, -9.0, 75.0, 40.0, -3.0, 165.0, -66.0, -494.0, 14.0, 73.0, -113.0, 81.0, 20.0, 0.0, -84.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -18.0, -27.0, 0.0, 0.0, -14.0, -22.0, 0.0, 0.0, 0.0, -82.0, 0.0, 0.0, 0.0, -6.0, -10.0, 0.0, -102.0, -2.0, -16.0, 4.0, -95.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, -56.0, -26.0, -155.0, -16.0, -20.0, 0.0, -88.0, -143.0, 0.0, 0.0, -68.0, -12.0, -10.0, 0.0, -4.0, 3.0, 28.0, -29.0, 0.0, -12.0, -12.0, 0.0, 0.0, 0.0, 0.0, -26.0, 0.0, -34.0, 0.0, 0.0, -23.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -106.0, 9.0, 0.0, 0.0, -28.0, -71.0, 0.0, -24.0, -76.0, 0.0, -5.0, 0.0, 0.0, 0.0, -12.0, 4.0, -74.0, -8.0, 0.0, -188.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, -125.0, -18.0, -9.0, 0.0, 0.0, -400.0, -206.0, -364.0, -16.0, 0.0, -36.0, 0.0, -2.0, -6.0, 0.0, -119.0, 0.0, -102.0, -14.0, 0.0, 26.0, 0.0, 0.0, 0.0, -49.0, 0.0, 0.0, -6.0, -6.0, -199.0, 0.0, 0.0, 0.0, -10.0, 0.0, -36.0, 0.0, -172.0, 0.0, -45.0, -11.0, -147.0, 0.0, -116.0, 1.0, -266.0, -18.0, 0.0, 2.0, 0.0, 0.0, -225.0, -55.0, -186.0, -18.0, -272.0, 0.0, 0.0, -59.0, -10.0, -2.0, -14.0, 0.0, 0.0, 0.0, 0.0, -322.0, 1.0, 0.0, -65.0, -68.0, 0.0, 0.0, -400.0, 0.0, -16.0, 64.0, -20.0, 0.0, -10.0, 0.0, -98.0, -77.0, 0.0, -6.0, 158.0, 0.0, 7.0, -314.0, -352.0, -397.0, -177.0, 0.0, 28.0, -2.0, 0.0, -317.0, -124.0, -6.0, -8.0, -194.0, 0.0, 0.0, 11.0, -319.0, 0.0, 0.0], "policy_predator_policy_reward": [16.0, 6.0, 14.0, 0.0, 7.0, 0.0, 0.0, 16.0, 0.0, 0.0, 45.0, 47.0, 0.0, 0.0, 8.0, 0.0, 21.0, 31.0, 9.0, 0.0, 38.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 33.0, 41.0, 48.0, 87.0, 9.0, 11.0, 41.0, 44.0, 76.0, 77.0, 34.0, 1.0, 0.0, 11.0, 2.0, 0.0, 0.0, 0.0, 14.0, 10.0, 6.0, 6.0, 0.0, 0.0, 0.0, 0.0, 12.0, 13.0, 24.0, 12.0, 15.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 55.0, 49.0, 0.0, 0.0, 14.0, 0.0, 18.0, 40.0, 44.0, 34.0, 3.0, 0.0, 0.0, 0.0, 4.0, 4.0, 32.0, 19.0, 5.0, 5.0, 117.0, 126.0, 0.0, 0.0, 0.0, 0.0, 21.0, 50.0, 8.0, 20.0, 0.0, 0.0, 119.0, 184.0, 183.0, 143.0, 18.0, 1.0, 1.0, 0.0, 3.0, 0.0, 61.0, 45.0, 38.0, 56.0, 0.0, 0.0, 0.0, 0.0, 28.0, 30.0, 0.0, 0.0, 0.0, 3.0, 125.0, 125.0, 0.0, 0.0, 4.0, 5.0, 0.0, 18.0, 95.0, 91.0, 49.0, 55.0, 100.0, 94.0, 72.0, 54.0, 122.0, 117.0, 0.0, 0.0, 0.0, 0.0, 111.0, 121.0, 109.0, 100.0, 19.0, 136.0, 18.0, 27.0, 0.0, 6.0, 0.0, 7.0, 0.0, 0.0, 35.0, 166.0, 0.0, 0.0, 79.0, 72.0, 0.0, 0.0, 147.0, 200.0, 15.0, 39.0, 11.0, 0.0, 56.0, 29.0, 137.0, 78.0, 0.0, 3.0, 4.0, 3.0, 90.0, 151.0, 56.0, 199.0, 86.0, 105.0, 41.0, 6.0, 60.0, 144.0, 105.0, 106.0, 98.0, 124.0, 0.0, 0.0, 69.0, 155.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 23.299422570501193, "mean_inference_ms": 7.2006339134102095, "mean_action_processing_ms": 0.6742883544659803, "mean_env_wait_ms": 0.6162201809352061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011705279350280762, "StateBufferConnector_ms": 0.0100555419921875, "ViewRequirementAgentConnector_ms": 0.18621838092803955}, "num_episodes": 18, "episode_return_max": 165.0, "episode_return_min": -494.0, "episode_return_mean": -10.73, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1888000, "num_agent_steps_trained": 1888000, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 11.480540417697645, "num_env_steps_trained_throughput_per_sec": 11.480540417697645, "timesteps_total": 472000, "num_env_steps_sampled_lifetime": 472000, "num_agent_steps_sampled_lifetime": 1888000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1888000, "timers": {"training_iteration_time_ms": 246789.04, "restore_workers_time_ms": 0.015, "training_step_time_ms": 246788.967, "sample_time_ms": 224090.569, "learn_time_ms": 22677.365, "learn_throughput": 176.387, "synch_weights_time_ms": 16.9}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 1888000, "num_agent_steps_trained": 1888000}, "done": false, "training_iteration": 118, "trial_id": "f6b99_00000", "date": "2024-08-13_21-03-32", "timestamp": 1723597412, "time_this_iter_s": 348.45937418937683, "time_total_s": 4711.155743837357, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b60a7a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4711.155743837357, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 51.94736842105263, "ram_util_percent": 83.66842105263157}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0652750980444057, "cur_kl_coeff": 0.00012359619140624997, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.580069669056191, "policy_loss": -0.002486759829384191, "vf_loss": 1.5825561319709456, "vf_explained_var": 0.036963254686385866, "kl": 0.002389306526737602, "entropy": 0.06939413624091281, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 223965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.919930250335623, "cur_kl_coeff": 0.0011123657226562494, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5259840390196553, "policy_loss": -0.009901146731578386, "vf_loss": 1.5358811595137156, "vf_explained_var": 0.4234042161040836, "kl": 0.0036225049073001924, "entropy": 0.26235447842135, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 223965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 1904000, "num_agent_steps_trained": 1904000}, "env_runners": {"episode_reward_max": 178.0, "episode_reward_min": -494.0, "episode_reward_mean": -3.58, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 178.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -35.985, "predator_policy": 34.195}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.0, -12.0, 0.0, 0.0, -1.0, 2.0, 3.0, 0.0, 0.0, 0.0, -2.0, 9.0, -14.0, -13.0, -22.0, -2.0, 0.0, -4.0, -19.0, 2.0, 55.0, 0.0, 0.0, -50.0, 1.0, 0.0, -303.0, -54.0, -17.0, -1.0, -3.0, -13.0, -22.0, 26.0, 0.0, 9.0, 0.0, -9.0, 51.0, 0.0, -1.0, -18.0, 14.0, 48.0, 47.0, 11.0, -45.0, 2.0, 0.0, -48.0, 5.0, -117.0, -14.0, -6.0, -7.0, 0.0, -121.0, 1.0, 18.0, 0.0, -53.0, 102.0, -9.0, 75.0, 40.0, -3.0, 165.0, -66.0, -494.0, 14.0, 73.0, -113.0, 81.0, 20.0, 0.0, -84.0, 0.0, 85.0, 0.0, 0.0, 101.0, 82.0, 0.0, 178.0, -16.0, -10.0, 0.0, -18.0, 112.0, 41.0, -40.0, -57.0, -10.0, 0.0, 0.0, -5.0, 93.0, 0.0, -3.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-29.0, 0.0, -12.0, -12.0, 0.0, 0.0, 0.0, 0.0, -26.0, 0.0, -34.0, 0.0, 0.0, -23.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -106.0, 9.0, 0.0, 0.0, -28.0, -71.0, 0.0, -24.0, -76.0, 0.0, -5.0, 0.0, 0.0, 0.0, -12.0, 4.0, -74.0, -8.0, 0.0, -188.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, -125.0, -18.0, -9.0, 0.0, 0.0, -400.0, -206.0, -364.0, -16.0, 0.0, -36.0, 0.0, -2.0, -6.0, 0.0, -119.0, 0.0, -102.0, -14.0, 0.0, 26.0, 0.0, 0.0, 0.0, -49.0, 0.0, 0.0, -6.0, -6.0, -199.0, 0.0, 0.0, 0.0, -10.0, 0.0, -36.0, 0.0, -172.0, 0.0, -45.0, -11.0, -147.0, 0.0, -116.0, 1.0, -266.0, -18.0, 0.0, 2.0, 0.0, 0.0, -225.0, -55.0, -186.0, -18.0, -272.0, 0.0, 0.0, -59.0, -10.0, -2.0, -14.0, 0.0, 0.0, 0.0, 0.0, -322.0, 1.0, 0.0, -65.0, -68.0, 0.0, 0.0, -400.0, 0.0, -16.0, 64.0, -20.0, 0.0, -10.0, 0.0, -98.0, -77.0, 0.0, -6.0, 158.0, 0.0, 7.0, -314.0, -352.0, -397.0, -177.0, 0.0, 28.0, -2.0, 0.0, -317.0, -124.0, -6.0, -8.0, -194.0, 0.0, 0.0, 11.0, -319.0, 0.0, 0.0, 0.0, -49.0, 0.0, 0.0, 0.0, 0.0, 78.0, 4.0, 52.0, -20.0, 0.0, 0.0, 0.0, 178.0, -6.0, -20.0, -6.0, -14.0, 0.0, 0.0, -20.0, -8.0, 0.0, 112.0, 0.0, -85.0, 0.0, -96.0, 0.0, -221.0, -10.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 6.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0], "policy_predator_policy_reward": [14.0, 10.0, 6.0, 6.0, 0.0, 0.0, 0.0, 0.0, 12.0, 13.0, 24.0, 12.0, 15.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 55.0, 49.0, 0.0, 0.0, 14.0, 0.0, 18.0, 40.0, 44.0, 34.0, 3.0, 0.0, 0.0, 0.0, 4.0, 4.0, 32.0, 19.0, 5.0, 5.0, 117.0, 126.0, 0.0, 0.0, 0.0, 0.0, 21.0, 50.0, 8.0, 20.0, 0.0, 0.0, 119.0, 184.0, 183.0, 143.0, 18.0, 1.0, 1.0, 0.0, 3.0, 0.0, 61.0, 45.0, 38.0, 56.0, 0.0, 0.0, 0.0, 0.0, 28.0, 30.0, 0.0, 0.0, 0.0, 3.0, 125.0, 125.0, 0.0, 0.0, 4.0, 5.0, 0.0, 18.0, 95.0, 91.0, 49.0, 55.0, 100.0, 94.0, 72.0, 54.0, 122.0, 117.0, 0.0, 0.0, 0.0, 0.0, 111.0, 121.0, 109.0, 100.0, 19.0, 136.0, 18.0, 27.0, 0.0, 6.0, 0.0, 7.0, 0.0, 0.0, 35.0, 166.0, 0.0, 0.0, 79.0, 72.0, 0.0, 0.0, 147.0, 200.0, 15.0, 39.0, 11.0, 0.0, 56.0, 29.0, 137.0, 78.0, 0.0, 3.0, 4.0, 3.0, 90.0, 151.0, 56.0, 199.0, 86.0, 105.0, 41.0, 6.0, 60.0, 144.0, 105.0, 106.0, 98.0, 124.0, 0.0, 0.0, 69.0, 155.0, 0.0, 0.0, 66.0, 68.0, 0.0, 0.0, 0.0, 0.0, 16.0, 3.0, 47.0, 3.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 77.0, 49.0, 4.0, 52.0, 75.0, 89.0, 7.0, 5.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 62.0, 25.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.47675824465797, "mean_inference_ms": 8.111279539025485, "mean_action_processing_ms": 0.6719386980640522, "mean_env_wait_ms": 0.7421717675554076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01079261302947998, "StateBufferConnector_ms": 0.011446356773376465, "ViewRequirementAgentConnector_ms": 0.19658362865447998}, "num_episodes": 23, "episode_return_max": 178.0, "episode_return_min": -494.0, "episode_return_mean": -3.58, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1904000, "num_agent_steps_trained": 1904000, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.6156026502126, "num_env_steps_trained_throughput_per_sec": 302.6156026502126, "timesteps_total": 476000, "num_env_steps_sampled_lifetime": 476000, "num_agent_steps_sampled_lifetime": 1904000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1904000, "timers": {"training_iteration_time_ms": 246744.623, "restore_workers_time_ms": 0.014, "training_step_time_ms": 246744.551, "sample_time_ms": 224082.168, "learn_time_ms": 22640.319, "learn_throughput": 176.676, "synch_weights_time_ms": 17.687}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 1904000, "num_agent_steps_trained": 1904000}, "done": false, "training_iteration": 119, "trial_id": "f6b99_00000", "date": "2024-08-13_21-03-45", "timestamp": 1723597425, "time_this_iter_s": 13.26783800125122, "time_total_s": 4724.423581838608, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b62a71f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4724.423581838608, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 49.51578947368421, "ram_util_percent": 83.67894736842105}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9564221036733773, "cur_kl_coeff": 6.179809570312498e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8442091702941864, "policy_loss": -0.0011827531132709097, "vf_loss": 0.8453916792752881, "vf_explained_var": 0.021805271553614784, "kl": 0.003955272611633321, "entropy": 0.09853861430295245, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 225855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8657426317532857, "cur_kl_coeff": 0.0005561828613281247, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6219317019143433, "policy_loss": -0.004820046476063826, "vf_loss": 1.626750049736134, "vf_explained_var": -0.20566583726771925, "kl": 0.003050303068350388, "entropy": 0.2492099192880449, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 225855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "env_runners": {"episode_reward_max": 178.0, "episode_reward_min": -494.0, "episode_reward_mean": -1.24, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 178.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -34.615, "predator_policy": 33.995}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -50.0, 1.0, 0.0, -303.0, -54.0, -17.0, -1.0, -3.0, -13.0, -22.0, 26.0, 0.0, 9.0, 0.0, -9.0, 51.0, 0.0, -1.0, -18.0, 14.0, 48.0, 47.0, 11.0, -45.0, 2.0, 0.0, -48.0, 5.0, -117.0, -14.0, -6.0, -7.0, 0.0, -121.0, 1.0, 18.0, 0.0, -53.0, 102.0, -9.0, 75.0, 40.0, -3.0, 165.0, -66.0, -494.0, 14.0, 73.0, -113.0, 81.0, 20.0, 0.0, -84.0, 0.0, 85.0, 0.0, 0.0, 101.0, 82.0, 0.0, 178.0, -16.0, -10.0, 0.0, -18.0, 112.0, 41.0, -40.0, -57.0, -10.0, 0.0, 0.0, -5.0, 93.0, 0.0, -3.0, 0.0, 119.0, 0.0, -123.0, 112.0, 0.0, -5.0, -2.0, 0.0, 144.0, -2.0, -3.0, -2.0, -88.0, 0.0, 16.0, -5.0, 118.0, -1.0, -54.0, -156.0, 0.0, 143.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 4.0, -125.0, -18.0, -9.0, 0.0, 0.0, -400.0, -206.0, -364.0, -16.0, 0.0, -36.0, 0.0, -2.0, -6.0, 0.0, -119.0, 0.0, -102.0, -14.0, 0.0, 26.0, 0.0, 0.0, 0.0, -49.0, 0.0, 0.0, -6.0, -6.0, -199.0, 0.0, 0.0, 0.0, -10.0, 0.0, -36.0, 0.0, -172.0, 0.0, -45.0, -11.0, -147.0, 0.0, -116.0, 1.0, -266.0, -18.0, 0.0, 2.0, 0.0, 0.0, -225.0, -55.0, -186.0, -18.0, -272.0, 0.0, 0.0, -59.0, -10.0, -2.0, -14.0, 0.0, 0.0, 0.0, 0.0, -322.0, 1.0, 0.0, -65.0, -68.0, 0.0, 0.0, -400.0, 0.0, -16.0, 64.0, -20.0, 0.0, -10.0, 0.0, -98.0, -77.0, 0.0, -6.0, 158.0, 0.0, 7.0, -314.0, -352.0, -397.0, -177.0, 0.0, 28.0, -2.0, 0.0, -317.0, -124.0, -6.0, -8.0, -194.0, 0.0, 0.0, 11.0, -319.0, 0.0, 0.0, 0.0, -49.0, 0.0, 0.0, 0.0, 0.0, 78.0, 4.0, 52.0, -20.0, 0.0, 0.0, 0.0, 178.0, -6.0, -20.0, -6.0, -14.0, 0.0, 0.0, -20.0, -8.0, 0.0, 112.0, 0.0, -85.0, 0.0, -96.0, 0.0, -221.0, -10.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 6.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, 95.0, 0.0, 0.0, -244.0, -2.0, 73.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, -4.0, 0.0, 0.0, 120.0, 0.0, -4.0, 0.0, 0.0, -11.0, 0.0, -4.0, 0.0, -222.0, 0.0, -10.0, 0.0, 16.0, -12.0, 1.0, 0.0, 92.0, 0.0, -2.0, -6.0, -118.0, -4.0, -318.0, 0.0, 0.0, 0.0, 133.0], "policy_predator_policy_reward": [0.0, 0.0, 21.0, 50.0, 8.0, 20.0, 0.0, 0.0, 119.0, 184.0, 183.0, 143.0, 18.0, 1.0, 1.0, 0.0, 3.0, 0.0, 61.0, 45.0, 38.0, 56.0, 0.0, 0.0, 0.0, 0.0, 28.0, 30.0, 0.0, 0.0, 0.0, 3.0, 125.0, 125.0, 0.0, 0.0, 4.0, 5.0, 0.0, 18.0, 95.0, 91.0, 49.0, 55.0, 100.0, 94.0, 72.0, 54.0, 122.0, 117.0, 0.0, 0.0, 0.0, 0.0, 111.0, 121.0, 109.0, 100.0, 19.0, 136.0, 18.0, 27.0, 0.0, 6.0, 0.0, 7.0, 0.0, 0.0, 35.0, 166.0, 0.0, 0.0, 79.0, 72.0, 0.0, 0.0, 147.0, 200.0, 15.0, 39.0, 11.0, 0.0, 56.0, 29.0, 137.0, 78.0, 0.0, 3.0, 4.0, 3.0, 90.0, 151.0, 56.0, 199.0, 86.0, 105.0, 41.0, 6.0, 60.0, 144.0, 105.0, 106.0, 98.0, 124.0, 0.0, 0.0, 69.0, 155.0, 0.0, 0.0, 66.0, 68.0, 0.0, 0.0, 0.0, 0.0, 16.0, 3.0, 47.0, 3.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 77.0, 49.0, 4.0, 52.0, 75.0, 89.0, 7.0, 5.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 62.0, 25.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 14.0, 10.0, 0.0, 0.0, 1.0, 122.0, 10.0, 29.0, 0.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 0.0, 24.0, 2.0, 0.0, 5.0, 3.0, 2.0, 0.0, 0.0, 134.0, 5.0, 5.0, 0.0, 0.0, 0.0, 6.0, 26.0, 0.0, 0.0, 1.0, 3.0, 67.0, 161.0, 5.0, 0.0, 0.0, 10.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.534416680388176, "mean_inference_ms": 8.265614959349985, "mean_action_processing_ms": 0.6732476199619171, "mean_env_wait_ms": 0.9313461860573662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008018732070922852, "StateBufferConnector_ms": 0.009450197219848633, "ViewRequirementAgentConnector_ms": 0.12819528579711914}, "num_episodes": 22, "episode_return_max": 178.0, "episode_return_min": -494.0, "episode_return_mean": -1.24, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.9755415849001, "num_env_steps_trained_throughput_per_sec": 288.9755415849001, "timesteps_total": 480000, "num_env_steps_sampled_lifetime": 480000, "num_agent_steps_sampled_lifetime": 1920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1920000, "timers": {"training_iteration_time_ms": 246554.939, "restore_workers_time_ms": 0.014, "training_step_time_ms": 246554.862, "sample_time_ms": 224089.483, "learn_time_ms": 22442.862, "learn_throughput": 178.23, "synch_weights_time_ms": 18.196}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "done": false, "training_iteration": 120, "trial_id": "f6b99_00000", "date": "2024-08-13_21-03-59", "timestamp": 1723597439, "time_this_iter_s": 13.887282848358154, "time_total_s": 4738.310864686966, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b623daf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4738.310864686966, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 52.185, "ram_util_percent": 83.825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.800159021305344, "cur_kl_coeff": 3.089904785156249e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8365715285299947, "policy_loss": -0.00238502160436597, "vf_loss": 0.8389564838753175, "vf_explained_var": 0.061190641904003404, "kl": 0.002109504759770953, "entropy": 0.0751632499651461, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 227745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7622096325512286, "cur_kl_coeff": 0.00027809143066406236, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3029337832063594, "policy_loss": -0.008572000730289984, "vf_loss": 1.311503799125631, "vf_explained_var": 0.41939298895301014, "kl": 0.007134481488307141, "entropy": 0.2365662767931267, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 227745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 1936000, "num_agent_steps_trained": 1936000}, "env_runners": {"episode_reward_max": 326.0, "episode_reward_min": -494.0, "episode_reward_mean": 9.28, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -24.58, "predator_policy": 29.22}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -18.0, 14.0, 48.0, 47.0, 11.0, -45.0, 2.0, 0.0, -48.0, 5.0, -117.0, -14.0, -6.0, -7.0, 0.0, -121.0, 1.0, 18.0, 0.0, -53.0, 102.0, -9.0, 75.0, 40.0, -3.0, 165.0, -66.0, -494.0, 14.0, 73.0, -113.0, 81.0, 20.0, 0.0, -84.0, 0.0, 85.0, 0.0, 0.0, 101.0, 82.0, 0.0, 178.0, -16.0, -10.0, 0.0, -18.0, 112.0, 41.0, -40.0, -57.0, -10.0, 0.0, 0.0, -5.0, 93.0, 0.0, -3.0, 0.0, 119.0, 0.0, -123.0, 112.0, 0.0, -5.0, -2.0, 0.0, 144.0, -2.0, -3.0, -2.0, -88.0, 0.0, 16.0, -5.0, 118.0, -1.0, -54.0, -156.0, 0.0, 143.0, -15.0, 0.0, 0.0, 0.0, 0.0, 326.0, 1.0, -3.0, 9.0, -4.0, 199.0, -20.0, 274.0, 4.0, 0.0, -86.0, -13.0, -5.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-10.0, 0.0, -36.0, 0.0, -172.0, 0.0, -45.0, -11.0, -147.0, 0.0, -116.0, 1.0, -266.0, -18.0, 0.0, 2.0, 0.0, 0.0, -225.0, -55.0, -186.0, -18.0, -272.0, 0.0, 0.0, -59.0, -10.0, -2.0, -14.0, 0.0, 0.0, 0.0, 0.0, -322.0, 1.0, 0.0, -65.0, -68.0, 0.0, 0.0, -400.0, 0.0, -16.0, 64.0, -20.0, 0.0, -10.0, 0.0, -98.0, -77.0, 0.0, -6.0, 158.0, 0.0, 7.0, -314.0, -352.0, -397.0, -177.0, 0.0, 28.0, -2.0, 0.0, -317.0, -124.0, -6.0, -8.0, -194.0, 0.0, 0.0, 11.0, -319.0, 0.0, 0.0, 0.0, -49.0, 0.0, 0.0, 0.0, 0.0, 78.0, 4.0, 52.0, -20.0, 0.0, 0.0, 0.0, 178.0, -6.0, -20.0, -6.0, -14.0, 0.0, 0.0, -20.0, -8.0, 0.0, 112.0, 0.0, -85.0, 0.0, -96.0, 0.0, -221.0, -10.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 6.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, 95.0, 0.0, 0.0, -244.0, -2.0, 73.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, -4.0, 0.0, 0.0, 120.0, 0.0, -4.0, 0.0, 0.0, -11.0, 0.0, -4.0, 0.0, -222.0, 0.0, -10.0, 0.0, 16.0, -12.0, 1.0, 0.0, 92.0, 0.0, -2.0, -6.0, -118.0, -4.0, -318.0, 0.0, 0.0, 0.0, 133.0, 0.0, -32.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 193.0, 102.0, -2.0, 2.0, -6.0, 0.0, 9.0, 0.0, 1.0, -10.0, 0.0, 199.0, -14.0, -26.0, 75.0, 129.0, 9.0, -10.0, 0.0, 0.0, -223.0, 0.0, -22.0, -4.0, 0.0, -10.0], "policy_predator_policy_reward": [4.0, 5.0, 0.0, 18.0, 95.0, 91.0, 49.0, 55.0, 100.0, 94.0, 72.0, 54.0, 122.0, 117.0, 0.0, 0.0, 0.0, 0.0, 111.0, 121.0, 109.0, 100.0, 19.0, 136.0, 18.0, 27.0, 0.0, 6.0, 0.0, 7.0, 0.0, 0.0, 35.0, 166.0, 0.0, 0.0, 79.0, 72.0, 0.0, 0.0, 147.0, 200.0, 15.0, 39.0, 11.0, 0.0, 56.0, 29.0, 137.0, 78.0, 0.0, 3.0, 4.0, 3.0, 90.0, 151.0, 56.0, 199.0, 86.0, 105.0, 41.0, 6.0, 60.0, 144.0, 105.0, 106.0, 98.0, 124.0, 0.0, 0.0, 69.0, 155.0, 0.0, 0.0, 66.0, 68.0, 0.0, 0.0, 0.0, 0.0, 16.0, 3.0, 47.0, 3.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 77.0, 49.0, 4.0, 52.0, 75.0, 89.0, 7.0, 5.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 62.0, 25.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 14.0, 10.0, 0.0, 0.0, 1.0, 122.0, 10.0, 29.0, 0.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 0.0, 24.0, 2.0, 0.0, 5.0, 3.0, 2.0, 0.0, 0.0, 134.0, 5.0, 5.0, 0.0, 0.0, 0.0, 6.0, 26.0, 0.0, 0.0, 1.0, 3.0, 67.0, 161.0, 5.0, 0.0, 0.0, 10.0, 0.0, 11.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 19.0, 0.0, 1.0, 0.0, 3.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 4.0, 16.0, 32.0, 38.0, 0.0, 5.0, 0.0, 0.0, 137.0, 0.0, 0.0, 13.0, 0.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.75156615253398, "mean_inference_ms": 8.016460120664942, "mean_action_processing_ms": 0.6658491727971816, "mean_env_wait_ms": 1.051357821657746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005735635757446289, "StateBufferConnector_ms": 0.006849765777587891, "ViewRequirementAgentConnector_ms": 0.11778318881988525}, "num_episodes": 18, "episode_return_max": 326.0, "episode_return_min": -494.0, "episode_return_mean": 9.28, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1936000, "num_agent_steps_trained": 1936000, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 59.84976991489724, "num_env_steps_trained_throughput_per_sec": 59.84976991489724, "timesteps_total": 484000, "num_env_steps_sampled_lifetime": 484000, "num_agent_steps_sampled_lifetime": 1936000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1936000, "timers": {"training_iteration_time_ms": 242029.045, "restore_workers_time_ms": 0.014, "training_step_time_ms": 242028.97, "sample_time_ms": 223981.344, "learn_time_ms": 18025.095, "learn_throughput": 221.913, "synch_weights_time_ms": 18.11}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 1936000, "num_agent_steps_trained": 1936000}, "done": false, "training_iteration": 121, "trial_id": "f6b99_00000", "date": "2024-08-13_21-05-06", "timestamp": 1723597506, "time_this_iter_s": 66.87307596206665, "time_total_s": 4805.183940649033, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b626bb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4805.183940649033, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 49.54736842105263, "ram_util_percent": 83.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7498714667069848, "cur_kl_coeff": 1.5449523925781246e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2686211311312579, "policy_loss": -0.0029279768762607425, "vf_loss": 1.2715490575189943, "vf_explained_var": 0.027077683569893006, "kl": 0.0036788020307496243, "entropy": 0.09700464460230063, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 229635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2562670255621904, "cur_kl_coeff": 0.00027809143066406236, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6591494438194094, "policy_loss": -0.01149557577593932, "vf_loss": 1.6706423033797553, "vf_explained_var": -0.6446860812959216, "kl": 0.009766611415040047, "entropy": 0.27713944680949365, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 229635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 1952000, "num_agent_steps_trained": 1952000}, "env_runners": {"episode_reward_max": 326.0, "episode_reward_min": -494.0, "episode_reward_mean": 10.95, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -17.815, "predator_policy": 23.29}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.0, 0.0, -53.0, 102.0, -9.0, 75.0, 40.0, -3.0, 165.0, -66.0, -494.0, 14.0, 73.0, -113.0, 81.0, 20.0, 0.0, -84.0, 0.0, 85.0, 0.0, 0.0, 101.0, 82.0, 0.0, 178.0, -16.0, -10.0, 0.0, -18.0, 112.0, 41.0, -40.0, -57.0, -10.0, 0.0, 0.0, -5.0, 93.0, 0.0, -3.0, 0.0, 119.0, 0.0, -123.0, 112.0, 0.0, -5.0, -2.0, 0.0, 144.0, -2.0, -3.0, -2.0, -88.0, 0.0, 16.0, -5.0, 118.0, -1.0, -54.0, -156.0, 0.0, 143.0, -15.0, 0.0, 0.0, 0.0, 0.0, 326.0, 1.0, -3.0, 9.0, -4.0, 199.0, -20.0, 274.0, 4.0, 0.0, -86.0, -13.0, -5.0, 0.0, 4.0, -200.0, -180.0, -5.0, 132.0, 0.0, 4.0, 6.0, 0.0, -6.0, -6.0, -5.0, -13.0, 173.0, 32.0, -11.0, -7.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-65.0, -68.0, 0.0, 0.0, -400.0, 0.0, -16.0, 64.0, -20.0, 0.0, -10.0, 0.0, -98.0, -77.0, 0.0, -6.0, 158.0, 0.0, 7.0, -314.0, -352.0, -397.0, -177.0, 0.0, 28.0, -2.0, 0.0, -317.0, -124.0, -6.0, -8.0, -194.0, 0.0, 0.0, 11.0, -319.0, 0.0, 0.0, 0.0, -49.0, 0.0, 0.0, 0.0, 0.0, 78.0, 4.0, 52.0, -20.0, 0.0, 0.0, 0.0, 178.0, -6.0, -20.0, -6.0, -14.0, 0.0, 0.0, -20.0, -8.0, 0.0, 112.0, 0.0, -85.0, 0.0, -96.0, 0.0, -221.0, -10.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 6.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, 95.0, 0.0, 0.0, -244.0, -2.0, 73.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, -4.0, 0.0, 0.0, 120.0, 0.0, -4.0, 0.0, 0.0, -11.0, 0.0, -4.0, 0.0, -222.0, 0.0, -10.0, 0.0, 16.0, -12.0, 1.0, 0.0, 92.0, 0.0, -2.0, -6.0, -118.0, -4.0, -318.0, 0.0, 0.0, 0.0, 133.0, 0.0, -32.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 193.0, 102.0, -2.0, 2.0, -6.0, 0.0, 9.0, 0.0, 1.0, -10.0, 0.0, 199.0, -14.0, -26.0, 75.0, 129.0, 9.0, -10.0, 0.0, 0.0, -223.0, 0.0, -22.0, -4.0, 0.0, -10.0, 0.0, 0.0, 4.0, 0.0, 0.0, -400.0, -392.0, 0.0, -10.0, 0.0, 0.0, 132.0, 0.0, 0.0, -8.0, 4.0, -2.0, 7.0, 0.0, 0.0, -29.0, -4.0, 0.0, -12.0, 0.0, -10.0, -31.0, 0.0, 173.0, 0.0, -4.0, 0.0, -10.0, -19.0, -10.0, -6.0], "policy_predator_policy_reward": [79.0, 72.0, 0.0, 0.0, 147.0, 200.0, 15.0, 39.0, 11.0, 0.0, 56.0, 29.0, 137.0, 78.0, 0.0, 3.0, 4.0, 3.0, 90.0, 151.0, 56.0, 199.0, 86.0, 105.0, 41.0, 6.0, 60.0, 144.0, 105.0, 106.0, 98.0, 124.0, 0.0, 0.0, 69.0, 155.0, 0.0, 0.0, 66.0, 68.0, 0.0, 0.0, 0.0, 0.0, 16.0, 3.0, 47.0, 3.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 77.0, 49.0, 4.0, 52.0, 75.0, 89.0, 7.0, 5.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 62.0, 25.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 14.0, 10.0, 0.0, 0.0, 1.0, 122.0, 10.0, 29.0, 0.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 0.0, 24.0, 2.0, 0.0, 5.0, 3.0, 2.0, 0.0, 0.0, 134.0, 5.0, 5.0, 0.0, 0.0, 0.0, 6.0, 26.0, 0.0, 0.0, 1.0, 3.0, 67.0, 161.0, 5.0, 0.0, 0.0, 10.0, 0.0, 11.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 19.0, 0.0, 1.0, 0.0, 3.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 4.0, 16.0, 32.0, 38.0, 0.0, 5.0, 0.0, 0.0, 137.0, 0.0, 0.0, 13.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 196.0, 16.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 1.0, 0.0, 0.0, 0.0, 12.0, 15.0, 0.0, 6.0, 0.0, 5.0, 3.0, 15.0, 0.0, 0.0, 0.0, 36.0, 5.0, 13.0, 0.0, 9.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.1556496476211, "mean_inference_ms": 7.971235099286358, "mean_action_processing_ms": 0.6628219344883246, "mean_env_wait_ms": 1.1728566456017915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005086302757263184, "StateBufferConnector_ms": 0.0047245025634765625, "ViewRequirementAgentConnector_ms": 0.11993944644927979}, "num_episodes": 18, "episode_return_max": 326.0, "episode_return_min": -494.0, "episode_return_mean": 10.95, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1952000, "num_agent_steps_trained": 1952000, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.28508851413574, "num_env_steps_trained_throughput_per_sec": 304.28508851413574, "timesteps_total": 488000, "num_env_steps_sampled_lifetime": 488000, "num_agent_steps_sampled_lifetime": 1952000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1952000, "timers": {"training_iteration_time_ms": 241862.982, "restore_workers_time_ms": 0.014, "training_step_time_ms": 241862.907, "sample_time_ms": 223864.567, "learn_time_ms": 17975.97, "learn_throughput": 222.519, "synch_weights_time_ms": 17.712}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 1952000, "num_agent_steps_trained": 1952000}, "done": false, "training_iteration": 122, "trial_id": "f6b99_00000", "date": "2024-08-13_21-05-19", "timestamp": 1723597519, "time_this_iter_s": 13.18376088142395, "time_total_s": 4818.3677015304565, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b626bdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4818.3677015304565, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 48.72777777777778, "ram_util_percent": 83.66111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3942553286829953, "cur_kl_coeff": 7.724761962890623e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9049917718405447, "policy_loss": -0.0014221975163472866, "vf_loss": 1.9064139626171224, "vf_explained_var": 0.014896547258215606, "kl": 0.003786170018284567, "entropy": 0.07838820933940865, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 231525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.0709057166305165, "cur_kl_coeff": 0.00027809143066406236, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1855972003053736, "policy_loss": -0.00460834657605836, "vf_loss": 2.1902033119605333, "vf_explained_var": -0.27009922540377057, "kl": 0.008071355551923686, "entropy": 0.32885908258182034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 231525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000}, "env_runners": {"episode_reward_max": 326.0, "episode_reward_min": -200.0, "episode_reward_mean": 16.18, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -6.505, "predator_policy": 14.595}, "custom_metrics": {}, "hist_stats": {"episode_reward": [82.0, 0.0, 178.0, -16.0, -10.0, 0.0, -18.0, 112.0, 41.0, -40.0, -57.0, -10.0, 0.0, 0.0, -5.0, 93.0, 0.0, -3.0, 0.0, 119.0, 0.0, -123.0, 112.0, 0.0, -5.0, -2.0, 0.0, 144.0, -2.0, -3.0, -2.0, -88.0, 0.0, 16.0, -5.0, 118.0, -1.0, -54.0, -156.0, 0.0, 143.0, -15.0, 0.0, 0.0, 0.0, 0.0, 326.0, 1.0, -3.0, 9.0, -4.0, 199.0, -20.0, 274.0, 4.0, 0.0, -86.0, -13.0, -5.0, 0.0, 4.0, -200.0, -180.0, -5.0, 132.0, 0.0, 4.0, 6.0, 0.0, -6.0, -6.0, -5.0, -13.0, 173.0, 32.0, -11.0, -7.0, -4.0, 17.0, -56.0, -67.0, -9.0, 151.0, 0.0, 14.0, 49.0, 152.0, 167.0, 7.0, 0.0, -159.0, 136.0, -25.0, -4.0, -123.0, 163.0, 73.0, -8.0, -5.0, 6.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [52.0, -20.0, 0.0, 0.0, 0.0, 178.0, -6.0, -20.0, -6.0, -14.0, 0.0, 0.0, -20.0, -8.0, 0.0, 112.0, 0.0, -85.0, 0.0, -96.0, 0.0, -221.0, -10.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 6.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, 95.0, 0.0, 0.0, -244.0, -2.0, 73.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, -4.0, 0.0, 0.0, 120.0, 0.0, -4.0, 0.0, 0.0, -11.0, 0.0, -4.0, 0.0, -222.0, 0.0, -10.0, 0.0, 16.0, -12.0, 1.0, 0.0, 92.0, 0.0, -2.0, -6.0, -118.0, -4.0, -318.0, 0.0, 0.0, 0.0, 133.0, 0.0, -32.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 193.0, 102.0, -2.0, 2.0, -6.0, 0.0, 9.0, 0.0, 1.0, -10.0, 0.0, 199.0, -14.0, -26.0, 75.0, 129.0, 9.0, -10.0, 0.0, 0.0, -223.0, 0.0, -22.0, -4.0, 0.0, -10.0, 0.0, 0.0, 4.0, 0.0, 0.0, -400.0, -392.0, 0.0, -10.0, 0.0, 0.0, 132.0, 0.0, 0.0, -8.0, 4.0, -2.0, 7.0, 0.0, 0.0, -29.0, -4.0, 0.0, -12.0, 0.0, -10.0, -31.0, 0.0, 173.0, 0.0, -4.0, 0.0, -10.0, -19.0, -10.0, -6.0, -8.0, 0.0, -24.0, -2.0, -184.0, 0.0, 1.0, -152.0, -8.0, -8.0, 0.0, 85.0, 0.0, 0.0, -16.0, -12.0, 46.0, -6.0, 144.0, 0.0, -2.0, 161.0, 0.0, 7.0, 0.0, 0.0, 0.0, -366.0, -14.0, 140.0, -51.0, -12.0, -8.0, 0.0, -251.0, 0.0, 158.0, 0.0, 82.0, -18.0, -41.0, 0.0, -17.0, 0.0, 0.0, -31.0], "policy_predator_policy_reward": [47.0, 3.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 77.0, 49.0, 4.0, 52.0, 75.0, 89.0, 7.0, 5.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 62.0, 25.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 14.0, 10.0, 0.0, 0.0, 1.0, 122.0, 10.0, 29.0, 0.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 0.0, 24.0, 2.0, 0.0, 5.0, 3.0, 2.0, 0.0, 0.0, 134.0, 5.0, 5.0, 0.0, 0.0, 0.0, 6.0, 26.0, 0.0, 0.0, 1.0, 3.0, 67.0, 161.0, 5.0, 0.0, 0.0, 10.0, 0.0, 11.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 19.0, 0.0, 1.0, 0.0, 3.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 4.0, 16.0, 32.0, 38.0, 0.0, 5.0, 0.0, 0.0, 137.0, 0.0, 0.0, 13.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 196.0, 16.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 1.0, 0.0, 0.0, 0.0, 12.0, 15.0, 0.0, 6.0, 0.0, 5.0, 3.0, 15.0, 0.0, 0.0, 0.0, 36.0, 5.0, 13.0, 0.0, 9.0, 1.0, 3.0, 19.0, 24.0, 0.0, 128.0, 0.0, 84.0, 7.0, 0.0, 34.0, 32.0, 0.0, 0.0, 21.0, 21.0, 6.0, 3.0, 0.0, 8.0, 1.0, 7.0, 0.0, 0.0, 0.0, 0.0, 183.0, 24.0, 0.0, 10.0, 25.0, 13.0, 4.0, 0.0, 127.0, 1.0, 0.0, 5.0, 0.0, 9.0, 16.0, 17.0, 5.0, 7.0, 20.0, 17.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.928670664967623, "mean_inference_ms": 8.108603694562918, "mean_action_processing_ms": 0.6652578158377906, "mean_env_wait_ms": 1.1685000315436662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004705309867858887, "StateBufferConnector_ms": 0.005950808525085449, "ViewRequirementAgentConnector_ms": 0.1172947883605957}, "num_episodes": 23, "episode_return_max": 326.0, "episode_return_min": -200.0, "episode_return_mean": 16.18, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.1256141253717, "num_env_steps_trained_throughput_per_sec": 301.1256141253717, "timesteps_total": 492000, "num_env_steps_sampled_lifetime": 492000, "num_agent_steps_sampled_lifetime": 1968000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1968000, "timers": {"training_iteration_time_ms": 241852.493, "restore_workers_time_ms": 0.014, "training_step_time_ms": 241852.419, "sample_time_ms": 223868.136, "learn_time_ms": 17962.005, "learn_throughput": 222.692, "synch_weights_time_ms": 17.853}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000}, "done": false, "training_iteration": 123, "trial_id": "f6b99_00000", "date": "2024-08-13_21-05-32", "timestamp": 1723597532, "time_this_iter_s": 13.329128980636597, "time_total_s": 4831.696830511093, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b626bd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4831.696830511093, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 48.50526315789474, "ram_util_percent": 83.73157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.498636984856671, "cur_kl_coeff": 3.8623809814453115e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9304446889609888, "policy_loss": -0.0013892968536339818, "vf_loss": 1.931833986315147, "vf_explained_var": 0.0285158616840524, "kl": 0.002159875677690918, "entropy": 0.09196372947325467, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 233415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2484116333029256, "cur_kl_coeff": 0.00027809143066406236, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.519127624060111, "policy_loss": -0.01034909300358286, "vf_loss": 1.5294745871314297, "vf_explained_var": -0.6216509739557902, "kl": 0.00766760002822365, "entropy": 0.23221691656049598, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 233415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 1984000, "num_agent_steps_trained": 1984000}, "env_runners": {"episode_reward_max": 326.0, "episode_reward_min": -200.0, "episode_reward_mean": 17.7, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -6.535, "predator_policy": 15.385}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 119.0, 0.0, -123.0, 112.0, 0.0, -5.0, -2.0, 0.0, 144.0, -2.0, -3.0, -2.0, -88.0, 0.0, 16.0, -5.0, 118.0, -1.0, -54.0, -156.0, 0.0, 143.0, -15.0, 0.0, 0.0, 0.0, 0.0, 326.0, 1.0, -3.0, 9.0, -4.0, 199.0, -20.0, 274.0, 4.0, 0.0, -86.0, -13.0, -5.0, 0.0, 4.0, -200.0, -180.0, -5.0, 132.0, 0.0, 4.0, 6.0, 0.0, -6.0, -6.0, -5.0, -13.0, 173.0, 32.0, -11.0, -7.0, -4.0, 17.0, -56.0, -67.0, -9.0, 151.0, 0.0, 14.0, 49.0, 152.0, 167.0, 7.0, 0.0, -159.0, 136.0, -25.0, -4.0, -123.0, 163.0, 73.0, -8.0, -5.0, 6.0, 0.0, -71.0, 0.0, 171.0, 141.0, 0.0, -119.0, 25.0, 164.0, 0.0, -6.0, 2.0, 155.0, 0.0, -6.0, 86.0, -43.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 95.0, 0.0, 0.0, -244.0, -2.0, 73.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, -4.0, 0.0, 0.0, 120.0, 0.0, -4.0, 0.0, 0.0, -11.0, 0.0, -4.0, 0.0, -222.0, 0.0, -10.0, 0.0, 16.0, -12.0, 1.0, 0.0, 92.0, 0.0, -2.0, -6.0, -118.0, -4.0, -318.0, 0.0, 0.0, 0.0, 133.0, 0.0, -32.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 193.0, 102.0, -2.0, 2.0, -6.0, 0.0, 9.0, 0.0, 1.0, -10.0, 0.0, 199.0, -14.0, -26.0, 75.0, 129.0, 9.0, -10.0, 0.0, 0.0, -223.0, 0.0, -22.0, -4.0, 0.0, -10.0, 0.0, 0.0, 4.0, 0.0, 0.0, -400.0, -392.0, 0.0, -10.0, 0.0, 0.0, 132.0, 0.0, 0.0, -8.0, 4.0, -2.0, 7.0, 0.0, 0.0, -29.0, -4.0, 0.0, -12.0, 0.0, -10.0, -31.0, 0.0, 173.0, 0.0, -4.0, 0.0, -10.0, -19.0, -10.0, -6.0, -8.0, 0.0, -24.0, -2.0, -184.0, 0.0, 1.0, -152.0, -8.0, -8.0, 0.0, 85.0, 0.0, 0.0, -16.0, -12.0, 46.0, -6.0, 144.0, 0.0, -2.0, 161.0, 0.0, 7.0, 0.0, 0.0, 0.0, -366.0, -14.0, 140.0, -51.0, -12.0, -8.0, 0.0, -251.0, 0.0, 158.0, 0.0, 82.0, -18.0, -41.0, 0.0, -17.0, 0.0, 0.0, -31.0, 0.0, 0.0, -230.0, -6.0, 0.0, 0.0, 156.0, -6.0, 131.0, 0.0, 0.0, 0.0, 0.0, -383.0, -44.0, 0.0, 0.0, 162.0, 0.0, 0.0, 0.0, -12.0, 0.0, 2.0, 77.0, 12.0, 0.0, 0.0, -12.0, 0.0, 0.0, 55.0, -94.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 14.0, 10.0, 0.0, 0.0, 1.0, 122.0, 10.0, 29.0, 0.0, 0.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 0.0, 24.0, 2.0, 0.0, 5.0, 3.0, 2.0, 0.0, 0.0, 134.0, 5.0, 5.0, 0.0, 0.0, 0.0, 6.0, 26.0, 0.0, 0.0, 1.0, 3.0, 67.0, 161.0, 5.0, 0.0, 0.0, 10.0, 0.0, 11.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 19.0, 0.0, 1.0, 0.0, 3.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 4.0, 16.0, 32.0, 38.0, 0.0, 5.0, 0.0, 0.0, 137.0, 0.0, 0.0, 13.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 196.0, 16.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 1.0, 0.0, 0.0, 0.0, 12.0, 15.0, 0.0, 6.0, 0.0, 5.0, 3.0, 15.0, 0.0, 0.0, 0.0, 36.0, 5.0, 13.0, 0.0, 9.0, 1.0, 3.0, 19.0, 24.0, 0.0, 128.0, 0.0, 84.0, 7.0, 0.0, 34.0, 32.0, 0.0, 0.0, 21.0, 21.0, 6.0, 3.0, 0.0, 8.0, 1.0, 7.0, 0.0, 0.0, 0.0, 0.0, 183.0, 24.0, 0.0, 10.0, 25.0, 13.0, 4.0, 0.0, 127.0, 1.0, 0.0, 5.0, 0.0, 9.0, 16.0, 17.0, 5.0, 7.0, 20.0, 17.0, 0.0, 0.0, 32.0, 133.0, 0.0, 0.0, 12.0, 9.0, 5.0, 5.0, 0.0, 0.0, 191.0, 73.0, 25.0, 44.0, 2.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 33.0, 33.0, 0.0, 0.0, 0.0, 6.0, 5.0, 26.0, 51.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.69565015764728, "mean_inference_ms": 7.873649996731342, "mean_action_processing_ms": 0.656203534934734, "mean_env_wait_ms": 1.1582330573414086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038559436798095703, "StateBufferConnector_ms": 0.004626870155334473, "ViewRequirementAgentConnector_ms": 0.10808217525482178}, "num_episodes": 18, "episode_return_max": 326.0, "episode_return_min": -200.0, "episode_return_mean": 17.7, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1984000, "num_agent_steps_trained": 1984000, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.75030585418716, "num_env_steps_trained_throughput_per_sec": 294.75030585418716, "timesteps_total": 496000, "num_env_steps_sampled_lifetime": 496000, "num_agent_steps_sampled_lifetime": 1984000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1984000, "timers": {"training_iteration_time_ms": 241888.807, "restore_workers_time_ms": 0.014, "training_step_time_ms": 241888.746, "sample_time_ms": 223864.949, "learn_time_ms": 18002.128, "learn_throughput": 222.196, "synch_weights_time_ms": 17.623}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 1984000, "num_agent_steps_trained": 1984000}, "done": false, "training_iteration": 124, "trial_id": "f6b99_00000", "date": "2024-08-13_21-05-46", "timestamp": 1723597546, "time_this_iter_s": 13.634002923965454, "time_total_s": 4845.330833435059, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6096430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4845.330833435059, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 49.635000000000005, "ram_util_percent": 83.735}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.383059810543502, "cur_kl_coeff": 1.9311904907226557e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8927761925275994, "policy_loss": -0.0009323310989038969, "vf_loss": 0.8937085239817857, "vf_explained_var": -0.002740400178091867, "kl": 0.006454311167737527, "entropy": 0.08968401798613804, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 235305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4896064333657106, "cur_kl_coeff": 0.00027809143066406236, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8356106766304937, "policy_loss": -0.010039306173061646, "vf_loss": 0.8456482786428992, "vf_explained_var": -0.8825724884000404, "kl": 0.006125045987745449, "entropy": 0.14176179892802365, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 235305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000}, "env_runners": {"episode_reward_max": 326.0, "episode_reward_min": -200.0, "episode_reward_mean": 17.51, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -6.385, "predator_policy": 15.14}, "custom_metrics": {}, "hist_stats": {"episode_reward": [143.0, -15.0, 0.0, 0.0, 0.0, 0.0, 326.0, 1.0, -3.0, 9.0, -4.0, 199.0, -20.0, 274.0, 4.0, 0.0, -86.0, -13.0, -5.0, 0.0, 4.0, -200.0, -180.0, -5.0, 132.0, 0.0, 4.0, 6.0, 0.0, -6.0, -6.0, -5.0, -13.0, 173.0, 32.0, -11.0, -7.0, -4.0, 17.0, -56.0, -67.0, -9.0, 151.0, 0.0, 14.0, 49.0, 152.0, 167.0, 7.0, 0.0, -159.0, 136.0, -25.0, -4.0, -123.0, 163.0, 73.0, -8.0, -5.0, 6.0, 0.0, -71.0, 0.0, 171.0, 141.0, 0.0, -119.0, 25.0, 164.0, 0.0, -6.0, 2.0, 155.0, 0.0, -6.0, 86.0, -43.0, 0.0, -1.0, -1.0, 23.0, 16.0, 0.0, 0.0, -70.0, 44.0, -8.0, -6.0, 7.0, 0.0, 0.0, 0.0, -12.0, -1.0, 0.0, 58.0, 6.0, 15.0, -21.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 133.0, 0.0, -32.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 193.0, 102.0, -2.0, 2.0, -6.0, 0.0, 9.0, 0.0, 1.0, -10.0, 0.0, 199.0, -14.0, -26.0, 75.0, 129.0, 9.0, -10.0, 0.0, 0.0, -223.0, 0.0, -22.0, -4.0, 0.0, -10.0, 0.0, 0.0, 4.0, 0.0, 0.0, -400.0, -392.0, 0.0, -10.0, 0.0, 0.0, 132.0, 0.0, 0.0, -8.0, 4.0, -2.0, 7.0, 0.0, 0.0, -29.0, -4.0, 0.0, -12.0, 0.0, -10.0, -31.0, 0.0, 173.0, 0.0, -4.0, 0.0, -10.0, -19.0, -10.0, -6.0, -8.0, 0.0, -24.0, -2.0, -184.0, 0.0, 1.0, -152.0, -8.0, -8.0, 0.0, 85.0, 0.0, 0.0, -16.0, -12.0, 46.0, -6.0, 144.0, 0.0, -2.0, 161.0, 0.0, 7.0, 0.0, 0.0, 0.0, -366.0, -14.0, 140.0, -51.0, -12.0, -8.0, 0.0, -251.0, 0.0, 158.0, 0.0, 82.0, -18.0, -41.0, 0.0, -17.0, 0.0, 0.0, -31.0, 0.0, 0.0, -230.0, -6.0, 0.0, 0.0, 156.0, -6.0, 131.0, 0.0, 0.0, 0.0, 0.0, -383.0, -44.0, 0.0, 0.0, 162.0, 0.0, 0.0, 0.0, -12.0, 0.0, 2.0, 77.0, 12.0, 0.0, 0.0, -12.0, 0.0, 0.0, 55.0, -94.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, -2.0, 17.0, 0.0, 16.0, 0.0, -7.0, 0.0, 0.0, 0.0, -158.0, 3.0, 0.0, 44.0, -2.0, -16.0, 0.0, -12.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -48.0, 0.0, -14.0, 0.0, 0.0, 0.0, -11.0, 55.0, 0.0, -12.0, -355.0, 8.0, -55.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [10.0, 0.0, 11.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 19.0, 0.0, 1.0, 0.0, 3.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 4.0, 16.0, 32.0, 38.0, 0.0, 5.0, 0.0, 0.0, 137.0, 0.0, 0.0, 13.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 196.0, 16.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 1.0, 0.0, 0.0, 0.0, 12.0, 15.0, 0.0, 6.0, 0.0, 5.0, 3.0, 15.0, 0.0, 0.0, 0.0, 36.0, 5.0, 13.0, 0.0, 9.0, 1.0, 3.0, 19.0, 24.0, 0.0, 128.0, 0.0, 84.0, 7.0, 0.0, 34.0, 32.0, 0.0, 0.0, 21.0, 21.0, 6.0, 3.0, 0.0, 8.0, 1.0, 7.0, 0.0, 0.0, 0.0, 0.0, 183.0, 24.0, 0.0, 10.0, 25.0, 13.0, 4.0, 0.0, 127.0, 1.0, 0.0, 5.0, 0.0, 9.0, 16.0, 17.0, 5.0, 7.0, 20.0, 17.0, 0.0, 0.0, 32.0, 133.0, 0.0, 0.0, 12.0, 9.0, 5.0, 5.0, 0.0, 0.0, 191.0, 73.0, 25.0, 44.0, 2.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 33.0, 33.0, 0.0, 0.0, 0.0, 6.0, 5.0, 26.0, 51.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 6.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 83.0, 2.0, 0.0, 0.0, 4.0, 6.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 32.0, 7.0, 6.0, 0.0, 0.0, 6.0, 8.0, 12.0, 6.0, 177.0, 185.0, 19.0, 15.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.80677364719121, "mean_inference_ms": 16.050416394512332, "mean_action_processing_ms": 1.2344177275801846, "mean_env_wait_ms": 2.599735508843139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052574872970581055, "StateBufferConnector_ms": 0.005115032196044922, "ViewRequirementAgentConnector_ms": 0.12090373039245605}, "num_episodes": 22, "episode_return_max": 326.0, "episode_return_min": -200.0, "episode_return_mean": 17.51, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1.4767415007492886, "num_env_steps_trained_throughput_per_sec": 1.4767415007492886, "timesteps_total": 500000, "num_env_steps_sampled_lifetime": 500000, "num_agent_steps_sampled_lifetime": 2000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2000000, "timers": {"training_iteration_time_ms": 322317.549, "restore_workers_time_ms": 0.014, "training_step_time_ms": 322317.496, "sample_time_ms": 304493.664, "learn_time_ms": 17802.392, "learn_throughput": 224.689, "synch_weights_time_ms": 17.589}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000}, "done": false, "training_iteration": 125, "trial_id": "f6b99_00000", "date": "2024-08-13_21-50-55", "timestamp": 1723600255, "time_this_iter_s": 2708.9962890148163, "time_total_s": 7554.327122449875, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b626b940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7554.327122449875, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 87.03725490196078, "ram_util_percent": 84.53529411764704}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9334259401632364, "cur_kl_coeff": 1.9311904907226557e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.782025142920711, "policy_loss": -0.00045298993311546467, "vf_loss": 1.7824781318820972, "vf_explained_var": 0.017298165957132974, "kl": 0.0011933012185022366, "entropy": 0.08980625829013883, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 237195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7799732470756802, "cur_kl_coeff": 0.00027809143066406236, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.101461642586365, "policy_loss": -0.014275402591006939, "vf_loss": 1.1157349567407022, "vf_explained_var": -0.8797821536581353, "kl": 0.007513382432959033, "entropy": 0.20802405357912734, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 237195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000}, "env_runners": {"episode_reward_max": 173.0, "episode_reward_min": -276.0, "episode_reward_mean": 3.57, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 173.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -15.65, "predator_policy": 17.435}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.0, 0.0, 4.0, -200.0, -180.0, -5.0, 132.0, 0.0, 4.0, 6.0, 0.0, -6.0, -6.0, -5.0, -13.0, 173.0, 32.0, -11.0, -7.0, -4.0, 17.0, -56.0, -67.0, -9.0, 151.0, 0.0, 14.0, 49.0, 152.0, 167.0, 7.0, 0.0, -159.0, 136.0, -25.0, -4.0, -123.0, 163.0, 73.0, -8.0, -5.0, 6.0, 0.0, -71.0, 0.0, 171.0, 141.0, 0.0, -119.0, 25.0, 164.0, 0.0, -6.0, 2.0, 155.0, 0.0, -6.0, 86.0, -43.0, 0.0, -1.0, -1.0, 23.0, 16.0, 0.0, 0.0, -70.0, 44.0, -8.0, -6.0, 7.0, 0.0, 0.0, 0.0, -12.0, -1.0, 0.0, 58.0, 6.0, 15.0, -21.0, 0.0, 0.0, 0.0, -18.0, -14.0, -145.0, 7.0, -146.0, 1.0, 8.0, -5.0, 34.0, 0.0, -276.0, -18.0, -2.0, 0.0, -5.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -10.0, 0.0, 0.0, 4.0, 0.0, 0.0, -400.0, -392.0, 0.0, -10.0, 0.0, 0.0, 132.0, 0.0, 0.0, -8.0, 4.0, -2.0, 7.0, 0.0, 0.0, -29.0, -4.0, 0.0, -12.0, 0.0, -10.0, -31.0, 0.0, 173.0, 0.0, -4.0, 0.0, -10.0, -19.0, -10.0, -6.0, -8.0, 0.0, -24.0, -2.0, -184.0, 0.0, 1.0, -152.0, -8.0, -8.0, 0.0, 85.0, 0.0, 0.0, -16.0, -12.0, 46.0, -6.0, 144.0, 0.0, -2.0, 161.0, 0.0, 7.0, 0.0, 0.0, 0.0, -366.0, -14.0, 140.0, -51.0, -12.0, -8.0, 0.0, -251.0, 0.0, 158.0, 0.0, 82.0, -18.0, -41.0, 0.0, -17.0, 0.0, 0.0, -31.0, 0.0, 0.0, -230.0, -6.0, 0.0, 0.0, 156.0, -6.0, 131.0, 0.0, 0.0, 0.0, 0.0, -383.0, -44.0, 0.0, 0.0, 162.0, 0.0, 0.0, 0.0, -12.0, 0.0, 2.0, 77.0, 12.0, 0.0, 0.0, -12.0, 0.0, 0.0, 55.0, -94.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, -2.0, 17.0, 0.0, 16.0, 0.0, -7.0, 0.0, 0.0, 0.0, -158.0, 3.0, 0.0, 44.0, -2.0, -16.0, 0.0, -12.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -48.0, 0.0, -14.0, 0.0, 0.0, 0.0, -11.0, 55.0, 0.0, -12.0, -355.0, 8.0, -55.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, -10.0, -28.0, 0.0, -10.0, -336.0, -2.0, 6.0, -16.0, -308.0, 0.0, 1.0, 13.0, -16.0, 0.0, -10.0, 25.0, -9.0, 0.0, 0.0, -391.0, -82.0, -143.0, 0.0, 0.0, -4.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 200.0, 196.0, 16.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 1.0, 0.0, 0.0, 0.0, 12.0, 15.0, 0.0, 6.0, 0.0, 5.0, 3.0, 15.0, 0.0, 0.0, 0.0, 36.0, 5.0, 13.0, 0.0, 9.0, 1.0, 3.0, 19.0, 24.0, 0.0, 128.0, 0.0, 84.0, 7.0, 0.0, 34.0, 32.0, 0.0, 0.0, 21.0, 21.0, 6.0, 3.0, 0.0, 8.0, 1.0, 7.0, 0.0, 0.0, 0.0, 0.0, 183.0, 24.0, 0.0, 10.0, 25.0, 13.0, 4.0, 0.0, 127.0, 1.0, 0.0, 5.0, 0.0, 9.0, 16.0, 17.0, 5.0, 7.0, 20.0, 17.0, 0.0, 0.0, 32.0, 133.0, 0.0, 0.0, 12.0, 9.0, 5.0, 5.0, 0.0, 0.0, 191.0, 73.0, 25.0, 44.0, 2.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 33.0, 33.0, 0.0, 0.0, 0.0, 6.0, 5.0, 26.0, 51.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 6.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 83.0, 2.0, 0.0, 0.0, 4.0, 6.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 32.0, 7.0, 6.0, 0.0, 0.0, 6.0, 8.0, 12.0, 6.0, 177.0, 185.0, 19.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 14.0, 33.0, 168.0, 2.0, 1.0, 27.0, 151.0, 0.0, 0.0, 8.0, 3.0, 0.0, 5.0, 7.0, 11.0, 0.0, 0.0, 197.0, 0.0, 45.0, 80.0, 2.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.96798158996504, "mean_inference_ms": 22.73712472323091, "mean_action_processing_ms": 1.8092288882854277, "mean_env_wait_ms": 3.5532923946766943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005491852760314941, "StateBufferConnector_ms": 0.005043506622314453, "ViewRequirementAgentConnector_ms": 0.12222051620483398}, "num_episodes": 18, "episode_return_max": 173.0, "episode_return_min": -276.0, "episode_return_mean": 3.57, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 219.4901556720788, "num_env_steps_trained_throughput_per_sec": 219.4901556720788, "timesteps_total": 504000, "num_env_steps_sampled_lifetime": 504000, "num_agent_steps_sampled_lifetime": 2016000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2016000, "timers": {"training_iteration_time_ms": 322274.924, "restore_workers_time_ms": 0.014, "training_step_time_ms": 322274.864, "sample_time_ms": 304537.726, "learn_time_ms": 17712.843, "learn_throughput": 225.825, "synch_weights_time_ms": 19.901}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000}, "done": false, "training_iteration": 126, "trial_id": "f6b99_00000", "date": "2024-08-13_21-51-14", "timestamp": 1723600274, "time_this_iter_s": 18.35121726989746, "time_total_s": 7572.678339719772, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6265ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7572.678339719772, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 74.40384615384616, "ram_util_percent": 83.94615384615385}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5489554164586243, "cur_kl_coeff": 9.655952453613279e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4797776159786042, "policy_loss": -0.0021196677472698627, "vf_loss": 1.4818972841614768, "vf_explained_var": 0.031100907149138275, "kl": 0.0020766049003451857, "entropy": 0.1091798412756472, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 239085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2838239492286765, "cur_kl_coeff": 0.00027809143066406236, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8560217454556435, "policy_loss": -0.007682487969508483, "vf_loss": 0.8637033738866055, "vf_explained_var": -0.9087795638848865, "kl": 0.0030780060176973634, "entropy": 0.17502221482456046, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 239085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 2032000, "num_agent_steps_trained": 2032000}, "env_runners": {"episode_reward_max": 171.0, "episode_reward_min": -276.0, "episode_reward_mean": 3.55, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -391.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 162.0, "predator_policy": 197.0}, "policy_reward_mean": {"prey_policy": -14.86, "predator_policy": 16.635}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.0, -4.0, 17.0, -56.0, -67.0, -9.0, 151.0, 0.0, 14.0, 49.0, 152.0, 167.0, 7.0, 0.0, -159.0, 136.0, -25.0, -4.0, -123.0, 163.0, 73.0, -8.0, -5.0, 6.0, 0.0, -71.0, 0.0, 171.0, 141.0, 0.0, -119.0, 25.0, 164.0, 0.0, -6.0, 2.0, 155.0, 0.0, -6.0, 86.0, -43.0, 0.0, -1.0, -1.0, 23.0, 16.0, 0.0, 0.0, -70.0, 44.0, -8.0, -6.0, 7.0, 0.0, 0.0, 0.0, -12.0, -1.0, 0.0, 58.0, 6.0, 15.0, -21.0, 0.0, 0.0, 0.0, -18.0, -14.0, -145.0, 7.0, -146.0, 1.0, 8.0, -5.0, 34.0, 0.0, -276.0, -18.0, -2.0, 0.0, -5.0, 0.0, 0.0, 0.0, -17.0, 6.0, 0.0, -2.0, 15.0, 0.0, 22.0, 0.0, -2.0, -15.0, 0.0, 1.0, 5.0, -68.0, -14.0, -13.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-10.0, -6.0, -8.0, 0.0, -24.0, -2.0, -184.0, 0.0, 1.0, -152.0, -8.0, -8.0, 0.0, 85.0, 0.0, 0.0, -16.0, -12.0, 46.0, -6.0, 144.0, 0.0, -2.0, 161.0, 0.0, 7.0, 0.0, 0.0, 0.0, -366.0, -14.0, 140.0, -51.0, -12.0, -8.0, 0.0, -251.0, 0.0, 158.0, 0.0, 82.0, -18.0, -41.0, 0.0, -17.0, 0.0, 0.0, -31.0, 0.0, 0.0, -230.0, -6.0, 0.0, 0.0, 156.0, -6.0, 131.0, 0.0, 0.0, 0.0, 0.0, -383.0, -44.0, 0.0, 0.0, 162.0, 0.0, 0.0, 0.0, -12.0, 0.0, 2.0, 77.0, 12.0, 0.0, 0.0, -12.0, 0.0, 0.0, 55.0, -94.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, -2.0, 17.0, 0.0, 16.0, 0.0, -7.0, 0.0, 0.0, 0.0, -158.0, 3.0, 0.0, 44.0, -2.0, -16.0, 0.0, -12.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -48.0, 0.0, -14.0, 0.0, 0.0, 0.0, -11.0, 55.0, 0.0, -12.0, -355.0, 8.0, -55.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, -10.0, -28.0, 0.0, -10.0, -336.0, -2.0, 6.0, -16.0, -308.0, 0.0, 1.0, 13.0, -16.0, 0.0, -10.0, 25.0, -9.0, 0.0, 0.0, -391.0, -82.0, -143.0, 0.0, 0.0, -4.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -30.0, -38.0, -46.0, 0.0, 0.0, 0.0, 2.0, -8.0, 13.0, 0.0, 0.0, 0.0, -83.0, 0.0, 0.0, 0.0, 0.0, -4.0, -16.0, -14.0, 0.0, 0.0, 0.0, 1.0, 0.0, 5.0, -201.0, -4.0, -14.0, -8.0, -10.0, -8.0], "policy_predator_policy_reward": [0.0, 9.0, 1.0, 3.0, 19.0, 24.0, 0.0, 128.0, 0.0, 84.0, 7.0, 0.0, 34.0, 32.0, 0.0, 0.0, 21.0, 21.0, 6.0, 3.0, 0.0, 8.0, 1.0, 7.0, 0.0, 0.0, 0.0, 0.0, 183.0, 24.0, 0.0, 10.0, 25.0, 13.0, 4.0, 0.0, 127.0, 1.0, 0.0, 5.0, 0.0, 9.0, 16.0, 17.0, 5.0, 7.0, 20.0, 17.0, 0.0, 0.0, 32.0, 133.0, 0.0, 0.0, 12.0, 9.0, 5.0, 5.0, 0.0, 0.0, 191.0, 73.0, 25.0, 44.0, 2.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 33.0, 33.0, 0.0, 0.0, 0.0, 6.0, 5.0, 26.0, 51.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 6.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 83.0, 2.0, 0.0, 0.0, 4.0, 6.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 32.0, 7.0, 6.0, 0.0, 0.0, 6.0, 8.0, 12.0, 6.0, 177.0, 185.0, 19.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 14.0, 33.0, 168.0, 2.0, 1.0, 27.0, 151.0, 0.0, 0.0, 8.0, 3.0, 0.0, 5.0, 7.0, 11.0, 0.0, 0.0, 197.0, 0.0, 45.0, 80.0, 2.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 26.0, 25.0, 25.0, 27.0, 0.0, 0.0, 0.0, 4.0, 0.0, 2.0, 0.0, 0.0, 58.0, 47.0, 0.0, 0.0, 0.0, 2.0, 8.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 37.0, 100.0, 8.0, 0.0, 5.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.82799921538069, "mean_inference_ms": 32.8424324629493, "mean_action_processing_ms": 3.4167202870660405, "mean_env_wait_ms": 4.8546836569681835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062444210052490234, "StateBufferConnector_ms": 0.005575895309448242, "ViewRequirementAgentConnector_ms": 0.17463815212249756}, "num_episodes": 18, "episode_return_max": 171.0, "episode_return_min": -276.0, "episode_return_mean": 3.55, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2032000, "num_agent_steps_trained": 2032000, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 2.0172661714864892, "num_env_steps_trained_throughput_per_sec": 2.0172661714864892, "timesteps_total": 508000, "num_env_steps_sampled_lifetime": 508000, "num_agent_steps_sampled_lifetime": 2032000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2032000, "timers": {"training_iteration_time_ms": 519208.172, "restore_workers_time_ms": 0.015, "training_step_time_ms": 519208.111, "sample_time_ms": 501217.257, "learn_time_ms": 17966.115, "learn_throughput": 222.641, "synch_weights_time_ms": 20.311}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 2032000, "num_agent_steps_trained": 2032000}, "done": false, "training_iteration": 127, "trial_id": "f6b99_00000", "date": "2024-08-13_22-24-17", "timestamp": 1723602257, "time_this_iter_s": 1982.9908571243286, "time_total_s": 9555.669196844101, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6219670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9555.669196844101, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 83.04545454545455, "ram_util_percent": 80.5060606060606}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6123676959957396, "cur_kl_coeff": 4.827976226806639e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1878431809957697, "policy_loss": -0.0022867968278843416, "vf_loss": 1.1901299767393283, "vf_explained_var": 0.028594805229277837, "kl": 0.0028739136396114333, "entropy": 0.11900541753207565, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 240975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3483795227275954, "cur_kl_coeff": 0.00013904571533203118, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7831345331002638, "policy_loss": -0.01622835878755838, "vf_loss": 0.7993623694099447, "vf_explained_var": -0.9936362814650964, "kl": 0.003767408058039054, "entropy": 0.17144982113882348, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 240975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 2048000, "num_agent_steps_trained": 2048000}, "env_runners": {"episode_reward_max": 171.0, "episode_reward_min": -276.0, "episode_reward_mean": -3.03, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -391.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 162.0, "predator_policy": 197.0}, "policy_reward_mean": {"prey_policy": -17.76, "predator_policy": 16.245}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.0, 0.0, -71.0, 0.0, 171.0, 141.0, 0.0, -119.0, 25.0, 164.0, 0.0, -6.0, 2.0, 155.0, 0.0, -6.0, 86.0, -43.0, 0.0, -1.0, -1.0, 23.0, 16.0, 0.0, 0.0, -70.0, 44.0, -8.0, -6.0, 7.0, 0.0, 0.0, 0.0, -12.0, -1.0, 0.0, 58.0, 6.0, 15.0, -21.0, 0.0, 0.0, 0.0, -18.0, -14.0, -145.0, 7.0, -146.0, 1.0, 8.0, -5.0, 34.0, 0.0, -276.0, -18.0, -2.0, 0.0, -5.0, 0.0, 0.0, 0.0, -17.0, 6.0, 0.0, -2.0, 15.0, 0.0, 22.0, 0.0, -2.0, -15.0, 0.0, 1.0, 5.0, -68.0, -14.0, -13.0, -84.0, 28.0, 0.0, 0.0, -22.0, -8.0, 3.0, -7.0, -63.0, -8.0, -13.0, 4.0, 13.0, 0.0, 0.0, -9.0, -4.0, 0.0, 18.0, -1.0, -36.0, -7.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -31.0, 0.0, 0.0, -230.0, -6.0, 0.0, 0.0, 156.0, -6.0, 131.0, 0.0, 0.0, 0.0, 0.0, -383.0, -44.0, 0.0, 0.0, 162.0, 0.0, 0.0, 0.0, -12.0, 0.0, 2.0, 77.0, 12.0, 0.0, 0.0, -12.0, 0.0, 0.0, 55.0, -94.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, -2.0, 17.0, 0.0, 16.0, 0.0, -7.0, 0.0, 0.0, 0.0, -158.0, 3.0, 0.0, 44.0, -2.0, -16.0, 0.0, -12.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -48.0, 0.0, -14.0, 0.0, 0.0, 0.0, -11.0, 55.0, 0.0, -12.0, -355.0, 8.0, -55.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, -10.0, -28.0, 0.0, -10.0, -336.0, -2.0, 6.0, -16.0, -308.0, 0.0, 1.0, 13.0, -16.0, 0.0, -10.0, 25.0, -9.0, 0.0, 0.0, -391.0, -82.0, -143.0, 0.0, 0.0, -4.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -30.0, -38.0, -46.0, 0.0, 0.0, 0.0, 2.0, -8.0, 13.0, 0.0, 0.0, 0.0, -83.0, 0.0, 0.0, 0.0, 0.0, -4.0, -16.0, -14.0, 0.0, 0.0, 0.0, 1.0, 0.0, 5.0, -201.0, -4.0, -14.0, -8.0, -10.0, -8.0, 0.0, -192.0, 0.0, -114.0, 0.0, 0.0, 0.0, 0.0, -142.0, 3.0, -16.0, 0.0, 7.0, -8.0, 0.0, -14.0, 0.0, -208.0, -101.0, -2.0, -27.0, 0.0, 4.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, -64.0, 0.0, -11.0, 0.0, 0.0, 9.0, 9.0, 0.0, -2.0, -88.0, -14.0, 0.0, -14.0, 0.0, 0.0], "policy_predator_policy_reward": [20.0, 17.0, 0.0, 0.0, 32.0, 133.0, 0.0, 0.0, 12.0, 9.0, 5.0, 5.0, 0.0, 0.0, 191.0, 73.0, 25.0, 44.0, 2.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 33.0, 33.0, 0.0, 0.0, 0.0, 6.0, 5.0, 26.0, 51.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 6.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 83.0, 2.0, 0.0, 0.0, 4.0, 6.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 32.0, 7.0, 6.0, 0.0, 0.0, 6.0, 8.0, 12.0, 6.0, 177.0, 185.0, 19.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 14.0, 33.0, 168.0, 2.0, 1.0, 27.0, 151.0, 0.0, 0.0, 8.0, 3.0, 0.0, 5.0, 7.0, 11.0, 0.0, 0.0, 197.0, 0.0, 45.0, 80.0, 2.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 26.0, 25.0, 25.0, 27.0, 0.0, 0.0, 0.0, 4.0, 0.0, 2.0, 0.0, 0.0, 58.0, 47.0, 0.0, 0.0, 0.0, 2.0, 8.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 37.0, 100.0, 8.0, 0.0, 5.0, 0.0, 5.0, 103.0, 70.0, 72.0, 0.0, 0.0, 0.0, 0.0, 74.0, 43.0, 0.0, 8.0, 4.0, 0.0, 0.0, 7.0, 50.0, 95.0, 13.0, 82.0, 9.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 23.0, 32.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 44.0, 22.0, 7.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.98939254417341, "mean_inference_ms": 45.62035941748805, "mean_action_processing_ms": 5.634823425297192, "mean_env_wait_ms": 6.322082961978831, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007706403732299805, "StateBufferConnector_ms": 0.005823850631713867, "ViewRequirementAgentConnector_ms": 0.18682372570037842}, "num_episodes": 23, "episode_return_max": 171.0, "episode_return_min": -276.0, "episode_return_mean": -3.03, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2048000, "num_agent_steps_trained": 2048000, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 238.15829312160093, "num_env_steps_trained_throughput_per_sec": 238.15829312160093, "timesteps_total": 512000, "num_env_steps_sampled_lifetime": 512000, "num_agent_steps_sampled_lifetime": 2048000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2048000, "timers": {"training_iteration_time_ms": 486046.162, "restore_workers_time_ms": 0.015, "training_step_time_ms": 486046.1, "sample_time_ms": 467911.203, "learn_time_ms": 18109.126, "learn_throughput": 220.883, "synch_weights_time_ms": 21.137}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 2048000, "num_agent_steps_trained": 2048000}, "done": false, "training_iteration": 128, "trial_id": "f6b99_00000", "date": "2024-08-13_22-24-34", "timestamp": 1723602274, "time_this_iter_s": 16.86334991455078, "time_total_s": 9572.532546758652, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6087f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9572.532546758652, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 73.45833333333333, "ram_util_percent": 83.88333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5131063434812757, "cur_kl_coeff": 2.4139881134033197e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2408817458089698, "policy_loss": -0.002718241635843047, "vf_loss": 1.2435999900417984, "vf_explained_var": 0.04169014518853849, "kl": 0.0027037772649915527, "entropy": 0.08932836411530694, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 242865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2947884040219444, "cur_kl_coeff": 6.952285766601559e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9623502697936067, "policy_loss": -0.012958086073575984, "vf_loss": 0.9753081191942174, "vf_explained_var": -0.9569580197649658, "kl": 0.0033719375308266103, "entropy": 0.18214637597717306, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 242865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000}, "env_runners": {"episode_reward_max": 58.0, "episode_reward_min": -276.0, "episode_reward_mean": -10.03, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -391.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 55.0, "predator_policy": 197.0}, "policy_reward_mean": {"prey_policy": -20.92, "predator_policy": 15.905}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.0, 0.0, 0.0, -70.0, 44.0, -8.0, -6.0, 7.0, 0.0, 0.0, 0.0, -12.0, -1.0, 0.0, 58.0, 6.0, 15.0, -21.0, 0.0, 0.0, 0.0, -18.0, -14.0, -145.0, 7.0, -146.0, 1.0, 8.0, -5.0, 34.0, 0.0, -276.0, -18.0, -2.0, 0.0, -5.0, 0.0, 0.0, 0.0, -17.0, 6.0, 0.0, -2.0, 15.0, 0.0, 22.0, 0.0, -2.0, -15.0, 0.0, 1.0, 5.0, -68.0, -14.0, -13.0, -84.0, 28.0, 0.0, 0.0, -22.0, -8.0, 3.0, -7.0, -63.0, -8.0, -13.0, 4.0, 13.0, 0.0, 0.0, -9.0, -4.0, 0.0, 18.0, -1.0, -36.0, -7.0, 0.0, 0.0, -11.0, 0.0, -2.0, -2.0, 0.0, 2.0, -11.0, 0.0, 0.0, -16.0, -4.0, 0.0, -153.0, 0.0, -2.0, -4.0, 5.0, 39.0, -9.0, 0.0, -6.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [16.0, 0.0, -7.0, 0.0, 0.0, 0.0, -158.0, 3.0, 0.0, 44.0, -2.0, -16.0, 0.0, -12.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -48.0, 0.0, -14.0, 0.0, 0.0, 0.0, -11.0, 55.0, 0.0, -12.0, -355.0, 8.0, -55.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, -10.0, -28.0, 0.0, -10.0, -336.0, -2.0, 6.0, -16.0, -308.0, 0.0, 1.0, 13.0, -16.0, 0.0, -10.0, 25.0, -9.0, 0.0, 0.0, -391.0, -82.0, -143.0, 0.0, 0.0, -4.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -30.0, -38.0, -46.0, 0.0, 0.0, 0.0, 2.0, -8.0, 13.0, 0.0, 0.0, 0.0, -83.0, 0.0, 0.0, 0.0, 0.0, -4.0, -16.0, -14.0, 0.0, 0.0, 0.0, 1.0, 0.0, 5.0, -201.0, -4.0, -14.0, -8.0, -10.0, -8.0, 0.0, -192.0, 0.0, -114.0, 0.0, 0.0, 0.0, 0.0, -142.0, 3.0, -16.0, 0.0, 7.0, -8.0, 0.0, -14.0, 0.0, -208.0, -101.0, -2.0, -27.0, 0.0, 4.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, -64.0, 0.0, -11.0, 0.0, 0.0, 9.0, 9.0, 0.0, -2.0, -88.0, -14.0, 0.0, -14.0, 0.0, 0.0, 0.0, 0.0, 0.0, -22.0, 0.0, 0.0, 0.0, -8.0, -4.0, 0.0, 0.0, 0.0, 3.0, -129.0, 0.0, -24.0, 0.0, 0.0, 0.0, 0.0, 0.0, -32.0, 0.0, -8.0, 0.0, 0.0, -182.0, -204.0, 0.0, 0.0, -8.0, -6.0, -9.0, 0.0, 12.0, -14.0, -89.0, 0.0, 0.0, -102.0, 0.0, 0.0, -6.0, -10.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 83.0, 2.0, 0.0, 0.0, 4.0, 6.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 32.0, 7.0, 6.0, 0.0, 0.0, 6.0, 8.0, 12.0, 6.0, 177.0, 185.0, 19.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 14.0, 33.0, 168.0, 2.0, 1.0, 27.0, 151.0, 0.0, 0.0, 8.0, 3.0, 0.0, 5.0, 7.0, 11.0, 0.0, 0.0, 197.0, 0.0, 45.0, 80.0, 2.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 26.0, 25.0, 25.0, 27.0, 0.0, 0.0, 0.0, 4.0, 0.0, 2.0, 0.0, 0.0, 58.0, 47.0, 0.0, 0.0, 0.0, 2.0, 8.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 37.0, 100.0, 8.0, 0.0, 5.0, 0.0, 5.0, 103.0, 70.0, 72.0, 0.0, 0.0, 0.0, 0.0, 74.0, 43.0, 0.0, 8.0, 4.0, 0.0, 0.0, 7.0, 50.0, 95.0, 13.0, 82.0, 9.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 23.0, 32.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 44.0, 22.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 2.0, 0.0, 0.0, 56.0, 72.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 4.0, 0.0, 0.0, 131.0, 102.0, 0.0, 0.0, 2.0, 10.0, 5.0, 0.0, 7.0, 0.0, 63.0, 65.0, 38.0, 55.0, 0.0, 0.0, 10.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.20906669806732, "mean_inference_ms": 56.5656406973969, "mean_action_processing_ms": 7.396296543848632, "mean_env_wait_ms": 8.133590820667497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007752537727355957, "StateBufferConnector_ms": 0.005780935287475586, "ViewRequirementAgentConnector_ms": 0.1856372356414795}, "num_episodes": 22, "episode_return_max": 58.0, "episode_return_min": -276.0, "episode_return_mean": -10.03, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 3.700891132427058, "num_env_steps_trained_throughput_per_sec": 3.700891132427058, "timesteps_total": 516000, "num_env_steps_sampled_lifetime": 516000, "num_agent_steps_sampled_lifetime": 2064000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2064000, "timers": {"training_iteration_time_ms": 592806.431, "restore_workers_time_ms": 0.016, "training_step_time_ms": 592806.367, "sample_time_ms": 467905.974, "learn_time_ms": 124871.264, "learn_throughput": 32.033, "synch_weights_time_ms": 24.802}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000}, "done": false, "training_iteration": 129, "trial_id": "f6b99_00000", "date": "2024-08-13_22-42-35", "timestamp": 1723603355, "time_this_iter_s": 1081.180990934372, "time_total_s": 10653.713537693024, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b30a95e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10653.713537693024, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 59.64545454545455, "ram_util_percent": 82.56818181818181}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3755094580549412, "cur_kl_coeff": 1.2069940567016598e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3564841257516669, "policy_loss": -0.0026949201804147196, "vf_loss": 1.3591790443690366, "vf_explained_var": 0.026246187295863237, "kl": 0.0017842620200742294, "entropy": 0.10244475093389314, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 244755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5977330374418113, "cur_kl_coeff": 3.4761428833007795e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.994884318338027, "policy_loss": -0.012429512658023409, "vf_loss": 1.0073136888878056, "vf_explained_var": -0.9153922846077611, "kl": 0.004145028378288863, "entropy": 0.18253026020432275, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 244755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000}, "env_runners": {"episode_reward_max": 39.0, "episode_reward_min": -276.0, "episode_reward_mean": -11.04, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -391.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 29.0, "predator_policy": 197.0}, "policy_reward_mean": {"prey_policy": -22.56, "predator_policy": 17.04}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, -18.0, -14.0, -145.0, 7.0, -146.0, 1.0, 8.0, -5.0, 34.0, 0.0, -276.0, -18.0, -2.0, 0.0, -5.0, 0.0, 0.0, 0.0, -17.0, 6.0, 0.0, -2.0, 15.0, 0.0, 22.0, 0.0, -2.0, -15.0, 0.0, 1.0, 5.0, -68.0, -14.0, -13.0, -84.0, 28.0, 0.0, 0.0, -22.0, -8.0, 3.0, -7.0, -63.0, -8.0, -13.0, 4.0, 13.0, 0.0, 0.0, -9.0, -4.0, 0.0, 18.0, -1.0, -36.0, -7.0, 0.0, 0.0, -11.0, 0.0, -2.0, -2.0, 0.0, 2.0, -11.0, 0.0, 0.0, -16.0, -4.0, 0.0, -153.0, 0.0, -2.0, -4.0, 5.0, 39.0, -9.0, 0.0, -6.0, -5.0, 0.0, -8.0, 0.0, 0.0, 17.0, 0.0, -4.0, 9.0, -13.0, 29.0, -9.0, -9.0, -17.0, -58.0, 0.0, -4.0, -1.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, -10.0, -28.0, 0.0, -10.0, -336.0, -2.0, 6.0, -16.0, -308.0, 0.0, 1.0, 13.0, -16.0, 0.0, -10.0, 25.0, -9.0, 0.0, 0.0, -391.0, -82.0, -143.0, 0.0, 0.0, -4.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -30.0, -38.0, -46.0, 0.0, 0.0, 0.0, 2.0, -8.0, 13.0, 0.0, 0.0, 0.0, -83.0, 0.0, 0.0, 0.0, 0.0, -4.0, -16.0, -14.0, 0.0, 0.0, 0.0, 1.0, 0.0, 5.0, -201.0, -4.0, -14.0, -8.0, -10.0, -8.0, 0.0, -192.0, 0.0, -114.0, 0.0, 0.0, 0.0, 0.0, -142.0, 3.0, -16.0, 0.0, 7.0, -8.0, 0.0, -14.0, 0.0, -208.0, -101.0, -2.0, -27.0, 0.0, 4.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, -64.0, 0.0, -11.0, 0.0, 0.0, 9.0, 9.0, 0.0, -2.0, -88.0, -14.0, 0.0, -14.0, 0.0, 0.0, 0.0, 0.0, 0.0, -22.0, 0.0, 0.0, 0.0, -8.0, -4.0, 0.0, 0.0, 0.0, 3.0, -129.0, 0.0, -24.0, 0.0, 0.0, 0.0, 0.0, 0.0, -32.0, 0.0, -8.0, 0.0, 0.0, -182.0, -204.0, 0.0, 0.0, -8.0, -6.0, -9.0, 0.0, 12.0, -14.0, -89.0, 0.0, 0.0, -102.0, 0.0, 0.0, -6.0, -10.0, -52.0, 0.0, 0.0, 0.0, -49.0, 0.0, 0.0, 0.0, 0.0, 0.0, -161.0, 0.0, 0.0, 0.0, -8.0, 0.0, -133.0, 0.0, -125.0, 0.0, 29.0, 0.0, -12.0, -10.0, -10.0, -4.0, 1.0, -158.0, -164.0, -16.0, 0.0, 0.0, 3.0, -14.0, -2.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 14.0, 33.0, 168.0, 2.0, 1.0, 27.0, 151.0, 0.0, 0.0, 8.0, 3.0, 0.0, 5.0, 7.0, 11.0, 0.0, 0.0, 197.0, 0.0, 45.0, 80.0, 2.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 26.0, 25.0, 25.0, 27.0, 0.0, 0.0, 0.0, 4.0, 0.0, 2.0, 0.0, 0.0, 58.0, 47.0, 0.0, 0.0, 0.0, 2.0, 8.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 37.0, 100.0, 8.0, 0.0, 5.0, 0.0, 5.0, 103.0, 70.0, 72.0, 0.0, 0.0, 0.0, 0.0, 74.0, 43.0, 0.0, 8.0, 4.0, 0.0, 0.0, 7.0, 50.0, 95.0, 13.0, 82.0, 9.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 23.0, 32.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 44.0, 22.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 2.0, 0.0, 0.0, 56.0, 72.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 4.0, 0.0, 0.0, 131.0, 102.0, 0.0, 0.0, 2.0, 10.0, 5.0, 0.0, 7.0, 0.0, 63.0, 65.0, 38.0, 55.0, 0.0, 0.0, 10.0, 0.0, 28.0, 19.0, 0.0, 0.0, 18.0, 23.0, 0.0, 0.0, 0.0, 0.0, 89.0, 89.0, 0.0, 0.0, 0.0, 4.0, 71.0, 71.0, 46.0, 66.0, 0.0, 0.0, 13.0, 0.0, 5.0, 0.0, 80.0, 60.0, 82.0, 40.0, 0.0, 0.0, 0.0, 7.0, 1.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.785456594417, "mean_inference_ms": 60.315419814409594, "mean_action_processing_ms": 8.382331519124396, "mean_env_wait_ms": 7.8921575958166885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007330656051635742, "StateBufferConnector_ms": 0.011484980583190918, "ViewRequirementAgentConnector_ms": 0.22563505172729492}, "num_episodes": 18, "episode_return_max": 39.0, "episode_return_min": -276.0, "episode_return_mean": -11.04, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 2.5347569214365584, "num_env_steps_trained_throughput_per_sec": 2.5347569214365584, "timesteps_total": 520000, "num_env_steps_sampled_lifetime": 520000, "num_agent_steps_sampled_lifetime": 2080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2080000, "timers": {"training_iteration_time_ms": 749228.406, "restore_workers_time_ms": 0.159, "training_step_time_ms": 749228.017, "sample_time_ms": 623130.515, "learn_time_ms": 126058.659, "learn_throughput": 31.731, "synch_weights_time_ms": 29.79}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000}, "done": false, "training_iteration": 130, "trial_id": "f6b99_00000", "date": "2024-08-13_23-08-54", "timestamp": 1723604934, "time_this_iter_s": 1579.2933781147003, "time_total_s": 12233.006915807724, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6219dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12233.006915807724, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 79.71704545454546, "ram_util_percent": 84.98181818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8093931111827414, "cur_kl_coeff": 6.034970283508299e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.31110808858795774, "policy_loss": -0.003153937600094766, "vf_loss": 0.3142620265933503, "vf_explained_var": 0.01821971551451103, "kl": 0.0064287187123727805, "entropy": 0.12318368029223864, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 246645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6637255934653459, "cur_kl_coeff": 1.7380714416503897e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6600950567406558, "policy_loss": -0.007405760727339872, "vf_loss": 0.6675007778145964, "vf_explained_var": -0.9461737678164528, "kl": 0.0023024063178136733, "entropy": 0.16083804600374407, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 246645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 2096000, "num_agent_steps_trained": 2096000}, "env_runners": {"episode_reward_max": 70.0, "episode_reward_min": -153.0, "episode_reward_mean": -5.06, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -208.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 34.0, "predator_policy": 131.0}, "policy_reward_mean": {"prey_policy": -17.095, "predator_policy": 14.565}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, -17.0, 6.0, 0.0, -2.0, 15.0, 0.0, 22.0, 0.0, -2.0, -15.0, 0.0, 1.0, 5.0, -68.0, -14.0, -13.0, -84.0, 28.0, 0.0, 0.0, -22.0, -8.0, 3.0, -7.0, -63.0, -8.0, -13.0, 4.0, 13.0, 0.0, 0.0, -9.0, -4.0, 0.0, 18.0, -1.0, -36.0, -7.0, 0.0, 0.0, -11.0, 0.0, -2.0, -2.0, 0.0, 2.0, -11.0, 0.0, 0.0, -16.0, -4.0, 0.0, -153.0, 0.0, -2.0, -4.0, 5.0, 39.0, -9.0, 0.0, -6.0, -5.0, 0.0, -8.0, 0.0, 0.0, 17.0, 0.0, -4.0, 9.0, -13.0, 29.0, -9.0, -9.0, -17.0, -58.0, 0.0, -4.0, -1.0, -27.0, 0.0, 12.0, -10.0, 7.0, 0.0, 70.0, 16.0, 0.0, 0.0, 6.0, -21.0, 0.0, -2.0, 16.0, -61.0, 13.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -30.0, -38.0, -46.0, 0.0, 0.0, 0.0, 2.0, -8.0, 13.0, 0.0, 0.0, 0.0, -83.0, 0.0, 0.0, 0.0, 0.0, -4.0, -16.0, -14.0, 0.0, 0.0, 0.0, 1.0, 0.0, 5.0, -201.0, -4.0, -14.0, -8.0, -10.0, -8.0, 0.0, -192.0, 0.0, -114.0, 0.0, 0.0, 0.0, 0.0, -142.0, 3.0, -16.0, 0.0, 7.0, -8.0, 0.0, -14.0, 0.0, -208.0, -101.0, -2.0, -27.0, 0.0, 4.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, -64.0, 0.0, -11.0, 0.0, 0.0, 9.0, 9.0, 0.0, -2.0, -88.0, -14.0, 0.0, -14.0, 0.0, 0.0, 0.0, 0.0, 0.0, -22.0, 0.0, 0.0, 0.0, -8.0, -4.0, 0.0, 0.0, 0.0, 3.0, -129.0, 0.0, -24.0, 0.0, 0.0, 0.0, 0.0, 0.0, -32.0, 0.0, -8.0, 0.0, 0.0, -182.0, -204.0, 0.0, 0.0, -8.0, -6.0, -9.0, 0.0, 12.0, -14.0, -89.0, 0.0, 0.0, -102.0, 0.0, 0.0, -6.0, -10.0, -52.0, 0.0, 0.0, 0.0, -49.0, 0.0, 0.0, 0.0, 0.0, 0.0, -161.0, 0.0, 0.0, 0.0, -8.0, 0.0, -133.0, 0.0, -125.0, 0.0, 29.0, 0.0, -12.0, -10.0, -10.0, -4.0, 1.0, -158.0, -164.0, -16.0, 0.0, 0.0, 3.0, -14.0, -2.0, 0.0, -20.0, -17.0, 0.0, 0.0, 0.0, 11.0, -19.0, -6.0, 0.0, 4.0, 0.0, 0.0, 34.0, 14.0, 23.0, -18.0, 0.0, 0.0, 0.0, 0.0, 0.0, -96.0, -14.0, -34.0, 0.0, 0.0, 0.0, -4.0, 0.0, 16.0, -128.0, 3.0, -6.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 26.0, 25.0, 25.0, 27.0, 0.0, 0.0, 0.0, 4.0, 0.0, 2.0, 0.0, 0.0, 58.0, 47.0, 0.0, 0.0, 0.0, 2.0, 8.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 37.0, 100.0, 8.0, 0.0, 5.0, 0.0, 5.0, 103.0, 70.0, 72.0, 0.0, 0.0, 0.0, 0.0, 74.0, 43.0, 0.0, 8.0, 4.0, 0.0, 0.0, 7.0, 50.0, 95.0, 13.0, 82.0, 9.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 23.0, 32.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 44.0, 22.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 2.0, 0.0, 0.0, 56.0, 72.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 4.0, 0.0, 0.0, 131.0, 102.0, 0.0, 0.0, 2.0, 10.0, 5.0, 0.0, 7.0, 0.0, 63.0, 65.0, 38.0, 55.0, 0.0, 0.0, 10.0, 0.0, 28.0, 19.0, 0.0, 0.0, 18.0, 23.0, 0.0, 0.0, 0.0, 0.0, 89.0, 89.0, 0.0, 0.0, 0.0, 4.0, 71.0, 71.0, 46.0, 66.0, 0.0, 0.0, 13.0, 0.0, 5.0, 0.0, 80.0, 60.0, 82.0, 40.0, 0.0, 0.0, 0.0, 7.0, 1.0, 0.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 15.0, 0.0, 3.0, 0.0, 0.0, 0.0, 9.0, 13.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 50.0, 52.0, 13.0, 14.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 64.0, 0.0, 8.0, 11.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.59250960191604, "mean_inference_ms": 63.742533429098906, "mean_action_processing_ms": 9.36492523858558, "mean_env_wait_ms": 8.19540536281738, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007318854331970215, "StateBufferConnector_ms": 0.01148676872253418, "ViewRequirementAgentConnector_ms": 0.22144687175750732}, "num_episodes": 18, "episode_return_max": 70.0, "episode_return_min": -153.0, "episode_return_mean": -5.06, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2096000, "num_agent_steps_trained": 2096000, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 197.80330217496888, "num_env_steps_trained_throughput_per_sec": 197.80330217496888, "timesteps_total": 524000, "num_env_steps_sampled_lifetime": 524000, "num_agent_steps_sampled_lifetime": 2096000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2096000, "timers": {"training_iteration_time_ms": 744567.218, "restore_workers_time_ms": 0.162, "training_step_time_ms": 744566.808, "sample_time_ms": 623344.776, "learn_time_ms": 121182.6, "learn_throughput": 33.008, "synch_weights_time_ms": 30.162}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 2096000, "num_agent_steps_trained": 2096000}, "done": false, "training_iteration": 131, "trial_id": "f6b99_00000", "date": "2024-08-13_23-09-15", "timestamp": 1723604955, "time_this_iter_s": 20.31775689125061, "time_total_s": 12253.324672698975, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b623d940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12253.324672698975, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 74.02333333333333, "ram_util_percent": 83.97666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.517064315908485, "cur_kl_coeff": 6.034970283508299e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.797319305321527, "policy_loss": -0.002666675873968021, "vf_loss": 0.7999859803489276, "vf_explained_var": 0.024289849983952033, "kl": 0.003162756555560144, "entropy": 0.13400116899104977, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 248535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2889049404828006, "cur_kl_coeff": 8.690357208251949e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9459360183842441, "policy_loss": -0.012328932385105719, "vf_loss": 0.9582648917323067, "vf_explained_var": -0.6618068966285261, "kl": 0.006038452840190054, "entropy": 0.20045708016980263, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 248535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000}, "env_runners": {"episode_reward_max": 70.0, "episode_reward_min": -153.0, "episode_reward_mean": -4.95, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -208.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 34.0, "predator_policy": 131.0}, "policy_reward_mean": {"prey_policy": -15.63, "predator_policy": 13.155}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-22.0, -8.0, 3.0, -7.0, -63.0, -8.0, -13.0, 4.0, 13.0, 0.0, 0.0, -9.0, -4.0, 0.0, 18.0, -1.0, -36.0, -7.0, 0.0, 0.0, -11.0, 0.0, -2.0, -2.0, 0.0, 2.0, -11.0, 0.0, 0.0, -16.0, -4.0, 0.0, -153.0, 0.0, -2.0, -4.0, 5.0, 39.0, -9.0, 0.0, -6.0, -5.0, 0.0, -8.0, 0.0, 0.0, 17.0, 0.0, -4.0, 9.0, -13.0, 29.0, -9.0, -9.0, -17.0, -58.0, 0.0, -4.0, -1.0, -27.0, 0.0, 12.0, -10.0, 7.0, 0.0, 70.0, 16.0, 0.0, 0.0, 6.0, -21.0, 0.0, -2.0, 16.0, -61.0, 13.0, 0.0, 8.0, 1.0, 0.0, 5.0, -6.0, 4.0, 0.0, 0.0, -9.0, 0.0, -30.0, -3.0, 0.0, -10.0, -18.0, -7.0, 0.0, 3.0, 4.0, -22.0, 4.0, -4.0, -47.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-142.0, 3.0, -16.0, 0.0, 7.0, -8.0, 0.0, -14.0, 0.0, -208.0, -101.0, -2.0, -27.0, 0.0, 4.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, -64.0, 0.0, -11.0, 0.0, 0.0, 9.0, 9.0, 0.0, -2.0, -88.0, -14.0, 0.0, -14.0, 0.0, 0.0, 0.0, 0.0, 0.0, -22.0, 0.0, 0.0, 0.0, -8.0, -4.0, 0.0, 0.0, 0.0, 3.0, -129.0, 0.0, -24.0, 0.0, 0.0, 0.0, 0.0, 0.0, -32.0, 0.0, -8.0, 0.0, 0.0, -182.0, -204.0, 0.0, 0.0, -8.0, -6.0, -9.0, 0.0, 12.0, -14.0, -89.0, 0.0, 0.0, -102.0, 0.0, 0.0, -6.0, -10.0, -52.0, 0.0, 0.0, 0.0, -49.0, 0.0, 0.0, 0.0, 0.0, 0.0, -161.0, 0.0, 0.0, 0.0, -8.0, 0.0, -133.0, 0.0, -125.0, 0.0, 29.0, 0.0, -12.0, -10.0, -10.0, -4.0, 1.0, -158.0, -164.0, -16.0, 0.0, 0.0, 3.0, -14.0, -2.0, 0.0, -20.0, -17.0, 0.0, 0.0, 0.0, 11.0, -19.0, -6.0, 0.0, 4.0, 0.0, 0.0, 34.0, 14.0, 23.0, -18.0, 0.0, 0.0, 0.0, 0.0, 0.0, -96.0, -14.0, -34.0, 0.0, 0.0, 0.0, -4.0, 0.0, 16.0, -128.0, 3.0, -6.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 0.0, -80.0, 2.0, -12.0, 0.0, 4.0, -28.0, 0.0, 0.0, 0.0, 0.0, -18.0, 0.0, 0.0, 0.0, 0.0, -73.0, -9.0, 0.0, 0.0, 0.0, -14.0, -6.0, -74.0, -16.0, -2.0, -12.0, -4.0, 0.0, 3.0, 0.0, 4.0, 0.0, 0.0, -46.0, 0.0, 4.0, -8.0, 0.0, -12.0, -82.0], "policy_predator_policy_reward": [74.0, 43.0, 0.0, 8.0, 4.0, 0.0, 0.0, 7.0, 50.0, 95.0, 13.0, 82.0, 9.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 23.0, 32.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 44.0, 22.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 2.0, 0.0, 0.0, 56.0, 72.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 4.0, 0.0, 0.0, 131.0, 102.0, 0.0, 0.0, 2.0, 10.0, 5.0, 0.0, 7.0, 0.0, 63.0, 65.0, 38.0, 55.0, 0.0, 0.0, 10.0, 0.0, 28.0, 19.0, 0.0, 0.0, 18.0, 23.0, 0.0, 0.0, 0.0, 0.0, 89.0, 89.0, 0.0, 0.0, 0.0, 4.0, 71.0, 71.0, 46.0, 66.0, 0.0, 0.0, 13.0, 0.0, 5.0, 0.0, 80.0, 60.0, 82.0, 40.0, 0.0, 0.0, 0.0, 7.0, 1.0, 0.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 15.0, 0.0, 3.0, 0.0, 0.0, 0.0, 9.0, 13.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 50.0, 52.0, 13.0, 14.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 64.0, 0.0, 8.0, 11.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 0.0, 29.0, 54.0, 6.0, 0.0, 14.0, 14.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 43.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 10.0, 37.0, 35.0, 6.0, 1.0, 2.0, 2.0, 0.0, 0.0, 0.0, 0.0, 24.0, 0.0, 0.0, 0.0, 4.0, 0.0, 47.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 37.17986133708292, "mean_inference_ms": 63.3003581005665, "mean_action_processing_ms": 9.912337261291752, "mean_env_wait_ms": 8.31481860372902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007907509803771973, "StateBufferConnector_ms": 0.012604236602783203, "ViewRequirementAgentConnector_ms": 0.17091751098632812}, "num_episodes": 23, "episode_return_max": 70.0, "episode_return_min": -153.0, "episode_return_mean": -4.95, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.3561887179212, "num_env_steps_trained_throughput_per_sec": 269.3561887179212, "timesteps_total": 528000, "num_env_steps_sampled_lifetime": 528000, "num_agent_steps_sampled_lifetime": 2112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2112000, "timers": {"training_iteration_time_ms": 744737.684, "restore_workers_time_ms": 0.162, "training_step_time_ms": 744737.274, "sample_time_ms": 623390.915, "learn_time_ms": 121307.741, "learn_throughput": 32.974, "synch_weights_time_ms": 29.785}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000}, "done": false, "training_iteration": 132, "trial_id": "f6b99_00000", "date": "2024-08-13_23-09-30", "timestamp": 1723604970, "time_this_iter_s": 14.893978118896484, "time_total_s": 12268.218650817871, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6d1eb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12268.218650817871, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 64.17619047619048, "ram_util_percent": 83.3809523809524}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9009786546545685, "cur_kl_coeff": 3.0174851417541496e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.752214622513327, "policy_loss": -0.00241106537628978, "vf_loss": 0.7546256859703039, "vf_explained_var": 0.027554391017035832, "kl": 0.003948510606909322, "entropy": 0.20345826635442713, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 250425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5815030950047666, "cur_kl_coeff": 8.690357208251949e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6150992641213138, "policy_loss": -0.01450863411174545, "vf_loss": 0.6296078492237794, "vf_explained_var": -0.4811992329579812, "kl": 0.005154609311197284, "entropy": 0.151748775430615, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 250425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 2128000, "num_agent_steps_trained": 2128000}, "env_runners": {"episode_reward_max": 70.0, "episode_reward_min": -153.0, "episode_reward_mean": -3.32, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -251.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 45.0, "predator_policy": 131.0}, "policy_reward_mean": {"prey_policy": -13.825, "predator_policy": 12.165}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, -11.0, 0.0, -2.0, -2.0, 0.0, 2.0, -11.0, 0.0, 0.0, -16.0, -4.0, 0.0, -153.0, 0.0, -2.0, -4.0, 5.0, 39.0, -9.0, 0.0, -6.0, -5.0, 0.0, -8.0, 0.0, 0.0, 17.0, 0.0, -4.0, 9.0, -13.0, 29.0, -9.0, -9.0, -17.0, -58.0, 0.0, -4.0, -1.0, -27.0, 0.0, 12.0, -10.0, 7.0, 0.0, 70.0, 16.0, 0.0, 0.0, 6.0, -21.0, 0.0, -2.0, 16.0, -61.0, 13.0, 0.0, 8.0, 1.0, 0.0, 5.0, -6.0, 4.0, 0.0, 0.0, -9.0, 0.0, -30.0, -3.0, 0.0, -10.0, -18.0, -7.0, 0.0, 3.0, 4.0, -22.0, 4.0, -4.0, -47.0, 15.0, -106.0, 46.0, -3.0, 3.0, -3.0, -4.0, 5.0, 11.0, 12.0, -5.0, 9.0, -1.0, -5.0, -11.0, 14.0, 37.0, 9.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, -22.0, 0.0, 0.0, 0.0, -8.0, -4.0, 0.0, 0.0, 0.0, 3.0, -129.0, 0.0, -24.0, 0.0, 0.0, 0.0, 0.0, 0.0, -32.0, 0.0, -8.0, 0.0, 0.0, -182.0, -204.0, 0.0, 0.0, -8.0, -6.0, -9.0, 0.0, 12.0, -14.0, -89.0, 0.0, 0.0, -102.0, 0.0, 0.0, -6.0, -10.0, -52.0, 0.0, 0.0, 0.0, -49.0, 0.0, 0.0, 0.0, 0.0, 0.0, -161.0, 0.0, 0.0, 0.0, -8.0, 0.0, -133.0, 0.0, -125.0, 0.0, 29.0, 0.0, -12.0, -10.0, -10.0, -4.0, 1.0, -158.0, -164.0, -16.0, 0.0, 0.0, 3.0, -14.0, -2.0, 0.0, -20.0, -17.0, 0.0, 0.0, 0.0, 11.0, -19.0, -6.0, 0.0, 4.0, 0.0, 0.0, 34.0, 14.0, 23.0, -18.0, 0.0, 0.0, 0.0, 0.0, 0.0, -96.0, -14.0, -34.0, 0.0, 0.0, 0.0, -4.0, 0.0, 16.0, -128.0, 3.0, -6.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 0.0, -80.0, 2.0, -12.0, 0.0, 4.0, -28.0, 0.0, 0.0, 0.0, 0.0, -18.0, 0.0, 0.0, 0.0, 0.0, -73.0, -9.0, 0.0, 0.0, 0.0, -14.0, -6.0, -74.0, -16.0, -2.0, -12.0, -4.0, 0.0, 3.0, 0.0, 4.0, 0.0, 0.0, -46.0, 0.0, 4.0, -8.0, 0.0, -12.0, -82.0, 10.0, 5.0, -20.0, -251.0, 45.0, 0.0, 0.0, -6.0, -84.0, 0.0, -6.0, 0.0, 0.0, -18.0, 5.0, -2.0, 11.0, 0.0, 12.0, 0.0, 0.0, -10.0, -11.0, 5.0, 0.0, -2.0, -12.0, 0.0, -22.0, 0.0, 0.0, 11.0, 0.0, 26.0, 9.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 2.0, 0.0, 0.0, 56.0, 72.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 4.0, 0.0, 0.0, 131.0, 102.0, 0.0, 0.0, 2.0, 10.0, 5.0, 0.0, 7.0, 0.0, 63.0, 65.0, 38.0, 55.0, 0.0, 0.0, 10.0, 0.0, 28.0, 19.0, 0.0, 0.0, 18.0, 23.0, 0.0, 0.0, 0.0, 0.0, 89.0, 89.0, 0.0, 0.0, 0.0, 4.0, 71.0, 71.0, 46.0, 66.0, 0.0, 0.0, 13.0, 0.0, 5.0, 0.0, 80.0, 60.0, 82.0, 40.0, 0.0, 0.0, 0.0, 7.0, 1.0, 0.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 15.0, 0.0, 3.0, 0.0, 0.0, 0.0, 9.0, 13.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 50.0, 52.0, 13.0, 14.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 64.0, 0.0, 8.0, 11.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 0.0, 29.0, 54.0, 6.0, 0.0, 14.0, 14.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 43.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 10.0, 37.0, 35.0, 6.0, 1.0, 2.0, 2.0, 0.0, 0.0, 0.0, 0.0, 24.0, 0.0, 0.0, 0.0, 4.0, 0.0, 47.0, 0.0, 0.0, 0.0, 115.0, 50.0, 1.0, 0.0, 0.0, 3.0, 31.0, 56.0, 3.0, 0.0, 7.0, 7.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 7.0, 8.0, 0.0, 1.0, 0.0, 7.0, 6.0, 5.0, 3.0, 0.0, 0.0, 11.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.91920945389445, "mean_inference_ms": 63.87011468968029, "mean_action_processing_ms": 9.391911897407711, "mean_env_wait_ms": 8.082745868348665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006737232208251953, "StateBufferConnector_ms": 0.011179447174072266, "ViewRequirementAgentConnector_ms": 0.16320061683654785}, "num_episodes": 18, "episode_return_max": 70.0, "episode_return_min": -153.0, "episode_return_mean": -3.32, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2128000, "num_agent_steps_trained": 2128000, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.82922236314624, "num_env_steps_trained_throughput_per_sec": 290.82922236314624, "timesteps_total": 532000, "num_env_steps_sampled_lifetime": 532000, "num_agent_steps_sampled_lifetime": 2128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2128000, "timers": {"training_iteration_time_ms": 744784.712, "restore_workers_time_ms": 0.162, "training_step_time_ms": 744784.302, "sample_time_ms": 623405.68, "learn_time_ms": 121340.3, "learn_throughput": 32.965, "synch_weights_time_ms": 29.451}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 2128000, "num_agent_steps_trained": 2128000}, "done": false, "training_iteration": 133, "trial_id": "f6b99_00000", "date": "2024-08-13_23-09-44", "timestamp": 1723604984, "time_this_iter_s": 13.78845500946045, "time_total_s": 12282.007105827332, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b60bac10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12282.007105827332, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 56.525, "ram_util_percent": 83.58000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9473784571523389, "cur_kl_coeff": 1.5087425708770748e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.35097402171798486, "policy_loss": -0.0039918736810919155, "vf_loss": 0.3549658945704953, "vf_explained_var": 0.08811947066317159, "kl": 0.037772168780052975, "entropy": 0.23944308497602979, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 252315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6697481983080111, "cur_kl_coeff": 8.690357208251949e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5150078405106253, "policy_loss": -0.009749643831321644, "vf_loss": 0.5247574807080643, "vf_explained_var": -0.575319837830054, "kl": 0.0013889740966348126, "entropy": 0.13556263518159983, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 252315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 2144000, "num_agent_steps_trained": 2144000}, "env_runners": {"episode_reward_max": 70.0, "episode_reward_min": -166.0, "episode_reward_mean": -3.37, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -251.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 45.0, "predator_policy": 115.0}, "policy_reward_mean": {"prey_policy": -11.61, "predator_policy": 9.925}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.0, -5.0, 0.0, -8.0, 0.0, 0.0, 17.0, 0.0, -4.0, 9.0, -13.0, 29.0, -9.0, -9.0, -17.0, -58.0, 0.0, -4.0, -1.0, -27.0, 0.0, 12.0, -10.0, 7.0, 0.0, 70.0, 16.0, 0.0, 0.0, 6.0, -21.0, 0.0, -2.0, 16.0, -61.0, 13.0, 0.0, 8.0, 1.0, 0.0, 5.0, -6.0, 4.0, 0.0, 0.0, -9.0, 0.0, -30.0, -3.0, 0.0, -10.0, -18.0, -7.0, 0.0, 3.0, 4.0, -22.0, 4.0, -4.0, -47.0, 15.0, -106.0, 46.0, -3.0, 3.0, -3.0, -4.0, 5.0, 11.0, 12.0, -5.0, 9.0, -1.0, -5.0, -11.0, 14.0, 37.0, 9.0, 0.0, -17.0, -2.0, 0.0, 0.0, 0.0, -7.0, -2.0, 0.0, 0.0, 16.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 7.0, -6.0, 4.0, -166.0, -4.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.0, -10.0, -52.0, 0.0, 0.0, 0.0, -49.0, 0.0, 0.0, 0.0, 0.0, 0.0, -161.0, 0.0, 0.0, 0.0, -8.0, 0.0, -133.0, 0.0, -125.0, 0.0, 29.0, 0.0, -12.0, -10.0, -10.0, -4.0, 1.0, -158.0, -164.0, -16.0, 0.0, 0.0, 3.0, -14.0, -2.0, 0.0, -20.0, -17.0, 0.0, 0.0, 0.0, 11.0, -19.0, -6.0, 0.0, 4.0, 0.0, 0.0, 34.0, 14.0, 23.0, -18.0, 0.0, 0.0, 0.0, 0.0, 0.0, -96.0, -14.0, -34.0, 0.0, 0.0, 0.0, -4.0, 0.0, 16.0, -128.0, 3.0, -6.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 0.0, -80.0, 2.0, -12.0, 0.0, 4.0, -28.0, 0.0, 0.0, 0.0, 0.0, -18.0, 0.0, 0.0, 0.0, 0.0, -73.0, -9.0, 0.0, 0.0, 0.0, -14.0, -6.0, -74.0, -16.0, -2.0, -12.0, -4.0, 0.0, 3.0, 0.0, 4.0, 0.0, 0.0, -46.0, 0.0, 4.0, -8.0, 0.0, -12.0, -82.0, 10.0, 5.0, -20.0, -251.0, 45.0, 0.0, 0.0, -6.0, -84.0, 0.0, -6.0, 0.0, 0.0, -18.0, 5.0, -2.0, 11.0, 0.0, 12.0, 0.0, 0.0, -10.0, -11.0, 5.0, 0.0, -2.0, -12.0, 0.0, -22.0, 0.0, 0.0, 11.0, 0.0, 26.0, 9.0, 0.0, 0.0, 0.0, 0.0, -35.0, 0.0, -26.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, -4.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -28.0, 0.0, -12.0, 0.0, 3.0, 1.0, -134.0, -142.0, -16.0, 4.0], "policy_predator_policy_reward": [10.0, 0.0, 28.0, 19.0, 0.0, 0.0, 18.0, 23.0, 0.0, 0.0, 0.0, 0.0, 89.0, 89.0, 0.0, 0.0, 0.0, 4.0, 71.0, 71.0, 46.0, 66.0, 0.0, 0.0, 13.0, 0.0, 5.0, 0.0, 80.0, 60.0, 82.0, 40.0, 0.0, 0.0, 0.0, 7.0, 1.0, 0.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 15.0, 0.0, 3.0, 0.0, 0.0, 0.0, 9.0, 13.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 50.0, 52.0, 13.0, 14.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 64.0, 0.0, 8.0, 11.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 0.0, 29.0, 54.0, 6.0, 0.0, 14.0, 14.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 43.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 10.0, 37.0, 35.0, 6.0, 1.0, 2.0, 2.0, 0.0, 0.0, 0.0, 0.0, 24.0, 0.0, 0.0, 0.0, 4.0, 0.0, 47.0, 0.0, 0.0, 0.0, 115.0, 50.0, 1.0, 0.0, 0.0, 3.0, 31.0, 56.0, 3.0, 0.0, 7.0, 7.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 7.0, 8.0, 0.0, 1.0, 0.0, 7.0, 6.0, 5.0, 3.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 11.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.0, 14.0, 0.0, 6.0, 0.0, 0.0, 25.0, 85.0, 0.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.97815816645559, "mean_inference_ms": 63.716211668360195, "mean_action_processing_ms": 9.32338323679615, "mean_env_wait_ms": 8.010626514074895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01186525821685791, "StateBufferConnector_ms": 0.011272549629211426, "ViewRequirementAgentConnector_ms": 0.1667860746383667}, "num_episodes": 22, "episode_return_max": 70.0, "episode_return_min": -166.0, "episode_return_mean": -3.37, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2144000, "num_agent_steps_trained": 2144000, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 278.0916939570775, "num_env_steps_trained_throughput_per_sec": 278.0916939570775, "timesteps_total": 536000, "num_env_steps_sampled_lifetime": 536000, "num_agent_steps_sampled_lifetime": 2144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2144000, "timers": {"training_iteration_time_ms": 744866.007, "restore_workers_time_ms": 0.164, "training_step_time_ms": 744865.593, "sample_time_ms": 623485.4, "learn_time_ms": 121341.505, "learn_throughput": 32.965, "synch_weights_time_ms": 29.73}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 2144000, "num_agent_steps_trained": 2144000}, "done": false, "training_iteration": 134, "trial_id": "f6b99_00000", "date": "2024-08-13_23-09-58", "timestamp": 1723604998, "time_this_iter_s": 14.416792154312134, "time_total_s": 12296.423897981644, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b60bae50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12296.423897981644, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 58.455000000000005, "ram_util_percent": 83.83000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2106672453777816, "cur_kl_coeff": 2.2631138563156135e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2368218153281502, "policy_loss": -0.005512097539631502, "vf_loss": 0.24233391238425775, "vf_explained_var": 0.0878043166228703, "kl": 0.0050115225053464175, "entropy": 0.21172603475984442, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 254205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7614700582055818, "cur_kl_coeff": 4.345178604125974e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4155904101641484, "policy_loss": -0.015813905622184318, "vf_loss": 0.43140431128925194, "vf_explained_var": -0.4115950828191465, "kl": 0.0024412023522807236, "entropy": 0.1444374722975587, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 254205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "env_runners": {"episode_reward_max": 72.0, "episode_reward_min": -166.0, "episode_reward_mean": -0.83, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -251.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 72.0, "predator_policy": 115.0}, "policy_reward_mean": {"prey_policy": -6.93, "predator_policy": 6.515}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -27.0, 0.0, 12.0, -10.0, 7.0, 0.0, 70.0, 16.0, 0.0, 0.0, 6.0, -21.0, 0.0, -2.0, 16.0, -61.0, 13.0, 0.0, 8.0, 1.0, 0.0, 5.0, -6.0, 4.0, 0.0, 0.0, -9.0, 0.0, -30.0, -3.0, 0.0, -10.0, -18.0, -7.0, 0.0, 3.0, 4.0, -22.0, 4.0, -4.0, -47.0, 15.0, -106.0, 46.0, -3.0, 3.0, -3.0, -4.0, 5.0, 11.0, 12.0, -5.0, 9.0, -1.0, -5.0, -11.0, 14.0, 37.0, 9.0, 0.0, -17.0, -2.0, 0.0, 0.0, 0.0, -7.0, -2.0, 0.0, 0.0, 16.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 7.0, -6.0, 4.0, -166.0, -4.0, -5.0, 17.0, 0.0, 0.0, 72.0, 2.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 16.0, 16.0, 0.0, 0.0, 1.0, 52.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.0, 0.0, -20.0, -17.0, 0.0, 0.0, 0.0, 11.0, -19.0, -6.0, 0.0, 4.0, 0.0, 0.0, 34.0, 14.0, 23.0, -18.0, 0.0, 0.0, 0.0, 0.0, 0.0, -96.0, -14.0, -34.0, 0.0, 0.0, 0.0, -4.0, 0.0, 16.0, -128.0, 3.0, -6.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 0.0, -80.0, 2.0, -12.0, 0.0, 4.0, -28.0, 0.0, 0.0, 0.0, 0.0, -18.0, 0.0, 0.0, 0.0, 0.0, -73.0, -9.0, 0.0, 0.0, 0.0, -14.0, -6.0, -74.0, -16.0, -2.0, -12.0, -4.0, 0.0, 3.0, 0.0, 4.0, 0.0, 0.0, -46.0, 0.0, 4.0, -8.0, 0.0, -12.0, -82.0, 10.0, 5.0, -20.0, -251.0, 45.0, 0.0, 0.0, -6.0, -84.0, 0.0, -6.0, 0.0, 0.0, -18.0, 5.0, -2.0, 11.0, 0.0, 12.0, 0.0, 0.0, -10.0, -11.0, 5.0, 0.0, -2.0, -12.0, 0.0, -22.0, 0.0, 0.0, 11.0, 0.0, 26.0, 9.0, 0.0, 0.0, 0.0, 0.0, -35.0, 0.0, -26.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, -4.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -28.0, 0.0, -12.0, 0.0, 3.0, 1.0, -134.0, -142.0, -16.0, 4.0, -9.0, -6.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, -17.0, 72.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, 5.0, 0.0, -4.0, 2.0, -35.0, 16.0, -4.0, -7.0, 0.0, 0.0, 0.0, 0.0, -27.0, -8.0, 0.0, 52.0], "policy_predator_policy_reward": [1.0, 0.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 15.0, 0.0, 3.0, 0.0, 0.0, 0.0, 9.0, 13.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 50.0, 52.0, 13.0, 14.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 64.0, 0.0, 8.0, 11.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 0.0, 29.0, 54.0, 6.0, 0.0, 14.0, 14.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 43.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 10.0, 37.0, 35.0, 6.0, 1.0, 2.0, 2.0, 0.0, 0.0, 0.0, 0.0, 24.0, 0.0, 0.0, 0.0, 4.0, 0.0, 47.0, 0.0, 0.0, 0.0, 115.0, 50.0, 1.0, 0.0, 0.0, 3.0, 31.0, 56.0, 3.0, 0.0, 7.0, 7.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 7.0, 8.0, 0.0, 1.0, 0.0, 7.0, 6.0, 5.0, 3.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 11.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.0, 14.0, 0.0, 6.0, 0.0, 0.0, 25.0, 85.0, 0.0, 8.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 6.0, 0.0, 0.0, 0.0, 2.0, 17.0, 18.0, 0.0, 27.0, 0.0, 0.0, 0.0, 0.0, 13.0, 23.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.73156187801229, "mean_inference_ms": 63.47579091851279, "mean_action_processing_ms": 9.261873431344979, "mean_env_wait_ms": 7.958236367455336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011228442192077637, "StateBufferConnector_ms": 0.010847091674804688, "ViewRequirementAgentConnector_ms": 0.14671754837036133}, "num_episodes": 18, "episode_return_max": 72.0, "episode_return_min": -166.0, "episode_return_mean": -0.83, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 285.8864107841571, "num_env_steps_trained_throughput_per_sec": 285.8864107841571, "timesteps_total": 540000, "num_env_steps_sampled_lifetime": 540000, "num_agent_steps_sampled_lifetime": 2160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2160000, "timers": {"training_iteration_time_ms": 475398.53, "restore_workers_time_ms": 0.164, "training_step_time_ms": 475398.115, "sample_time_ms": 354344.847, "learn_time_ms": 121014.34, "learn_throughput": 33.054, "synch_weights_time_ms": 30.137}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "done": false, "training_iteration": 135, "trial_id": "f6b99_00000", "date": "2024-08-13_23-10-12", "timestamp": 1723605012, "time_this_iter_s": 14.051060914993286, "time_total_s": 12310.474958896637, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6d1eb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12310.474958896637, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 53.1, "ram_util_percent": 83.785}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7818724918460089, "cur_kl_coeff": 2.2631138563156135e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.20480130523561485, "policy_loss": -0.0022159603737274963, "vf_loss": 0.20701726616049806, "vf_explained_var": 0.06631943126204153, "kl": 0.002628022217206637, "entropy": 0.1710350333658791, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 256095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2105264671698766, "cur_kl_coeff": 2.172589302062987e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.23701383118936853, "policy_loss": -0.01601803465426047, "vf_loss": 0.2530318583330083, "vf_explained_var": -0.3832041422526042, "kl": 0.004400626228001938, "entropy": 0.1635497433798654, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 256095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 2176000, "num_agent_steps_trained": 2176000}, "env_runners": {"episode_reward_max": 72.0, "episode_reward_min": -166.0, "episode_reward_mean": -1.6, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -251.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 72.0, "predator_policy": 115.0}, "policy_reward_mean": {"prey_policy": -6.93, "predator_policy": 6.13}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 8.0, 1.0, 0.0, 5.0, -6.0, 4.0, 0.0, 0.0, -9.0, 0.0, -30.0, -3.0, 0.0, -10.0, -18.0, -7.0, 0.0, 3.0, 4.0, -22.0, 4.0, -4.0, -47.0, 15.0, -106.0, 46.0, -3.0, 3.0, -3.0, -4.0, 5.0, 11.0, 12.0, -5.0, 9.0, -1.0, -5.0, -11.0, 14.0, 37.0, 9.0, 0.0, -17.0, -2.0, 0.0, 0.0, 0.0, -7.0, -2.0, 0.0, 0.0, 16.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 7.0, -6.0, 4.0, -166.0, -4.0, -5.0, 17.0, 0.0, 0.0, 72.0, 2.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 16.0, 16.0, 0.0, 0.0, 1.0, 52.0, 0.0, -1.0, 3.0, 0.0, 1.0, -6.0, 23.0, -10.0, 2.0, 5.0, -3.0, -3.0, -10.0, -7.0, -4.0, 4.0, -20.0, -33.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 0.0, -80.0, 2.0, -12.0, 0.0, 4.0, -28.0, 0.0, 0.0, 0.0, 0.0, -18.0, 0.0, 0.0, 0.0, 0.0, -73.0, -9.0, 0.0, 0.0, 0.0, -14.0, -6.0, -74.0, -16.0, -2.0, -12.0, -4.0, 0.0, 3.0, 0.0, 4.0, 0.0, 0.0, -46.0, 0.0, 4.0, -8.0, 0.0, -12.0, -82.0, 10.0, 5.0, -20.0, -251.0, 45.0, 0.0, 0.0, -6.0, -84.0, 0.0, -6.0, 0.0, 0.0, -18.0, 5.0, -2.0, 11.0, 0.0, 12.0, 0.0, 0.0, -10.0, -11.0, 5.0, 0.0, -2.0, -12.0, 0.0, -22.0, 0.0, 0.0, 11.0, 0.0, 26.0, 9.0, 0.0, 0.0, 0.0, 0.0, -35.0, 0.0, -26.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, -4.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -28.0, 0.0, -12.0, 0.0, 3.0, 1.0, -134.0, -142.0, -16.0, 4.0, -9.0, -6.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, -17.0, 72.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, 5.0, 0.0, -4.0, 2.0, -35.0, 16.0, -4.0, -7.0, 0.0, 0.0, 0.0, 0.0, -27.0, -8.0, 0.0, 52.0, 0.0, 0.0, 0.0, -8.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, -36.0, 28.0, -12.0, -8.0, -12.0, -4.0, 4.0, -5.0, 0.0, 0.0, -7.0, 0.0, -6.0, -36.0, 0.0, -8.0, -6.0, -12.0, 0.0, 4.0, 0.0, -12.0, -40.0, -95.0, 5.0], "policy_predator_policy_reward": [0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 0.0, 29.0, 54.0, 6.0, 0.0, 14.0, 14.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 43.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 10.0, 37.0, 35.0, 6.0, 1.0, 2.0, 2.0, 0.0, 0.0, 0.0, 0.0, 24.0, 0.0, 0.0, 0.0, 4.0, 0.0, 47.0, 0.0, 0.0, 0.0, 115.0, 50.0, 1.0, 0.0, 0.0, 3.0, 31.0, 56.0, 3.0, 0.0, 7.0, 7.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 7.0, 8.0, 0.0, 1.0, 0.0, 7.0, 6.0, 5.0, 3.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 11.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.0, 14.0, 0.0, 6.0, 0.0, 0.0, 25.0, 85.0, 0.0, 8.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 6.0, 0.0, 0.0, 0.0, 2.0, 17.0, 18.0, 0.0, 27.0, 0.0, 0.0, 0.0, 0.0, 13.0, 23.0, 0.0, 0.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 15.0, 6.0, 1.0, 4.0, 6.0, 2.0, 0.0, 0.0, 10.0, 0.0, 4.0, 3.0, 0.0, 0.0, 26.0, 3.0, 4.0, 0.0, 8.0, 0.0, 0.0, 6.0, 26.0, 54.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.48725185172748, "mean_inference_ms": 63.06115516870479, "mean_action_processing_ms": 9.200977581126445, "mean_env_wait_ms": 7.906027524808573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011414647102355957, "StateBufferConnector_ms": 0.005190491676330566, "ViewRequirementAgentConnector_ms": 0.11169302463531494}, "num_episodes": 18, "episode_return_max": 72.0, "episode_return_min": -166.0, "episode_return_mean": -1.6, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2176000, "num_agent_steps_trained": 2176000, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.6541058354366, "num_env_steps_trained_throughput_per_sec": 288.6541058354366, "timesteps_total": 544000, "num_env_steps_sampled_lifetime": 544000, "num_agent_steps_sampled_lifetime": 2176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2176000, "timers": {"training_iteration_time_ms": 474961.867, "restore_workers_time_ms": 0.164, "training_step_time_ms": 474961.457, "sample_time_ms": 354080.402, "learn_time_ms": 120843.805, "learn_throughput": 33.101, "synch_weights_time_ms": 28.83}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 2176000, "num_agent_steps_trained": 2176000}, "done": false, "training_iteration": 136, "trial_id": "f6b99_00000", "date": "2024-08-13_23-10-26", "timestamp": 1723605026, "time_this_iter_s": 13.918524980545044, "time_total_s": 12324.393483877182, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b60ba040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12324.393483877182, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 57.06500000000001, "ram_util_percent": 83.78}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.218734401669452, "cur_kl_coeff": 1.1315569281578068e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.82067097083286, "policy_loss": -0.0020022368482338687, "vf_loss": 0.8226732089800178, "vf_explained_var": 0.023103604335633535, "kl": 0.008547502657936537, "entropy": 0.13262724169584178, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 257985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3711003025215138, "cur_kl_coeff": 1.0862946510314936e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8680065966482279, "policy_loss": -0.011101653543670499, "vf_loss": 0.8791082498888491, "vf_explained_var": -0.3121793104857995, "kl": 0.0019690901172438355, "entropy": 0.2375540445327128, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 257985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 2192000, "num_agent_steps_trained": 2192000}, "env_runners": {"episode_reward_max": 72.0, "episode_reward_min": -178.0, "episode_reward_mean": -3.11, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -363.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 72.0, "predator_policy": 185.0}, "policy_reward_mean": {"prey_policy": -7.81, "predator_policy": 6.255}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-47.0, 15.0, -106.0, 46.0, -3.0, 3.0, -3.0, -4.0, 5.0, 11.0, 12.0, -5.0, 9.0, -1.0, -5.0, -11.0, 14.0, 37.0, 9.0, 0.0, -17.0, -2.0, 0.0, 0.0, 0.0, -7.0, -2.0, 0.0, 0.0, 16.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 7.0, -6.0, 4.0, -166.0, -4.0, -5.0, 17.0, 0.0, 0.0, 72.0, 2.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 16.0, 16.0, 0.0, 0.0, 1.0, 52.0, 0.0, -1.0, 3.0, 0.0, 1.0, -6.0, 23.0, -10.0, 2.0, 5.0, -3.0, -3.0, -10.0, -7.0, -4.0, 4.0, -20.0, -33.0, 1.0, -178.0, 16.0, 0.0, 0.0, -21.0, -3.0, -18.0, 0.0, -4.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 10.0, 0.0, 12.0, 0.0, -28.0, -26.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-12.0, -82.0, 10.0, 5.0, -20.0, -251.0, 45.0, 0.0, 0.0, -6.0, -84.0, 0.0, -6.0, 0.0, 0.0, -18.0, 5.0, -2.0, 11.0, 0.0, 12.0, 0.0, 0.0, -10.0, -11.0, 5.0, 0.0, -2.0, -12.0, 0.0, -22.0, 0.0, 0.0, 11.0, 0.0, 26.0, 9.0, 0.0, 0.0, 0.0, 0.0, -35.0, 0.0, -26.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, -4.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -28.0, 0.0, -12.0, 0.0, 3.0, 1.0, -134.0, -142.0, -16.0, 4.0, -9.0, -6.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, -17.0, 72.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, 5.0, 0.0, -4.0, 2.0, -35.0, 16.0, -4.0, -7.0, 0.0, 0.0, 0.0, 0.0, -27.0, -8.0, 0.0, 52.0, 0.0, 0.0, 0.0, -8.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, -36.0, 28.0, -12.0, -8.0, -12.0, -4.0, 4.0, -5.0, 0.0, 0.0, -7.0, 0.0, -6.0, -36.0, 0.0, -8.0, -6.0, -12.0, 0.0, 4.0, 0.0, -12.0, -40.0, -95.0, 5.0, 0.0, 1.0, -363.0, 0.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, -26.0, -2.0, -4.0, -16.0, -23.0, 0.0, 0.0, -10.0, 1.0, -6.0, -4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, -11.0, 3.0, 0.0, 0.0, -8.0, 16.0, 0.0, 0.0, -12.0, -46.0, -38.0, -20.0, 0.0, 0.0], "policy_predator_policy_reward": [47.0, 0.0, 0.0, 0.0, 115.0, 50.0, 1.0, 0.0, 0.0, 3.0, 31.0, 56.0, 3.0, 0.0, 7.0, 7.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 7.0, 8.0, 0.0, 1.0, 0.0, 7.0, 6.0, 5.0, 3.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 11.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.0, 14.0, 0.0, 6.0, 0.0, 0.0, 25.0, 85.0, 0.0, 8.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 6.0, 0.0, 0.0, 0.0, 2.0, 17.0, 18.0, 0.0, 27.0, 0.0, 0.0, 0.0, 0.0, 13.0, 23.0, 0.0, 0.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 15.0, 6.0, 1.0, 4.0, 6.0, 2.0, 0.0, 0.0, 10.0, 0.0, 4.0, 3.0, 0.0, 0.0, 26.0, 3.0, 4.0, 0.0, 8.0, 0.0, 0.0, 6.0, 26.0, 54.0, 3.0, 0.0, 0.0, 0.0, 185.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 14.0, 2.0, 1.0, 13.0, 8.0, 0.0, 0.0, 0.0, 5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 16.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 16.0, 14.0, 17.0, 15.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.17318463812613, "mean_inference_ms": 62.53932518301745, "mean_action_processing_ms": 9.118188856914008, "mean_env_wait_ms": 7.847869282162252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01089322566986084, "StateBufferConnector_ms": 0.0035642385482788086, "ViewRequirementAgentConnector_ms": 0.10701906681060791}, "num_episodes": 23, "episode_return_max": 72.0, "episode_return_min": -178.0, "episode_return_mean": -3.11, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2192000, "num_agent_steps_trained": 2192000, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.0727187349442, "num_env_steps_trained_throughput_per_sec": 288.0727187349442, "timesteps_total": 548000, "num_env_steps_sampled_lifetime": 548000, "num_agent_steps_sampled_lifetime": 2192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2192000, "timers": {"training_iteration_time_ms": 278062.243, "restore_workers_time_ms": 0.163, "training_step_time_ms": 278061.835, "sample_time_ms": 157391.66, "learn_time_ms": 120632.773, "learn_throughput": 33.158, "synch_weights_time_ms": 28.44}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 2192000, "num_agent_steps_trained": 2192000}, "done": false, "training_iteration": 137, "trial_id": "f6b99_00000", "date": "2024-08-13_23-10-40", "timestamp": 1723605040, "time_this_iter_s": 13.916958093643188, "time_total_s": 12338.310441970825, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b60badc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12338.310441970825, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 53.74000000000001, "ram_util_percent": 83.67999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6838460449188475, "cur_kl_coeff": 1.1315569281578068e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.22865221446389875, "policy_loss": -0.006534589897649037, "vf_loss": 0.2351868039654893, "vf_explained_var": 0.2528328720854704, "kl": 0.02278789376898336, "entropy": 0.2766918679787999, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 259875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5015353312370954, "cur_kl_coeff": 5.431473255157468e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.44072445233385743, "policy_loss": -0.01347999221746312, "vf_loss": 0.4542044445522445, "vf_explained_var": -0.25207679571298064, "kl": 0.0023695227366175515, "entropy": 0.19253261959347776, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 259875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000}, "env_runners": {"episode_reward_max": 72.0, "episode_reward_min": -178.0, "episode_reward_mean": -3.19, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -363.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 72.0, "predator_policy": 185.0}, "policy_reward_mean": {"prey_policy": -6.82, "predator_policy": 5.225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, -7.0, -2.0, 0.0, 0.0, 16.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 7.0, -6.0, 4.0, -166.0, -4.0, -5.0, 17.0, 0.0, 0.0, 72.0, 2.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 16.0, 16.0, 0.0, 0.0, 1.0, 52.0, 0.0, -1.0, 3.0, 0.0, 1.0, -6.0, 23.0, -10.0, 2.0, 5.0, -3.0, -3.0, -10.0, -7.0, -4.0, 4.0, -20.0, -33.0, 1.0, -178.0, 16.0, 0.0, 0.0, -21.0, -3.0, -18.0, 0.0, -4.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 10.0, 0.0, 12.0, 0.0, -28.0, -26.0, 0.0, -4.0, -3.0, 4.0, 0.0, 14.0, -5.0, -7.0, -5.0, -6.0, -51.0, -12.0, 16.0, 0.0, 4.0, 7.0, 0.0, 3.0, 12.0, -19.0, 0.0, 13.0, -12.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, -4.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 2.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -28.0, 0.0, -12.0, 0.0, 3.0, 1.0, -134.0, -142.0, -16.0, 4.0, -9.0, -6.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, -17.0, 72.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, 5.0, 0.0, -4.0, 2.0, -35.0, 16.0, -4.0, -7.0, 0.0, 0.0, 0.0, 0.0, -27.0, -8.0, 0.0, 52.0, 0.0, 0.0, 0.0, -8.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, -36.0, 28.0, -12.0, -8.0, -12.0, -4.0, 4.0, -5.0, 0.0, 0.0, -7.0, 0.0, -6.0, -36.0, 0.0, -8.0, -6.0, -12.0, 0.0, 4.0, 0.0, -12.0, -40.0, -95.0, 5.0, 0.0, 1.0, -363.0, 0.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, -26.0, -2.0, -4.0, -16.0, -23.0, 0.0, 0.0, -10.0, 1.0, -6.0, -4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, -11.0, 3.0, 0.0, 0.0, -8.0, 16.0, 0.0, 0.0, -12.0, -46.0, -38.0, -20.0, 0.0, 0.0, -2.0, -10.0, 0.0, -6.0, 4.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, -31.0, -4.0, -8.0, 0.0, -10.0, 1.0, -14.0, -98.0, -8.0, 0.0, -24.0, 15.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, -30.0, 0.0, 0.0, 0.0, 1.0, 3.0, 6.0, -38.0, 0.0, -10.0, 4.0, -6.0, 12.0, 0.0, -24.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 21.0, 14.0, 0.0, 6.0, 0.0, 0.0, 25.0, 85.0, 0.0, 8.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 6.0, 0.0, 0.0, 0.0, 2.0, 17.0, 18.0, 0.0, 27.0, 0.0, 0.0, 0.0, 0.0, 13.0, 23.0, 0.0, 0.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 15.0, 6.0, 1.0, 4.0, 6.0, 2.0, 0.0, 0.0, 10.0, 0.0, 4.0, 3.0, 0.0, 0.0, 26.0, 3.0, 4.0, 0.0, 8.0, 0.0, 0.0, 6.0, 26.0, 54.0, 3.0, 0.0, 0.0, 0.0, 185.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 14.0, 2.0, 1.0, 13.0, 8.0, 0.0, 0.0, 0.0, 5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 16.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 16.0, 14.0, 17.0, 15.0, 0.0, 0.0, 0.0, 8.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 16.0, 4.0, 1.0, 5.0, 0.0, 0.0, 7.0, 49.0, 6.0, 7.0, 5.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 16.0, 21.0, 0.0, 0.0, 0.0, 2.0, 2.0, 1.0, 0.0, 19.0, 1.0, 5.0, 7.0, 0.0, 0.0, 12.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.2818231422615, "mean_inference_ms": 61.785077104988815, "mean_action_processing_ms": 9.062565504632104, "mean_env_wait_ms": 8.292310690818358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0114058256149292, "StateBufferConnector_ms": 0.0040558576583862305, "ViewRequirementAgentConnector_ms": 0.10602760314941406}, "num_episodes": 22, "episode_return_max": 72.0, "episode_return_min": -178.0, "episode_return_mean": -3.19, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.48507161948214, "num_env_steps_trained_throughput_per_sec": 290.48507161948214, "timesteps_total": 552000, "num_env_steps_sampled_lifetime": 552000, "num_agent_steps_sampled_lifetime": 2208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2208000, "timers": {"training_iteration_time_ms": 277759.695, "restore_workers_time_ms": 0.163, "training_step_time_ms": 277759.28, "sample_time_ms": 157168.904, "learn_time_ms": 120553.105, "learn_throughput": 33.18, "synch_weights_time_ms": 28.305}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000}, "done": false, "training_iteration": 138, "trial_id": "f6b99_00000", "date": "2024-08-13_23-10-54", "timestamp": 1723605054, "time_this_iter_s": 13.828613042831421, "time_total_s": 12352.139055013657, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6219550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12352.139055013657, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 54.163157894736834, "ram_util_percent": 83.73684210526316}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1548605367304787, "cur_kl_coeff": 1.6973353922367087e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7582057882869054, "policy_loss": -0.0026969692541690417, "vf_loss": 0.7609027575248133, "vf_explained_var": 0.0723311032252337, "kl": 0.006974249196100282, "entropy": 0.2914822320379908, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 261765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3317676127193465, "cur_kl_coeff": 2.715736627578734e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.747814683864514, "policy_loss": -0.007953597569256706, "vf_loss": 0.7557682808429476, "vf_explained_var": 0.04488279220288393, "kl": 0.002146000031805216, "entropy": 0.1781583189097031, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 261765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 2224000, "num_agent_steps_trained": 2224000}, "env_runners": {"episode_reward_max": 72.0, "episode_reward_min": -178.0, "episode_reward_mean": -2.99, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -363.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 72.0, "predator_policy": 185.0}, "policy_reward_mean": {"prey_policy": -7.36, "predator_policy": 5.865}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, -5.0, 17.0, 0.0, 0.0, 72.0, 2.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 16.0, 16.0, 0.0, 0.0, 1.0, 52.0, 0.0, -1.0, 3.0, 0.0, 1.0, -6.0, 23.0, -10.0, 2.0, 5.0, -3.0, -3.0, -10.0, -7.0, -4.0, 4.0, -20.0, -33.0, 1.0, -178.0, 16.0, 0.0, 0.0, -21.0, -3.0, -18.0, 0.0, -4.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 10.0, 0.0, 12.0, 0.0, -28.0, -26.0, 0.0, -4.0, -3.0, 4.0, 0.0, 14.0, -5.0, -7.0, -5.0, -6.0, -51.0, -12.0, 16.0, 0.0, 4.0, 7.0, 0.0, 3.0, 12.0, -19.0, 0.0, 13.0, -12.0, 0.0, 0.0, 0.0, -4.0, -32.0, -6.0, -45.0, -70.0, -5.0, -2.0, 0.0, -26.0, -5.0, 67.0, 0.0, 6.0, -8.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-16.0, 4.0, -9.0, -6.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, -17.0, 72.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, 5.0, 0.0, -4.0, 2.0, -35.0, 16.0, -4.0, -7.0, 0.0, 0.0, 0.0, 0.0, -27.0, -8.0, 0.0, 52.0, 0.0, 0.0, 0.0, -8.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, -36.0, 28.0, -12.0, -8.0, -12.0, -4.0, 4.0, -5.0, 0.0, 0.0, -7.0, 0.0, -6.0, -36.0, 0.0, -8.0, -6.0, -12.0, 0.0, 4.0, 0.0, -12.0, -40.0, -95.0, 5.0, 0.0, 1.0, -363.0, 0.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, -26.0, -2.0, -4.0, -16.0, -23.0, 0.0, 0.0, -10.0, 1.0, -6.0, -4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, -11.0, 3.0, 0.0, 0.0, -8.0, 16.0, 0.0, 0.0, -12.0, -46.0, -38.0, -20.0, 0.0, 0.0, -2.0, -10.0, 0.0, -6.0, 4.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, -31.0, -4.0, -8.0, 0.0, -10.0, 1.0, -14.0, -98.0, -8.0, 0.0, -24.0, 15.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, -30.0, 0.0, 0.0, 0.0, 1.0, 3.0, 6.0, -38.0, 0.0, -10.0, 4.0, -6.0, 12.0, 0.0, -24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -8.0, 0.0, -40.0, -24.0, -12.0, 0.0, 0.0, -90.0, 0.0, -150.0, 0.0, -16.0, -4.0, 0.0, 0.0, 0.0, 1.0, -74.0, -16.0, 0.0, 34.0, 0.0, 0.0, 0.0, 6.0, -9.0, -4.0, -12.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 8.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 6.0, 0.0, 0.0, 0.0, 2.0, 17.0, 18.0, 0.0, 27.0, 0.0, 0.0, 0.0, 0.0, 13.0, 23.0, 0.0, 0.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 15.0, 6.0, 1.0, 4.0, 6.0, 2.0, 0.0, 0.0, 10.0, 0.0, 4.0, 3.0, 0.0, 0.0, 26.0, 3.0, 4.0, 0.0, 8.0, 0.0, 0.0, 6.0, 26.0, 54.0, 3.0, 0.0, 0.0, 0.0, 185.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 14.0, 2.0, 1.0, 13.0, 8.0, 0.0, 0.0, 0.0, 5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 16.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 16.0, 14.0, 17.0, 15.0, 0.0, 0.0, 0.0, 8.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 16.0, 4.0, 1.0, 5.0, 0.0, 0.0, 7.0, 49.0, 6.0, 7.0, 5.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 16.0, 21.0, 0.0, 0.0, 0.0, 2.0, 2.0, 1.0, 0.0, 19.0, 1.0, 5.0, 7.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 12.0, 20.0, 0.0, 6.0, 0.0, 45.0, 63.0, 17.0, 0.0, 11.0, 2.0, 0.0, 0.0, 0.0, 41.0, 6.0, 8.0, 3.0, 33.0, 0.0, 0.0, 0.0, 3.0, 6.0, 2.0, 6.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.66578534188226, "mean_inference_ms": 61.66801856272139, "mean_action_processing_ms": 8.995369601672657, "mean_env_wait_ms": 7.731896035107407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006728172302246094, "StateBufferConnector_ms": 0.003985285758972168, "ViewRequirementAgentConnector_ms": 0.10450315475463867}, "num_episodes": 18, "episode_return_max": 72.0, "episode_return_min": -178.0, "episode_return_mean": -2.99, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2224000, "num_agent_steps_trained": 2224000, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.9466677642841, "num_env_steps_trained_throughput_per_sec": 309.9466677642841, "timesteps_total": 556000, "num_env_steps_sampled_lifetime": 556000, "num_agent_steps_sampled_lifetime": 2224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2224000, "timers": {"training_iteration_time_ms": 170968.163, "restore_workers_time_ms": 0.163, "training_step_time_ms": 170967.749, "sample_time_ms": 157168.013, "learn_time_ms": 13766.03, "learn_throughput": 290.57, "synch_weights_time_ms": 24.78}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 2224000, "num_agent_steps_trained": 2224000}, "done": false, "training_iteration": 139, "trial_id": "f6b99_00000", "date": "2024-08-13_23-11-07", "timestamp": 1723605067, "time_this_iter_s": 12.947326898574829, "time_total_s": 12365.086381912231, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6219430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12365.086381912231, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 50.421052631578945, "ram_util_percent": 83.78947368421052}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.580123284269893, "cur_kl_coeff": 1.6973353922367087e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1658419592828346, "policy_loss": -0.0017151578267908128, "vf_loss": 1.1675571168541277, "vf_explained_var": 0.038246047086816615, "kl": 0.004969250279516837, "entropy": 0.33615581842641984, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 263655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4155932538566136, "cur_kl_coeff": 1.357868313789367e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8720391656969373, "policy_loss": -0.014059567212117294, "vf_loss": 0.8860987307375701, "vf_explained_var": -0.5355348192194782, "kl": 0.0030832628639386964, "entropy": 0.20263656311959186, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 263655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000}, "env_runners": {"episode_reward_max": 67.0, "episode_reward_min": -178.0, "episode_reward_mean": -6.26, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -363.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 52.0, "predator_policy": 185.0}, "policy_reward_mean": {"prey_policy": -10.32, "predator_policy": 7.19}, "custom_metrics": {}, "hist_stats": {"episode_reward": [52.0, 0.0, -1.0, 3.0, 0.0, 1.0, -6.0, 23.0, -10.0, 2.0, 5.0, -3.0, -3.0, -10.0, -7.0, -4.0, 4.0, -20.0, -33.0, 1.0, -178.0, 16.0, 0.0, 0.0, -21.0, -3.0, -18.0, 0.0, -4.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 10.0, 0.0, 12.0, 0.0, -28.0, -26.0, 0.0, -4.0, -3.0, 4.0, 0.0, 14.0, -5.0, -7.0, -5.0, -6.0, -51.0, -12.0, 16.0, 0.0, 4.0, 7.0, 0.0, 3.0, 12.0, -19.0, 0.0, 13.0, -12.0, 0.0, 0.0, 0.0, -4.0, -32.0, -6.0, -45.0, -70.0, -5.0, -2.0, 0.0, -26.0, -5.0, 67.0, 0.0, 6.0, -8.0, 0.0, 0.0, 0.0, -1.0, -7.0, -5.0, -17.0, -26.0, -86.0, -14.0, 3.0, -12.0, -15.0, -7.0, -12.0, -2.0, 0.0, 0.0, -6.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 52.0, 0.0, 0.0, 0.0, -8.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 3.0, -36.0, 28.0, -12.0, -8.0, -12.0, -4.0, 4.0, -5.0, 0.0, 0.0, -7.0, 0.0, -6.0, -36.0, 0.0, -8.0, -6.0, -12.0, 0.0, 4.0, 0.0, -12.0, -40.0, -95.0, 5.0, 0.0, 1.0, -363.0, 0.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, -26.0, -2.0, -4.0, -16.0, -23.0, 0.0, 0.0, -10.0, 1.0, -6.0, -4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, -11.0, 3.0, 0.0, 0.0, -8.0, 16.0, 0.0, 0.0, -12.0, -46.0, -38.0, -20.0, 0.0, 0.0, -2.0, -10.0, 0.0, -6.0, 4.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, -31.0, -4.0, -8.0, 0.0, -10.0, 1.0, -14.0, -98.0, -8.0, 0.0, -24.0, 15.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, -30.0, 0.0, 0.0, 0.0, 1.0, 3.0, 6.0, -38.0, 0.0, -10.0, 4.0, -6.0, 12.0, 0.0, -24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -8.0, 0.0, -40.0, -24.0, -12.0, 0.0, 0.0, -90.0, 0.0, -150.0, 0.0, -16.0, -4.0, 0.0, 0.0, 0.0, 1.0, -74.0, -16.0, 0.0, 34.0, 0.0, 0.0, 0.0, 6.0, -9.0, -4.0, -12.0, 0.0, 0.0, -4.0, 2.0, 0.0, 0.0, 3.0, -8.0, -30.0, 0.0, -30.0, 0.0, -6.0, -80.0, -12.0, -28.0, -172.0, 0.0, -8.0, -20.0, 0.0, -2.0, -11.0, -14.0, -22.0, -102.0, 0.0, -14.0, 0.0, -41.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, -10.0, -2.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 15.0, 6.0, 1.0, 4.0, 6.0, 2.0, 0.0, 0.0, 10.0, 0.0, 4.0, 3.0, 0.0, 0.0, 26.0, 3.0, 4.0, 0.0, 8.0, 0.0, 0.0, 6.0, 26.0, 54.0, 3.0, 0.0, 0.0, 0.0, 185.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 14.0, 2.0, 1.0, 13.0, 8.0, 0.0, 0.0, 0.0, 5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 16.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 16.0, 14.0, 17.0, 15.0, 0.0, 0.0, 0.0, 8.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 16.0, 4.0, 1.0, 5.0, 0.0, 0.0, 7.0, 49.0, 6.0, 7.0, 5.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 16.0, 21.0, 0.0, 0.0, 0.0, 2.0, 2.0, 1.0, 0.0, 19.0, 1.0, 5.0, 7.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 12.0, 20.0, 0.0, 6.0, 0.0, 45.0, 63.0, 17.0, 0.0, 11.0, 2.0, 0.0, 0.0, 0.0, 41.0, 6.0, 8.0, 3.0, 33.0, 0.0, 0.0, 0.0, 3.0, 6.0, 2.0, 6.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 23.0, 10.0, 15.0, 12.0, 57.0, 0.0, 14.0, 86.0, 0.0, 6.0, 8.0, 5.0, 0.0, 7.0, 6.0, 58.0, 51.0, 0.0, 7.0, 0.0, 29.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.434851582711374, "mean_inference_ms": 61.27495195332367, "mean_action_processing_ms": 8.937787897029832, "mean_env_wait_ms": 7.682340758625681, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006838679313659668, "StateBufferConnector_ms": 0.003929734230041504, "ViewRequirementAgentConnector_ms": 0.10364532470703125}, "num_episodes": 18, "episode_return_max": 67.0, "episode_return_min": -178.0, "episode_return_mean": -6.26, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.63817264058144, "num_env_steps_trained_throughput_per_sec": 298.63817264058144, "timesteps_total": 560000, "num_env_steps_sampled_lifetime": 560000, "num_agent_steps_sampled_lifetime": 2240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2240000, "timers": {"training_iteration_time_ms": 14501.4, "restore_workers_time_ms": 0.02, "training_step_time_ms": 14501.315, "sample_time_ms": 1919.25, "learn_time_ms": 12558.178, "learn_throughput": 318.518, "synch_weights_time_ms": 19.27}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000}, "done": false, "training_iteration": 140, "trial_id": "f6b99_00000", "date": "2024-08-13_23-11-21", "timestamp": 1723605081, "time_this_iter_s": 13.435448169708252, "time_total_s": 12378.52183008194, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6d71af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12378.52183008194, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 50.68947368421052, "ram_util_percent": 83.71578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6564953355089066, "cur_kl_coeff": 8.486676961183544e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5181087576759555, "policy_loss": -0.0021020093060556857, "vf_loss": 0.5202107685218964, "vf_explained_var": 0.029954087292706526, "kl": 0.009162982910016031, "entropy": 0.4832936332812385, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 265545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7169638717970837, "cur_kl_coeff": 6.789341568946835e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7515437604061195, "policy_loss": -0.0013921513823329141, "vf_loss": 0.7529359118056991, "vf_explained_var": 0.08277928460211981, "kl": 0.001274538389674721, "entropy": 0.1322495664080615, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 265545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000}, "env_runners": {"episode_reward_max": 67.0, "episode_reward_min": -156.0, "episode_reward_mean": -6.38, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -292.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 39.0, "predator_policy": 156.0}, "policy_reward_mean": {"prey_policy": -10.445, "predator_policy": 7.255}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -21.0, -3.0, -18.0, 0.0, -4.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 10.0, 0.0, 12.0, 0.0, -28.0, -26.0, 0.0, -4.0, -3.0, 4.0, 0.0, 14.0, -5.0, -7.0, -5.0, -6.0, -51.0, -12.0, 16.0, 0.0, 4.0, 7.0, 0.0, 3.0, 12.0, -19.0, 0.0, 13.0, -12.0, 0.0, 0.0, 0.0, -4.0, -32.0, -6.0, -45.0, -70.0, -5.0, -2.0, 0.0, -26.0, -5.0, 67.0, 0.0, 6.0, -8.0, 0.0, 0.0, 0.0, -1.0, -7.0, -5.0, -17.0, -26.0, -86.0, -14.0, 3.0, -12.0, -15.0, -7.0, -12.0, -2.0, 0.0, 0.0, -6.0, -2.0, -25.0, -3.0, 0.0, 26.0, -4.0, -4.0, 0.0, 9.0, -9.0, 0.0, -4.0, -1.0, 0.0, 0.0, -98.0, 0.0, 10.0, -4.0, 56.0, 2.0, -156.0, 27.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -14.0, -26.0, -2.0, -4.0, -16.0, -23.0, 0.0, 0.0, -10.0, 1.0, -6.0, -4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, -11.0, 3.0, 0.0, 0.0, -8.0, 16.0, 0.0, 0.0, -12.0, -46.0, -38.0, -20.0, 0.0, 0.0, -2.0, -10.0, 0.0, -6.0, 4.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, -31.0, -4.0, -8.0, 0.0, -10.0, 1.0, -14.0, -98.0, -8.0, 0.0, -24.0, 15.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, -30.0, 0.0, 0.0, 0.0, 1.0, 3.0, 6.0, -38.0, 0.0, -10.0, 4.0, -6.0, 12.0, 0.0, -24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -8.0, 0.0, -40.0, -24.0, -12.0, 0.0, 0.0, -90.0, 0.0, -150.0, 0.0, -16.0, -4.0, 0.0, 0.0, 0.0, 1.0, -74.0, -16.0, 0.0, 34.0, 0.0, 0.0, 0.0, 6.0, -9.0, -4.0, -12.0, 0.0, 0.0, -4.0, 2.0, 0.0, 0.0, 3.0, -8.0, -30.0, 0.0, -30.0, 0.0, -6.0, -80.0, -12.0, -28.0, -172.0, 0.0, -8.0, -20.0, 0.0, -2.0, -11.0, -14.0, -22.0, -102.0, 0.0, -14.0, 0.0, -41.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, -10.0, -2.0, -4.0, 0.0, 0.0, -50.0, -12.0, -10.0, 0.0, 0.0, -4.0, -6.0, -9.0, 0.0, 1.0, -10.0, 0.0, 0.0, -9.0, -5.0, -15.0, -23.0, 0.0, 0.0, -8.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, 0.0, -68.0, -74.0, 0.0, 0.0, 0.0, 5.0, -8.0, 0.0, 0.0, 39.0, -13.0, -8.0, -20.0, -292.0, 0.0, 27.0], "policy_predator_policy_reward": [0.0, 0.0, 5.0, 14.0, 2.0, 1.0, 13.0, 8.0, 0.0, 0.0, 0.0, 5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 16.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 16.0, 14.0, 17.0, 15.0, 0.0, 0.0, 0.0, 8.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 16.0, 4.0, 1.0, 5.0, 0.0, 0.0, 7.0, 49.0, 6.0, 7.0, 5.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 16.0, 21.0, 0.0, 0.0, 0.0, 2.0, 2.0, 1.0, 0.0, 19.0, 1.0, 5.0, 7.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 12.0, 20.0, 0.0, 6.0, 0.0, 45.0, 63.0, 17.0, 0.0, 11.0, 2.0, 0.0, 0.0, 0.0, 41.0, 6.0, 8.0, 3.0, 33.0, 0.0, 0.0, 0.0, 3.0, 6.0, 2.0, 6.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 23.0, 10.0, 15.0, 12.0, 57.0, 0.0, 14.0, 86.0, 0.0, 6.0, 8.0, 5.0, 0.0, 7.0, 6.0, 58.0, 51.0, 0.0, 7.0, 0.0, 29.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 2.0, 25.0, 0.0, 5.0, 14.0, 0.0, 0.0, 14.0, 22.0, 5.0, 0.0, 0.0, 5.0, 0.0, 0.0, 10.0, 13.0, 15.0, 14.0, 0.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 33.0, 11.0, 0.0, 0.0, 5.0, 0.0, 0.0, 4.0, 17.0, 0.0, 12.0, 11.0, 156.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 35.661105221609745, "mean_inference_ms": 60.20598649543661, "mean_action_processing_ms": 9.291717111464017, "mean_env_wait_ms": 7.795321534400829, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007878541946411133, "StateBufferConnector_ms": 0.003686666488647461, "ViewRequirementAgentConnector_ms": 0.09868872165679932}, "num_episodes": 23, "episode_return_max": 67.0, "episode_return_min": -156.0, "episode_return_mean": -6.38, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.1504090306024, "num_env_steps_trained_throughput_per_sec": 302.1504090306024, "timesteps_total": 564000, "num_env_steps_sampled_lifetime": 564000, "num_agent_steps_sampled_lifetime": 2256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2256000, "timers": {"training_iteration_time_ms": 13803.031, "restore_workers_time_ms": 0.017, "training_step_time_ms": 13802.967, "sample_time_ms": 1701.27, "learn_time_ms": 12077.863, "learn_throughput": 331.184, "synch_weights_time_ms": 19.485}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000}, "done": false, "training_iteration": 141, "trial_id": "f6b99_00000", "date": "2024-08-13_23-11-34", "timestamp": 1723605094, "time_this_iter_s": 13.276703119277954, "time_total_s": 12391.798533201218, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6d531f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12391.798533201218, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 50.55789473684211, "ram_util_percent": 83.83684210526316}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.806606016485464, "cur_kl_coeff": 8.486676961183544e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.46291717901116325, "policy_loss": -0.0012574075201339035, "vf_loss": 0.46417458593160427, "vf_explained_var": 0.011224617718388794, "kl": 0.009762982330943542, "entropy": 0.3497604043553115, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 267435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7180383714044063, "cur_kl_coeff": 3.3946707844734175e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5129906051871355, "policy_loss": -0.001020903083638697, "vf_loss": 0.5140115072603323, "vf_explained_var": -0.01211307720532493, "kl": 0.0017593250852241265, "entropy": 0.09792042469615658, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 267435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 2272000, "num_agent_steps_trained": 2272000}, "env_runners": {"episode_reward_max": 67.0, "episode_reward_min": -197.0, "episode_reward_mean": -7.04, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -396.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 62.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": -11.595, "predator_policy": 8.075}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -4.0, -3.0, 4.0, 0.0, 14.0, -5.0, -7.0, -5.0, -6.0, -51.0, -12.0, 16.0, 0.0, 4.0, 7.0, 0.0, 3.0, 12.0, -19.0, 0.0, 13.0, -12.0, 0.0, 0.0, 0.0, -4.0, -32.0, -6.0, -45.0, -70.0, -5.0, -2.0, 0.0, -26.0, -5.0, 67.0, 0.0, 6.0, -8.0, 0.0, 0.0, 0.0, -1.0, -7.0, -5.0, -17.0, -26.0, -86.0, -14.0, 3.0, -12.0, -15.0, -7.0, -12.0, -2.0, 0.0, 0.0, -6.0, -2.0, -25.0, -3.0, 0.0, 26.0, -4.0, -4.0, 0.0, 9.0, -9.0, 0.0, -4.0, -1.0, 0.0, 0.0, -98.0, 0.0, 10.0, -4.0, 56.0, 2.0, -156.0, 27.0, 0.0, 0.0, 42.0, -7.0, 23.0, 3.0, 59.0, -50.0, -5.0, 0.0, -197.0, 1.0, -4.0, -1.0, -2.0, 2.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -2.0, -10.0, 0.0, -6.0, 4.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, -31.0, -4.0, -8.0, 0.0, -10.0, 1.0, -14.0, -98.0, -8.0, 0.0, -24.0, 15.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, -30.0, 0.0, 0.0, 0.0, 1.0, 3.0, 6.0, -38.0, 0.0, -10.0, 4.0, -6.0, 12.0, 0.0, -24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -8.0, 0.0, -40.0, -24.0, -12.0, 0.0, 0.0, -90.0, 0.0, -150.0, 0.0, -16.0, -4.0, 0.0, 0.0, 0.0, 1.0, -74.0, -16.0, 0.0, 34.0, 0.0, 0.0, 0.0, 6.0, -9.0, -4.0, -12.0, 0.0, 0.0, -4.0, 2.0, 0.0, 0.0, 3.0, -8.0, -30.0, 0.0, -30.0, 0.0, -6.0, -80.0, -12.0, -28.0, -172.0, 0.0, -8.0, -20.0, 0.0, -2.0, -11.0, -14.0, -22.0, -102.0, 0.0, -14.0, 0.0, -41.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, -10.0, -2.0, -4.0, 0.0, 0.0, -50.0, -12.0, -10.0, 0.0, 0.0, -4.0, -6.0, -9.0, 0.0, 1.0, -10.0, 0.0, 0.0, -9.0, -5.0, -15.0, -23.0, 0.0, 0.0, -8.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, 0.0, -68.0, -74.0, 0.0, 0.0, 0.0, 5.0, -8.0, 0.0, 0.0, 39.0, -13.0, -8.0, -20.0, -292.0, 0.0, 27.0, 0.0, 0.0, 0.0, 0.0, 0.0, 42.0, -14.0, 0.0, 22.0, 0.0, 3.0, 0.0, 62.0, -9.0, 0.0, -101.0, -2.0, -29.0, 0.0, 0.0, -396.0, 1.0, 1.0, 0.0, -16.0, -2.0, -2.0, 0.0, -4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 8.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 16.0, 4.0, 1.0, 5.0, 0.0, 0.0, 7.0, 49.0, 6.0, 7.0, 5.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 16.0, 21.0, 0.0, 0.0, 0.0, 2.0, 2.0, 1.0, 0.0, 19.0, 1.0, 5.0, 7.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 12.0, 20.0, 0.0, 6.0, 0.0, 45.0, 63.0, 17.0, 0.0, 11.0, 2.0, 0.0, 0.0, 0.0, 41.0, 6.0, 8.0, 3.0, 33.0, 0.0, 0.0, 0.0, 3.0, 6.0, 2.0, 6.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 23.0, 10.0, 15.0, 12.0, 57.0, 0.0, 14.0, 86.0, 0.0, 6.0, 8.0, 5.0, 0.0, 7.0, 6.0, 58.0, 51.0, 0.0, 7.0, 0.0, 29.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 2.0, 25.0, 0.0, 5.0, 14.0, 0.0, 0.0, 14.0, 22.0, 5.0, 0.0, 0.0, 5.0, 0.0, 0.0, 10.0, 13.0, 15.0, 14.0, 0.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 33.0, 11.0, 0.0, 0.0, 5.0, 0.0, 0.0, 4.0, 17.0, 0.0, 12.0, 11.0, 156.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 1.0, 0.0, 0.0, 6.0, 0.0, 0.0, 51.0, 25.0, 1.0, 0.0, 0.0, 198.0, 0.0, 0.0, 0.0, 2.0, 12.0, 1.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.927584455661645, "mean_inference_ms": 60.419747379957606, "mean_action_processing_ms": 8.807926225285623, "mean_env_wait_ms": 7.580207108776551, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007286548614501953, "StateBufferConnector_ms": 0.003802657127380371, "ViewRequirementAgentConnector_ms": 0.11078321933746338}, "num_episodes": 18, "episode_return_max": 67.0, "episode_return_min": -197.0, "episode_return_mean": -7.04, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2272000, "num_agent_steps_trained": 2272000, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.54176875705485, "num_env_steps_trained_throughput_per_sec": 308.54176875705485, "timesteps_total": 568000, "num_env_steps_sampled_lifetime": 568000, "num_agent_steps_sampled_lifetime": 2272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2272000, "timers": {"training_iteration_time_ms": 13614.43, "restore_workers_time_ms": 0.017, "training_step_time_ms": 13614.365, "sample_time_ms": 1665.656, "learn_time_ms": 11923.981, "learn_throughput": 335.458, "synch_weights_time_ms": 20.281}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 2272000, "num_agent_steps_trained": 2272000}, "done": false, "training_iteration": 142, "trial_id": "f6b99_00000", "date": "2024-08-13_23-11-47", "timestamp": 1723605107, "time_this_iter_s": 13.023851156234741, "time_total_s": 12404.822384357452, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6d71a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12404.822384357452, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 49.638888888888886, "ram_util_percent": 83.69444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1217576293245195, "cur_kl_coeff": 8.486676961183544e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0840875447427154, "policy_loss": -0.0026384230582388465, "vf_loss": 1.0867259638255866, "vf_explained_var": 0.04993024244510307, "kl": 0.008919680507185782, "entropy": 0.49200744753476805, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 269325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9112919576702609, "cur_kl_coeff": 1.6973353922367087e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.541562409060342, "policy_loss": -0.003808555583021155, "vf_loss": 1.5453709673629237, "vf_explained_var": -0.0021787081445966447, "kl": 0.003031900872845177, "entropy": 0.14739071313272079, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 269325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 2288000, "num_agent_steps_trained": 2288000}, "env_runners": {"episode_reward_max": 67.0, "episode_reward_min": -565.0, "episode_reward_mean": -16.86, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 62.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -18.85, "predator_policy": 10.42}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, 0.0, 0.0, 0.0, -4.0, -32.0, -6.0, -45.0, -70.0, -5.0, -2.0, 0.0, -26.0, -5.0, 67.0, 0.0, 6.0, -8.0, 0.0, 0.0, 0.0, -1.0, -7.0, -5.0, -17.0, -26.0, -86.0, -14.0, 3.0, -12.0, -15.0, -7.0, -12.0, -2.0, 0.0, 0.0, -6.0, -2.0, -25.0, -3.0, 0.0, 26.0, -4.0, -4.0, 0.0, 9.0, -9.0, 0.0, -4.0, -1.0, 0.0, 0.0, -98.0, 0.0, 10.0, -4.0, 56.0, 2.0, -156.0, 27.0, 0.0, 0.0, 42.0, -7.0, 23.0, 3.0, 59.0, -50.0, -5.0, 0.0, -197.0, 1.0, -4.0, -1.0, -2.0, 2.0, 0.0, 0.0, -5.0, -565.0, -14.0, 0.0, 0.0, 0.0, -12.0, -17.0, -9.0, 12.0, -9.0, 0.0, 3.0, -20.0, 11.0, 0.0, 0.0, 7.0, 0.0, -236.0, -179.0, 12.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -8.0, 0.0, -40.0, -24.0, -12.0, 0.0, 0.0, -90.0, 0.0, -150.0, 0.0, -16.0, -4.0, 0.0, 0.0, 0.0, 1.0, -74.0, -16.0, 0.0, 34.0, 0.0, 0.0, 0.0, 6.0, -9.0, -4.0, -12.0, 0.0, 0.0, -4.0, 2.0, 0.0, 0.0, 3.0, -8.0, -30.0, 0.0, -30.0, 0.0, -6.0, -80.0, -12.0, -28.0, -172.0, 0.0, -8.0, -20.0, 0.0, -2.0, -11.0, -14.0, -22.0, -102.0, 0.0, -14.0, 0.0, -41.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, -10.0, -2.0, -4.0, 0.0, 0.0, -50.0, -12.0, -10.0, 0.0, 0.0, -4.0, -6.0, -9.0, 0.0, 1.0, -10.0, 0.0, 0.0, -9.0, -5.0, -15.0, -23.0, 0.0, 0.0, -8.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, 0.0, -68.0, -74.0, 0.0, 0.0, 0.0, 5.0, -8.0, 0.0, 0.0, 39.0, -13.0, -8.0, -20.0, -292.0, 0.0, 27.0, 0.0, 0.0, 0.0, 0.0, 0.0, 42.0, -14.0, 0.0, 22.0, 0.0, 3.0, 0.0, 62.0, -9.0, 0.0, -101.0, -2.0, -29.0, 0.0, 0.0, -396.0, 1.0, 1.0, 0.0, -16.0, -2.0, -2.0, 0.0, -4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, -400.0, -365.0, -30.0, 0.0, 0.0, 0.0, 0.0, -4.0, -8.0, 0.0, -24.0, 0.0, -24.0, -14.0, -12.0, -6.0, 12.0, 0.0, -22.0, 0.0, 0.0, 0.0, 0.0, 2.0, -40.0, 0.0, -10.0, 16.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, -70.0, -340.0, -19.0, -340.0, 0.0, 12.0], "policy_predator_policy_reward": [0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 12.0, 20.0, 0.0, 6.0, 0.0, 45.0, 63.0, 17.0, 0.0, 11.0, 2.0, 0.0, 0.0, 0.0, 41.0, 6.0, 8.0, 3.0, 33.0, 0.0, 0.0, 0.0, 3.0, 6.0, 2.0, 6.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 23.0, 10.0, 15.0, 12.0, 57.0, 0.0, 14.0, 86.0, 0.0, 6.0, 8.0, 5.0, 0.0, 7.0, 6.0, 58.0, 51.0, 0.0, 7.0, 0.0, 29.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 2.0, 25.0, 0.0, 5.0, 14.0, 0.0, 0.0, 14.0, 22.0, 5.0, 0.0, 0.0, 5.0, 0.0, 0.0, 10.0, 13.0, 15.0, 14.0, 0.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 33.0, 11.0, 0.0, 0.0, 5.0, 0.0, 0.0, 4.0, 17.0, 0.0, 12.0, 11.0, 156.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 1.0, 0.0, 0.0, 6.0, 0.0, 0.0, 51.0, 25.0, 1.0, 0.0, 0.0, 198.0, 0.0, 0.0, 0.0, 2.0, 12.0, 1.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 200.0, 9.0, 7.0, 0.0, 0.0, 0.0, 4.0, 8.0, 0.0, 10.0, 2.0, 19.0, 2.0, 6.0, 3.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 1.0, 0.0, 20.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 165.0, 9.0, 0.0, 180.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.66410073305847, "mean_inference_ms": 59.96080735157124, "mean_action_processing_ms": 8.746555719774076, "mean_env_wait_ms": 7.515152616916152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006750822067260742, "StateBufferConnector_ms": 0.0034580230712890625, "ViewRequirementAgentConnector_ms": 0.11178719997406006}, "num_episodes": 22, "episode_return_max": 67.0, "episode_return_min": -565.0, "episode_return_mean": -16.86, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2288000, "num_agent_steps_trained": 2288000, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.63675279847894, "num_env_steps_trained_throughput_per_sec": 309.63675279847894, "timesteps_total": 572000, "num_env_steps_sampled_lifetime": 572000, "num_agent_steps_sampled_lifetime": 2288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2288000, "timers": {"training_iteration_time_ms": 13530.888, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13530.824, "sample_time_ms": 1669.462, "learn_time_ms": 11836.313, "learn_throughput": 337.943, "synch_weights_time_ms": 20.349}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 2288000, "num_agent_steps_trained": 2288000}, "done": false, "training_iteration": 143, "trial_id": "f6b99_00000", "date": "2024-08-13_23-12-00", "timestamp": 1723605120, "time_this_iter_s": 12.958607196807861, "time_total_s": 12417.78099155426, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6d718b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12417.78099155426, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 51.31052631578948, "ram_util_percent": 83.8157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1683416999994762, "cur_kl_coeff": 8.486676961183544e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6425856905560645, "policy_loss": -0.0009482418652623891, "vf_loss": 0.6435339333203735, "vf_explained_var": 0.008898297251847686, "kl": 0.016966348508282842, "entropy": 0.4351838954384365, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 271215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0498461779818018, "cur_kl_coeff": 8.486676961183544e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.043352932266142, "policy_loss": -0.0008259091201046157, "vf_loss": 1.0441788407702925, "vf_explained_var": 0.004420069695780517, "kl": 0.0027676775908791686, "entropy": 0.18973096953655677, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 271215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000}, "env_runners": {"episode_reward_max": 59.0, "episode_reward_min": -573.0, "episode_reward_mean": -21.52, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 62.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -21.415, "predator_policy": 10.655}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, -1.0, -7.0, -5.0, -17.0, -26.0, -86.0, -14.0, 3.0, -12.0, -15.0, -7.0, -12.0, -2.0, 0.0, 0.0, -6.0, -2.0, -25.0, -3.0, 0.0, 26.0, -4.0, -4.0, 0.0, 9.0, -9.0, 0.0, -4.0, -1.0, 0.0, 0.0, -98.0, 0.0, 10.0, -4.0, 56.0, 2.0, -156.0, 27.0, 0.0, 0.0, 42.0, -7.0, 23.0, 3.0, 59.0, -50.0, -5.0, 0.0, -197.0, 1.0, -4.0, -1.0, -2.0, 2.0, 0.0, 0.0, -5.0, -565.0, -14.0, 0.0, 0.0, 0.0, -12.0, -17.0, -9.0, 12.0, -9.0, 0.0, 3.0, -20.0, 11.0, 0.0, 0.0, 7.0, 0.0, -236.0, -179.0, 12.0, 0.0, -1.0, -22.0, 0.0, 16.0, 0.0, 0.0, -16.0, -21.0, -573.0, 4.0, 25.0, -11.0, 0.0, 0.0, 0.0, -6.0, -3.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -4.0, 2.0, 0.0, 0.0, 3.0, -8.0, -30.0, 0.0, -30.0, 0.0, -6.0, -80.0, -12.0, -28.0, -172.0, 0.0, -8.0, -20.0, 0.0, -2.0, -11.0, -14.0, -22.0, -102.0, 0.0, -14.0, 0.0, -41.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, -10.0, -2.0, -4.0, 0.0, 0.0, -50.0, -12.0, -10.0, 0.0, 0.0, -4.0, -6.0, -9.0, 0.0, 1.0, -10.0, 0.0, 0.0, -9.0, -5.0, -15.0, -23.0, 0.0, 0.0, -8.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, 0.0, -68.0, -74.0, 0.0, 0.0, 0.0, 5.0, -8.0, 0.0, 0.0, 39.0, -13.0, -8.0, -20.0, -292.0, 0.0, 27.0, 0.0, 0.0, 0.0, 0.0, 0.0, 42.0, -14.0, 0.0, 22.0, 0.0, 3.0, 0.0, 62.0, -9.0, 0.0, -101.0, -2.0, -29.0, 0.0, 0.0, -396.0, 1.0, 1.0, 0.0, -16.0, -2.0, -2.0, 0.0, -4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, -400.0, -365.0, -30.0, 0.0, 0.0, 0.0, 0.0, -4.0, -8.0, 0.0, -24.0, 0.0, -24.0, -14.0, -12.0, -6.0, 12.0, 0.0, -22.0, 0.0, 0.0, 0.0, 0.0, 2.0, -40.0, 0.0, -10.0, 16.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, -70.0, -340.0, -19.0, -340.0, 0.0, 12.0, 0.0, 0.0, -2.0, 0.0, 14.0, -82.0, 0.0, 0.0, 9.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, -41.0, -32.0, -12.0, -394.0, -380.0, 0.0, 4.0, 0.0, 19.0, -21.0, -22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, -8.0, 1.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 0.0, 23.0, 10.0, 15.0, 12.0, 57.0, 0.0, 14.0, 86.0, 0.0, 6.0, 8.0, 5.0, 0.0, 7.0, 6.0, 58.0, 51.0, 0.0, 7.0, 0.0, 29.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 2.0, 25.0, 0.0, 5.0, 14.0, 0.0, 0.0, 14.0, 22.0, 5.0, 0.0, 0.0, 5.0, 0.0, 0.0, 10.0, 13.0, 15.0, 14.0, 0.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 33.0, 11.0, 0.0, 0.0, 5.0, 0.0, 0.0, 4.0, 17.0, 0.0, 12.0, 11.0, 156.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 1.0, 0.0, 0.0, 6.0, 0.0, 0.0, 51.0, 25.0, 1.0, 0.0, 0.0, 198.0, 0.0, 0.0, 0.0, 2.0, 12.0, 1.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 200.0, 9.0, 7.0, 0.0, 0.0, 0.0, 4.0, 8.0, 0.0, 10.0, 2.0, 19.0, 2.0, 6.0, 3.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 1.0, 0.0, 20.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 165.0, 9.0, 0.0, 180.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 41.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 25.0, 0.0, 7.0, 16.0, 200.0, 1.0, 0.0, 0.0, 0.0, 6.0, 17.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 4.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.44597014139002, "mean_inference_ms": 59.58927333251489, "mean_action_processing_ms": 8.6921462174533, "mean_env_wait_ms": 7.468383492362302, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006376504898071289, "StateBufferConnector_ms": 0.0034879446029663086, "ViewRequirementAgentConnector_ms": 0.11311614513397217}, "num_episodes": 18, "episode_return_max": 59.0, "episode_return_min": -573.0, "episode_return_mean": -21.52, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.2939022278572, "num_env_steps_trained_throughput_per_sec": 304.2939022278572, "timesteps_total": 576000, "num_env_steps_sampled_lifetime": 576000, "num_agent_steps_sampled_lifetime": 2304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2304000, "timers": {"training_iteration_time_ms": 13407.031, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13406.971, "sample_time_ms": 1607.69, "learn_time_ms": 11773.757, "learn_throughput": 339.739, "synch_weights_time_ms": 20.785}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000}, "done": false, "training_iteration": 144, "trial_id": "f6b99_00000", "date": "2024-08-13_23-12-13", "timestamp": 1723605133, "time_this_iter_s": 13.20357084274292, "time_total_s": 12430.984562397003, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6219430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12430.984562397003, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 51.03333333333333, "ram_util_percent": 83.75555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.093642762626605, "cur_kl_coeff": 8.486676961183544e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.168649685493222, "policy_loss": -0.0018014927627518773, "vf_loss": 1.1704511747316078, "vf_explained_var": 0.009812116244482616, "kl": 0.012703846071809473, "entropy": 0.37688075683261985, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 273105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0862172403978922, "cur_kl_coeff": 4.243338480591772e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2135918582558, "policy_loss": -0.0032526826609182297, "vf_loss": 1.2168445429473957, "vf_explained_var": 0.0030293841841359617, "kl": 0.0042816025406092004, "entropy": 0.24500806877222012, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 273105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000}, "env_runners": {"episode_reward_max": 59.0, "episode_reward_min": -573.0, "episode_reward_mean": -21.94, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 62.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -21.43, "predator_policy": 10.46}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.0, -2.0, -25.0, -3.0, 0.0, 26.0, -4.0, -4.0, 0.0, 9.0, -9.0, 0.0, -4.0, -1.0, 0.0, 0.0, -98.0, 0.0, 10.0, -4.0, 56.0, 2.0, -156.0, 27.0, 0.0, 0.0, 42.0, -7.0, 23.0, 3.0, 59.0, -50.0, -5.0, 0.0, -197.0, 1.0, -4.0, -1.0, -2.0, 2.0, 0.0, 0.0, -5.0, -565.0, -14.0, 0.0, 0.0, 0.0, -12.0, -17.0, -9.0, 12.0, -9.0, 0.0, 3.0, -20.0, 11.0, 0.0, 0.0, 7.0, 0.0, -236.0, -179.0, 12.0, 0.0, -1.0, -22.0, 0.0, 16.0, 0.0, 0.0, -16.0, -21.0, -573.0, 4.0, 25.0, -11.0, 0.0, 0.0, 0.0, -6.0, -3.0, -5.0, -7.0, -197.0, 1.0, -5.0, 0.0, -5.0, 12.0, 26.0, -15.0, 0.0, 0.0, 0.0, -33.0, 0.0, 0.0, 1.0, -16.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-10.0, -2.0, -4.0, 0.0, 0.0, -50.0, -12.0, -10.0, 0.0, 0.0, -4.0, -6.0, -9.0, 0.0, 1.0, -10.0, 0.0, 0.0, -9.0, -5.0, -15.0, -23.0, 0.0, 0.0, -8.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, 0.0, -68.0, -74.0, 0.0, 0.0, 0.0, 5.0, -8.0, 0.0, 0.0, 39.0, -13.0, -8.0, -20.0, -292.0, 0.0, 27.0, 0.0, 0.0, 0.0, 0.0, 0.0, 42.0, -14.0, 0.0, 22.0, 0.0, 3.0, 0.0, 62.0, -9.0, 0.0, -101.0, -2.0, -29.0, 0.0, 0.0, -396.0, 1.0, 1.0, 0.0, -16.0, -2.0, -2.0, 0.0, -4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, -400.0, -365.0, -30.0, 0.0, 0.0, 0.0, 0.0, -4.0, -8.0, 0.0, -24.0, 0.0, -24.0, -14.0, -12.0, -6.0, 12.0, 0.0, -22.0, 0.0, 0.0, 0.0, 0.0, 2.0, -40.0, 0.0, -10.0, 16.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, -70.0, -340.0, -19.0, -340.0, 0.0, 12.0, 0.0, 0.0, -2.0, 0.0, 14.0, -82.0, 0.0, 0.0, 9.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, -41.0, -32.0, -12.0, -394.0, -380.0, 0.0, 4.0, 0.0, 19.0, -21.0, -22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, -8.0, 1.0, 0.0, -10.0, 14.0, -53.0, -394.0, 0.0, 1.0, 0.0, 0.0, -45.0, 0.0, 0.0, 0.0, -16.0, 10.0, 0.0, 0.0, 26.0, -42.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -70.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, -26.0, -10.0], "policy_predator_policy_reward": [6.0, 0.0, 0.0, 2.0, 25.0, 0.0, 5.0, 14.0, 0.0, 0.0, 14.0, 22.0, 5.0, 0.0, 0.0, 5.0, 0.0, 0.0, 10.0, 13.0, 15.0, 14.0, 0.0, 0.0, 0.0, 4.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 33.0, 11.0, 0.0, 0.0, 5.0, 0.0, 0.0, 4.0, 17.0, 0.0, 12.0, 11.0, 156.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 1.0, 0.0, 0.0, 6.0, 0.0, 0.0, 51.0, 25.0, 1.0, 0.0, 0.0, 198.0, 0.0, 0.0, 0.0, 2.0, 12.0, 1.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 200.0, 9.0, 7.0, 0.0, 0.0, 0.0, 4.0, 8.0, 0.0, 10.0, 2.0, 19.0, 2.0, 6.0, 3.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 1.0, 0.0, 20.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 165.0, 9.0, 0.0, 180.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 41.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 25.0, 0.0, 7.0, 16.0, 200.0, 1.0, 0.0, 0.0, 0.0, 6.0, 17.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 4.0, 5.0, 0.0, 32.0, 0.0, 0.0, 197.0, 0.0, 0.0, 24.0, 16.0, 0.0, 0.0, 10.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 23.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 37.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.23088254519067, "mean_inference_ms": 59.222921376152534, "mean_action_processing_ms": 8.638523812088529, "mean_env_wait_ms": 7.422287353856477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006023526191711426, "StateBufferConnector_ms": 0.0035289525985717773, "ViewRequirementAgentConnector_ms": 0.12264883518218994}, "num_episodes": 18, "episode_return_max": 59.0, "episode_return_min": -573.0, "episode_return_mean": -21.94, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.77157336390474, "num_env_steps_trained_throughput_per_sec": 307.77157336390474, "timesteps_total": 580000, "num_env_steps_sampled_lifetime": 580000, "num_agent_steps_sampled_lifetime": 2320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2320000, "timers": {"training_iteration_time_ms": 13307.539, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13307.48, "sample_time_ms": 1599.748, "learn_time_ms": 11683.285, "learn_throughput": 342.369, "synch_weights_time_ms": 19.973}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000}, "done": false, "training_iteration": 145, "trial_id": "f6b99_00000", "date": "2024-08-13_23-12-26", "timestamp": 1723605146, "time_this_iter_s": 13.031621217727661, "time_total_s": 12444.01618361473, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6ef8430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12444.01618361473, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 49.61052631578947, "ram_util_percent": 83.61578947368422}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8961637500890348, "cur_kl_coeff": 8.486676961183544e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8636220912927042, "policy_loss": -0.001872619086748393, "vf_loss": 0.8654947082122798, "vf_explained_var": 0.023698643275669642, "kl": 0.014708662340507979, "entropy": 0.3975817303178172, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 274995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9802239854105566, "cur_kl_coeff": 2.121669240295886e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0367622070211582, "policy_loss": -0.0019293688121867715, "vf_loss": 1.038691576290383, "vf_explained_var": -0.003664635728906702, "kl": 0.0019938912824444223, "entropy": 0.21313097000752806, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 274995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 2336000, "num_agent_steps_trained": 2336000}, "env_runners": {"episode_reward_max": 59.0, "episode_reward_min": -573.0, "episode_reward_mean": -24.42, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 62.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -24.155, "predator_policy": 11.945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.0, 0.0, 0.0, 42.0, -7.0, 23.0, 3.0, 59.0, -50.0, -5.0, 0.0, -197.0, 1.0, -4.0, -1.0, -2.0, 2.0, 0.0, 0.0, -5.0, -565.0, -14.0, 0.0, 0.0, 0.0, -12.0, -17.0, -9.0, 12.0, -9.0, 0.0, 3.0, -20.0, 11.0, 0.0, 0.0, 7.0, 0.0, -236.0, -179.0, 12.0, 0.0, -1.0, -22.0, 0.0, 16.0, 0.0, 0.0, -16.0, -21.0, -573.0, 4.0, 25.0, -11.0, 0.0, 0.0, 0.0, -6.0, -3.0, -5.0, -7.0, -197.0, 1.0, -5.0, 0.0, -5.0, 12.0, 26.0, -15.0, 0.0, 0.0, 0.0, -33.0, 0.0, 0.0, 1.0, -16.0, 50.0, -2.0, -10.0, -92.0, 0.0, 0.0, 0.0, -199.0, 14.0, -38.0, -9.0, -165.0, 46.0, 0.0, -12.0, 0.0, -12.0, -31.0, 0.0, -1.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 27.0, 0.0, 0.0, 0.0, 0.0, 0.0, 42.0, -14.0, 0.0, 22.0, 0.0, 3.0, 0.0, 62.0, -9.0, 0.0, -101.0, -2.0, -29.0, 0.0, 0.0, -396.0, 1.0, 1.0, 0.0, -16.0, -2.0, -2.0, 0.0, -4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, -400.0, -365.0, -30.0, 0.0, 0.0, 0.0, 0.0, -4.0, -8.0, 0.0, -24.0, 0.0, -24.0, -14.0, -12.0, -6.0, 12.0, 0.0, -22.0, 0.0, 0.0, 0.0, 0.0, 2.0, -40.0, 0.0, -10.0, 16.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, -70.0, -340.0, -19.0, -340.0, 0.0, 12.0, 0.0, 0.0, -2.0, 0.0, 14.0, -82.0, 0.0, 0.0, 9.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, -41.0, -32.0, -12.0, -394.0, -380.0, 0.0, 4.0, 0.0, 19.0, -21.0, -22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, -8.0, 1.0, 0.0, -10.0, 14.0, -53.0, -394.0, 0.0, 1.0, 0.0, 0.0, -45.0, 0.0, 0.0, 0.0, -16.0, 10.0, 0.0, 0.0, 26.0, -42.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -70.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, -26.0, -10.0, 50.0, 0.0, 0.0, -4.0, 0.0, -35.0, -228.0, 19.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -398.0, 0.0, 0.0, 11.0, -111.0, -8.0, 0.0, -18.0, -330.0, 0.0, 46.0, 0.0, 0.0, 0.0, -86.0, 0.0, 0.0, 0.0, 0.0, -24.0, -18.0, -26.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 1.0, 0.0, 0.0, 6.0, 0.0, 0.0, 51.0, 25.0, 1.0, 0.0, 0.0, 198.0, 0.0, 0.0, 0.0, 2.0, 12.0, 1.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 200.0, 9.0, 7.0, 0.0, 0.0, 0.0, 4.0, 8.0, 0.0, 10.0, 2.0, 19.0, 2.0, 6.0, 3.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 1.0, 0.0, 20.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 165.0, 9.0, 0.0, 180.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 41.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 25.0, 0.0, 7.0, 16.0, 200.0, 1.0, 0.0, 0.0, 0.0, 6.0, 17.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 4.0, 5.0, 0.0, 32.0, 0.0, 0.0, 197.0, 0.0, 0.0, 24.0, 16.0, 0.0, 0.0, 10.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 23.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 37.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 8.0, 0.0, 0.0, 2.0, 0.0, 25.0, 0.0, 114.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 199.0, 0.0, 0.0, 3.0, 7.0, 74.0, 2.0, 7.0, 165.0, 0.0, 0.0, 0.0, 0.0, 0.0, 35.0, 39.0, 0.0, 0.0, 0.0, 12.0, 0.0, 13.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.95440882367062, "mean_inference_ms": 58.762283445167796, "mean_action_processing_ms": 8.565677072924604, "mean_env_wait_ms": 7.3709467652468605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004186153411865234, "StateBufferConnector_ms": 0.005157470703125, "ViewRequirementAgentConnector_ms": 0.1330786943435669}, "num_episodes": 23, "episode_return_max": 59.0, "episode_return_min": -573.0, "episode_return_mean": -24.42, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2336000, "num_agent_steps_trained": 2336000, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.33449611469945, "num_env_steps_trained_throughput_per_sec": 302.33449611469945, "timesteps_total": 584000, "num_env_steps_sampled_lifetime": 584000, "num_agent_steps_sampled_lifetime": 2336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2336000, "timers": {"training_iteration_time_ms": 13244.835, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13244.778, "sample_time_ms": 1581.659, "learn_time_ms": 11640.4, "learn_throughput": 343.631, "synch_weights_time_ms": 18.428}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 2336000, "num_agent_steps_trained": 2336000}, "done": false, "training_iteration": 146, "trial_id": "f6b99_00000", "date": "2024-08-13_23-12-40", "timestamp": 1723605160, "time_this_iter_s": 13.279404163360596, "time_total_s": 12457.295587778091, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6ef8670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12457.295587778091, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 51.484210526315785, "ram_util_percent": 83.76315789473684}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.880489735628562, "cur_kl_coeff": 8.486676961183544e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6944381503831774, "policy_loss": -0.002651050941594852, "vf_loss": 1.6970892036718035, "vf_explained_var": 0.05072133837553559, "kl": 0.00597749198567554, "entropy": 0.31924588406685167, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 276885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3735862361217932, "cur_kl_coeff": 1.060834620147943e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9086455870242345, "policy_loss": -0.0021885401165240973, "vf_loss": 1.9108341204110908, "vf_explained_var": -0.014518282527015322, "kl": 0.0039820532921518315, "entropy": 0.2971321936164584, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 276885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000}, "env_runners": {"episode_reward_max": 60.0, "episode_reward_min": -573.0, "episode_reward_mean": -24.26, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -398.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 50.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -25.425, "predator_policy": 13.295}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, -12.0, -17.0, -9.0, 12.0, -9.0, 0.0, 3.0, -20.0, 11.0, 0.0, 0.0, 7.0, 0.0, -236.0, -179.0, 12.0, 0.0, -1.0, -22.0, 0.0, 16.0, 0.0, 0.0, -16.0, -21.0, -573.0, 4.0, 25.0, -11.0, 0.0, 0.0, 0.0, -6.0, -3.0, -5.0, -7.0, -197.0, 1.0, -5.0, 0.0, -5.0, 12.0, 26.0, -15.0, 0.0, 0.0, 0.0, -33.0, 0.0, 0.0, 1.0, -16.0, 50.0, -2.0, -10.0, -92.0, 0.0, 0.0, 0.0, -199.0, 14.0, -38.0, -9.0, -165.0, 46.0, 0.0, -12.0, 0.0, -12.0, -31.0, 0.0, -1.0, 0.0, 0.0, 0.0, 35.0, -181.0, 3.0, 3.0, 1.0, -15.0, 0.0, 60.0, 0.0, 0.0, -3.0, -90.0, 1.0, -22.0, -67.0, -13.0, 17.0, -12.0, 28.0, -422.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, -4.0, -8.0, 0.0, -24.0, 0.0, -24.0, -14.0, -12.0, -6.0, 12.0, 0.0, -22.0, 0.0, 0.0, 0.0, 0.0, 2.0, -40.0, 0.0, -10.0, 16.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, -70.0, -340.0, -19.0, -340.0, 0.0, 12.0, 0.0, 0.0, -2.0, 0.0, 14.0, -82.0, 0.0, 0.0, 9.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, -41.0, -32.0, -12.0, -394.0, -380.0, 0.0, 4.0, 0.0, 19.0, -21.0, -22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, -8.0, 1.0, 0.0, -10.0, 14.0, -53.0, -394.0, 0.0, 1.0, 0.0, 0.0, -45.0, 0.0, 0.0, 0.0, -16.0, 10.0, 0.0, 0.0, 26.0, -42.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -70.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, -26.0, -10.0, 50.0, 0.0, 0.0, -4.0, 0.0, -35.0, -228.0, 19.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -398.0, 0.0, 0.0, 11.0, -111.0, -8.0, 0.0, -18.0, -330.0, 0.0, 46.0, 0.0, 0.0, 0.0, -86.0, 0.0, 0.0, 0.0, 0.0, -24.0, -18.0, -26.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 35.0, 0.0, 0.0, -362.0, -12.0, 5.0, 3.0, 0.0, 1.0, 0.0, -41.0, 0.0, 0.0, 0.0, 49.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, -229.0, -66.0, -2.0, 2.0, 0.0, -44.0, -61.0, -52.0, 0.0, -57.0, 17.0, -1.0, 0.0, -33.0, 0.0, 16.0, -330.0, -290.0, -10.0, 0.0, -8.0, 2.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 4.0, 8.0, 0.0, 10.0, 2.0, 19.0, 2.0, 6.0, 3.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 1.0, 0.0, 20.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 165.0, 9.0, 0.0, 180.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 41.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 25.0, 0.0, 7.0, 16.0, 200.0, 1.0, 0.0, 0.0, 0.0, 6.0, 17.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 4.0, 5.0, 0.0, 32.0, 0.0, 0.0, 197.0, 0.0, 0.0, 24.0, 16.0, 0.0, 0.0, 10.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 23.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 37.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 8.0, 0.0, 0.0, 2.0, 0.0, 25.0, 0.0, 114.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 199.0, 0.0, 0.0, 3.0, 7.0, 74.0, 2.0, 7.0, 165.0, 0.0, 0.0, 0.0, 0.0, 0.0, 35.0, 39.0, 0.0, 0.0, 0.0, 12.0, 0.0, 13.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 181.0, 0.0, 6.0, 4.0, 0.0, 0.0, 0.0, 0.0, 16.0, 10.0, 0.0, 0.0, 9.0, 2.0, 0.0, 0.0, 0.0, 0.0, 1.0, 2.0, 103.0, 102.0, 1.0, 0.0, 22.0, 0.0, 0.0, 46.0, 0.0, 44.0, 1.0, 0.0, 21.0, 0.0, 12.0, 0.0, 14.0, 184.0, 5.0, 5.0, 6.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 34.07197558082075, "mean_inference_ms": 58.08195721547776, "mean_action_processing_ms": 8.517296833433386, "mean_env_wait_ms": 7.7910807406597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004538536071777344, "StateBufferConnector_ms": 0.005594611167907715, "ViewRequirementAgentConnector_ms": 0.12181103229522705}, "num_episodes": 22, "episode_return_max": 60.0, "episode_return_min": -573.0, "episode_return_mean": -24.26, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 291.566205470144, "num_env_steps_trained_throughput_per_sec": 291.566205470144, "timesteps_total": 588000, "num_env_steps_sampled_lifetime": 588000, "num_agent_steps_sampled_lifetime": 2352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2352000, "timers": {"training_iteration_time_ms": 13228.198, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13228.141, "sample_time_ms": 1589.466, "learn_time_ms": 11616.178, "learn_throughput": 344.347, "synch_weights_time_ms": 18.338}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000}, "done": false, "training_iteration": 147, "trial_id": "f6b99_00000", "date": "2024-08-13_23-12-53", "timestamp": 1723605173, "time_this_iter_s": 13.775488138198853, "time_total_s": 12471.07107591629, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6219430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12471.07107591629, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 53.48947368421052, "ram_util_percent": 83.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.008973755383933, "cur_kl_coeff": 8.486676961183544e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.851810363486961, "policy_loss": -0.0013792745697573223, "vf_loss": 0.8531896367669105, "vf_explained_var": 0.05020193791894055, "kl": 0.006041963408799098, "entropy": 0.3074952795943886, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 278775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2606758481453335, "cur_kl_coeff": 5.304173100739715e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.796504615521226, "policy_loss": -0.004491023863936779, "vf_loss": 0.8009956433974876, "vf_explained_var": -0.000682013470029074, "kl": 0.0032623393601857297, "entropy": 0.19544901075186552, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 278775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 2368000, "num_agent_steps_trained": 2368000}, "env_runners": {"episode_reward_max": 60.0, "episode_reward_min": -573.0, "episode_reward_mean": -21.74, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -398.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 50.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -24.005, "predator_policy": 13.135}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.0, 0.0, -1.0, -22.0, 0.0, 16.0, 0.0, 0.0, -16.0, -21.0, -573.0, 4.0, 25.0, -11.0, 0.0, 0.0, 0.0, -6.0, -3.0, -5.0, -7.0, -197.0, 1.0, -5.0, 0.0, -5.0, 12.0, 26.0, -15.0, 0.0, 0.0, 0.0, -33.0, 0.0, 0.0, 1.0, -16.0, 50.0, -2.0, -10.0, -92.0, 0.0, 0.0, 0.0, -199.0, 14.0, -38.0, -9.0, -165.0, 46.0, 0.0, -12.0, 0.0, -12.0, -31.0, 0.0, -1.0, 0.0, 0.0, 0.0, 35.0, -181.0, 3.0, 3.0, 1.0, -15.0, 0.0, 60.0, 0.0, 0.0, -3.0, -90.0, 1.0, -22.0, -67.0, -13.0, 17.0, -12.0, 28.0, -422.0, 0.0, 0.0, -144.0, -5.0, 1.0, -8.0, 1.0, 6.0, 0.0, 0.0, 22.0, 0.0, 0.0, 11.0, 6.0, 11.0, -56.0, -31.0, 2.0, -13.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 12.0, 0.0, 0.0, -2.0, 0.0, 14.0, -82.0, 0.0, 0.0, 9.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, -41.0, -32.0, -12.0, -394.0, -380.0, 0.0, 4.0, 0.0, 19.0, -21.0, -22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, -8.0, 1.0, 0.0, -10.0, 14.0, -53.0, -394.0, 0.0, 1.0, 0.0, 0.0, -45.0, 0.0, 0.0, 0.0, -16.0, 10.0, 0.0, 0.0, 26.0, -42.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -70.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, -26.0, -10.0, 50.0, 0.0, 0.0, -4.0, 0.0, -35.0, -228.0, 19.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -398.0, 0.0, 0.0, 11.0, -111.0, -8.0, 0.0, -18.0, -330.0, 0.0, 46.0, 0.0, 0.0, 0.0, -86.0, 0.0, 0.0, 0.0, 0.0, -24.0, -18.0, -26.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 35.0, 0.0, 0.0, -362.0, -12.0, 5.0, 3.0, 0.0, 1.0, 0.0, -41.0, 0.0, 0.0, 0.0, 49.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, -229.0, -66.0, -2.0, 2.0, 0.0, -44.0, -61.0, -52.0, 0.0, -57.0, 17.0, -1.0, 0.0, -33.0, 0.0, 16.0, -330.0, -290.0, -10.0, 0.0, -8.0, 2.0, -290.0, 0.0, -10.0, 0.0, -18.0, 0.0, -22.0, 0.0, -14.0, 7.0, 1.0, 5.0, 0.0, 0.0, 4.0, -8.0, 1.0, 21.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, -49.0, 0.0, -3.0, -74.0, -39.0, -98.0, 0.0, 0.0, -11.0, -26.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 41.0, 5.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 25.0, 0.0, 7.0, 16.0, 200.0, 1.0, 0.0, 0.0, 0.0, 6.0, 17.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 4.0, 5.0, 0.0, 32.0, 0.0, 0.0, 197.0, 0.0, 0.0, 24.0, 16.0, 0.0, 0.0, 10.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 23.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 37.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 8.0, 0.0, 0.0, 2.0, 0.0, 25.0, 0.0, 114.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 199.0, 0.0, 0.0, 3.0, 7.0, 74.0, 2.0, 7.0, 165.0, 0.0, 0.0, 0.0, 0.0, 0.0, 35.0, 39.0, 0.0, 0.0, 0.0, 12.0, 0.0, 13.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 181.0, 0.0, 6.0, 4.0, 0.0, 0.0, 0.0, 0.0, 16.0, 10.0, 0.0, 0.0, 9.0, 2.0, 0.0, 0.0, 0.0, 0.0, 1.0, 2.0, 103.0, 102.0, 1.0, 0.0, 22.0, 0.0, 0.0, 46.0, 0.0, 44.0, 1.0, 0.0, 21.0, 0.0, 12.0, 0.0, 14.0, 184.0, 5.0, 5.0, 6.0, 0.0, 0.0, 146.0, 0.0, 5.0, 11.0, 8.0, 14.0, 0.0, 1.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 26.0, 29.0, 0.0, 14.0, 0.0, 57.0, 19.0, 48.0, 13.0, 0.0, 13.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.507759148853026, "mean_inference_ms": 57.994132658293076, "mean_action_processing_ms": 8.457509490828125, "mean_env_wait_ms": 7.268742826217156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004863142967224121, "StateBufferConnector_ms": 0.005522608757019043, "ViewRequirementAgentConnector_ms": 0.12351381778717041}, "num_episodes": 18, "episode_return_max": 60.0, "episode_return_min": -573.0, "episode_return_mean": -21.74, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2368000, "num_agent_steps_trained": 2368000, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.32602416353734, "num_env_steps_trained_throughput_per_sec": 300.32602416353734, "timesteps_total": 592000, "num_env_steps_sampled_lifetime": 592000, "num_agent_steps_sampled_lifetime": 2368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2368000, "timers": {"training_iteration_time_ms": 13183.077, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13183.005, "sample_time_ms": 1593.231, "learn_time_ms": 11567.461, "learn_throughput": 345.798, "synch_weights_time_ms": 18.071}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 2368000, "num_agent_steps_trained": 2368000}, "done": false, "training_iteration": 148, "trial_id": "f6b99_00000", "date": "2024-08-13_23-13-07", "timestamp": 1723605187, "time_this_iter_s": 13.362941980361938, "time_total_s": 12484.434017896652, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b60bae50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12484.434017896652, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 51.689473684210526, "ram_util_percent": 83.69473684210526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6306195038651663, "cur_kl_coeff": 8.486676961183544e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6888666838092148, "policy_loss": -0.0029783595116838575, "vf_loss": 0.6918450438225316, "vf_explained_var": 0.026773658662876756, "kl": 0.026168851619318458, "entropy": 0.42563702738474285, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 280665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6720495624300191, "cur_kl_coeff": 2.6520865503698574e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.731744992761582, "policy_loss": -0.003925590007935488, "vf_loss": 0.7356705852365367, "vf_explained_var": -0.000587299387290995, "kl": 0.0013510115570131676, "entropy": 0.17914368603279981, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 280665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 2384000, "num_agent_steps_trained": 2384000}, "env_runners": {"episode_reward_max": 60.0, "episode_reward_min": -422.0, "episode_reward_mean": -15.91, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -398.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 50.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -20.105, "predator_policy": 12.15}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -5.0, -7.0, -197.0, 1.0, -5.0, 0.0, -5.0, 12.0, 26.0, -15.0, 0.0, 0.0, 0.0, -33.0, 0.0, 0.0, 1.0, -16.0, 50.0, -2.0, -10.0, -92.0, 0.0, 0.0, 0.0, -199.0, 14.0, -38.0, -9.0, -165.0, 46.0, 0.0, -12.0, 0.0, -12.0, -31.0, 0.0, -1.0, 0.0, 0.0, 0.0, 35.0, -181.0, 3.0, 3.0, 1.0, -15.0, 0.0, 60.0, 0.0, 0.0, -3.0, -90.0, 1.0, -22.0, -67.0, -13.0, 17.0, -12.0, 28.0, -422.0, 0.0, 0.0, -144.0, -5.0, 1.0, -8.0, 1.0, 6.0, 0.0, 0.0, 22.0, 0.0, 0.0, 11.0, 6.0, 11.0, -56.0, -31.0, 2.0, -13.0, -21.0, 0.0, 0.0, 3.0, -2.0, -1.0, 17.0, 6.0, -9.0, -13.0, 2.0, 0.0, 31.0, 8.0, -32.0, 8.0, 0.0, -7.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-8.0, 1.0, 0.0, -10.0, 14.0, -53.0, -394.0, 0.0, 1.0, 0.0, 0.0, -45.0, 0.0, 0.0, 0.0, -16.0, 10.0, 0.0, 0.0, 26.0, -42.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -70.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, -26.0, -10.0, 50.0, 0.0, 0.0, -4.0, 0.0, -35.0, -228.0, 19.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -398.0, 0.0, 0.0, 11.0, -111.0, -8.0, 0.0, -18.0, -330.0, 0.0, 46.0, 0.0, 0.0, 0.0, -86.0, 0.0, 0.0, 0.0, 0.0, -24.0, -18.0, -26.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 35.0, 0.0, 0.0, -362.0, -12.0, 5.0, 3.0, 0.0, 1.0, 0.0, -41.0, 0.0, 0.0, 0.0, 49.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, -229.0, -66.0, -2.0, 2.0, 0.0, -44.0, -61.0, -52.0, 0.0, -57.0, 17.0, -1.0, 0.0, -33.0, 0.0, 16.0, -330.0, -290.0, -10.0, 0.0, -8.0, 2.0, -290.0, 0.0, -10.0, 0.0, -18.0, 0.0, -22.0, 0.0, -14.0, 7.0, 1.0, 5.0, 0.0, 0.0, 4.0, -8.0, 1.0, 21.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, -49.0, 0.0, -3.0, -74.0, -39.0, -98.0, 0.0, 0.0, -11.0, -26.0, 0.0, -42.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 3.0, -4.0, 0.0, -2.0, 0.0, 0.0, 17.0, 0.0, 6.0, -21.0, 0.0, 0.0, -26.0, -10.0, 0.0, 0.0, 0.0, 0.0, 28.0, 8.0, 0.0, -85.0, -7.0, 11.0, -8.0, 0.0, 0.0, -14.0, 0.0], "policy_predator_policy_reward": [0.0, 4.0, 5.0, 0.0, 32.0, 0.0, 0.0, 197.0, 0.0, 0.0, 24.0, 16.0, 0.0, 0.0, 10.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 23.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 37.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 8.0, 0.0, 0.0, 2.0, 0.0, 25.0, 0.0, 114.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 199.0, 0.0, 0.0, 3.0, 7.0, 74.0, 2.0, 7.0, 165.0, 0.0, 0.0, 0.0, 0.0, 0.0, 35.0, 39.0, 0.0, 0.0, 0.0, 12.0, 0.0, 13.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 181.0, 0.0, 6.0, 4.0, 0.0, 0.0, 0.0, 0.0, 16.0, 10.0, 0.0, 0.0, 9.0, 2.0, 0.0, 0.0, 0.0, 0.0, 1.0, 2.0, 103.0, 102.0, 1.0, 0.0, 22.0, 0.0, 0.0, 46.0, 0.0, 44.0, 1.0, 0.0, 21.0, 0.0, 12.0, 0.0, 14.0, 184.0, 5.0, 5.0, 6.0, 0.0, 0.0, 146.0, 0.0, 5.0, 11.0, 8.0, 14.0, 0.0, 1.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 26.0, 29.0, 0.0, 14.0, 0.0, 57.0, 19.0, 48.0, 13.0, 0.0, 13.0, 0.0, 21.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 2.0, 0.0, 13.0, 0.0, 12.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 13.0, 47.0, 5.0, 0.0, 0.0, 0.0, 7.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.304360525415085, "mean_inference_ms": 57.64778103453013, "mean_action_processing_ms": 8.406807144144617, "mean_env_wait_ms": 7.225075834054397, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004797697067260742, "StateBufferConnector_ms": 0.005659818649291992, "ViewRequirementAgentConnector_ms": 0.12170839309692383}, "num_episodes": 18, "episode_return_max": 60.0, "episode_return_min": -422.0, "episode_return_mean": -15.91, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2384000, "num_agent_steps_trained": 2384000, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.3991872667823, "num_env_steps_trained_throughput_per_sec": 315.3991872667823, "timesteps_total": 596000, "num_env_steps_sampled_lifetime": 596000, "num_agent_steps_sampled_lifetime": 2384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2384000, "timers": {"training_iteration_time_ms": 13160.766, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13160.678, "sample_time_ms": 1595.124, "learn_time_ms": 11543.588, "learn_throughput": 346.513, "synch_weights_time_ms": 17.331}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 2384000, "num_agent_steps_trained": 2384000}, "done": false, "training_iteration": 149, "trial_id": "f6b99_00000", "date": "2024-08-13_23-13-20", "timestamp": 1723605200, "time_this_iter_s": 12.718605995178223, "time_total_s": 12497.15262389183, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b62989d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12497.15262389183, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 50.71666666666667, "ram_util_percent": 83.68333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6787698486652324, "cur_kl_coeff": 1.2730015441775318e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7209476359543346, "policy_loss": -0.0010685123978724713, "vf_loss": 0.7220161474482328, "vf_explained_var": 0.02411451598323842, "kl": 0.005946940268441215, "entropy": 0.20732833691453809, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 282555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8138297557594284, "cur_kl_coeff": 1.3260432751849287e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7064550602079305, "policy_loss": -0.0032509033129644142, "vf_loss": 0.7097059620987801, "vf_explained_var": -0.001290161962862368, "kl": 0.0018725201666580172, "entropy": 0.1462660522136108, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 282555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "env_runners": {"episode_reward_max": 60.0, "episode_reward_min": -422.0, "episode_reward_mean": -18.9, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -398.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 49.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -23.42, "predator_policy": 13.97}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, -199.0, 14.0, -38.0, -9.0, -165.0, 46.0, 0.0, -12.0, 0.0, -12.0, -31.0, 0.0, -1.0, 0.0, 0.0, 0.0, 35.0, -181.0, 3.0, 3.0, 1.0, -15.0, 0.0, 60.0, 0.0, 0.0, -3.0, -90.0, 1.0, -22.0, -67.0, -13.0, 17.0, -12.0, 28.0, -422.0, 0.0, 0.0, -144.0, -5.0, 1.0, -8.0, 1.0, 6.0, 0.0, 0.0, 22.0, 0.0, 0.0, 11.0, 6.0, 11.0, -56.0, -31.0, 2.0, -13.0, -21.0, 0.0, 0.0, 3.0, -2.0, -1.0, 17.0, 6.0, -9.0, -13.0, 2.0, 0.0, 31.0, 8.0, -32.0, 8.0, 0.0, -7.0, 0.0, 0.0, 0.0, 18.0, 0.0, -13.0, 0.0, -18.0, -150.0, 3.0, -4.0, -271.0, -5.0, 16.0, 0.0, -22.0, -160.0, -3.0, 0.0, 0.0, -1.0, -2.0, 13.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -398.0, 0.0, 0.0, 11.0, -111.0, -8.0, 0.0, -18.0, -330.0, 0.0, 46.0, 0.0, 0.0, 0.0, -86.0, 0.0, 0.0, 0.0, 0.0, -24.0, -18.0, -26.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 35.0, 0.0, 0.0, -362.0, -12.0, 5.0, 3.0, 0.0, 1.0, 0.0, -41.0, 0.0, 0.0, 0.0, 49.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, -229.0, -66.0, -2.0, 2.0, 0.0, -44.0, -61.0, -52.0, 0.0, -57.0, 17.0, -1.0, 0.0, -33.0, 0.0, 16.0, -330.0, -290.0, -10.0, 0.0, -8.0, 2.0, -290.0, 0.0, -10.0, 0.0, -18.0, 0.0, -22.0, 0.0, -14.0, 7.0, 1.0, 5.0, 0.0, 0.0, 4.0, -8.0, 1.0, 21.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, -49.0, 0.0, -3.0, -74.0, -39.0, -98.0, 0.0, 0.0, -11.0, -26.0, 0.0, -42.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 3.0, -4.0, 0.0, -2.0, 0.0, 0.0, 17.0, 0.0, 6.0, -21.0, 0.0, 0.0, -26.0, -10.0, 0.0, 0.0, 0.0, 0.0, 28.0, 8.0, 0.0, -85.0, -7.0, 11.0, -8.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 0.0, 0.0, -10.0, -10.0, 0.0, 0.0, -50.0, 0.0, 16.0, -332.0, 0.0, 3.0, 0.0, -8.0, -352.0, -287.0, -10.0, 0.0, -1.0, 6.0, 0.0, 0.0, -85.0, -51.0, -320.0, 0.0, -2.0, -4.0, 0.0, 0.0, -8.0, 4.0, -2.0, 0.0, 0.0, -4.0, 3.0, 8.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 199.0, 0.0, 0.0, 3.0, 7.0, 74.0, 2.0, 7.0, 165.0, 0.0, 0.0, 0.0, 0.0, 0.0, 35.0, 39.0, 0.0, 0.0, 0.0, 12.0, 0.0, 13.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 181.0, 0.0, 6.0, 4.0, 0.0, 0.0, 0.0, 0.0, 16.0, 10.0, 0.0, 0.0, 9.0, 2.0, 0.0, 0.0, 0.0, 0.0, 1.0, 2.0, 103.0, 102.0, 1.0, 0.0, 22.0, 0.0, 0.0, 46.0, 0.0, 44.0, 1.0, 0.0, 21.0, 0.0, 12.0, 0.0, 14.0, 184.0, 5.0, 5.0, 6.0, 0.0, 0.0, 146.0, 0.0, 5.0, 11.0, 8.0, 14.0, 0.0, 1.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 26.0, 29.0, 0.0, 14.0, 0.0, 57.0, 19.0, 48.0, 13.0, 0.0, 13.0, 0.0, 21.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 2.0, 0.0, 13.0, 0.0, 12.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 13.0, 47.0, 5.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 32.0, 0.0, 0.0, 166.0, 0.0, 0.0, 4.0, 0.0, 184.0, 184.0, 5.0, 0.0, 0.0, 11.0, 0.0, 0.0, 57.0, 57.0, 0.0, 160.0, 2.0, 1.0, 0.0, 0.0, 0.0, 4.0, 1.0, 0.0, 2.0, 0.0, 1.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 33.53304322281826, "mean_inference_ms": 56.672247100337025, "mean_action_processing_ms": 8.743295174978789, "mean_env_wait_ms": 7.334211463927469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004774808883666992, "StateBufferConnector_ms": 0.005614519119262695, "ViewRequirementAgentConnector_ms": 0.10750412940979004}, "num_episodes": 23, "episode_return_max": 60.0, "episode_return_min": -422.0, "episode_return_mean": -18.9, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.1213755277221, "num_env_steps_trained_throughput_per_sec": 305.1213755277221, "timesteps_total": 600000, "num_env_steps_sampled_lifetime": 600000, "num_agent_steps_sampled_lifetime": 2400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2400000, "timers": {"training_iteration_time_ms": 13132.307, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13132.218, "sample_time_ms": 1586.118, "learn_time_ms": 11524.45, "learn_throughput": 347.088, "synch_weights_time_ms": 17.31}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "done": false, "training_iteration": 150, "trial_id": "f6b99_00000", "date": "2024-08-13_23-13-33", "timestamp": 1723605213, "time_this_iter_s": 13.14081883430481, "time_total_s": 12510.293442726135, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6219430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12510.293442726135, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 49.95263157894737, "ram_util_percent": 83.74736842105263}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7751619420827381, "cur_kl_coeff": 1.2730015441775318e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0870938700027566, "policy_loss": -0.0015693826688374713, "vf_loss": 1.0886632529989122, "vf_explained_var": 0.03853698470605114, "kl": 0.010814640792589444, "entropy": 0.30388318219828225, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 284445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.718534487385362, "cur_kl_coeff": 6.630216375924643e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.113153592560184, "policy_loss": -0.002005938432923464, "vf_loss": 1.1151595306459559, "vf_explained_var": 0.004083267784623242, "kl": 0.0018410327845985752, "entropy": 0.16589685523557285, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 284445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 2416000, "num_agent_steps_trained": 2416000}, "env_runners": {"episode_reward_max": 60.0, "episode_reward_min": -422.0, "episode_reward_mean": -18.8, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 49.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -23.04, "predator_policy": 13.64}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 35.0, -181.0, 3.0, 3.0, 1.0, -15.0, 0.0, 60.0, 0.0, 0.0, -3.0, -90.0, 1.0, -22.0, -67.0, -13.0, 17.0, -12.0, 28.0, -422.0, 0.0, 0.0, -144.0, -5.0, 1.0, -8.0, 1.0, 6.0, 0.0, 0.0, 22.0, 0.0, 0.0, 11.0, 6.0, 11.0, -56.0, -31.0, 2.0, -13.0, -21.0, 0.0, 0.0, 3.0, -2.0, -1.0, 17.0, 6.0, -9.0, -13.0, 2.0, 0.0, 31.0, 8.0, -32.0, 8.0, 0.0, -7.0, 0.0, 0.0, 0.0, 18.0, 0.0, -13.0, 0.0, -18.0, -150.0, 3.0, -4.0, -271.0, -5.0, 16.0, 0.0, -22.0, -160.0, -3.0, 0.0, 0.0, -1.0, -2.0, 13.0, 8.0, -191.0, 0.0, 4.0, 0.0, 8.0, 0.0, -7.0, 2.0, -4.0, 7.0, 2.0, -9.0, 0.0, -14.0, -2.0, -197.0, -4.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 35.0, 0.0, 0.0, -362.0, -12.0, 5.0, 3.0, 0.0, 1.0, 0.0, -41.0, 0.0, 0.0, 0.0, 49.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, -229.0, -66.0, -2.0, 2.0, 0.0, -44.0, -61.0, -52.0, 0.0, -57.0, 17.0, -1.0, 0.0, -33.0, 0.0, 16.0, -330.0, -290.0, -10.0, 0.0, -8.0, 2.0, -290.0, 0.0, -10.0, 0.0, -18.0, 0.0, -22.0, 0.0, -14.0, 7.0, 1.0, 5.0, 0.0, 0.0, 4.0, -8.0, 1.0, 21.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, -49.0, 0.0, -3.0, -74.0, -39.0, -98.0, 0.0, 0.0, -11.0, -26.0, 0.0, -42.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 3.0, -4.0, 0.0, -2.0, 0.0, 0.0, 17.0, 0.0, 6.0, -21.0, 0.0, 0.0, -26.0, -10.0, 0.0, 0.0, 0.0, 0.0, 28.0, 8.0, 0.0, -85.0, -7.0, 11.0, -8.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 0.0, 0.0, -10.0, -10.0, 0.0, 0.0, -50.0, 0.0, 16.0, -332.0, 0.0, 3.0, 0.0, -8.0, -352.0, -287.0, -10.0, 0.0, -1.0, 6.0, 0.0, 0.0, -85.0, -51.0, -320.0, 0.0, -2.0, -4.0, 0.0, 0.0, -8.0, 4.0, -2.0, 0.0, 0.0, -4.0, 3.0, 8.0, -3.0, -4.0, -382.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 15.0, -14.0, 0.0, 0.0, -14.0, 0.0, 3.0, -2.0, 0.0, -9.0, 7.0, 0.0, 1.0, 0.0, -18.0, 0.0, 0.0, 0.0, -51.0, 0.0, -4.0, 0.0, -400.0, -9.0, 0.0, -8.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 181.0, 0.0, 6.0, 4.0, 0.0, 0.0, 0.0, 0.0, 16.0, 10.0, 0.0, 0.0, 9.0, 2.0, 0.0, 0.0, 0.0, 0.0, 1.0, 2.0, 103.0, 102.0, 1.0, 0.0, 22.0, 0.0, 0.0, 46.0, 0.0, 44.0, 1.0, 0.0, 21.0, 0.0, 12.0, 0.0, 14.0, 184.0, 5.0, 5.0, 6.0, 0.0, 0.0, 146.0, 0.0, 5.0, 11.0, 8.0, 14.0, 0.0, 1.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 26.0, 29.0, 0.0, 14.0, 0.0, 57.0, 19.0, 48.0, 13.0, 0.0, 13.0, 0.0, 21.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 2.0, 0.0, 13.0, 0.0, 12.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 13.0, 47.0, 5.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 32.0, 0.0, 0.0, 166.0, 0.0, 0.0, 4.0, 0.0, 184.0, 184.0, 5.0, 0.0, 0.0, 11.0, 0.0, 0.0, 57.0, 57.0, 0.0, 160.0, 2.0, 1.0, 0.0, 0.0, 0.0, 4.0, 1.0, 0.0, 2.0, 0.0, 1.0, 1.0, 10.0, 5.0, 191.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 2.0, 5.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 9.0, 0.0, 0.0, 0.0, 37.0, 0.0, 2.0, 12.0, 200.0, 4.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.85726216560047, "mean_inference_ms": 56.894111497038324, "mean_action_processing_ms": 8.292402546759016, "mean_env_wait_ms": 7.135051988278427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004765987396240234, "StateBufferConnector_ms": 0.00403141975402832, "ViewRequirementAgentConnector_ms": 0.10803723335266113}, "num_episodes": 18, "episode_return_max": 60.0, "episode_return_min": -422.0, "episode_return_mean": -18.8, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2416000, "num_agent_steps_trained": 2416000, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.4506676630395, "num_env_steps_trained_throughput_per_sec": 315.4506676630395, "timesteps_total": 604000, "num_env_steps_sampled_lifetime": 604000, "num_agent_steps_sampled_lifetime": 2416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2416000, "timers": {"training_iteration_time_ms": 13076.49, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13076.403, "sample_time_ms": 1585.927, "learn_time_ms": 11469.857, "learn_throughput": 348.74, "synch_weights_time_ms": 16.457}, "counters": {"num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 2416000, "num_agent_steps_trained": 2416000}, "done": false, "training_iteration": 151, "trial_id": "f6b99_00000", "date": "2024-08-13_23-13-45", "timestamp": 1723605225, "time_this_iter_s": 12.719624757766724, "time_total_s": 12523.013067483902, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6d8f1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12523.013067483902, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 49.761111111111106, "ram_util_percent": 83.6277777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.505536026062158, "cur_kl_coeff": 1.2730015441775318e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8203852201265002, "policy_loss": -0.0006314785522778355, "vf_loss": 0.821016699824699, "vf_explained_var": 0.039608302633598366, "kl": 0.031502999657070194, "entropy": 0.32691359340198456, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 286335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6329159915604918, "cur_kl_coeff": 3.315108187962322e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8615910856003957, "policy_loss": -0.0018395621243312403, "vf_loss": 0.8634306494915296, "vf_explained_var": -0.011257688015226334, "kl": 0.0025766408976882083, "entropy": 0.29370199881060416, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 286335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 2432000, "num_agent_steps_trained": 2432000}, "env_runners": {"episode_reward_max": 31.0, "episode_reward_min": -271.0, "episode_reward_mean": -16.85, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 28.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -20.86, "predator_policy": 12.435}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -144.0, -5.0, 1.0, -8.0, 1.0, 6.0, 0.0, 0.0, 22.0, 0.0, 0.0, 11.0, 6.0, 11.0, -56.0, -31.0, 2.0, -13.0, -21.0, 0.0, 0.0, 3.0, -2.0, -1.0, 17.0, 6.0, -9.0, -13.0, 2.0, 0.0, 31.0, 8.0, -32.0, 8.0, 0.0, -7.0, 0.0, 0.0, 0.0, 18.0, 0.0, -13.0, 0.0, -18.0, -150.0, 3.0, -4.0, -271.0, -5.0, 16.0, 0.0, -22.0, -160.0, -3.0, 0.0, 0.0, -1.0, -2.0, 13.0, 8.0, -191.0, 0.0, 4.0, 0.0, 8.0, 0.0, -7.0, 2.0, -4.0, 7.0, 2.0, -9.0, 0.0, -14.0, -2.0, -197.0, -4.0, -6.0, 0.0, 0.0, -6.0, -5.0, -12.0, -200.0, 14.0, -22.0, -1.0, -6.0, 5.0, -8.0, -1.0, -11.0, -4.0, -10.0, 0.0, -206.0, -3.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-8.0, 2.0, -290.0, 0.0, -10.0, 0.0, -18.0, 0.0, -22.0, 0.0, -14.0, 7.0, 1.0, 5.0, 0.0, 0.0, 4.0, -8.0, 1.0, 21.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, -49.0, 0.0, -3.0, -74.0, -39.0, -98.0, 0.0, 0.0, -11.0, -26.0, 0.0, -42.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 3.0, -4.0, 0.0, -2.0, 0.0, 0.0, 17.0, 0.0, 6.0, -21.0, 0.0, 0.0, -26.0, -10.0, 0.0, 0.0, 0.0, 0.0, 28.0, 8.0, 0.0, -85.0, -7.0, 11.0, -8.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 0.0, 0.0, -10.0, -10.0, 0.0, 0.0, -50.0, 0.0, 16.0, -332.0, 0.0, 3.0, 0.0, -8.0, -352.0, -287.0, -10.0, 0.0, -1.0, 6.0, 0.0, 0.0, -85.0, -51.0, -320.0, 0.0, -2.0, -4.0, 0.0, 0.0, -8.0, 4.0, -2.0, 0.0, 0.0, -4.0, 3.0, 8.0, -3.0, -4.0, -382.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 15.0, -14.0, 0.0, 0.0, -14.0, 0.0, 3.0, -2.0, 0.0, -9.0, 7.0, 0.0, 1.0, 0.0, -18.0, 0.0, 0.0, 0.0, -51.0, 0.0, -4.0, 0.0, -400.0, -9.0, 0.0, -8.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, -10.0, 0.0, -30.0, 0.0, 0.0, -400.0, 0.0, 11.0, 0.0, -44.0, -6.0, -14.0, -12.0, 0.0, 11.0, -12.0, -2.0, -28.0, -2.0, -2.0, 0.0, -22.0, 0.0, -8.0, 0.0, -20.0, 0.0, 0.0, -34.0, -378.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [6.0, 0.0, 0.0, 146.0, 0.0, 5.0, 11.0, 8.0, 14.0, 0.0, 1.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 26.0, 29.0, 0.0, 14.0, 0.0, 57.0, 19.0, 48.0, 13.0, 0.0, 13.0, 0.0, 21.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 2.0, 0.0, 13.0, 0.0, 12.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 13.0, 47.0, 5.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 32.0, 0.0, 0.0, 166.0, 0.0, 0.0, 4.0, 0.0, 184.0, 184.0, 5.0, 0.0, 0.0, 11.0, 0.0, 0.0, 57.0, 57.0, 0.0, 160.0, 2.0, 1.0, 0.0, 0.0, 0.0, 4.0, 1.0, 0.0, 2.0, 0.0, 1.0, 1.0, 10.0, 5.0, 191.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 2.0, 5.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 9.0, 0.0, 0.0, 0.0, 37.0, 0.0, 2.0, 12.0, 200.0, 4.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 5.0, 0.0, 6.0, 12.0, 0.0, 200.0, 3.0, 0.0, 0.0, 22.0, 9.0, 10.0, 0.0, 6.0, 0.0, 6.0, 17.0, 5.0, 1.0, 2.0, 5.0, 6.0, 4.0, 0.0, 10.0, 0.0, 0.0, 0.0, 188.0, 18.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.62463149384046, "mean_inference_ms": 56.488942601311635, "mean_action_processing_ms": 8.238264744498702, "mean_env_wait_ms": 7.077621092144052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004751443862915039, "StateBufferConnector_ms": 0.0036276578903198242, "ViewRequirementAgentConnector_ms": 0.11364579200744629}, "num_episodes": 22, "episode_return_max": 31.0, "episode_return_min": -271.0, "episode_return_mean": -16.85, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2432000, "num_agent_steps_trained": 2432000, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.8489300578177, "num_env_steps_trained_throughput_per_sec": 299.8489300578177, "timesteps_total": 608000, "num_env_steps_sampled_lifetime": 608000, "num_agent_steps_sampled_lifetime": 2432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2432000, "timers": {"training_iteration_time_ms": 13114.074, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13113.987, "sample_time_ms": 1588.541, "learn_time_ms": 11504.167, "learn_throughput": 347.7, "synch_weights_time_ms": 17.393}, "counters": {"num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 2432000, "num_agent_steps_trained": 2432000}, "done": false, "training_iteration": 152, "trial_id": "f6b99_00000", "date": "2024-08-13_23-13-59", "timestamp": 1723605239, "time_this_iter_s": 13.372829914093018, "time_total_s": 12536.385897397995, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6d8f430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12536.385897397995, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 51.08947368421053, "ram_util_percent": 83.7842105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1143522176871854, "cur_kl_coeff": 1.9095023162662987e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9752057730993896, "policy_loss": -0.001468038523973769, "vf_loss": 0.9766738107280125, "vf_explained_var": 0.03750557300274965, "kl": 0.016029581362993584, "entropy": 0.3240234621933528, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 288225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6318604502807219, "cur_kl_coeff": 1.657554093981161e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8776126503816278, "policy_loss": -0.0019030636623649606, "vf_loss": 0.8795157113876292, "vf_explained_var": 0.003937422693091094, "kl": 0.0022816148315099004, "entropy": 0.2324836089655205, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 288225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 2448000, "num_agent_steps_trained": 2448000}, "env_runners": {"episode_reward_max": 31.0, "episode_reward_min": -271.0, "episode_reward_mean": -19.13, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 28.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -22.445, "predator_policy": 12.88}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.0, -21.0, 0.0, 0.0, 3.0, -2.0, -1.0, 17.0, 6.0, -9.0, -13.0, 2.0, 0.0, 31.0, 8.0, -32.0, 8.0, 0.0, -7.0, 0.0, 0.0, 0.0, 18.0, 0.0, -13.0, 0.0, -18.0, -150.0, 3.0, -4.0, -271.0, -5.0, 16.0, 0.0, -22.0, -160.0, -3.0, 0.0, 0.0, -1.0, -2.0, 13.0, 8.0, -191.0, 0.0, 4.0, 0.0, 8.0, 0.0, -7.0, 2.0, -4.0, 7.0, 2.0, -9.0, 0.0, -14.0, -2.0, -197.0, -4.0, -6.0, 0.0, 0.0, -6.0, -5.0, -12.0, -200.0, 14.0, -22.0, -1.0, -6.0, 5.0, -8.0, -1.0, -11.0, -4.0, -10.0, 0.0, -206.0, -3.0, 0.0, 0.0, 0.0, -4.0, -3.0, -200.0, 0.0, -15.0, 0.0, 7.0, -19.0, -9.0, -8.0, 3.0, -148.0, 0.0, 0.0, 1.0, -5.0, -12.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-26.0, 0.0, -42.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 3.0, -4.0, 0.0, -2.0, 0.0, 0.0, 17.0, 0.0, 6.0, -21.0, 0.0, 0.0, -26.0, -10.0, 0.0, 0.0, 0.0, 0.0, 28.0, 8.0, 0.0, -85.0, -7.0, 11.0, -8.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 0.0, 0.0, -10.0, -10.0, 0.0, 0.0, -50.0, 0.0, 16.0, -332.0, 0.0, 3.0, 0.0, -8.0, -352.0, -287.0, -10.0, 0.0, -1.0, 6.0, 0.0, 0.0, -85.0, -51.0, -320.0, 0.0, -2.0, -4.0, 0.0, 0.0, -8.0, 4.0, -2.0, 0.0, 0.0, -4.0, 3.0, 8.0, -3.0, -4.0, -382.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 15.0, -14.0, 0.0, 0.0, -14.0, 0.0, 3.0, -2.0, 0.0, -9.0, 7.0, 0.0, 1.0, 0.0, -18.0, 0.0, 0.0, 0.0, -51.0, 0.0, -4.0, 0.0, -400.0, -9.0, 0.0, -8.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, -10.0, 0.0, -30.0, 0.0, 0.0, -400.0, 0.0, 11.0, 0.0, -44.0, -6.0, -14.0, -12.0, 0.0, 11.0, -12.0, -2.0, -28.0, -2.0, -2.0, 0.0, -22.0, 0.0, -8.0, 0.0, -20.0, 0.0, 0.0, -34.0, -378.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, -6.0, -10.0, 0.0, -8.0, 0.0, -6.0, 0.0, -400.0, 0.0, 0.0, -12.0, -22.0, 0.0, 0.0, 7.0, 0.0, 0.0, -39.0, 0.0, -29.0, -16.0, 0.0, 0.0, 0.0, -323.0, -6.0, 0.0, 0.0, 0.0, 0.0, -1.0, 0.0, 0.0, -10.0, -28.0, 0.0], "policy_predator_policy_reward": [13.0, 0.0, 21.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 2.0, 0.0, 13.0, 0.0, 12.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 13.0, 47.0, 5.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 32.0, 0.0, 0.0, 166.0, 0.0, 0.0, 4.0, 0.0, 184.0, 184.0, 5.0, 0.0, 0.0, 11.0, 0.0, 0.0, 57.0, 57.0, 0.0, 160.0, 2.0, 1.0, 0.0, 0.0, 0.0, 4.0, 1.0, 0.0, 2.0, 0.0, 1.0, 1.0, 10.0, 5.0, 191.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 2.0, 5.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 9.0, 0.0, 0.0, 0.0, 37.0, 0.0, 2.0, 12.0, 200.0, 4.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 5.0, 0.0, 6.0, 12.0, 0.0, 200.0, 3.0, 0.0, 0.0, 22.0, 9.0, 10.0, 0.0, 6.0, 0.0, 6.0, 17.0, 5.0, 1.0, 2.0, 5.0, 6.0, 4.0, 0.0, 10.0, 0.0, 0.0, 0.0, 188.0, 18.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 5.0, 11.0, 4.0, 0.0, 0.0, 3.0, 200.0, 0.0, 0.0, 0.0, 9.0, 10.0, 0.0, 0.0, 0.0, 0.0, 9.0, 11.0, 9.0, 11.0, 8.0, 0.0, 0.0, 3.0, 166.0, 15.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 5.0, 9.0, 7.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.43177080248357, "mean_inference_ms": 56.160334055778776, "mean_action_processing_ms": 8.190168861867559, "mean_env_wait_ms": 7.036227215610957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007187843322753906, "StateBufferConnector_ms": 0.0035909414291381836, "ViewRequirementAgentConnector_ms": 0.11738467216491699}, "num_episodes": 18, "episode_return_max": 31.0, "episode_return_min": -271.0, "episode_return_mean": -19.13, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2448000, "num_agent_steps_trained": 2448000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.3864598857781, "num_env_steps_trained_throughput_per_sec": 295.3864598857781, "timesteps_total": 612000, "num_env_steps_sampled_lifetime": 612000, "num_agent_steps_sampled_lifetime": 2448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2448000, "timers": {"training_iteration_time_ms": 13176.395, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13176.309, "sample_time_ms": 1584.493, "learn_time_ms": 11570.173, "learn_throughput": 345.717, "synch_weights_time_ms": 17.402}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 2448000, "num_agent_steps_trained": 2448000}, "done": false, "training_iteration": 153, "trial_id": "f6b99_00000", "date": "2024-08-13_23-14-12", "timestamp": 1723605252, "time_this_iter_s": 13.578295946121216, "time_total_s": 12549.964193344116, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6219430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12549.964193344116, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 49.24999999999999, "ram_util_percent": 83.70000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0171454148002403, "cur_kl_coeff": 1.9095023162662987e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2423633616121987, "policy_loss": -0.001816548820013407, "vf_loss": 1.2441799133542983, "vf_explained_var": 0.047499675063229115, "kl": 0.010247056956054459, "entropy": 0.27197187685619584, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 290115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8835452709958036, "cur_kl_coeff": 8.287770469905804e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0775762805863032, "policy_loss": -0.0019694253632296173, "vf_loss": 1.0795457073778072, "vf_explained_var": 0.008333617354196216, "kl": 0.0020143971162785933, "entropy": 0.2520559885987529, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 290115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 2464000, "num_agent_steps_trained": 2464000}, "env_runners": {"episode_reward_max": 19.0, "episode_reward_min": -271.0, "episode_reward_mean": -21.51, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 18.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -26.91, "predator_policy": 16.155}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.0, 0.0, 0.0, 0.0, 18.0, 0.0, -13.0, 0.0, -18.0, -150.0, 3.0, -4.0, -271.0, -5.0, 16.0, 0.0, -22.0, -160.0, -3.0, 0.0, 0.0, -1.0, -2.0, 13.0, 8.0, -191.0, 0.0, 4.0, 0.0, 8.0, 0.0, -7.0, 2.0, -4.0, 7.0, 2.0, -9.0, 0.0, -14.0, -2.0, -197.0, -4.0, -6.0, 0.0, 0.0, -6.0, -5.0, -12.0, -200.0, 14.0, -22.0, -1.0, -6.0, 5.0, -8.0, -1.0, -11.0, -4.0, -10.0, 0.0, -206.0, -3.0, 0.0, 0.0, 0.0, -4.0, -3.0, -200.0, 0.0, -15.0, 0.0, 7.0, -19.0, -9.0, -8.0, 3.0, -148.0, 0.0, 0.0, 1.0, -5.0, -12.0, -2.0, -2.0, 19.0, -4.0, -200.0, -8.0, -22.0, -3.0, -10.0, 6.0, 0.0, 1.0, 4.0, 3.0, 0.0, -12.0, -28.0, 4.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 0.0, 0.0, -10.0, -10.0, 0.0, 0.0, -50.0, 0.0, 16.0, -332.0, 0.0, 3.0, 0.0, -8.0, -352.0, -287.0, -10.0, 0.0, -1.0, 6.0, 0.0, 0.0, -85.0, -51.0, -320.0, 0.0, -2.0, -4.0, 0.0, 0.0, -8.0, 4.0, -2.0, 0.0, 0.0, -4.0, 3.0, 8.0, -3.0, -4.0, -382.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 15.0, -14.0, 0.0, 0.0, -14.0, 0.0, 3.0, -2.0, 0.0, -9.0, 7.0, 0.0, 1.0, 0.0, -18.0, 0.0, 0.0, 0.0, -51.0, 0.0, -4.0, 0.0, -400.0, -9.0, 0.0, -8.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, -10.0, 0.0, -30.0, 0.0, 0.0, -400.0, 0.0, 11.0, 0.0, -44.0, -6.0, -14.0, -12.0, 0.0, 11.0, -12.0, -2.0, -28.0, -2.0, -2.0, 0.0, -22.0, 0.0, -8.0, 0.0, -20.0, 0.0, 0.0, -34.0, -378.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, -6.0, -10.0, 0.0, -8.0, 0.0, -6.0, 0.0, -400.0, 0.0, 0.0, -12.0, -22.0, 0.0, 0.0, 7.0, 0.0, 0.0, -39.0, 0.0, -29.0, -16.0, 0.0, 0.0, 0.0, -323.0, -6.0, 0.0, 0.0, 0.0, 0.0, -1.0, 0.0, 0.0, -10.0, -28.0, 0.0, -12.0, -370.0, 0.0, -7.0, 0.0, 5.0, -9.0, 0.0, 0.0, -400.0, 0.0, -74.0, -42.0, -11.0, -6.0, 0.0, -20.0, 0.0, 16.0, -22.0, 0.0, 0.0, 0.0, 1.0, -7.0, 0.0, 0.0, -4.0, 0.0, 0.0, -11.0, -8.0, -62.0, -7.0, 11.0, -22.0], "policy_predator_policy_reward": [7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 32.0, 0.0, 0.0, 166.0, 0.0, 0.0, 4.0, 0.0, 184.0, 184.0, 5.0, 0.0, 0.0, 11.0, 0.0, 0.0, 57.0, 57.0, 0.0, 160.0, 2.0, 1.0, 0.0, 0.0, 0.0, 4.0, 1.0, 0.0, 2.0, 0.0, 1.0, 1.0, 10.0, 5.0, 191.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 2.0, 5.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 9.0, 0.0, 0.0, 0.0, 37.0, 0.0, 2.0, 12.0, 200.0, 4.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 5.0, 0.0, 6.0, 12.0, 0.0, 200.0, 3.0, 0.0, 0.0, 22.0, 9.0, 10.0, 0.0, 6.0, 0.0, 6.0, 17.0, 5.0, 1.0, 2.0, 5.0, 6.0, 4.0, 0.0, 10.0, 0.0, 0.0, 0.0, 188.0, 18.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 5.0, 11.0, 4.0, 0.0, 0.0, 3.0, 200.0, 0.0, 0.0, 0.0, 9.0, 10.0, 0.0, 0.0, 0.0, 0.0, 9.0, 11.0, 9.0, 11.0, 8.0, 0.0, 0.0, 3.0, 166.0, 15.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 5.0, 9.0, 7.0, 190.0, 190.0, 0.0, 5.0, 5.0, 9.0, 5.0, 0.0, 200.0, 0.0, 24.0, 42.0, 21.0, 10.0, 3.0, 0.0, 0.0, 10.0, 1.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 7.0, 0.0, 0.0, 0.0, 0.0, 7.0, 32.0, 9.0, 4.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.24144248870613, "mean_inference_ms": 55.83609933111549, "mean_action_processing_ms": 8.142677762380313, "mean_env_wait_ms": 6.995386155577054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007265925407409668, "StateBufferConnector_ms": 0.0035620927810668945, "ViewRequirementAgentConnector_ms": 0.12229692935943604}, "num_episodes": 18, "episode_return_max": 19.0, "episode_return_min": -271.0, "episode_return_mean": -21.51, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2464000, "num_agent_steps_trained": 2464000, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.21131770355555, "num_env_steps_trained_throughput_per_sec": 318.21131770355555, "timesteps_total": 616000, "num_env_steps_sampled_lifetime": 616000, "num_agent_steps_sampled_lifetime": 2464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2464000, "timers": {"training_iteration_time_ms": 13118.903, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13118.817, "sample_time_ms": 1570.148, "learn_time_ms": 11527.545, "learn_throughput": 346.995, "synch_weights_time_ms": 16.891}, "counters": {"num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 2464000, "num_agent_steps_trained": 2464000}, "done": false, "training_iteration": 154, "trial_id": "f6b99_00000", "date": "2024-08-13_23-14-25", "timestamp": 1723605265, "time_this_iter_s": 12.614794969558716, "time_total_s": 12562.578988313675, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6d3f430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12562.578988313675, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 50.27222222222221, "ram_util_percent": 83.63333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8297261354823907, "cur_kl_coeff": 1.9095023162662987e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.44795414602788036, "policy_loss": -0.0003886066074113524, "vf_loss": 0.4483427535222656, "vf_explained_var": 0.03647511197776391, "kl": 0.003377680695192104, "entropy": 0.11247123734108985, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 292005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8724386622350683, "cur_kl_coeff": 4.143885234952902e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6224390623184345, "policy_loss": -0.0009254688636040089, "vf_loss": 0.6233645319921721, "vf_explained_var": 0.0031060636358917074, "kl": 0.001764649228381487, "entropy": 0.26503217847889693, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 292005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000}, "env_runners": {"episode_reward_max": 19.0, "episode_reward_min": -370.0, "episode_reward_mean": -21.36, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 16.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -25.095, "predator_policy": 14.415}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.0, 8.0, -191.0, 0.0, 4.0, 0.0, 8.0, 0.0, -7.0, 2.0, -4.0, 7.0, 2.0, -9.0, 0.0, -14.0, -2.0, -197.0, -4.0, -6.0, 0.0, 0.0, -6.0, -5.0, -12.0, -200.0, 14.0, -22.0, -1.0, -6.0, 5.0, -8.0, -1.0, -11.0, -4.0, -10.0, 0.0, -206.0, -3.0, 0.0, 0.0, 0.0, -4.0, -3.0, -200.0, 0.0, -15.0, 0.0, 7.0, -19.0, -9.0, -8.0, 3.0, -148.0, 0.0, 0.0, 1.0, -5.0, -12.0, -2.0, -2.0, 19.0, -4.0, -200.0, -8.0, -22.0, -3.0, -10.0, 6.0, 0.0, 1.0, 4.0, 3.0, 0.0, -12.0, -28.0, 4.0, -19.0, 0.0, 5.0, 11.0, -71.0, 0.0, 14.0, -370.0, -128.0, 0.0, 6.0, 0.0, 6.0, 0.0, -8.0, -16.0, 0.0, -9.0, 0.0, -8.0, -17.0, 10.0, -10.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [3.0, 8.0, -3.0, -4.0, -382.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 15.0, -14.0, 0.0, 0.0, -14.0, 0.0, 3.0, -2.0, 0.0, -9.0, 7.0, 0.0, 1.0, 0.0, -18.0, 0.0, 0.0, 0.0, -51.0, 0.0, -4.0, 0.0, -400.0, -9.0, 0.0, -8.0, -12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, -10.0, 0.0, -30.0, 0.0, 0.0, -400.0, 0.0, 11.0, 0.0, -44.0, -6.0, -14.0, -12.0, 0.0, 11.0, -12.0, -2.0, -28.0, -2.0, -2.0, 0.0, -22.0, 0.0, -8.0, 0.0, -20.0, 0.0, 0.0, -34.0, -378.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, -6.0, -10.0, 0.0, -8.0, 0.0, -6.0, 0.0, -400.0, 0.0, 0.0, -12.0, -22.0, 0.0, 0.0, 7.0, 0.0, 0.0, -39.0, 0.0, -29.0, -16.0, 0.0, 0.0, 0.0, -323.0, -6.0, 0.0, 0.0, 0.0, 0.0, -1.0, 0.0, 0.0, -10.0, -28.0, 0.0, -12.0, -370.0, 0.0, -7.0, 0.0, 5.0, -9.0, 0.0, 0.0, -400.0, 0.0, -74.0, -42.0, -11.0, -6.0, 0.0, -20.0, 0.0, 16.0, -22.0, 0.0, 0.0, 0.0, 1.0, -7.0, 0.0, 0.0, -4.0, 0.0, 0.0, -11.0, -8.0, -62.0, -7.0, 11.0, -22.0, -25.0, -27.0, 0.0, 0.0, 5.0, 0.0, 9.0, 0.0, -144.0, 0.0, 0.0, 0.0, -8.0, 16.0, -312.0, -248.0, -264.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, 9.0, -8.0, 0.0, 0.0, 9.0, -40.0, -15.0, -20.0, 0.0, 0.0, 0.0, -19.0, 0.0, 0.0, -4.0, -11.0, -14.0, -10.0, 10.0, 0.0, -16.0, -7.0], "policy_predator_policy_reward": [1.0, 1.0, 10.0, 5.0, 191.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 2.0, 5.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 9.0, 0.0, 0.0, 0.0, 37.0, 0.0, 2.0, 12.0, 200.0, 4.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 5.0, 0.0, 6.0, 12.0, 0.0, 200.0, 3.0, 0.0, 0.0, 22.0, 9.0, 10.0, 0.0, 6.0, 0.0, 6.0, 17.0, 5.0, 1.0, 2.0, 5.0, 6.0, 4.0, 0.0, 10.0, 0.0, 0.0, 0.0, 188.0, 18.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 5.0, 11.0, 4.0, 0.0, 0.0, 3.0, 200.0, 0.0, 0.0, 0.0, 9.0, 10.0, 0.0, 0.0, 0.0, 0.0, 9.0, 11.0, 9.0, 11.0, 8.0, 0.0, 0.0, 3.0, 166.0, 15.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 5.0, 9.0, 7.0, 190.0, 190.0, 0.0, 5.0, 5.0, 9.0, 5.0, 0.0, 200.0, 0.0, 24.0, 42.0, 21.0, 10.0, 3.0, 0.0, 0.0, 10.0, 1.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 7.0, 0.0, 0.0, 0.0, 0.0, 7.0, 32.0, 9.0, 4.0, 11.0, 8.0, 25.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 73.0, 0.0, 0.0, 2.0, 4.0, 0.0, 190.0, 124.0, 12.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 12.0, 11.0, 12.0, 7.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 7.0, 0.0, 0.0, 7.0, 0.0, 0.0, 6.0, 7.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.996569277967804, "mean_inference_ms": 55.42804536193911, "mean_action_processing_ms": 8.078100231886845, "mean_env_wait_ms": 6.949834333722196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007262706756591797, "StateBufferConnector_ms": 0.0035974979400634766, "ViewRequirementAgentConnector_ms": 0.12997257709503174}, "num_episodes": 23, "episode_return_max": 19.0, "episode_return_min": -370.0, "episode_return_mean": -21.36, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.1832065430847, "num_env_steps_trained_throughput_per_sec": 307.1832065430847, "timesteps_total": 620000, "num_env_steps_sampled_lifetime": 620000, "num_agent_steps_sampled_lifetime": 2480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2480000, "timers": {"training_iteration_time_ms": 13121.393, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13121.305, "sample_time_ms": 1566.604, "learn_time_ms": 11533.323, "learn_throughput": 346.821, "synch_weights_time_ms": 16.857}, "counters": {"num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000}, "done": false, "training_iteration": 155, "trial_id": "f6b99_00000", "date": "2024-08-13_23-14-38", "timestamp": 1723605278, "time_this_iter_s": 13.056652784347534, "time_total_s": 12575.635641098022, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6d3fd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12575.635641098022, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 49.238888888888894, "ram_util_percent": 83.82222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8266180148594594, "cur_kl_coeff": 9.547511581331493e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7323016458402866, "policy_loss": -0.001410116097106347, "vf_loss": 0.7337117615752119, "vf_explained_var": 0.03175357491881759, "kl": 0.003151812333971923, "entropy": 0.11283632468767267, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 293895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8490156446342115, "cur_kl_coeff": 2.071942617476451e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6958063057579454, "policy_loss": -0.001738837791887659, "vf_loss": 0.6975451427792746, "vf_explained_var": -0.005371773053729345, "kl": 0.0026393970730230307, "entropy": 0.27077271019024823, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 293895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 2496000, "num_agent_steps_trained": 2496000}, "env_runners": {"episode_reward_max": 19.0, "episode_reward_min": -370.0, "episode_reward_mean": -19.26, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 16.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -22.695, "predator_policy": 13.065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.0, -5.0, -12.0, -200.0, 14.0, -22.0, -1.0, -6.0, 5.0, -8.0, -1.0, -11.0, -4.0, -10.0, 0.0, -206.0, -3.0, 0.0, 0.0, 0.0, -4.0, -3.0, -200.0, 0.0, -15.0, 0.0, 7.0, -19.0, -9.0, -8.0, 3.0, -148.0, 0.0, 0.0, 1.0, -5.0, -12.0, -2.0, -2.0, 19.0, -4.0, -200.0, -8.0, -22.0, -3.0, -10.0, 6.0, 0.0, 1.0, 4.0, 3.0, 0.0, -12.0, -28.0, 4.0, -19.0, 0.0, 5.0, 11.0, -71.0, 0.0, 14.0, -370.0, -128.0, 0.0, 6.0, 0.0, 6.0, 0.0, -8.0, -16.0, 0.0, -9.0, 0.0, -8.0, -17.0, 10.0, -10.0, 0.0, -5.0, 10.0, -6.0, 0.0, -5.0, -2.0, -7.0, 6.0, -11.0, 0.0, -4.0, -2.0, -3.0, -27.0, -119.0, 0.0, 0.0, 0.0, -5.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -12.0, -10.0, 0.0, -30.0, 0.0, 0.0, -400.0, 0.0, 11.0, 0.0, -44.0, -6.0, -14.0, -12.0, 0.0, 11.0, -12.0, -2.0, -28.0, -2.0, -2.0, 0.0, -22.0, 0.0, -8.0, 0.0, -20.0, 0.0, 0.0, -34.0, -378.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, -6.0, -10.0, 0.0, -8.0, 0.0, -6.0, 0.0, -400.0, 0.0, 0.0, -12.0, -22.0, 0.0, 0.0, 7.0, 0.0, 0.0, -39.0, 0.0, -29.0, -16.0, 0.0, 0.0, 0.0, -323.0, -6.0, 0.0, 0.0, 0.0, 0.0, -1.0, 0.0, 0.0, -10.0, -28.0, 0.0, -12.0, -370.0, 0.0, -7.0, 0.0, 5.0, -9.0, 0.0, 0.0, -400.0, 0.0, -74.0, -42.0, -11.0, -6.0, 0.0, -20.0, 0.0, 16.0, -22.0, 0.0, 0.0, 0.0, 1.0, -7.0, 0.0, 0.0, -4.0, 0.0, 0.0, -11.0, -8.0, -62.0, -7.0, 11.0, -22.0, -25.0, -27.0, 0.0, 0.0, 5.0, 0.0, 9.0, 0.0, -144.0, 0.0, 0.0, 0.0, -8.0, 16.0, -312.0, -248.0, -264.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, 9.0, -8.0, 0.0, 0.0, 9.0, -40.0, -15.0, -20.0, 0.0, 0.0, 0.0, -19.0, 0.0, 0.0, -4.0, -11.0, -14.0, -10.0, 10.0, 0.0, -16.0, -7.0, 0.0, 0.0, -10.0, 0.0, 0.0, 2.0, -12.0, 0.0, 0.0, 0.0, -11.0, 0.0, 0.0, -4.0, -14.0, 0.0, 0.0, -16.0, -10.0, -12.0, 0.0, 0.0, 0.0, -8.0, 0.0, -6.0, -6.0, 0.0, -54.0, 0.0, -238.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 6.0, 5.0, 0.0, 6.0, 12.0, 0.0, 200.0, 3.0, 0.0, 0.0, 22.0, 9.0, 10.0, 0.0, 6.0, 0.0, 6.0, 17.0, 5.0, 1.0, 2.0, 5.0, 6.0, 4.0, 0.0, 10.0, 0.0, 0.0, 0.0, 188.0, 18.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 5.0, 11.0, 4.0, 0.0, 0.0, 3.0, 200.0, 0.0, 0.0, 0.0, 9.0, 10.0, 0.0, 0.0, 0.0, 0.0, 9.0, 11.0, 9.0, 11.0, 8.0, 0.0, 0.0, 3.0, 166.0, 15.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 5.0, 9.0, 7.0, 190.0, 190.0, 0.0, 5.0, 5.0, 9.0, 5.0, 0.0, 200.0, 0.0, 24.0, 42.0, 21.0, 10.0, 3.0, 0.0, 0.0, 10.0, 1.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 7.0, 0.0, 0.0, 0.0, 0.0, 7.0, 32.0, 9.0, 4.0, 11.0, 8.0, 25.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 73.0, 0.0, 0.0, 2.0, 4.0, 0.0, 190.0, 124.0, 12.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 12.0, 11.0, 12.0, 7.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 7.0, 0.0, 0.0, 7.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 5.0, 0.0, 0.0, 8.0, 0.0, 6.0, 0.0, 0.0, 6.0, 0.0, 0.0, 2.0, 7.0, 0.0, 12.0, 10.0, 6.0, 5.0, 0.0, 0.0, 0.0, 4.0, 3.0, 1.0, 3.0, 0.0, 27.0, 0.0, 119.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 32.12038060039758, "mean_inference_ms": 54.81107450349051, "mean_action_processing_ms": 8.035750517772168, "mean_env_wait_ms": 7.348208690666541, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007259249687194824, "StateBufferConnector_ms": 0.0036031007766723633, "ViewRequirementAgentConnector_ms": 0.11878669261932373}, "num_episodes": 22, "episode_return_max": 19.0, "episode_return_min": -370.0, "episode_return_mean": -19.26, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2496000, "num_agent_steps_trained": 2496000, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 282.5474345429117, "num_env_steps_trained_throughput_per_sec": 282.5474345429117, "timesteps_total": 624000, "num_env_steps_sampled_lifetime": 624000, "num_agent_steps_sampled_lifetime": 2496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2496000, "timers": {"training_iteration_time_ms": 13214.046, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13213.95, "sample_time_ms": 1567.296, "learn_time_ms": 11624.058, "learn_throughput": 344.114, "synch_weights_time_ms": 17.562}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 2496000, "num_agent_steps_trained": 2496000}, "done": false, "training_iteration": 156, "trial_id": "f6b99_00000", "date": "2024-08-13_23-14-52", "timestamp": 1723605292, "time_this_iter_s": 14.19935393333435, "time_total_s": 12589.834995031357, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6d711f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12589.834995031357, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 53.385000000000005, "ram_util_percent": 83.74000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6375566302074327, "cur_kl_coeff": 4.773755790665747e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6139201205874246, "policy_loss": -0.0012715800739233455, "vf_loss": 0.6151916991978411, "vf_explained_var": 0.033751342094764505, "kl": 0.004305360015480102, "entropy": 0.14499769006417226, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 295785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.555542673669243, "cur_kl_coeff": 1.0359713087382255e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.48926589167701506, "policy_loss": -0.0006810751125196773, "vf_loss": 0.4899469667626175, "vf_explained_var": 0.012475230611821332, "kl": 0.002316614593729897, "entropy": 0.28590844808116794, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 295785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 2512000, "num_agent_steps_trained": 2512000}, "env_runners": {"episode_reward_max": 19.0, "episode_reward_min": -370.0, "episode_reward_mean": -16.28, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 16.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -21.4, "predator_policy": 13.26}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, -4.0, -3.0, -200.0, 0.0, -15.0, 0.0, 7.0, -19.0, -9.0, -8.0, 3.0, -148.0, 0.0, 0.0, 1.0, -5.0, -12.0, -2.0, -2.0, 19.0, -4.0, -200.0, -8.0, -22.0, -3.0, -10.0, 6.0, 0.0, 1.0, 4.0, 3.0, 0.0, -12.0, -28.0, 4.0, -19.0, 0.0, 5.0, 11.0, -71.0, 0.0, 14.0, -370.0, -128.0, 0.0, 6.0, 0.0, 6.0, 0.0, -8.0, -16.0, 0.0, -9.0, 0.0, -8.0, -17.0, 10.0, -10.0, 0.0, -5.0, 10.0, -6.0, 0.0, -5.0, -2.0, -7.0, 6.0, -11.0, 0.0, -4.0, -2.0, -3.0, -27.0, -119.0, 0.0, 0.0, 0.0, -5.0, 0.0, 0.0, -2.0, -3.0, -13.0, 0.0, 0.0, 0.0, -3.0, -5.0, 11.0, 9.0, -13.0, 0.0, 0.0, -1.0, 0.0, 0.0, -162.0, 4.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -6.0, -10.0, 0.0, -8.0, 0.0, -6.0, 0.0, -400.0, 0.0, 0.0, -12.0, -22.0, 0.0, 0.0, 7.0, 0.0, 0.0, -39.0, 0.0, -29.0, -16.0, 0.0, 0.0, 0.0, -323.0, -6.0, 0.0, 0.0, 0.0, 0.0, -1.0, 0.0, 0.0, -10.0, -28.0, 0.0, -12.0, -370.0, 0.0, -7.0, 0.0, 5.0, -9.0, 0.0, 0.0, -400.0, 0.0, -74.0, -42.0, -11.0, -6.0, 0.0, -20.0, 0.0, 16.0, -22.0, 0.0, 0.0, 0.0, 1.0, -7.0, 0.0, 0.0, -4.0, 0.0, 0.0, -11.0, -8.0, -62.0, -7.0, 11.0, -22.0, -25.0, -27.0, 0.0, 0.0, 5.0, 0.0, 9.0, 0.0, -144.0, 0.0, 0.0, 0.0, -8.0, 16.0, -312.0, -248.0, -264.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, 9.0, -8.0, 0.0, 0.0, 9.0, -40.0, -15.0, -20.0, 0.0, 0.0, 0.0, -19.0, 0.0, 0.0, -4.0, -11.0, -14.0, -10.0, 10.0, 0.0, -16.0, -7.0, 0.0, 0.0, -10.0, 0.0, 0.0, 2.0, -12.0, 0.0, 0.0, 0.0, -11.0, 0.0, 0.0, -4.0, -14.0, 0.0, 0.0, -16.0, -10.0, -12.0, 0.0, 0.0, 0.0, -8.0, 0.0, -6.0, -6.0, 0.0, -54.0, 0.0, -238.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -15.0, 0.0, 0.0, -16.0, 0.0, -30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, -10.0, 0.0, -340.0, 16.0, 0.0, 9.0, -10.0, -8.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, -364.0, 11.0, 4.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 5.0, 11.0, 4.0, 0.0, 0.0, 3.0, 200.0, 0.0, 0.0, 0.0, 9.0, 10.0, 0.0, 0.0, 0.0, 0.0, 9.0, 11.0, 9.0, 11.0, 8.0, 0.0, 0.0, 3.0, 166.0, 15.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 5.0, 9.0, 7.0, 190.0, 190.0, 0.0, 5.0, 5.0, 9.0, 5.0, 0.0, 200.0, 0.0, 24.0, 42.0, 21.0, 10.0, 3.0, 0.0, 0.0, 10.0, 1.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 7.0, 0.0, 0.0, 0.0, 0.0, 7.0, 32.0, 9.0, 4.0, 11.0, 8.0, 25.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 73.0, 0.0, 0.0, 2.0, 4.0, 0.0, 190.0, 124.0, 12.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 12.0, 11.0, 12.0, 7.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 7.0, 0.0, 0.0, 7.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 5.0, 0.0, 0.0, 8.0, 0.0, 6.0, 0.0, 0.0, 6.0, 0.0, 0.0, 2.0, 7.0, 0.0, 12.0, 10.0, 6.0, 5.0, 0.0, 0.0, 0.0, 4.0, 3.0, 1.0, 3.0, 0.0, 27.0, 0.0, 119.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 7.0, 8.0, 5.0, 11.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 5.0, 170.0, 165.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 3.0, 188.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.60018294550805, "mean_inference_ms": 54.74651767259436, "mean_action_processing_ms": 7.982051528391846, "mean_env_wait_ms": 6.85906734415063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006933808326721191, "StateBufferConnector_ms": 0.0033985376358032227, "ViewRequirementAgentConnector_ms": 0.11344385147094727}, "num_episodes": 18, "episode_return_max": 19.0, "episode_return_min": -370.0, "episode_return_mean": -16.28, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2512000, "num_agent_steps_trained": 2512000, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.535527031017, "num_env_steps_trained_throughput_per_sec": 301.535527031017, "timesteps_total": 628000, "num_env_steps_sampled_lifetime": 628000, "num_agent_steps_sampled_lifetime": 2512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2512000, "timers": {"training_iteration_time_ms": 13168.689, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13168.592, "sample_time_ms": 1557.112, "learn_time_ms": 11589.388, "learn_throughput": 345.143, "synch_weights_time_ms": 17.52}, "counters": {"num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 2512000, "num_agent_steps_trained": 2512000}, "done": false, "training_iteration": 157, "trial_id": "f6b99_00000", "date": "2024-08-13_23-15-06", "timestamp": 1723605306, "time_this_iter_s": 13.319510698318481, "time_total_s": 12603.154505729675, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6db9d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12603.154505729675, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 48.636842105263156, "ram_util_percent": 83.54736842105262}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5058806480199256, "cur_kl_coeff": 2.3868778953328734e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3737122275290035, "policy_loss": -0.0007801500407771932, "vf_loss": 0.37449237678443925, "vf_explained_var": 0.02659120414622877, "kl": 0.004981455173424835, "entropy": 0.09752123930427448, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 297675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6874338968050858, "cur_kl_coeff": 5.179856543691128e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5691590452685006, "policy_loss": -0.0016698106603509693, "vf_loss": 0.570828854329342, "vf_explained_var": -0.002292349508830479, "kl": 0.003190453430929482, "entropy": 0.22763582118762232, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 297675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 2528000, "num_agent_steps_trained": 2528000}, "env_runners": {"episode_reward_max": 19.0, "episode_reward_min": -370.0, "episode_reward_mean": -15.31, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 16.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -20.065, "predator_policy": 12.41}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, -2.0, -2.0, 19.0, -4.0, -200.0, -8.0, -22.0, -3.0, -10.0, 6.0, 0.0, 1.0, 4.0, 3.0, 0.0, -12.0, -28.0, 4.0, -19.0, 0.0, 5.0, 11.0, -71.0, 0.0, 14.0, -370.0, -128.0, 0.0, 6.0, 0.0, 6.0, 0.0, -8.0, -16.0, 0.0, -9.0, 0.0, -8.0, -17.0, 10.0, -10.0, 0.0, -5.0, 10.0, -6.0, 0.0, -5.0, -2.0, -7.0, 6.0, -11.0, 0.0, -4.0, -2.0, -3.0, -27.0, -119.0, 0.0, 0.0, 0.0, -5.0, 0.0, 0.0, -2.0, -3.0, -13.0, 0.0, 0.0, 0.0, -3.0, -5.0, 11.0, 9.0, -13.0, 0.0, 0.0, -1.0, 0.0, 0.0, -162.0, 4.0, -1.0, 0.0, 0.0, 0.0, -1.0, 2.0, -92.0, 0.0, -6.0, 12.0, 0.0, -14.0, -3.0, 0.0, -200.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-28.0, 0.0, -12.0, -370.0, 0.0, -7.0, 0.0, 5.0, -9.0, 0.0, 0.0, -400.0, 0.0, -74.0, -42.0, -11.0, -6.0, 0.0, -20.0, 0.0, 16.0, -22.0, 0.0, 0.0, 0.0, 1.0, -7.0, 0.0, 0.0, -4.0, 0.0, 0.0, -11.0, -8.0, -62.0, -7.0, 11.0, -22.0, -25.0, -27.0, 0.0, 0.0, 5.0, 0.0, 9.0, 0.0, -144.0, 0.0, 0.0, 0.0, -8.0, 16.0, -312.0, -248.0, -264.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, 9.0, -8.0, 0.0, 0.0, 9.0, -40.0, -15.0, -20.0, 0.0, 0.0, 0.0, -19.0, 0.0, 0.0, -4.0, -11.0, -14.0, -10.0, 10.0, 0.0, -16.0, -7.0, 0.0, 0.0, -10.0, 0.0, 0.0, 2.0, -12.0, 0.0, 0.0, 0.0, -11.0, 0.0, 0.0, -4.0, -14.0, 0.0, 0.0, -16.0, -10.0, -12.0, 0.0, 0.0, 0.0, -8.0, 0.0, -6.0, -6.0, 0.0, -54.0, 0.0, -238.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -15.0, 0.0, 0.0, -16.0, 0.0, -30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, -10.0, 0.0, -340.0, 16.0, 0.0, 9.0, -10.0, -8.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, -364.0, 11.0, 4.0, 0.0, -4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 2.0, 0.0, -20.0, -144.0, 0.0, 0.0, 0.0, -12.0, -6.0, 13.0, 0.0, 0.0, -2.0, -31.0, -8.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [9.0, 7.0, 190.0, 190.0, 0.0, 5.0, 5.0, 9.0, 5.0, 0.0, 200.0, 0.0, 24.0, 42.0, 21.0, 10.0, 3.0, 0.0, 0.0, 10.0, 1.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 7.0, 0.0, 0.0, 0.0, 0.0, 7.0, 32.0, 9.0, 4.0, 11.0, 8.0, 25.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 73.0, 0.0, 0.0, 2.0, 4.0, 0.0, 190.0, 124.0, 12.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 12.0, 11.0, 12.0, 7.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 7.0, 0.0, 0.0, 7.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 5.0, 0.0, 0.0, 8.0, 0.0, 6.0, 0.0, 0.0, 6.0, 0.0, 0.0, 2.0, 7.0, 0.0, 12.0, 10.0, 6.0, 5.0, 0.0, 0.0, 0.0, 4.0, 3.0, 1.0, 3.0, 0.0, 27.0, 0.0, 119.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 7.0, 8.0, 5.0, 11.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 5.0, 170.0, 165.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 3.0, 188.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 72.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 0.0, 0.0, 4.0, 15.0, 5.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.419483089781625, "mean_inference_ms": 54.4388997128988, "mean_action_processing_ms": 7.936946209814682, "mean_env_wait_ms": 6.820291568026311, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004214286804199219, "StateBufferConnector_ms": 0.003478527069091797, "ViewRequirementAgentConnector_ms": 0.11296117305755615}, "num_episodes": 18, "episode_return_max": 19.0, "episode_return_min": -370.0, "episode_return_mean": -15.31, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2528000, "num_agent_steps_trained": 2528000, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.3728438385394, "num_env_steps_trained_throughput_per_sec": 309.3728438385394, "timesteps_total": 632000, "num_env_steps_sampled_lifetime": 632000, "num_agent_steps_sampled_lifetime": 2528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2528000, "timers": {"training_iteration_time_ms": 13129.741, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13129.666, "sample_time_ms": 1541.463, "learn_time_ms": 11565.996, "learn_throughput": 345.841, "synch_weights_time_ms": 17.545}, "counters": {"num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 2528000, "num_agent_steps_trained": 2528000}, "done": false, "training_iteration": 158, "trial_id": "f6b99_00000", "date": "2024-08-13_23-15-19", "timestamp": 1723605319, "time_this_iter_s": 12.964810132980347, "time_total_s": 12616.119315862656, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6db9f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12616.119315862656, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 50.33888888888889, "ram_util_percent": 83.56666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5478448347676368, "cur_kl_coeff": 1.1934389476664367e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8179940929173162, "policy_loss": -0.0003032053355127573, "vf_loss": 0.818297297566656, "vf_explained_var": 0.020463054173837893, "kl": 0.0022999234777745102, "entropy": 0.07501925470001956, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 299565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7627895975081378, "cur_kl_coeff": 2.589928271845564e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2898710826993305, "policy_loss": -0.0017099645878212951, "vf_loss": 1.2915810482684897, "vf_explained_var": 0.004948350109120526, "kl": 0.0019896422037163942, "entropy": 0.19099011559177329, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 299565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 2544000, "num_agent_steps_trained": 2544000}, "env_runners": {"episode_reward_max": 15.0, "episode_reward_min": -463.0, "episode_reward_mean": -18.46, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 21.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -19.66, "predator_policy": 10.43}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.0, -19.0, 0.0, 5.0, 11.0, -71.0, 0.0, 14.0, -370.0, -128.0, 0.0, 6.0, 0.0, 6.0, 0.0, -8.0, -16.0, 0.0, -9.0, 0.0, -8.0, -17.0, 10.0, -10.0, 0.0, -5.0, 10.0, -6.0, 0.0, -5.0, -2.0, -7.0, 6.0, -11.0, 0.0, -4.0, -2.0, -3.0, -27.0, -119.0, 0.0, 0.0, 0.0, -5.0, 0.0, 0.0, -2.0, -3.0, -13.0, 0.0, 0.0, 0.0, -3.0, -5.0, 11.0, 9.0, -13.0, 0.0, 0.0, -1.0, 0.0, 0.0, -162.0, 4.0, -1.0, 0.0, 0.0, 0.0, -1.0, 2.0, -92.0, 0.0, -6.0, 12.0, 0.0, -14.0, -3.0, 0.0, -200.0, 0.0, 0.0, 0.0, 0.0, 12.0, -6.0, -463.0, -12.0, 4.0, -1.0, 2.0, 5.0, -5.0, 0.0, 0.0, -3.0, 0.0, 0.0, -127.0, -6.0, 15.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [11.0, -22.0, -25.0, -27.0, 0.0, 0.0, 5.0, 0.0, 9.0, 0.0, -144.0, 0.0, 0.0, 0.0, -8.0, 16.0, -312.0, -248.0, -264.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, 9.0, -8.0, 0.0, 0.0, 9.0, -40.0, -15.0, -20.0, 0.0, 0.0, 0.0, -19.0, 0.0, 0.0, -4.0, -11.0, -14.0, -10.0, 10.0, 0.0, -16.0, -7.0, 0.0, 0.0, -10.0, 0.0, 0.0, 2.0, -12.0, 0.0, 0.0, 0.0, -11.0, 0.0, 0.0, -4.0, -14.0, 0.0, 0.0, -16.0, -10.0, -12.0, 0.0, 0.0, 0.0, -8.0, 0.0, -6.0, -6.0, 0.0, -54.0, 0.0, -238.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -15.0, 0.0, 0.0, -16.0, 0.0, -30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, -10.0, 0.0, -340.0, 16.0, 0.0, 9.0, -10.0, -8.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, -364.0, 11.0, 4.0, 0.0, -4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 2.0, 0.0, -20.0, -144.0, 0.0, 0.0, 0.0, -12.0, -6.0, 13.0, 0.0, 0.0, -2.0, -31.0, -8.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -12.0, -363.0, -284.0, -22.0, -2.0, 0.0, -4.0, 0.0, -16.0, 0.0, -2.0, 8.0, -10.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -9.0, 0.0, 0.0, 0.0, 0.0, -287.0, 13.0, -14.0, -2.0, -12.0, 21.0], "policy_predator_policy_reward": [4.0, 11.0, 8.0, 25.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 73.0, 0.0, 0.0, 2.0, 4.0, 0.0, 190.0, 124.0, 12.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 12.0, 11.0, 12.0, 7.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 7.0, 0.0, 0.0, 7.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 5.0, 0.0, 0.0, 8.0, 0.0, 6.0, 0.0, 0.0, 6.0, 0.0, 0.0, 2.0, 7.0, 0.0, 12.0, 10.0, 6.0, 5.0, 0.0, 0.0, 0.0, 4.0, 3.0, 1.0, 3.0, 0.0, 27.0, 0.0, 119.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 7.0, 8.0, 5.0, 11.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 5.0, 170.0, 165.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 3.0, 188.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 72.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 0.0, 0.0, 4.0, 15.0, 5.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 6.0, 0.0, 1.0, 183.0, 1.0, 11.0, 3.0, 5.0, 0.0, 15.0, 0.0, 4.0, 7.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 144.0, 3.0, 3.0, 7.0, 6.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.24105443680672, "mean_inference_ms": 54.135167360039006, "mean_action_processing_ms": 7.892424708557841, "mean_env_wait_ms": 6.782007506638944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0049114227294921875, "StateBufferConnector_ms": 0.00334775447845459, "ViewRequirementAgentConnector_ms": 0.11823475360870361}, "num_episodes": 18, "episode_return_max": 15.0, "episode_return_min": -463.0, "episode_return_mean": -18.46, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2544000, "num_agent_steps_trained": 2544000, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.68494315859016, "num_env_steps_trained_throughput_per_sec": 312.68494315859016, "timesteps_total": 636000, "num_env_steps_sampled_lifetime": 636000, "num_agent_steps_sampled_lifetime": 2544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2544000, "timers": {"training_iteration_time_ms": 13140.749, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13140.691, "sample_time_ms": 1547.558, "learn_time_ms": 11571.383, "learn_throughput": 345.68, "synch_weights_time_ms": 17.483}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 2544000, "num_agent_steps_trained": 2544000}, "done": false, "training_iteration": 159, "trial_id": "f6b99_00000", "date": "2024-08-13_23-15-32", "timestamp": 1723605332, "time_this_iter_s": 12.844039916992188, "time_total_s": 12628.963355779648, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6dbfaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12628.963355779648, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 48.88421052631579, "ram_util_percent": 83.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8557100723265971, "cur_kl_coeff": 5.967194738332183e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3655074276857906, "policy_loss": -0.00109390997692509, "vf_loss": 0.366601337717166, "vf_explained_var": 0.054423261193371326, "kl": 0.0032870128848272065, "entropy": 0.11907598522526247, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 301455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8009038607141485, "cur_kl_coeff": 1.294964135922782e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.38399589762052216, "policy_loss": -0.0057912572971964005, "vf_loss": 0.38978715619249715, "vf_explained_var": -0.0153795944319831, "kl": 0.012713498087246053, "entropy": 0.2582911130927858, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 301455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000}, "env_runners": {"episode_reward_max": 17.0, "episode_reward_min": -463.0, "episode_reward_mean": -18.46, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 21.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -19.42, "predator_policy": 10.19}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.0, 0.0, -5.0, -2.0, -7.0, 6.0, -11.0, 0.0, -4.0, -2.0, -3.0, -27.0, -119.0, 0.0, 0.0, 0.0, -5.0, 0.0, 0.0, -2.0, -3.0, -13.0, 0.0, 0.0, 0.0, -3.0, -5.0, 11.0, 9.0, -13.0, 0.0, 0.0, -1.0, 0.0, 0.0, -162.0, 4.0, -1.0, 0.0, 0.0, 0.0, -1.0, 2.0, -92.0, 0.0, -6.0, 12.0, 0.0, -14.0, -3.0, 0.0, -200.0, 0.0, 0.0, 0.0, 0.0, 12.0, -6.0, -463.0, -12.0, 4.0, -1.0, 2.0, 5.0, -5.0, 0.0, 0.0, -3.0, 0.0, 0.0, -127.0, -6.0, 15.0, -1.0, -9.0, -4.0, 0.0, -4.0, -87.0, -348.0, -5.0, 0.0, -2.0, -14.0, 0.0, -2.0, -8.0, -12.0, 0.0, -6.0, 0.0, -111.0, 10.0, 0.0, 1.0, 0.0, 17.0, -4.0, -3.0, -3.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-12.0, 0.0, 0.0, 0.0, -11.0, 0.0, 0.0, -4.0, -14.0, 0.0, 0.0, -16.0, -10.0, -12.0, 0.0, 0.0, 0.0, -8.0, 0.0, -6.0, -6.0, 0.0, -54.0, 0.0, -238.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -15.0, 0.0, 0.0, -16.0, 0.0, -30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, -10.0, 0.0, -340.0, 16.0, 0.0, 9.0, -10.0, -8.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, -364.0, 11.0, 4.0, 0.0, -4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 2.0, 0.0, -20.0, -144.0, 0.0, 0.0, 0.0, -12.0, -6.0, 13.0, 0.0, 0.0, -2.0, -31.0, -8.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -12.0, -363.0, -284.0, -22.0, -2.0, 0.0, -4.0, 0.0, -16.0, 0.0, -2.0, 8.0, -10.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -9.0, 0.0, 0.0, 0.0, 0.0, -287.0, 13.0, -14.0, -2.0, -12.0, 21.0, 0.0, -2.0, -20.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, -8.0, -176.0, 0.0, -316.0, -232.0, -10.0, 0.0, 0.0, 0.0, -4.0, 0.0, -8.0, -12.0, 0.0, 0.0, 0.0, -4.0, 0.0, -33.0, -5.0, -14.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, -229.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 12.0, -13.0, -8.0, 0.0, 0.0, -10.0, -6.0, 0.0], "policy_predator_policy_reward": [0.0, 6.0, 0.0, 0.0, 6.0, 0.0, 0.0, 2.0, 7.0, 0.0, 12.0, 10.0, 6.0, 5.0, 0.0, 0.0, 0.0, 4.0, 3.0, 1.0, 3.0, 0.0, 27.0, 0.0, 119.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 7.0, 8.0, 5.0, 11.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 5.0, 170.0, 165.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 3.0, 188.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 72.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 0.0, 0.0, 4.0, 15.0, 5.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 6.0, 0.0, 1.0, 183.0, 1.0, 11.0, 3.0, 5.0, 0.0, 15.0, 0.0, 4.0, 7.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 144.0, 3.0, 3.0, 7.0, 6.0, 0.0, 0.0, 1.0, 7.0, 4.0, 0.0, 8.0, 0.0, 0.0, 0.0, 4.0, 89.0, 0.0, 200.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 2.0, 11.0, 14.0, 7.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 118.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 10.0, 4.0, 0.0, 0.0, 7.0, 0.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 31.31338314416444, "mean_inference_ms": 53.46044070992167, "mean_action_processing_ms": 7.835835407795397, "mean_env_wait_ms": 7.166502665065974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007456541061401367, "StateBufferConnector_ms": 0.00628662109375, "ViewRequirementAgentConnector_ms": 0.12864148616790771}, "num_episodes": 27, "episode_return_max": 17.0, "episode_return_min": -463.0, "episode_return_mean": -18.46, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.0151909317426, "num_env_steps_trained_throughput_per_sec": 305.0151909317426, "timesteps_total": 640000, "num_env_steps_sampled_lifetime": 640000, "num_agent_steps_sampled_lifetime": 2560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2560000, "timers": {"training_iteration_time_ms": 13141.206, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13141.146, "sample_time_ms": 1546.919, "learn_time_ms": 11572.084, "learn_throughput": 345.659, "synch_weights_time_ms": 17.802}, "counters": {"num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000}, "done": false, "training_iteration": 160, "trial_id": "f6b99_00000", "date": "2024-08-13_23-15-45", "timestamp": 1723605345, "time_this_iter_s": 13.143763065338135, "time_total_s": 12642.107118844986, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6dbfe50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12642.107118844986, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 48.95000000000001, "ram_util_percent": 83.69444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.456507534119818, "cur_kl_coeff": 2.9835973691660917e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9057249143798515, "policy_loss": -0.0029456662925738822, "vf_loss": 0.9086705830914003, "vf_explained_var": 0.019271672781182345, "kl": 0.0031119839671076093, "entropy": 0.1099866797881467, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 303345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4717637819903238, "cur_kl_coeff": 1.294964135922782e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8867533498458446, "policy_loss": -0.002090426926653852, "vf_loss": 0.8888437741411426, "vf_explained_var": -0.08660889627441527, "kl": 0.0027544527175576198, "entropy": 0.4190427570746689, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 303345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 2576000, "num_agent_steps_trained": 2576000}, "env_runners": {"episode_reward_max": 36.0, "episode_reward_min": -463.0, "episode_reward_mean": -17.21, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 38.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -19.635, "predator_policy": 11.03}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -2.0, -3.0, -13.0, 0.0, 0.0, 0.0, -3.0, -5.0, 11.0, 9.0, -13.0, 0.0, 0.0, -1.0, 0.0, 0.0, -162.0, 4.0, -1.0, 0.0, 0.0, 0.0, -1.0, 2.0, -92.0, 0.0, -6.0, 12.0, 0.0, -14.0, -3.0, 0.0, -200.0, 0.0, 0.0, 0.0, 0.0, 12.0, -6.0, -463.0, -12.0, 4.0, -1.0, 2.0, 5.0, -5.0, 0.0, 0.0, -3.0, 0.0, 0.0, -127.0, -6.0, 15.0, -1.0, -9.0, -4.0, 0.0, -4.0, -87.0, -348.0, -5.0, 0.0, -2.0, -14.0, 0.0, -2.0, -8.0, -12.0, 0.0, -6.0, 0.0, -111.0, 10.0, 0.0, 1.0, 0.0, 17.0, -4.0, -3.0, -3.0, 5.0, -11.0, 0.0, -128.0, 32.0, -9.0, 0.0, 36.0, 2.0, -40.0, -9.0, 0.0, 0.0, 12.0, 3.0, 31.0, 0.0, 16.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -15.0, 0.0, 0.0, -16.0, 0.0, -30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, -10.0, 0.0, -340.0, 16.0, 0.0, 9.0, -10.0, -8.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, -364.0, 11.0, 4.0, 0.0, -4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 2.0, 0.0, -20.0, -144.0, 0.0, 0.0, 0.0, -12.0, -6.0, 13.0, 0.0, 0.0, -2.0, -31.0, -8.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -12.0, -363.0, -284.0, -22.0, -2.0, 0.0, -4.0, 0.0, -16.0, 0.0, -2.0, 8.0, -10.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -9.0, 0.0, 0.0, 0.0, 0.0, -287.0, 13.0, -14.0, -2.0, -12.0, 21.0, 0.0, -2.0, -20.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, -8.0, -176.0, 0.0, -316.0, -232.0, -10.0, 0.0, 0.0, 0.0, -4.0, 0.0, -8.0, -12.0, 0.0, 0.0, 0.0, -4.0, 0.0, -33.0, -5.0, -14.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, -229.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 12.0, -13.0, -8.0, 0.0, 0.0, -10.0, -6.0, 0.0, 0.0, 5.0, -10.0, -18.0, 0.0, 0.0, -256.0, 0.0, 18.0, 12.0, -18.0, 0.0, 0.0, 0.0, -111.0, 0.0, -5.0, -2.0, 0.0, -82.0, 0.0, -18.0, 0.0, 0.0, 0.0, 0.0, 19.0, -18.0, 2.0, 1.0, 38.0, -14.0, 0.0, 0.0, 8.0, 5.0], "policy_predator_policy_reward": [0.0, 0.0, 6.0, 7.0, 8.0, 5.0, 11.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 5.0, 170.0, 165.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 3.0, 188.0, 0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 72.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 0.0, 0.0, 4.0, 15.0, 5.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 6.0, 0.0, 1.0, 183.0, 1.0, 11.0, 3.0, 5.0, 0.0, 15.0, 0.0, 4.0, 7.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 144.0, 3.0, 3.0, 7.0, 6.0, 0.0, 0.0, 1.0, 7.0, 4.0, 0.0, 8.0, 0.0, 0.0, 0.0, 4.0, 89.0, 0.0, 200.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 2.0, 11.0, 14.0, 7.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 118.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 10.0, 4.0, 0.0, 0.0, 7.0, 0.0, 3.0, 0.0, 0.0, 5.0, 12.0, 0.0, 0.0, 128.0, 0.0, 2.0, 0.0, 0.0, 9.0, 0.0, 0.0, 63.0, 84.0, 2.0, 7.0, 1.0, 41.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 3.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.8107925004725, "mean_inference_ms": 53.404685083764925, "mean_action_processing_ms": 7.784584201708071, "mean_env_wait_ms": 6.690832660401575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008060812950134277, "StateBufferConnector_ms": 0.006263017654418945, "ViewRequirementAgentConnector_ms": 0.1326305866241455}, "num_episodes": 18, "episode_return_max": 36.0, "episode_return_min": -463.0, "episode_return_mean": -17.21, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2576000, "num_agent_steps_trained": 2576000, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 244.9787629641444, "num_env_steps_trained_throughput_per_sec": 244.9787629641444, "timesteps_total": 644000, "num_env_steps_sampled_lifetime": 644000, "num_agent_steps_sampled_lifetime": 2576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2576000, "timers": {"training_iteration_time_ms": 13505.975, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13505.906, "sample_time_ms": 1555.541, "learn_time_ms": 11926.77, "learn_throughput": 335.38, "synch_weights_time_ms": 18.102}, "counters": {"num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 2576000, "num_agent_steps_trained": 2576000}, "done": false, "training_iteration": 161, "trial_id": "f6b99_00000", "date": "2024-08-13_23-16-01", "timestamp": 1723605361, "time_this_iter_s": 16.379919290542603, "time_total_s": 12658.487038135529, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6d1eaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12658.487038135529, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 63.05652173913043, "ram_util_percent": 83.73913043478262}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9694775367342922, "cur_kl_coeff": 1.4917986845830459e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5076472981975823, "policy_loss": -0.0004057538666067615, "vf_loss": 0.5080530523529483, "vf_explained_var": 0.016039195041807872, "kl": 0.002891252414136158, "entropy": 0.10271080242735998, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 305235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6454142648470464, "cur_kl_coeff": 6.47482067961391e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4803715316391496, "policy_loss": -0.0023179846175172656, "vf_loss": 0.48268951670600535, "vf_explained_var": -0.027249867417824963, "kl": 0.002712559937377106, "entropy": 0.38516373899247913, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 305235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 2592000, "num_agent_steps_trained": 2592000}, "env_runners": {"episode_reward_max": 36.0, "episode_reward_min": -463.0, "episode_reward_mean": -17.56, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 38.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -18.955, "predator_policy": 10.175}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.0, -1.0, 0.0, 0.0, 0.0, -1.0, 2.0, -92.0, 0.0, -6.0, 12.0, 0.0, -14.0, -3.0, 0.0, -200.0, 0.0, 0.0, 0.0, 0.0, 12.0, -6.0, -463.0, -12.0, 4.0, -1.0, 2.0, 5.0, -5.0, 0.0, 0.0, -3.0, 0.0, 0.0, -127.0, -6.0, 15.0, -1.0, -9.0, -4.0, 0.0, -4.0, -87.0, -348.0, -5.0, 0.0, -2.0, -14.0, 0.0, -2.0, -8.0, -12.0, 0.0, -6.0, 0.0, -111.0, 10.0, 0.0, 1.0, 0.0, 17.0, -4.0, -3.0, -3.0, 5.0, -11.0, 0.0, -128.0, 32.0, -9.0, 0.0, 36.0, 2.0, -40.0, -9.0, 0.0, 0.0, 12.0, 3.0, 31.0, 0.0, 16.0, -3.0, -1.0, -6.0, 15.0, 29.0, -208.0, -2.0, -2.0, -5.0, -8.0, 1.0, -12.0, -3.0, 6.0, -13.0, 0.0, -5.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [4.0, 0.0, -4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, 2.0, 0.0, -20.0, -144.0, 0.0, 0.0, 0.0, -12.0, -6.0, 13.0, 0.0, 0.0, -2.0, -31.0, -8.0, 0.0, 0.0, 0.0, 0.0, -400.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -12.0, -363.0, -284.0, -22.0, -2.0, 0.0, -4.0, 0.0, -16.0, 0.0, -2.0, 8.0, -10.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -9.0, 0.0, 0.0, 0.0, 0.0, -287.0, 13.0, -14.0, -2.0, -12.0, 21.0, 0.0, -2.0, -20.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, -8.0, -176.0, 0.0, -316.0, -232.0, -10.0, 0.0, 0.0, 0.0, -4.0, 0.0, -8.0, -12.0, 0.0, 0.0, 0.0, -4.0, 0.0, -33.0, -5.0, -14.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, -229.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 12.0, -13.0, -8.0, 0.0, 0.0, -10.0, -6.0, 0.0, 0.0, 5.0, -10.0, -18.0, 0.0, 0.0, -256.0, 0.0, 18.0, 12.0, -18.0, 0.0, 0.0, 0.0, -111.0, 0.0, -5.0, -2.0, 0.0, -82.0, 0.0, -18.0, 0.0, 0.0, 0.0, 0.0, 19.0, -18.0, 2.0, 1.0, 38.0, -14.0, 0.0, 0.0, 8.0, 5.0, -6.0, 0.0, -2.0, 0.0, 0.0, -12.0, -9.0, -4.0, 18.0, 11.0, -8.0, -400.0, 0.0, -23.0, -4.0, 0.0, 0.0, -10.0, -16.0, 0.0, -14.0, 0.0, -28.0, 0.0, -6.0, 0.0, -4.0, -74.0, 0.0, -28.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 72.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 5.0, 0.0, 0.0, 4.0, 15.0, 5.0, 0.0, 0.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 6.0, 0.0, 1.0, 183.0, 1.0, 11.0, 3.0, 5.0, 0.0, 15.0, 0.0, 4.0, 7.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 144.0, 3.0, 3.0, 7.0, 6.0, 0.0, 0.0, 1.0, 7.0, 4.0, 0.0, 8.0, 0.0, 0.0, 0.0, 4.0, 89.0, 0.0, 200.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 2.0, 11.0, 14.0, 7.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 118.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 10.0, 4.0, 0.0, 0.0, 7.0, 0.0, 3.0, 0.0, 0.0, 5.0, 12.0, 0.0, 0.0, 128.0, 0.0, 2.0, 0.0, 0.0, 9.0, 0.0, 0.0, 63.0, 84.0, 2.0, 7.0, 1.0, 41.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 1.0, 0.0, 6.0, 15.0, 13.0, 0.0, 0.0, 200.0, 0.0, 21.0, 0.0, 0.0, 2.0, 0.0, 5.0, 8.0, 0.0, 2.0, 13.0, 16.0, 0.0, 3.0, 0.0, 41.0, 43.0, 1.0, 14.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.639094904823764, "mean_inference_ms": 53.112393859056425, "mean_action_processing_ms": 7.741787250305181, "mean_env_wait_ms": 6.653989710600991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009183526039123535, "StateBufferConnector_ms": 0.006343722343444824, "ViewRequirementAgentConnector_ms": 0.1420961618423462}, "num_episodes": 18, "episode_return_max": 36.0, "episode_return_min": -463.0, "episode_return_mean": -17.56, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2592000, "num_agent_steps_trained": 2592000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.2140805236053, "num_env_steps_trained_throughput_per_sec": 266.2140805236053, "timesteps_total": 648000, "num_env_steps_sampled_lifetime": 648000, "num_agent_steps_sampled_lifetime": 2592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2592000, "timers": {"training_iteration_time_ms": 13674.52, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13674.451, "sample_time_ms": 1571.097, "learn_time_ms": 12081.544, "learn_throughput": 331.084, "synch_weights_time_ms": 16.183}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 2592000, "num_agent_steps_trained": 2592000}, "done": false, "training_iteration": 162, "trial_id": "f6b99_00000", "date": "2024-08-13_23-16-16", "timestamp": 1723605376, "time_this_iter_s": 15.104964017868042, "time_total_s": 12673.592002153397, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6d8f430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12673.592002153397, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 64.78571428571429, "ram_util_percent": 82.04285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0190578902366931, "cur_kl_coeff": 7.458993422915229e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.15177623272612298, "policy_loss": -0.003936187682978849, "vf_loss": 0.1557124205634291, "vf_explained_var": -0.026855308542806634, "kl": 0.004923990556153291, "entropy": 0.06308016841492009, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 307125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0916059779900091, "cur_kl_coeff": 3.237410339806955e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.20860828861751884, "policy_loss": -0.012207342573643597, "vf_loss": 0.22081563040489705, "vf_explained_var": -0.07437254814874558, "kl": 0.009748022805443273, "entropy": 0.435831215504616, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 307125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 2608000, "num_agent_steps_trained": 2608000}, "env_runners": {"episode_reward_max": 36.0, "episode_reward_min": -463.0, "episode_reward_mean": -14.57, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 38.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -16.22, "predator_policy": 8.935}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 12.0, -6.0, -463.0, -12.0, 4.0, -1.0, 2.0, 5.0, -5.0, 0.0, 0.0, -3.0, 0.0, 0.0, -127.0, -6.0, 15.0, -1.0, -9.0, -4.0, 0.0, -4.0, -87.0, -348.0, -5.0, 0.0, -2.0, -14.0, 0.0, -2.0, -8.0, -12.0, 0.0, -6.0, 0.0, -111.0, 10.0, 0.0, 1.0, 0.0, 17.0, -4.0, -3.0, -3.0, 5.0, -11.0, 0.0, -128.0, 32.0, -9.0, 0.0, 36.0, 2.0, -40.0, -9.0, 0.0, 0.0, 12.0, 3.0, 31.0, 0.0, 16.0, -3.0, -1.0, -6.0, 15.0, 29.0, -208.0, -2.0, -2.0, -5.0, -8.0, 1.0, -12.0, -3.0, 6.0, -13.0, 0.0, -5.0, 0.0, -4.0, -14.0, 2.0, 20.0, -2.0, -6.0, 0.0, 0.0, -2.0, -3.0, 6.0, -2.0, 4.0, 15.0, 0.0, 0.0, -5.0, -9.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -12.0, -363.0, -284.0, -22.0, -2.0, 0.0, -4.0, 0.0, -16.0, 0.0, -2.0, 8.0, -10.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -9.0, 0.0, 0.0, 0.0, 0.0, -287.0, 13.0, -14.0, -2.0, -12.0, 21.0, 0.0, -2.0, -20.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, -8.0, -176.0, 0.0, -316.0, -232.0, -10.0, 0.0, 0.0, 0.0, -4.0, 0.0, -8.0, -12.0, 0.0, 0.0, 0.0, -4.0, 0.0, -33.0, -5.0, -14.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, -229.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 12.0, -13.0, -8.0, 0.0, 0.0, -10.0, -6.0, 0.0, 0.0, 5.0, -10.0, -18.0, 0.0, 0.0, -256.0, 0.0, 18.0, 12.0, -18.0, 0.0, 0.0, 0.0, -111.0, 0.0, -5.0, -2.0, 0.0, -82.0, 0.0, -18.0, 0.0, 0.0, 0.0, 0.0, 19.0, -18.0, 2.0, 1.0, 38.0, -14.0, 0.0, 0.0, 8.0, 5.0, -6.0, 0.0, -2.0, 0.0, 0.0, -12.0, -9.0, -4.0, 18.0, 11.0, -8.0, -400.0, 0.0, -23.0, -4.0, 0.0, 0.0, -10.0, -16.0, 0.0, -14.0, 0.0, -28.0, 0.0, -6.0, 0.0, -4.0, -74.0, 0.0, -28.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, -8.0, -30.0, 1.0, -14.0, 6.0, 13.0, 7.0, 0.0, -4.0, 0.0, -13.0, 0.0, 0.0, 0.0, 0.0, -4.0, 0.0, -6.0, 0.0, 5.0, 0.0, -4.0, 0.0, 0.0, 4.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, -14.0, 1.0, 0.0, -18.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 6.0, 0.0, 1.0, 183.0, 1.0, 11.0, 3.0, 5.0, 0.0, 15.0, 0.0, 4.0, 7.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 144.0, 3.0, 3.0, 7.0, 6.0, 0.0, 0.0, 1.0, 7.0, 4.0, 0.0, 8.0, 0.0, 0.0, 0.0, 4.0, 89.0, 0.0, 200.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 2.0, 11.0, 14.0, 7.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 118.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 10.0, 4.0, 0.0, 0.0, 7.0, 0.0, 3.0, 0.0, 0.0, 5.0, 12.0, 0.0, 0.0, 128.0, 0.0, 2.0, 0.0, 0.0, 9.0, 0.0, 0.0, 63.0, 84.0, 2.0, 7.0, 1.0, 41.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 1.0, 0.0, 6.0, 15.0, 13.0, 0.0, 0.0, 200.0, 0.0, 21.0, 0.0, 0.0, 2.0, 0.0, 5.0, 8.0, 0.0, 2.0, 13.0, 16.0, 0.0, 3.0, 0.0, 41.0, 43.0, 1.0, 14.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 4.0, 15.0, 0.0, 3.0, 7.0, 0.0, 0.0, 0.0, 2.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 2.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 6.0, 0.0, 9.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.469687209565947, "mean_inference_ms": 52.82416607496541, "mean_action_processing_ms": 7.699580377409259, "mean_env_wait_ms": 6.617659826874705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00917351245880127, "StateBufferConnector_ms": 0.006235837936401367, "ViewRequirementAgentConnector_ms": 0.14007484912872314}, "num_episodes": 18, "episode_return_max": 36.0, "episode_return_min": -463.0, "episode_return_mean": -14.57, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2608000, "num_agent_steps_trained": 2608000, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 263.8827896718452, "num_env_steps_trained_throughput_per_sec": 263.8827896718452, "timesteps_total": 652000, "num_env_steps_sampled_lifetime": 652000, "num_agent_steps_sampled_lifetime": 2608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2608000, "timers": {"training_iteration_time_ms": 13836.186, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13836.118, "sample_time_ms": 1595.984, "learn_time_ms": 12218.107, "learn_throughput": 327.383, "synch_weights_time_ms": 16.879}, "counters": {"num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 2608000, "num_agent_steps_trained": 2608000}, "done": false, "training_iteration": 163, "trial_id": "f6b99_00000", "date": "2024-08-13_23-16-32", "timestamp": 1723605392, "time_this_iter_s": 15.242932081222534, "time_total_s": 12688.83493423462, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6d8f550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12688.83493423462, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 63.14545454545455, "ram_util_percent": 82.15454545454544}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6929091142953704, "cur_kl_coeff": 3.7294967114576146e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.963248637870506, "policy_loss": -0.0008100406966472744, "vf_loss": 0.9640586767641325, "vf_explained_var": 0.00880661064354831, "kl": 0.0018622856483189463, "entropy": 0.08182411931514266, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 309015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7373783876774488, "cur_kl_coeff": 3.237410339806955e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7325225775391258, "policy_loss": -0.002037211401121957, "vf_loss": 0.7345597896866917, "vf_explained_var": -0.0025170732112157913, "kl": 0.002705682497781808, "entropy": 0.3964530614791093, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 309015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 2624000, "num_agent_steps_trained": 2624000}, "env_runners": {"episode_reward_max": 36.0, "episode_reward_min": -348.0, "episode_reward_mean": -11.16, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 38.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -16.035, "predator_policy": 10.455}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, -87.0, -348.0, -5.0, 0.0, -2.0, -14.0, 0.0, -2.0, -8.0, -12.0, 0.0, -6.0, 0.0, -111.0, 10.0, 0.0, 1.0, 0.0, 17.0, -4.0, -3.0, -3.0, 5.0, -11.0, 0.0, -128.0, 32.0, -9.0, 0.0, 36.0, 2.0, -40.0, -9.0, 0.0, 0.0, 12.0, 3.0, 31.0, 0.0, 16.0, -3.0, -1.0, -6.0, 15.0, 29.0, -208.0, -2.0, -2.0, -5.0, -8.0, 1.0, -12.0, -3.0, 6.0, -13.0, 0.0, -5.0, 0.0, -4.0, -14.0, 2.0, 20.0, -2.0, -6.0, 0.0, 0.0, -2.0, -3.0, 6.0, -2.0, 4.0, 15.0, 0.0, 0.0, -5.0, -9.0, 0.0, -2.0, -4.0, 0.0, 0.0, 0.0, 2.0, -13.0, -7.0, -7.0, 0.0, -4.0, -13.0, -13.0, -5.0, -3.0, -2.0, 3.0, 2.0, -4.0, 0.0, -188.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -8.0, -176.0, 0.0, -316.0, -232.0, -10.0, 0.0, 0.0, 0.0, -4.0, 0.0, -8.0, -12.0, 0.0, 0.0, 0.0, -4.0, 0.0, -33.0, -5.0, -14.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, -229.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 12.0, -13.0, -8.0, 0.0, 0.0, -10.0, -6.0, 0.0, 0.0, 5.0, -10.0, -18.0, 0.0, 0.0, -256.0, 0.0, 18.0, 12.0, -18.0, 0.0, 0.0, 0.0, -111.0, 0.0, -5.0, -2.0, 0.0, -82.0, 0.0, -18.0, 0.0, 0.0, 0.0, 0.0, 19.0, -18.0, 2.0, 1.0, 38.0, -14.0, 0.0, 0.0, 8.0, 5.0, -6.0, 0.0, -2.0, 0.0, 0.0, -12.0, -9.0, -4.0, 18.0, 11.0, -8.0, -400.0, 0.0, -23.0, -4.0, 0.0, 0.0, -10.0, -16.0, 0.0, -14.0, 0.0, -28.0, 0.0, -6.0, 0.0, -4.0, -74.0, 0.0, -28.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, -8.0, -30.0, 1.0, -14.0, 6.0, 13.0, 7.0, 0.0, -4.0, 0.0, -13.0, 0.0, 0.0, 0.0, 0.0, -4.0, 0.0, -6.0, 0.0, 5.0, 0.0, -4.0, 0.0, 0.0, 4.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, -14.0, 1.0, 0.0, -18.0, 0.0, 0.0, 1.0, -6.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 2.0, 0.0, -26.0, 0.0, -16.0, -17.0, 0.0, 0.0, 0.0, 1.0, -15.0, -26.0, 0.0, -10.0, -20.0, 0.0, -10.0, 0.0, -6.0, -48.0, -11.0, 0.0, 3.0, 0.0, 2.0, -400.0, 0.0, 0.0, 0.0, 0.0, -378.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 4.0, 89.0, 0.0, 200.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 2.0, 11.0, 14.0, 7.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 118.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 10.0, 4.0, 0.0, 0.0, 7.0, 0.0, 3.0, 0.0, 0.0, 5.0, 12.0, 0.0, 0.0, 128.0, 0.0, 2.0, 0.0, 0.0, 9.0, 0.0, 0.0, 63.0, 84.0, 2.0, 7.0, 1.0, 41.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 1.0, 0.0, 6.0, 15.0, 13.0, 0.0, 0.0, 200.0, 0.0, 21.0, 0.0, 0.0, 2.0, 0.0, 5.0, 8.0, 0.0, 2.0, 13.0, 16.0, 0.0, 3.0, 0.0, 41.0, 43.0, 1.0, 14.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 4.0, 15.0, 0.0, 3.0, 7.0, 0.0, 0.0, 0.0, 2.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 2.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 6.0, 0.0, 9.0, 0.0, 0.0, 0.0, 3.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 5.0, 8.0, 0.0, 9.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 13.0, 10.0, 7.0, 5.0, 0.0, 0.0, 3.0, 23.0, 34.0, 0.0, 0.0, 0.0, 0.0, 196.0, 200.0, 0.0, 0.0, 0.0, 190.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.885368519151083, "mean_inference_ms": 52.11586342036643, "mean_action_processing_ms": 8.013113050292379, "mean_env_wait_ms": 6.722396855700838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00834190845489502, "StateBufferConnector_ms": 0.00623929500579834, "ViewRequirementAgentConnector_ms": 0.14143359661102295}, "num_episodes": 23, "episode_return_max": 36.0, "episode_return_min": -348.0, "episode_return_mean": -11.16, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2624000, "num_agent_steps_trained": 2624000, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.6089293716494, "num_env_steps_trained_throughput_per_sec": 303.6089293716494, "timesteps_total": 656000, "num_env_steps_sampled_lifetime": 656000, "num_agent_steps_sampled_lifetime": 2624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2624000, "timers": {"training_iteration_time_ms": 13896.644, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13896.576, "sample_time_ms": 1620.776, "learn_time_ms": 12253.982, "learn_throughput": 326.424, "synch_weights_time_ms": 16.897}, "counters": {"num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 2624000, "num_agent_steps_trained": 2624000}, "done": false, "training_iteration": 164, "trial_id": "f6b99_00000", "date": "2024-08-13_23-16-45", "timestamp": 1723605405, "time_this_iter_s": 13.228423833847046, "time_total_s": 12702.063358068466, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6d1eaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12702.063358068466, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 54.468421052631584, "ram_util_percent": 80.56842105263159}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3214144037198767, "cur_kl_coeff": 1.8647483557288073e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8668641029684632, "policy_loss": -0.0002202914648309902, "vf_loss": 0.8670843949846962, "vf_explained_var": 0.02224727783884321, "kl": 0.0024436430437989013, "entropy": 0.08984234117010914, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 310905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3727635564785154, "cur_kl_coeff": 1.6187051699034774e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9113337100064628, "policy_loss": -0.0039441942752255175, "vf_loss": 0.9152779029948371, "vf_explained_var": -0.02542896895181565, "kl": 0.004332097735974556, "entropy": 0.514808805610137, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 310905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000}, "env_runners": {"episode_reward_max": 36.0, "episode_reward_min": -208.0, "episode_reward_mean": -8.61, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 38.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -14.295, "predator_policy": 9.99}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, 5.0, -11.0, 0.0, -128.0, 32.0, -9.0, 0.0, 36.0, 2.0, -40.0, -9.0, 0.0, 0.0, 12.0, 3.0, 31.0, 0.0, 16.0, -3.0, -1.0, -6.0, 15.0, 29.0, -208.0, -2.0, -2.0, -5.0, -8.0, 1.0, -12.0, -3.0, 6.0, -13.0, 0.0, -5.0, 0.0, -4.0, -14.0, 2.0, 20.0, -2.0, -6.0, 0.0, 0.0, -2.0, -3.0, 6.0, -2.0, 4.0, 15.0, 0.0, 0.0, -5.0, -9.0, 0.0, -2.0, -4.0, 0.0, 0.0, 0.0, 2.0, -13.0, -7.0, -7.0, 0.0, -4.0, -13.0, -13.0, -5.0, -3.0, -2.0, 3.0, 2.0, -4.0, 0.0, -188.0, 0.0, 0.0, -73.0, 0.0, 0.0, -1.0, -3.0, -6.0, 0.0, -4.0, 1.0, -18.0, -7.0, 0.0, 0.0, -16.0, -4.0, -7.0, -124.0, -52.0, -9.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.0, 0.0, 0.0, 5.0, -10.0, -18.0, 0.0, 0.0, -256.0, 0.0, 18.0, 12.0, -18.0, 0.0, 0.0, 0.0, -111.0, 0.0, -5.0, -2.0, 0.0, -82.0, 0.0, -18.0, 0.0, 0.0, 0.0, 0.0, 19.0, -18.0, 2.0, 1.0, 38.0, -14.0, 0.0, 0.0, 8.0, 5.0, -6.0, 0.0, -2.0, 0.0, 0.0, -12.0, -9.0, -4.0, 18.0, 11.0, -8.0, -400.0, 0.0, -23.0, -4.0, 0.0, 0.0, -10.0, -16.0, 0.0, -14.0, 0.0, -28.0, 0.0, -6.0, 0.0, -4.0, -74.0, 0.0, -28.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, -8.0, -30.0, 1.0, -14.0, 6.0, 13.0, 7.0, 0.0, -4.0, 0.0, -13.0, 0.0, 0.0, 0.0, 0.0, -4.0, 0.0, -6.0, 0.0, 5.0, 0.0, -4.0, 0.0, 0.0, 4.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, -14.0, 1.0, 0.0, -18.0, 0.0, 0.0, 1.0, -6.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 2.0, 0.0, -26.0, 0.0, -16.0, -17.0, 0.0, 0.0, 0.0, 1.0, -15.0, -26.0, 0.0, -10.0, -20.0, 0.0, -10.0, 0.0, -6.0, -48.0, -11.0, 0.0, 3.0, 0.0, 2.0, -400.0, 0.0, 0.0, 0.0, 0.0, -378.0, 0.0, 0.0, 0.0, 0.0, -146.0, 0.0, -17.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, -7.0, 0.0, -12.0, 0.0, 0.0, -8.0, 0.0, -4.0, 3.0, 0.0, -36.0, -16.0, 1.0, 0.0, 0.0, 0.0, 0.0, -70.0, 10.0, -8.0, 0.0, -14.0, 0.0, -242.0, -6.0, -110.0, 0.0, -25.0, 0.0, 0.0, 0.0, -6.0, -8.0], "policy_predator_policy_reward": [0.0, 3.0, 0.0, 0.0, 5.0, 12.0, 0.0, 0.0, 128.0, 0.0, 2.0, 0.0, 0.0, 9.0, 0.0, 0.0, 63.0, 84.0, 2.0, 7.0, 1.0, 41.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 1.0, 0.0, 6.0, 15.0, 13.0, 0.0, 0.0, 200.0, 0.0, 21.0, 0.0, 0.0, 2.0, 0.0, 5.0, 8.0, 0.0, 2.0, 13.0, 16.0, 0.0, 3.0, 0.0, 41.0, 43.0, 1.0, 14.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 4.0, 15.0, 0.0, 3.0, 7.0, 0.0, 0.0, 0.0, 2.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 2.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 6.0, 0.0, 9.0, 0.0, 0.0, 0.0, 3.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 5.0, 8.0, 0.0, 9.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 13.0, 10.0, 7.0, 5.0, 0.0, 0.0, 3.0, 23.0, 34.0, 0.0, 0.0, 0.0, 0.0, 196.0, 200.0, 0.0, 0.0, 0.0, 190.0, 0.0, 0.0, 0.0, 0.0, 73.0, 0.0, 10.0, 7.0, 0.0, 0.0, 1.0, 0.0, 4.0, 0.0, 6.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 18.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 3.0, 41.0, 1.0, 3.0, 0.0, 7.0, 121.0, 3.0, 1.0, 57.0, 0.0, 16.0, 0.0, 0.0, 0.0, 14.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 30.065609400326803, "mean_inference_ms": 52.135779582739524, "mean_action_processing_ms": 7.599693886175596, "mean_env_wait_ms": 6.529635025467195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005927681922912598, "StateBufferConnector_ms": 0.0031740665435791016, "ViewRequirementAgentConnector_ms": 0.12183821201324463}, "num_episodes": 22, "episode_return_max": 36.0, "episode_return_min": -208.0, "episode_return_mean": -8.61, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.9674501657167, "num_env_steps_trained_throughput_per_sec": 305.9674501657167, "timesteps_total": 660000, "num_env_steps_sampled_lifetime": 660000, "num_agent_steps_sampled_lifetime": 2640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2640000, "timers": {"training_iteration_time_ms": 13901.818, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13901.75, "sample_time_ms": 1617.41, "learn_time_ms": 12262.631, "learn_throughput": 326.194, "synch_weights_time_ms": 16.826}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000}, "done": false, "training_iteration": 165, "trial_id": "f6b99_00000", "date": "2024-08-13_23-16-58", "timestamp": 1723605418, "time_this_iter_s": 13.124055624008179, "time_total_s": 12715.187413692474, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6d4c1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12715.187413692474, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 51.17894736842105, "ram_util_percent": 79.24736842105264}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.008848929200223, "cur_kl_coeff": 9.323741778644037e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3744848375164327, "policy_loss": -0.004204816548104482, "vf_loss": 0.378689652467861, "vf_explained_var": 0.057712399612658866, "kl": 0.002726626960699589, "entropy": 0.09392680591317239, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 312795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.970512879900043, "cur_kl_coeff": 8.093525849517387e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3799323742499664, "policy_loss": -0.010159651402177082, "vf_loss": 0.390092024523654, "vf_explained_var": -0.0775803957351301, "kl": 0.022238781986115817, "entropy": 0.5037924366337913, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 312795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 2656000, "num_agent_steps_trained": 2656000}, "env_runners": {"episode_reward_max": 29.0, "episode_reward_min": -208.0, "episode_reward_mean": -8.8, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 18.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -13.295, "predator_policy": 8.895}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.0, -3.0, -1.0, -6.0, 15.0, 29.0, -208.0, -2.0, -2.0, -5.0, -8.0, 1.0, -12.0, -3.0, 6.0, -13.0, 0.0, -5.0, 0.0, -4.0, -14.0, 2.0, 20.0, -2.0, -6.0, 0.0, 0.0, -2.0, -3.0, 6.0, -2.0, 4.0, 15.0, 0.0, 0.0, -5.0, -9.0, 0.0, -2.0, -4.0, 0.0, 0.0, 0.0, 2.0, -13.0, -7.0, -7.0, 0.0, -4.0, -13.0, -13.0, -5.0, -3.0, -2.0, 3.0, 2.0, -4.0, 0.0, -188.0, 0.0, 0.0, -73.0, 0.0, 0.0, -1.0, -3.0, -6.0, 0.0, -4.0, 1.0, -18.0, -7.0, 0.0, 0.0, -16.0, -4.0, -7.0, -124.0, -52.0, -9.0, 0.0, 0.0, 0.0, 2.0, -4.0, 1.0, 3.0, 0.0, -52.0, 0.0, 0.0, -10.0, 0.0, 0.0, -2.0, 15.0, -20.0, -5.0, -8.0, -18.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [8.0, 5.0, -6.0, 0.0, -2.0, 0.0, 0.0, -12.0, -9.0, -4.0, 18.0, 11.0, -8.0, -400.0, 0.0, -23.0, -4.0, 0.0, 0.0, -10.0, -16.0, 0.0, -14.0, 0.0, -28.0, 0.0, -6.0, 0.0, -4.0, -74.0, 0.0, -28.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, -8.0, -30.0, 1.0, -14.0, 6.0, 13.0, 7.0, 0.0, -4.0, 0.0, -13.0, 0.0, 0.0, 0.0, 0.0, -4.0, 0.0, -6.0, 0.0, 5.0, 0.0, -4.0, 0.0, 0.0, 4.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, -14.0, 1.0, 0.0, -18.0, 0.0, 0.0, 1.0, -6.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 2.0, 0.0, -26.0, 0.0, -16.0, -17.0, 0.0, 0.0, 0.0, 1.0, -15.0, -26.0, 0.0, -10.0, -20.0, 0.0, -10.0, 0.0, -6.0, -48.0, -11.0, 0.0, 3.0, 0.0, 2.0, -400.0, 0.0, 0.0, 0.0, 0.0, -378.0, 0.0, 0.0, 0.0, 0.0, -146.0, 0.0, -17.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, -7.0, 0.0, -12.0, 0.0, 0.0, -8.0, 0.0, -4.0, 3.0, 0.0, -36.0, -16.0, 1.0, 0.0, 0.0, 0.0, 0.0, -70.0, 10.0, -8.0, 0.0, -14.0, 0.0, -242.0, -6.0, -110.0, 0.0, -25.0, 0.0, 0.0, 0.0, -6.0, -8.0, 0.0, 0.0, -11.0, 0.0, 0.0, -8.0, -13.0, 0.0, 2.0, 0.0, 0.0, 0.0, -116.0, 6.0, 0.0, 0.0, 0.0, 0.0, -12.0, -8.0, 0.0, 0.0, 0.0, 0.0, -11.0, 0.0, 0.0, 12.0, 0.0, -40.0, -1.0, -10.0, 0.0, -17.0, -20.0, -16.0], "policy_predator_policy_reward": [3.0, 0.0, 3.0, 0.0, 0.0, 1.0, 0.0, 6.0, 15.0, 13.0, 0.0, 0.0, 200.0, 0.0, 21.0, 0.0, 0.0, 2.0, 0.0, 5.0, 8.0, 0.0, 2.0, 13.0, 16.0, 0.0, 3.0, 0.0, 41.0, 43.0, 1.0, 14.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 4.0, 15.0, 0.0, 3.0, 7.0, 0.0, 0.0, 0.0, 2.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 2.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 6.0, 0.0, 9.0, 0.0, 0.0, 0.0, 3.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 5.0, 8.0, 0.0, 9.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 13.0, 10.0, 7.0, 5.0, 0.0, 0.0, 3.0, 23.0, 34.0, 0.0, 0.0, 0.0, 0.0, 196.0, 200.0, 0.0, 0.0, 0.0, 190.0, 0.0, 0.0, 0.0, 0.0, 73.0, 0.0, 10.0, 7.0, 0.0, 0.0, 1.0, 0.0, 4.0, 0.0, 6.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 18.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 3.0, 41.0, 1.0, 3.0, 0.0, 7.0, 121.0, 3.0, 1.0, 57.0, 0.0, 16.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 13.0, 4.0, 0.0, 13.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 58.0, 0.0, 0.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 0.0, 0.0, 2.0, 7.0, 3.0, 0.0, 0.0, 20.0, 5.0, 1.0, 9.0, 0.0, 8.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.902545699741182, "mean_inference_ms": 51.8584005227713, "mean_action_processing_ms": 7.559061324690844, "mean_env_wait_ms": 6.494694730974336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00521087646484375, "StateBufferConnector_ms": 0.003145575523376465, "ViewRequirementAgentConnector_ms": 0.12018823623657227}, "num_episodes": 18, "episode_return_max": 29.0, "episode_return_min": -208.0, "episode_return_mean": -8.8, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2656000, "num_agent_steps_trained": 2656000, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 324.47002815118867, "num_env_steps_trained_throughput_per_sec": 324.47002815118867, "timesteps_total": 664000, "num_env_steps_sampled_lifetime": 664000, "num_agent_steps_sampled_lifetime": 2656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2656000, "timers": {"training_iteration_time_ms": 13718.906, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13718.847, "sample_time_ms": 1625.807, "learn_time_ms": 12072.43, "learn_throughput": 331.333, "synch_weights_time_ms": 16.329}, "counters": {"num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 2656000, "num_agent_steps_trained": 2656000}, "done": false, "training_iteration": 166, "trial_id": "f6b99_00000", "date": "2024-08-13_23-17-10", "timestamp": 1723605430, "time_this_iter_s": 12.333861112594604, "time_total_s": 12727.521274805069, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6f243a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12727.521274805069, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 52.21764705882352, "ram_util_percent": 79.40588235294118}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.235372405613541, "cur_kl_coeff": 4.661870889322018e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3505299746044098, "policy_loss": -0.0029332157539785223, "vf_loss": 0.35346319258272174, "vf_explained_var": 0.12124855887322199, "kl": 0.003076227669224714, "entropy": 0.05463802926784391, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 314685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3503804506132842, "cur_kl_coeff": 1.2140288774276083e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.563552249443259, "policy_loss": -0.008655080870138826, "vf_loss": 0.5722073308317848, "vf_explained_var": -0.07650691412744068, "kl": 0.0038125586784520226, "entropy": 0.514869837644239, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 314685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 2672000, "num_agent_steps_trained": 2672000}, "env_runners": {"episode_reward_max": 20.0, "episode_reward_min": -188.0, "episode_reward_mean": -7.39, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 15.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -11.04, "predator_policy": 7.345}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -4.0, -14.0, 2.0, 20.0, -2.0, -6.0, 0.0, 0.0, -2.0, -3.0, 6.0, -2.0, 4.0, 15.0, 0.0, 0.0, -5.0, -9.0, 0.0, -2.0, -4.0, 0.0, 0.0, 0.0, 2.0, -13.0, -7.0, -7.0, 0.0, -4.0, -13.0, -13.0, -5.0, -3.0, -2.0, 3.0, 2.0, -4.0, 0.0, -188.0, 0.0, 0.0, -73.0, 0.0, 0.0, -1.0, -3.0, -6.0, 0.0, -4.0, 1.0, -18.0, -7.0, 0.0, 0.0, -16.0, -4.0, -7.0, -124.0, -52.0, -9.0, 0.0, 0.0, 0.0, 2.0, -4.0, 1.0, 3.0, 0.0, -52.0, 0.0, 0.0, -10.0, 0.0, 0.0, -2.0, 15.0, -20.0, -5.0, -8.0, -18.0, 0.0, 1.0, 0.0, -4.0, -1.0, -3.0, -2.0, -10.0, -15.0, -20.0, -1.0, -9.0, 6.0, -2.0, 0.0, 3.0, 0.0, -3.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, -8.0, -30.0, 1.0, -14.0, 6.0, 13.0, 7.0, 0.0, -4.0, 0.0, -13.0, 0.0, 0.0, 0.0, 0.0, -4.0, 0.0, -6.0, 0.0, 5.0, 0.0, -4.0, 0.0, 0.0, 4.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, -14.0, 1.0, 0.0, -18.0, 0.0, 0.0, 1.0, -6.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 2.0, 0.0, -26.0, 0.0, -16.0, -17.0, 0.0, 0.0, 0.0, 1.0, -15.0, -26.0, 0.0, -10.0, -20.0, 0.0, -10.0, 0.0, -6.0, -48.0, -11.0, 0.0, 3.0, 0.0, 2.0, -400.0, 0.0, 0.0, 0.0, 0.0, -378.0, 0.0, 0.0, 0.0, 0.0, -146.0, 0.0, -17.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, -7.0, 0.0, -12.0, 0.0, 0.0, -8.0, 0.0, -4.0, 3.0, 0.0, -36.0, -16.0, 1.0, 0.0, 0.0, 0.0, 0.0, -70.0, 10.0, -8.0, 0.0, -14.0, 0.0, -242.0, -6.0, -110.0, 0.0, -25.0, 0.0, 0.0, 0.0, -6.0, -8.0, 0.0, 0.0, -11.0, 0.0, 0.0, -8.0, -13.0, 0.0, 2.0, 0.0, 0.0, 0.0, -116.0, 6.0, 0.0, 0.0, 0.0, 0.0, -12.0, -8.0, 0.0, 0.0, 0.0, 0.0, -11.0, 0.0, 0.0, 12.0, 0.0, -40.0, -1.0, -10.0, 0.0, -17.0, -20.0, -16.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, -9.0, -2.0, 0.0, 0.0, -6.0, 0.0, -4.0, 0.0, -20.0, -46.0, -8.0, 0.0, -41.0, -12.0, 5.0, -18.0, 0.0, 2.0, 0.0, -4.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, -6.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 4.0, 15.0, 0.0, 3.0, 7.0, 0.0, 0.0, 0.0, 2.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 2.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 6.0, 0.0, 9.0, 0.0, 0.0, 0.0, 3.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 5.0, 8.0, 0.0, 9.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 13.0, 10.0, 7.0, 5.0, 0.0, 0.0, 3.0, 23.0, 34.0, 0.0, 0.0, 0.0, 0.0, 196.0, 200.0, 0.0, 0.0, 0.0, 190.0, 0.0, 0.0, 0.0, 0.0, 73.0, 0.0, 10.0, 7.0, 0.0, 0.0, 1.0, 0.0, 4.0, 0.0, 6.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 18.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 3.0, 41.0, 1.0, 3.0, 0.0, 7.0, 121.0, 3.0, 1.0, 57.0, 0.0, 16.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 13.0, 4.0, 0.0, 13.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 58.0, 0.0, 0.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 0.0, 0.0, 2.0, 7.0, 3.0, 0.0, 0.0, 20.0, 5.0, 1.0, 9.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 1.0, 0.0, 3.0, 0.0, 2.0, 0.0, 0.0, 10.0, 19.0, 20.0, 0.0, 21.0, 0.0, 6.0, 0.0, 9.0, 0.0, 4.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.741391797661237, "mean_inference_ms": 51.584147133109674, "mean_action_processing_ms": 7.518851757612306, "mean_env_wait_ms": 6.46012502335973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004706263542175293, "StateBufferConnector_ms": 0.0032236576080322266, "ViewRequirementAgentConnector_ms": 0.11543500423431396}, "num_episodes": 18, "episode_return_max": 20.0, "episode_return_min": -188.0, "episode_return_mean": -7.39, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2672000, "num_agent_steps_trained": 2672000, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.6264517186006, "num_env_steps_trained_throughput_per_sec": 308.6264517186006, "timesteps_total": 668000, "num_env_steps_sampled_lifetime": 668000, "num_agent_steps_sampled_lifetime": 2672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2672000, "timers": {"training_iteration_time_ms": 13688.428, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13688.37, "sample_time_ms": 1615.088, "learn_time_ms": 12052.867, "learn_throughput": 331.871, "synch_weights_time_ms": 16.253}, "counters": {"num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 2672000, "num_agent_steps_trained": 2672000}, "done": false, "training_iteration": 167, "trial_id": "f6b99_00000", "date": "2024-08-13_23-17-23", "timestamp": 1723605443, "time_this_iter_s": 12.964882850646973, "time_total_s": 12740.486157655716, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6f764c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12740.486157655716, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 46.98947368421053, "ram_util_percent": 79.3842105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2025695554714986, "cur_kl_coeff": 2.330935444661009e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8246564664853313, "policy_loss": -0.0005997598048043314, "vf_loss": 0.8252562274456655, "vf_explained_var": 0.0292485999051856, "kl": 0.0018347475674227003, "entropy": 0.06064362046776941, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 316575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3549579258160616, "cur_kl_coeff": 6.0701443871380415e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9850237147044884, "policy_loss": -0.0022026773483034166, "vf_loss": 0.9872263918635706, "vf_explained_var": -0.0008234400282461176, "kl": 0.004214882624752858, "entropy": 0.5534900629015826, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 316575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 2688000, "num_agent_steps_trained": 2688000}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": -188.0, "episode_reward_mean": -9.27, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 17.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -13.04, "predator_policy": 8.405}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.0, 0.0, -2.0, -4.0, 0.0, 0.0, 0.0, 2.0, -13.0, -7.0, -7.0, 0.0, -4.0, -13.0, -13.0, -5.0, -3.0, -2.0, 3.0, 2.0, -4.0, 0.0, -188.0, 0.0, 0.0, -73.0, 0.0, 0.0, -1.0, -3.0, -6.0, 0.0, -4.0, 1.0, -18.0, -7.0, 0.0, 0.0, -16.0, -4.0, -7.0, -124.0, -52.0, -9.0, 0.0, 0.0, 0.0, 2.0, -4.0, 1.0, 3.0, 0.0, -52.0, 0.0, 0.0, -10.0, 0.0, 0.0, -2.0, 15.0, -20.0, -5.0, -8.0, -18.0, 0.0, 1.0, 0.0, -4.0, -1.0, -3.0, -2.0, -10.0, -15.0, -20.0, -1.0, -9.0, 6.0, -2.0, 0.0, 3.0, 0.0, -3.0, 1.0, 2.0, 0.0, 2.0, -10.0, -2.0, 0.0, 22.0, -64.0, -6.0, -1.0, -110.0, 0.0, 0.0, -12.0, 0.0, -1.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -18.0, 0.0, 0.0, 1.0, -6.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 2.0, 0.0, -26.0, 0.0, -16.0, -17.0, 0.0, 0.0, 0.0, 1.0, -15.0, -26.0, 0.0, -10.0, -20.0, 0.0, -10.0, 0.0, -6.0, -48.0, -11.0, 0.0, 3.0, 0.0, 2.0, -400.0, 0.0, 0.0, 0.0, 0.0, -378.0, 0.0, 0.0, 0.0, 0.0, -146.0, 0.0, -17.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, -7.0, 0.0, -12.0, 0.0, 0.0, -8.0, 0.0, -4.0, 3.0, 0.0, -36.0, -16.0, 1.0, 0.0, 0.0, 0.0, 0.0, -70.0, 10.0, -8.0, 0.0, -14.0, 0.0, -242.0, -6.0, -110.0, 0.0, -25.0, 0.0, 0.0, 0.0, -6.0, -8.0, 0.0, 0.0, -11.0, 0.0, 0.0, -8.0, -13.0, 0.0, 2.0, 0.0, 0.0, 0.0, -116.0, 6.0, 0.0, 0.0, 0.0, 0.0, -12.0, -8.0, 0.0, 0.0, 0.0, 0.0, -11.0, 0.0, 0.0, 12.0, 0.0, -40.0, -1.0, -10.0, 0.0, -17.0, -20.0, -16.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, -9.0, -2.0, 0.0, 0.0, -6.0, 0.0, -4.0, 0.0, -20.0, -46.0, -8.0, 0.0, -41.0, -12.0, 5.0, -18.0, 0.0, 2.0, 0.0, -4.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 1.0, 8.0, -14.0, 0.0, 0.0, 2.0, 0.0, -14.0, -14.0, 0.0, -4.0, -4.0, 0.0, 5.0, 17.0, 0.0, -128.0, 0.0, -12.0, -18.0, 6.0, -206.0, -16.0, 0.0, 0.0, 0.0, 0.0, 0.0, -52.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 9.0, 0.0, 0.0, 0.0, 3.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 5.0, 8.0, 0.0, 9.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 13.0, 10.0, 7.0, 5.0, 0.0, 0.0, 3.0, 23.0, 34.0, 0.0, 0.0, 0.0, 0.0, 196.0, 200.0, 0.0, 0.0, 0.0, 190.0, 0.0, 0.0, 0.0, 0.0, 73.0, 0.0, 10.0, 7.0, 0.0, 0.0, 1.0, 0.0, 4.0, 0.0, 6.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 18.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 3.0, 41.0, 1.0, 3.0, 0.0, 7.0, 121.0, 3.0, 1.0, 57.0, 0.0, 16.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 13.0, 4.0, 0.0, 13.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 58.0, 0.0, 0.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 0.0, 0.0, 2.0, 7.0, 3.0, 0.0, 0.0, 20.0, 5.0, 1.0, 9.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 1.0, 0.0, 3.0, 0.0, 2.0, 0.0, 0.0, 10.0, 19.0, 20.0, 0.0, 21.0, 0.0, 6.0, 0.0, 9.0, 0.0, 4.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 6.0, 2.0, 0.0, 0.0, 0.0, 0.0, 1.0, 17.0, 2.0, 0.0, 4.0, 0.0, 0.0, 0.0, 6.0, 58.0, 6.0, 0.0, 11.0, 0.0, 111.0, 1.0, 0.0, 0.0, 0.0, 0.0, 26.0, 14.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.58197121939241, "mean_inference_ms": 51.31269808155519, "mean_action_processing_ms": 7.479044473959972, "mean_env_wait_ms": 6.425898167494808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038192272186279297, "StateBufferConnector_ms": 0.00317990779876709, "ViewRequirementAgentConnector_ms": 0.10630226135253906}, "num_episodes": 18, "episode_return_max": 22.0, "episode_return_min": -188.0, "episode_return_mean": -9.27, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2688000, "num_agent_steps_trained": 2688000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.19998717323836, "num_env_steps_trained_throughput_per_sec": 306.19998717323836, "timesteps_total": 672000, "num_env_steps_sampled_lifetime": 672000, "num_agent_steps_sampled_lifetime": 2688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2688000, "timers": {"training_iteration_time_ms": 13701.825, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13701.768, "sample_time_ms": 1607.316, "learn_time_ms": 12074.632, "learn_throughput": 331.273, "synch_weights_time_ms": 15.901}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 2688000, "num_agent_steps_trained": 2688000}, "done": false, "training_iteration": 168, "trial_id": "f6b99_00000", "date": "2024-08-13_23-17-37", "timestamp": 1723605457, "time_this_iter_s": 13.095964908599854, "time_total_s": 12753.582122564316, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6db9ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12753.582122564316, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 50.405555555555566, "ram_util_percent": 79.59444444444443}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8768239702181841, "cur_kl_coeff": 1.1654677223305046e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.45673909210181113, "policy_loss": -0.0006451838620243564, "vf_loss": 0.4573842761165305, "vf_explained_var": 0.02162524792883131, "kl": 0.0024258652462576954, "entropy": 0.0617863686065431, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 318465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9672426952295518, "cur_kl_coeff": 3.0350721935690207e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.48071021472138387, "policy_loss": -0.002308676214198823, "vf_loss": 0.48301888952594096, "vf_explained_var": 0.0002982682651943631, "kl": 0.004658510883194733, "entropy": 0.514340849007879, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 318465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 2704000, "num_agent_steps_trained": 2704000}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": -160.0, "episode_reward_mean": -8.93, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -242.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 19.0, "predator_policy": 121.0}, "policy_reward_mean": {"prey_policy": -10.845, "predator_policy": 6.38}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -1.0, -3.0, -6.0, 0.0, -4.0, 1.0, -18.0, -7.0, 0.0, 0.0, -16.0, -4.0, -7.0, -124.0, -52.0, -9.0, 0.0, 0.0, 0.0, 2.0, -4.0, 1.0, 3.0, 0.0, -52.0, 0.0, 0.0, -10.0, 0.0, 0.0, -2.0, 15.0, -20.0, -5.0, -8.0, -18.0, 0.0, 1.0, 0.0, -4.0, -1.0, -3.0, -2.0, -10.0, -15.0, -20.0, -1.0, -9.0, 6.0, -2.0, 0.0, 3.0, 0.0, -3.0, 1.0, 2.0, 0.0, 2.0, -10.0, -2.0, 0.0, 22.0, -64.0, -6.0, -1.0, -110.0, 0.0, 0.0, -12.0, 0.0, -1.0, 0.0, -10.0, -5.0, 0.0, 0.0, 4.0, 0.0, -14.0, -4.0, -6.0, 0.0, 0.0, -1.0, -160.0, -4.0, 12.0, 0.0, 0.0, 0.0, -9.0, 21.0, 4.0, -15.0, -119.0, 3.0, 11.0, -14.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -2.0, 0.0, 0.0, -7.0, 0.0, -12.0, 0.0, 0.0, -8.0, 0.0, -4.0, 3.0, 0.0, -36.0, -16.0, 1.0, 0.0, 0.0, 0.0, 0.0, -70.0, 10.0, -8.0, 0.0, -14.0, 0.0, -242.0, -6.0, -110.0, 0.0, -25.0, 0.0, 0.0, 0.0, -6.0, -8.0, 0.0, 0.0, -11.0, 0.0, 0.0, -8.0, -13.0, 0.0, 2.0, 0.0, 0.0, 0.0, -116.0, 6.0, 0.0, 0.0, 0.0, 0.0, -12.0, -8.0, 0.0, 0.0, 0.0, 0.0, -11.0, 0.0, 0.0, 12.0, 0.0, -40.0, -1.0, -10.0, 0.0, -17.0, -20.0, -16.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, -9.0, -2.0, 0.0, 0.0, -6.0, 0.0, -4.0, 0.0, -20.0, -46.0, -8.0, 0.0, -41.0, -12.0, 5.0, -18.0, 0.0, 2.0, 0.0, -4.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 1.0, 8.0, -14.0, 0.0, 0.0, 2.0, 0.0, -14.0, -14.0, 0.0, -4.0, -4.0, 0.0, 5.0, 17.0, 0.0, -128.0, 0.0, -12.0, -18.0, 6.0, -206.0, -16.0, 0.0, 0.0, 0.0, 0.0, 0.0, -52.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, -28.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, 11.0, 0.0, 0.0, 0.0, -31.0, 0.0, -8.0, 0.0, -19.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, -238.0, -89.0, 0.0, -8.0, 2.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -18.0, 0.0, 0.0, 19.0, -12.0, 8.0, -22.0, -4.0, 0.0, -238.0, 4.0, -4.0, -15.0, -2.0, -10.0, -18.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 1.0, 0.0, 4.0, 0.0, 6.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 18.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 3.0, 41.0, 1.0, 3.0, 0.0, 7.0, 121.0, 3.0, 1.0, 57.0, 0.0, 16.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 13.0, 4.0, 0.0, 13.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 58.0, 0.0, 0.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 0.0, 0.0, 2.0, 7.0, 3.0, 0.0, 0.0, 20.0, 5.0, 1.0, 9.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 1.0, 0.0, 3.0, 0.0, 2.0, 0.0, 0.0, 10.0, 19.0, 20.0, 0.0, 21.0, 0.0, 6.0, 0.0, 9.0, 0.0, 4.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 6.0, 2.0, 0.0, 0.0, 0.0, 0.0, 1.0, 17.0, 2.0, 0.0, 4.0, 0.0, 0.0, 0.0, 6.0, 58.0, 6.0, 0.0, 11.0, 0.0, 111.0, 1.0, 0.0, 0.0, 0.0, 0.0, 26.0, 14.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 7.0, 11.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 4.0, 12.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 119.0, 48.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 5.0, 0.0, 2.0, 5.0, 3.0, 11.0, 0.0, 119.0, 0.0, 3.0, 0.0, 10.0, 18.0, 5.0, 9.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.66358570502493, "mean_inference_ms": 50.696983780456364, "mean_action_processing_ms": 7.428838415123681, "mean_env_wait_ms": 6.792145784139869, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038477182388305664, "StateBufferConnector_ms": 0.003444194793701172, "ViewRequirementAgentConnector_ms": 0.10486185550689697}, "num_episodes": 27, "episode_return_max": 22.0, "episode_return_min": -160.0, "episode_return_mean": -8.93, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2704000, "num_agent_steps_trained": 2704000, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.0630415034768, "num_env_steps_trained_throughput_per_sec": 303.0630415034768, "timesteps_total": 676000, "num_env_steps_sampled_lifetime": 676000, "num_agent_steps_sampled_lifetime": 2704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2704000, "timers": {"training_iteration_time_ms": 13742.44, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13742.383, "sample_time_ms": 1598.21, "learn_time_ms": 12123.549, "learn_throughput": 329.936, "synch_weights_time_ms": 16.577}, "counters": {"num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 2704000, "num_agent_steps_trained": 2704000}, "done": false, "training_iteration": 169, "trial_id": "f6b99_00000", "date": "2024-08-13_23-17-50", "timestamp": 1723605470, "time_this_iter_s": 13.240688800811768, "time_total_s": 12766.822811365128, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6dbfe50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12766.822811365128, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 51.76842105263158, "ram_util_percent": 80.43684210526315}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8438324069062239, "cur_kl_coeff": 5.827338611652523e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.47914841648132084, "policy_loss": -0.00019410302586577558, "vf_loss": 0.47934251877432443, "vf_explained_var": 0.027140392197502985, "kl": 0.001568313953984439, "entropy": 0.04658431119246103, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 320355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0176405695459199, "cur_kl_coeff": 1.5175360967845104e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4018155865509201, "policy_loss": -0.008588490410949345, "vf_loss": 0.4104040774706783, "vf_explained_var": -0.049549750676230776, "kl": 0.007149006391001233, "entropy": 0.4370680806498048, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 320355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": -160.0, "episode_reward_mean": -6.87, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -238.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 19.0, "predator_policy": 119.0}, "policy_reward_mean": {"prey_policy": -9.5, "predator_policy": 6.065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 2.0, -4.0, 1.0, 3.0, 0.0, -52.0, 0.0, 0.0, -10.0, 0.0, 0.0, -2.0, 15.0, -20.0, -5.0, -8.0, -18.0, 0.0, 1.0, 0.0, -4.0, -1.0, -3.0, -2.0, -10.0, -15.0, -20.0, -1.0, -9.0, 6.0, -2.0, 0.0, 3.0, 0.0, -3.0, 1.0, 2.0, 0.0, 2.0, -10.0, -2.0, 0.0, 22.0, -64.0, -6.0, -1.0, -110.0, 0.0, 0.0, -12.0, 0.0, -1.0, 0.0, -10.0, -5.0, 0.0, 0.0, 4.0, 0.0, -14.0, -4.0, -6.0, 0.0, 0.0, -1.0, -160.0, -4.0, 12.0, 0.0, 0.0, 0.0, -9.0, 21.0, 4.0, -15.0, -119.0, 3.0, 11.0, -14.0, 0.0, 0.0, 0.0, 0.0, -8.0, 0.0, 12.0, -21.0, 0.0, 0.0, 4.0, 2.0, -49.0, 11.0, 0.0, 3.0, 7.0, -1.0, -4.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.0, -8.0, 0.0, 0.0, -11.0, 0.0, 0.0, -8.0, -13.0, 0.0, 2.0, 0.0, 0.0, 0.0, -116.0, 6.0, 0.0, 0.0, 0.0, 0.0, -12.0, -8.0, 0.0, 0.0, 0.0, 0.0, -11.0, 0.0, 0.0, 12.0, 0.0, -40.0, -1.0, -10.0, 0.0, -17.0, -20.0, -16.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, -9.0, -2.0, 0.0, 0.0, -6.0, 0.0, -4.0, 0.0, -20.0, -46.0, -8.0, 0.0, -41.0, -12.0, 5.0, -18.0, 0.0, 2.0, 0.0, -4.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 1.0, 8.0, -14.0, 0.0, 0.0, 2.0, 0.0, -14.0, -14.0, 0.0, -4.0, -4.0, 0.0, 5.0, 17.0, 0.0, -128.0, 0.0, -12.0, -18.0, 6.0, -206.0, -16.0, 0.0, 0.0, 0.0, 0.0, 0.0, -52.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, -28.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, 11.0, 0.0, 0.0, 0.0, -31.0, 0.0, -8.0, 0.0, -19.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, -238.0, -89.0, 0.0, -8.0, 2.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -18.0, 0.0, 0.0, 19.0, -12.0, 8.0, -22.0, -4.0, 0.0, -238.0, 4.0, -4.0, -15.0, -2.0, -10.0, -18.0, 0.0, 0.0, 1.0, -2.0, 0.0, 0.0, 0.0, 0.0, -16.0, 0.0, 0.0, 0.0, -12.0, 5.0, -8.0, -47.0, 0.0, 0.0, 0.0, 0.0, -1.0, 0.0, -8.0, 0.0, 0.0, -98.0, 11.0, 0.0, 0.0, 0.0, 0.0, 3.0, 7.0, 0.0, -84.0, -13.0, -15.0, 0.0], "policy_predator_policy_reward": [0.0, 14.0, 0.0, 0.0, 0.0, 13.0, 4.0, 0.0, 13.0, 1.0, 0.0, 1.0, 0.0, 0.0, 0.0, 58.0, 0.0, 0.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 0.0, 0.0, 2.0, 7.0, 3.0, 0.0, 0.0, 20.0, 5.0, 1.0, 9.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 1.0, 0.0, 3.0, 0.0, 2.0, 0.0, 0.0, 10.0, 19.0, 20.0, 0.0, 21.0, 0.0, 6.0, 0.0, 9.0, 0.0, 4.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 6.0, 2.0, 0.0, 0.0, 0.0, 0.0, 1.0, 17.0, 2.0, 0.0, 4.0, 0.0, 0.0, 0.0, 6.0, 58.0, 6.0, 0.0, 11.0, 0.0, 111.0, 1.0, 0.0, 0.0, 0.0, 0.0, 26.0, 14.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 7.0, 11.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 4.0, 12.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 119.0, 48.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 5.0, 0.0, 2.0, 5.0, 3.0, 11.0, 0.0, 119.0, 0.0, 3.0, 0.0, 10.0, 18.0, 5.0, 9.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 8.0, 11.0, 24.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 10.0, 49.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 51.0, 45.0, 0.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.19677795006536, "mean_inference_ms": 50.658393312379886, "mean_action_processing_ms": 7.38235329030372, "mean_env_wait_ms": 6.3442372945467245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003912568092346191, "StateBufferConnector_ms": 0.003506302833557129, "ViewRequirementAgentConnector_ms": 0.10599410533905029}, "num_episodes": 18, "episode_return_max": 22.0, "episode_return_min": -160.0, "episode_return_mean": -6.87, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.5747270922749, "num_env_steps_trained_throughput_per_sec": 296.5747270922749, "timesteps_total": 680000, "num_env_steps_sampled_lifetime": 680000, "num_agent_steps_sampled_lifetime": 2720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2720000, "timers": {"training_iteration_time_ms": 13779.762, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13779.707, "sample_time_ms": 1604.505, "learn_time_ms": 12154.941, "learn_throughput": 329.084, "synch_weights_time_ms": 16.619}, "counters": {"num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000}, "done": false, "training_iteration": 170, "trial_id": "f6b99_00000", "date": "2024-08-13_23-18-03", "timestamp": 1723605483, "time_this_iter_s": 13.523468017578125, "time_total_s": 12780.346279382706, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6f764c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12780.346279382706, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 54.11052631578948, "ram_util_percent": 83.30526315789474}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8889106894296314, "cur_kl_coeff": 2.9136693058262614e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6753968645340551, "policy_loss": -0.0005816882195335532, "vf_loss": 0.6759785539298145, "vf_explained_var": 0.027730244335043366, "kl": 0.0016039973625919487, "entropy": 0.056410895217525424, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 322245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8488544875943156, "cur_kl_coeff": 1.5175360967845104e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4418131938489972, "policy_loss": -0.008045345148387015, "vf_loss": 0.4498585393222384, "vf_explained_var": 0.008915146601893914, "kl": 0.023922125626340753, "entropy": 0.5775172467269595, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 322245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 2736000, "num_agent_steps_trained": 2736000}, "env_runners": {"episode_reward_max": 24.0, "episode_reward_min": -160.0, "episode_reward_mean": -5.89, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 19.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -10.735, "predator_policy": 7.79}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-18.0, 0.0, 1.0, 0.0, -4.0, -1.0, -3.0, -2.0, -10.0, -15.0, -20.0, -1.0, -9.0, 6.0, -2.0, 0.0, 3.0, 0.0, -3.0, 1.0, 2.0, 0.0, 2.0, -10.0, -2.0, 0.0, 22.0, -64.0, -6.0, -1.0, -110.0, 0.0, 0.0, -12.0, 0.0, -1.0, 0.0, -10.0, -5.0, 0.0, 0.0, 4.0, 0.0, -14.0, -4.0, -6.0, 0.0, 0.0, -1.0, -160.0, -4.0, 12.0, 0.0, 0.0, 0.0, -9.0, 21.0, 4.0, -15.0, -119.0, 3.0, 11.0, -14.0, 0.0, 0.0, 0.0, 0.0, -8.0, 0.0, 12.0, -21.0, 0.0, 0.0, 4.0, 2.0, -49.0, 11.0, 0.0, 3.0, 7.0, -1.0, -4.0, -5.0, 2.0, -8.0, 24.0, 0.0, 0.0, -4.0, 0.0, -7.0, -1.0, 0.0, 0.0, 0.0, 0.0, 9.0, 8.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-20.0, -16.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, -9.0, -2.0, 0.0, 0.0, -6.0, 0.0, -4.0, 0.0, -20.0, -46.0, -8.0, 0.0, -41.0, -12.0, 5.0, -18.0, 0.0, 2.0, 0.0, -4.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 1.0, 8.0, -14.0, 0.0, 0.0, 2.0, 0.0, -14.0, -14.0, 0.0, -4.0, -4.0, 0.0, 5.0, 17.0, 0.0, -128.0, 0.0, -12.0, -18.0, 6.0, -206.0, -16.0, 0.0, 0.0, 0.0, 0.0, 0.0, -52.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, -28.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, 11.0, 0.0, 0.0, 0.0, -31.0, 0.0, -8.0, 0.0, -19.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, -238.0, -89.0, 0.0, -8.0, 2.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -18.0, 0.0, 0.0, 19.0, -12.0, 8.0, -22.0, -4.0, 0.0, -238.0, 4.0, -4.0, -15.0, -2.0, -10.0, -18.0, 0.0, 0.0, 1.0, -2.0, 0.0, 0.0, 0.0, 0.0, -16.0, 0.0, 0.0, 0.0, -12.0, 5.0, -8.0, -47.0, 0.0, 0.0, 0.0, 0.0, -1.0, 0.0, -8.0, 0.0, 0.0, -98.0, 11.0, 0.0, 0.0, 0.0, 0.0, 3.0, 7.0, 0.0, -84.0, -13.0, -15.0, 0.0, -10.0, -15.0, 2.0, 0.0, -400.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, -16.0, -1.0, 0.0, -14.0, 0.0, -4.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, -46.0, 0.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [8.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 1.0, 0.0, 3.0, 0.0, 2.0, 0.0, 0.0, 10.0, 19.0, 20.0, 0.0, 21.0, 0.0, 6.0, 0.0, 9.0, 0.0, 4.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 6.0, 2.0, 0.0, 0.0, 0.0, 0.0, 1.0, 17.0, 2.0, 0.0, 4.0, 0.0, 0.0, 0.0, 6.0, 58.0, 6.0, 0.0, 11.0, 0.0, 111.0, 1.0, 0.0, 0.0, 0.0, 0.0, 26.0, 14.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 7.0, 11.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 4.0, 12.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 119.0, 48.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 5.0, 0.0, 2.0, 5.0, 3.0, 11.0, 0.0, 119.0, 0.0, 3.0, 0.0, 10.0, 18.0, 5.0, 9.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 8.0, 11.0, 24.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 10.0, 49.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 51.0, 45.0, 0.0, 11.0, 9.0, 11.0, 0.0, 0.0, 200.0, 192.0, 7.0, 14.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 1.0, 0.0, 0.0, 7.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 24.0, 30.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.042756161108574, "mean_inference_ms": 50.39611704505955, "mean_action_processing_ms": 7.343903818767571, "mean_env_wait_ms": 6.311162968678227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004210710525512695, "StateBufferConnector_ms": 0.0036624670028686523, "ViewRequirementAgentConnector_ms": 0.10999321937561035}, "num_episodes": 18, "episode_return_max": 24.0, "episode_return_min": -160.0, "episode_return_mean": -5.89, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2736000, "num_agent_steps_trained": 2736000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.4832869409893, "num_env_steps_trained_throughput_per_sec": 301.4832869409893, "timesteps_total": 684000, "num_env_steps_sampled_lifetime": 684000, "num_agent_steps_sampled_lifetime": 2736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2736000, "timers": {"training_iteration_time_ms": 13473.741, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13473.69, "sample_time_ms": 1605.734, "learn_time_ms": 11847.435, "learn_throughput": 337.626, "synch_weights_time_ms": 17.736}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 2736000, "num_agent_steps_trained": 2736000}, "done": false, "training_iteration": 171, "trial_id": "f6b99_00000", "date": "2024-08-13_23-18-17", "timestamp": 1723605497, "time_this_iter_s": 13.326022863388062, "time_total_s": 12793.672302246094, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6f4caf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12793.672302246094, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 49.968421052631584, "ram_util_percent": 83.47894736842105}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0340424128113286, "cur_kl_coeff": 1.4568346529131307e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5252966998115418, "policy_loss": -0.001720329768531931, "vf_loss": 0.5270170297099169, "vf_explained_var": 0.03339833585673539, "kl": 0.0013921201639104286, "entropy": 0.05944498216082889, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 324135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2838117372658517, "cur_kl_coeff": 2.2763041451767667e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5145645710368636, "policy_loss": -0.009046699831917606, "vf_loss": 0.5236112724031228, "vf_explained_var": 0.030774507163062927, "kl": 0.00627085905417304, "entropy": 0.7331722853044984, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 324135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 2752000, "num_agent_steps_trained": 2752000}, "env_runners": {"episode_reward_max": 24.0, "episode_reward_min": -195.0, "episode_reward_mean": -7.39, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 19.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -12.795, "predator_policy": 9.1}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, 1.0, 2.0, 0.0, 2.0, -10.0, -2.0, 0.0, 22.0, -64.0, -6.0, -1.0, -110.0, 0.0, 0.0, -12.0, 0.0, -1.0, 0.0, -10.0, -5.0, 0.0, 0.0, 4.0, 0.0, -14.0, -4.0, -6.0, 0.0, 0.0, -1.0, -160.0, -4.0, 12.0, 0.0, 0.0, 0.0, -9.0, 21.0, 4.0, -15.0, -119.0, 3.0, 11.0, -14.0, 0.0, 0.0, 0.0, 0.0, -8.0, 0.0, 12.0, -21.0, 0.0, 0.0, 4.0, 2.0, -49.0, 11.0, 0.0, 3.0, 7.0, -1.0, -4.0, -5.0, 2.0, -8.0, 24.0, 0.0, 0.0, -4.0, 0.0, -7.0, -1.0, 0.0, 0.0, 0.0, 0.0, 9.0, 8.0, 0.0, 0.0, -195.0, -4.0, -6.0, 5.0, 0.0, 18.0, 0.0, 0.0, 0.0, 0.0, -4.0, -10.0, 0.0, 0.0, -8.0, 0.0, -1.0, -20.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -6.0, 0.0, 1.0, 8.0, -14.0, 0.0, 0.0, 2.0, 0.0, -14.0, -14.0, 0.0, -4.0, -4.0, 0.0, 5.0, 17.0, 0.0, -128.0, 0.0, -12.0, -18.0, 6.0, -206.0, -16.0, 0.0, 0.0, 0.0, 0.0, 0.0, -52.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, -28.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, 11.0, 0.0, 0.0, 0.0, -31.0, 0.0, -8.0, 0.0, -19.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, -238.0, -89.0, 0.0, -8.0, 2.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -18.0, 0.0, 0.0, 19.0, -12.0, 8.0, -22.0, -4.0, 0.0, -238.0, 4.0, -4.0, -15.0, -2.0, -10.0, -18.0, 0.0, 0.0, 1.0, -2.0, 0.0, 0.0, 0.0, 0.0, -16.0, 0.0, 0.0, 0.0, -12.0, 5.0, -8.0, -47.0, 0.0, 0.0, 0.0, 0.0, -1.0, 0.0, -8.0, 0.0, 0.0, -98.0, 11.0, 0.0, 0.0, 0.0, 0.0, 3.0, 7.0, 0.0, -84.0, -13.0, -15.0, 0.0, -10.0, -15.0, 2.0, 0.0, -400.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, -16.0, -1.0, 0.0, -14.0, 0.0, -4.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, -46.0, 0.0, 0.0, 0.0, 0.0, 0.0, -390.0, 0.0, -8.0, -10.0, -4.0, -82.0, 17.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -18.0, 5.0, 0.0, -20.0, 0.0, 0.0, -5.0, -5.0, -16.0, 0.0, -1.0, 0.0, -26.0, 9.0, -60.0, 0.0], "policy_predator_policy_reward": [0.0, 3.0, 0.0, 0.0, 6.0, 2.0, 0.0, 0.0, 0.0, 0.0, 1.0, 17.0, 2.0, 0.0, 4.0, 0.0, 0.0, 0.0, 6.0, 58.0, 6.0, 0.0, 11.0, 0.0, 111.0, 1.0, 0.0, 0.0, 0.0, 0.0, 26.0, 14.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 7.0, 11.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 4.0, 12.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 119.0, 48.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 5.0, 0.0, 2.0, 5.0, 3.0, 11.0, 0.0, 119.0, 0.0, 3.0, 0.0, 10.0, 18.0, 5.0, 9.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 8.0, 11.0, 24.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 10.0, 49.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 51.0, 45.0, 0.0, 11.0, 9.0, 11.0, 0.0, 0.0, 200.0, 192.0, 7.0, 14.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 1.0, 0.0, 0.0, 7.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 24.0, 30.0, 0.0, 0.0, 0.0, 0.0, 195.0, 0.0, 4.0, 0.0, 6.0, 2.0, 29.0, 41.0, 0.0, 0.0, 10.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 10.0, 0.0, 0.0, 9.0, 1.0, 0.0, 8.0, 0.0, 1.0, 8.0, 8.0, 6.0, 34.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.890526070748336, "mean_inference_ms": 50.13694343547903, "mean_action_processing_ms": 7.305930236336187, "mean_env_wait_ms": 6.278507299524177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004257321357727051, "StateBufferConnector_ms": 0.003553152084350586, "ViewRequirementAgentConnector_ms": 0.11395037174224854}, "num_episodes": 18, "episode_return_max": 24.0, "episode_return_min": -195.0, "episode_return_mean": -7.39, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2752000, "num_agent_steps_trained": 2752000, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.0546483387628, "num_env_steps_trained_throughput_per_sec": 300.0546483387628, "timesteps_total": 688000, "num_env_steps_sampled_lifetime": 688000, "num_agent_steps_sampled_lifetime": 2752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2752000, "timers": {"training_iteration_time_ms": 13304.281, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13304.226, "sample_time_ms": 1594.18, "learn_time_ms": 11688.892, "learn_throughput": 342.205, "synch_weights_time_ms": 18.339}, "counters": {"num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 2752000, "num_agent_steps_trained": 2752000}, "done": false, "training_iteration": 172, "trial_id": "f6b99_00000", "date": "2024-08-13_23-18-30", "timestamp": 1723605510, "time_this_iter_s": 13.387328863143921, "time_total_s": 12807.059631109238, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6d711f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12807.059631109238, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 52.61052631578947, "ram_util_percent": 83.62105263157895}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9734809759038466, "cur_kl_coeff": 7.284173264565654e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.207889884695529, "policy_loss": -0.003668185122182997, "vf_loss": 0.2115580699866682, "vf_explained_var": 0.09070125083443979, "kl": 0.0033422349456260526, "entropy": 0.056307521514427014, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 326025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5757294852503394, "cur_kl_coeff": 2.2763041451767667e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.304912459046368, "policy_loss": -0.0034653623085764665, "vf_loss": 0.30837781981542883, "vf_explained_var": 0.14680069962506573, "kl": 0.006588155253387403, "entropy": 0.7991674855272606, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 326025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 2768000, "num_agent_steps_trained": 2768000}, "env_runners": {"episode_reward_max": 29.0, "episode_reward_min": -195.0, "episode_reward_mean": -5.55, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 19.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -11.34, "predator_policy": 8.565}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.0, 0.0, -14.0, -4.0, -6.0, 0.0, 0.0, -1.0, -160.0, -4.0, 12.0, 0.0, 0.0, 0.0, -9.0, 21.0, 4.0, -15.0, -119.0, 3.0, 11.0, -14.0, 0.0, 0.0, 0.0, 0.0, -8.0, 0.0, 12.0, -21.0, 0.0, 0.0, 4.0, 2.0, -49.0, 11.0, 0.0, 3.0, 7.0, -1.0, -4.0, -5.0, 2.0, -8.0, 24.0, 0.0, 0.0, -4.0, 0.0, -7.0, -1.0, 0.0, 0.0, 0.0, 0.0, 9.0, 8.0, 0.0, 0.0, -195.0, -4.0, -6.0, 5.0, 0.0, 18.0, 0.0, 0.0, 0.0, 0.0, -4.0, -10.0, 0.0, 0.0, -8.0, 0.0, -1.0, -20.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, -7.0, 0.0, 0.0, -3.0, 0.0, 5.0, 0.0, -8.0, 1.0, -15.0, 0.0, -1.0, 0.0, 0.0, -11.0, 29.0, -22.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-14.0, 11.0, 0.0, 0.0, 0.0, -31.0, 0.0, -8.0, 0.0, -19.0, 0.0, 0.0, 0.0, 0.0, -2.0, 0.0, -238.0, -89.0, 0.0, -8.0, 2.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -18.0, 0.0, 0.0, 19.0, -12.0, 8.0, -22.0, -4.0, 0.0, -238.0, 4.0, -4.0, -15.0, -2.0, -10.0, -18.0, 0.0, 0.0, 1.0, -2.0, 0.0, 0.0, 0.0, 0.0, -16.0, 0.0, 0.0, 0.0, -12.0, 5.0, -8.0, -47.0, 0.0, 0.0, 0.0, 0.0, -1.0, 0.0, -8.0, 0.0, 0.0, -98.0, 11.0, 0.0, 0.0, 0.0, 0.0, 3.0, 7.0, 0.0, -84.0, -13.0, -15.0, 0.0, -10.0, -15.0, 2.0, 0.0, -400.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, -16.0, -1.0, 0.0, -14.0, 0.0, -4.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, -46.0, 0.0, 0.0, 0.0, 0.0, 0.0, -390.0, 0.0, -8.0, -10.0, -4.0, -82.0, 17.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -18.0, 5.0, 0.0, -20.0, 0.0, 0.0, -5.0, -5.0, -16.0, 0.0, -1.0, 0.0, -26.0, 9.0, -60.0, 0.0, -16.0, -11.0, 0.0, 0.0, 0.0, 0.0, 5.0, 14.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, -16.0, 4.0, -12.0, -39.0, 0.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, -25.0, -28.0, 0.0, 6.0, 0.0, -53.0], "policy_predator_policy_reward": [7.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 4.0, 12.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 119.0, 48.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 5.0, 0.0, 2.0, 5.0, 3.0, 11.0, 0.0, 119.0, 0.0, 3.0, 0.0, 10.0, 18.0, 5.0, 9.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 8.0, 11.0, 24.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 10.0, 49.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 51.0, 45.0, 0.0, 11.0, 9.0, 11.0, 0.0, 0.0, 200.0, 192.0, 7.0, 14.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 1.0, 0.0, 0.0, 7.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 24.0, 30.0, 0.0, 0.0, 0.0, 0.0, 195.0, 0.0, 4.0, 0.0, 6.0, 2.0, 29.0, 41.0, 0.0, 0.0, 10.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 10.0, 0.0, 0.0, 9.0, 1.0, 0.0, 8.0, 0.0, 1.0, 8.0, 8.0, 6.0, 34.0, 15.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 6.0, 3.0, 0.0, 24.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 29.0, 13.0, 9.0, 14.0, 31.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 29.294138197581344, "mean_inference_ms": 49.48278265778115, "mean_action_processing_ms": 7.60537366068574, "mean_env_wait_ms": 6.379527868863887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00445556640625, "StateBufferConnector_ms": 0.003571629524230957, "ViewRequirementAgentConnector_ms": 0.11588621139526367}, "num_episodes": 23, "episode_return_max": 29.0, "episode_return_min": -195.0, "episode_return_mean": -5.55, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2768000, "num_agent_steps_trained": 2768000, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.86600254220633, "num_env_steps_trained_throughput_per_sec": 312.86600254220633, "timesteps_total": 692000, "num_env_steps_sampled_lifetime": 692000, "num_agent_steps_sampled_lifetime": 2768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2768000, "timers": {"training_iteration_time_ms": 13066.959, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13066.905, "sample_time_ms": 1550.063, "learn_time_ms": 11495.733, "learn_throughput": 347.955, "synch_weights_time_ms": 18.644}, "counters": {"num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 2768000, "num_agent_steps_trained": 2768000}, "done": false, "training_iteration": 173, "trial_id": "f6b99_00000", "date": "2024-08-13_23-18-43", "timestamp": 1723605523, "time_this_iter_s": 12.827107906341553, "time_total_s": 12819.88673901558, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6db9ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12819.88673901558, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 48.352631578947374, "ram_util_percent": 83.15789473684211}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8383231282313034, "cur_kl_coeff": 3.642086632282827e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6235315064273814, "policy_loss": -0.0007152770774034911, "vf_loss": 0.6242467828553229, "vf_explained_var": 0.01321571116094236, "kl": 0.0016120701951092451, "entropy": 0.06571444539864801, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 327915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.72896667461862, "cur_kl_coeff": 2.2763041451767667e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2766971258417008, "policy_loss": -0.005014892579327342, "vf_loss": 1.2817120207995965, "vf_explained_var": 0.01922199155287768, "kl": 0.008251761700404089, "entropy": 0.7839668709449668, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 327915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 2784000, "num_agent_steps_trained": 2784000}, "env_runners": {"episode_reward_max": 59.0, "episode_reward_min": -195.0, "episode_reward_mean": -3.53, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 59.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -10.38, "predator_policy": 8.615}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, -8.0, 0.0, 12.0, -21.0, 0.0, 0.0, 4.0, 2.0, -49.0, 11.0, 0.0, 3.0, 7.0, -1.0, -4.0, -5.0, 2.0, -8.0, 24.0, 0.0, 0.0, -4.0, 0.0, -7.0, -1.0, 0.0, 0.0, 0.0, 0.0, 9.0, 8.0, 0.0, 0.0, -195.0, -4.0, -6.0, 5.0, 0.0, 18.0, 0.0, 0.0, 0.0, 0.0, -4.0, -10.0, 0.0, 0.0, -8.0, 0.0, -1.0, -20.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, -7.0, 0.0, 0.0, -3.0, 0.0, 5.0, 0.0, -8.0, 1.0, -15.0, 0.0, -1.0, 0.0, 0.0, -11.0, 29.0, -22.0, 7.0, -9.0, -7.0, 15.0, 0.0, 0.0, 0.0, -21.0, 0.0, 22.0, 3.0, 39.0, 18.0, 19.0, -141.0, 59.0, 0.0, -8.0, -4.0, -99.0, 11.0, 7.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 1.0, -2.0, 0.0, 0.0, 0.0, 0.0, -16.0, 0.0, 0.0, 0.0, -12.0, 5.0, -8.0, -47.0, 0.0, 0.0, 0.0, 0.0, -1.0, 0.0, -8.0, 0.0, 0.0, -98.0, 11.0, 0.0, 0.0, 0.0, 0.0, 3.0, 7.0, 0.0, -84.0, -13.0, -15.0, 0.0, -10.0, -15.0, 2.0, 0.0, -400.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, -16.0, -1.0, 0.0, -14.0, 0.0, -4.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, -46.0, 0.0, 0.0, 0.0, 0.0, 0.0, -390.0, 0.0, -8.0, -10.0, -4.0, -82.0, 17.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -18.0, 5.0, 0.0, -20.0, 0.0, 0.0, -5.0, -5.0, -16.0, 0.0, -1.0, 0.0, -26.0, 9.0, -60.0, 0.0, -16.0, -11.0, 0.0, 0.0, 0.0, 0.0, 5.0, 14.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, -16.0, 4.0, -12.0, -39.0, 0.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, -25.0, -28.0, 0.0, 6.0, 0.0, -53.0, 0.0, 7.0, -30.0, 6.0, -12.0, -6.0, 0.0, 10.0, 0.0, 0.0, 0.0, -5.0, 0.0, 0.0, -18.0, -14.0, 0.0, 0.0, 22.0, 0.0, -4.0, 0.0, 12.0, 26.0, 0.0, 1.0, 4.0, 0.0, -361.0, 36.0, 59.0, 0.0, 0.0, 0.0, 0.0, -16.0, -8.0, 0.0, -198.0, 0.0, 14.0, -6.0, -25.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 8.0, 11.0, 24.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 10.0, 49.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 51.0, 45.0, 0.0, 11.0, 9.0, 11.0, 0.0, 0.0, 200.0, 192.0, 7.0, 14.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 1.0, 0.0, 0.0, 7.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 24.0, 30.0, 0.0, 0.0, 0.0, 0.0, 195.0, 0.0, 4.0, 0.0, 6.0, 2.0, 29.0, 41.0, 0.0, 0.0, 10.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 10.0, 0.0, 0.0, 9.0, 1.0, 0.0, 8.0, 0.0, 1.0, 8.0, 8.0, 6.0, 34.0, 15.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 6.0, 3.0, 0.0, 24.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 29.0, 13.0, 9.0, 14.0, 31.0, 0.0, 0.0, 0.0, 15.0, 0.0, 6.0, 5.0, 5.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 1.0, 0.0, 7.0, 10.0, 8.0, 7.0, 0.0, 184.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 4.0, 0.0, 99.0, 0.0, 3.0, 21.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.526966614742445, "mean_inference_ms": 49.516958301962475, "mean_action_processing_ms": 7.21596273916999, "mean_env_wait_ms": 6.199228052927888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043669939041137695, "StateBufferConnector_ms": 0.003301382064819336, "ViewRequirementAgentConnector_ms": 0.11138534545898438}, "num_episodes": 22, "episode_return_max": 59.0, "episode_return_min": -195.0, "episode_return_mean": -3.53, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2784000, "num_agent_steps_trained": 2784000, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.65304685458904, "num_env_steps_trained_throughput_per_sec": 300.65304685458904, "timesteps_total": 696000, "num_env_steps_sampled_lifetime": 696000, "num_agent_steps_sampled_lifetime": 2784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2784000, "timers": {"training_iteration_time_ms": 13079.912, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13079.858, "sample_time_ms": 1529.634, "learn_time_ms": 11529.349, "learn_throughput": 346.941, "synch_weights_time_ms": 18.251}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 2784000, "num_agent_steps_trained": 2784000}, "done": false, "training_iteration": 174, "trial_id": "f6b99_00000", "date": "2024-08-13_23-18-56", "timestamp": 1723605536, "time_this_iter_s": 13.35149621963501, "time_total_s": 12833.238235235214, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6db9040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12833.238235235214, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 50.06315789473685, "ram_util_percent": 83.03684210526316}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.708029203944736, "cur_kl_coeff": 1.8210433161414134e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3395879344650046, "policy_loss": -0.002447397514152779, "vf_loss": 0.34203533154429383, "vf_explained_var": 0.07716677797534478, "kl": 0.0016751122642019972, "entropy": 0.046388606281665266, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 329805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1158584537329497, "cur_kl_coeff": 2.2763041451767667e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6058254967290888, "policy_loss": -0.012329116394674336, "vf_loss": 1.6181546139654028, "vf_explained_var": 0.18755640529450915, "kl": 0.013965172623989767, "entropy": 0.9721849038802758, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 329805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000}, "env_runners": {"episode_reward_max": 126.0, "episode_reward_min": -195.0, "episode_reward_mean": 0.91, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -400.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 77.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -7.505, "predator_policy": 7.96}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, -5.0, 2.0, -8.0, 24.0, 0.0, 0.0, -4.0, 0.0, -7.0, -1.0, 0.0, 0.0, 0.0, 0.0, 9.0, 8.0, 0.0, 0.0, -195.0, -4.0, -6.0, 5.0, 0.0, 18.0, 0.0, 0.0, 0.0, 0.0, -4.0, -10.0, 0.0, 0.0, -8.0, 0.0, -1.0, -20.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, -7.0, 0.0, 0.0, -3.0, 0.0, 5.0, 0.0, -8.0, 1.0, -15.0, 0.0, -1.0, 0.0, 0.0, -11.0, 29.0, -22.0, 7.0, -9.0, -7.0, 15.0, 0.0, 0.0, 0.0, -21.0, 0.0, 22.0, 3.0, 39.0, 18.0, 19.0, -141.0, 59.0, 0.0, -8.0, -4.0, -99.0, 11.0, 7.0, -7.0, 34.0, 126.0, -38.0, 81.0, 12.0, -3.0, 19.0, 7.0, -8.0, 0.0, 14.0, 8.0, 5.0, 31.0, 46.0, 77.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-15.0, 0.0, -10.0, -15.0, 2.0, 0.0, -400.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, -16.0, -1.0, 0.0, -14.0, 0.0, -4.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, -46.0, 0.0, 0.0, 0.0, 0.0, 0.0, -390.0, 0.0, -8.0, -10.0, -4.0, -82.0, 17.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -18.0, 5.0, 0.0, -20.0, 0.0, 0.0, -5.0, -5.0, -16.0, 0.0, -1.0, 0.0, -26.0, 9.0, -60.0, 0.0, -16.0, -11.0, 0.0, 0.0, 0.0, 0.0, 5.0, 14.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, -16.0, 4.0, -12.0, -39.0, 0.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, -25.0, -28.0, 0.0, 6.0, 0.0, -53.0, 0.0, 7.0, -30.0, 6.0, -12.0, -6.0, 0.0, 10.0, 0.0, 0.0, 0.0, -5.0, 0.0, 0.0, -18.0, -14.0, 0.0, 0.0, 22.0, 0.0, -4.0, 0.0, 12.0, 26.0, 0.0, 1.0, 4.0, 0.0, -361.0, 36.0, 59.0, 0.0, 0.0, 0.0, 0.0, -16.0, -8.0, 0.0, -198.0, 0.0, 14.0, -6.0, -25.0, 0.0, -4.0, -34.0, 34.0, 0.0, 60.0, 66.0, -18.0, -40.0, 74.0, -4.0, 0.0, 12.0, 0.0, -9.0, 20.0, -2.0, 5.0, 1.0, 0.0, -16.0, 0.0, 0.0, -8.0, 14.0, 0.0, 8.0, -6.0, 8.0, 22.0, 7.0, 43.0, 3.0, 77.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 11.0, 9.0, 11.0, 0.0, 0.0, 200.0, 192.0, 7.0, 14.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 1.0, 0.0, 0.0, 7.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 24.0, 30.0, 0.0, 0.0, 0.0, 0.0, 195.0, 0.0, 4.0, 0.0, 6.0, 2.0, 29.0, 41.0, 0.0, 0.0, 10.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 10.0, 0.0, 0.0, 9.0, 1.0, 0.0, 8.0, 0.0, 1.0, 8.0, 8.0, 6.0, 34.0, 15.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 6.0, 3.0, 0.0, 24.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 29.0, 13.0, 9.0, 14.0, 31.0, 0.0, 0.0, 0.0, 15.0, 0.0, 6.0, 5.0, 5.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 1.0, 0.0, 7.0, 10.0, 8.0, 7.0, 0.0, 184.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 4.0, 0.0, 99.0, 0.0, 3.0, 21.0, 11.0, 17.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 8.0, 3.0, 0.0, 0.0, 6.0, 0.0, 0.0, 1.0, 1.0, 0.0, 8.0, 0.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.380099775742757, "mean_inference_ms": 49.26700863710379, "mean_action_processing_ms": 7.179358232155761, "mean_env_wait_ms": 6.167731732252882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004348278045654297, "StateBufferConnector_ms": 0.003270745277404785, "ViewRequirementAgentConnector_ms": 0.11186027526855469}, "num_episodes": 18, "episode_return_max": 126.0, "episode_return_min": -195.0, "episode_return_mean": 0.91, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.18698061229304, "num_env_steps_trained_throughput_per_sec": 290.18698061229304, "timesteps_total": 700000, "num_env_steps_sampled_lifetime": 700000, "num_agent_steps_sampled_lifetime": 2800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2800000, "timers": {"training_iteration_time_ms": 13151.005, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13150.951, "sample_time_ms": 1539.059, "learn_time_ms": 11590.499, "learn_throughput": 345.11, "synch_weights_time_ms": 18.522}, "counters": {"num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000}, "done": false, "training_iteration": 175, "trial_id": "f6b99_00000", "date": "2024-08-13_23-19-10", "timestamp": 1723605550, "time_this_iter_s": 13.832985877990723, "time_total_s": 12847.071221113205, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6f4c820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12847.071221113205, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 50.963157894736845, "ram_util_percent": 83.46315789473685}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8224776969227211, "cur_kl_coeff": 9.105216580707067e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4649549326489842, "policy_loss": -0.0022149287309576435, "vf_loss": 0.4671698604269377, "vf_explained_var": 0.05230076026033472, "kl": 0.0018715460020909934, "entropy": 0.03467308022057214, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 331695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8331246184924292, "cur_kl_coeff": 2.2763041451767667e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0714852697634822, "policy_loss": 7.357011504826092e-05, "vf_loss": 3.071411687482602, "vf_explained_var": 0.27361815748391327, "kl": 0.014531934294537582, "entropy": 0.9245038578434596, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 331695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 2816000, "num_agent_steps_trained": 2816000}, "env_runners": {"episode_reward_max": 151.0, "episode_reward_min": -195.0, "episode_reward_mean": 7.85, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -390.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 151.0, "predator_policy": 195.0}, "policy_reward_mean": {"prey_policy": -2.31, "predator_policy": 6.235}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -195.0, -4.0, -6.0, 5.0, 0.0, 18.0, 0.0, 0.0, 0.0, 0.0, -4.0, -10.0, 0.0, 0.0, -8.0, 0.0, -1.0, -20.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, -7.0, 0.0, 0.0, -3.0, 0.0, 5.0, 0.0, -8.0, 1.0, -15.0, 0.0, -1.0, 0.0, 0.0, -11.0, 29.0, -22.0, 7.0, -9.0, -7.0, 15.0, 0.0, 0.0, 0.0, -21.0, 0.0, 22.0, 3.0, 39.0, 18.0, 19.0, -141.0, 59.0, 0.0, -8.0, -4.0, -99.0, 11.0, 7.0, -7.0, 34.0, 126.0, -38.0, 81.0, 12.0, -3.0, 19.0, 7.0, -8.0, 0.0, 14.0, 8.0, 5.0, 31.0, 46.0, 77.0, 0.0, 27.0, 131.0, 120.0, -2.0, 0.0, 151.0, -11.0, 28.0, 141.0, 8.0, 0.0, -4.0, 0.0, -7.0, 112.0, 0.0, -13.0, 27.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, -390.0, 0.0, -8.0, -10.0, -4.0, -82.0, 17.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -18.0, 5.0, 0.0, -20.0, 0.0, 0.0, -5.0, -5.0, -16.0, 0.0, -1.0, 0.0, -26.0, 9.0, -60.0, 0.0, -16.0, -11.0, 0.0, 0.0, 0.0, 0.0, 5.0, 14.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, -16.0, 4.0, -12.0, -39.0, 0.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, -25.0, -28.0, 0.0, 6.0, 0.0, -53.0, 0.0, 7.0, -30.0, 6.0, -12.0, -6.0, 0.0, 10.0, 0.0, 0.0, 0.0, -5.0, 0.0, 0.0, -18.0, -14.0, 0.0, 0.0, 22.0, 0.0, -4.0, 0.0, 12.0, 26.0, 0.0, 1.0, 4.0, 0.0, -361.0, 36.0, 59.0, 0.0, 0.0, 0.0, 0.0, -16.0, -8.0, 0.0, -198.0, 0.0, 14.0, -6.0, -25.0, 0.0, -4.0, -34.0, 34.0, 0.0, 60.0, 66.0, -18.0, -40.0, 74.0, -4.0, 0.0, 12.0, 0.0, -9.0, 20.0, -2.0, 5.0, 1.0, 0.0, -16.0, 0.0, 0.0, -8.0, 14.0, 0.0, 8.0, -6.0, 8.0, 22.0, 7.0, 43.0, 3.0, 77.0, 0.0, 0.0, 0.0, 0.0, 27.0, 0.0, 131.0, 0.0, 72.0, 20.0, -44.0, 0.0, 0.0, 151.0, 0.0, -14.0, -8.0, 0.0, -8.0, -22.0, 146.0, 3.0, 5.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 106.0, 0.0, 0.0, -26.0, 0.0, 21.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 195.0, 0.0, 4.0, 0.0, 6.0, 2.0, 29.0, 41.0, 0.0, 0.0, 10.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 10.0, 0.0, 0.0, 9.0, 1.0, 0.0, 8.0, 0.0, 1.0, 8.0, 8.0, 6.0, 34.0, 15.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 6.0, 3.0, 0.0, 24.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 29.0, 13.0, 9.0, 14.0, 31.0, 0.0, 0.0, 0.0, 15.0, 0.0, 6.0, 5.0, 5.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 1.0, 0.0, 7.0, 10.0, 8.0, 7.0, 0.0, 184.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 4.0, 0.0, 99.0, 0.0, 3.0, 21.0, 11.0, 17.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 8.0, 3.0, 0.0, 0.0, 6.0, 0.0, 0.0, 1.0, 1.0, 0.0, 8.0, 0.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 29.0, 0.0, 22.0, 0.0, 0.0, 0.0, 0.0, 7.0, 4.0, 0.0, 36.0, 6.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 7.0, 0.0, 6.0, 0.0, 0.0, 0.0, 13.0, 0.0, 6.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.234956006564595, "mean_inference_ms": 49.019947612598806, "mean_action_processing_ms": 7.143154224638355, "mean_env_wait_ms": 6.1366125121425625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004263758659362793, "StateBufferConnector_ms": 0.003263711929321289, "ViewRequirementAgentConnector_ms": 0.11427438259124756}, "num_episodes": 18, "episode_return_max": 151.0, "episode_return_min": -195.0, "episode_return_mean": 7.85, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2816000, "num_agent_steps_trained": 2816000, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.3713649075199, "num_env_steps_trained_throughput_per_sec": 310.3713649075199, "timesteps_total": 704000, "num_env_steps_sampled_lifetime": 704000, "num_agent_steps_sampled_lifetime": 2816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2816000, "timers": {"training_iteration_time_ms": 13207.004, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13206.945, "sample_time_ms": 1529.225, "learn_time_ms": 11656.004, "learn_throughput": 343.171, "synch_weights_time_ms": 18.822}, "counters": {"num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 2816000, "num_agent_steps_trained": 2816000}, "done": false, "training_iteration": 176, "trial_id": "f6b99_00000", "date": "2024-08-13_23-19-23", "timestamp": 1723605563, "time_this_iter_s": 12.936376094818115, "time_total_s": 12860.007597208023, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6f4cf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12860.007597208023, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 49.189473684210526, "ram_util_percent": 83.35263157894735}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4377443407578443, "cur_kl_coeff": 4.5526082903535335e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.46774532949482955, "policy_loss": -0.0034153100466552786, "vf_loss": 0.47116064013070647, "vf_explained_var": 0.04045120982265977, "kl": 0.003840104102976666, "entropy": 0.04913229923251839, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 333585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.800137849664562, "cur_kl_coeff": 2.2763041451767667e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3856622483364487, "policy_loss": -0.004533759044069383, "vf_loss": 2.3901960061971472, "vf_explained_var": 0.32065634907238066, "kl": 0.017016714248161667, "entropy": 1.0044241350163858, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 333585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 2832000, "num_agent_steps_trained": 2832000}, "env_runners": {"episode_reward_max": 268.0, "episode_reward_min": -141.0, "episode_reward_mean": 25.87, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -361.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 155.0, "predator_policy": 184.0}, "policy_reward_mean": {"prey_policy": 7.535, "predator_policy": 5.4}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, -7.0, 0.0, 0.0, -3.0, 0.0, 5.0, 0.0, -8.0, 1.0, -15.0, 0.0, -1.0, 0.0, 0.0, -11.0, 29.0, -22.0, 7.0, -9.0, -7.0, 15.0, 0.0, 0.0, 0.0, -21.0, 0.0, 22.0, 3.0, 39.0, 18.0, 19.0, -141.0, 59.0, 0.0, -8.0, -4.0, -99.0, 11.0, 7.0, -7.0, 34.0, 126.0, -38.0, 81.0, 12.0, -3.0, 19.0, 7.0, -8.0, 0.0, 14.0, 8.0, 5.0, 31.0, 46.0, 77.0, 0.0, 27.0, 131.0, 120.0, -2.0, 0.0, 151.0, -11.0, 28.0, 141.0, 8.0, 0.0, -4.0, 0.0, -7.0, 112.0, 0.0, -13.0, 27.0, 0.0, 139.0, 104.0, 2.0, 268.0, 148.0, 106.0, -18.0, -3.0, 214.0, 267.0, 58.0, 172.0, 0.0, 127.0, -8.0, 21.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-60.0, 0.0, -16.0, -11.0, 0.0, 0.0, 0.0, 0.0, 5.0, 14.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, -16.0, 4.0, -12.0, -39.0, 0.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0, 0.0, 0.0, -25.0, -28.0, 0.0, 6.0, 0.0, -53.0, 0.0, 7.0, -30.0, 6.0, -12.0, -6.0, 0.0, 10.0, 0.0, 0.0, 0.0, -5.0, 0.0, 0.0, -18.0, -14.0, 0.0, 0.0, 22.0, 0.0, -4.0, 0.0, 12.0, 26.0, 0.0, 1.0, 4.0, 0.0, -361.0, 36.0, 59.0, 0.0, 0.0, 0.0, 0.0, -16.0, -8.0, 0.0, -198.0, 0.0, 14.0, -6.0, -25.0, 0.0, -4.0, -34.0, 34.0, 0.0, 60.0, 66.0, -18.0, -40.0, 74.0, -4.0, 0.0, 12.0, 0.0, -9.0, 20.0, -2.0, 5.0, 1.0, 0.0, -16.0, 0.0, 0.0, -8.0, 14.0, 0.0, 8.0, -6.0, 8.0, 22.0, 7.0, 43.0, 3.0, 77.0, 0.0, 0.0, 0.0, 0.0, 27.0, 0.0, 131.0, 0.0, 72.0, 20.0, -44.0, 0.0, 0.0, 151.0, 0.0, -14.0, -8.0, 0.0, -8.0, -22.0, 146.0, 3.0, 5.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 106.0, 0.0, 0.0, -26.0, 0.0, 21.0, 0.0, 0.0, 0.0, 0.0, 127.0, 43.0, 0.0, -7.0, 0.0, 139.0, 129.0, 0.0, 147.0, 98.0, 7.0, 0.0, -58.0, 0.0, -6.0, 77.0, 126.0, 112.0, 143.0, 58.0, 0.0, 155.0, 14.0, 0.0, 0.0, 113.0, 0.0, 0.0, -16.0, 0.0, 21.0, 0.0, 0.0], "policy_predator_policy_reward": [6.0, 34.0, 15.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 4.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 6.0, 3.0, 0.0, 24.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 29.0, 13.0, 9.0, 14.0, 31.0, 0.0, 0.0, 0.0, 15.0, 0.0, 6.0, 5.0, 5.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 1.0, 0.0, 7.0, 10.0, 8.0, 7.0, 0.0, 184.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 4.0, 0.0, 99.0, 0.0, 3.0, 21.0, 11.0, 17.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 8.0, 3.0, 0.0, 0.0, 6.0, 0.0, 0.0, 1.0, 1.0, 0.0, 8.0, 0.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 29.0, 0.0, 22.0, 0.0, 0.0, 0.0, 0.0, 7.0, 4.0, 0.0, 36.0, 6.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 7.0, 0.0, 6.0, 0.0, 0.0, 0.0, 13.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 12.0, 28.0, 33.0, 9.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 4.0, 36.0, 3.0, 0.0, 4.0, 7.0, 0.0, 12.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 10.0, 4.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.091539112185966, "mean_inference_ms": 48.77582121230034, "mean_action_processing_ms": 7.1073686652849775, "mean_env_wait_ms": 6.105854775955286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042383670806884766, "StateBufferConnector_ms": 0.003250718116760254, "ViewRequirementAgentConnector_ms": 0.10876309871673584}, "num_episodes": 18, "episode_return_max": 268.0, "episode_return_min": -141.0, "episode_return_mean": 25.87, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2832000, "num_agent_steps_trained": 2832000, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 293.89685500604816, "num_env_steps_trained_throughput_per_sec": 293.89685500604816, "timesteps_total": 708000, "num_env_steps_sampled_lifetime": 708000, "num_agent_steps_sampled_lifetime": 2832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2832000, "timers": {"training_iteration_time_ms": 13271.961, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13271.9, "sample_time_ms": 1541.035, "learn_time_ms": 11709.233, "learn_throughput": 341.611, "synch_weights_time_ms": 18.715}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 2832000, "num_agent_steps_trained": 2832000}, "done": false, "training_iteration": 177, "trial_id": "f6b99_00000", "date": "2024-08-13_23-19-37", "timestamp": 1723605577, "time_this_iter_s": 13.650676250457764, "time_total_s": 12873.65827345848, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6db9040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12873.65827345848, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 50.90526315789474, "ram_util_percent": 83.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0938342879531247, "cur_kl_coeff": 2.2763041451767667e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.71649335307419, "policy_loss": -0.003000658580284349, "vf_loss": 1.719494004508175, "vf_explained_var": 0.03155969668317724, "kl": 0.0017447222418548293, "entropy": 0.05180221482786158, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 335475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9502380320004054, "cur_kl_coeff": 2.2763041451767667e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.256601400350137, "policy_loss": -0.006875117241266977, "vf_loss": 3.263476515699316, "vf_explained_var": 0.3094616902568353, "kl": 0.01731776813276439, "entropy": 1.1055395347731454, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 335475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 2848000, "num_agent_steps_trained": 2848000}, "env_runners": {"episode_reward_max": 299.0, "episode_reward_min": -141.0, "episode_reward_mean": 41.77, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -361.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 172.0, "predator_policy": 184.0}, "policy_reward_mean": {"prey_policy": 12.79, "predator_policy": 8.095}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.0, 0.0, 0.0, 0.0, -21.0, 0.0, 22.0, 3.0, 39.0, 18.0, 19.0, -141.0, 59.0, 0.0, -8.0, -4.0, -99.0, 11.0, 7.0, -7.0, 34.0, 126.0, -38.0, 81.0, 12.0, -3.0, 19.0, 7.0, -8.0, 0.0, 14.0, 8.0, 5.0, 31.0, 46.0, 77.0, 0.0, 27.0, 131.0, 120.0, -2.0, 0.0, 151.0, -11.0, 28.0, 141.0, 8.0, 0.0, -4.0, 0.0, -7.0, 112.0, 0.0, -13.0, 27.0, 0.0, 139.0, 104.0, 2.0, 268.0, 148.0, 106.0, -18.0, -3.0, 214.0, 267.0, 58.0, 172.0, 0.0, 127.0, -8.0, 21.0, 0.0, 14.0, -17.0, 76.0, 258.0, 136.0, 104.0, -15.0, -2.0, 138.0, -6.0, -1.0, 165.0, -9.0, -25.0, 163.0, 0.0, 52.0, 299.0, -7.0, 115.0, 2.0, -4.0, -36.0, 9.0, -10.0, -6.0, 155.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 10.0, 0.0, 0.0, 0.0, -5.0, 0.0, 0.0, -18.0, -14.0, 0.0, 0.0, 22.0, 0.0, -4.0, 0.0, 12.0, 26.0, 0.0, 1.0, 4.0, 0.0, -361.0, 36.0, 59.0, 0.0, 0.0, 0.0, 0.0, -16.0, -8.0, 0.0, -198.0, 0.0, 14.0, -6.0, -25.0, 0.0, -4.0, -34.0, 34.0, 0.0, 60.0, 66.0, -18.0, -40.0, 74.0, -4.0, 0.0, 12.0, 0.0, -9.0, 20.0, -2.0, 5.0, 1.0, 0.0, -16.0, 0.0, 0.0, -8.0, 14.0, 0.0, 8.0, -6.0, 8.0, 22.0, 7.0, 43.0, 3.0, 77.0, 0.0, 0.0, 0.0, 0.0, 27.0, 0.0, 131.0, 0.0, 72.0, 20.0, -44.0, 0.0, 0.0, 151.0, 0.0, -14.0, -8.0, 0.0, -8.0, -22.0, 146.0, 3.0, 5.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 106.0, 0.0, 0.0, -26.0, 0.0, 21.0, 0.0, 0.0, 0.0, 0.0, 127.0, 43.0, 0.0, -7.0, 0.0, 139.0, 129.0, 0.0, 147.0, 98.0, 7.0, 0.0, -58.0, 0.0, -6.0, 77.0, 126.0, 112.0, 143.0, 58.0, 0.0, 155.0, 14.0, 0.0, 0.0, 113.0, 0.0, 0.0, -16.0, 0.0, 21.0, 0.0, 0.0, -109.0, 0.0, 0.0, -78.0, -8.0, -84.0, 141.0, 115.0, 94.0, 26.0, 104.0, 0.0, -16.0, -10.0, -18.0, 0.0, 0.0, 108.0, -12.0, 0.0, -2.0, 0.0, 172.0, -44.0, -18.0, 0.0, -22.0, -66.0, 23.0, 140.0, 0.0, 0.0, -93.0, 0.0, 141.0, 151.0, 0.0, -30.0, -12.0, 121.0, 2.0, 0.0, 0.0, -8.0, -72.0, 0.0, 0.0, 9.0, -20.0, 0.0, 0.0, -12.0, -20.0, 165.0], "policy_predator_policy_reward": [5.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 1.0, 0.0, 7.0, 10.0, 8.0, 7.0, 0.0, 184.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 4.0, 0.0, 99.0, 0.0, 3.0, 21.0, 11.0, 17.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 8.0, 3.0, 0.0, 0.0, 6.0, 0.0, 0.0, 1.0, 1.0, 0.0, 8.0, 0.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 29.0, 0.0, 22.0, 0.0, 0.0, 0.0, 0.0, 7.0, 4.0, 0.0, 36.0, 6.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 7.0, 0.0, 6.0, 0.0, 0.0, 0.0, 13.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 12.0, 28.0, 33.0, 9.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 4.0, 36.0, 3.0, 0.0, 4.0, 7.0, 0.0, 12.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 10.0, 4.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 61.0, 62.0, 37.0, 24.0, 93.0, 75.0, 2.0, 0.0, 8.0, 8.0, 0.0, 0.0, 3.0, 8.0, 11.0, 5.0, 9.0, 21.0, 0.0, 6.0, 1.0, 0.0, 15.0, 22.0, 0.0, 9.0, 27.0, 36.0, 0.0, 0.0, 0.0, 0.0, 78.0, 67.0, 0.0, 7.0, 8.0, 15.0, 0.0, 6.0, 0.0, 0.0, 4.0, 0.0, 36.0, 0.0, 0.0, 0.0, 10.0, 0.0, 6.0, 0.0, 0.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 28.180300906375876, "mean_inference_ms": 48.211692125369794, "mean_action_processing_ms": 7.062714615977825, "mean_env_wait_ms": 6.455658724150591, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004262328147888184, "StateBufferConnector_ms": 0.0033407211303710938, "ViewRequirementAgentConnector_ms": 0.11147916316986084}, "num_episodes": 27, "episode_return_max": 299.0, "episode_return_min": -141.0, "episode_return_mean": 41.77, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2848000, "num_agent_steps_trained": 2848000, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.0719673383343, "num_env_steps_trained_throughput_per_sec": 297.0719673383343, "timesteps_total": 712000, "num_env_steps_sampled_lifetime": 712000, "num_agent_steps_sampled_lifetime": 2848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2848000, "timers": {"training_iteration_time_ms": 13312.1, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13312.039, "sample_time_ms": 1543.323, "learn_time_ms": 11747.502, "learn_throughput": 340.498, "synch_weights_time_ms": 18.542}, "counters": {"num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 2848000, "num_agent_steps_trained": 2848000}, "done": false, "training_iteration": 178, "trial_id": "f6b99_00000", "date": "2024-08-13_23-19-50", "timestamp": 1723605590, "time_this_iter_s": 13.512881755828857, "time_total_s": 12887.17115521431, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6f4c0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12887.17115521431, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 51.505263157894746, "ram_util_percent": 83.60526315789473}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2777753254566244, "cur_kl_coeff": 1.1381520725883834e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.733343840323428, "policy_loss": -0.003832853891734014, "vf_loss": 0.7371766946106045, "vf_explained_var": 0.07715133920548455, "kl": 0.0014851276980885305, "entropy": 0.04263937525456111, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 337365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.412988430387759, "cur_kl_coeff": 2.2763041451767667e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8339343576834946, "policy_loss": -0.004535504911469404, "vf_loss": 2.838469869434518, "vf_explained_var": 0.48172646723096335, "kl": 0.010795291181035555, "entropy": 1.22566548863416, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 337365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 2864000, "num_agent_steps_trained": 2864000}, "env_runners": {"episode_reward_max": 299.0, "episode_reward_min": -38.0, "episode_reward_mean": 53.05, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -109.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 175.0, "predator_policy": 93.0}, "policy_reward_mean": {"prey_policy": 19.01, "predator_policy": 7.515}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.0, -7.0, 34.0, 126.0, -38.0, 81.0, 12.0, -3.0, 19.0, 7.0, -8.0, 0.0, 14.0, 8.0, 5.0, 31.0, 46.0, 77.0, 0.0, 27.0, 131.0, 120.0, -2.0, 0.0, 151.0, -11.0, 28.0, 141.0, 8.0, 0.0, -4.0, 0.0, -7.0, 112.0, 0.0, -13.0, 27.0, 0.0, 139.0, 104.0, 2.0, 268.0, 148.0, 106.0, -18.0, -3.0, 214.0, 267.0, 58.0, 172.0, 0.0, 127.0, -8.0, 21.0, 0.0, 14.0, -17.0, 76.0, 258.0, 136.0, 104.0, -15.0, -2.0, 138.0, -6.0, -1.0, 165.0, -9.0, -25.0, 163.0, 0.0, 52.0, 299.0, -7.0, 115.0, 2.0, -4.0, -36.0, 9.0, -10.0, -6.0, 155.0, 117.0, -12.0, 0.0, -3.0, 0.0, -9.0, 290.0, -1.0, 0.0, -10.0, 175.0, 131.0, -2.0, 148.0, 153.0, -4.0, 101.0, -33.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-25.0, 0.0, -4.0, -34.0, 34.0, 0.0, 60.0, 66.0, -18.0, -40.0, 74.0, -4.0, 0.0, 12.0, 0.0, -9.0, 20.0, -2.0, 5.0, 1.0, 0.0, -16.0, 0.0, 0.0, -8.0, 14.0, 0.0, 8.0, -6.0, 8.0, 22.0, 7.0, 43.0, 3.0, 77.0, 0.0, 0.0, 0.0, 0.0, 27.0, 0.0, 131.0, 0.0, 72.0, 20.0, -44.0, 0.0, 0.0, 151.0, 0.0, -14.0, -8.0, 0.0, -8.0, -22.0, 146.0, 3.0, 5.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 106.0, 0.0, 0.0, -26.0, 0.0, 21.0, 0.0, 0.0, 0.0, 0.0, 127.0, 43.0, 0.0, -7.0, 0.0, 139.0, 129.0, 0.0, 147.0, 98.0, 7.0, 0.0, -58.0, 0.0, -6.0, 77.0, 126.0, 112.0, 143.0, 58.0, 0.0, 155.0, 14.0, 0.0, 0.0, 113.0, 0.0, 0.0, -16.0, 0.0, 21.0, 0.0, 0.0, -109.0, 0.0, 0.0, -78.0, -8.0, -84.0, 141.0, 115.0, 94.0, 26.0, 104.0, 0.0, -16.0, -10.0, -18.0, 0.0, 0.0, 108.0, -12.0, 0.0, -2.0, 0.0, 172.0, -44.0, -18.0, 0.0, -22.0, -66.0, 23.0, 140.0, 0.0, 0.0, -93.0, 0.0, 141.0, 151.0, 0.0, -30.0, -12.0, 121.0, 2.0, 0.0, 0.0, -8.0, -72.0, 0.0, 0.0, 9.0, -20.0, 0.0, 0.0, -12.0, -20.0, 165.0, -86.0, 139.0, -4.0, -20.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, -18.0, 0.0, 140.0, 139.0, 0.0, -2.0, 0.0, 0.0, -18.0, -8.0, 175.0, 0.0, 128.0, -27.0, -4.0, 0.0, 0.0, 136.0, 0.0, 153.0, 3.0, -36.0, -2.0, 100.0, -46.0, -38.0], "policy_predator_policy_reward": [21.0, 11.0, 17.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 8.0, 3.0, 0.0, 0.0, 6.0, 0.0, 0.0, 1.0, 1.0, 0.0, 8.0, 0.0, 0.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 29.0, 0.0, 22.0, 0.0, 0.0, 0.0, 0.0, 7.0, 4.0, 0.0, 36.0, 6.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 7.0, 0.0, 6.0, 0.0, 0.0, 0.0, 13.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 12.0, 28.0, 33.0, 9.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 4.0, 36.0, 3.0, 0.0, 4.0, 7.0, 0.0, 12.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 10.0, 4.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 61.0, 62.0, 37.0, 24.0, 93.0, 75.0, 2.0, 0.0, 8.0, 8.0, 0.0, 0.0, 3.0, 8.0, 11.0, 5.0, 9.0, 21.0, 0.0, 6.0, 1.0, 0.0, 15.0, 22.0, 0.0, 9.0, 27.0, 36.0, 0.0, 0.0, 0.0, 0.0, 78.0, 67.0, 0.0, 7.0, 8.0, 15.0, 0.0, 6.0, 0.0, 0.0, 4.0, 0.0, 36.0, 0.0, 0.0, 0.0, 10.0, 0.0, 6.0, 0.0, 0.0, 10.0, 20.0, 44.0, 12.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 9.0, 0.0, 7.0, 4.0, 1.0, 0.0, 0.0, 0.0, 13.0, 3.0, 0.0, 0.0, 26.0, 4.0, 2.0, 0.0, 0.0, 12.0, 0.0, 0.0, 22.0, 7.0, 1.0, 2.0, 21.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.74498793818416, "mean_inference_ms": 48.18773643489301, "mean_action_processing_ms": 7.0204901555240395, "mean_env_wait_ms": 6.032556665311498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004217624664306641, "StateBufferConnector_ms": 0.003314971923828125, "ViewRequirementAgentConnector_ms": 0.10608851909637451}, "num_episodes": 18, "episode_return_max": 299.0, "episode_return_min": -38.0, "episode_return_mean": 53.05, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2864000, "num_agent_steps_trained": 2864000, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.1916016177895, "num_env_steps_trained_throughput_per_sec": 300.1916016177895, "timesteps_total": 716000, "num_env_steps_sampled_lifetime": 716000, "num_agent_steps_sampled_lifetime": 2864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2864000, "timers": {"training_iteration_time_ms": 13324.725, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13324.663, "sample_time_ms": 1546.167, "learn_time_ms": 11757.362, "learn_throughput": 340.212, "synch_weights_time_ms": 18.497}, "counters": {"num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 2864000, "num_agent_steps_trained": 2864000}, "done": false, "training_iteration": 179, "trial_id": "f6b99_00000", "date": "2024-08-13_23-20-04", "timestamp": 1723605604, "time_this_iter_s": 13.35984992980957, "time_total_s": 12900.53100514412, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6f4cb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12900.53100514412, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 50.17894736842105, "ram_util_percent": 83.6421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2229415118457778, "cur_kl_coeff": 5.690760362941917e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3858605785620591, "policy_loss": -0.0025368785554612124, "vf_loss": 0.3883974573592207, "vf_explained_var": 0.06302641384185306, "kl": 0.002146575449710509, "entropy": 0.0339585604158442, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 339255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7559274336648365, "cur_kl_coeff": 2.2763041451767667e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.060341155970538, "policy_loss": -0.0062192876934118214, "vf_loss": 4.066560439710264, "vf_explained_var": 0.5256537040390035, "kl": 0.022549722475330918, "entropy": 1.2013493477352082, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 339255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000}, "env_runners": {"episode_reward_max": 329.0, "episode_reward_min": -36.0, "episode_reward_mean": 72.59, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -109.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 187.0, "predator_policy": 93.0}, "policy_reward_mean": {"prey_policy": 28.455, "predator_policy": 7.84}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 27.0, 131.0, 120.0, -2.0, 0.0, 151.0, -11.0, 28.0, 141.0, 8.0, 0.0, -4.0, 0.0, -7.0, 112.0, 0.0, -13.0, 27.0, 0.0, 139.0, 104.0, 2.0, 268.0, 148.0, 106.0, -18.0, -3.0, 214.0, 267.0, 58.0, 172.0, 0.0, 127.0, -8.0, 21.0, 0.0, 14.0, -17.0, 76.0, 258.0, 136.0, 104.0, -15.0, -2.0, 138.0, -6.0, -1.0, 165.0, -9.0, -25.0, 163.0, 0.0, 52.0, 299.0, -7.0, 115.0, 2.0, -4.0, -36.0, 9.0, -10.0, -6.0, 155.0, 117.0, -12.0, 0.0, -3.0, 0.0, -9.0, 290.0, -1.0, 0.0, -10.0, 175.0, 131.0, -2.0, 148.0, 153.0, -4.0, 101.0, -33.0, 180.0, 118.0, 0.0, -9.0, 185.0, -7.0, 170.0, -3.0, 143.0, 34.0, 315.0, 159.0, 120.0, 329.0, -10.0, 163.0, 164.0, 314.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 27.0, 0.0, 131.0, 0.0, 72.0, 20.0, -44.0, 0.0, 0.0, 151.0, 0.0, -14.0, -8.0, 0.0, -8.0, -22.0, 146.0, 3.0, 5.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 106.0, 0.0, 0.0, -26.0, 0.0, 21.0, 0.0, 0.0, 0.0, 0.0, 127.0, 43.0, 0.0, -7.0, 0.0, 139.0, 129.0, 0.0, 147.0, 98.0, 7.0, 0.0, -58.0, 0.0, -6.0, 77.0, 126.0, 112.0, 143.0, 58.0, 0.0, 155.0, 14.0, 0.0, 0.0, 113.0, 0.0, 0.0, -16.0, 0.0, 21.0, 0.0, 0.0, -109.0, 0.0, 0.0, -78.0, -8.0, -84.0, 141.0, 115.0, 94.0, 26.0, 104.0, 0.0, -16.0, -10.0, -18.0, 0.0, 0.0, 108.0, -12.0, 0.0, -2.0, 0.0, 172.0, -44.0, -18.0, 0.0, -22.0, -66.0, 23.0, 140.0, 0.0, 0.0, -93.0, 0.0, 141.0, 151.0, 0.0, -30.0, -12.0, 121.0, 2.0, 0.0, 0.0, -8.0, -72.0, 0.0, 0.0, 9.0, -20.0, 0.0, 0.0, -12.0, -20.0, 165.0, -86.0, 139.0, -4.0, -20.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, -18.0, 0.0, 140.0, 139.0, 0.0, -2.0, 0.0, 0.0, -18.0, -8.0, 175.0, 0.0, 128.0, -27.0, -4.0, 0.0, 0.0, 136.0, 0.0, 153.0, 3.0, -36.0, -2.0, 100.0, -46.0, -38.0, 187.0, -15.0, -18.0, 112.0, 0.0, 0.0, -18.0, 0.0, 185.0, 0.0, -14.0, 0.0, 0.0, 170.0, -6.0, 0.0, 153.0, -38.0, 0.0, 23.0, 166.0, 143.0, 0.0, 159.0, 0.0, 96.0, 160.0, 133.0, 0.0, -20.0, -8.0, 167.0, 0.0, 158.0, 157.0, 145.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 29.0, 0.0, 22.0, 0.0, 0.0, 0.0, 0.0, 7.0, 4.0, 0.0, 36.0, 6.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 7.0, 0.0, 6.0, 0.0, 0.0, 0.0, 13.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 12.0, 28.0, 33.0, 9.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 4.0, 36.0, 3.0, 0.0, 4.0, 7.0, 0.0, 12.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 10.0, 4.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 61.0, 62.0, 37.0, 24.0, 93.0, 75.0, 2.0, 0.0, 8.0, 8.0, 0.0, 0.0, 3.0, 8.0, 11.0, 5.0, 9.0, 21.0, 0.0, 6.0, 1.0, 0.0, 15.0, 22.0, 0.0, 9.0, 27.0, 36.0, 0.0, 0.0, 0.0, 0.0, 78.0, 67.0, 0.0, 7.0, 8.0, 15.0, 0.0, 6.0, 0.0, 0.0, 4.0, 0.0, 36.0, 0.0, 0.0, 0.0, 10.0, 0.0, 6.0, 0.0, 0.0, 10.0, 20.0, 44.0, 12.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 9.0, 0.0, 7.0, 4.0, 1.0, 0.0, 0.0, 0.0, 13.0, 3.0, 0.0, 0.0, 26.0, 4.0, 2.0, 0.0, 0.0, 12.0, 0.0, 0.0, 22.0, 7.0, 1.0, 2.0, 21.0, 30.0, 0.0, 8.0, 9.0, 15.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 3.0, 0.0, 16.0, 12.0, 11.0, 0.0, 2.0, 4.0, 0.0, 0.0, 0.0, 24.0, 16.0, 20.0, 10.0, 0.0, 4.0, 0.0, 6.0, 0.0, 0.0, 12.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.6063919845521, "mean_inference_ms": 47.95175379178473, "mean_action_processing_ms": 6.985901225794277, "mean_env_wait_ms": 6.0028317859076425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004191398620605469, "StateBufferConnector_ms": 0.0033937692642211914, "ViewRequirementAgentConnector_ms": 0.10960638523101807}, "num_episodes": 18, "episode_return_max": 329.0, "episode_return_min": -36.0, "episode_return_mean": 72.59, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.15256049277235, "num_env_steps_trained_throughput_per_sec": 311.15256049277235, "timesteps_total": 720000, "num_env_steps_sampled_lifetime": 720000, "num_agent_steps_sampled_lifetime": 2880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2880000, "timers": {"training_iteration_time_ms": 13261.536, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13261.474, "sample_time_ms": 1544.199, "learn_time_ms": 11695.709, "learn_throughput": 342.006, "synch_weights_time_ms": 19.072}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000}, "done": false, "training_iteration": 180, "trial_id": "f6b99_00000", "date": "2024-08-13_23-20-17", "timestamp": 1723605617, "time_this_iter_s": 12.88297700881958, "time_total_s": 12913.413982152939, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6f76550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12913.413982152939, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 48.95263157894737, "ram_util_percent": 83.53684210526316}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8593361866221856, "cur_kl_coeff": 2.8453801814709584e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4059670259634023, "policy_loss": -0.0013888152301429757, "vf_loss": 0.40735584310004636, "vf_explained_var": 0.11670309488104764, "kl": 0.001007580604833392, "entropy": 0.0364181226669754, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 341145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1793470471939713, "cur_kl_coeff": 3.4144562177651485e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7002007977672355, "policy_loss": -0.004214490433691671, "vf_loss": 3.7044152972559448, "vf_explained_var": 0.5809707762072326, "kl": 0.012124144335119501, "entropy": 1.2182071244275128, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 341145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 2896000, "num_agent_steps_trained": 2896000}, "env_runners": {"episode_reward_max": 329.0, "episode_reward_min": -36.0, "episode_reward_mean": 82.86, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -109.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 187.0, "predator_policy": 93.0}, "policy_reward_mean": {"prey_policy": 33.165, "predator_policy": 8.265}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.0, 0.0, 139.0, 104.0, 2.0, 268.0, 148.0, 106.0, -18.0, -3.0, 214.0, 267.0, 58.0, 172.0, 0.0, 127.0, -8.0, 21.0, 0.0, 14.0, -17.0, 76.0, 258.0, 136.0, 104.0, -15.0, -2.0, 138.0, -6.0, -1.0, 165.0, -9.0, -25.0, 163.0, 0.0, 52.0, 299.0, -7.0, 115.0, 2.0, -4.0, -36.0, 9.0, -10.0, -6.0, 155.0, 117.0, -12.0, 0.0, -3.0, 0.0, -9.0, 290.0, -1.0, 0.0, -10.0, 175.0, 131.0, -2.0, 148.0, 153.0, -4.0, 101.0, -33.0, 180.0, 118.0, 0.0, -9.0, 185.0, -7.0, 170.0, -3.0, 143.0, 34.0, 315.0, 159.0, 120.0, 329.0, -10.0, 163.0, 164.0, 314.0, -29.0, 93.0, -20.0, -1.0, 0.0, 186.0, 0.0, 301.0, 7.0, 17.0, 167.0, 0.0, 169.0, 161.0, 318.0, -11.0, 168.0, 182.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [21.0, 0.0, 0.0, 0.0, 0.0, 127.0, 43.0, 0.0, -7.0, 0.0, 139.0, 129.0, 0.0, 147.0, 98.0, 7.0, 0.0, -58.0, 0.0, -6.0, 77.0, 126.0, 112.0, 143.0, 58.0, 0.0, 155.0, 14.0, 0.0, 0.0, 113.0, 0.0, 0.0, -16.0, 0.0, 21.0, 0.0, 0.0, -109.0, 0.0, 0.0, -78.0, -8.0, -84.0, 141.0, 115.0, 94.0, 26.0, 104.0, 0.0, -16.0, -10.0, -18.0, 0.0, 0.0, 108.0, -12.0, 0.0, -2.0, 0.0, 172.0, -44.0, -18.0, 0.0, -22.0, -66.0, 23.0, 140.0, 0.0, 0.0, -93.0, 0.0, 141.0, 151.0, 0.0, -30.0, -12.0, 121.0, 2.0, 0.0, 0.0, -8.0, -72.0, 0.0, 0.0, 9.0, -20.0, 0.0, 0.0, -12.0, -20.0, 165.0, -86.0, 139.0, -4.0, -20.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, -18.0, 0.0, 140.0, 139.0, 0.0, -2.0, 0.0, 0.0, -18.0, -8.0, 175.0, 0.0, 128.0, -27.0, -4.0, 0.0, 0.0, 136.0, 0.0, 153.0, 3.0, -36.0, -2.0, 100.0, -46.0, -38.0, 187.0, -15.0, -18.0, 112.0, 0.0, 0.0, -18.0, 0.0, 185.0, 0.0, -14.0, 0.0, 0.0, 170.0, -6.0, 0.0, 153.0, -38.0, 0.0, 23.0, 166.0, 143.0, 0.0, 159.0, 0.0, 96.0, 160.0, 133.0, 0.0, -20.0, -8.0, 167.0, 0.0, 158.0, 157.0, 145.0, 0.0, -72.0, 0.0, 76.0, -34.0, -6.0, -6.0, 0.0, 0.0, 0.0, 128.0, 24.0, 0.0, 0.0, 122.0, 177.0, 35.0, -66.0, 0.0, 7.0, 155.0, 0.0, 0.0, 0.0, 169.0, 0.0, 142.0, 0.0, 136.0, 161.0, -16.0, -6.0, -8.0, 161.0, 178.0, 0.0], "policy_predator_policy_reward": [6.0, 0.0, 0.0, 0.0, 0.0, 12.0, 28.0, 33.0, 9.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 4.0, 36.0, 3.0, 0.0, 4.0, 7.0, 0.0, 12.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 10.0, 4.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 61.0, 62.0, 37.0, 24.0, 93.0, 75.0, 2.0, 0.0, 8.0, 8.0, 0.0, 0.0, 3.0, 8.0, 11.0, 5.0, 9.0, 21.0, 0.0, 6.0, 1.0, 0.0, 15.0, 22.0, 0.0, 9.0, 27.0, 36.0, 0.0, 0.0, 0.0, 0.0, 78.0, 67.0, 0.0, 7.0, 8.0, 15.0, 0.0, 6.0, 0.0, 0.0, 4.0, 0.0, 36.0, 0.0, 0.0, 0.0, 10.0, 0.0, 6.0, 0.0, 0.0, 10.0, 20.0, 44.0, 12.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 9.0, 0.0, 7.0, 4.0, 1.0, 0.0, 0.0, 0.0, 13.0, 3.0, 0.0, 0.0, 26.0, 4.0, 2.0, 0.0, 0.0, 12.0, 0.0, 0.0, 22.0, 7.0, 1.0, 2.0, 21.0, 30.0, 0.0, 8.0, 9.0, 15.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 3.0, 0.0, 16.0, 12.0, 11.0, 0.0, 2.0, 4.0, 0.0, 0.0, 0.0, 24.0, 16.0, 20.0, 10.0, 0.0, 4.0, 0.0, 6.0, 0.0, 0.0, 12.0, 0.0, 43.0, 6.0, 11.0, 8.0, 12.0, 3.0, 2.0, 0.0, 0.0, 22.0, 12.0, 0.0, 0.0, 0.0, 2.0, 33.0, 5.0, 10.0, 0.0, 6.0, 6.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 21.0, 0.0, 0.0, 11.0, 3.0, 12.0, 4.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.469378990356855, "mean_inference_ms": 47.718440523946626, "mean_action_processing_ms": 6.951707477237324, "mean_env_wait_ms": 5.973442109761934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043822526931762695, "StateBufferConnector_ms": 0.0033301115036010742, "ViewRequirementAgentConnector_ms": 0.11278879642486572}, "num_episodes": 18, "episode_return_max": 329.0, "episode_return_min": -36.0, "episode_return_mean": 82.86, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2896000, "num_agent_steps_trained": 2896000, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 287.6628303772016, "num_env_steps_trained_throughput_per_sec": 287.6628303772016, "timesteps_total": 724000, "num_env_steps_sampled_lifetime": 724000, "num_agent_steps_sampled_lifetime": 2896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2896000, "timers": {"training_iteration_time_ms": 13325.278, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13325.221, "sample_time_ms": 1542.95, "learn_time_ms": 11762.189, "learn_throughput": 340.073, "synch_weights_time_ms": 17.738}, "counters": {"num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 2896000, "num_agent_steps_trained": 2896000}, "done": false, "training_iteration": 181, "trial_id": "f6b99_00000", "date": "2024-08-13_23-20-31", "timestamp": 1723605631, "time_this_iter_s": 13.970993041992188, "time_total_s": 12927.384975194931, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6f1a280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12927.384975194931, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 55.46, "ram_util_percent": 83.64}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1403717488129304, "cur_kl_coeff": 1.4226900907354792e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.49339100497740285, "policy_loss": -0.0009305621821324898, "vf_loss": 0.49432156821959233, "vf_explained_var": 0.032745989006032386, "kl": 0.0018404505819769239, "entropy": 0.04071376573925138, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 343035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0275494149437656, "cur_kl_coeff": 3.4144562177651485e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.112389748689359, "policy_loss": -0.005767505265102185, "vf_loss": 4.118157239187331, "vf_explained_var": 0.5912254942788018, "kl": 0.013236960389843372, "entropy": 1.1658387512757034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 343035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 2912000, "num_agent_steps_trained": 2912000}, "env_runners": {"episode_reward_max": 358.0, "episode_reward_min": -36.0, "episode_reward_mean": 92.65, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -93.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 192.0, "predator_policy": 78.0}, "policy_reward_mean": {"prey_policy": 39.64, "predator_policy": 6.685}, "custom_metrics": {}, "hist_stats": {"episode_reward": [136.0, 104.0, -15.0, -2.0, 138.0, -6.0, -1.0, 165.0, -9.0, -25.0, 163.0, 0.0, 52.0, 299.0, -7.0, 115.0, 2.0, -4.0, -36.0, 9.0, -10.0, -6.0, 155.0, 117.0, -12.0, 0.0, -3.0, 0.0, -9.0, 290.0, -1.0, 0.0, -10.0, 175.0, 131.0, -2.0, 148.0, 153.0, -4.0, 101.0, -33.0, 180.0, 118.0, 0.0, -9.0, 185.0, -7.0, 170.0, -3.0, 143.0, 34.0, 315.0, 159.0, 120.0, 329.0, -10.0, 163.0, 164.0, 314.0, -29.0, 93.0, -20.0, -1.0, 0.0, 186.0, 0.0, 301.0, 7.0, 17.0, 167.0, 0.0, 169.0, 161.0, 318.0, -11.0, 168.0, 182.0, 16.0, 167.0, 182.0, -4.0, 190.0, 358.0, -14.0, 0.0, 175.0, 178.0, 167.0, 180.0, -1.0, 149.0, 184.0, -6.0, 209.0, 347.0, 50.0, -7.0, 174.0, 217.0, 23.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [94.0, 26.0, 104.0, 0.0, -16.0, -10.0, -18.0, 0.0, 0.0, 108.0, -12.0, 0.0, -2.0, 0.0, 172.0, -44.0, -18.0, 0.0, -22.0, -66.0, 23.0, 140.0, 0.0, 0.0, -93.0, 0.0, 141.0, 151.0, 0.0, -30.0, -12.0, 121.0, 2.0, 0.0, 0.0, -8.0, -72.0, 0.0, 0.0, 9.0, -20.0, 0.0, 0.0, -12.0, -20.0, 165.0, -86.0, 139.0, -4.0, -20.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, -18.0, 0.0, 140.0, 139.0, 0.0, -2.0, 0.0, 0.0, -18.0, -8.0, 175.0, 0.0, 128.0, -27.0, -4.0, 0.0, 0.0, 136.0, 0.0, 153.0, 3.0, -36.0, -2.0, 100.0, -46.0, -38.0, 187.0, -15.0, -18.0, 112.0, 0.0, 0.0, -18.0, 0.0, 185.0, 0.0, -14.0, 0.0, 0.0, 170.0, -6.0, 0.0, 153.0, -38.0, 0.0, 23.0, 166.0, 143.0, 0.0, 159.0, 0.0, 96.0, 160.0, 133.0, 0.0, -20.0, -8.0, 167.0, 0.0, 158.0, 157.0, 145.0, 0.0, -72.0, 0.0, 76.0, -34.0, -6.0, -6.0, 0.0, 0.0, 0.0, 128.0, 24.0, 0.0, 0.0, 122.0, 177.0, 35.0, -66.0, 0.0, 7.0, 155.0, 0.0, 0.0, 0.0, 169.0, 0.0, 142.0, 0.0, 136.0, 161.0, -16.0, -6.0, -8.0, 161.0, 178.0, 0.0, 0.0, 16.0, 0.0, 162.0, 179.0, 0.0, 0.0, -8.0, 0.0, 190.0, 192.0, 158.0, -36.0, 3.0, 0.0, 0.0, -10.0, 175.0, 178.0, 0.0, 163.0, 0.0, 173.0, 0.0, 0.0, -8.0, 129.0, 0.0, 172.0, 1.0, 0.0, -12.0, 18.0, 191.0, 178.0, 161.0, 0.0, -24.0, -14.0, 0.0, 183.0, -18.0, 52.0, 157.0, 14.0, 0.0], "policy_predator_policy_reward": [8.0, 8.0, 0.0, 0.0, 3.0, 8.0, 11.0, 5.0, 9.0, 21.0, 0.0, 6.0, 1.0, 0.0, 15.0, 22.0, 0.0, 9.0, 27.0, 36.0, 0.0, 0.0, 0.0, 0.0, 78.0, 67.0, 0.0, 7.0, 8.0, 15.0, 0.0, 6.0, 0.0, 0.0, 4.0, 0.0, 36.0, 0.0, 0.0, 0.0, 10.0, 0.0, 6.0, 0.0, 0.0, 10.0, 20.0, 44.0, 12.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 9.0, 0.0, 7.0, 4.0, 1.0, 0.0, 0.0, 0.0, 13.0, 3.0, 0.0, 0.0, 26.0, 4.0, 2.0, 0.0, 0.0, 12.0, 0.0, 0.0, 22.0, 7.0, 1.0, 2.0, 21.0, 30.0, 0.0, 8.0, 9.0, 15.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 3.0, 0.0, 16.0, 12.0, 11.0, 0.0, 2.0, 4.0, 0.0, 0.0, 0.0, 24.0, 16.0, 20.0, 10.0, 0.0, 4.0, 0.0, 6.0, 0.0, 0.0, 12.0, 0.0, 43.0, 6.0, 11.0, 8.0, 12.0, 3.0, 2.0, 0.0, 0.0, 22.0, 12.0, 0.0, 0.0, 0.0, 2.0, 33.0, 5.0, 10.0, 0.0, 6.0, 6.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 21.0, 0.0, 0.0, 11.0, 3.0, 12.0, 4.0, 0.0, 0.0, 0.0, 0.0, 5.0, 3.0, 0.0, 4.0, 0.0, 0.0, 0.0, 8.0, 0.0, 19.0, 0.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 1.0, 3.0, 7.0, 0.0, 4.0, 3.0, 0.0, 20.0, 11.0, 0.0, 6.0, 0.0, 0.0, 0.0, 5.0, 3.0, 10.0, 64.0, 0.0, 7.0, 9.0, 0.0, 0.0, 8.0, 0.0, 9.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.861663153819958, "mean_inference_ms": 47.11242543600416, "mean_action_processing_ms": 7.238386383047851, "mean_env_wait_ms": 6.071112282966205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006186366081237793, "StateBufferConnector_ms": 0.0034712553024291992, "ViewRequirementAgentConnector_ms": 0.11159408092498779}, "num_episodes": 23, "episode_return_max": 358.0, "episode_return_min": -36.0, "episode_return_mean": 92.65, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2912000, "num_agent_steps_trained": 2912000, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.18169903341084, "num_env_steps_trained_throughput_per_sec": 308.18169903341084, "timesteps_total": 728000, "num_env_steps_sampled_lifetime": 728000, "num_agent_steps_sampled_lifetime": 2912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2912000, "timers": {"training_iteration_time_ms": 13290.123, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13290.069, "sample_time_ms": 1544.397, "learn_time_ms": 11725.662, "learn_throughput": 341.132, "synch_weights_time_ms": 17.637}, "counters": {"num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 2912000, "num_agent_steps_trained": 2912000}, "done": false, "training_iteration": 182, "trial_id": "f6b99_00000", "date": "2024-08-13_23-20-44", "timestamp": 1723605644, "time_this_iter_s": 13.017671823501587, "time_total_s": 12940.402647018433, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6f1a700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12940.402647018433, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 51.10555555555555, "ram_util_percent": 83.82777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.014770580016116, "cur_kl_coeff": 7.113450453677396e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1173389881691604, "policy_loss": -0.0022302706682778618, "vf_loss": 1.1195692547730036, "vf_explained_var": 0.07647892618305469, "kl": 0.002340198138529715, "entropy": 0.05343377866668912, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 344925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.315916801634289, "cur_kl_coeff": 3.4144562177651485e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.845446036858533, "policy_loss": -0.00551226639297234, "vf_loss": 5.850958299636841, "vf_explained_var": 0.6005548759743019, "kl": 0.014283906037953186, "entropy": 1.0932499485671836, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 344925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 2928000, "num_agent_steps_trained": 2928000}, "env_runners": {"episode_reward_max": 385.0, "episode_reward_min": -33.0, "episode_reward_mean": 130.1, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -86.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 64.0}, "policy_reward_mean": {"prey_policy": 59.04, "predator_policy": 6.01}, "custom_metrics": {}, "hist_stats": {"episode_reward": [155.0, 117.0, -12.0, 0.0, -3.0, 0.0, -9.0, 290.0, -1.0, 0.0, -10.0, 175.0, 131.0, -2.0, 148.0, 153.0, -4.0, 101.0, -33.0, 180.0, 118.0, 0.0, -9.0, 185.0, -7.0, 170.0, -3.0, 143.0, 34.0, 315.0, 159.0, 120.0, 329.0, -10.0, 163.0, 164.0, 314.0, -29.0, 93.0, -20.0, -1.0, 0.0, 186.0, 0.0, 301.0, 7.0, 17.0, 167.0, 0.0, 169.0, 161.0, 318.0, -11.0, 168.0, 182.0, 16.0, 167.0, 182.0, -4.0, 190.0, 358.0, -14.0, 0.0, 175.0, 178.0, 167.0, 180.0, -1.0, 149.0, 184.0, -6.0, 209.0, 347.0, 50.0, -7.0, 174.0, 217.0, 23.0, 358.0, 196.0, 180.0, 141.0, 178.0, -1.0, 376.0, 0.0, 321.0, 183.0, 375.0, 332.0, 339.0, 188.0, 333.0, 70.0, -2.0, 274.0, 161.0, 199.0, 221.0, 385.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-20.0, 165.0, -86.0, 139.0, -4.0, -20.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, -18.0, 0.0, 140.0, 139.0, 0.0, -2.0, 0.0, 0.0, -18.0, -8.0, 175.0, 0.0, 128.0, -27.0, -4.0, 0.0, 0.0, 136.0, 0.0, 153.0, 3.0, -36.0, -2.0, 100.0, -46.0, -38.0, 187.0, -15.0, -18.0, 112.0, 0.0, 0.0, -18.0, 0.0, 185.0, 0.0, -14.0, 0.0, 0.0, 170.0, -6.0, 0.0, 153.0, -38.0, 0.0, 23.0, 166.0, 143.0, 0.0, 159.0, 0.0, 96.0, 160.0, 133.0, 0.0, -20.0, -8.0, 167.0, 0.0, 158.0, 157.0, 145.0, 0.0, -72.0, 0.0, 76.0, -34.0, -6.0, -6.0, 0.0, 0.0, 0.0, 128.0, 24.0, 0.0, 0.0, 122.0, 177.0, 35.0, -66.0, 0.0, 7.0, 155.0, 0.0, 0.0, 0.0, 169.0, 0.0, 142.0, 0.0, 136.0, 161.0, -16.0, -6.0, -8.0, 161.0, 178.0, 0.0, 0.0, 16.0, 0.0, 162.0, 179.0, 0.0, 0.0, -8.0, 0.0, 190.0, 192.0, 158.0, -36.0, 3.0, 0.0, 0.0, -10.0, 175.0, 178.0, 0.0, 163.0, 0.0, 173.0, 0.0, 0.0, -8.0, 129.0, 0.0, 172.0, 1.0, 0.0, -12.0, 18.0, 191.0, 178.0, 161.0, 0.0, -24.0, -14.0, 0.0, 183.0, -18.0, 52.0, 157.0, 14.0, 0.0, 181.0, 160.0, 196.0, 0.0, 159.0, 0.0, -4.0, 134.0, 171.0, -4.0, -2.0, 0.0, 178.0, 195.0, 0.0, 0.0, 158.0, 138.0, 185.0, -4.0, 177.0, 193.0, 146.0, 167.0, 153.0, 171.0, 194.0, -30.0, 138.0, 178.0, 59.0, 0.0, -4.0, -24.0, 75.0, 178.0, 138.0, 0.0, 0.0, 199.0, -11.0, 194.0, 194.0, 190.0], "policy_predator_policy_reward": [0.0, 10.0, 20.0, 44.0, 12.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 9.0, 0.0, 7.0, 4.0, 1.0, 0.0, 0.0, 0.0, 13.0, 3.0, 0.0, 0.0, 26.0, 4.0, 2.0, 0.0, 0.0, 12.0, 0.0, 0.0, 22.0, 7.0, 1.0, 2.0, 21.0, 30.0, 0.0, 8.0, 9.0, 15.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 3.0, 0.0, 16.0, 12.0, 11.0, 0.0, 2.0, 4.0, 0.0, 0.0, 0.0, 24.0, 16.0, 20.0, 10.0, 0.0, 4.0, 0.0, 6.0, 0.0, 0.0, 12.0, 0.0, 43.0, 6.0, 11.0, 8.0, 12.0, 3.0, 2.0, 0.0, 0.0, 22.0, 12.0, 0.0, 0.0, 0.0, 2.0, 33.0, 5.0, 10.0, 0.0, 6.0, 6.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 21.0, 0.0, 0.0, 11.0, 3.0, 12.0, 4.0, 0.0, 0.0, 0.0, 0.0, 5.0, 3.0, 0.0, 4.0, 0.0, 0.0, 0.0, 8.0, 0.0, 19.0, 0.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 1.0, 3.0, 7.0, 0.0, 4.0, 3.0, 0.0, 20.0, 11.0, 0.0, 6.0, 0.0, 0.0, 0.0, 5.0, 3.0, 10.0, 64.0, 0.0, 7.0, 9.0, 0.0, 0.0, 8.0, 0.0, 9.0, 13.0, 4.0, 0.0, 0.0, 12.0, 9.0, 3.0, 8.0, 4.0, 7.0, 1.0, 0.0, 0.0, 3.0, 0.0, 0.0, 18.0, 7.0, 0.0, 2.0, 5.0, 0.0, 0.0, 19.0, 14.0, 1.0, 9.0, 15.0, 0.0, 17.0, 9.0, 2.0, 12.0, 14.0, 10.0, 11.0, 17.0, 6.0, 0.0, 0.0, 10.0, 28.0, 0.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.141586927067628, "mean_inference_ms": 47.15915321036262, "mean_action_processing_ms": 6.8705457147593965, "mean_env_wait_ms": 5.902009060963362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007292747497558594, "StateBufferConnector_ms": 0.004199385643005371, "ViewRequirementAgentConnector_ms": 0.10974013805389404}, "num_episodes": 22, "episode_return_max": 385.0, "episode_return_min": -33.0, "episode_return_mean": 130.1, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2928000, "num_agent_steps_trained": 2928000, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.69652214667104, "num_env_steps_trained_throughput_per_sec": 303.69652214667104, "timesteps_total": 732000, "num_env_steps_sampled_lifetime": 732000, "num_agent_steps_sampled_lifetime": 2928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2928000, "timers": {"training_iteration_time_ms": 13328.725, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13328.67, "sample_time_ms": 1540.0, "learn_time_ms": 11769.985, "learn_throughput": 339.848, "synch_weights_time_ms": 16.283}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 2928000, "num_agent_steps_trained": 2928000}, "done": false, "training_iteration": 183, "trial_id": "f6b99_00000", "date": "2024-08-13_23-20-57", "timestamp": 1723605657, "time_this_iter_s": 13.23319697380066, "time_total_s": 12953.635843992233, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6f76550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12953.635843992233, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 50.60526315789473, "ram_util_percent": 83.46315789473682}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2642258839474785, "cur_kl_coeff": 3.556725226838698e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5703210958176189, "policy_loss": -0.0009148801891281018, "vf_loss": 0.5712359761543296, "vf_explained_var": 0.035957574718212953, "kl": 0.0014826400588468104, "entropy": 0.05362579016379578, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 346815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9615255691071667, "cur_kl_coeff": 3.4144562177651485e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.476102129870622, "policy_loss": -0.005161913951474523, "vf_loss": 5.481264027842769, "vf_explained_var": 0.6616080128641987, "kl": 0.018291235382173896, "entropy": 1.1296272436147015, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 346815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 2944000, "num_agent_steps_trained": 2944000}, "env_runners": {"episode_reward_max": 385.0, "episode_reward_min": -33.0, "episode_reward_mean": 147.99, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -72.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 64.0}, "policy_reward_mean": {"prey_policy": 67.725, "predator_policy": 6.27}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33.0, 180.0, 118.0, 0.0, -9.0, 185.0, -7.0, 170.0, -3.0, 143.0, 34.0, 315.0, 159.0, 120.0, 329.0, -10.0, 163.0, 164.0, 314.0, -29.0, 93.0, -20.0, -1.0, 0.0, 186.0, 0.0, 301.0, 7.0, 17.0, 167.0, 0.0, 169.0, 161.0, 318.0, -11.0, 168.0, 182.0, 16.0, 167.0, 182.0, -4.0, 190.0, 358.0, -14.0, 0.0, 175.0, 178.0, 167.0, 180.0, -1.0, 149.0, 184.0, -6.0, 209.0, 347.0, 50.0, -7.0, 174.0, 217.0, 23.0, 358.0, 196.0, 180.0, 141.0, 178.0, -1.0, 376.0, 0.0, 321.0, 183.0, 375.0, 332.0, 339.0, 188.0, 333.0, 70.0, -2.0, 274.0, 161.0, 199.0, 221.0, 385.0, 184.0, 0.0, 113.0, 152.0, 152.0, 159.0, 0.0, 322.0, 43.0, 171.0, 200.0, 79.0, 347.0, 328.0, 323.0, 360.0, 98.0, -13.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-46.0, -38.0, 187.0, -15.0, -18.0, 112.0, 0.0, 0.0, -18.0, 0.0, 185.0, 0.0, -14.0, 0.0, 0.0, 170.0, -6.0, 0.0, 153.0, -38.0, 0.0, 23.0, 166.0, 143.0, 0.0, 159.0, 0.0, 96.0, 160.0, 133.0, 0.0, -20.0, -8.0, 167.0, 0.0, 158.0, 157.0, 145.0, 0.0, -72.0, 0.0, 76.0, -34.0, -6.0, -6.0, 0.0, 0.0, 0.0, 128.0, 24.0, 0.0, 0.0, 122.0, 177.0, 35.0, -66.0, 0.0, 7.0, 155.0, 0.0, 0.0, 0.0, 169.0, 0.0, 142.0, 0.0, 136.0, 161.0, -16.0, -6.0, -8.0, 161.0, 178.0, 0.0, 0.0, 16.0, 0.0, 162.0, 179.0, 0.0, 0.0, -8.0, 0.0, 190.0, 192.0, 158.0, -36.0, 3.0, 0.0, 0.0, -10.0, 175.0, 178.0, 0.0, 163.0, 0.0, 173.0, 0.0, 0.0, -8.0, 129.0, 0.0, 172.0, 1.0, 0.0, -12.0, 18.0, 191.0, 178.0, 161.0, 0.0, -24.0, -14.0, 0.0, 183.0, -18.0, 52.0, 157.0, 14.0, 0.0, 181.0, 160.0, 196.0, 0.0, 159.0, 0.0, -4.0, 134.0, 171.0, -4.0, -2.0, 0.0, 178.0, 195.0, 0.0, 0.0, 158.0, 138.0, 185.0, -4.0, 177.0, 193.0, 146.0, 167.0, 153.0, 171.0, 194.0, -30.0, 138.0, 178.0, 59.0, 0.0, -4.0, -24.0, 75.0, 178.0, 138.0, 0.0, 0.0, 199.0, -11.0, 194.0, 194.0, 190.0, -16.0, 192.0, 0.0, 0.0, 112.0, -44.0, 152.0, 0.0, 0.0, 134.0, 0.0, 157.0, 0.0, 0.0, 134.0, 164.0, 23.0, -10.0, 0.0, 157.0, 0.0, 200.0, 0.0, 57.0, 156.0, 178.0, 171.0, 148.0, 153.0, 152.0, 168.0, 190.0, 62.0, 0.0, -8.0, -18.0], "policy_predator_policy_reward": [21.0, 30.0, 0.0, 8.0, 9.0, 15.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 3.0, 0.0, 16.0, 12.0, 11.0, 0.0, 2.0, 4.0, 0.0, 0.0, 0.0, 24.0, 16.0, 20.0, 10.0, 0.0, 4.0, 0.0, 6.0, 0.0, 0.0, 12.0, 0.0, 43.0, 6.0, 11.0, 8.0, 12.0, 3.0, 2.0, 0.0, 0.0, 22.0, 12.0, 0.0, 0.0, 0.0, 2.0, 33.0, 5.0, 10.0, 0.0, 6.0, 6.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 21.0, 0.0, 0.0, 11.0, 3.0, 12.0, 4.0, 0.0, 0.0, 0.0, 0.0, 5.0, 3.0, 0.0, 4.0, 0.0, 0.0, 0.0, 8.0, 0.0, 19.0, 0.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 1.0, 3.0, 7.0, 0.0, 4.0, 3.0, 0.0, 20.0, 11.0, 0.0, 6.0, 0.0, 0.0, 0.0, 5.0, 3.0, 10.0, 64.0, 0.0, 7.0, 9.0, 0.0, 0.0, 8.0, 0.0, 9.0, 13.0, 4.0, 0.0, 0.0, 12.0, 9.0, 3.0, 8.0, 4.0, 7.0, 1.0, 0.0, 0.0, 3.0, 0.0, 0.0, 18.0, 7.0, 0.0, 2.0, 5.0, 0.0, 0.0, 19.0, 14.0, 1.0, 9.0, 15.0, 0.0, 17.0, 9.0, 2.0, 12.0, 14.0, 10.0, 11.0, 17.0, 6.0, 0.0, 0.0, 10.0, 28.0, 0.0, 1.0, 8.0, 0.0, 0.0, 0.0, 23.0, 22.0, 0.0, 0.0, 13.0, 5.0, 2.0, 0.0, 0.0, 0.0, 10.0, 14.0, 21.0, 9.0, 0.0, 14.0, 0.0, 0.0, 22.0, 0.0, 12.0, 1.0, 0.0, 9.0, 17.0, 1.0, 0.0, 2.0, 17.0, 19.0, 2.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 27.009007358844045, "mean_inference_ms": 46.93329792605557, "mean_action_processing_ms": 6.837458972454533, "mean_env_wait_ms": 5.873597978085233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008126378059387207, "StateBufferConnector_ms": 0.004186511039733887, "ViewRequirementAgentConnector_ms": 0.11030292510986328}, "num_episodes": 18, "episode_return_max": 385.0, "episode_return_min": -33.0, "episode_return_mean": 147.99, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2944000, "num_agent_steps_trained": 2944000, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.65004049324176, "num_env_steps_trained_throughput_per_sec": 300.65004049324176, "timesteps_total": 736000, "num_env_steps_sampled_lifetime": 736000, "num_agent_steps_sampled_lifetime": 2944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2944000, "timers": {"training_iteration_time_ms": 13328.738, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13328.684, "sample_time_ms": 1541.76, "learn_time_ms": 11767.416, "learn_throughput": 339.922, "synch_weights_time_ms": 17.205}, "counters": {"num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 2944000, "num_agent_steps_trained": 2944000}, "done": false, "training_iteration": 184, "trial_id": "f6b99_00000", "date": "2024-08-13_23-21-10", "timestamp": 1723605670, "time_this_iter_s": 13.352503776550293, "time_total_s": 12966.988347768784, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6f78670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12966.988347768784, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 49.978947368421046, "ram_util_percent": 83.63684210526317}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1513223772563, "cur_kl_coeff": 1.778362613419349e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2375510771438558, "policy_loss": -0.0018368357075526128, "vf_loss": 1.2393879100443825, "vf_explained_var": 0.011040117217119408, "kl": 0.0012753538659645374, "entropy": 0.04600891371075281, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 348705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6706295006804996, "cur_kl_coeff": 3.4144562177651485e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.516620054951421, "policy_loss": -0.00820614684954601, "vf_loss": 6.5248261953787825, "vf_explained_var": 0.5908233353385219, "kl": 0.015352855923198856, "entropy": 1.0329972790347206, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 348705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000}, "env_runners": {"episode_reward_max": 385.0, "episode_reward_min": -29.0, "episode_reward_mean": 161.91, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -124.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 100.0}, "policy_reward_mean": {"prey_policy": 74.325, "predator_policy": 6.63}, "custom_metrics": {}, "hist_stats": {"episode_reward": [314.0, -29.0, 93.0, -20.0, -1.0, 0.0, 186.0, 0.0, 301.0, 7.0, 17.0, 167.0, 0.0, 169.0, 161.0, 318.0, -11.0, 168.0, 182.0, 16.0, 167.0, 182.0, -4.0, 190.0, 358.0, -14.0, 0.0, 175.0, 178.0, 167.0, 180.0, -1.0, 149.0, 184.0, -6.0, 209.0, 347.0, 50.0, -7.0, 174.0, 217.0, 23.0, 358.0, 196.0, 180.0, 141.0, 178.0, -1.0, 376.0, 0.0, 321.0, 183.0, 375.0, 332.0, 339.0, 188.0, 333.0, 70.0, -2.0, 274.0, 161.0, 199.0, 221.0, 385.0, 184.0, 0.0, 113.0, 152.0, 152.0, 159.0, 0.0, 322.0, 43.0, 171.0, 200.0, 79.0, 347.0, 328.0, 323.0, 360.0, 98.0, -13.0, 345.0, 0.0, 351.0, 352.0, 204.0, -16.0, 195.0, -3.0, 155.0, 168.0, 222.0, 123.0, 129.0, 197.0, 302.0, 328.0, 175.0, 183.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [157.0, 145.0, 0.0, -72.0, 0.0, 76.0, -34.0, -6.0, -6.0, 0.0, 0.0, 0.0, 128.0, 24.0, 0.0, 0.0, 122.0, 177.0, 35.0, -66.0, 0.0, 7.0, 155.0, 0.0, 0.0, 0.0, 169.0, 0.0, 142.0, 0.0, 136.0, 161.0, -16.0, -6.0, -8.0, 161.0, 178.0, 0.0, 0.0, 16.0, 0.0, 162.0, 179.0, 0.0, 0.0, -8.0, 0.0, 190.0, 192.0, 158.0, -36.0, 3.0, 0.0, 0.0, -10.0, 175.0, 178.0, 0.0, 163.0, 0.0, 173.0, 0.0, 0.0, -8.0, 129.0, 0.0, 172.0, 1.0, 0.0, -12.0, 18.0, 191.0, 178.0, 161.0, 0.0, -24.0, -14.0, 0.0, 183.0, -18.0, 52.0, 157.0, 14.0, 0.0, 181.0, 160.0, 196.0, 0.0, 159.0, 0.0, -4.0, 134.0, 171.0, -4.0, -2.0, 0.0, 178.0, 195.0, 0.0, 0.0, 158.0, 138.0, 185.0, -4.0, 177.0, 193.0, 146.0, 167.0, 153.0, 171.0, 194.0, -30.0, 138.0, 178.0, 59.0, 0.0, -4.0, -24.0, 75.0, 178.0, 138.0, 0.0, 0.0, 199.0, -11.0, 194.0, 194.0, 190.0, -16.0, 192.0, 0.0, 0.0, 112.0, -44.0, 152.0, 0.0, 0.0, 134.0, 0.0, 157.0, 0.0, 0.0, 134.0, 164.0, 23.0, -10.0, 0.0, 157.0, 0.0, 200.0, 0.0, 57.0, 156.0, 178.0, 171.0, 148.0, 153.0, 152.0, 168.0, 190.0, 62.0, 0.0, -8.0, -18.0, 155.0, 154.0, 0.0, 0.0, 173.0, 166.0, 147.0, 189.0, 157.0, 25.0, 0.0, -124.0, 0.0, 194.0, 0.0, -6.0, 0.0, 139.0, 153.0, 0.0, 45.0, 170.0, 0.0, 111.0, 124.0, 0.0, 197.0, 0.0, 106.0, 196.0, 126.0, 170.0, 0.0, 166.0, -4.0, 182.0], "policy_predator_policy_reward": [0.0, 12.0, 0.0, 43.0, 6.0, 11.0, 8.0, 12.0, 3.0, 2.0, 0.0, 0.0, 22.0, 12.0, 0.0, 0.0, 0.0, 2.0, 33.0, 5.0, 10.0, 0.0, 6.0, 6.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 21.0, 0.0, 0.0, 11.0, 3.0, 12.0, 4.0, 0.0, 0.0, 0.0, 0.0, 5.0, 3.0, 0.0, 4.0, 0.0, 0.0, 0.0, 8.0, 0.0, 19.0, 0.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 1.0, 3.0, 7.0, 0.0, 4.0, 3.0, 0.0, 20.0, 11.0, 0.0, 6.0, 0.0, 0.0, 0.0, 5.0, 3.0, 10.0, 64.0, 0.0, 7.0, 9.0, 0.0, 0.0, 8.0, 0.0, 9.0, 13.0, 4.0, 0.0, 0.0, 12.0, 9.0, 3.0, 8.0, 4.0, 7.0, 1.0, 0.0, 0.0, 3.0, 0.0, 0.0, 18.0, 7.0, 0.0, 2.0, 5.0, 0.0, 0.0, 19.0, 14.0, 1.0, 9.0, 15.0, 0.0, 17.0, 9.0, 2.0, 12.0, 14.0, 10.0, 11.0, 17.0, 6.0, 0.0, 0.0, 10.0, 28.0, 0.0, 1.0, 8.0, 0.0, 0.0, 0.0, 23.0, 22.0, 0.0, 0.0, 13.0, 5.0, 2.0, 0.0, 0.0, 0.0, 10.0, 14.0, 21.0, 9.0, 0.0, 14.0, 0.0, 0.0, 22.0, 0.0, 12.0, 1.0, 0.0, 9.0, 17.0, 1.0, 0.0, 2.0, 17.0, 19.0, 2.0, 11.0, 15.0, 21.0, 0.0, 0.0, 0.0, 12.0, 0.0, 16.0, 11.0, 11.0, 8.0, 100.0, 1.0, 0.0, 3.0, 0.0, 15.0, 1.0, 13.0, 2.0, 0.0, 7.0, 0.0, 12.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 18.0, 14.0, 0.0, 9.0, 3.0, 2.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 26.87795791374533, "mean_inference_ms": 46.71008443892797, "mean_action_processing_ms": 6.804762017017052, "mean_env_wait_ms": 5.845525785345623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009741544723510742, "StateBufferConnector_ms": 0.004194974899291992, "ViewRequirementAgentConnector_ms": 0.11282789707183838}, "num_episodes": 18, "episode_return_max": 385.0, "episode_return_min": -29.0, "episode_return_mean": 161.91, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 282.2922379770496, "num_env_steps_trained_throughput_per_sec": 282.2922379770496, "timesteps_total": 740000, "num_env_steps_sampled_lifetime": 740000, "num_agent_steps_sampled_lifetime": 2960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2960000, "timers": {"training_iteration_time_ms": 13367.288, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13367.233, "sample_time_ms": 1548.477, "learn_time_ms": 11799.052, "learn_throughput": 339.01, "synch_weights_time_ms": 17.162}, "counters": {"num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000}, "done": false, "training_iteration": 185, "trial_id": "f6b99_00000", "date": "2024-08-13_23-21-25", "timestamp": 1723605685, "time_this_iter_s": 14.209251165390015, "time_total_s": 12981.197598934174, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6f1a820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12981.197598934174, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 54.515, "ram_util_percent": 83.435}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1715606088045414, "cur_kl_coeff": 8.891813067096745e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3835682713480852, "policy_loss": -0.0008506994391421951, "vf_loss": 1.3844189681073344, "vf_explained_var": 0.0693558639004117, "kl": 0.0011371171677672207, "entropy": 0.041024557523005614, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 350595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.438730417326014, "cur_kl_coeff": 3.4144562177651485e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.898169078019561, "policy_loss": -0.005542768475417265, "vf_loss": 7.9037118250730805, "vf_explained_var": 0.5993919971443358, "kl": 0.013892638157360034, "entropy": 0.9310312304547224, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 350595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 2976000, "num_agent_steps_trained": 2976000}, "env_runners": {"episode_reward_max": 385.0, "episode_reward_min": -16.0, "episode_reward_mean": 193.52, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -124.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 100.0}, "policy_reward_mean": {"prey_policy": 89.84, "predator_policy": 6.92}, "custom_metrics": {}, "hist_stats": {"episode_reward": [182.0, 16.0, 167.0, 182.0, -4.0, 190.0, 358.0, -14.0, 0.0, 175.0, 178.0, 167.0, 180.0, -1.0, 149.0, 184.0, -6.0, 209.0, 347.0, 50.0, -7.0, 174.0, 217.0, 23.0, 358.0, 196.0, 180.0, 141.0, 178.0, -1.0, 376.0, 0.0, 321.0, 183.0, 375.0, 332.0, 339.0, 188.0, 333.0, 70.0, -2.0, 274.0, 161.0, 199.0, 221.0, 385.0, 184.0, 0.0, 113.0, 152.0, 152.0, 159.0, 0.0, 322.0, 43.0, 171.0, 200.0, 79.0, 347.0, 328.0, 323.0, 360.0, 98.0, -13.0, 345.0, 0.0, 351.0, 352.0, 204.0, -16.0, 195.0, -3.0, 155.0, 168.0, 222.0, 123.0, 129.0, 197.0, 302.0, 328.0, 175.0, 183.0, 366.0, 357.0, 330.0, 185.0, 317.0, 344.0, 315.0, 335.0, 255.0, 168.0, 191.0, 371.0, 186.0, 102.0, 185.0, 368.0, 323.0, 303.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [178.0, 0.0, 0.0, 16.0, 0.0, 162.0, 179.0, 0.0, 0.0, -8.0, 0.0, 190.0, 192.0, 158.0, -36.0, 3.0, 0.0, 0.0, -10.0, 175.0, 178.0, 0.0, 163.0, 0.0, 173.0, 0.0, 0.0, -8.0, 129.0, 0.0, 172.0, 1.0, 0.0, -12.0, 18.0, 191.0, 178.0, 161.0, 0.0, -24.0, -14.0, 0.0, 183.0, -18.0, 52.0, 157.0, 14.0, 0.0, 181.0, 160.0, 196.0, 0.0, 159.0, 0.0, -4.0, 134.0, 171.0, -4.0, -2.0, 0.0, 178.0, 195.0, 0.0, 0.0, 158.0, 138.0, 185.0, -4.0, 177.0, 193.0, 146.0, 167.0, 153.0, 171.0, 194.0, -30.0, 138.0, 178.0, 59.0, 0.0, -4.0, -24.0, 75.0, 178.0, 138.0, 0.0, 0.0, 199.0, -11.0, 194.0, 194.0, 190.0, -16.0, 192.0, 0.0, 0.0, 112.0, -44.0, 152.0, 0.0, 0.0, 134.0, 0.0, 157.0, 0.0, 0.0, 134.0, 164.0, 23.0, -10.0, 0.0, 157.0, 0.0, 200.0, 0.0, 57.0, 156.0, 178.0, 171.0, 148.0, 153.0, 152.0, 168.0, 190.0, 62.0, 0.0, -8.0, -18.0, 155.0, 154.0, 0.0, 0.0, 173.0, 166.0, 147.0, 189.0, 157.0, 25.0, 0.0, -124.0, 0.0, 194.0, 0.0, -6.0, 0.0, 139.0, 153.0, 0.0, 45.0, 170.0, 0.0, 111.0, 124.0, 0.0, 197.0, 0.0, 106.0, 196.0, 126.0, 170.0, 0.0, 166.0, -4.0, 182.0, 188.0, 171.0, 165.0, 176.0, 180.0, 143.0, 38.0, 91.0, 154.0, 150.0, 160.0, 152.0, 181.0, 102.0, 152.0, 169.0, 32.0, 197.0, 181.0, -34.0, 191.0, -2.0, 181.0, 181.0, 186.0, 0.0, 93.0, 0.0, 185.0, 0.0, 173.0, 195.0, 161.0, 142.0, 140.0, 110.0], "policy_predator_policy_reward": [4.0, 0.0, 0.0, 0.0, 0.0, 5.0, 3.0, 0.0, 4.0, 0.0, 0.0, 0.0, 8.0, 0.0, 19.0, 0.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 1.0, 3.0, 7.0, 0.0, 4.0, 3.0, 0.0, 20.0, 11.0, 0.0, 6.0, 0.0, 0.0, 0.0, 5.0, 3.0, 10.0, 64.0, 0.0, 7.0, 9.0, 0.0, 0.0, 8.0, 0.0, 9.0, 13.0, 4.0, 0.0, 0.0, 12.0, 9.0, 3.0, 8.0, 4.0, 7.0, 1.0, 0.0, 0.0, 3.0, 0.0, 0.0, 18.0, 7.0, 0.0, 2.0, 5.0, 0.0, 0.0, 19.0, 14.0, 1.0, 9.0, 15.0, 0.0, 17.0, 9.0, 2.0, 12.0, 14.0, 10.0, 11.0, 17.0, 6.0, 0.0, 0.0, 10.0, 28.0, 0.0, 1.0, 8.0, 0.0, 0.0, 0.0, 23.0, 22.0, 0.0, 0.0, 13.0, 5.0, 2.0, 0.0, 0.0, 0.0, 10.0, 14.0, 21.0, 9.0, 0.0, 14.0, 0.0, 0.0, 22.0, 0.0, 12.0, 1.0, 0.0, 9.0, 17.0, 1.0, 0.0, 2.0, 17.0, 19.0, 2.0, 11.0, 15.0, 21.0, 0.0, 0.0, 0.0, 12.0, 0.0, 16.0, 11.0, 11.0, 8.0, 100.0, 1.0, 0.0, 3.0, 0.0, 15.0, 1.0, 13.0, 2.0, 0.0, 7.0, 0.0, 12.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 18.0, 14.0, 0.0, 9.0, 3.0, 2.0, 2.0, 5.0, 7.0, 9.0, 6.0, 1.0, 28.0, 28.0, 0.0, 13.0, 18.0, 14.0, 0.0, 32.0, 14.0, 0.0, 13.0, 13.0, 16.0, 5.0, 1.0, 1.0, 8.0, 1.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 31.0, 22.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 26.74833640157288, "mean_inference_ms": 46.48931210986957, "mean_action_processing_ms": 6.772426145086719, "mean_env_wait_ms": 5.8177686771952315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009391307830810547, "StateBufferConnector_ms": 0.004119873046875, "ViewRequirementAgentConnector_ms": 0.11018931865692139}, "num_episodes": 18, "episode_return_max": 385.0, "episode_return_min": -16.0, "episode_return_mean": 193.52, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2976000, "num_agent_steps_trained": 2976000, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 262.5816703075008, "num_env_steps_trained_throughput_per_sec": 262.5816703075008, "timesteps_total": 744000, "num_env_steps_sampled_lifetime": 744000, "num_agent_steps_sampled_lifetime": 2976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2976000, "timers": {"training_iteration_time_ms": 13601.846, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13601.793, "sample_time_ms": 1552.761, "learn_time_ms": 12029.463, "learn_throughput": 332.517, "synch_weights_time_ms": 17.06}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 2976000, "num_agent_steps_trained": 2976000}, "done": false, "training_iteration": 186, "trial_id": "f6b99_00000", "date": "2024-08-13_23-21-40", "timestamp": 1723605700, "time_this_iter_s": 15.290318727493286, "time_total_s": 12996.487917661667, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6f1dd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12996.487917661667, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 63.06818181818182, "ram_util_percent": 82.9590909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.576280478447203, "cur_kl_coeff": 4.4459065335483725e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7970391009850477, "policy_loss": -0.0012987865746100114, "vf_loss": 1.7983378846493978, "vf_explained_var": 0.04777756434269052, "kl": 0.0016001332023486332, "entropy": 0.05965668817479459, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 352485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8868269809024043, "cur_kl_coeff": 3.4144562177651485e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.612112128797662, "policy_loss": -0.007158414431891981, "vf_loss": 8.619270541175963, "vf_explained_var": 0.4076211169283226, "kl": 0.01271515106393371, "entropy": 0.8938791770468313, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 352485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 2992000, "num_agent_steps_trained": 2992000}, "env_runners": {"episode_reward_max": 388.0, "episode_reward_min": -16.0, "episode_reward_mean": 229.46, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -124.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 100.0}, "policy_reward_mean": {"prey_policy": 106.19, "predator_policy": 8.54}, "custom_metrics": {}, "hist_stats": {"episode_reward": [141.0, 178.0, -1.0, 376.0, 0.0, 321.0, 183.0, 375.0, 332.0, 339.0, 188.0, 333.0, 70.0, -2.0, 274.0, 161.0, 199.0, 221.0, 385.0, 184.0, 0.0, 113.0, 152.0, 152.0, 159.0, 0.0, 322.0, 43.0, 171.0, 200.0, 79.0, 347.0, 328.0, 323.0, 360.0, 98.0, -13.0, 345.0, 0.0, 351.0, 352.0, 204.0, -16.0, 195.0, -3.0, 155.0, 168.0, 222.0, 123.0, 129.0, 197.0, 302.0, 328.0, 175.0, 183.0, 366.0, 357.0, 330.0, 185.0, 317.0, 344.0, 315.0, 335.0, 255.0, 168.0, 191.0, 371.0, 186.0, 102.0, 185.0, 368.0, 323.0, 303.0, 388.0, 337.0, 365.0, 199.0, 300.0, 349.0, 344.0, 216.0, 373.0, 234.0, 233.0, 338.0, 189.0, 346.0, 334.0, 171.0, 312.0, 277.0, 244.0, 235.0, 99.0, 7.0, 362.0, 157.0, 305.0, 375.0, 355.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-4.0, 134.0, 171.0, -4.0, -2.0, 0.0, 178.0, 195.0, 0.0, 0.0, 158.0, 138.0, 185.0, -4.0, 177.0, 193.0, 146.0, 167.0, 153.0, 171.0, 194.0, -30.0, 138.0, 178.0, 59.0, 0.0, -4.0, -24.0, 75.0, 178.0, 138.0, 0.0, 0.0, 199.0, -11.0, 194.0, 194.0, 190.0, -16.0, 192.0, 0.0, 0.0, 112.0, -44.0, 152.0, 0.0, 0.0, 134.0, 0.0, 157.0, 0.0, 0.0, 134.0, 164.0, 23.0, -10.0, 0.0, 157.0, 0.0, 200.0, 0.0, 57.0, 156.0, 178.0, 171.0, 148.0, 153.0, 152.0, 168.0, 190.0, 62.0, 0.0, -8.0, -18.0, 155.0, 154.0, 0.0, 0.0, 173.0, 166.0, 147.0, 189.0, 157.0, 25.0, 0.0, -124.0, 0.0, 194.0, 0.0, -6.0, 0.0, 139.0, 153.0, 0.0, 45.0, 170.0, 0.0, 111.0, 124.0, 0.0, 197.0, 0.0, 106.0, 196.0, 126.0, 170.0, 0.0, 166.0, -4.0, 182.0, 188.0, 171.0, 165.0, 176.0, 180.0, 143.0, 38.0, 91.0, 154.0, 150.0, 160.0, 152.0, 181.0, 102.0, 152.0, 169.0, 32.0, 197.0, 181.0, -34.0, 191.0, -2.0, 181.0, 181.0, 186.0, 0.0, 93.0, 0.0, 185.0, 0.0, 173.0, 195.0, 161.0, 142.0, 140.0, 110.0, 191.0, 194.0, 128.0, 187.0, 167.0, 188.0, 199.0, 0.0, 149.0, 127.0, 177.0, 153.0, 131.0, 181.0, 168.0, 24.0, 163.0, 198.0, 71.0, 121.0, 129.0, 33.0, 181.0, 144.0, 189.0, 0.0, 178.0, 156.0, 143.0, 188.0, 0.0, 158.0, 153.0, 154.0, 193.0, 30.0, 44.0, 171.0, 73.0, 139.0, -24.0, 85.0, 0.0, -82.0, 175.0, 178.0, 155.0, 0.0, 130.0, 154.0, 186.0, 182.0, 149.0, 198.0], "policy_predator_policy_reward": [3.0, 8.0, 4.0, 7.0, 1.0, 0.0, 0.0, 3.0, 0.0, 0.0, 18.0, 7.0, 0.0, 2.0, 5.0, 0.0, 0.0, 19.0, 14.0, 1.0, 9.0, 15.0, 0.0, 17.0, 9.0, 2.0, 12.0, 14.0, 10.0, 11.0, 17.0, 6.0, 0.0, 0.0, 10.0, 28.0, 0.0, 1.0, 8.0, 0.0, 0.0, 0.0, 23.0, 22.0, 0.0, 0.0, 13.0, 5.0, 2.0, 0.0, 0.0, 0.0, 10.0, 14.0, 21.0, 9.0, 0.0, 14.0, 0.0, 0.0, 22.0, 0.0, 12.0, 1.0, 0.0, 9.0, 17.0, 1.0, 0.0, 2.0, 17.0, 19.0, 2.0, 11.0, 15.0, 21.0, 0.0, 0.0, 0.0, 12.0, 0.0, 16.0, 11.0, 11.0, 8.0, 100.0, 1.0, 0.0, 3.0, 0.0, 15.0, 1.0, 13.0, 2.0, 0.0, 7.0, 0.0, 12.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 18.0, 14.0, 0.0, 9.0, 3.0, 2.0, 2.0, 5.0, 7.0, 9.0, 6.0, 1.0, 28.0, 28.0, 0.0, 13.0, 18.0, 14.0, 0.0, 32.0, 14.0, 0.0, 13.0, 13.0, 16.0, 5.0, 1.0, 1.0, 8.0, 1.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 31.0, 22.0, 1.0, 2.0, 11.0, 11.0, 0.0, 10.0, 0.0, 0.0, 24.0, 0.0, 9.0, 10.0, 15.0, 17.0, 7.0, 17.0, 12.0, 0.0, 42.0, 0.0, 19.0, 52.0, 13.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 3.0, 13.0, 0.0, 5.0, 0.0, 40.0, 14.0, 29.0, 0.0, 9.0, 14.0, 24.0, 14.0, 89.0, 0.0, 2.0, 7.0, 2.0, 0.0, 13.0, 8.0, 3.0, 4.0, 0.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 26.843164330595865, "mean_inference_ms": 45.970936674798786, "mean_action_processing_ms": 6.732792134034744, "mean_env_wait_ms": 6.152614373106039, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0076100826263427734, "StateBufferConnector_ms": 0.0044934749603271484, "ViewRequirementAgentConnector_ms": 0.12096560001373291}, "num_episodes": 27, "episode_return_max": 388.0, "episode_return_min": -16.0, "episode_return_mean": 229.46, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2992000, "num_agent_steps_trained": 2992000, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 239.62097953572916, "num_env_steps_trained_throughput_per_sec": 239.62097953572916, "timesteps_total": 748000, "num_env_steps_sampled_lifetime": 748000, "num_agent_steps_sampled_lifetime": 2992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2992000, "timers": {"training_iteration_time_ms": 13910.127, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13910.071, "sample_time_ms": 1668.499, "learn_time_ms": 12220.334, "learn_throughput": 327.323, "synch_weights_time_ms": 18.473}, "counters": {"num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 2992000, "num_agent_steps_trained": 2992000}, "done": false, "training_iteration": 187, "trial_id": "f6b99_00000", "date": "2024-08-13_23-21-57", "timestamp": 1723605717, "time_this_iter_s": 16.757257223129272, "time_total_s": 13013.245174884796, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6f78670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13013.245174884796, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 67.60434782608695, "ram_util_percent": 82.90434782608696}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5201813984484898, "cur_kl_coeff": 2.2229532667741863e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7671275073889072, "policy_loss": -0.0018259249457586852, "vf_loss": 1.7689534289496285, "vf_explained_var": 0.09969658561484523, "kl": 0.0008069708931107343, "entropy": 0.04710387041762708, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 354375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.702814475096092, "cur_kl_coeff": 3.4144562177651485e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.866219584147135, "policy_loss": -0.00666842698008709, "vf_loss": 8.872888007491985, "vf_explained_var": 0.39580185867491224, "kl": 0.008770352183602476, "entropy": 0.8173711847060572, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 354375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 3008000, "num_agent_steps_trained": 3008000}, "env_runners": {"episode_reward_max": 388.0, "episode_reward_min": -16.0, "episode_reward_mean": 250.62, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -124.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 100.0}, "policy_reward_mean": {"prey_policy": 116.175, "predator_policy": 9.135}, "custom_metrics": {}, "hist_stats": {"episode_reward": [385.0, 184.0, 0.0, 113.0, 152.0, 152.0, 159.0, 0.0, 322.0, 43.0, 171.0, 200.0, 79.0, 347.0, 328.0, 323.0, 360.0, 98.0, -13.0, 345.0, 0.0, 351.0, 352.0, 204.0, -16.0, 195.0, -3.0, 155.0, 168.0, 222.0, 123.0, 129.0, 197.0, 302.0, 328.0, 175.0, 183.0, 366.0, 357.0, 330.0, 185.0, 317.0, 344.0, 315.0, 335.0, 255.0, 168.0, 191.0, 371.0, 186.0, 102.0, 185.0, 368.0, 323.0, 303.0, 388.0, 337.0, 365.0, 199.0, 300.0, 349.0, 344.0, 216.0, 373.0, 234.0, 233.0, 338.0, 189.0, 346.0, 334.0, 171.0, 312.0, 277.0, 244.0, 235.0, 99.0, 7.0, 362.0, 157.0, 305.0, 375.0, 355.0, 376.0, 331.0, 367.0, 343.0, 385.0, 382.0, 354.0, 357.0, 179.0, 374.0, 322.0, 293.0, 329.0, 248.0, 265.0, 293.0, 280.0, 326.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [194.0, 190.0, -16.0, 192.0, 0.0, 0.0, 112.0, -44.0, 152.0, 0.0, 0.0, 134.0, 0.0, 157.0, 0.0, 0.0, 134.0, 164.0, 23.0, -10.0, 0.0, 157.0, 0.0, 200.0, 0.0, 57.0, 156.0, 178.0, 171.0, 148.0, 153.0, 152.0, 168.0, 190.0, 62.0, 0.0, -8.0, -18.0, 155.0, 154.0, 0.0, 0.0, 173.0, 166.0, 147.0, 189.0, 157.0, 25.0, 0.0, -124.0, 0.0, 194.0, 0.0, -6.0, 0.0, 139.0, 153.0, 0.0, 45.0, 170.0, 0.0, 111.0, 124.0, 0.0, 197.0, 0.0, 106.0, 196.0, 126.0, 170.0, 0.0, 166.0, -4.0, 182.0, 188.0, 171.0, 165.0, 176.0, 180.0, 143.0, 38.0, 91.0, 154.0, 150.0, 160.0, 152.0, 181.0, 102.0, 152.0, 169.0, 32.0, 197.0, 181.0, -34.0, 191.0, -2.0, 181.0, 181.0, 186.0, 0.0, 93.0, 0.0, 185.0, 0.0, 173.0, 195.0, 161.0, 142.0, 140.0, 110.0, 191.0, 194.0, 128.0, 187.0, 167.0, 188.0, 199.0, 0.0, 149.0, 127.0, 177.0, 153.0, 131.0, 181.0, 168.0, 24.0, 163.0, 198.0, 71.0, 121.0, 129.0, 33.0, 181.0, 144.0, 189.0, 0.0, 178.0, 156.0, 143.0, 188.0, 0.0, 158.0, 153.0, 154.0, 193.0, 30.0, 44.0, 171.0, 73.0, 139.0, -24.0, 85.0, 0.0, -82.0, 175.0, 178.0, 155.0, 0.0, 130.0, 154.0, 186.0, 182.0, 149.0, 198.0, 194.0, 171.0, 196.0, 95.0, 191.0, 176.0, 170.0, 166.0, 195.0, 190.0, 197.0, 185.0, 198.0, 156.0, 159.0, 180.0, 0.0, 173.0, 196.0, 171.0, 127.0, 165.0, 125.0, 134.0, 174.0, 131.0, 45.0, 176.0, 96.0, 133.0, 135.0, 97.0, 120.0, 126.0, 200.0, 90.0], "policy_predator_policy_reward": [0.0, 1.0, 8.0, 0.0, 0.0, 0.0, 23.0, 22.0, 0.0, 0.0, 13.0, 5.0, 2.0, 0.0, 0.0, 0.0, 10.0, 14.0, 21.0, 9.0, 0.0, 14.0, 0.0, 0.0, 22.0, 0.0, 12.0, 1.0, 0.0, 9.0, 17.0, 1.0, 0.0, 2.0, 17.0, 19.0, 2.0, 11.0, 15.0, 21.0, 0.0, 0.0, 0.0, 12.0, 0.0, 16.0, 11.0, 11.0, 8.0, 100.0, 1.0, 0.0, 3.0, 0.0, 15.0, 1.0, 13.0, 2.0, 0.0, 7.0, 0.0, 12.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 18.0, 14.0, 0.0, 9.0, 3.0, 2.0, 2.0, 5.0, 7.0, 9.0, 6.0, 1.0, 28.0, 28.0, 0.0, 13.0, 18.0, 14.0, 0.0, 32.0, 14.0, 0.0, 13.0, 13.0, 16.0, 5.0, 1.0, 1.0, 8.0, 1.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 31.0, 22.0, 1.0, 2.0, 11.0, 11.0, 0.0, 10.0, 0.0, 0.0, 24.0, 0.0, 9.0, 10.0, 15.0, 17.0, 7.0, 17.0, 12.0, 0.0, 42.0, 0.0, 19.0, 52.0, 13.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 3.0, 13.0, 0.0, 5.0, 0.0, 40.0, 14.0, 29.0, 0.0, 9.0, 14.0, 24.0, 14.0, 89.0, 0.0, 2.0, 7.0, 2.0, 0.0, 13.0, 8.0, 3.0, 4.0, 0.0, 8.0, 2.0, 9.0, 26.0, 14.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 14.0, 6.0, 0.0, 3.0, 4.0, 18.0, 12.0, 23.0, 11.0, 13.0, 11.0, 27.0, 0.0, 19.0, 17.0, 25.0, 36.0, 17.0, 17.0, 3.0, 33.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 26.437150168320887, "mean_inference_ms": 45.96237641883865, "mean_action_processing_ms": 6.694701259864621, "mean_env_wait_ms": 5.752137403338216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006853342056274414, "StateBufferConnector_ms": 0.004015684127807617, "ViewRequirementAgentConnector_ms": 0.14419853687286377}, "num_episodes": 18, "episode_return_max": 388.0, "episode_return_min": -16.0, "episode_return_mean": 250.62, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3008000, "num_agent_steps_trained": 3008000, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 249.4367414147557, "num_env_steps_trained_throughput_per_sec": 249.4367414147557, "timesteps_total": 752000, "num_env_steps_sampled_lifetime": 752000, "num_agent_steps_sampled_lifetime": 3008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3008000, "timers": {"training_iteration_time_ms": 14167.265, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14167.206, "sample_time_ms": 1851.84, "learn_time_ms": 12293.377, "learn_throughput": 325.378, "synch_weights_time_ms": 19.056}, "counters": {"num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 3008000, "num_agent_steps_trained": 3008000}, "done": false, "training_iteration": 188, "trial_id": "f6b99_00000", "date": "2024-08-13_23-22-13", "timestamp": 1723605733, "time_this_iter_s": 16.09134078025818, "time_total_s": 13029.336515665054, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6fd55e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13029.336515665054, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 60.09130434782608, "ram_util_percent": 81.5695652173913}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5636347646593416, "cur_kl_coeff": 1.1114766333870931e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.976333751375713, "policy_loss": -0.001559675134787405, "vf_loss": 1.9778934223626656, "vf_explained_var": 0.20098629811453442, "kl": 0.0019824926800928637, "entropy": 0.04162812677394382, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 356265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7996129094608246, "cur_kl_coeff": 3.4144562177651485e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.781829940705073, "policy_loss": -0.00873444645170359, "vf_loss": 8.79056437759803, "vf_explained_var": 0.21388889522779556, "kl": 0.01798718020101399, "entropy": 0.8084055032048907, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 356265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 3024000, "num_agent_steps_trained": 3024000}, "env_runners": {"episode_reward_max": 397.0, "episode_reward_min": -16.0, "episode_reward_mean": 271.64, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -124.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 100.0}, "policy_reward_mean": {"prey_policy": 125.42, "predator_policy": 10.4}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.0, 345.0, 0.0, 351.0, 352.0, 204.0, -16.0, 195.0, -3.0, 155.0, 168.0, 222.0, 123.0, 129.0, 197.0, 302.0, 328.0, 175.0, 183.0, 366.0, 357.0, 330.0, 185.0, 317.0, 344.0, 315.0, 335.0, 255.0, 168.0, 191.0, 371.0, 186.0, 102.0, 185.0, 368.0, 323.0, 303.0, 388.0, 337.0, 365.0, 199.0, 300.0, 349.0, 344.0, 216.0, 373.0, 234.0, 233.0, 338.0, 189.0, 346.0, 334.0, 171.0, 312.0, 277.0, 244.0, 235.0, 99.0, 7.0, 362.0, 157.0, 305.0, 375.0, 355.0, 376.0, 331.0, 367.0, 343.0, 385.0, 382.0, 354.0, 357.0, 179.0, 374.0, 322.0, 293.0, 329.0, 248.0, 265.0, 293.0, 280.0, 326.0, 214.0, 351.0, 271.0, 314.0, 347.0, 318.0, 328.0, 357.0, 233.0, 359.0, 334.0, 223.0, 244.0, 329.0, 295.0, 252.0, 397.0, 352.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-8.0, -18.0, 155.0, 154.0, 0.0, 0.0, 173.0, 166.0, 147.0, 189.0, 157.0, 25.0, 0.0, -124.0, 0.0, 194.0, 0.0, -6.0, 0.0, 139.0, 153.0, 0.0, 45.0, 170.0, 0.0, 111.0, 124.0, 0.0, 197.0, 0.0, 106.0, 196.0, 126.0, 170.0, 0.0, 166.0, -4.0, 182.0, 188.0, 171.0, 165.0, 176.0, 180.0, 143.0, 38.0, 91.0, 154.0, 150.0, 160.0, 152.0, 181.0, 102.0, 152.0, 169.0, 32.0, 197.0, 181.0, -34.0, 191.0, -2.0, 181.0, 181.0, 186.0, 0.0, 93.0, 0.0, 185.0, 0.0, 173.0, 195.0, 161.0, 142.0, 140.0, 110.0, 191.0, 194.0, 128.0, 187.0, 167.0, 188.0, 199.0, 0.0, 149.0, 127.0, 177.0, 153.0, 131.0, 181.0, 168.0, 24.0, 163.0, 198.0, 71.0, 121.0, 129.0, 33.0, 181.0, 144.0, 189.0, 0.0, 178.0, 156.0, 143.0, 188.0, 0.0, 158.0, 153.0, 154.0, 193.0, 30.0, 44.0, 171.0, 73.0, 139.0, -24.0, 85.0, 0.0, -82.0, 175.0, 178.0, 155.0, 0.0, 130.0, 154.0, 186.0, 182.0, 149.0, 198.0, 194.0, 171.0, 196.0, 95.0, 191.0, 176.0, 170.0, 166.0, 195.0, 190.0, 197.0, 185.0, 198.0, 156.0, 159.0, 180.0, 0.0, 173.0, 196.0, 171.0, 127.0, 165.0, 125.0, 134.0, 174.0, 131.0, 45.0, 176.0, 96.0, 133.0, 135.0, 97.0, 120.0, 126.0, 200.0, 90.0, 83.0, 69.0, 188.0, 149.0, 73.0, 186.0, 164.0, 129.0, 160.0, 187.0, 164.0, 124.0, 183.0, 123.0, 163.0, 177.0, 92.0, 116.0, 153.0, 191.0, 146.0, 164.0, 64.0, 122.0, 17.0, 110.0, 106.0, 199.0, 85.0, 189.0, 188.0, 38.0, 198.0, 199.0, 141.0, 183.0], "policy_predator_policy_reward": [2.0, 11.0, 15.0, 21.0, 0.0, 0.0, 0.0, 12.0, 0.0, 16.0, 11.0, 11.0, 8.0, 100.0, 1.0, 0.0, 3.0, 0.0, 15.0, 1.0, 13.0, 2.0, 0.0, 7.0, 0.0, 12.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 18.0, 14.0, 0.0, 9.0, 3.0, 2.0, 2.0, 5.0, 7.0, 9.0, 6.0, 1.0, 28.0, 28.0, 0.0, 13.0, 18.0, 14.0, 0.0, 32.0, 14.0, 0.0, 13.0, 13.0, 16.0, 5.0, 1.0, 1.0, 8.0, 1.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 31.0, 22.0, 1.0, 2.0, 11.0, 11.0, 0.0, 10.0, 0.0, 0.0, 24.0, 0.0, 9.0, 10.0, 15.0, 17.0, 7.0, 17.0, 12.0, 0.0, 42.0, 0.0, 19.0, 52.0, 13.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 3.0, 13.0, 0.0, 5.0, 0.0, 40.0, 14.0, 29.0, 0.0, 9.0, 14.0, 24.0, 14.0, 89.0, 0.0, 2.0, 7.0, 2.0, 0.0, 13.0, 8.0, 3.0, 4.0, 0.0, 8.0, 2.0, 9.0, 26.0, 14.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 14.0, 6.0, 0.0, 3.0, 4.0, 18.0, 12.0, 23.0, 11.0, 13.0, 11.0, 27.0, 0.0, 19.0, 17.0, 25.0, 36.0, 17.0, 17.0, 3.0, 33.0, 13.0, 49.0, 14.0, 0.0, 4.0, 8.0, 16.0, 5.0, 0.0, 0.0, 6.0, 24.0, 22.0, 0.0, 1.0, 16.0, 22.0, 3.0, 8.0, 7.0, 10.0, 14.0, 13.0, 24.0, 51.0, 66.0, 12.0, 12.0, 3.0, 18.0, 11.0, 15.0, 0.0, 0.0, 15.0, 13.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 26.313242469307934, "mean_inference_ms": 45.75217639404205, "mean_action_processing_ms": 6.663926785319962, "mean_env_wait_ms": 5.725659305053539, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006077289581298828, "StateBufferConnector_ms": 0.004061102867126465, "ViewRequirementAgentConnector_ms": 0.14434325695037842}, "num_episodes": 18, "episode_return_max": 397.0, "episode_return_min": -16.0, "episode_return_mean": 271.64, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3024000, "num_agent_steps_trained": 3024000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 279.70308675065354, "num_env_steps_trained_throughput_per_sec": 279.70308675065354, "timesteps_total": 756000, "num_env_steps_sampled_lifetime": 756000, "num_agent_steps_sampled_lifetime": 3024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3024000, "timers": {"training_iteration_time_ms": 14264.871, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14264.812, "sample_time_ms": 1872.096, "learn_time_ms": 12371.067, "learn_throughput": 323.335, "synch_weights_time_ms": 18.613}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 3024000, "num_agent_steps_trained": 3024000}, "done": false, "training_iteration": 189, "trial_id": "f6b99_00000", "date": "2024-08-13_23-22-27", "timestamp": 1723605747, "time_this_iter_s": 14.345679998397827, "time_total_s": 13043.682195663452, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6f3bee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13043.682195663452, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 55.98571428571429, "ram_util_percent": 80.7095238095238}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.857912125300478, "cur_kl_coeff": 5.557383166935466e-19, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7870925288824808, "policy_loss": -0.0027622783401360113, "vf_loss": 0.78985480666949, "vf_explained_var": 0.24231586017936627, "kl": 0.0011681219844670747, "entropy": 0.038975157738027594, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 358155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.166617166680633, "cur_kl_coeff": 3.4144562177651485e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.023955818206545, "policy_loss": 2.264928574077588e-05, "vf_loss": 8.023933178028733, "vf_explained_var": -0.48827503698843494, "kl": 0.018192610837738255, "entropy": 0.7589212909892753, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 358155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000}, "env_runners": {"episode_reward_max": 397.0, "episode_reward_min": 7.0, "episode_reward_mean": 297.94, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -82.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 89.0}, "policy_reward_mean": {"prey_policy": 138.115, "predator_policy": 10.855}, "custom_metrics": {}, "hist_stats": {"episode_reward": [183.0, 366.0, 357.0, 330.0, 185.0, 317.0, 344.0, 315.0, 335.0, 255.0, 168.0, 191.0, 371.0, 186.0, 102.0, 185.0, 368.0, 323.0, 303.0, 388.0, 337.0, 365.0, 199.0, 300.0, 349.0, 344.0, 216.0, 373.0, 234.0, 233.0, 338.0, 189.0, 346.0, 334.0, 171.0, 312.0, 277.0, 244.0, 235.0, 99.0, 7.0, 362.0, 157.0, 305.0, 375.0, 355.0, 376.0, 331.0, 367.0, 343.0, 385.0, 382.0, 354.0, 357.0, 179.0, 374.0, 322.0, 293.0, 329.0, 248.0, 265.0, 293.0, 280.0, 326.0, 214.0, 351.0, 271.0, 314.0, 347.0, 318.0, 328.0, 357.0, 233.0, 359.0, 334.0, 223.0, 244.0, 329.0, 295.0, 252.0, 397.0, 352.0, 239.0, 306.0, 352.0, 373.0, 351.0, 309.0, 374.0, 381.0, 284.0, 362.0, 359.0, 360.0, 179.0, 345.0, 304.0, 324.0, 322.0, 320.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-4.0, 182.0, 188.0, 171.0, 165.0, 176.0, 180.0, 143.0, 38.0, 91.0, 154.0, 150.0, 160.0, 152.0, 181.0, 102.0, 152.0, 169.0, 32.0, 197.0, 181.0, -34.0, 191.0, -2.0, 181.0, 181.0, 186.0, 0.0, 93.0, 0.0, 185.0, 0.0, 173.0, 195.0, 161.0, 142.0, 140.0, 110.0, 191.0, 194.0, 128.0, 187.0, 167.0, 188.0, 199.0, 0.0, 149.0, 127.0, 177.0, 153.0, 131.0, 181.0, 168.0, 24.0, 163.0, 198.0, 71.0, 121.0, 129.0, 33.0, 181.0, 144.0, 189.0, 0.0, 178.0, 156.0, 143.0, 188.0, 0.0, 158.0, 153.0, 154.0, 193.0, 30.0, 44.0, 171.0, 73.0, 139.0, -24.0, 85.0, 0.0, -82.0, 175.0, 178.0, 155.0, 0.0, 130.0, 154.0, 186.0, 182.0, 149.0, 198.0, 194.0, 171.0, 196.0, 95.0, 191.0, 176.0, 170.0, 166.0, 195.0, 190.0, 197.0, 185.0, 198.0, 156.0, 159.0, 180.0, 0.0, 173.0, 196.0, 171.0, 127.0, 165.0, 125.0, 134.0, 174.0, 131.0, 45.0, 176.0, 96.0, 133.0, 135.0, 97.0, 120.0, 126.0, 200.0, 90.0, 83.0, 69.0, 188.0, 149.0, 73.0, 186.0, 164.0, 129.0, 160.0, 187.0, 164.0, 124.0, 183.0, 123.0, 163.0, 177.0, 92.0, 116.0, 153.0, 191.0, 146.0, 164.0, 64.0, 122.0, 17.0, 110.0, 106.0, 199.0, 85.0, 189.0, 188.0, 38.0, 198.0, 199.0, 141.0, 183.0, 137.0, 53.0, 169.0, 101.0, 178.0, 159.0, 194.0, 175.0, 164.0, 168.0, 131.0, 152.0, 188.0, 178.0, 176.0, 197.0, 124.0, 125.0, 174.0, 179.0, 143.0, 197.0, 164.0, 182.0, 36.0, 108.0, 153.0, 168.0, 194.0, 68.0, 193.0, 110.0, 133.0, 180.0, 145.0, 150.0], "policy_predator_policy_reward": [3.0, 2.0, 2.0, 5.0, 7.0, 9.0, 6.0, 1.0, 28.0, 28.0, 0.0, 13.0, 18.0, 14.0, 0.0, 32.0, 14.0, 0.0, 13.0, 13.0, 16.0, 5.0, 1.0, 1.0, 8.0, 1.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 31.0, 22.0, 1.0, 2.0, 11.0, 11.0, 0.0, 10.0, 0.0, 0.0, 24.0, 0.0, 9.0, 10.0, 15.0, 17.0, 7.0, 17.0, 12.0, 0.0, 42.0, 0.0, 19.0, 52.0, 13.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 3.0, 13.0, 0.0, 5.0, 0.0, 40.0, 14.0, 29.0, 0.0, 9.0, 14.0, 24.0, 14.0, 89.0, 0.0, 2.0, 7.0, 2.0, 0.0, 13.0, 8.0, 3.0, 4.0, 0.0, 8.0, 2.0, 9.0, 26.0, 14.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 14.0, 6.0, 0.0, 3.0, 4.0, 18.0, 12.0, 23.0, 11.0, 13.0, 11.0, 27.0, 0.0, 19.0, 17.0, 25.0, 36.0, 17.0, 17.0, 3.0, 33.0, 13.0, 49.0, 14.0, 0.0, 4.0, 8.0, 16.0, 5.0, 0.0, 0.0, 6.0, 24.0, 22.0, 0.0, 1.0, 16.0, 22.0, 3.0, 8.0, 7.0, 10.0, 14.0, 13.0, 24.0, 51.0, 66.0, 12.0, 12.0, 3.0, 18.0, 11.0, 15.0, 0.0, 0.0, 15.0, 13.0, 20.0, 29.0, 6.0, 30.0, 2.0, 13.0, 0.0, 4.0, 7.0, 12.0, 17.0, 9.0, 3.0, 5.0, 1.0, 7.0, 12.0, 23.0, 7.0, 2.0, 0.0, 19.0, 14.0, 0.0, 17.0, 18.0, 8.0, 16.0, 37.0, 5.0, 10.0, 11.0, 2.0, 7.0, 0.0, 25.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 26.190688584753033, "mean_inference_ms": 45.54431115599837, "mean_action_processing_ms": 6.633518089233128, "mean_env_wait_ms": 5.69948952219932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004925966262817383, "StateBufferConnector_ms": 0.004174590110778809, "ViewRequirementAgentConnector_ms": 0.14130043983459473}, "num_episodes": 18, "episode_return_max": 397.0, "episode_return_min": 7.0, "episode_return_mean": 297.94, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.40989330922713, "num_env_steps_trained_throughput_per_sec": 299.40989330922713, "timesteps_total": 760000, "num_env_steps_sampled_lifetime": 760000, "num_agent_steps_sampled_lifetime": 3040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3040000, "timers": {"training_iteration_time_ms": 14315.29, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14315.23, "sample_time_ms": 1895.527, "learn_time_ms": 12398.828, "learn_throughput": 322.611, "synch_weights_time_ms": 17.738}, "counters": {"num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000}, "done": false, "training_iteration": 190, "trial_id": "f6b99_00000", "date": "2024-08-13_23-22-41", "timestamp": 1723605761, "time_this_iter_s": 13.428457021713257, "time_total_s": 13057.110652685165, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6f76550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13057.110652685165, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 54.921052631578945, "ram_util_percent": 81.08947368421055}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3870310954315954, "cur_kl_coeff": 2.778691583467733e-19, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2029460468304851, "policy_loss": -0.0012045709672507156, "vf_loss": 1.2041506202605667, "vf_explained_var": 0.20427605452991668, "kl": 0.0007521967420876021, "entropy": 0.031013110417517878, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 360045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.850840884163266, "cur_kl_coeff": 3.4144562177651485e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.4143637876662, "policy_loss": -0.0013752547122301564, "vf_loss": 6.4157390531408724, "vf_explained_var": -0.04164107476592695, "kl": 0.013635314077278173, "entropy": 0.8006485622080546, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 360045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 3056000, "num_agent_steps_trained": 3056000}, "env_runners": {"episode_reward_max": 398.0, "episode_reward_min": 7.0, "episode_reward_mean": 313.86, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -82.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 89.0}, "policy_reward_mean": {"prey_policy": 145.94, "predator_policy": 10.99}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 349.0, 344.0, 216.0, 373.0, 234.0, 233.0, 338.0, 189.0, 346.0, 334.0, 171.0, 312.0, 277.0, 244.0, 235.0, 99.0, 7.0, 362.0, 157.0, 305.0, 375.0, 355.0, 376.0, 331.0, 367.0, 343.0, 385.0, 382.0, 354.0, 357.0, 179.0, 374.0, 322.0, 293.0, 329.0, 248.0, 265.0, 293.0, 280.0, 326.0, 214.0, 351.0, 271.0, 314.0, 347.0, 318.0, 328.0, 357.0, 233.0, 359.0, 334.0, 223.0, 244.0, 329.0, 295.0, 252.0, 397.0, 352.0, 239.0, 306.0, 352.0, 373.0, 351.0, 309.0, 374.0, 381.0, 284.0, 362.0, 359.0, 360.0, 179.0, 345.0, 304.0, 324.0, 322.0, 320.0, 371.0, 281.0, 376.0, 384.0, 349.0, 374.0, 356.0, 306.0, 239.0, 345.0, 310.0, 348.0, 362.0, 365.0, 369.0, 350.0, 339.0, 367.0, 389.0, 398.0, 379.0, 376.0, 332.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [149.0, 127.0, 177.0, 153.0, 131.0, 181.0, 168.0, 24.0, 163.0, 198.0, 71.0, 121.0, 129.0, 33.0, 181.0, 144.0, 189.0, 0.0, 178.0, 156.0, 143.0, 188.0, 0.0, 158.0, 153.0, 154.0, 193.0, 30.0, 44.0, 171.0, 73.0, 139.0, -24.0, 85.0, 0.0, -82.0, 175.0, 178.0, 155.0, 0.0, 130.0, 154.0, 186.0, 182.0, 149.0, 198.0, 194.0, 171.0, 196.0, 95.0, 191.0, 176.0, 170.0, 166.0, 195.0, 190.0, 197.0, 185.0, 198.0, 156.0, 159.0, 180.0, 0.0, 173.0, 196.0, 171.0, 127.0, 165.0, 125.0, 134.0, 174.0, 131.0, 45.0, 176.0, 96.0, 133.0, 135.0, 97.0, 120.0, 126.0, 200.0, 90.0, 83.0, 69.0, 188.0, 149.0, 73.0, 186.0, 164.0, 129.0, 160.0, 187.0, 164.0, 124.0, 183.0, 123.0, 163.0, 177.0, 92.0, 116.0, 153.0, 191.0, 146.0, 164.0, 64.0, 122.0, 17.0, 110.0, 106.0, 199.0, 85.0, 189.0, 188.0, 38.0, 198.0, 199.0, 141.0, 183.0, 137.0, 53.0, 169.0, 101.0, 178.0, 159.0, 194.0, 175.0, 164.0, 168.0, 131.0, 152.0, 188.0, 178.0, 176.0, 197.0, 124.0, 125.0, 174.0, 179.0, 143.0, 197.0, 164.0, 182.0, 36.0, 108.0, 153.0, 168.0, 194.0, 68.0, 193.0, 110.0, 133.0, 180.0, 145.0, 150.0, 190.0, 172.0, 115.0, 135.0, 195.0, 175.0, 176.0, 200.0, 170.0, 171.0, 188.0, 179.0, 149.0, 188.0, 78.0, 182.0, 82.0, 118.0, 163.0, 161.0, 109.0, 170.0, 160.0, 165.0, 172.0, 164.0, 160.0, 190.0, 163.0, 196.0, 173.0, 161.0, 161.0, 159.0, 170.0, 187.0, 188.0, 197.0, 200.0, 198.0, 189.0, 185.0, 197.0, 179.0, 170.0, 131.0], "policy_predator_policy_reward": [24.0, 0.0, 9.0, 10.0, 15.0, 17.0, 7.0, 17.0, 12.0, 0.0, 42.0, 0.0, 19.0, 52.0, 13.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 3.0, 13.0, 0.0, 5.0, 0.0, 40.0, 14.0, 29.0, 0.0, 9.0, 14.0, 24.0, 14.0, 89.0, 0.0, 2.0, 7.0, 2.0, 0.0, 13.0, 8.0, 3.0, 4.0, 0.0, 8.0, 2.0, 9.0, 26.0, 14.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 14.0, 6.0, 0.0, 3.0, 4.0, 18.0, 12.0, 23.0, 11.0, 13.0, 11.0, 27.0, 0.0, 19.0, 17.0, 25.0, 36.0, 17.0, 17.0, 3.0, 33.0, 13.0, 49.0, 14.0, 0.0, 4.0, 8.0, 16.0, 5.0, 0.0, 0.0, 6.0, 24.0, 22.0, 0.0, 1.0, 16.0, 22.0, 3.0, 8.0, 7.0, 10.0, 14.0, 13.0, 24.0, 51.0, 66.0, 12.0, 12.0, 3.0, 18.0, 11.0, 15.0, 0.0, 0.0, 15.0, 13.0, 20.0, 29.0, 6.0, 30.0, 2.0, 13.0, 0.0, 4.0, 7.0, 12.0, 17.0, 9.0, 3.0, 5.0, 1.0, 7.0, 12.0, 23.0, 7.0, 2.0, 0.0, 19.0, 14.0, 0.0, 17.0, 18.0, 8.0, 16.0, 37.0, 5.0, 10.0, 11.0, 2.0, 7.0, 0.0, 25.0, 9.0, 0.0, 5.0, 26.0, 0.0, 6.0, 0.0, 8.0, 5.0, 3.0, 7.0, 0.0, 12.0, 7.0, 23.0, 23.0, 30.0, 9.0, 12.0, 9.0, 17.0, 14.0, 11.0, 12.0, 12.0, 14.0, 9.0, 6.0, 10.0, 0.0, 3.0, 13.0, 0.0, 19.0, 10.0, 0.0, 4.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 20.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 26.573566300102645, "mean_inference_ms": 44.98415340585293, "mean_action_processing_ms": 6.908995999523654, "mean_env_wait_ms": 5.79445695057756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004894852638244629, "StateBufferConnector_ms": 0.004204988479614258, "ViewRequirementAgentConnector_ms": 0.13357436656951904}, "num_episodes": 23, "episode_return_max": 398.0, "episode_return_min": 7.0, "episode_return_mean": 313.86, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3056000, "num_agent_steps_trained": 3056000, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 282.5440798961116, "num_env_steps_trained_throughput_per_sec": 282.5440798961116, "timesteps_total": 764000, "num_env_steps_sampled_lifetime": 764000, "num_agent_steps_sampled_lifetime": 3056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3056000, "timers": {"training_iteration_time_ms": 14340.481, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14340.421, "sample_time_ms": 1893.368, "learn_time_ms": 12425.555, "learn_throughput": 321.917, "synch_weights_time_ms": 18.405}, "counters": {"num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 3056000, "num_agent_steps_trained": 3056000}, "done": false, "training_iteration": 191, "trial_id": "f6b99_00000", "date": "2024-08-13_23-22-55", "timestamp": 1723605775, "time_this_iter_s": 14.206096172332764, "time_total_s": 13071.316748857498, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6f05700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13071.316748857498, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 57.34000000000001, "ram_util_percent": 81.89500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.726318454931653, "cur_kl_coeff": 1.3893457917338664e-19, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1348290308442697, "policy_loss": -0.0009117369977363124, "vf_loss": 1.1357407653457905, "vf_explained_var": 0.2656591926617597, "kl": 0.0017326126276153836, "entropy": 0.04006596370058124, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 361935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.437381724642698, "cur_kl_coeff": 3.4144562177651485e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.358743797660505, "policy_loss": -0.009469811810536567, "vf_loss": 3.368213608277538, "vf_explained_var": -0.20345867689324434, "kl": 0.04176641724954899, "entropy": 0.880581408518332, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 361935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 3072000, "num_agent_steps_trained": 3072000}, "env_runners": {"episode_reward_max": 398.0, "episode_reward_min": 179.0, "episode_reward_mean": 333.05, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -5.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 66.0}, "policy_reward_mean": {"prey_policy": 156.14, "predator_policy": 10.385}, "custom_metrics": {}, "hist_stats": {"episode_reward": [355.0, 376.0, 331.0, 367.0, 343.0, 385.0, 382.0, 354.0, 357.0, 179.0, 374.0, 322.0, 293.0, 329.0, 248.0, 265.0, 293.0, 280.0, 326.0, 214.0, 351.0, 271.0, 314.0, 347.0, 318.0, 328.0, 357.0, 233.0, 359.0, 334.0, 223.0, 244.0, 329.0, 295.0, 252.0, 397.0, 352.0, 239.0, 306.0, 352.0, 373.0, 351.0, 309.0, 374.0, 381.0, 284.0, 362.0, 359.0, 360.0, 179.0, 345.0, 304.0, 324.0, 322.0, 320.0, 371.0, 281.0, 376.0, 384.0, 349.0, 374.0, 356.0, 306.0, 239.0, 345.0, 310.0, 348.0, 362.0, 365.0, 369.0, 350.0, 339.0, 367.0, 389.0, 398.0, 379.0, 376.0, 332.0, 296.0, 226.0, 388.0, 364.0, 353.0, 369.0, 368.0, 339.0, 390.0, 343.0, 386.0, 349.0, 339.0, 355.0, 383.0, 377.0, 371.0, 353.0, 318.0, 379.0, 329.0, 344.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [149.0, 198.0, 194.0, 171.0, 196.0, 95.0, 191.0, 176.0, 170.0, 166.0, 195.0, 190.0, 197.0, 185.0, 198.0, 156.0, 159.0, 180.0, 0.0, 173.0, 196.0, 171.0, 127.0, 165.0, 125.0, 134.0, 174.0, 131.0, 45.0, 176.0, 96.0, 133.0, 135.0, 97.0, 120.0, 126.0, 200.0, 90.0, 83.0, 69.0, 188.0, 149.0, 73.0, 186.0, 164.0, 129.0, 160.0, 187.0, 164.0, 124.0, 183.0, 123.0, 163.0, 177.0, 92.0, 116.0, 153.0, 191.0, 146.0, 164.0, 64.0, 122.0, 17.0, 110.0, 106.0, 199.0, 85.0, 189.0, 188.0, 38.0, 198.0, 199.0, 141.0, 183.0, 137.0, 53.0, 169.0, 101.0, 178.0, 159.0, 194.0, 175.0, 164.0, 168.0, 131.0, 152.0, 188.0, 178.0, 176.0, 197.0, 124.0, 125.0, 174.0, 179.0, 143.0, 197.0, 164.0, 182.0, 36.0, 108.0, 153.0, 168.0, 194.0, 68.0, 193.0, 110.0, 133.0, 180.0, 145.0, 150.0, 190.0, 172.0, 115.0, 135.0, 195.0, 175.0, 176.0, 200.0, 170.0, 171.0, 188.0, 179.0, 149.0, 188.0, 78.0, 182.0, 82.0, 118.0, 163.0, 161.0, 109.0, 170.0, 160.0, 165.0, 172.0, 164.0, 160.0, 190.0, 163.0, 196.0, 173.0, 161.0, 161.0, 159.0, 170.0, 187.0, 188.0, 197.0, 200.0, 198.0, 189.0, 185.0, 197.0, 179.0, 170.0, 131.0, 179.0, 67.0, 155.0, -5.0, 188.0, 200.0, 149.0, 198.0, 176.0, 169.0, 160.0, 200.0, 193.0, 167.0, 191.0, 137.0, 199.0, 191.0, 168.0, 141.0, 191.0, 195.0, 150.0, 161.0, 152.0, 170.0, 173.0, 146.0, 188.0, 195.0, 167.0, 200.0, 159.0, 199.0, 146.0, 183.0, 131.0, 161.0, 179.0, 194.0, 150.0, 161.0, 145.0, 179.0], "policy_predator_policy_reward": [0.0, 8.0, 2.0, 9.0, 26.0, 14.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 14.0, 6.0, 0.0, 3.0, 4.0, 18.0, 12.0, 23.0, 11.0, 13.0, 11.0, 27.0, 0.0, 19.0, 17.0, 25.0, 36.0, 17.0, 17.0, 3.0, 33.0, 13.0, 49.0, 14.0, 0.0, 4.0, 8.0, 16.0, 5.0, 0.0, 0.0, 6.0, 24.0, 22.0, 0.0, 1.0, 16.0, 22.0, 3.0, 8.0, 7.0, 10.0, 14.0, 13.0, 24.0, 51.0, 66.0, 12.0, 12.0, 3.0, 18.0, 11.0, 15.0, 0.0, 0.0, 15.0, 13.0, 20.0, 29.0, 6.0, 30.0, 2.0, 13.0, 0.0, 4.0, 7.0, 12.0, 17.0, 9.0, 3.0, 5.0, 1.0, 7.0, 12.0, 23.0, 7.0, 2.0, 0.0, 19.0, 14.0, 0.0, 17.0, 18.0, 8.0, 16.0, 37.0, 5.0, 10.0, 11.0, 2.0, 7.0, 0.0, 25.0, 9.0, 0.0, 5.0, 26.0, 0.0, 6.0, 0.0, 8.0, 5.0, 3.0, 7.0, 0.0, 12.0, 7.0, 23.0, 23.0, 30.0, 9.0, 12.0, 9.0, 17.0, 14.0, 11.0, 12.0, 12.0, 14.0, 9.0, 6.0, 10.0, 0.0, 3.0, 13.0, 0.0, 19.0, 10.0, 0.0, 4.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 20.0, 11.0, 0.0, 50.0, 62.0, 14.0, 0.0, 0.0, 16.0, 1.0, 0.0, 8.0, 9.0, 0.0, 8.0, 0.0, 0.0, 11.0, 0.0, 0.0, 12.0, 22.0, 0.0, 0.0, 17.0, 21.0, 0.0, 17.0, 18.0, 18.0, 0.0, 0.0, 1.0, 9.0, 11.0, 2.0, 18.0, 6.0, 16.0, 10.0, 0.0, 6.0, 18.0, 0.0, 15.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 25.89662982677589, "mean_inference_ms": 45.04422399487581, "mean_action_processing_ms": 6.560974587068942, "mean_env_wait_ms": 5.635622102264158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004667758941650391, "StateBufferConnector_ms": 0.004038095474243164, "ViewRequirementAgentConnector_ms": 0.1275942325592041}, "num_episodes": 22, "episode_return_max": 398.0, "episode_return_min": 179.0, "episode_return_mean": 333.05, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3072000, "num_agent_steps_trained": 3072000, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.27230157326335, "num_env_steps_trained_throughput_per_sec": 299.27230157326335, "timesteps_total": 768000, "num_env_steps_sampled_lifetime": 768000, "num_agent_steps_sampled_lifetime": 3072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3072000, "timers": {"training_iteration_time_ms": 14379.121, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14379.062, "sample_time_ms": 1887.115, "learn_time_ms": 12469.614, "learn_throughput": 320.78, "synch_weights_time_ms": 19.254}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 3072000, "num_agent_steps_trained": 3072000}, "done": false, "training_iteration": 192, "trial_id": "f6b99_00000", "date": "2024-08-13_23-23-09", "timestamp": 1723605789, "time_this_iter_s": 13.44669508934021, "time_total_s": 13084.763443946838, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6fd53a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13084.763443946838, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 52.194736842105264, "ram_util_percent": 80.45263157894739}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7684851588710906, "cur_kl_coeff": 6.946728958669332e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.262381597296901, "policy_loss": -0.0013253595925148123, "vf_loss": 5.263706971980907, "vf_explained_var": 0.07433149199637155, "kl": 0.001101970509871481, "entropy": 0.04138441378147238, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 363825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.412391668841952, "cur_kl_coeff": 5.121684326647724e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.429195079097042, "policy_loss": -0.013216237817206001, "vf_loss": 6.442411308187657, "vf_explained_var": 0.12601127930419154, "kl": 0.014362968033045572, "entropy": 0.8274320103504039, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 363825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 3088000, "num_agent_steps_trained": 3088000}, "env_runners": {"episode_reward_max": 398.0, "episode_reward_min": 65.0, "episode_reward_mean": 325.61, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -116.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 82.0}, "policy_reward_mean": {"prey_policy": 148.685, "predator_policy": 14.12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [326.0, 214.0, 351.0, 271.0, 314.0, 347.0, 318.0, 328.0, 357.0, 233.0, 359.0, 334.0, 223.0, 244.0, 329.0, 295.0, 252.0, 397.0, 352.0, 239.0, 306.0, 352.0, 373.0, 351.0, 309.0, 374.0, 381.0, 284.0, 362.0, 359.0, 360.0, 179.0, 345.0, 304.0, 324.0, 322.0, 320.0, 371.0, 281.0, 376.0, 384.0, 349.0, 374.0, 356.0, 306.0, 239.0, 345.0, 310.0, 348.0, 362.0, 365.0, 369.0, 350.0, 339.0, 367.0, 389.0, 398.0, 379.0, 376.0, 332.0, 296.0, 226.0, 388.0, 364.0, 353.0, 369.0, 368.0, 339.0, 390.0, 343.0, 386.0, 349.0, 339.0, 355.0, 383.0, 377.0, 371.0, 353.0, 318.0, 379.0, 329.0, 344.0, 329.0, 379.0, 367.0, 315.0, 344.0, 313.0, 159.0, 250.0, 276.0, 331.0, 315.0, 201.0, 357.0, 65.0, 356.0, 193.0, 246.0, 293.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 90.0, 83.0, 69.0, 188.0, 149.0, 73.0, 186.0, 164.0, 129.0, 160.0, 187.0, 164.0, 124.0, 183.0, 123.0, 163.0, 177.0, 92.0, 116.0, 153.0, 191.0, 146.0, 164.0, 64.0, 122.0, 17.0, 110.0, 106.0, 199.0, 85.0, 189.0, 188.0, 38.0, 198.0, 199.0, 141.0, 183.0, 137.0, 53.0, 169.0, 101.0, 178.0, 159.0, 194.0, 175.0, 164.0, 168.0, 131.0, 152.0, 188.0, 178.0, 176.0, 197.0, 124.0, 125.0, 174.0, 179.0, 143.0, 197.0, 164.0, 182.0, 36.0, 108.0, 153.0, 168.0, 194.0, 68.0, 193.0, 110.0, 133.0, 180.0, 145.0, 150.0, 190.0, 172.0, 115.0, 135.0, 195.0, 175.0, 176.0, 200.0, 170.0, 171.0, 188.0, 179.0, 149.0, 188.0, 78.0, 182.0, 82.0, 118.0, 163.0, 161.0, 109.0, 170.0, 160.0, 165.0, 172.0, 164.0, 160.0, 190.0, 163.0, 196.0, 173.0, 161.0, 161.0, 159.0, 170.0, 187.0, 188.0, 197.0, 200.0, 198.0, 189.0, 185.0, 197.0, 179.0, 170.0, 131.0, 179.0, 67.0, 155.0, -5.0, 188.0, 200.0, 149.0, 198.0, 176.0, 169.0, 160.0, 200.0, 193.0, 167.0, 191.0, 137.0, 199.0, 191.0, 168.0, 141.0, 191.0, 195.0, 150.0, 161.0, 152.0, 170.0, 173.0, 146.0, 188.0, 195.0, 167.0, 200.0, 159.0, 199.0, 146.0, 183.0, 131.0, 161.0, 179.0, 194.0, 150.0, 161.0, 145.0, 179.0, 86.0, 166.0, 199.0, 180.0, 128.0, 191.0, 150.0, 128.0, 84.0, 184.0, 169.0, 91.0, -23.0, 71.0, 66.0, 82.0, 128.0, 121.0, 73.0, 197.0, 175.0, 80.0, 100.0, 63.0, 128.0, 185.0, -116.0, 46.0, 143.0, 184.0, 120.0, 56.0, -2.0, 186.0, 85.0, 95.0], "policy_predator_policy_reward": [3.0, 33.0, 13.0, 49.0, 14.0, 0.0, 4.0, 8.0, 16.0, 5.0, 0.0, 0.0, 6.0, 24.0, 22.0, 0.0, 1.0, 16.0, 22.0, 3.0, 8.0, 7.0, 10.0, 14.0, 13.0, 24.0, 51.0, 66.0, 12.0, 12.0, 3.0, 18.0, 11.0, 15.0, 0.0, 0.0, 15.0, 13.0, 20.0, 29.0, 6.0, 30.0, 2.0, 13.0, 0.0, 4.0, 7.0, 12.0, 17.0, 9.0, 3.0, 5.0, 1.0, 7.0, 12.0, 23.0, 7.0, 2.0, 0.0, 19.0, 14.0, 0.0, 17.0, 18.0, 8.0, 16.0, 37.0, 5.0, 10.0, 11.0, 2.0, 7.0, 0.0, 25.0, 9.0, 0.0, 5.0, 26.0, 0.0, 6.0, 0.0, 8.0, 5.0, 3.0, 7.0, 0.0, 12.0, 7.0, 23.0, 23.0, 30.0, 9.0, 12.0, 9.0, 17.0, 14.0, 11.0, 12.0, 12.0, 14.0, 9.0, 6.0, 10.0, 0.0, 3.0, 13.0, 0.0, 19.0, 10.0, 0.0, 4.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 20.0, 11.0, 0.0, 50.0, 62.0, 14.0, 0.0, 0.0, 16.0, 1.0, 0.0, 8.0, 9.0, 0.0, 8.0, 0.0, 0.0, 11.0, 0.0, 0.0, 12.0, 22.0, 0.0, 0.0, 17.0, 21.0, 0.0, 17.0, 18.0, 18.0, 0.0, 0.0, 1.0, 9.0, 11.0, 2.0, 18.0, 6.0, 16.0, 10.0, 0.0, 6.0, 18.0, 0.0, 15.0, 5.0, 45.0, 32.0, 0.0, 0.0, 24.0, 24.0, 13.0, 24.0, 38.0, 38.0, 42.0, 11.0, 29.0, 82.0, 64.0, 38.0, 6.0, 21.0, 23.0, 38.0, 35.0, 25.0, 34.0, 4.0, 23.0, 21.0, 62.0, 73.0, 15.0, 14.0, 1.0, 16.0, 9.0, 53.0, 57.0, 56.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 25.776935939374788, "mean_inference_ms": 44.84095692877482, "mean_action_processing_ms": 6.531165420165935, "mean_env_wait_ms": 5.610017700116476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004674315452575684, "StateBufferConnector_ms": 0.006064414978027344, "ViewRequirementAgentConnector_ms": 0.12351000308990479}, "num_episodes": 18, "episode_return_max": 398.0, "episode_return_min": 65.0, "episode_return_mean": 325.61, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3088000, "num_agent_steps_trained": 3088000, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 247.2675642602941, "num_env_steps_trained_throughput_per_sec": 247.2675642602941, "timesteps_total": 772000, "num_env_steps_sampled_lifetime": 772000, "num_agent_steps_sampled_lifetime": 3088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3088000, "timers": {"training_iteration_time_ms": 14679.697, "restore_workers_time_ms": 0.017, "training_step_time_ms": 14679.636, "sample_time_ms": 2000.372, "learn_time_ms": 12653.668, "learn_throughput": 316.114, "synch_weights_time_ms": 22.207}, "counters": {"num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 3088000, "num_agent_steps_trained": 3088000}, "done": false, "training_iteration": 193, "trial_id": "f6b99_00000", "date": "2024-08-13_23-23-25", "timestamp": 1723605805, "time_this_iter_s": 16.238593101501465, "time_total_s": 13101.00203704834, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6fd5af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13101.00203704834, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 62.68695652173914, "ram_util_percent": 83.86521739130434}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.623268911841685, "cur_kl_coeff": 3.473364479334666e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.402172564640247, "policy_loss": -0.0031506349190961193, "vf_loss": 1.4053232029947653, "vf_explained_var": 0.1763036485386904, "kl": 0.0011801246023103102, "entropy": 0.036993794231650924, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 365715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.1387248061321396, "cur_kl_coeff": 5.121684326647724e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.729543495682812, "policy_loss": -0.009109543616977082, "vf_loss": 3.7386530331202916, "vf_explained_var": 0.3184845447540283, "kl": 0.013132276650880922, "entropy": 0.812006318443036, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 365715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 3104000, "num_agent_steps_trained": 3104000}, "env_runners": {"episode_reward_max": 398.0, "episode_reward_min": 65.0, "episode_reward_mean": 325.35, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -116.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 82.0}, "policy_reward_mean": {"prey_policy": 148.44, "predator_policy": 14.235}, "custom_metrics": {}, "hist_stats": {"episode_reward": [352.0, 239.0, 306.0, 352.0, 373.0, 351.0, 309.0, 374.0, 381.0, 284.0, 362.0, 359.0, 360.0, 179.0, 345.0, 304.0, 324.0, 322.0, 320.0, 371.0, 281.0, 376.0, 384.0, 349.0, 374.0, 356.0, 306.0, 239.0, 345.0, 310.0, 348.0, 362.0, 365.0, 369.0, 350.0, 339.0, 367.0, 389.0, 398.0, 379.0, 376.0, 332.0, 296.0, 226.0, 388.0, 364.0, 353.0, 369.0, 368.0, 339.0, 390.0, 343.0, 386.0, 349.0, 339.0, 355.0, 383.0, 377.0, 371.0, 353.0, 318.0, 379.0, 329.0, 344.0, 329.0, 379.0, 367.0, 315.0, 344.0, 313.0, 159.0, 250.0, 276.0, 331.0, 315.0, 201.0, 357.0, 65.0, 356.0, 193.0, 246.0, 293.0, 164.0, 315.0, 350.0, 392.0, 303.0, 307.0, 328.0, 388.0, 277.0, 292.0, 320.0, 297.0, 204.0, 345.0, 332.0, 316.0, 196.0, 340.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [141.0, 183.0, 137.0, 53.0, 169.0, 101.0, 178.0, 159.0, 194.0, 175.0, 164.0, 168.0, 131.0, 152.0, 188.0, 178.0, 176.0, 197.0, 124.0, 125.0, 174.0, 179.0, 143.0, 197.0, 164.0, 182.0, 36.0, 108.0, 153.0, 168.0, 194.0, 68.0, 193.0, 110.0, 133.0, 180.0, 145.0, 150.0, 190.0, 172.0, 115.0, 135.0, 195.0, 175.0, 176.0, 200.0, 170.0, 171.0, 188.0, 179.0, 149.0, 188.0, 78.0, 182.0, 82.0, 118.0, 163.0, 161.0, 109.0, 170.0, 160.0, 165.0, 172.0, 164.0, 160.0, 190.0, 163.0, 196.0, 173.0, 161.0, 161.0, 159.0, 170.0, 187.0, 188.0, 197.0, 200.0, 198.0, 189.0, 185.0, 197.0, 179.0, 170.0, 131.0, 179.0, 67.0, 155.0, -5.0, 188.0, 200.0, 149.0, 198.0, 176.0, 169.0, 160.0, 200.0, 193.0, 167.0, 191.0, 137.0, 199.0, 191.0, 168.0, 141.0, 191.0, 195.0, 150.0, 161.0, 152.0, 170.0, 173.0, 146.0, 188.0, 195.0, 167.0, 200.0, 159.0, 199.0, 146.0, 183.0, 131.0, 161.0, 179.0, 194.0, 150.0, 161.0, 145.0, 179.0, 86.0, 166.0, 199.0, 180.0, 128.0, 191.0, 150.0, 128.0, 84.0, 184.0, 169.0, 91.0, -23.0, 71.0, 66.0, 82.0, 128.0, 121.0, 73.0, 197.0, 175.0, 80.0, 100.0, 63.0, 128.0, 185.0, -116.0, 46.0, 143.0, 184.0, 120.0, 56.0, -2.0, 186.0, 85.0, 95.0, 13.0, 92.0, 164.0, 124.0, 173.0, 169.0, 197.0, 195.0, 119.0, 148.0, 113.0, 188.0, 101.0, 157.0, 192.0, 193.0, 148.0, 80.0, 140.0, 84.0, 121.0, 199.0, 113.0, 136.0, 105.0, 54.0, 140.0, 183.0, 131.0, 181.0, 185.0, 122.0, 35.0, 110.0, 174.0, 161.0], "policy_predator_policy_reward": [15.0, 13.0, 20.0, 29.0, 6.0, 30.0, 2.0, 13.0, 0.0, 4.0, 7.0, 12.0, 17.0, 9.0, 3.0, 5.0, 1.0, 7.0, 12.0, 23.0, 7.0, 2.0, 0.0, 19.0, 14.0, 0.0, 17.0, 18.0, 8.0, 16.0, 37.0, 5.0, 10.0, 11.0, 2.0, 7.0, 0.0, 25.0, 9.0, 0.0, 5.0, 26.0, 0.0, 6.0, 0.0, 8.0, 5.0, 3.0, 7.0, 0.0, 12.0, 7.0, 23.0, 23.0, 30.0, 9.0, 12.0, 9.0, 17.0, 14.0, 11.0, 12.0, 12.0, 14.0, 9.0, 6.0, 10.0, 0.0, 3.0, 13.0, 0.0, 19.0, 10.0, 0.0, 4.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 20.0, 11.0, 0.0, 50.0, 62.0, 14.0, 0.0, 0.0, 16.0, 1.0, 0.0, 8.0, 9.0, 0.0, 8.0, 0.0, 0.0, 11.0, 0.0, 0.0, 12.0, 22.0, 0.0, 0.0, 17.0, 21.0, 0.0, 17.0, 18.0, 18.0, 0.0, 0.0, 1.0, 9.0, 11.0, 2.0, 18.0, 6.0, 16.0, 10.0, 0.0, 6.0, 18.0, 0.0, 15.0, 5.0, 45.0, 32.0, 0.0, 0.0, 24.0, 24.0, 13.0, 24.0, 38.0, 38.0, 42.0, 11.0, 29.0, 82.0, 64.0, 38.0, 6.0, 21.0, 23.0, 38.0, 35.0, 25.0, 34.0, 4.0, 23.0, 21.0, 62.0, 73.0, 15.0, 14.0, 1.0, 16.0, 9.0, 53.0, 57.0, 56.0, 56.0, 3.0, 14.0, 13.0, 3.0, 5.0, 0.0, 0.0, 7.0, 29.0, 3.0, 3.0, 41.0, 29.0, 2.0, 1.0, 23.0, 26.0, 31.0, 37.0, 0.0, 0.0, 36.0, 12.0, 14.0, 31.0, 18.0, 4.0, 8.0, 12.0, 9.0, 0.0, 30.0, 21.0, 5.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 25.65872132940098, "mean_inference_ms": 44.64065166553448, "mean_action_processing_ms": 6.501795907184096, "mean_env_wait_ms": 5.584785252328007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005335688591003418, "StateBufferConnector_ms": 0.00642704963684082, "ViewRequirementAgentConnector_ms": 0.1455075740814209}, "num_episodes": 18, "episode_return_max": 398.0, "episode_return_min": 65.0, "episode_return_mean": 325.35, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3104000, "num_agent_steps_trained": 3104000, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 225.7449176898098, "num_env_steps_trained_throughput_per_sec": 225.7449176898098, "timesteps_total": 776000, "num_env_steps_sampled_lifetime": 776000, "num_agent_steps_sampled_lifetime": 3104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3104000, "timers": {"training_iteration_time_ms": 15121.161, "restore_workers_time_ms": 0.017, "training_step_time_ms": 15121.096, "sample_time_ms": 2087.383, "learn_time_ms": 13007.202, "learn_throughput": 307.522, "synch_weights_time_ms": 23.05}, "counters": {"num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 3104000, "num_agent_steps_trained": 3104000}, "done": false, "training_iteration": 194, "trial_id": "f6b99_00000", "date": "2024-08-13_23-23-43", "timestamp": 1723605823, "time_this_iter_s": 17.809309005737305, "time_total_s": 13118.811346054077, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b60f3ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13118.811346054077, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 64.288, "ram_util_percent": 82.94}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7359816028958277, "cur_kl_coeff": 1.736682239667333e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3252729439546191, "policy_loss": -0.0019131600440396045, "vf_loss": 1.327186108077014, "vf_explained_var": 0.15328696127291078, "kl": 0.0012880046710440484, "entropy": 0.04111379718693791, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 367605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.011597613556675, "cur_kl_coeff": 5.121684326647724e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.958760633418169, "policy_loss": -0.005064178722486806, "vf_loss": 2.9638248157248928, "vf_explained_var": 0.23459504423318087, "kl": 0.006164310201189874, "entropy": 0.8420204174581659, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 367605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000}, "env_runners": {"episode_reward_max": 398.0, "episode_reward_min": 65.0, "episode_reward_mean": 324.61, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -116.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 82.0}, "policy_reward_mean": {"prey_policy": 147.84, "predator_policy": 14.465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [320.0, 371.0, 281.0, 376.0, 384.0, 349.0, 374.0, 356.0, 306.0, 239.0, 345.0, 310.0, 348.0, 362.0, 365.0, 369.0, 350.0, 339.0, 367.0, 389.0, 398.0, 379.0, 376.0, 332.0, 296.0, 226.0, 388.0, 364.0, 353.0, 369.0, 368.0, 339.0, 390.0, 343.0, 386.0, 349.0, 339.0, 355.0, 383.0, 377.0, 371.0, 353.0, 318.0, 379.0, 329.0, 344.0, 329.0, 379.0, 367.0, 315.0, 344.0, 313.0, 159.0, 250.0, 276.0, 331.0, 315.0, 201.0, 357.0, 65.0, 356.0, 193.0, 246.0, 293.0, 164.0, 315.0, 350.0, 392.0, 303.0, 307.0, 328.0, 388.0, 277.0, 292.0, 320.0, 297.0, 204.0, 345.0, 332.0, 316.0, 196.0, 340.0, 319.0, 377.0, 375.0, 356.0, 357.0, 344.0, 322.0, 229.0, 351.0, 245.0, 382.0, 364.0, 271.0, 323.0, 322.0, 375.0, 133.0, 357.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [145.0, 150.0, 190.0, 172.0, 115.0, 135.0, 195.0, 175.0, 176.0, 200.0, 170.0, 171.0, 188.0, 179.0, 149.0, 188.0, 78.0, 182.0, 82.0, 118.0, 163.0, 161.0, 109.0, 170.0, 160.0, 165.0, 172.0, 164.0, 160.0, 190.0, 163.0, 196.0, 173.0, 161.0, 161.0, 159.0, 170.0, 187.0, 188.0, 197.0, 200.0, 198.0, 189.0, 185.0, 197.0, 179.0, 170.0, 131.0, 179.0, 67.0, 155.0, -5.0, 188.0, 200.0, 149.0, 198.0, 176.0, 169.0, 160.0, 200.0, 193.0, 167.0, 191.0, 137.0, 199.0, 191.0, 168.0, 141.0, 191.0, 195.0, 150.0, 161.0, 152.0, 170.0, 173.0, 146.0, 188.0, 195.0, 167.0, 200.0, 159.0, 199.0, 146.0, 183.0, 131.0, 161.0, 179.0, 194.0, 150.0, 161.0, 145.0, 179.0, 86.0, 166.0, 199.0, 180.0, 128.0, 191.0, 150.0, 128.0, 84.0, 184.0, 169.0, 91.0, -23.0, 71.0, 66.0, 82.0, 128.0, 121.0, 73.0, 197.0, 175.0, 80.0, 100.0, 63.0, 128.0, 185.0, -116.0, 46.0, 143.0, 184.0, 120.0, 56.0, -2.0, 186.0, 85.0, 95.0, 13.0, 92.0, 164.0, 124.0, 173.0, 169.0, 197.0, 195.0, 119.0, 148.0, 113.0, 188.0, 101.0, 157.0, 192.0, 193.0, 148.0, 80.0, 140.0, 84.0, 121.0, 199.0, 113.0, 136.0, 105.0, 54.0, 140.0, 183.0, 131.0, 181.0, 185.0, 122.0, 35.0, 110.0, 174.0, 161.0, 170.0, 128.0, 185.0, 183.0, 155.0, 194.0, 156.0, 194.0, 185.0, 156.0, 161.0, 149.0, 172.0, 124.0, 65.0, 82.0, 145.0, 191.0, 38.0, 143.0, 176.0, 190.0, 182.0, 166.0, 148.0, 84.0, 188.0, 130.0, 149.0, 152.0, 187.0, 170.0, 26.0, 85.0, 168.0, 178.0], "policy_predator_policy_reward": [0.0, 25.0, 9.0, 0.0, 5.0, 26.0, 0.0, 6.0, 0.0, 8.0, 5.0, 3.0, 7.0, 0.0, 12.0, 7.0, 23.0, 23.0, 30.0, 9.0, 12.0, 9.0, 17.0, 14.0, 11.0, 12.0, 12.0, 14.0, 9.0, 6.0, 10.0, 0.0, 3.0, 13.0, 0.0, 19.0, 10.0, 0.0, 4.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 20.0, 11.0, 0.0, 50.0, 62.0, 14.0, 0.0, 0.0, 16.0, 1.0, 0.0, 8.0, 9.0, 0.0, 8.0, 0.0, 0.0, 11.0, 0.0, 0.0, 12.0, 22.0, 0.0, 0.0, 17.0, 21.0, 0.0, 17.0, 18.0, 18.0, 0.0, 0.0, 1.0, 9.0, 11.0, 2.0, 18.0, 6.0, 16.0, 10.0, 0.0, 6.0, 18.0, 0.0, 15.0, 5.0, 45.0, 32.0, 0.0, 0.0, 24.0, 24.0, 13.0, 24.0, 38.0, 38.0, 42.0, 11.0, 29.0, 82.0, 64.0, 38.0, 6.0, 21.0, 23.0, 38.0, 35.0, 25.0, 34.0, 4.0, 23.0, 21.0, 62.0, 73.0, 15.0, 14.0, 1.0, 16.0, 9.0, 53.0, 57.0, 56.0, 56.0, 3.0, 14.0, 13.0, 3.0, 5.0, 0.0, 0.0, 7.0, 29.0, 3.0, 3.0, 41.0, 29.0, 2.0, 1.0, 23.0, 26.0, 31.0, 37.0, 0.0, 0.0, 36.0, 12.0, 14.0, 31.0, 18.0, 4.0, 8.0, 12.0, 9.0, 0.0, 30.0, 21.0, 5.0, 0.0, 11.0, 10.0, 0.0, 9.0, 13.0, 13.0, 6.0, 0.0, 7.0, 9.0, 17.0, 17.0, 14.0, 12.0, 29.0, 53.0, 15.0, 0.0, 26.0, 38.0, 8.0, 8.0, 15.0, 1.0, 17.0, 22.0, 1.0, 4.0, 20.0, 1.0, 10.0, 8.0, 22.0, 0.0, 7.0, 4.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 25.54174903103961, "mean_inference_ms": 44.44253468553366, "mean_action_processing_ms": 6.472727362496159, "mean_env_wait_ms": 5.559798636146347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005089402198791504, "StateBufferConnector_ms": 0.0063190460205078125, "ViewRequirementAgentConnector_ms": 0.14964866638183594}, "num_episodes": 18, "episode_return_max": 398.0, "episode_return_min": 65.0, "episode_return_mean": 324.61, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 326.9472040362035, "num_env_steps_trained_throughput_per_sec": 326.9472040362035, "timesteps_total": 780000, "num_env_steps_sampled_lifetime": 780000, "num_agent_steps_sampled_lifetime": 3120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3120000, "timers": {"training_iteration_time_ms": 14927.63, "restore_workers_time_ms": 0.017, "training_step_time_ms": 14927.564, "sample_time_ms": 2098.543, "learn_time_ms": 12802.637, "learn_throughput": 312.436, "synch_weights_time_ms": 23.667}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000}, "done": false, "training_iteration": 195, "trial_id": "f6b99_00000", "date": "2024-08-13_23-23-55", "timestamp": 1723605835, "time_this_iter_s": 12.299917936325073, "time_total_s": 13131.111263990402, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6fd5b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13131.111263990402, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 41.800000000000004, "ram_util_percent": 83.26470588235293}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.489784123310967, "cur_kl_coeff": 8.683411198336665e-21, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2350609830762975, "policy_loss": -0.0067280040915917464, "vf_loss": 1.2417889885801487, "vf_explained_var": 0.14113515060414714, "kl": 0.004009671297675046, "entropy": 0.06966825021854627, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 369495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.261818808853311, "cur_kl_coeff": 5.121684326647724e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3142137682627117, "policy_loss": -0.011077986954509345, "vf_loss": 3.3252917586180266, "vf_explained_var": -0.0207304007792599, "kl": 0.0851570786056855, "entropy": 0.9434660773744028, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 369495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 3136000, "num_agent_steps_trained": 3136000}, "env_runners": {"episode_reward_max": 392.0, "episode_reward_min": -360.0, "episode_reward_mean": 315.62, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -320.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 171.0}, "policy_reward_mean": {"prey_policy": 142.105, "predator_policy": 15.705}, "custom_metrics": {}, "hist_stats": {"episode_reward": [364.0, 353.0, 369.0, 368.0, 339.0, 390.0, 343.0, 386.0, 349.0, 339.0, 355.0, 383.0, 377.0, 371.0, 353.0, 318.0, 379.0, 329.0, 344.0, 329.0, 379.0, 367.0, 315.0, 344.0, 313.0, 159.0, 250.0, 276.0, 331.0, 315.0, 201.0, 357.0, 65.0, 356.0, 193.0, 246.0, 293.0, 164.0, 315.0, 350.0, 392.0, 303.0, 307.0, 328.0, 388.0, 277.0, 292.0, 320.0, 297.0, 204.0, 345.0, 332.0, 316.0, 196.0, 340.0, 319.0, 377.0, 375.0, 356.0, 357.0, 344.0, 322.0, 229.0, 351.0, 245.0, 382.0, 364.0, 271.0, 323.0, 322.0, 375.0, 133.0, 357.0, 296.0, 350.0, 387.0, 390.0, 372.0, -360.0, 361.0, 244.0, 385.0, 336.0, 379.0, 309.0, 359.0, 252.0, 369.0, 366.0, 326.0, 332.0, 362.0, 363.0, 298.0, 338.0, 352.0, 175.0, 370.0, 334.0, 351.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [149.0, 198.0, 176.0, 169.0, 160.0, 200.0, 193.0, 167.0, 191.0, 137.0, 199.0, 191.0, 168.0, 141.0, 191.0, 195.0, 150.0, 161.0, 152.0, 170.0, 173.0, 146.0, 188.0, 195.0, 167.0, 200.0, 159.0, 199.0, 146.0, 183.0, 131.0, 161.0, 179.0, 194.0, 150.0, 161.0, 145.0, 179.0, 86.0, 166.0, 199.0, 180.0, 128.0, 191.0, 150.0, 128.0, 84.0, 184.0, 169.0, 91.0, -23.0, 71.0, 66.0, 82.0, 128.0, 121.0, 73.0, 197.0, 175.0, 80.0, 100.0, 63.0, 128.0, 185.0, -116.0, 46.0, 143.0, 184.0, 120.0, 56.0, -2.0, 186.0, 85.0, 95.0, 13.0, 92.0, 164.0, 124.0, 173.0, 169.0, 197.0, 195.0, 119.0, 148.0, 113.0, 188.0, 101.0, 157.0, 192.0, 193.0, 148.0, 80.0, 140.0, 84.0, 121.0, 199.0, 113.0, 136.0, 105.0, 54.0, 140.0, 183.0, 131.0, 181.0, 185.0, 122.0, 35.0, 110.0, 174.0, 161.0, 170.0, 128.0, 185.0, 183.0, 155.0, 194.0, 156.0, 194.0, 185.0, 156.0, 161.0, 149.0, 172.0, 124.0, 65.0, 82.0, 145.0, 191.0, 38.0, 143.0, 176.0, 190.0, 182.0, 166.0, 148.0, 84.0, 188.0, 130.0, 149.0, 152.0, 187.0, 170.0, 26.0, 85.0, 168.0, 178.0, 150.0, 119.0, 140.0, 190.0, 199.0, 188.0, 200.0, 189.0, 177.0, 190.0, -320.0, -215.0, 156.0, 190.0, 149.0, 14.0, 187.0, 198.0, 157.0, 155.0, 181.0, 194.0, 140.0, 128.0, 155.0, 197.0, 168.0, 17.0, 177.0, 187.0, 189.0, 170.0, 99.0, 181.0, 158.0, 149.0, 193.0, 144.0, 197.0, 166.0, 77.0, 180.0, 190.0, 120.0, 140.0, 176.0, 9.0, 99.0, 164.0, 195.0, 165.0, 149.0, 165.0, 181.0], "policy_predator_policy_reward": [16.0, 1.0, 0.0, 8.0, 9.0, 0.0, 8.0, 0.0, 0.0, 11.0, 0.0, 0.0, 12.0, 22.0, 0.0, 0.0, 17.0, 21.0, 0.0, 17.0, 18.0, 18.0, 0.0, 0.0, 1.0, 9.0, 11.0, 2.0, 18.0, 6.0, 16.0, 10.0, 0.0, 6.0, 18.0, 0.0, 15.0, 5.0, 45.0, 32.0, 0.0, 0.0, 24.0, 24.0, 13.0, 24.0, 38.0, 38.0, 42.0, 11.0, 29.0, 82.0, 64.0, 38.0, 6.0, 21.0, 23.0, 38.0, 35.0, 25.0, 34.0, 4.0, 23.0, 21.0, 62.0, 73.0, 15.0, 14.0, 1.0, 16.0, 9.0, 53.0, 57.0, 56.0, 56.0, 3.0, 14.0, 13.0, 3.0, 5.0, 0.0, 0.0, 7.0, 29.0, 3.0, 3.0, 41.0, 29.0, 2.0, 1.0, 23.0, 26.0, 31.0, 37.0, 0.0, 0.0, 36.0, 12.0, 14.0, 31.0, 18.0, 4.0, 8.0, 12.0, 9.0, 0.0, 30.0, 21.0, 5.0, 0.0, 11.0, 10.0, 0.0, 9.0, 13.0, 13.0, 6.0, 0.0, 7.0, 9.0, 17.0, 17.0, 14.0, 12.0, 29.0, 53.0, 15.0, 0.0, 26.0, 38.0, 8.0, 8.0, 15.0, 1.0, 17.0, 22.0, 1.0, 4.0, 20.0, 1.0, 10.0, 8.0, 22.0, 0.0, 7.0, 4.0, 0.0, 27.0, 20.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 5.0, 4.0, 171.0, 13.0, 2.0, 62.0, 19.0, 0.0, 0.0, 13.0, 11.0, 0.0, 4.0, 28.0, 13.0, 0.0, 7.0, 16.0, 51.0, 5.0, 0.0, 0.0, 7.0, 24.0, 22.0, 3.0, 22.0, 12.0, 13.0, 0.0, 0.0, 41.0, 0.0, 14.0, 14.0, 21.0, 15.0, 58.0, 9.0, 4.0, 7.0, 4.0, 16.0, 0.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 25.64099449118558, "mean_inference_ms": 43.96468281190425, "mean_action_processing_ms": 6.437225498710514, "mean_env_wait_ms": 5.880777694783672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005471587181091309, "StateBufferConnector_ms": 0.0062133073806762695, "ViewRequirementAgentConnector_ms": 0.1766493320465088}, "num_episodes": 27, "episode_return_max": 392.0, "episode_return_min": -360.0, "episode_return_mean": 315.62, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3136000, "num_agent_steps_trained": 3136000, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.6427624346621, "num_env_steps_trained_throughput_per_sec": 312.6427624346621, "timesteps_total": 784000, "num_env_steps_sampled_lifetime": 784000, "num_agent_steps_sampled_lifetime": 3136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3136000, "timers": {"training_iteration_time_ms": 14683.709, "restore_workers_time_ms": 0.017, "training_step_time_ms": 14683.642, "sample_time_ms": 2116.607, "learn_time_ms": 12540.151, "learn_throughput": 318.975, "synch_weights_time_ms": 23.95}, "counters": {"num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 3136000, "num_agent_steps_trained": 3136000}, "done": false, "training_iteration": 196, "trial_id": "f6b99_00000", "date": "2024-08-13_23-24-08", "timestamp": 1723605848, "time_this_iter_s": 12.854387998580933, "time_total_s": 13143.965651988983, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b60f35e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13143.965651988983, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 46.92631578947369, "ram_util_percent": 83.91052631578947}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.834571500966158, "cur_kl_coeff": 4.3417055991683326e-21, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.767706190593659, "policy_loss": -0.00037090135750572677, "vf_loss": 4.7680770795812055, "vf_explained_var": 0.030861496042322228, "kl": 0.0013684520515931896, "entropy": 0.058033489103788735, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 371385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9697565352475204, "cur_kl_coeff": 7.682526489971588e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.168729185931896, "policy_loss": -0.008891656143078333, "vf_loss": 8.177620833512968, "vf_explained_var": 0.14514050439552026, "kl": 0.03172707457575479, "entropy": 0.8867467878041444, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 371385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 3152000, "num_agent_steps_trained": 3152000}, "env_runners": {"episode_reward_max": 392.0, "episode_reward_min": -360.0, "episode_reward_mean": 284.06, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -320.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 171.0}, "policy_reward_mean": {"prey_policy": 123.675, "predator_policy": 18.355}, "custom_metrics": {}, "hist_stats": {"episode_reward": [344.0, 329.0, 379.0, 367.0, 315.0, 344.0, 313.0, 159.0, 250.0, 276.0, 331.0, 315.0, 201.0, 357.0, 65.0, 356.0, 193.0, 246.0, 293.0, 164.0, 315.0, 350.0, 392.0, 303.0, 307.0, 328.0, 388.0, 277.0, 292.0, 320.0, 297.0, 204.0, 345.0, 332.0, 316.0, 196.0, 340.0, 319.0, 377.0, 375.0, 356.0, 357.0, 344.0, 322.0, 229.0, 351.0, 245.0, 382.0, 364.0, 271.0, 323.0, 322.0, 375.0, 133.0, 357.0, 296.0, 350.0, 387.0, 390.0, 372.0, -360.0, 361.0, 244.0, 385.0, 336.0, 379.0, 309.0, 359.0, 252.0, 369.0, 366.0, 326.0, 332.0, 362.0, 363.0, 298.0, 338.0, 352.0, 175.0, 370.0, 334.0, 351.0, 260.0, 7.0, 189.0, 65.0, 193.0, 237.0, 266.0, 193.0, 223.0, 102.0, 189.0, 173.0, 317.0, 72.0, 90.0, 331.0, 170.0, 232.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [145.0, 179.0, 86.0, 166.0, 199.0, 180.0, 128.0, 191.0, 150.0, 128.0, 84.0, 184.0, 169.0, 91.0, -23.0, 71.0, 66.0, 82.0, 128.0, 121.0, 73.0, 197.0, 175.0, 80.0, 100.0, 63.0, 128.0, 185.0, -116.0, 46.0, 143.0, 184.0, 120.0, 56.0, -2.0, 186.0, 85.0, 95.0, 13.0, 92.0, 164.0, 124.0, 173.0, 169.0, 197.0, 195.0, 119.0, 148.0, 113.0, 188.0, 101.0, 157.0, 192.0, 193.0, 148.0, 80.0, 140.0, 84.0, 121.0, 199.0, 113.0, 136.0, 105.0, 54.0, 140.0, 183.0, 131.0, 181.0, 185.0, 122.0, 35.0, 110.0, 174.0, 161.0, 170.0, 128.0, 185.0, 183.0, 155.0, 194.0, 156.0, 194.0, 185.0, 156.0, 161.0, 149.0, 172.0, 124.0, 65.0, 82.0, 145.0, 191.0, 38.0, 143.0, 176.0, 190.0, 182.0, 166.0, 148.0, 84.0, 188.0, 130.0, 149.0, 152.0, 187.0, 170.0, 26.0, 85.0, 168.0, 178.0, 150.0, 119.0, 140.0, 190.0, 199.0, 188.0, 200.0, 189.0, 177.0, 190.0, -320.0, -215.0, 156.0, 190.0, 149.0, 14.0, 187.0, 198.0, 157.0, 155.0, 181.0, 194.0, 140.0, 128.0, 155.0, 197.0, 168.0, 17.0, 177.0, 187.0, 189.0, 170.0, 99.0, 181.0, 158.0, 149.0, 193.0, 144.0, 197.0, 166.0, 77.0, 180.0, 190.0, 120.0, 140.0, 176.0, 9.0, 99.0, 164.0, 195.0, 165.0, 149.0, 165.0, 181.0, 48.0, 162.0, -44.0, -52.0, 94.0, 38.0, 22.0, -8.0, 42.0, 104.0, 37.0, 118.0, 94.0, 118.0, 53.0, 104.0, 67.0, 131.0, 32.0, 39.0, 112.0, 61.0, 81.0, -1.0, 184.0, 105.0, -23.0, 41.0, -49.0, 98.0, 140.0, 173.0, 49.0, 120.0, 103.0, 111.0], "policy_predator_policy_reward": [15.0, 5.0, 45.0, 32.0, 0.0, 0.0, 24.0, 24.0, 13.0, 24.0, 38.0, 38.0, 42.0, 11.0, 29.0, 82.0, 64.0, 38.0, 6.0, 21.0, 23.0, 38.0, 35.0, 25.0, 34.0, 4.0, 23.0, 21.0, 62.0, 73.0, 15.0, 14.0, 1.0, 16.0, 9.0, 53.0, 57.0, 56.0, 56.0, 3.0, 14.0, 13.0, 3.0, 5.0, 0.0, 0.0, 7.0, 29.0, 3.0, 3.0, 41.0, 29.0, 2.0, 1.0, 23.0, 26.0, 31.0, 37.0, 0.0, 0.0, 36.0, 12.0, 14.0, 31.0, 18.0, 4.0, 8.0, 12.0, 9.0, 0.0, 30.0, 21.0, 5.0, 0.0, 11.0, 10.0, 0.0, 9.0, 13.0, 13.0, 6.0, 0.0, 7.0, 9.0, 17.0, 17.0, 14.0, 12.0, 29.0, 53.0, 15.0, 0.0, 26.0, 38.0, 8.0, 8.0, 15.0, 1.0, 17.0, 22.0, 1.0, 4.0, 20.0, 1.0, 10.0, 8.0, 22.0, 0.0, 7.0, 4.0, 0.0, 27.0, 20.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 5.0, 4.0, 171.0, 13.0, 2.0, 62.0, 19.0, 0.0, 0.0, 13.0, 11.0, 0.0, 4.0, 28.0, 13.0, 0.0, 7.0, 16.0, 51.0, 5.0, 0.0, 0.0, 7.0, 24.0, 22.0, 3.0, 22.0, 12.0, 13.0, 0.0, 0.0, 41.0, 0.0, 14.0, 14.0, 21.0, 15.0, 58.0, 9.0, 4.0, 7.0, 4.0, 16.0, 0.0, 5.0, 25.0, 25.0, 62.0, 41.0, 34.0, 23.0, 26.0, 25.0, 14.0, 33.0, 57.0, 25.0, 28.0, 26.0, 13.0, 23.0, 10.0, 15.0, 17.0, 14.0, 0.0, 16.0, 51.0, 42.0, 14.0, 14.0, 11.0, 43.0, 39.0, 2.0, 9.0, 9.0, 0.0, 1.0, 0.0, 18.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 25.25892862504947, "mean_inference_ms": 43.96499204941567, "mean_action_processing_ms": 6.402121269466436, "mean_env_wait_ms": 5.500106642949235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005337238311767578, "StateBufferConnector_ms": 0.006117343902587891, "ViewRequirementAgentConnector_ms": 0.17646288871765137}, "num_episodes": 18, "episode_return_max": 392.0, "episode_return_min": -360.0, "episode_return_mean": 284.06, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3152000, "num_agent_steps_trained": 3152000, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 352.3692023914843, "num_env_steps_trained_throughput_per_sec": 352.3692023914843, "timesteps_total": 788000, "num_env_steps_sampled_lifetime": 788000, "num_agent_steps_sampled_lifetime": 3152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3152000, "timers": {"training_iteration_time_ms": 14149.579, "restore_workers_time_ms": 0.017, "training_step_time_ms": 14149.518, "sample_time_ms": 1977.087, "learn_time_ms": 12147.388, "learn_throughput": 329.289, "synch_weights_time_ms": 22.397}, "counters": {"num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 3152000, "num_agent_steps_trained": 3152000}, "done": false, "training_iteration": 197, "trial_id": "f6b99_00000", "date": "2024-08-13_23-24-19", "timestamp": 1723605859, "time_this_iter_s": 11.356439113616943, "time_total_s": 13155.3220911026, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6f4c0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13155.3220911026, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 31.587500000000002, "ram_util_percent": 83.73125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.53638848626109, "cur_kl_coeff": 2.1708527995841663e-21, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.247644068072082, "policy_loss": -0.001389807711907283, "vf_loss": 1.2490338730906683, "vf_explained_var": 0.24030609550299467, "kl": 0.0014170523878299967, "entropy": 0.04280313575817715, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 373275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.767719333480906, "cur_kl_coeff": 1.1523789734957376e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.661934150715984, "policy_loss": -0.009228857693006161, "vf_loss": 4.6711630122371455, "vf_explained_var": 0.1935694658567035, "kl": 0.006510773660249481, "entropy": 0.841328279145811, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 373275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 3168000, "num_agent_steps_trained": 3168000}, "env_runners": {"episode_reward_max": 392.0, "episode_reward_min": -360.0, "episode_reward_mean": 290.36, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -320.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 171.0}, "policy_reward_mean": {"prey_policy": 130.36, "predator_policy": 14.82}, "custom_metrics": {}, "hist_stats": {"episode_reward": [293.0, 164.0, 315.0, 350.0, 392.0, 303.0, 307.0, 328.0, 388.0, 277.0, 292.0, 320.0, 297.0, 204.0, 345.0, 332.0, 316.0, 196.0, 340.0, 319.0, 377.0, 375.0, 356.0, 357.0, 344.0, 322.0, 229.0, 351.0, 245.0, 382.0, 364.0, 271.0, 323.0, 322.0, 375.0, 133.0, 357.0, 296.0, 350.0, 387.0, 390.0, 372.0, -360.0, 361.0, 244.0, 385.0, 336.0, 379.0, 309.0, 359.0, 252.0, 369.0, 366.0, 326.0, 332.0, 362.0, 363.0, 298.0, 338.0, 352.0, 175.0, 370.0, 334.0, 351.0, 260.0, 7.0, 189.0, 65.0, 193.0, 237.0, 266.0, 193.0, 223.0, 102.0, 189.0, 173.0, 317.0, 72.0, 90.0, 331.0, 170.0, 232.0, 351.0, 366.0, 342.0, 359.0, 363.0, 314.0, 251.0, 284.0, 366.0, 283.0, 318.0, 355.0, 219.0, 298.0, 312.0, 339.0, 364.0, 286.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [85.0, 95.0, 13.0, 92.0, 164.0, 124.0, 173.0, 169.0, 197.0, 195.0, 119.0, 148.0, 113.0, 188.0, 101.0, 157.0, 192.0, 193.0, 148.0, 80.0, 140.0, 84.0, 121.0, 199.0, 113.0, 136.0, 105.0, 54.0, 140.0, 183.0, 131.0, 181.0, 185.0, 122.0, 35.0, 110.0, 174.0, 161.0, 170.0, 128.0, 185.0, 183.0, 155.0, 194.0, 156.0, 194.0, 185.0, 156.0, 161.0, 149.0, 172.0, 124.0, 65.0, 82.0, 145.0, 191.0, 38.0, 143.0, 176.0, 190.0, 182.0, 166.0, 148.0, 84.0, 188.0, 130.0, 149.0, 152.0, 187.0, 170.0, 26.0, 85.0, 168.0, 178.0, 150.0, 119.0, 140.0, 190.0, 199.0, 188.0, 200.0, 189.0, 177.0, 190.0, -320.0, -215.0, 156.0, 190.0, 149.0, 14.0, 187.0, 198.0, 157.0, 155.0, 181.0, 194.0, 140.0, 128.0, 155.0, 197.0, 168.0, 17.0, 177.0, 187.0, 189.0, 170.0, 99.0, 181.0, 158.0, 149.0, 193.0, 144.0, 197.0, 166.0, 77.0, 180.0, 190.0, 120.0, 140.0, 176.0, 9.0, 99.0, 164.0, 195.0, 165.0, 149.0, 165.0, 181.0, 48.0, 162.0, -44.0, -52.0, 94.0, 38.0, 22.0, -8.0, 42.0, 104.0, 37.0, 118.0, 94.0, 118.0, 53.0, 104.0, 67.0, 131.0, 32.0, 39.0, 112.0, 61.0, 81.0, -1.0, 184.0, 105.0, -23.0, 41.0, -49.0, 98.0, 140.0, 173.0, 49.0, 120.0, 103.0, 111.0, 175.0, 160.0, 176.0, 186.0, 155.0, 176.0, 171.0, 188.0, 161.0, 193.0, 170.0, 113.0, 122.0, 99.0, 153.0, 115.0, 175.0, 184.0, 66.0, 176.0, 168.0, 139.0, 152.0, 179.0, 76.0, 98.0, 113.0, 158.0, 147.0, 163.0, 132.0, 199.0, 168.0, 196.0, 108.0, 170.0], "policy_predator_policy_reward": [57.0, 56.0, 56.0, 3.0, 14.0, 13.0, 3.0, 5.0, 0.0, 0.0, 7.0, 29.0, 3.0, 3.0, 41.0, 29.0, 2.0, 1.0, 23.0, 26.0, 31.0, 37.0, 0.0, 0.0, 36.0, 12.0, 14.0, 31.0, 18.0, 4.0, 8.0, 12.0, 9.0, 0.0, 30.0, 21.0, 5.0, 0.0, 11.0, 10.0, 0.0, 9.0, 13.0, 13.0, 6.0, 0.0, 7.0, 9.0, 17.0, 17.0, 14.0, 12.0, 29.0, 53.0, 15.0, 0.0, 26.0, 38.0, 8.0, 8.0, 15.0, 1.0, 17.0, 22.0, 1.0, 4.0, 20.0, 1.0, 10.0, 8.0, 22.0, 0.0, 7.0, 4.0, 0.0, 27.0, 20.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 5.0, 4.0, 171.0, 13.0, 2.0, 62.0, 19.0, 0.0, 0.0, 13.0, 11.0, 0.0, 4.0, 28.0, 13.0, 0.0, 7.0, 16.0, 51.0, 5.0, 0.0, 0.0, 7.0, 24.0, 22.0, 3.0, 22.0, 12.0, 13.0, 0.0, 0.0, 41.0, 0.0, 14.0, 14.0, 21.0, 15.0, 58.0, 9.0, 4.0, 7.0, 4.0, 16.0, 0.0, 5.0, 25.0, 25.0, 62.0, 41.0, 34.0, 23.0, 26.0, 25.0, 14.0, 33.0, 57.0, 25.0, 28.0, 26.0, 13.0, 23.0, 10.0, 15.0, 17.0, 14.0, 0.0, 16.0, 51.0, 42.0, 14.0, 14.0, 11.0, 43.0, 39.0, 2.0, 9.0, 9.0, 0.0, 1.0, 0.0, 18.0, 9.0, 7.0, 3.0, 1.0, 8.0, 3.0, 0.0, 0.0, 9.0, 0.0, 10.0, 21.0, 6.0, 24.0, 0.0, 16.0, 4.0, 3.0, 23.0, 18.0, 11.0, 0.0, 8.0, 16.0, 20.0, 25.0, 15.0, 12.0, 2.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 25.145033015987245, "mean_inference_ms": 43.77150336701523, "mean_action_processing_ms": 6.373796921977159, "mean_env_wait_ms": 5.475688650957336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00530552864074707, "StateBufferConnector_ms": 0.0038024187088012695, "ViewRequirementAgentConnector_ms": 0.15793061256408691}, "num_episodes": 18, "episode_return_max": 392.0, "episode_return_min": -360.0, "episode_return_mean": 290.36, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3168000, "num_agent_steps_trained": 3168000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 356.53442881378226, "num_env_steps_trained_throughput_per_sec": 356.53442881378226, "timesteps_total": 792000, "num_env_steps_sampled_lifetime": 792000, "num_agent_steps_sampled_lifetime": 3168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3168000, "timers": {"training_iteration_time_ms": 13667.877, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13667.82, "sample_time_ms": 1773.454, "learn_time_ms": 11870.048, "learn_throughput": 336.983, "synch_weights_time_ms": 21.852}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 3168000, "num_agent_steps_trained": 3168000}, "done": false, "training_iteration": 198, "trial_id": "f6b99_00000", "date": "2024-08-13_23-24-31", "timestamp": 1723605871, "time_this_iter_s": 11.224066019058228, "time_total_s": 13166.546157121658, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6f1d820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13166.546157121658, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 34.21875, "ram_util_percent": 83.75625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.49293000884157, "cur_kl_coeff": 1.0854263997920831e-21, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7091241961906827, "policy_loss": -0.002869930804495222, "vf_loss": 0.7119941282524633, "vf_explained_var": 0.1850727172440322, "kl": 0.0014151749880525638, "entropy": 0.03592776221016215, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 375165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.524501341392123, "cur_kl_coeff": 1.1523789734957376e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5469778120202364, "policy_loss": -0.0044083638754845765, "vf_loss": 3.551386178864373, "vf_explained_var": 0.1639244815344533, "kl": 0.015484602376155794, "entropy": 0.8354135656798327, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 375165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 3184000, "num_agent_steps_trained": 3184000}, "env_runners": {"episode_reward_max": 390.0, "episode_reward_min": -360.0, "episode_reward_mean": 297.58, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -320.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 171.0}, "policy_reward_mean": {"prey_policy": 135.825, "predator_policy": 12.965}, "custom_metrics": {}, "hist_stats": {"episode_reward": [340.0, 319.0, 377.0, 375.0, 356.0, 357.0, 344.0, 322.0, 229.0, 351.0, 245.0, 382.0, 364.0, 271.0, 323.0, 322.0, 375.0, 133.0, 357.0, 296.0, 350.0, 387.0, 390.0, 372.0, -360.0, 361.0, 244.0, 385.0, 336.0, 379.0, 309.0, 359.0, 252.0, 369.0, 366.0, 326.0, 332.0, 362.0, 363.0, 298.0, 338.0, 352.0, 175.0, 370.0, 334.0, 351.0, 260.0, 7.0, 189.0, 65.0, 193.0, 237.0, 266.0, 193.0, 223.0, 102.0, 189.0, 173.0, 317.0, 72.0, 90.0, 331.0, 170.0, 232.0, 351.0, 366.0, 342.0, 359.0, 363.0, 314.0, 251.0, 284.0, 366.0, 283.0, 318.0, 355.0, 219.0, 298.0, 312.0, 339.0, 364.0, 286.0, 317.0, 351.0, 309.0, 390.0, 375.0, 360.0, 376.0, 286.0, 300.0, 327.0, 337.0, 375.0, 323.0, 379.0, 271.0, 369.0, 369.0, 327.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [174.0, 161.0, 170.0, 128.0, 185.0, 183.0, 155.0, 194.0, 156.0, 194.0, 185.0, 156.0, 161.0, 149.0, 172.0, 124.0, 65.0, 82.0, 145.0, 191.0, 38.0, 143.0, 176.0, 190.0, 182.0, 166.0, 148.0, 84.0, 188.0, 130.0, 149.0, 152.0, 187.0, 170.0, 26.0, 85.0, 168.0, 178.0, 150.0, 119.0, 140.0, 190.0, 199.0, 188.0, 200.0, 189.0, 177.0, 190.0, -320.0, -215.0, 156.0, 190.0, 149.0, 14.0, 187.0, 198.0, 157.0, 155.0, 181.0, 194.0, 140.0, 128.0, 155.0, 197.0, 168.0, 17.0, 177.0, 187.0, 189.0, 170.0, 99.0, 181.0, 158.0, 149.0, 193.0, 144.0, 197.0, 166.0, 77.0, 180.0, 190.0, 120.0, 140.0, 176.0, 9.0, 99.0, 164.0, 195.0, 165.0, 149.0, 165.0, 181.0, 48.0, 162.0, -44.0, -52.0, 94.0, 38.0, 22.0, -8.0, 42.0, 104.0, 37.0, 118.0, 94.0, 118.0, 53.0, 104.0, 67.0, 131.0, 32.0, 39.0, 112.0, 61.0, 81.0, -1.0, 184.0, 105.0, -23.0, 41.0, -49.0, 98.0, 140.0, 173.0, 49.0, 120.0, 103.0, 111.0, 175.0, 160.0, 176.0, 186.0, 155.0, 176.0, 171.0, 188.0, 161.0, 193.0, 170.0, 113.0, 122.0, 99.0, 153.0, 115.0, 175.0, 184.0, 66.0, 176.0, 168.0, 139.0, 152.0, 179.0, 76.0, 98.0, 113.0, 158.0, 147.0, 163.0, 132.0, 199.0, 168.0, 196.0, 108.0, 170.0, 124.0, 156.0, 171.0, 171.0, 108.0, 152.0, 196.0, 194.0, 191.0, 184.0, 170.0, 186.0, 186.0, 184.0, 101.0, 136.0, 145.0, 140.0, 148.0, 157.0, 138.0, 186.0, 196.0, 176.0, 114.0, 199.0, 187.0, 192.0, 108.0, 133.0, 178.0, 189.0, 194.0, 170.0, 142.0, 176.0], "policy_predator_policy_reward": [5.0, 0.0, 11.0, 10.0, 0.0, 9.0, 13.0, 13.0, 6.0, 0.0, 7.0, 9.0, 17.0, 17.0, 14.0, 12.0, 29.0, 53.0, 15.0, 0.0, 26.0, 38.0, 8.0, 8.0, 15.0, 1.0, 17.0, 22.0, 1.0, 4.0, 20.0, 1.0, 10.0, 8.0, 22.0, 0.0, 7.0, 4.0, 0.0, 27.0, 20.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 5.0, 4.0, 171.0, 13.0, 2.0, 62.0, 19.0, 0.0, 0.0, 13.0, 11.0, 0.0, 4.0, 28.0, 13.0, 0.0, 7.0, 16.0, 51.0, 5.0, 0.0, 0.0, 7.0, 24.0, 22.0, 3.0, 22.0, 12.0, 13.0, 0.0, 0.0, 41.0, 0.0, 14.0, 14.0, 21.0, 15.0, 58.0, 9.0, 4.0, 7.0, 4.0, 16.0, 0.0, 5.0, 25.0, 25.0, 62.0, 41.0, 34.0, 23.0, 26.0, 25.0, 14.0, 33.0, 57.0, 25.0, 28.0, 26.0, 13.0, 23.0, 10.0, 15.0, 17.0, 14.0, 0.0, 16.0, 51.0, 42.0, 14.0, 14.0, 11.0, 43.0, 39.0, 2.0, 9.0, 9.0, 0.0, 1.0, 0.0, 18.0, 9.0, 7.0, 3.0, 1.0, 8.0, 3.0, 0.0, 0.0, 9.0, 0.0, 10.0, 21.0, 6.0, 24.0, 0.0, 16.0, 4.0, 3.0, 23.0, 18.0, 11.0, 0.0, 8.0, 16.0, 20.0, 25.0, 15.0, 12.0, 2.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 8.0, 19.0, 18.0, 9.0, 0.0, 28.0, 21.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 3.0, 3.0, 26.0, 23.0, 2.0, 13.0, 15.0, 7.0, 0.0, 13.0, 0.0, 3.0, 6.0, 4.0, 0.0, 0.0, 23.0, 7.0, 2.0, 0.0, 0.0, 5.0, 3.0, 6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 25.031862755107532, "mean_inference_ms": 43.5785891106648, "mean_action_processing_ms": 6.345564534256642, "mean_env_wait_ms": 5.451357720647382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005004525184631348, "StateBufferConnector_ms": 0.003427743911743164, "ViewRequirementAgentConnector_ms": 0.1335240602493286}, "num_episodes": 18, "episode_return_max": 390.0, "episode_return_min": -360.0, "episode_return_mean": 297.58, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3184000, "num_agent_steps_trained": 3184000, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 360.43062752533973, "num_env_steps_trained_throughput_per_sec": 360.43062752533973, "timesteps_total": 796000, "num_env_steps_sampled_lifetime": 796000, "num_agent_steps_sampled_lifetime": 3184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3184000, "timers": {"training_iteration_time_ms": 13347.573, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13347.515, "sample_time_ms": 1735.256, "learn_time_ms": 11587.591, "learn_throughput": 345.197, "synch_weights_time_ms": 22.473}, "counters": {"num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 3184000, "num_agent_steps_trained": 3184000}, "done": false, "training_iteration": 199, "trial_id": "f6b99_00000", "date": "2024-08-13_23-24-42", "timestamp": 1723605882, "time_this_iter_s": 11.111801147460938, "time_total_s": 13177.65795826912, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6f3b0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13177.65795826912, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 30.124999999999996, "ram_util_percent": 83.575}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9023707083451054, "cur_kl_coeff": 5.427131998960416e-22, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6353372020617364, "policy_loss": -0.0013073154096861208, "vf_loss": 0.6366445158406225, "vf_explained_var": 0.24405011881596197, "kl": 0.0015103395548659259, "entropy": 0.053028342914742926, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 377055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.208507337961247, "cur_kl_coeff": 1.1523789734957376e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8956732639244624, "policy_loss": -0.006649915678500538, "vf_loss": 1.9023231859244998, "vf_explained_var": 0.350178813555884, "kl": 0.011592022407475889, "entropy": 0.8671987657824521, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 377055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000}, "env_runners": {"episode_reward_max": 390.0, "episode_reward_min": 7.0, "episode_reward_mean": 308.06, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -52.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 62.0}, "policy_reward_mean": {"prey_policy": 142.4, "predator_policy": 11.63}, "custom_metrics": {}, "hist_stats": {"episode_reward": [385.0, 336.0, 379.0, 309.0, 359.0, 252.0, 369.0, 366.0, 326.0, 332.0, 362.0, 363.0, 298.0, 338.0, 352.0, 175.0, 370.0, 334.0, 351.0, 260.0, 7.0, 189.0, 65.0, 193.0, 237.0, 266.0, 193.0, 223.0, 102.0, 189.0, 173.0, 317.0, 72.0, 90.0, 331.0, 170.0, 232.0, 351.0, 366.0, 342.0, 359.0, 363.0, 314.0, 251.0, 284.0, 366.0, 283.0, 318.0, 355.0, 219.0, 298.0, 312.0, 339.0, 364.0, 286.0, 317.0, 351.0, 309.0, 390.0, 375.0, 360.0, 376.0, 286.0, 300.0, 327.0, 337.0, 375.0, 323.0, 379.0, 271.0, 369.0, 369.0, 327.0, 306.0, 317.0, 363.0, 379.0, 321.0, 318.0, 312.0, 347.0, 335.0, 366.0, 329.0, 319.0, 307.0, 343.0, 368.0, 359.0, 374.0, 333.0, 339.0, 355.0, 354.0, 342.0, 343.0, 368.0, 340.0, 346.0, 347.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [187.0, 198.0, 157.0, 155.0, 181.0, 194.0, 140.0, 128.0, 155.0, 197.0, 168.0, 17.0, 177.0, 187.0, 189.0, 170.0, 99.0, 181.0, 158.0, 149.0, 193.0, 144.0, 197.0, 166.0, 77.0, 180.0, 190.0, 120.0, 140.0, 176.0, 9.0, 99.0, 164.0, 195.0, 165.0, 149.0, 165.0, 181.0, 48.0, 162.0, -44.0, -52.0, 94.0, 38.0, 22.0, -8.0, 42.0, 104.0, 37.0, 118.0, 94.0, 118.0, 53.0, 104.0, 67.0, 131.0, 32.0, 39.0, 112.0, 61.0, 81.0, -1.0, 184.0, 105.0, -23.0, 41.0, -49.0, 98.0, 140.0, 173.0, 49.0, 120.0, 103.0, 111.0, 175.0, 160.0, 176.0, 186.0, 155.0, 176.0, 171.0, 188.0, 161.0, 193.0, 170.0, 113.0, 122.0, 99.0, 153.0, 115.0, 175.0, 184.0, 66.0, 176.0, 168.0, 139.0, 152.0, 179.0, 76.0, 98.0, 113.0, 158.0, 147.0, 163.0, 132.0, 199.0, 168.0, 196.0, 108.0, 170.0, 124.0, 156.0, 171.0, 171.0, 108.0, 152.0, 196.0, 194.0, 191.0, 184.0, 170.0, 186.0, 186.0, 184.0, 101.0, 136.0, 145.0, 140.0, 148.0, 157.0, 138.0, 186.0, 196.0, 176.0, 114.0, 199.0, 187.0, 192.0, 108.0, 133.0, 178.0, 189.0, 194.0, 170.0, 142.0, 176.0, 137.0, 124.0, 134.0, 171.0, 176.0, 176.0, 189.0, 187.0, 157.0, 122.0, 152.0, 140.0, 138.0, 174.0, 163.0, 172.0, 157.0, 142.0, 188.0, 178.0, 183.0, 121.0, 130.0, 172.0, 131.0, 149.0, 175.0, 146.0, 176.0, 178.0, 167.0, 183.0, 175.0, 191.0, 151.0, 164.0, 182.0, 137.0, 170.0, 177.0, 186.0, 142.0, 108.0, 185.0, 166.0, 152.0, 179.0, 189.0, 142.0, 182.0, 155.0, 169.0, 140.0, 191.0], "policy_predator_policy_reward": [0.0, 0.0, 13.0, 11.0, 0.0, 4.0, 28.0, 13.0, 0.0, 7.0, 16.0, 51.0, 5.0, 0.0, 0.0, 7.0, 24.0, 22.0, 3.0, 22.0, 12.0, 13.0, 0.0, 0.0, 41.0, 0.0, 14.0, 14.0, 21.0, 15.0, 58.0, 9.0, 4.0, 7.0, 4.0, 16.0, 0.0, 5.0, 25.0, 25.0, 62.0, 41.0, 34.0, 23.0, 26.0, 25.0, 14.0, 33.0, 57.0, 25.0, 28.0, 26.0, 13.0, 23.0, 10.0, 15.0, 17.0, 14.0, 0.0, 16.0, 51.0, 42.0, 14.0, 14.0, 11.0, 43.0, 39.0, 2.0, 9.0, 9.0, 0.0, 1.0, 0.0, 18.0, 9.0, 7.0, 3.0, 1.0, 8.0, 3.0, 0.0, 0.0, 9.0, 0.0, 10.0, 21.0, 6.0, 24.0, 0.0, 16.0, 4.0, 3.0, 23.0, 18.0, 11.0, 0.0, 8.0, 16.0, 20.0, 25.0, 15.0, 12.0, 2.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 8.0, 19.0, 18.0, 9.0, 0.0, 28.0, 21.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 3.0, 3.0, 26.0, 23.0, 2.0, 13.0, 15.0, 7.0, 0.0, 13.0, 0.0, 3.0, 6.0, 4.0, 0.0, 0.0, 23.0, 7.0, 2.0, 0.0, 0.0, 5.0, 3.0, 6.0, 27.0, 18.0, 12.0, 0.0, 10.0, 1.0, 3.0, 0.0, 25.0, 17.0, 10.0, 16.0, 0.0, 0.0, 0.0, 12.0, 13.0, 23.0, 0.0, 0.0, 0.0, 25.0, 17.0, 0.0, 27.0, 0.0, 11.0, 11.0, 8.0, 6.0, 6.0, 3.0, 8.0, 0.0, 5.0, 13.0, 19.0, 1.0, 0.0, 8.0, 13.0, 13.0, 28.0, 21.0, 13.0, 12.0, 0.0, 0.0, 0.0, 16.0, 13.0, 9.0, 13.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 25.193840700778072, "mean_inference_ms": 43.071674527632375, "mean_action_processing_ms": 6.490449689443019, "mean_env_wait_ms": 5.511053563216083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004741549491882324, "StateBufferConnector_ms": 0.003281831741333008, "ViewRequirementAgentConnector_ms": 0.11848688125610352}, "num_episodes": 27, "episode_return_max": 390.0, "episode_return_min": 7.0, "episode_return_mean": 308.06, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 332.8172751544936, "num_env_steps_trained_throughput_per_sec": 332.8172751544936, "timesteps_total": 800000, "num_env_steps_sampled_lifetime": 800000, "num_agent_steps_sampled_lifetime": 3200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3200000, "timers": {"training_iteration_time_ms": 13213.472, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13213.413, "sample_time_ms": 1690.635, "learn_time_ms": 11497.842, "learn_throughput": 347.891, "synch_weights_time_ms": 22.635}, "counters": {"num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000}, "done": true, "training_iteration": 200, "trial_id": "f6b99_00000", "date": "2024-08-13_23-24-54", "timestamp": 1723605894, "time_this_iter_s": 12.076441049575806, "time_total_s": 13189.734399318695, "pid": 49759, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b6f14940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13189.734399318695, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 34.21176470588235, "ram_util_percent": 83.69999999999999}}
