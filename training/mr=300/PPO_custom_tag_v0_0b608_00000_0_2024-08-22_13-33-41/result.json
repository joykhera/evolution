{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0116003227770014, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.703972122152016, "policy_loss": -0.00929658362326562, "vf_loss": 6.712130030879268, "vf_explained_var": 0.017073374198227333, "kl": 0.005693447052023162, "entropy": 1.6049111243908998, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 473.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1094298199055688, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.6115924799883805, "policy_loss": -0.007747462937342269, "vf_loss": 7.618190899601689, "vf_explained_var": 0.02454980895632789, "kl": 0.005745201476815122, "entropy": 1.6061202486986836, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 473.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 146.68462694519326, "num_env_steps_trained_throughput_per_sec": 146.68462694519326, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 27269.407, "restore_workers_time_ms": 0.031, "training_step_time_ms": 27268.813, "sample_time_ms": 2993.359, "learn_time_ms": 24260.332, "learn_throughput": 164.878, "synch_weights_time_ms": 10.654}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "0b608_00000", "date": "2024-08-22_13-45-30", "timestamp": 1724314530, "time_this_iter_s": 27.33690595626831, "time_total_s": 27.33690595626831, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x311c62a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 27.33690595626831, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 46.4775, "ram_util_percent": 83.57249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0578085860247333, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.230285029184251, "policy_loss": -0.013638268827544476, "vf_loss": 4.242848629169363, "vf_explained_var": 0.07536858086863522, "kl": 0.005373369161256407, "entropy": 1.6010390078579937, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 1418.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.291050887738586, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.90793805147605, "policy_loss": -0.015275712742682093, "vf_loss": 5.9215572962685235, "vf_explained_var": 0.10463131855404566, "kl": 0.008282398764985224, "entropy": 1.5940251707399964, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 1418.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 157.88393939834242, "num_env_steps_trained_throughput_per_sec": 157.88393939834242, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 26302.246, "restore_workers_time_ms": 0.036, "training_step_time_ms": 26301.688, "sample_time_ms": 2706.658, "learn_time_ms": 23574.673, "learn_throughput": 169.674, "synch_weights_time_ms": 17.085}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "0b608_00000", "date": "2024-08-22_13-45-58", "timestamp": 1724314558, "time_this_iter_s": 25.38602638244629, "time_total_s": 52.7229323387146, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x311e62280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 52.7229323387146, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 41.65384615384615, "ram_util_percent": 83.17692307692307}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9944044701636783, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.450924269358317, "policy_loss": -0.014908253610942257, "vf_loss": 3.464452977407546, "vf_explained_var": 0.12120471379113576, "kl": 0.0068978053533654445, "entropy": 1.591881778378966, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2363.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4394916376108844, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.811195053625359, "policy_loss": -0.015138481320350101, "vf_loss": 5.8248471537595075, "vf_explained_var": 0.22482257740838188, "kl": 0.007431928088602723, "entropy": 1.5865092783377914, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2363.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 159.06967142945427, "num_env_steps_trained_throughput_per_sec": 159.06967142945427, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 25916.911, "restore_workers_time_ms": 0.036, "training_step_time_ms": 25916.509, "sample_time_ms": 2528.48, "learn_time_ms": 23370.093, "learn_throughput": 171.159, "synch_weights_time_ms": 15.013}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "0b608_00000", "date": "2024-08-22_13-46-23", "timestamp": 1724314583, "time_this_iter_s": 25.188811779022217, "time_total_s": 77.91174411773682, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x311fd7d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 77.91174411773682, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 36.80833333333333, "ram_util_percent": 83.3777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2789983248584487, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.974840331582165, "policy_loss": -0.015892658158446902, "vf_loss": 2.989562166178668, "vf_explained_var": 0.13474925491544937, "kl": 0.005854075882465593, "entropy": 1.5862477867691605, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 3308.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7550750805587363, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.257958022627251, "policy_loss": -0.013834776102550446, "vf_loss": 6.270163930660833, "vf_explained_var": 0.2116232991849304, "kl": 0.008144422305905551, "entropy": 1.5701410489107566, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 3308.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 161.21931547623137, "num_env_steps_trained_throughput_per_sec": 161.21931547623137, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 25640.418, "restore_workers_time_ms": 0.03, "training_step_time_ms": 25640.081, "sample_time_ms": 2351.098, "learn_time_ms": 23266.481, "learn_throughput": 171.921, "synch_weights_time_ms": 19.544}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "0b608_00000", "date": "2024-08-22_13-46-48", "timestamp": 1724314608, "time_this_iter_s": 24.843795776367188, "time_total_s": 102.755539894104, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a34a940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 102.755539894104, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 34.41428571428572, "ram_util_percent": 83.31714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.939713269503659, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.586844570926888, "policy_loss": -0.016765523724573315, "vf_loss": 2.602047621131574, "vf_explained_var": 0.1604043901282013, "kl": 0.007812387491674926, "entropy": 1.5776357542270074, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4253.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.133356297457659, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.195120834168934, "policy_loss": -0.014783297539762562, "vf_loss": 6.208241636790927, "vf_explained_var": 0.2657978324663071, "kl": 0.00831259686312584, "entropy": 1.5644092315088505, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4253.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 151.01505120102226, "num_env_steps_trained_throughput_per_sec": 151.01505120102226, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 25809.826, "restore_workers_time_ms": 0.031, "training_step_time_ms": 25809.507, "sample_time_ms": 2375.73, "learn_time_ms": 23410.357, "learn_throughput": 170.865, "synch_weights_time_ms": 20.161}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "0b608_00000", "date": "2024-08-22_13-47-14", "timestamp": 1724314634, "time_this_iter_s": 26.54120397567749, "time_total_s": 129.2967438697815, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a34ab80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 129.2967438697815, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 39.98918918918919, "ram_util_percent": 83.37837837837837}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0679117962796854, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.2559518353648915, "policy_loss": -0.01622525671984823, "vf_loss": 2.2703422195696956, "vf_explained_var": 0.15663204136348907, "kl": 0.009174331964520865, "entropy": 1.5714567830322912, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 5198.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.722313833993579, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.283991501318715, "policy_loss": -0.013893334495849789, "vf_loss": 6.296067985655769, "vf_explained_var": 0.3936768237875883, "kl": 0.00908431014583185, "entropy": 1.5523844609184871, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 5198.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 150.97338469871826, "num_env_steps_trained_throughput_per_sec": 150.97338469871826, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 25923.983, "restore_workers_time_ms": 0.032, "training_step_time_ms": 25923.697, "sample_time_ms": 2397.117, "learn_time_ms": 23503.195, "learn_throughput": 170.19, "synch_weights_time_ms": 20.228}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "0b608_00000", "date": "2024-08-22_13-47-41", "timestamp": 1724314661, "time_this_iter_s": 26.54742693901062, "time_total_s": 155.84417080879211, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3120640d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 155.84417080879211, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 35.0421052631579, "ram_util_percent": 83.26052631578948}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5485452706851657, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 1.9733968370175234, "policy_loss": -0.014645855638775088, "vf_loss": 1.9862162406482393, "vf_explained_var": 0.1565585557745878, "kl": 0.009132254451621698, "entropy": 1.5614038444700695, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6143.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.712565865087761, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.137456002311101, "policy_loss": -0.010160820414780308, "vf_loss": 6.145881937420557, "vf_explained_var": 0.388519534736714, "kl": 0.008674438061222197, "entropy": 1.5423044781205515, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6143.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.13448562953047, "num_env_steps_trained_throughput_per_sec": 156.13448562953047, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 25880.407, "restore_workers_time_ms": 0.03, "training_step_time_ms": 25880.146, "sample_time_ms": 2363.297, "learn_time_ms": 23490.643, "learn_throughput": 170.281, "synch_weights_time_ms": 23.173}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "0b608_00000", "date": "2024-08-22_13-48-07", "timestamp": 1724314687, "time_this_iter_s": 25.65434694290161, "time_total_s": 181.49851775169373, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a34a790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 181.49851775169373, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 32.05833333333334, "ram_util_percent": 83.32777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2344486984626326, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.1263954191611556, "policy_loss": -0.01656395636607336, "vf_loss": 2.1409186007484555, "vf_explained_var": 0.1903937122809193, "kl": 0.01020391393236067, "entropy": 1.5484621034097419, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 7088.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000004}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.141086394320089, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.6393269897138, "policy_loss": -0.010815843571687028, "vf_loss": 6.648308461305326, "vf_explained_var": 0.3371468423535584, "kl": 0.009171865928533769, "entropy": 1.5265256351894803, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 7088.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000004}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 738.329240031391, "episode_reward_min": 73.4000000000001, "episode_reward_mean": 391.0380486412609, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 5200, "policy_reward_min": {"prey_policy": -166.68659326450776, "predator_policy": 1.8687747186964283}, "policy_reward_max": {"prey_policy": 377.37367663830685, "predator_policy": 276.6059166870268}, "policy_reward_mean": {"prey_policy": 88.41796856276684, "predator_policy": 107.10105575786345}, "custom_metrics": {}, "hist_stats": {"episode_reward": [221.09999999999926, 497.00000000000006, 73.4000000000001, 284.7582326959704, 325.5042891697734, 738.329240031391, 512.8999999999994, 530.1000000000009, 332.10000000000065, 376.7777949135276, 471.8, 529.0989752030652, 190.6261003226634], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [25.179961431050064, -52.73083732672165, 199.28927044853597, 198.68074084525722, -64.77816481716049, 2.4228079593100027, -73.50780096732343, 9.10461543776101, 50.27322812519208, 20.51956847998826, 377.37367663830685, 270.96070779816455, 203.15010915884338, 171.11955693278554, 132.12957602616788, 353.7108027378266, 158.59106651609443, -27.383301949534562, 155.05314051780798, -166.68659326450776, 50.52893874627648, 248.5312252813035, 86.05406350662123, 175.08838714801752, -41.48447750786388, -162.3230852702604], "policy_predator_policy_reward": [160.9200385689499, 87.7308373267206, 70.11072955146373, 28.91925915474278, 99.87816481715856, 35.877192040690225, 276.6059166870268, 72.55550153850673, 144.98830749588325, 109.72318506870961, 79.70929542593183, 10.285560168987557, 116.04989084115665, 22.580443067214492, 17.970423973832364, 26.289197262173374, 133.20893348390527, 67.68330194953481, 211.97281818603352, 176.4384294741941, 170.87106125372281, 1.8687747186964283, 142.72044801844626, 125.23607652998031, 196.20030095715643, 198.23336214363107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.692413823774163, "mean_inference_ms": 4.458976650834872, "mean_action_processing_ms": 1.3679817696834484, "mean_env_wait_ms": 11.057103173518913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00341030267568735, "StateBufferConnector_ms": 0.0033800418560321513, "ViewRequirementAgentConnector_ms": 0.0741133323082557}, "num_episodes": 13, "episode_return_max": 738.329240031391, "episode_return_min": 73.4000000000001, "episode_return_mean": 391.0380486412609, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.2943237337789, "num_env_steps_trained_throughput_per_sec": 156.2943237337789, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 25844.452, "restore_workers_time_ms": 0.029, "training_step_time_ms": 25844.214, "sample_time_ms": 2325.857, "learn_time_ms": 23493.511, "learn_throughput": 170.26, "synch_weights_time_ms": 21.918}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "0b608_00000", "date": "2024-08-22_13-48-32", "timestamp": 1724314712, "time_this_iter_s": 25.640013217926025, "time_total_s": 207.13853096961975, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a34a820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 207.13853096961975, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 30.083333333333332, "ram_util_percent": 83.15555555555557}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.489569303472206, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.031609020535908, "policy_loss": -0.014248533785422013, "vf_loss": 3.044000818237426, "vf_explained_var": 0.20007210906851228, "kl": 0.009283651547043255, "entropy": 1.5166796140569858, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8033.0, "diff_num_grad_updates_vs_sampler_policy": 493.2624999999999}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.30778708495791, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.894277676072701, "policy_loss": -0.017767100036144255, "vf_loss": 6.90994576045445, "vf_explained_var": 0.39501028067220456, "kl": 0.010494978729852293, "entropy": 1.4813631095583477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8033.0, "diff_num_grad_updates_vs_sampler_policy": 493.2624999999999}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 738.329240031391, "episode_reward_min": 43.60000000000032, "episode_reward_mean": 350.6427027832168, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 28400, "policy_reward_min": {"prey_policy": -417.34633953376414, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 377.37367663830685, "predator_policy": 659.6496135550558}, "policy_reward_mean": {"prey_policy": 26.543874602002038, "predator_policy": 148.77747678960637}, "custom_metrics": {}, "hist_stats": {"episode_reward": [221.09999999999926, 497.00000000000006, 73.4000000000001, 284.7582326959704, 325.5042891697734, 738.329240031391, 512.8999999999994, 530.1000000000009, 332.10000000000065, 376.7777949135276, 471.8, 529.0989752030652, 190.6261003226634, 494.2032643744032, 373.1999999999996, 387.9999999999991, 286.38093427798594, 292.09999999999997, 305.5000000000002, 609.0726868068141, 73.50000000000006, 461.5782011886129, 486.23382458810545, 610.2452460123576, 596.1999999999998, 542.962942906764, 544.4999999999997, 618.7413271788275, 217.43434491765083, 493.79999999999967, 289.5241671931809, 386.29999999999944, 214.57147451833478, 429.9640189598841, 346.4471272410277, 75.9000000000003, 272.4999999999993, 358.5999999999993, 192.83109493386146, 140.8999999999994, 207.4910828827706, 376.05953594528074, 236.03577300949507, 157.24838054331317, 532.0374330300673, 229.23283012041298, 189.89999999999986, 401.5845138195314, 626.4089043362978, 223.69805484143765, 239.69999999999933, 432.5999999999999, 442.71841641681794, 264.3999999999992, 326.0853901481669, 260.6999999999993, 43.60000000000032, 263.97644196179465, 257.02735428746246, 390.0000000000017, 248.7675776105872, 342.8353663977673, 185.49999999999972, 198.36209225892, 293.59999999999854, 359.91665465807665, 476.518493304353, 600.0642111846487, 203.11760142861888, 501.30000000000007, 200.46050198837332], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [25.179961431050064, -52.73083732672165, 199.28927044853597, 198.68074084525722, -64.77816481716049, 2.4228079593100027, -73.50780096732343, 9.10461543776101, 50.27322812519208, 20.51956847998826, 377.37367663830685, 270.96070779816455, 203.15010915884338, 171.11955693278554, 132.12957602616788, 353.7108027378266, 158.59106651609443, -27.383301949534562, 155.05314051780798, -166.68659326450776, 50.52893874627648, 248.5312252813035, 86.05406350662123, 175.08838714801752, -41.48447750786388, -162.3230852702604, 196.57281088887353, -176.81536341296848, -3.809588946185329, 207.8664881573004, 216.06301800630877, -208.97501588109805, 8.815211613435467, -142.21633905943094, 39.11028250323231, 250.7456558968977, 125.27313369989814, -45.532250820607295, -112.53440839074963, 182.87736719187217, -17.37365639351769, -136.18747677886515, -55.24304377632064, 146.9556280348033, 70.53309589652605, 3.443227475027385, 134.2061619416707, 330.475757769977, 291.8827798584348, 228.6482719919805, 187.6705324761418, 80.21307441728842, 225.84254169332448, 17.721507513156492, 244.27128252829922, 208.54983013370523, -192.90097381318634, 127.11343765675988, 308.0825997762744, 91.39219983539496, -175.28572479978877, 48.212853390260186, -47.346170395009636, 52.027686485331415, 116.10000579603431, -175.01076898041669, -113.21719311477484, 339.1060136493959, -311.06764747898046, 227.73764431755043, -25.886051931266728, -16.907496359149512, 149.92987824568917, 19.42253767568771, 86.70493202415648, 62.49935992426168, 122.73772138329474, -194.92158798700038, -259.52185896057915, 72.83702880269009, -66.24332058904541, -67.63938427800676, -218.40284461438236, 152.54986396623707, -233.6556645397925, 36.31238076992583, 28.7600880185457, -99.1288092916671, 244.4898978061673, 86.4366776481917, -70.86925510641997, 22.18558305259655, -132.53263325612977, -159.1687204038769, 133.77158209771608, -29.034027782663166, 279.07872544301534, 283.39689796074856, -414.86723494756154, 64.42246347392515, -76.98497752657141, 113.74986777186014, 212.16816549740503, 122.07865353222704, -47.454202860017425, 36.90644965363365, -7.308861005624804, -117.31209917374298, 288.56796204694615, -359.04723103694135, -31.83342364950822, 171.40581413293995, -373.87294056941636, -258.4428815239774, 73.70917223836501, -89.30678930792492, 16.554959840842955, -127.29200203523706, -165.89344777341609, 333.6772055171264, -16.51035061465834, -164.2428751073002, 226.931792750413, -87.76722832226665, 13.369699988122015, -91.8479504413443, -417.34633953376414, -157.49499398292866, -6.605584133803764, 106.6744129349632, -74.27604252402237, -181.35145448400306, 324.37169254375004, 18.981387498444022, 296.70820026863333, 53.56239090359908, -53.726997529492934, -254.82913077572204, 146.67805668670184, -2.8123818445797895, -252.46950429550634, -320.45438970041494], "policy_predator_policy_reward": [160.9200385689499, 87.7308373267206, 70.11072955146373, 28.91925915474278, 99.87816481715856, 35.877192040690225, 276.6059166870268, 72.55550153850673, 144.98830749588325, 109.72318506870961, 79.70929542593183, 10.285560168987557, 116.04989084115665, 22.580443067214492, 17.970423973832364, 26.289197262173374, 133.20893348390527, 67.68330194953481, 211.97281818603352, 176.4384294741941, 170.87106125372281, 1.8687747186964283, 142.72044801844626, 125.23607652998031, 196.20030095715643, 198.23336214363107, 229.6401471201545, 244.80566977834334, 145.1568083753064, 23.986292413577583, 45.19120077357155, 335.7207971012192, 134.9445566989192, 284.83750502506285, 2.244061599870267, 0.0, 145.72686630010193, 80.03225082060668, 182.22031805934006, 356.5094099463506, 56.67365639351818, 170.3874767788632, 80.99257126352761, 288.873045666603, 67.66695664177102, 344.5905445747808, 105.0390840706866, 40.524242230022956, 17.092393138342675, 58.57655501124225, 130.9542744882901, 144.12506152504363, 88.02996855868986, 212.90598223482903, 156.31345039133933, 9.606764125483597, 241.48300817119954, 41.73887290287668, 0.9174002237255884, 93.40780016460502, 346.6946263673267, 69.9024122353832, 274.15567196264783, 107.46281194703037, 154.56849239157148, 118.91374531114543, 169.9021961366111, 34.173002288652576, 362.29746786434407, 67.47966253811671, 65.68605193126722, 53.00749635914986, 103.1475840786226, 0.0, 120.3687088178235, 89.02699923375845, 67.30623290547787, 197.70872863208837, 284.4218589605823, 43.16297119730989, 122.08423594069144, 219.289551809129, 46.57724865635593, 395.33526793706784, 395.2750709725056, 38.103985806855704, 133.82143214304045, 93.79566967339603, 89.38982546864247, 111.72103210706568, 250.62489859065894, 27.291603583578834, 177.8326332561299, 303.7687204038772, 141.4627144199544, 155.38424508452405, 0.0, 63.93328093253395, 412.6903582446017, 161.45246807047286, 114.04189982404732, 88.89320993066123, 87.7318345025949, 10.621346467772916, 382.5032255130105, 70.7629441101915, 44.10886100562505, 344.912099173743, 20.555697044115362, 376.0089620940519, 66.3334236495086, 54.794185867060214, 394.8729405694201, 281.0428815239801, 101.48425257245917, 178.08980645889423, 38.00268799309794, 329.7617084887599, 221.27351751739724, 0.9427247388904799, 186.9067458448498, 242.61405748769582, 71.12283198937229, 132.54796998024625, 133.0303000118772, 130.9479504413424, 517.2937729784959, 255.9096527971169, 185.89574473546608, 7.635426463371812, 274.22656260243616, 341.317589063666, 50.80599967959896, 82.35941358255586, 224.4303642415871, 25.36325577082924, 169.73466213773025, 341.93906759610604, 95.4219433132976, 262.01238184457975, 659.6496135550558, 113.7347824292391]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.7737818583745755, "mean_inference_ms": 4.461116528379907, "mean_action_processing_ms": 1.3734342163242397, "mean_env_wait_ms": 11.158942693350967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013305267817537549, "StateBufferConnector_ms": 0.00457343920855455, "ViewRequirementAgentConnector_ms": 0.11660263571940677}, "num_episodes": 58, "episode_return_max": 738.329240031391, "episode_return_min": 43.60000000000032, "episode_return_mean": 350.6427027832168, "episodes_this_iter": 58}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.1987048946103, "num_env_steps_trained_throughput_per_sec": 154.1987048946103, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 25855.131, "restore_workers_time_ms": 0.028, "training_step_time_ms": 25854.901, "sample_time_ms": 2342.202, "learn_time_ms": 23485.675, "learn_throughput": 170.317, "synch_weights_time_ms": 24.08}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 9, "trial_id": "0b608_00000", "date": "2024-08-22_13-48-58", "timestamp": 1724314738, "time_this_iter_s": 25.971317052841187, "time_total_s": 233.10984802246094, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31205b310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 233.10984802246094, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 33.554054054054056, "ram_util_percent": 83.2216216216216}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.649182193115275, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.753820563624145, "policy_loss": -0.021484299452492483, "vf_loss": 4.772473919580853, "vf_explained_var": 0.1855368975609068, "kl": 0.014154729497909704, "entropy": 1.4369551564019825, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8978.0, "diff_num_grad_updates_vs_sampler_policy": 492.7900000000009}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.745188688096546, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.134322185112686, "policy_loss": -0.016240569285397966, "vf_loss": 7.148423065205731, "vf_explained_var": 0.31843361431959444, "kl": 0.010698459027877086, "entropy": 1.4227147990433628, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8978.0, "diff_num_grad_updates_vs_sampler_policy": 492.7900000000009}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 738.329240031391, "episode_reward_min": 43.60000000000032, "episode_reward_mean": 344.26501163977815, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 36000, "policy_reward_min": {"prey_policy": -417.34633953376414, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 377.37367663830685, "predator_policy": 659.6496135550558}, "policy_reward_mean": {"prey_policy": 19.200157017062065, "predator_policy": 152.93234880282702}, "custom_metrics": {}, "hist_stats": {"episode_reward": [221.09999999999926, 497.00000000000006, 73.4000000000001, 284.7582326959704, 325.5042891697734, 738.329240031391, 512.8999999999994, 530.1000000000009, 332.10000000000065, 376.7777949135276, 471.8, 529.0989752030652, 190.6261003226634, 494.2032643744032, 373.1999999999996, 387.9999999999991, 286.38093427798594, 292.09999999999997, 305.5000000000002, 609.0726868068141, 73.50000000000006, 461.5782011886129, 486.23382458810545, 610.2452460123576, 596.1999999999998, 542.962942906764, 544.4999999999997, 618.7413271788275, 217.43434491765083, 493.79999999999967, 289.5241671931809, 386.29999999999944, 214.57147451833478, 429.9640189598841, 346.4471272410277, 75.9000000000003, 272.4999999999993, 358.5999999999993, 192.83109493386146, 140.8999999999994, 207.4910828827706, 376.05953594528074, 236.03577300949507, 157.24838054331317, 532.0374330300673, 229.23283012041298, 189.89999999999986, 401.5845138195314, 626.4089043362978, 223.69805484143765, 239.69999999999933, 432.5999999999999, 442.71841641681794, 264.3999999999992, 326.0853901481669, 260.6999999999993, 43.60000000000032, 263.97644196179465, 257.02735428746246, 390.0000000000017, 248.7675776105872, 342.8353663977673, 185.49999999999972, 198.36209225892, 293.59999999999854, 359.91665465807665, 476.518493304353, 600.0642111846487, 203.11760142861888, 501.30000000000007, 200.46050198837332, 127.70000000000009, 422.76952014563943, 516.3550508974929, 371.4243706745654, 371.2900178264415, 136.29999999999927, 419.28173159300263, 430.12000848703576, 174.0054940462068, 459.3873551495944, 391.8999999999993, 206.06104766849165, 416.70000000000266, 199.77446177916863, 409.8436420916603, 369.06837484577466, 161.24917122154213, 285.4999999999992, 219.488903545024], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [25.179961431050064, -52.73083732672165, 199.28927044853597, 198.68074084525722, -64.77816481716049, 2.4228079593100027, -73.50780096732343, 9.10461543776101, 50.27322812519208, 20.51956847998826, 377.37367663830685, 270.96070779816455, 203.15010915884338, 171.11955693278554, 132.12957602616788, 353.7108027378266, 158.59106651609443, -27.383301949534562, 155.05314051780798, -166.68659326450776, 50.52893874627648, 248.5312252813035, 86.05406350662123, 175.08838714801752, -41.48447750786388, -162.3230852702604, 196.57281088887353, -176.81536341296848, -3.809588946185329, 207.8664881573004, 216.06301800630877, -208.97501588109805, 8.815211613435467, -142.21633905943094, 39.11028250323231, 250.7456558968977, 125.27313369989814, -45.532250820607295, -112.53440839074963, 182.87736719187217, -17.37365639351769, -136.18747677886515, -55.24304377632064, 146.9556280348033, 70.53309589652605, 3.443227475027385, 134.2061619416707, 330.475757769977, 291.8827798584348, 228.6482719919805, 187.6705324761418, 80.21307441728842, 225.84254169332448, 17.721507513156492, 244.27128252829922, 208.54983013370523, -192.90097381318634, 127.11343765675988, 308.0825997762744, 91.39219983539496, -175.28572479978877, 48.212853390260186, -47.346170395009636, 52.027686485331415, 116.10000579603431, -175.01076898041669, -113.21719311477484, 339.1060136493959, -311.06764747898046, 227.73764431755043, -25.886051931266728, -16.907496359149512, 149.92987824568917, 19.42253767568771, 86.70493202415648, 62.49935992426168, 122.73772138329474, -194.92158798700038, -259.52185896057915, 72.83702880269009, -66.24332058904541, -67.63938427800676, -218.40284461438236, 152.54986396623707, -233.6556645397925, 36.31238076992583, 28.7600880185457, -99.1288092916671, 244.4898978061673, 86.4366776481917, -70.86925510641997, 22.18558305259655, -132.53263325612977, -159.1687204038769, 133.77158209771608, -29.034027782663166, 279.07872544301534, 283.39689796074856, -414.86723494756154, 64.42246347392515, -76.98497752657141, 113.74986777186014, 212.16816549740503, 122.07865353222704, -47.454202860017425, 36.90644965363365, -7.308861005624804, -117.31209917374298, 288.56796204694615, -359.04723103694135, -31.83342364950822, 171.40581413293995, -373.87294056941636, -258.4428815239774, 73.70917223836501, -89.30678930792492, 16.554959840842955, -127.29200203523706, -165.89344777341609, 333.6772055171264, -16.51035061465834, -164.2428751073002, 226.931792750413, -87.76722832226665, 13.369699988122015, -91.8479504413443, -417.34633953376414, -157.49499398292866, -6.605584133803764, 106.6744129349632, -74.27604252402237, -181.35145448400306, 324.37169254375004, 18.981387498444022, 296.70820026863333, 53.56239090359908, -53.726997529492934, -254.82913077572204, 146.67805668670184, -2.8123818445797895, -252.46950429550634, -320.45438970041494, -252.58036782908158, -92.53256051807763, -40.61396037256026, 334.8695201456403, 141.25143605270637, 150.92204674280708, -59.74211289931435, 58.051910885074825, 208.51544794266056, -111.29182005191548, -362.94354737230736, -354.05080309317015, -34.609243057541846, 28.18725560200353, 33.97147717954135, -96.29424365162792, -136.47615563318854, -127.55285567342952, -81.39414039512889, 20.71647967964509, 271.79798593827053, -5.396706046965797, 68.40116022399846, -90.5090478842511, 289.3861586594953, 68.17208970740376, -12.597544384837498, 73.72696675375026, 19.61652100816481, 60.184252500395075, -99.75554653185449, 86.41433754630884, -32.794562316643706, -72.5871166474991, 195.9757842942535, -149.73824072986423, -35.376249165734244, -174.52593702024285], "policy_predator_policy_reward": [160.9200385689499, 87.7308373267206, 70.11072955146373, 28.91925915474278, 99.87816481715856, 35.877192040690225, 276.6059166870268, 72.55550153850673, 144.98830749588325, 109.72318506870961, 79.70929542593183, 10.285560168987557, 116.04989084115665, 22.580443067214492, 17.970423973832364, 26.289197262173374, 133.20893348390527, 67.68330194953481, 211.97281818603352, 176.4384294741941, 170.87106125372281, 1.8687747186964283, 142.72044801844626, 125.23607652998031, 196.20030095715643, 198.23336214363107, 229.6401471201545, 244.80566977834334, 145.1568083753064, 23.986292413577583, 45.19120077357155, 335.7207971012192, 134.9445566989192, 284.83750502506285, 2.244061599870267, 0.0, 145.72686630010193, 80.03225082060668, 182.22031805934006, 356.5094099463506, 56.67365639351818, 170.3874767788632, 80.99257126352761, 288.873045666603, 67.66695664177102, 344.5905445747808, 105.0390840706866, 40.524242230022956, 17.092393138342675, 58.57655501124225, 130.9542744882901, 144.12506152504363, 88.02996855868986, 212.90598223482903, 156.31345039133933, 9.606764125483597, 241.48300817119954, 41.73887290287668, 0.9174002237255884, 93.40780016460502, 346.6946263673267, 69.9024122353832, 274.15567196264783, 107.46281194703037, 154.56849239157148, 118.91374531114543, 169.9021961366111, 34.173002288652576, 362.29746786434407, 67.47966253811671, 65.68605193126722, 53.00749635914986, 103.1475840786226, 0.0, 120.3687088178235, 89.02699923375845, 67.30623290547787, 197.70872863208837, 284.4218589605823, 43.16297119730989, 122.08423594069144, 219.289551809129, 46.57724865635593, 395.33526793706784, 395.2750709725056, 38.103985806855704, 133.82143214304045, 93.79566967339603, 89.38982546864247, 111.72103210706568, 250.62489859065894, 27.291603583578834, 177.8326332561299, 303.7687204038772, 141.4627144199544, 155.38424508452405, 0.0, 63.93328093253395, 412.6903582446017, 161.45246807047286, 114.04189982404732, 88.89320993066123, 87.7318345025949, 10.621346467772916, 382.5032255130105, 70.7629441101915, 44.10886100562505, 344.912099173743, 20.555697044115362, 376.0089620940519, 66.3334236495086, 54.794185867060214, 394.8729405694201, 281.0428815239801, 101.48425257245917, 178.08980645889423, 38.00268799309794, 329.7617084887599, 221.27351751739724, 0.9427247388904799, 186.9067458448498, 242.61405748769582, 71.12283198937229, 132.54796998024625, 133.0303000118772, 130.9479504413424, 517.2937729784959, 255.9096527971169, 185.89574473546608, 7.635426463371812, 274.22656260243616, 341.317589063666, 50.80599967959896, 82.35941358255586, 224.4303642415871, 25.36325577082924, 169.73466213773025, 341.93906759610604, 95.4219433132976, 262.01238184457975, 659.6496135550558, 113.7347824292391, 345.3803678290859, 127.43256051807568, 128.51396037256055, 0.0, 6.639606857863548, 217.5419612441162, 69.2354065397705, 303.8791661490334, 166.95628507004344, 107.1101048656525, 480.0099898407404, 373.28436062473963, 96.43368396291744, 329.27003508562257, 228.23861297832065, 264.20416198080125, 189.8397651453381, 248.19474020748527, 336.51120975352694, 183.553806111551, 32.90201406172944, 92.59670604696574, 173.34142415373003, 54.82751117501456, 11.41591511669615, 47.725836516404925, 121.53577457325493, 17.109264837000865, 250.42640790635983, 79.61646067674027, 195.34515822664744, 187.0644256046728, 24.797436631646207, 241.83341355403772, 50.72421570574651, 188.53824072986285, 146.5683409430558, 282.822748787946]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.782461347198495, "mean_inference_ms": 4.467382600768838, "mean_action_processing_ms": 1.3716631582048928, "mean_env_wait_ms": 11.178996614275839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01144303215874566, "StateBufferConnector_ms": 0.004525581995646159, "ViewRequirementAgentConnector_ms": 0.12538711229960123}, "num_episodes": 19, "episode_return_max": 738.329240031391, "episode_return_min": 43.60000000000032, "episode_return_mean": 344.26501163977815, "episodes_this_iter": 19}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.29015476611625, "num_env_steps_trained_throughput_per_sec": 155.29015476611625, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 25845.444, "restore_workers_time_ms": 0.028, "training_step_time_ms": 25845.179, "sample_time_ms": 2339.129, "learn_time_ms": 23478.635, "learn_throughput": 170.368, "synch_weights_time_ms": 24.325}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 10, "trial_id": "0b608_00000", "date": "2024-08-22_13-49-24", "timestamp": 1724314764, "time_this_iter_s": 25.832469701766968, "time_total_s": 258.9423177242279, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a34aaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 258.9423177242279, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 32.81621621621621, "ram_util_percent": 83.20540540540543}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.3176607084022, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.876476507338267, "policy_loss": -0.016059747364411438, "vf_loss": 4.889848852409887, "vf_explained_var": 0.19574016717375903, "kl": 0.013436947162287733, "entropy": 1.4221398333393076, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 9923.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.459674016130034, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.23681127003261, "policy_loss": -0.012312748373569871, "vf_loss": 7.247382061065189, "vf_explained_var": 0.29797219782279283, "kl": 0.008709768595656864, "entropy": 1.4143801308182813, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 9923.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 738.329240031391, "episode_reward_min": 43.60000000000032, "episode_reward_mean": 344.26501163977815, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 36000, "policy_reward_min": {"prey_policy": -417.34633953376414, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 377.37367663830685, "predator_policy": 659.6496135550558}, "policy_reward_mean": {"prey_policy": 19.200157017062065, "predator_policy": 152.93234880282702}, "custom_metrics": {}, "hist_stats": {"episode_reward": [221.09999999999926, 497.00000000000006, 73.4000000000001, 284.7582326959704, 325.5042891697734, 738.329240031391, 512.8999999999994, 530.1000000000009, 332.10000000000065, 376.7777949135276, 471.8, 529.0989752030652, 190.6261003226634, 494.2032643744032, 373.1999999999996, 387.9999999999991, 286.38093427798594, 292.09999999999997, 305.5000000000002, 609.0726868068141, 73.50000000000006, 461.5782011886129, 486.23382458810545, 610.2452460123576, 596.1999999999998, 542.962942906764, 544.4999999999997, 618.7413271788275, 217.43434491765083, 493.79999999999967, 289.5241671931809, 386.29999999999944, 214.57147451833478, 429.9640189598841, 346.4471272410277, 75.9000000000003, 272.4999999999993, 358.5999999999993, 192.83109493386146, 140.8999999999994, 207.4910828827706, 376.05953594528074, 236.03577300949507, 157.24838054331317, 532.0374330300673, 229.23283012041298, 189.89999999999986, 401.5845138195314, 626.4089043362978, 223.69805484143765, 239.69999999999933, 432.5999999999999, 442.71841641681794, 264.3999999999992, 326.0853901481669, 260.6999999999993, 43.60000000000032, 263.97644196179465, 257.02735428746246, 390.0000000000017, 248.7675776105872, 342.8353663977673, 185.49999999999972, 198.36209225892, 293.59999999999854, 359.91665465807665, 476.518493304353, 600.0642111846487, 203.11760142861888, 501.30000000000007, 200.46050198837332, 127.70000000000009, 422.76952014563943, 516.3550508974929, 371.4243706745654, 371.2900178264415, 136.29999999999927, 419.28173159300263, 430.12000848703576, 174.0054940462068, 459.3873551495944, 391.8999999999993, 206.06104766849165, 416.70000000000266, 199.77446177916863, 409.8436420916603, 369.06837484577466, 161.24917122154213, 285.4999999999992, 219.488903545024], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [25.179961431050064, -52.73083732672165, 199.28927044853597, 198.68074084525722, -64.77816481716049, 2.4228079593100027, -73.50780096732343, 9.10461543776101, 50.27322812519208, 20.51956847998826, 377.37367663830685, 270.96070779816455, 203.15010915884338, 171.11955693278554, 132.12957602616788, 353.7108027378266, 158.59106651609443, -27.383301949534562, 155.05314051780798, -166.68659326450776, 50.52893874627648, 248.5312252813035, 86.05406350662123, 175.08838714801752, -41.48447750786388, -162.3230852702604, 196.57281088887353, -176.81536341296848, -3.809588946185329, 207.8664881573004, 216.06301800630877, -208.97501588109805, 8.815211613435467, -142.21633905943094, 39.11028250323231, 250.7456558968977, 125.27313369989814, -45.532250820607295, -112.53440839074963, 182.87736719187217, -17.37365639351769, -136.18747677886515, -55.24304377632064, 146.9556280348033, 70.53309589652605, 3.443227475027385, 134.2061619416707, 330.475757769977, 291.8827798584348, 228.6482719919805, 187.6705324761418, 80.21307441728842, 225.84254169332448, 17.721507513156492, 244.27128252829922, 208.54983013370523, -192.90097381318634, 127.11343765675988, 308.0825997762744, 91.39219983539496, -175.28572479978877, 48.212853390260186, -47.346170395009636, 52.027686485331415, 116.10000579603431, -175.01076898041669, -113.21719311477484, 339.1060136493959, -311.06764747898046, 227.73764431755043, -25.886051931266728, -16.907496359149512, 149.92987824568917, 19.42253767568771, 86.70493202415648, 62.49935992426168, 122.73772138329474, -194.92158798700038, -259.52185896057915, 72.83702880269009, -66.24332058904541, -67.63938427800676, -218.40284461438236, 152.54986396623707, -233.6556645397925, 36.31238076992583, 28.7600880185457, -99.1288092916671, 244.4898978061673, 86.4366776481917, -70.86925510641997, 22.18558305259655, -132.53263325612977, -159.1687204038769, 133.77158209771608, -29.034027782663166, 279.07872544301534, 283.39689796074856, -414.86723494756154, 64.42246347392515, -76.98497752657141, 113.74986777186014, 212.16816549740503, 122.07865353222704, -47.454202860017425, 36.90644965363365, -7.308861005624804, -117.31209917374298, 288.56796204694615, -359.04723103694135, -31.83342364950822, 171.40581413293995, -373.87294056941636, -258.4428815239774, 73.70917223836501, -89.30678930792492, 16.554959840842955, -127.29200203523706, -165.89344777341609, 333.6772055171264, -16.51035061465834, -164.2428751073002, 226.931792750413, -87.76722832226665, 13.369699988122015, -91.8479504413443, -417.34633953376414, -157.49499398292866, -6.605584133803764, 106.6744129349632, -74.27604252402237, -181.35145448400306, 324.37169254375004, 18.981387498444022, 296.70820026863333, 53.56239090359908, -53.726997529492934, -254.82913077572204, 146.67805668670184, -2.8123818445797895, -252.46950429550634, -320.45438970041494, -252.58036782908158, -92.53256051807763, -40.61396037256026, 334.8695201456403, 141.25143605270637, 150.92204674280708, -59.74211289931435, 58.051910885074825, 208.51544794266056, -111.29182005191548, -362.94354737230736, -354.05080309317015, -34.609243057541846, 28.18725560200353, 33.97147717954135, -96.29424365162792, -136.47615563318854, -127.55285567342952, -81.39414039512889, 20.71647967964509, 271.79798593827053, -5.396706046965797, 68.40116022399846, -90.5090478842511, 289.3861586594953, 68.17208970740376, -12.597544384837498, 73.72696675375026, 19.61652100816481, 60.184252500395075, -99.75554653185449, 86.41433754630884, -32.794562316643706, -72.5871166474991, 195.9757842942535, -149.73824072986423, -35.376249165734244, -174.52593702024285], "policy_predator_policy_reward": [160.9200385689499, 87.7308373267206, 70.11072955146373, 28.91925915474278, 99.87816481715856, 35.877192040690225, 276.6059166870268, 72.55550153850673, 144.98830749588325, 109.72318506870961, 79.70929542593183, 10.285560168987557, 116.04989084115665, 22.580443067214492, 17.970423973832364, 26.289197262173374, 133.20893348390527, 67.68330194953481, 211.97281818603352, 176.4384294741941, 170.87106125372281, 1.8687747186964283, 142.72044801844626, 125.23607652998031, 196.20030095715643, 198.23336214363107, 229.6401471201545, 244.80566977834334, 145.1568083753064, 23.986292413577583, 45.19120077357155, 335.7207971012192, 134.9445566989192, 284.83750502506285, 2.244061599870267, 0.0, 145.72686630010193, 80.03225082060668, 182.22031805934006, 356.5094099463506, 56.67365639351818, 170.3874767788632, 80.99257126352761, 288.873045666603, 67.66695664177102, 344.5905445747808, 105.0390840706866, 40.524242230022956, 17.092393138342675, 58.57655501124225, 130.9542744882901, 144.12506152504363, 88.02996855868986, 212.90598223482903, 156.31345039133933, 9.606764125483597, 241.48300817119954, 41.73887290287668, 0.9174002237255884, 93.40780016460502, 346.6946263673267, 69.9024122353832, 274.15567196264783, 107.46281194703037, 154.56849239157148, 118.91374531114543, 169.9021961366111, 34.173002288652576, 362.29746786434407, 67.47966253811671, 65.68605193126722, 53.00749635914986, 103.1475840786226, 0.0, 120.3687088178235, 89.02699923375845, 67.30623290547787, 197.70872863208837, 284.4218589605823, 43.16297119730989, 122.08423594069144, 219.289551809129, 46.57724865635593, 395.33526793706784, 395.2750709725056, 38.103985806855704, 133.82143214304045, 93.79566967339603, 89.38982546864247, 111.72103210706568, 250.62489859065894, 27.291603583578834, 177.8326332561299, 303.7687204038772, 141.4627144199544, 155.38424508452405, 0.0, 63.93328093253395, 412.6903582446017, 161.45246807047286, 114.04189982404732, 88.89320993066123, 87.7318345025949, 10.621346467772916, 382.5032255130105, 70.7629441101915, 44.10886100562505, 344.912099173743, 20.555697044115362, 376.0089620940519, 66.3334236495086, 54.794185867060214, 394.8729405694201, 281.0428815239801, 101.48425257245917, 178.08980645889423, 38.00268799309794, 329.7617084887599, 221.27351751739724, 0.9427247388904799, 186.9067458448498, 242.61405748769582, 71.12283198937229, 132.54796998024625, 133.0303000118772, 130.9479504413424, 517.2937729784959, 255.9096527971169, 185.89574473546608, 7.635426463371812, 274.22656260243616, 341.317589063666, 50.80599967959896, 82.35941358255586, 224.4303642415871, 25.36325577082924, 169.73466213773025, 341.93906759610604, 95.4219433132976, 262.01238184457975, 659.6496135550558, 113.7347824292391, 345.3803678290859, 127.43256051807568, 128.51396037256055, 0.0, 6.639606857863548, 217.5419612441162, 69.2354065397705, 303.8791661490334, 166.95628507004344, 107.1101048656525, 480.0099898407404, 373.28436062473963, 96.43368396291744, 329.27003508562257, 228.23861297832065, 264.20416198080125, 189.8397651453381, 248.19474020748527, 336.51120975352694, 183.553806111551, 32.90201406172944, 92.59670604696574, 173.34142415373003, 54.82751117501456, 11.41591511669615, 47.725836516404925, 121.53577457325493, 17.109264837000865, 250.42640790635983, 79.61646067674027, 195.34515822664744, 187.0644256046728, 24.797436631646207, 241.83341355403772, 50.72421570574651, 188.53824072986285, 146.5683409430558, 282.822748787946]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.782461347198495, "mean_inference_ms": 4.467382600768838, "mean_action_processing_ms": 1.3716631582048928, "mean_env_wait_ms": 11.178996614275839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01144303215874566, "StateBufferConnector_ms": 0.004525581995646159, "ViewRequirementAgentConnector_ms": 0.12538711229960123}, "num_episodes": 0, "episode_return_max": 738.329240031391, "episode_return_min": 43.60000000000032, "episode_return_mean": 344.26501163977815, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 152.71302895161267, "num_env_steps_trained_throughput_per_sec": 152.71302895161267, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 25737.797, "restore_workers_time_ms": 0.028, "training_step_time_ms": 25737.585, "sample_time_ms": 2269.304, "learn_time_ms": 23440.435, "learn_throughput": 170.645, "synch_weights_time_ms": 24.942}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 11, "trial_id": "0b608_00000", "date": "2024-08-22_13-49-50", "timestamp": 1724314790, "time_this_iter_s": 26.25845980644226, "time_total_s": 285.20077753067017, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x312087310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 285.20077753067017, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 33.94864864864864, "ram_util_percent": 83.18918918918916}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.752056223248679, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.341831515579627, "policy_loss": -0.014138251354316712, "vf_loss": 4.353576697748174, "vf_explained_var": 0.22364956418042461, "kl": 0.011965342622900766, "entropy": 1.4079832844002538, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10868.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000004}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.941793569307478, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.310568299369207, "policy_loss": -0.011824868841185457, "vf_loss": 6.320906414052166, "vf_explained_var": 0.3342335067098103, "kl": 0.007433794223131839, "entropy": 1.4239177057982753, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10868.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000004}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 738.329240031391, "episode_reward_min": 43.60000000000032, "episode_reward_mean": 344.26501163977815, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 36000, "policy_reward_min": {"prey_policy": -417.34633953376414, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 377.37367663830685, "predator_policy": 659.6496135550558}, "policy_reward_mean": {"prey_policy": 19.200157017062065, "predator_policy": 152.93234880282702}, "custom_metrics": {}, "hist_stats": {"episode_reward": [221.09999999999926, 497.00000000000006, 73.4000000000001, 284.7582326959704, 325.5042891697734, 738.329240031391, 512.8999999999994, 530.1000000000009, 332.10000000000065, 376.7777949135276, 471.8, 529.0989752030652, 190.6261003226634, 494.2032643744032, 373.1999999999996, 387.9999999999991, 286.38093427798594, 292.09999999999997, 305.5000000000002, 609.0726868068141, 73.50000000000006, 461.5782011886129, 486.23382458810545, 610.2452460123576, 596.1999999999998, 542.962942906764, 544.4999999999997, 618.7413271788275, 217.43434491765083, 493.79999999999967, 289.5241671931809, 386.29999999999944, 214.57147451833478, 429.9640189598841, 346.4471272410277, 75.9000000000003, 272.4999999999993, 358.5999999999993, 192.83109493386146, 140.8999999999994, 207.4910828827706, 376.05953594528074, 236.03577300949507, 157.24838054331317, 532.0374330300673, 229.23283012041298, 189.89999999999986, 401.5845138195314, 626.4089043362978, 223.69805484143765, 239.69999999999933, 432.5999999999999, 442.71841641681794, 264.3999999999992, 326.0853901481669, 260.6999999999993, 43.60000000000032, 263.97644196179465, 257.02735428746246, 390.0000000000017, 248.7675776105872, 342.8353663977673, 185.49999999999972, 198.36209225892, 293.59999999999854, 359.91665465807665, 476.518493304353, 600.0642111846487, 203.11760142861888, 501.30000000000007, 200.46050198837332, 127.70000000000009, 422.76952014563943, 516.3550508974929, 371.4243706745654, 371.2900178264415, 136.29999999999927, 419.28173159300263, 430.12000848703576, 174.0054940462068, 459.3873551495944, 391.8999999999993, 206.06104766849165, 416.70000000000266, 199.77446177916863, 409.8436420916603, 369.06837484577466, 161.24917122154213, 285.4999999999992, 219.488903545024], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [25.179961431050064, -52.73083732672165, 199.28927044853597, 198.68074084525722, -64.77816481716049, 2.4228079593100027, -73.50780096732343, 9.10461543776101, 50.27322812519208, 20.51956847998826, 377.37367663830685, 270.96070779816455, 203.15010915884338, 171.11955693278554, 132.12957602616788, 353.7108027378266, 158.59106651609443, -27.383301949534562, 155.05314051780798, -166.68659326450776, 50.52893874627648, 248.5312252813035, 86.05406350662123, 175.08838714801752, -41.48447750786388, -162.3230852702604, 196.57281088887353, -176.81536341296848, -3.809588946185329, 207.8664881573004, 216.06301800630877, -208.97501588109805, 8.815211613435467, -142.21633905943094, 39.11028250323231, 250.7456558968977, 125.27313369989814, -45.532250820607295, -112.53440839074963, 182.87736719187217, -17.37365639351769, -136.18747677886515, -55.24304377632064, 146.9556280348033, 70.53309589652605, 3.443227475027385, 134.2061619416707, 330.475757769977, 291.8827798584348, 228.6482719919805, 187.6705324761418, 80.21307441728842, 225.84254169332448, 17.721507513156492, 244.27128252829922, 208.54983013370523, -192.90097381318634, 127.11343765675988, 308.0825997762744, 91.39219983539496, -175.28572479978877, 48.212853390260186, -47.346170395009636, 52.027686485331415, 116.10000579603431, -175.01076898041669, -113.21719311477484, 339.1060136493959, -311.06764747898046, 227.73764431755043, -25.886051931266728, -16.907496359149512, 149.92987824568917, 19.42253767568771, 86.70493202415648, 62.49935992426168, 122.73772138329474, -194.92158798700038, -259.52185896057915, 72.83702880269009, -66.24332058904541, -67.63938427800676, -218.40284461438236, 152.54986396623707, -233.6556645397925, 36.31238076992583, 28.7600880185457, -99.1288092916671, 244.4898978061673, 86.4366776481917, -70.86925510641997, 22.18558305259655, -132.53263325612977, -159.1687204038769, 133.77158209771608, -29.034027782663166, 279.07872544301534, 283.39689796074856, -414.86723494756154, 64.42246347392515, -76.98497752657141, 113.74986777186014, 212.16816549740503, 122.07865353222704, -47.454202860017425, 36.90644965363365, -7.308861005624804, -117.31209917374298, 288.56796204694615, -359.04723103694135, -31.83342364950822, 171.40581413293995, -373.87294056941636, -258.4428815239774, 73.70917223836501, -89.30678930792492, 16.554959840842955, -127.29200203523706, -165.89344777341609, 333.6772055171264, -16.51035061465834, -164.2428751073002, 226.931792750413, -87.76722832226665, 13.369699988122015, -91.8479504413443, -417.34633953376414, -157.49499398292866, -6.605584133803764, 106.6744129349632, -74.27604252402237, -181.35145448400306, 324.37169254375004, 18.981387498444022, 296.70820026863333, 53.56239090359908, -53.726997529492934, -254.82913077572204, 146.67805668670184, -2.8123818445797895, -252.46950429550634, -320.45438970041494, -252.58036782908158, -92.53256051807763, -40.61396037256026, 334.8695201456403, 141.25143605270637, 150.92204674280708, -59.74211289931435, 58.051910885074825, 208.51544794266056, -111.29182005191548, -362.94354737230736, -354.05080309317015, -34.609243057541846, 28.18725560200353, 33.97147717954135, -96.29424365162792, -136.47615563318854, -127.55285567342952, -81.39414039512889, 20.71647967964509, 271.79798593827053, -5.396706046965797, 68.40116022399846, -90.5090478842511, 289.3861586594953, 68.17208970740376, -12.597544384837498, 73.72696675375026, 19.61652100816481, 60.184252500395075, -99.75554653185449, 86.41433754630884, -32.794562316643706, -72.5871166474991, 195.9757842942535, -149.73824072986423, -35.376249165734244, -174.52593702024285], "policy_predator_policy_reward": [160.9200385689499, 87.7308373267206, 70.11072955146373, 28.91925915474278, 99.87816481715856, 35.877192040690225, 276.6059166870268, 72.55550153850673, 144.98830749588325, 109.72318506870961, 79.70929542593183, 10.285560168987557, 116.04989084115665, 22.580443067214492, 17.970423973832364, 26.289197262173374, 133.20893348390527, 67.68330194953481, 211.97281818603352, 176.4384294741941, 170.87106125372281, 1.8687747186964283, 142.72044801844626, 125.23607652998031, 196.20030095715643, 198.23336214363107, 229.6401471201545, 244.80566977834334, 145.1568083753064, 23.986292413577583, 45.19120077357155, 335.7207971012192, 134.9445566989192, 284.83750502506285, 2.244061599870267, 0.0, 145.72686630010193, 80.03225082060668, 182.22031805934006, 356.5094099463506, 56.67365639351818, 170.3874767788632, 80.99257126352761, 288.873045666603, 67.66695664177102, 344.5905445747808, 105.0390840706866, 40.524242230022956, 17.092393138342675, 58.57655501124225, 130.9542744882901, 144.12506152504363, 88.02996855868986, 212.90598223482903, 156.31345039133933, 9.606764125483597, 241.48300817119954, 41.73887290287668, 0.9174002237255884, 93.40780016460502, 346.6946263673267, 69.9024122353832, 274.15567196264783, 107.46281194703037, 154.56849239157148, 118.91374531114543, 169.9021961366111, 34.173002288652576, 362.29746786434407, 67.47966253811671, 65.68605193126722, 53.00749635914986, 103.1475840786226, 0.0, 120.3687088178235, 89.02699923375845, 67.30623290547787, 197.70872863208837, 284.4218589605823, 43.16297119730989, 122.08423594069144, 219.289551809129, 46.57724865635593, 395.33526793706784, 395.2750709725056, 38.103985806855704, 133.82143214304045, 93.79566967339603, 89.38982546864247, 111.72103210706568, 250.62489859065894, 27.291603583578834, 177.8326332561299, 303.7687204038772, 141.4627144199544, 155.38424508452405, 0.0, 63.93328093253395, 412.6903582446017, 161.45246807047286, 114.04189982404732, 88.89320993066123, 87.7318345025949, 10.621346467772916, 382.5032255130105, 70.7629441101915, 44.10886100562505, 344.912099173743, 20.555697044115362, 376.0089620940519, 66.3334236495086, 54.794185867060214, 394.8729405694201, 281.0428815239801, 101.48425257245917, 178.08980645889423, 38.00268799309794, 329.7617084887599, 221.27351751739724, 0.9427247388904799, 186.9067458448498, 242.61405748769582, 71.12283198937229, 132.54796998024625, 133.0303000118772, 130.9479504413424, 517.2937729784959, 255.9096527971169, 185.89574473546608, 7.635426463371812, 274.22656260243616, 341.317589063666, 50.80599967959896, 82.35941358255586, 224.4303642415871, 25.36325577082924, 169.73466213773025, 341.93906759610604, 95.4219433132976, 262.01238184457975, 659.6496135550558, 113.7347824292391, 345.3803678290859, 127.43256051807568, 128.51396037256055, 0.0, 6.639606857863548, 217.5419612441162, 69.2354065397705, 303.8791661490334, 166.95628507004344, 107.1101048656525, 480.0099898407404, 373.28436062473963, 96.43368396291744, 329.27003508562257, 228.23861297832065, 264.20416198080125, 189.8397651453381, 248.19474020748527, 336.51120975352694, 183.553806111551, 32.90201406172944, 92.59670604696574, 173.34142415373003, 54.82751117501456, 11.41591511669615, 47.725836516404925, 121.53577457325493, 17.109264837000865, 250.42640790635983, 79.61646067674027, 195.34515822664744, 187.0644256046728, 24.797436631646207, 241.83341355403772, 50.72421570574651, 188.53824072986285, 146.5683409430558, 282.822748787946]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.782461347198495, "mean_inference_ms": 4.467382600768838, "mean_action_processing_ms": 1.3716631582048928, "mean_env_wait_ms": 11.178996614275839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01144303215874566, "StateBufferConnector_ms": 0.004525581995646159, "ViewRequirementAgentConnector_ms": 0.12538711229960123}, "num_episodes": 0, "episode_return_max": 738.329240031391, "episode_return_min": 43.60000000000032, "episode_return_mean": 344.26501163977815, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.19642168299856, "num_env_steps_trained_throughput_per_sec": 155.19642168299856, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 25781.668, "restore_workers_time_ms": 0.025, "training_step_time_ms": 25781.498, "sample_time_ms": 2273.214, "learn_time_ms": 23480.067, "learn_throughput": 170.357, "synch_weights_time_ms": 25.217}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 12, "trial_id": "0b608_00000", "date": "2024-08-22_13-50-16", "timestamp": 1724314816, "time_this_iter_s": 25.805060148239136, "time_total_s": 311.0058376789093, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x312087790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 311.0058376789093, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 33.31111111111111, "ram_util_percent": 83.12500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.499475334434913, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.75223201847581, "policy_loss": -0.014934738211471725, "vf_loss": 3.764538885802819, "vf_explained_var": 0.23605843227376383, "kl": 0.013139436183073533, "entropy": 1.3841942003795078, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 11813.0, "diff_num_grad_updates_vs_sampler_policy": 493.02625000000074}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.009362582050302, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.941025516469643, "policy_loss": -0.011368083220132918, "vf_loss": 5.950881317683629, "vf_explained_var": 0.2931300909430892, "kl": 0.007561471732333303, "entropy": 1.4233769757407053, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 11813.0, "diff_num_grad_updates_vs_sampler_policy": 493.02625000000074}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 738.329240031391, "episode_reward_min": 43.60000000000032, "episode_reward_mean": 344.26501163977815, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 36000, "policy_reward_min": {"prey_policy": -417.34633953376414, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 377.37367663830685, "predator_policy": 659.6496135550558}, "policy_reward_mean": {"prey_policy": 19.200157017062065, "predator_policy": 152.93234880282702}, "custom_metrics": {}, "hist_stats": {"episode_reward": [221.09999999999926, 497.00000000000006, 73.4000000000001, 284.7582326959704, 325.5042891697734, 738.329240031391, 512.8999999999994, 530.1000000000009, 332.10000000000065, 376.7777949135276, 471.8, 529.0989752030652, 190.6261003226634, 494.2032643744032, 373.1999999999996, 387.9999999999991, 286.38093427798594, 292.09999999999997, 305.5000000000002, 609.0726868068141, 73.50000000000006, 461.5782011886129, 486.23382458810545, 610.2452460123576, 596.1999999999998, 542.962942906764, 544.4999999999997, 618.7413271788275, 217.43434491765083, 493.79999999999967, 289.5241671931809, 386.29999999999944, 214.57147451833478, 429.9640189598841, 346.4471272410277, 75.9000000000003, 272.4999999999993, 358.5999999999993, 192.83109493386146, 140.8999999999994, 207.4910828827706, 376.05953594528074, 236.03577300949507, 157.24838054331317, 532.0374330300673, 229.23283012041298, 189.89999999999986, 401.5845138195314, 626.4089043362978, 223.69805484143765, 239.69999999999933, 432.5999999999999, 442.71841641681794, 264.3999999999992, 326.0853901481669, 260.6999999999993, 43.60000000000032, 263.97644196179465, 257.02735428746246, 390.0000000000017, 248.7675776105872, 342.8353663977673, 185.49999999999972, 198.36209225892, 293.59999999999854, 359.91665465807665, 476.518493304353, 600.0642111846487, 203.11760142861888, 501.30000000000007, 200.46050198837332, 127.70000000000009, 422.76952014563943, 516.3550508974929, 371.4243706745654, 371.2900178264415, 136.29999999999927, 419.28173159300263, 430.12000848703576, 174.0054940462068, 459.3873551495944, 391.8999999999993, 206.06104766849165, 416.70000000000266, 199.77446177916863, 409.8436420916603, 369.06837484577466, 161.24917122154213, 285.4999999999992, 219.488903545024], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [25.179961431050064, -52.73083732672165, 199.28927044853597, 198.68074084525722, -64.77816481716049, 2.4228079593100027, -73.50780096732343, 9.10461543776101, 50.27322812519208, 20.51956847998826, 377.37367663830685, 270.96070779816455, 203.15010915884338, 171.11955693278554, 132.12957602616788, 353.7108027378266, 158.59106651609443, -27.383301949534562, 155.05314051780798, -166.68659326450776, 50.52893874627648, 248.5312252813035, 86.05406350662123, 175.08838714801752, -41.48447750786388, -162.3230852702604, 196.57281088887353, -176.81536341296848, -3.809588946185329, 207.8664881573004, 216.06301800630877, -208.97501588109805, 8.815211613435467, -142.21633905943094, 39.11028250323231, 250.7456558968977, 125.27313369989814, -45.532250820607295, -112.53440839074963, 182.87736719187217, -17.37365639351769, -136.18747677886515, -55.24304377632064, 146.9556280348033, 70.53309589652605, 3.443227475027385, 134.2061619416707, 330.475757769977, 291.8827798584348, 228.6482719919805, 187.6705324761418, 80.21307441728842, 225.84254169332448, 17.721507513156492, 244.27128252829922, 208.54983013370523, -192.90097381318634, 127.11343765675988, 308.0825997762744, 91.39219983539496, -175.28572479978877, 48.212853390260186, -47.346170395009636, 52.027686485331415, 116.10000579603431, -175.01076898041669, -113.21719311477484, 339.1060136493959, -311.06764747898046, 227.73764431755043, -25.886051931266728, -16.907496359149512, 149.92987824568917, 19.42253767568771, 86.70493202415648, 62.49935992426168, 122.73772138329474, -194.92158798700038, -259.52185896057915, 72.83702880269009, -66.24332058904541, -67.63938427800676, -218.40284461438236, 152.54986396623707, -233.6556645397925, 36.31238076992583, 28.7600880185457, -99.1288092916671, 244.4898978061673, 86.4366776481917, -70.86925510641997, 22.18558305259655, -132.53263325612977, -159.1687204038769, 133.77158209771608, -29.034027782663166, 279.07872544301534, 283.39689796074856, -414.86723494756154, 64.42246347392515, -76.98497752657141, 113.74986777186014, 212.16816549740503, 122.07865353222704, -47.454202860017425, 36.90644965363365, -7.308861005624804, -117.31209917374298, 288.56796204694615, -359.04723103694135, -31.83342364950822, 171.40581413293995, -373.87294056941636, -258.4428815239774, 73.70917223836501, -89.30678930792492, 16.554959840842955, -127.29200203523706, -165.89344777341609, 333.6772055171264, -16.51035061465834, -164.2428751073002, 226.931792750413, -87.76722832226665, 13.369699988122015, -91.8479504413443, -417.34633953376414, -157.49499398292866, -6.605584133803764, 106.6744129349632, -74.27604252402237, -181.35145448400306, 324.37169254375004, 18.981387498444022, 296.70820026863333, 53.56239090359908, -53.726997529492934, -254.82913077572204, 146.67805668670184, -2.8123818445797895, -252.46950429550634, -320.45438970041494, -252.58036782908158, -92.53256051807763, -40.61396037256026, 334.8695201456403, 141.25143605270637, 150.92204674280708, -59.74211289931435, 58.051910885074825, 208.51544794266056, -111.29182005191548, -362.94354737230736, -354.05080309317015, -34.609243057541846, 28.18725560200353, 33.97147717954135, -96.29424365162792, -136.47615563318854, -127.55285567342952, -81.39414039512889, 20.71647967964509, 271.79798593827053, -5.396706046965797, 68.40116022399846, -90.5090478842511, 289.3861586594953, 68.17208970740376, -12.597544384837498, 73.72696675375026, 19.61652100816481, 60.184252500395075, -99.75554653185449, 86.41433754630884, -32.794562316643706, -72.5871166474991, 195.9757842942535, -149.73824072986423, -35.376249165734244, -174.52593702024285], "policy_predator_policy_reward": [160.9200385689499, 87.7308373267206, 70.11072955146373, 28.91925915474278, 99.87816481715856, 35.877192040690225, 276.6059166870268, 72.55550153850673, 144.98830749588325, 109.72318506870961, 79.70929542593183, 10.285560168987557, 116.04989084115665, 22.580443067214492, 17.970423973832364, 26.289197262173374, 133.20893348390527, 67.68330194953481, 211.97281818603352, 176.4384294741941, 170.87106125372281, 1.8687747186964283, 142.72044801844626, 125.23607652998031, 196.20030095715643, 198.23336214363107, 229.6401471201545, 244.80566977834334, 145.1568083753064, 23.986292413577583, 45.19120077357155, 335.7207971012192, 134.9445566989192, 284.83750502506285, 2.244061599870267, 0.0, 145.72686630010193, 80.03225082060668, 182.22031805934006, 356.5094099463506, 56.67365639351818, 170.3874767788632, 80.99257126352761, 288.873045666603, 67.66695664177102, 344.5905445747808, 105.0390840706866, 40.524242230022956, 17.092393138342675, 58.57655501124225, 130.9542744882901, 144.12506152504363, 88.02996855868986, 212.90598223482903, 156.31345039133933, 9.606764125483597, 241.48300817119954, 41.73887290287668, 0.9174002237255884, 93.40780016460502, 346.6946263673267, 69.9024122353832, 274.15567196264783, 107.46281194703037, 154.56849239157148, 118.91374531114543, 169.9021961366111, 34.173002288652576, 362.29746786434407, 67.47966253811671, 65.68605193126722, 53.00749635914986, 103.1475840786226, 0.0, 120.3687088178235, 89.02699923375845, 67.30623290547787, 197.70872863208837, 284.4218589605823, 43.16297119730989, 122.08423594069144, 219.289551809129, 46.57724865635593, 395.33526793706784, 395.2750709725056, 38.103985806855704, 133.82143214304045, 93.79566967339603, 89.38982546864247, 111.72103210706568, 250.62489859065894, 27.291603583578834, 177.8326332561299, 303.7687204038772, 141.4627144199544, 155.38424508452405, 0.0, 63.93328093253395, 412.6903582446017, 161.45246807047286, 114.04189982404732, 88.89320993066123, 87.7318345025949, 10.621346467772916, 382.5032255130105, 70.7629441101915, 44.10886100562505, 344.912099173743, 20.555697044115362, 376.0089620940519, 66.3334236495086, 54.794185867060214, 394.8729405694201, 281.0428815239801, 101.48425257245917, 178.08980645889423, 38.00268799309794, 329.7617084887599, 221.27351751739724, 0.9427247388904799, 186.9067458448498, 242.61405748769582, 71.12283198937229, 132.54796998024625, 133.0303000118772, 130.9479504413424, 517.2937729784959, 255.9096527971169, 185.89574473546608, 7.635426463371812, 274.22656260243616, 341.317589063666, 50.80599967959896, 82.35941358255586, 224.4303642415871, 25.36325577082924, 169.73466213773025, 341.93906759610604, 95.4219433132976, 262.01238184457975, 659.6496135550558, 113.7347824292391, 345.3803678290859, 127.43256051807568, 128.51396037256055, 0.0, 6.639606857863548, 217.5419612441162, 69.2354065397705, 303.8791661490334, 166.95628507004344, 107.1101048656525, 480.0099898407404, 373.28436062473963, 96.43368396291744, 329.27003508562257, 228.23861297832065, 264.20416198080125, 189.8397651453381, 248.19474020748527, 336.51120975352694, 183.553806111551, 32.90201406172944, 92.59670604696574, 173.34142415373003, 54.82751117501456, 11.41591511669615, 47.725836516404925, 121.53577457325493, 17.109264837000865, 250.42640790635983, 79.61646067674027, 195.34515822664744, 187.0644256046728, 24.797436631646207, 241.83341355403772, 50.72421570574651, 188.53824072986285, 146.5683409430558, 282.822748787946]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.782461347198495, "mean_inference_ms": 4.467382600768838, "mean_action_processing_ms": 1.3716631582048928, "mean_env_wait_ms": 11.178996614275839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01144303215874566, "StateBufferConnector_ms": 0.004525581995646159, "ViewRequirementAgentConnector_ms": 0.12538711229960123}, "num_episodes": 0, "episode_return_max": 738.329240031391, "episode_return_min": 43.60000000000032, "episode_return_mean": 344.26501163977815, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.81237916886505, "num_env_steps_trained_throughput_per_sec": 154.81237916886505, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 25850.821, "restore_workers_time_ms": 0.025, "training_step_time_ms": 25850.647, "sample_time_ms": 2277.027, "learn_time_ms": 23545.069, "learn_throughput": 169.887, "synch_weights_time_ms": 25.547}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 13, "trial_id": "0b608_00000", "date": "2024-08-22_13-50-42", "timestamp": 1724314842, "time_this_iter_s": 25.88656520843506, "time_total_s": 336.89240288734436, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x312068e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 336.89240288734436, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 32.67027027027027, "ram_util_percent": 82.9108108108108}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.741886939447393, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.030051329779247, "policy_loss": -0.013951229042417947, "vf_loss": 4.041175657605368, "vf_explained_var": 0.23902497966453512, "kl": 0.014134571428297374, "entropy": 1.349022592186297, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12758.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000036}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.414118788734315, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.782107713992003, "policy_loss": -0.016235605654400336, "vf_loss": 5.796412038046216, "vf_explained_var": 0.21210350618160592, "kl": 0.009656390608362262, "entropy": 1.398763732052354, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12758.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000036}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 738.329240031391, "episode_reward_min": 43.60000000000032, "episode_reward_mean": 344.26501163977815, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 36000, "policy_reward_min": {"prey_policy": -417.34633953376414, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 377.37367663830685, "predator_policy": 659.6496135550558}, "policy_reward_mean": {"prey_policy": 19.200157017062065, "predator_policy": 152.93234880282702}, "custom_metrics": {}, "hist_stats": {"episode_reward": [221.09999999999926, 497.00000000000006, 73.4000000000001, 284.7582326959704, 325.5042891697734, 738.329240031391, 512.8999999999994, 530.1000000000009, 332.10000000000065, 376.7777949135276, 471.8, 529.0989752030652, 190.6261003226634, 494.2032643744032, 373.1999999999996, 387.9999999999991, 286.38093427798594, 292.09999999999997, 305.5000000000002, 609.0726868068141, 73.50000000000006, 461.5782011886129, 486.23382458810545, 610.2452460123576, 596.1999999999998, 542.962942906764, 544.4999999999997, 618.7413271788275, 217.43434491765083, 493.79999999999967, 289.5241671931809, 386.29999999999944, 214.57147451833478, 429.9640189598841, 346.4471272410277, 75.9000000000003, 272.4999999999993, 358.5999999999993, 192.83109493386146, 140.8999999999994, 207.4910828827706, 376.05953594528074, 236.03577300949507, 157.24838054331317, 532.0374330300673, 229.23283012041298, 189.89999999999986, 401.5845138195314, 626.4089043362978, 223.69805484143765, 239.69999999999933, 432.5999999999999, 442.71841641681794, 264.3999999999992, 326.0853901481669, 260.6999999999993, 43.60000000000032, 263.97644196179465, 257.02735428746246, 390.0000000000017, 248.7675776105872, 342.8353663977673, 185.49999999999972, 198.36209225892, 293.59999999999854, 359.91665465807665, 476.518493304353, 600.0642111846487, 203.11760142861888, 501.30000000000007, 200.46050198837332, 127.70000000000009, 422.76952014563943, 516.3550508974929, 371.4243706745654, 371.2900178264415, 136.29999999999927, 419.28173159300263, 430.12000848703576, 174.0054940462068, 459.3873551495944, 391.8999999999993, 206.06104766849165, 416.70000000000266, 199.77446177916863, 409.8436420916603, 369.06837484577466, 161.24917122154213, 285.4999999999992, 219.488903545024], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [25.179961431050064, -52.73083732672165, 199.28927044853597, 198.68074084525722, -64.77816481716049, 2.4228079593100027, -73.50780096732343, 9.10461543776101, 50.27322812519208, 20.51956847998826, 377.37367663830685, 270.96070779816455, 203.15010915884338, 171.11955693278554, 132.12957602616788, 353.7108027378266, 158.59106651609443, -27.383301949534562, 155.05314051780798, -166.68659326450776, 50.52893874627648, 248.5312252813035, 86.05406350662123, 175.08838714801752, -41.48447750786388, -162.3230852702604, 196.57281088887353, -176.81536341296848, -3.809588946185329, 207.8664881573004, 216.06301800630877, -208.97501588109805, 8.815211613435467, -142.21633905943094, 39.11028250323231, 250.7456558968977, 125.27313369989814, -45.532250820607295, -112.53440839074963, 182.87736719187217, -17.37365639351769, -136.18747677886515, -55.24304377632064, 146.9556280348033, 70.53309589652605, 3.443227475027385, 134.2061619416707, 330.475757769977, 291.8827798584348, 228.6482719919805, 187.6705324761418, 80.21307441728842, 225.84254169332448, 17.721507513156492, 244.27128252829922, 208.54983013370523, -192.90097381318634, 127.11343765675988, 308.0825997762744, 91.39219983539496, -175.28572479978877, 48.212853390260186, -47.346170395009636, 52.027686485331415, 116.10000579603431, -175.01076898041669, -113.21719311477484, 339.1060136493959, -311.06764747898046, 227.73764431755043, -25.886051931266728, -16.907496359149512, 149.92987824568917, 19.42253767568771, 86.70493202415648, 62.49935992426168, 122.73772138329474, -194.92158798700038, -259.52185896057915, 72.83702880269009, -66.24332058904541, -67.63938427800676, -218.40284461438236, 152.54986396623707, -233.6556645397925, 36.31238076992583, 28.7600880185457, -99.1288092916671, 244.4898978061673, 86.4366776481917, -70.86925510641997, 22.18558305259655, -132.53263325612977, -159.1687204038769, 133.77158209771608, -29.034027782663166, 279.07872544301534, 283.39689796074856, -414.86723494756154, 64.42246347392515, -76.98497752657141, 113.74986777186014, 212.16816549740503, 122.07865353222704, -47.454202860017425, 36.90644965363365, -7.308861005624804, -117.31209917374298, 288.56796204694615, -359.04723103694135, -31.83342364950822, 171.40581413293995, -373.87294056941636, -258.4428815239774, 73.70917223836501, -89.30678930792492, 16.554959840842955, -127.29200203523706, -165.89344777341609, 333.6772055171264, -16.51035061465834, -164.2428751073002, 226.931792750413, -87.76722832226665, 13.369699988122015, -91.8479504413443, -417.34633953376414, -157.49499398292866, -6.605584133803764, 106.6744129349632, -74.27604252402237, -181.35145448400306, 324.37169254375004, 18.981387498444022, 296.70820026863333, 53.56239090359908, -53.726997529492934, -254.82913077572204, 146.67805668670184, -2.8123818445797895, -252.46950429550634, -320.45438970041494, -252.58036782908158, -92.53256051807763, -40.61396037256026, 334.8695201456403, 141.25143605270637, 150.92204674280708, -59.74211289931435, 58.051910885074825, 208.51544794266056, -111.29182005191548, -362.94354737230736, -354.05080309317015, -34.609243057541846, 28.18725560200353, 33.97147717954135, -96.29424365162792, -136.47615563318854, -127.55285567342952, -81.39414039512889, 20.71647967964509, 271.79798593827053, -5.396706046965797, 68.40116022399846, -90.5090478842511, 289.3861586594953, 68.17208970740376, -12.597544384837498, 73.72696675375026, 19.61652100816481, 60.184252500395075, -99.75554653185449, 86.41433754630884, -32.794562316643706, -72.5871166474991, 195.9757842942535, -149.73824072986423, -35.376249165734244, -174.52593702024285], "policy_predator_policy_reward": [160.9200385689499, 87.7308373267206, 70.11072955146373, 28.91925915474278, 99.87816481715856, 35.877192040690225, 276.6059166870268, 72.55550153850673, 144.98830749588325, 109.72318506870961, 79.70929542593183, 10.285560168987557, 116.04989084115665, 22.580443067214492, 17.970423973832364, 26.289197262173374, 133.20893348390527, 67.68330194953481, 211.97281818603352, 176.4384294741941, 170.87106125372281, 1.8687747186964283, 142.72044801844626, 125.23607652998031, 196.20030095715643, 198.23336214363107, 229.6401471201545, 244.80566977834334, 145.1568083753064, 23.986292413577583, 45.19120077357155, 335.7207971012192, 134.9445566989192, 284.83750502506285, 2.244061599870267, 0.0, 145.72686630010193, 80.03225082060668, 182.22031805934006, 356.5094099463506, 56.67365639351818, 170.3874767788632, 80.99257126352761, 288.873045666603, 67.66695664177102, 344.5905445747808, 105.0390840706866, 40.524242230022956, 17.092393138342675, 58.57655501124225, 130.9542744882901, 144.12506152504363, 88.02996855868986, 212.90598223482903, 156.31345039133933, 9.606764125483597, 241.48300817119954, 41.73887290287668, 0.9174002237255884, 93.40780016460502, 346.6946263673267, 69.9024122353832, 274.15567196264783, 107.46281194703037, 154.56849239157148, 118.91374531114543, 169.9021961366111, 34.173002288652576, 362.29746786434407, 67.47966253811671, 65.68605193126722, 53.00749635914986, 103.1475840786226, 0.0, 120.3687088178235, 89.02699923375845, 67.30623290547787, 197.70872863208837, 284.4218589605823, 43.16297119730989, 122.08423594069144, 219.289551809129, 46.57724865635593, 395.33526793706784, 395.2750709725056, 38.103985806855704, 133.82143214304045, 93.79566967339603, 89.38982546864247, 111.72103210706568, 250.62489859065894, 27.291603583578834, 177.8326332561299, 303.7687204038772, 141.4627144199544, 155.38424508452405, 0.0, 63.93328093253395, 412.6903582446017, 161.45246807047286, 114.04189982404732, 88.89320993066123, 87.7318345025949, 10.621346467772916, 382.5032255130105, 70.7629441101915, 44.10886100562505, 344.912099173743, 20.555697044115362, 376.0089620940519, 66.3334236495086, 54.794185867060214, 394.8729405694201, 281.0428815239801, 101.48425257245917, 178.08980645889423, 38.00268799309794, 329.7617084887599, 221.27351751739724, 0.9427247388904799, 186.9067458448498, 242.61405748769582, 71.12283198937229, 132.54796998024625, 133.0303000118772, 130.9479504413424, 517.2937729784959, 255.9096527971169, 185.89574473546608, 7.635426463371812, 274.22656260243616, 341.317589063666, 50.80599967959896, 82.35941358255586, 224.4303642415871, 25.36325577082924, 169.73466213773025, 341.93906759610604, 95.4219433132976, 262.01238184457975, 659.6496135550558, 113.7347824292391, 345.3803678290859, 127.43256051807568, 128.51396037256055, 0.0, 6.639606857863548, 217.5419612441162, 69.2354065397705, 303.8791661490334, 166.95628507004344, 107.1101048656525, 480.0099898407404, 373.28436062473963, 96.43368396291744, 329.27003508562257, 228.23861297832065, 264.20416198080125, 189.8397651453381, 248.19474020748527, 336.51120975352694, 183.553806111551, 32.90201406172944, 92.59670604696574, 173.34142415373003, 54.82751117501456, 11.41591511669615, 47.725836516404925, 121.53577457325493, 17.109264837000865, 250.42640790635983, 79.61646067674027, 195.34515822664744, 187.0644256046728, 24.797436631646207, 241.83341355403772, 50.72421570574651, 188.53824072986285, 146.5683409430558, 282.822748787946]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.782461347198495, "mean_inference_ms": 4.467382600768838, "mean_action_processing_ms": 1.3716631582048928, "mean_env_wait_ms": 11.178996614275839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01144303215874566, "StateBufferConnector_ms": 0.004525581995646159, "ViewRequirementAgentConnector_ms": 0.12538711229960123}, "num_episodes": 0, "episode_return_max": 738.329240031391, "episode_return_min": 43.60000000000032, "episode_return_mean": 344.26501163977815, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 142.042780699404, "num_env_steps_trained_throughput_per_sec": 142.042780699404, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 26185.781, "restore_workers_time_ms": 0.025, "training_step_time_ms": 26185.605, "sample_time_ms": 2582.884, "learn_time_ms": 23575.074, "learn_throughput": 169.671, "synch_weights_time_ms": 24.64}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 14, "trial_id": "0b608_00000", "date": "2024-08-22_13-51-10", "timestamp": 1724314870, "time_this_iter_s": 28.200134992599487, "time_total_s": 365.09253787994385, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3120878b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 365.09253787994385, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 34.98205128205129, "ram_util_percent": 83.23076923076925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.221651638247979, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.8561505963562657, "policy_loss": -0.011875568677193273, "vf_loss": 3.8655752509990067, "vf_explained_var": 0.28964491041879803, "kl": 0.012254522000217722, "entropy": 1.3076556420200085, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 13703.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.431462996977347, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.67813606363125, "policy_loss": -0.011296127570999993, "vf_loss": 5.687638747502887, "vf_explained_var": 0.25042514939787525, "kl": 0.008967253126489817, "entropy": 1.387585859197788, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 13703.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 738.329240031391, "episode_reward_min": 43.60000000000032, "episode_reward_mean": 344.26501163977815, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 36000, "policy_reward_min": {"prey_policy": -417.34633953376414, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 377.37367663830685, "predator_policy": 659.6496135550558}, "policy_reward_mean": {"prey_policy": 19.200157017062065, "predator_policy": 152.93234880282702}, "custom_metrics": {}, "hist_stats": {"episode_reward": [221.09999999999926, 497.00000000000006, 73.4000000000001, 284.7582326959704, 325.5042891697734, 738.329240031391, 512.8999999999994, 530.1000000000009, 332.10000000000065, 376.7777949135276, 471.8, 529.0989752030652, 190.6261003226634, 494.2032643744032, 373.1999999999996, 387.9999999999991, 286.38093427798594, 292.09999999999997, 305.5000000000002, 609.0726868068141, 73.50000000000006, 461.5782011886129, 486.23382458810545, 610.2452460123576, 596.1999999999998, 542.962942906764, 544.4999999999997, 618.7413271788275, 217.43434491765083, 493.79999999999967, 289.5241671931809, 386.29999999999944, 214.57147451833478, 429.9640189598841, 346.4471272410277, 75.9000000000003, 272.4999999999993, 358.5999999999993, 192.83109493386146, 140.8999999999994, 207.4910828827706, 376.05953594528074, 236.03577300949507, 157.24838054331317, 532.0374330300673, 229.23283012041298, 189.89999999999986, 401.5845138195314, 626.4089043362978, 223.69805484143765, 239.69999999999933, 432.5999999999999, 442.71841641681794, 264.3999999999992, 326.0853901481669, 260.6999999999993, 43.60000000000032, 263.97644196179465, 257.02735428746246, 390.0000000000017, 248.7675776105872, 342.8353663977673, 185.49999999999972, 198.36209225892, 293.59999999999854, 359.91665465807665, 476.518493304353, 600.0642111846487, 203.11760142861888, 501.30000000000007, 200.46050198837332, 127.70000000000009, 422.76952014563943, 516.3550508974929, 371.4243706745654, 371.2900178264415, 136.29999999999927, 419.28173159300263, 430.12000848703576, 174.0054940462068, 459.3873551495944, 391.8999999999993, 206.06104766849165, 416.70000000000266, 199.77446177916863, 409.8436420916603, 369.06837484577466, 161.24917122154213, 285.4999999999992, 219.488903545024], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [25.179961431050064, -52.73083732672165, 199.28927044853597, 198.68074084525722, -64.77816481716049, 2.4228079593100027, -73.50780096732343, 9.10461543776101, 50.27322812519208, 20.51956847998826, 377.37367663830685, 270.96070779816455, 203.15010915884338, 171.11955693278554, 132.12957602616788, 353.7108027378266, 158.59106651609443, -27.383301949534562, 155.05314051780798, -166.68659326450776, 50.52893874627648, 248.5312252813035, 86.05406350662123, 175.08838714801752, -41.48447750786388, -162.3230852702604, 196.57281088887353, -176.81536341296848, -3.809588946185329, 207.8664881573004, 216.06301800630877, -208.97501588109805, 8.815211613435467, -142.21633905943094, 39.11028250323231, 250.7456558968977, 125.27313369989814, -45.532250820607295, -112.53440839074963, 182.87736719187217, -17.37365639351769, -136.18747677886515, -55.24304377632064, 146.9556280348033, 70.53309589652605, 3.443227475027385, 134.2061619416707, 330.475757769977, 291.8827798584348, 228.6482719919805, 187.6705324761418, 80.21307441728842, 225.84254169332448, 17.721507513156492, 244.27128252829922, 208.54983013370523, -192.90097381318634, 127.11343765675988, 308.0825997762744, 91.39219983539496, -175.28572479978877, 48.212853390260186, -47.346170395009636, 52.027686485331415, 116.10000579603431, -175.01076898041669, -113.21719311477484, 339.1060136493959, -311.06764747898046, 227.73764431755043, -25.886051931266728, -16.907496359149512, 149.92987824568917, 19.42253767568771, 86.70493202415648, 62.49935992426168, 122.73772138329474, -194.92158798700038, -259.52185896057915, 72.83702880269009, -66.24332058904541, -67.63938427800676, -218.40284461438236, 152.54986396623707, -233.6556645397925, 36.31238076992583, 28.7600880185457, -99.1288092916671, 244.4898978061673, 86.4366776481917, -70.86925510641997, 22.18558305259655, -132.53263325612977, -159.1687204038769, 133.77158209771608, -29.034027782663166, 279.07872544301534, 283.39689796074856, -414.86723494756154, 64.42246347392515, -76.98497752657141, 113.74986777186014, 212.16816549740503, 122.07865353222704, -47.454202860017425, 36.90644965363365, -7.308861005624804, -117.31209917374298, 288.56796204694615, -359.04723103694135, -31.83342364950822, 171.40581413293995, -373.87294056941636, -258.4428815239774, 73.70917223836501, -89.30678930792492, 16.554959840842955, -127.29200203523706, -165.89344777341609, 333.6772055171264, -16.51035061465834, -164.2428751073002, 226.931792750413, -87.76722832226665, 13.369699988122015, -91.8479504413443, -417.34633953376414, -157.49499398292866, -6.605584133803764, 106.6744129349632, -74.27604252402237, -181.35145448400306, 324.37169254375004, 18.981387498444022, 296.70820026863333, 53.56239090359908, -53.726997529492934, -254.82913077572204, 146.67805668670184, -2.8123818445797895, -252.46950429550634, -320.45438970041494, -252.58036782908158, -92.53256051807763, -40.61396037256026, 334.8695201456403, 141.25143605270637, 150.92204674280708, -59.74211289931435, 58.051910885074825, 208.51544794266056, -111.29182005191548, -362.94354737230736, -354.05080309317015, -34.609243057541846, 28.18725560200353, 33.97147717954135, -96.29424365162792, -136.47615563318854, -127.55285567342952, -81.39414039512889, 20.71647967964509, 271.79798593827053, -5.396706046965797, 68.40116022399846, -90.5090478842511, 289.3861586594953, 68.17208970740376, -12.597544384837498, 73.72696675375026, 19.61652100816481, 60.184252500395075, -99.75554653185449, 86.41433754630884, -32.794562316643706, -72.5871166474991, 195.9757842942535, -149.73824072986423, -35.376249165734244, -174.52593702024285], "policy_predator_policy_reward": [160.9200385689499, 87.7308373267206, 70.11072955146373, 28.91925915474278, 99.87816481715856, 35.877192040690225, 276.6059166870268, 72.55550153850673, 144.98830749588325, 109.72318506870961, 79.70929542593183, 10.285560168987557, 116.04989084115665, 22.580443067214492, 17.970423973832364, 26.289197262173374, 133.20893348390527, 67.68330194953481, 211.97281818603352, 176.4384294741941, 170.87106125372281, 1.8687747186964283, 142.72044801844626, 125.23607652998031, 196.20030095715643, 198.23336214363107, 229.6401471201545, 244.80566977834334, 145.1568083753064, 23.986292413577583, 45.19120077357155, 335.7207971012192, 134.9445566989192, 284.83750502506285, 2.244061599870267, 0.0, 145.72686630010193, 80.03225082060668, 182.22031805934006, 356.5094099463506, 56.67365639351818, 170.3874767788632, 80.99257126352761, 288.873045666603, 67.66695664177102, 344.5905445747808, 105.0390840706866, 40.524242230022956, 17.092393138342675, 58.57655501124225, 130.9542744882901, 144.12506152504363, 88.02996855868986, 212.90598223482903, 156.31345039133933, 9.606764125483597, 241.48300817119954, 41.73887290287668, 0.9174002237255884, 93.40780016460502, 346.6946263673267, 69.9024122353832, 274.15567196264783, 107.46281194703037, 154.56849239157148, 118.91374531114543, 169.9021961366111, 34.173002288652576, 362.29746786434407, 67.47966253811671, 65.68605193126722, 53.00749635914986, 103.1475840786226, 0.0, 120.3687088178235, 89.02699923375845, 67.30623290547787, 197.70872863208837, 284.4218589605823, 43.16297119730989, 122.08423594069144, 219.289551809129, 46.57724865635593, 395.33526793706784, 395.2750709725056, 38.103985806855704, 133.82143214304045, 93.79566967339603, 89.38982546864247, 111.72103210706568, 250.62489859065894, 27.291603583578834, 177.8326332561299, 303.7687204038772, 141.4627144199544, 155.38424508452405, 0.0, 63.93328093253395, 412.6903582446017, 161.45246807047286, 114.04189982404732, 88.89320993066123, 87.7318345025949, 10.621346467772916, 382.5032255130105, 70.7629441101915, 44.10886100562505, 344.912099173743, 20.555697044115362, 376.0089620940519, 66.3334236495086, 54.794185867060214, 394.8729405694201, 281.0428815239801, 101.48425257245917, 178.08980645889423, 38.00268799309794, 329.7617084887599, 221.27351751739724, 0.9427247388904799, 186.9067458448498, 242.61405748769582, 71.12283198937229, 132.54796998024625, 133.0303000118772, 130.9479504413424, 517.2937729784959, 255.9096527971169, 185.89574473546608, 7.635426463371812, 274.22656260243616, 341.317589063666, 50.80599967959896, 82.35941358255586, 224.4303642415871, 25.36325577082924, 169.73466213773025, 341.93906759610604, 95.4219433132976, 262.01238184457975, 659.6496135550558, 113.7347824292391, 345.3803678290859, 127.43256051807568, 128.51396037256055, 0.0, 6.639606857863548, 217.5419612441162, 69.2354065397705, 303.8791661490334, 166.95628507004344, 107.1101048656525, 480.0099898407404, 373.28436062473963, 96.43368396291744, 329.27003508562257, 228.23861297832065, 264.20416198080125, 189.8397651453381, 248.19474020748527, 336.51120975352694, 183.553806111551, 32.90201406172944, 92.59670604696574, 173.34142415373003, 54.82751117501456, 11.41591511669615, 47.725836516404925, 121.53577457325493, 17.109264837000865, 250.42640790635983, 79.61646067674027, 195.34515822664744, 187.0644256046728, 24.797436631646207, 241.83341355403772, 50.72421570574651, 188.53824072986285, 146.5683409430558, 282.822748787946]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.782461347198495, "mean_inference_ms": 4.467382600768838, "mean_action_processing_ms": 1.3716631582048928, "mean_env_wait_ms": 11.178996614275839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01144303215874566, "StateBufferConnector_ms": 0.004525581995646159, "ViewRequirementAgentConnector_ms": 0.12538711229960123}, "num_episodes": 0, "episode_return_max": 738.329240031391, "episode_return_min": 43.60000000000032, "episode_return_mean": 344.26501163977815, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 150.77543923531908, "num_env_steps_trained_throughput_per_sec": 150.77543923531908, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 26189.989, "restore_workers_time_ms": 0.024, "training_step_time_ms": 26189.768, "sample_time_ms": 2605.2, "learn_time_ms": 23555.555, "learn_throughput": 169.811, "synch_weights_time_ms": 24.571}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 15, "trial_id": "0b608_00000", "date": "2024-08-22_13-51-37", "timestamp": 1724314897, "time_this_iter_s": 26.55586290359497, "time_total_s": 391.6484007835388, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3120874c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 391.6484007835388, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 34.18947368421053, "ram_util_percent": 83.2342105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.06902408814304, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.10814673913219, "policy_loss": -0.011719140485076914, "vf_loss": 4.118003658768992, "vf_explained_var": 0.3034339226742901, "kl": 0.009311012400895673, "entropy": 1.2881703519316576, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14648.0, "diff_num_grad_updates_vs_sampler_policy": 492.7900000000009}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.451897481005028, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.412480136074087, "policy_loss": -0.011444454189271681, "vf_loss": 5.42218348689811, "vf_explained_var": 0.26285142267822587, "kl": 0.008705415754583935, "entropy": 1.3853327333611787, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14648.0, "diff_num_grad_updates_vs_sampler_policy": 492.7900000000009}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 738.329240031391, "episode_reward_min": 43.60000000000032, "episode_reward_mean": 341.112964615072, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 39600, "policy_reward_min": {"prey_policy": -417.34633953376414, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 377.37367663830685, "predator_policy": 659.6496135550558}, "policy_reward_mean": {"prey_policy": 16.340579498559286, "predator_policy": 154.21590280897667}, "custom_metrics": {}, "hist_stats": {"episode_reward": [221.09999999999926, 497.00000000000006, 73.4000000000001, 284.7582326959704, 325.5042891697734, 738.329240031391, 512.8999999999994, 530.1000000000009, 332.10000000000065, 376.7777949135276, 471.8, 529.0989752030652, 190.6261003226634, 494.2032643744032, 373.1999999999996, 387.9999999999991, 286.38093427798594, 292.09999999999997, 305.5000000000002, 609.0726868068141, 73.50000000000006, 461.5782011886129, 486.23382458810545, 610.2452460123576, 596.1999999999998, 542.962942906764, 544.4999999999997, 618.7413271788275, 217.43434491765083, 493.79999999999967, 289.5241671931809, 386.29999999999944, 214.57147451833478, 429.9640189598841, 346.4471272410277, 75.9000000000003, 272.4999999999993, 358.5999999999993, 192.83109493386146, 140.8999999999994, 207.4910828827706, 376.05953594528074, 236.03577300949507, 157.24838054331317, 532.0374330300673, 229.23283012041298, 189.89999999999986, 401.5845138195314, 626.4089043362978, 223.69805484143765, 239.69999999999933, 432.5999999999999, 442.71841641681794, 264.3999999999992, 326.0853901481669, 260.6999999999993, 43.60000000000032, 263.97644196179465, 257.02735428746246, 390.0000000000017, 248.7675776105872, 342.8353663977673, 185.49999999999972, 198.36209225892, 293.59999999999854, 359.91665465807665, 476.518493304353, 600.0642111846487, 203.11760142861888, 501.30000000000007, 200.46050198837332, 127.70000000000009, 422.76952014563943, 516.3550508974929, 371.4243706745654, 371.2900178264415, 136.29999999999927, 419.28173159300263, 430.12000848703576, 174.0054940462068, 459.3873551495944, 391.8999999999993, 206.06104766849165, 416.70000000000266, 199.77446177916863, 409.8436420916603, 369.06837484577466, 161.24917122154213, 285.4999999999992, 219.488903545024, 281.4177318772378, 73.70000000000009, 153.59999999999718, 414.33833344884647, 602.3545259526645, 473.8981910381608, 80.32757873855842, 313.9299409464846, 392.76614731014155], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [25.179961431050064, -52.73083732672165, 199.28927044853597, 198.68074084525722, -64.77816481716049, 2.4228079593100027, -73.50780096732343, 9.10461543776101, 50.27322812519208, 20.51956847998826, 377.37367663830685, 270.96070779816455, 203.15010915884338, 171.11955693278554, 132.12957602616788, 353.7108027378266, 158.59106651609443, -27.383301949534562, 155.05314051780798, -166.68659326450776, 50.52893874627648, 248.5312252813035, 86.05406350662123, 175.08838714801752, -41.48447750786388, -162.3230852702604, 196.57281088887353, -176.81536341296848, -3.809588946185329, 207.8664881573004, 216.06301800630877, -208.97501588109805, 8.815211613435467, -142.21633905943094, 39.11028250323231, 250.7456558968977, 125.27313369989814, -45.532250820607295, -112.53440839074963, 182.87736719187217, -17.37365639351769, -136.18747677886515, -55.24304377632064, 146.9556280348033, 70.53309589652605, 3.443227475027385, 134.2061619416707, 330.475757769977, 291.8827798584348, 228.6482719919805, 187.6705324761418, 80.21307441728842, 225.84254169332448, 17.721507513156492, 244.27128252829922, 208.54983013370523, -192.90097381318634, 127.11343765675988, 308.0825997762744, 91.39219983539496, -175.28572479978877, 48.212853390260186, -47.346170395009636, 52.027686485331415, 116.10000579603431, -175.01076898041669, -113.21719311477484, 339.1060136493959, -311.06764747898046, 227.73764431755043, -25.886051931266728, -16.907496359149512, 149.92987824568917, 19.42253767568771, 86.70493202415648, 62.49935992426168, 122.73772138329474, -194.92158798700038, -259.52185896057915, 72.83702880269009, -66.24332058904541, -67.63938427800676, -218.40284461438236, 152.54986396623707, -233.6556645397925, 36.31238076992583, 28.7600880185457, -99.1288092916671, 244.4898978061673, 86.4366776481917, -70.86925510641997, 22.18558305259655, -132.53263325612977, -159.1687204038769, 133.77158209771608, -29.034027782663166, 279.07872544301534, 283.39689796074856, -414.86723494756154, 64.42246347392515, -76.98497752657141, 113.74986777186014, 212.16816549740503, 122.07865353222704, -47.454202860017425, 36.90644965363365, -7.308861005624804, -117.31209917374298, 288.56796204694615, -359.04723103694135, -31.83342364950822, 171.40581413293995, -373.87294056941636, -258.4428815239774, 73.70917223836501, -89.30678930792492, 16.554959840842955, -127.29200203523706, -165.89344777341609, 333.6772055171264, -16.51035061465834, -164.2428751073002, 226.931792750413, -87.76722832226665, 13.369699988122015, -91.8479504413443, -417.34633953376414, -157.49499398292866, -6.605584133803764, 106.6744129349632, -74.27604252402237, -181.35145448400306, 324.37169254375004, 18.981387498444022, 296.70820026863333, 53.56239090359908, -53.726997529492934, -254.82913077572204, 146.67805668670184, -2.8123818445797895, -252.46950429550634, -320.45438970041494, -252.58036782908158, -92.53256051807763, -40.61396037256026, 334.8695201456403, 141.25143605270637, 150.92204674280708, -59.74211289931435, 58.051910885074825, 208.51544794266056, -111.29182005191548, -362.94354737230736, -354.05080309317015, -34.609243057541846, 28.18725560200353, 33.97147717954135, -96.29424365162792, -136.47615563318854, -127.55285567342952, -81.39414039512889, 20.71647967964509, 271.79798593827053, -5.396706046965797, 68.40116022399846, -90.5090478842511, 289.3861586594953, 68.17208970740376, -12.597544384837498, 73.72696675375026, 19.61652100816481, 60.184252500395075, -99.75554653185449, 86.41433754630884, -32.794562316643706, -72.5871166474991, 195.9757842942535, -149.73824072986423, -35.376249165734244, -174.52593702024285, -69.68105167306263, -44.53748182412454, 20.18341930362485, -91.8578932469275, -0.9665732908148345, -1.0432898911843553, -258.51127509698324, 209.00414166400046, 90.34382239644786, 258.90936533207974, -96.43567935424846, 4.96701086333146, -23.05270064551386, -1.7562396285943316, -75.42849880802908, -92.42156846190262, -18.840315841517707, -29.468714153014545], "policy_predator_policy_reward": [160.9200385689499, 87.7308373267206, 70.11072955146373, 28.91925915474278, 99.87816481715856, 35.877192040690225, 276.6059166870268, 72.55550153850673, 144.98830749588325, 109.72318506870961, 79.70929542593183, 10.285560168987557, 116.04989084115665, 22.580443067214492, 17.970423973832364, 26.289197262173374, 133.20893348390527, 67.68330194953481, 211.97281818603352, 176.4384294741941, 170.87106125372281, 1.8687747186964283, 142.72044801844626, 125.23607652998031, 196.20030095715643, 198.23336214363107, 229.6401471201545, 244.80566977834334, 145.1568083753064, 23.986292413577583, 45.19120077357155, 335.7207971012192, 134.9445566989192, 284.83750502506285, 2.244061599870267, 0.0, 145.72686630010193, 80.03225082060668, 182.22031805934006, 356.5094099463506, 56.67365639351818, 170.3874767788632, 80.99257126352761, 288.873045666603, 67.66695664177102, 344.5905445747808, 105.0390840706866, 40.524242230022956, 17.092393138342675, 58.57655501124225, 130.9542744882901, 144.12506152504363, 88.02996855868986, 212.90598223482903, 156.31345039133933, 9.606764125483597, 241.48300817119954, 41.73887290287668, 0.9174002237255884, 93.40780016460502, 346.6946263673267, 69.9024122353832, 274.15567196264783, 107.46281194703037, 154.56849239157148, 118.91374531114543, 169.9021961366111, 34.173002288652576, 362.29746786434407, 67.47966253811671, 65.68605193126722, 53.00749635914986, 103.1475840786226, 0.0, 120.3687088178235, 89.02699923375845, 67.30623290547787, 197.70872863208837, 284.4218589605823, 43.16297119730989, 122.08423594069144, 219.289551809129, 46.57724865635593, 395.33526793706784, 395.2750709725056, 38.103985806855704, 133.82143214304045, 93.79566967339603, 89.38982546864247, 111.72103210706568, 250.62489859065894, 27.291603583578834, 177.8326332561299, 303.7687204038772, 141.4627144199544, 155.38424508452405, 0.0, 63.93328093253395, 412.6903582446017, 161.45246807047286, 114.04189982404732, 88.89320993066123, 87.7318345025949, 10.621346467772916, 382.5032255130105, 70.7629441101915, 44.10886100562505, 344.912099173743, 20.555697044115362, 376.0089620940519, 66.3334236495086, 54.794185867060214, 394.8729405694201, 281.0428815239801, 101.48425257245917, 178.08980645889423, 38.00268799309794, 329.7617084887599, 221.27351751739724, 0.9427247388904799, 186.9067458448498, 242.61405748769582, 71.12283198937229, 132.54796998024625, 133.0303000118772, 130.9479504413424, 517.2937729784959, 255.9096527971169, 185.89574473546608, 7.635426463371812, 274.22656260243616, 341.317589063666, 50.80599967959896, 82.35941358255586, 224.4303642415871, 25.36325577082924, 169.73466213773025, 341.93906759610604, 95.4219433132976, 262.01238184457975, 659.6496135550558, 113.7347824292391, 345.3803678290859, 127.43256051807568, 128.51396037256055, 0.0, 6.639606857863548, 217.5419612441162, 69.2354065397705, 303.8791661490334, 166.95628507004344, 107.1101048656525, 480.0099898407404, 373.28436062473963, 96.43368396291744, 329.27003508562257, 228.23861297832065, 264.20416198080125, 189.8397651453381, 248.19474020748527, 336.51120975352694, 183.553806111551, 32.90201406172944, 92.59670604696574, 173.34142415373003, 54.82751117501456, 11.41591511669615, 47.725836516404925, 121.53577457325493, 17.109264837000865, 250.42640790635983, 79.61646067674027, 195.34515822664744, 187.0644256046728, 24.797436631646207, 241.83341355403772, 50.72421570574651, 188.53824072986285, 146.5683409430558, 282.822748787946, 247.073835091675, 148.56243028274946, 18.31658069637516, 127.0578932469255, 38.86657329081512, 116.74328989118443, 49.73152566045534, 414.1139412213728, 0.0, 253.10133822413718, 34.59597247550811, 530.7708870535695, 58.652700645514365, 46.48381836715331, 134.2312416148527, 347.548766601562, 157.44022861668134, 283.63494868799046]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.836987455053584, "mean_inference_ms": 4.470912413199302, "mean_action_processing_ms": 1.4191809759818514, "mean_env_wait_ms": 11.214334107180898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010697769396232836, "StateBufferConnector_ms": 0.004487326650908499, "ViewRequirementAgentConnector_ms": 0.12964515975027374}, "num_episodes": 9, "episode_return_max": 738.329240031391, "episode_return_min": 43.60000000000032, "episode_return_mean": 341.112964615072, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.0808781216518, "num_env_steps_trained_throughput_per_sec": 156.0808781216518, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 26103.316, "restore_workers_time_ms": 0.036, "training_step_time_ms": 26103.059, "sample_time_ms": 2578.627, "learn_time_ms": 23495.987, "learn_throughput": 170.242, "synch_weights_time_ms": 24.008}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 16, "trial_id": "0b608_00000", "date": "2024-08-22_13-52-03", "timestamp": 1724314923, "time_this_iter_s": 25.67296600341797, "time_total_s": 417.3213667869568, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31205b310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 417.3213667869568, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 32.40833333333333, "ram_util_percent": 83.29166666666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.446140081163437, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.211271421745341, "policy_loss": -0.014143883673444628, "vf_loss": 4.22289983103515, "vf_explained_var": 0.29765198356890804, "kl": 0.012577361117792193, "entropy": 1.19528944593258, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 15593.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.134958557477074, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.369475615213788, "policy_loss": -0.010746839557276674, "vf_loss": 5.378604022535698, "vf_explained_var": 0.23310890614040314, "kl": 0.00809210740256483, "entropy": 1.3381628922053745, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 15593.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 765.0, "episode_reward_min": 43.60000000000032, "episode_reward_mean": 326.9886939268618, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -561.1802415278005, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 379.36203860587045, "predator_policy": 659.6496135550558}, "policy_reward_mean": {"prey_policy": -15.07769035268042, "predator_policy": 178.5720373161113}, "custom_metrics": {}, "hist_stats": {"episode_reward": [305.5000000000002, 609.0726868068141, 73.50000000000006, 461.5782011886129, 486.23382458810545, 610.2452460123576, 596.1999999999998, 542.962942906764, 544.4999999999997, 618.7413271788275, 217.43434491765083, 493.79999999999967, 289.5241671931809, 386.29999999999944, 214.57147451833478, 429.9640189598841, 346.4471272410277, 75.9000000000003, 272.4999999999993, 358.5999999999993, 192.83109493386146, 140.8999999999994, 207.4910828827706, 376.05953594528074, 236.03577300949507, 157.24838054331317, 532.0374330300673, 229.23283012041298, 189.89999999999986, 401.5845138195314, 626.4089043362978, 223.69805484143765, 239.69999999999933, 432.5999999999999, 442.71841641681794, 264.3999999999992, 326.0853901481669, 260.6999999999993, 43.60000000000032, 263.97644196179465, 257.02735428746246, 390.0000000000017, 248.7675776105872, 342.8353663977673, 185.49999999999972, 198.36209225892, 293.59999999999854, 359.91665465807665, 476.518493304353, 600.0642111846487, 203.11760142861888, 501.30000000000007, 200.46050198837332, 127.70000000000009, 422.76952014563943, 516.3550508974929, 371.4243706745654, 371.2900178264415, 136.29999999999927, 419.28173159300263, 430.12000848703576, 174.0054940462068, 459.3873551495944, 391.8999999999993, 206.06104766849165, 416.70000000000266, 199.77446177916863, 409.8436420916603, 369.06837484577466, 161.24917122154213, 285.4999999999992, 219.488903545024, 281.4177318772378, 73.70000000000009, 153.59999999999718, 414.33833344884647, 602.3545259526645, 473.8981910381608, 80.32757873855842, 313.9299409464846, 392.76614731014155, 268.3881584947542, 765.0, 473.1520312833473, 258.0700451541186, 50.298685823925624, 242.5963917054242, 320.50585053745556, 136.299999999997, 138.79999999999953, 302.45372032520925, 439.47703329549904, 305.04801026807945, 252.099999999998, 228.1999999999978, 365.50202773143917, 427.8128562266817, 270.1171086285664, 356.9428073083489, 245.2999999999985], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [125.27313369989814, -45.532250820607295, -112.53440839074963, 182.87736719187217, -17.37365639351769, -136.18747677886515, -55.24304377632064, 146.9556280348033, 70.53309589652605, 3.443227475027385, 134.2061619416707, 330.475757769977, 291.8827798584348, 228.6482719919805, 187.6705324761418, 80.21307441728842, 225.84254169332448, 17.721507513156492, 244.27128252829922, 208.54983013370523, -192.90097381318634, 127.11343765675988, 308.0825997762744, 91.39219983539496, -175.28572479978877, 48.212853390260186, -47.346170395009636, 52.027686485331415, 116.10000579603431, -175.01076898041669, -113.21719311477484, 339.1060136493959, -311.06764747898046, 227.73764431755043, -25.886051931266728, -16.907496359149512, 149.92987824568917, 19.42253767568771, 86.70493202415648, 62.49935992426168, 122.73772138329474, -194.92158798700038, -259.52185896057915, 72.83702880269009, -66.24332058904541, -67.63938427800676, -218.40284461438236, 152.54986396623707, -233.6556645397925, 36.31238076992583, 28.7600880185457, -99.1288092916671, 244.4898978061673, 86.4366776481917, -70.86925510641997, 22.18558305259655, -132.53263325612977, -159.1687204038769, 133.77158209771608, -29.034027782663166, 279.07872544301534, 283.39689796074856, -414.86723494756154, 64.42246347392515, -76.98497752657141, 113.74986777186014, 212.16816549740503, 122.07865353222704, -47.454202860017425, 36.90644965363365, -7.308861005624804, -117.31209917374298, 288.56796204694615, -359.04723103694135, -31.83342364950822, 171.40581413293995, -373.87294056941636, -258.4428815239774, 73.70917223836501, -89.30678930792492, 16.554959840842955, -127.29200203523706, -165.89344777341609, 333.6772055171264, -16.51035061465834, -164.2428751073002, 226.931792750413, -87.76722832226665, 13.369699988122015, -91.8479504413443, -417.34633953376414, -157.49499398292866, -6.605584133803764, 106.6744129349632, -74.27604252402237, -181.35145448400306, 324.37169254375004, 18.981387498444022, 296.70820026863333, 53.56239090359908, -53.726997529492934, -254.82913077572204, 146.67805668670184, -2.8123818445797895, -252.46950429550634, -320.45438970041494, -252.58036782908158, -92.53256051807763, -40.61396037256026, 334.8695201456403, 141.25143605270637, 150.92204674280708, -59.74211289931435, 58.051910885074825, 208.51544794266056, -111.29182005191548, -362.94354737230736, -354.05080309317015, -34.609243057541846, 28.18725560200353, 33.97147717954135, -96.29424365162792, -136.47615563318854, -127.55285567342952, -81.39414039512889, 20.71647967964509, 271.79798593827053, -5.396706046965797, 68.40116022399846, -90.5090478842511, 289.3861586594953, 68.17208970740376, -12.597544384837498, 73.72696675375026, 19.61652100816481, 60.184252500395075, -99.75554653185449, 86.41433754630884, -32.794562316643706, -72.5871166474991, 195.9757842942535, -149.73824072986423, -35.376249165734244, -174.52593702024285, -69.68105167306263, -44.53748182412454, 20.18341930362485, -91.8578932469275, -0.9665732908148345, -1.0432898911843553, -258.51127509698324, 209.00414166400046, 90.34382239644786, 258.90936533207974, -96.43567935424846, 4.96701086333146, -23.05270064551386, -1.7562396285943316, -75.42849880802908, -92.42156846190262, -18.840315841517707, -29.468714153014545, -77.949391098934, -120.87743542223464, 321.3473494628521, 379.36203860587045, 170.35569210186858, -40.75319408565777, -14.696006611569846, -230.74018616289428, -214.600282135419, -561.1802415278005, -435.69552140188165, -319.2993069611055, -309.3604957890383, 113.02168582021612, 33.80712486898351, -92.03459636689088, 46.32227986901313, 27.735921745615737, -344.3009532317802, 30.179210655208642, 88.28184759572243, -250.1334498125012, 31.762220347020882, 27.08489864579678, -109.7003323793771, 133.8713063874825, 96.976456038752, -142.72234404223286, -47.15665809005747, -317.4786582935746, -407.50025903668273, 251.99339033807397, -62.85732358249489, -445.67369252386135, -484.7058977304096, -55.96497587069842, -238.7700636602542, 7.301374482355689], "policy_predator_policy_reward": [145.72686630010193, 80.03225082060668, 182.22031805934006, 356.5094099463506, 56.67365639351818, 170.3874767788632, 80.99257126352761, 288.873045666603, 67.66695664177102, 344.5905445747808, 105.0390840706866, 40.524242230022956, 17.092393138342675, 58.57655501124225, 130.9542744882901, 144.12506152504363, 88.02996855868986, 212.90598223482903, 156.31345039133933, 9.606764125483597, 241.48300817119954, 41.73887290287668, 0.9174002237255884, 93.40780016460502, 346.6946263673267, 69.9024122353832, 274.15567196264783, 107.46281194703037, 154.56849239157148, 118.91374531114543, 169.9021961366111, 34.173002288652576, 362.29746786434407, 67.47966253811671, 65.68605193126722, 53.00749635914986, 103.1475840786226, 0.0, 120.3687088178235, 89.02699923375845, 67.30623290547787, 197.70872863208837, 284.4218589605823, 43.16297119730989, 122.08423594069144, 219.289551809129, 46.57724865635593, 395.33526793706784, 395.2750709725056, 38.103985806855704, 133.82143214304045, 93.79566967339603, 89.38982546864247, 111.72103210706568, 250.62489859065894, 27.291603583578834, 177.8326332561299, 303.7687204038772, 141.4627144199544, 155.38424508452405, 0.0, 63.93328093253395, 412.6903582446017, 161.45246807047286, 114.04189982404732, 88.89320993066123, 87.7318345025949, 10.621346467772916, 382.5032255130105, 70.7629441101915, 44.10886100562505, 344.912099173743, 20.555697044115362, 376.0089620940519, 66.3334236495086, 54.794185867060214, 394.8729405694201, 281.0428815239801, 101.48425257245917, 178.08980645889423, 38.00268799309794, 329.7617084887599, 221.27351751739724, 0.9427247388904799, 186.9067458448498, 242.61405748769582, 71.12283198937229, 132.54796998024625, 133.0303000118772, 130.9479504413424, 517.2937729784959, 255.9096527971169, 185.89574473546608, 7.635426463371812, 274.22656260243616, 341.317589063666, 50.80599967959896, 82.35941358255586, 224.4303642415871, 25.36325577082924, 169.73466213773025, 341.93906759610604, 95.4219433132976, 262.01238184457975, 659.6496135550558, 113.7347824292391, 345.3803678290859, 127.43256051807568, 128.51396037256055, 0.0, 6.639606857863548, 217.5419612441162, 69.2354065397705, 303.8791661490334, 166.95628507004344, 107.1101048656525, 480.0099898407404, 373.28436062473963, 96.43368396291744, 329.27003508562257, 228.23861297832065, 264.20416198080125, 189.8397651453381, 248.19474020748527, 336.51120975352694, 183.553806111551, 32.90201406172944, 92.59670604696574, 173.34142415373003, 54.82751117501456, 11.41591511669615, 47.725836516404925, 121.53577457325493, 17.109264837000865, 250.42640790635983, 79.61646067674027, 195.34515822664744, 187.0644256046728, 24.797436631646207, 241.83341355403772, 50.72421570574651, 188.53824072986285, 146.5683409430558, 282.822748787946, 247.073835091675, 148.56243028274946, 18.31658069637516, 127.0578932469255, 38.86657329081512, 116.74328989118443, 49.73152566045534, 414.1139412213728, 0.0, 253.10133822413718, 34.59597247550811, 530.7708870535695, 58.652700645514365, 46.48381836715331, 134.2312416148527, 347.548766601562, 157.44022861668134, 283.63494868799046, 410.47208240570257, 56.742902610216355, 52.652650537147906, 11.63796139412958, 255.1019279460997, 88.4476053210329, 159.10622444943758, 344.4000134791466, 465.5750001962978, 360.5042092908465, 494.5749802314377, 503.0162398369744, 393.6869637455582, 123.15769676072057, 175.4707680512907, 19.056703446615767, 53.37772013098717, 11.364078254384365, 138.59107855956844, 477.9843843422121, 330.6648022917045, 270.663833220572, 39.2831990704309, 206.9176922048298, 222.71041573807784, 5.218610253814608, 92.31688061967488, 181.62900738380426, 455.0933402635041, 275.0440038515708, 362.30166179532523, 221.01806312996604, 588.5585769639024, 190.08954777101863, 526.5222460531012, 371.09143485635514, 49.81732752525826, 426.95136165264006]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.956237532874619, "mean_inference_ms": 4.463175924134104, "mean_action_processing_ms": 1.579862305827139, "mean_env_wait_ms": 11.257341289238818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010685205459594727, "StateBufferConnector_ms": 0.00892031192779541, "ViewRequirementAgentConnector_ms": 0.1437368392944336}, "num_episodes": 19, "episode_return_max": 765.0, "episode_return_min": 43.60000000000032, "episode_return_mean": 326.9886939268618, "episodes_this_iter": 19}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 157.99006900603217, "num_env_steps_trained_throughput_per_sec": 157.99006900603217, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 26073.227, "restore_workers_time_ms": 0.035, "training_step_time_ms": 26072.953, "sample_time_ms": 2570.791, "learn_time_ms": 23474.397, "learn_throughput": 170.398, "synch_weights_time_ms": 23.306}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 17, "trial_id": "0b608_00000", "date": "2024-08-22_13-52-28", "timestamp": 1724314948, "time_this_iter_s": 25.365220308303833, "time_total_s": 442.6865870952606, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31207cf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 442.6865870952606, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 30.783333333333328, "ram_util_percent": 82.68333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.968712461183942, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.018402804773321, "policy_loss": -0.01058683060355997, "vf_loss": 5.0267546580582065, "vf_explained_var": 0.29020122895165096, "kl": 0.011174887406181486, "entropy": 1.1311414774132784, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16538.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.391986933650163, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.040809059143067, "policy_loss": -0.01291954363844106, "vf_loss": 6.051999052744063, "vf_explained_var": 0.18687424874179578, "kl": 0.008647768074035566, "entropy": 1.3055605337102578, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16538.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 765.0, "episode_reward_min": 17.114338646407063, "episode_reward_mean": 307.2923124943257, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -919.1374409710456, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 379.36203860587045, "predator_policy": 798.2731275266842}, "policy_reward_mean": {"prey_policy": -64.18465690508627, "predator_policy": 217.83081315224908}, "custom_metrics": {}, "hist_stats": {"episode_reward": [532.0374330300673, 229.23283012041298, 189.89999999999986, 401.5845138195314, 626.4089043362978, 223.69805484143765, 239.69999999999933, 432.5999999999999, 442.71841641681794, 264.3999999999992, 326.0853901481669, 260.6999999999993, 43.60000000000032, 263.97644196179465, 257.02735428746246, 390.0000000000017, 248.7675776105872, 342.8353663977673, 185.49999999999972, 198.36209225892, 293.59999999999854, 359.91665465807665, 476.518493304353, 600.0642111846487, 203.11760142861888, 501.30000000000007, 200.46050198837332, 127.70000000000009, 422.76952014563943, 516.3550508974929, 371.4243706745654, 371.2900178264415, 136.29999999999927, 419.28173159300263, 430.12000848703576, 174.0054940462068, 459.3873551495944, 391.8999999999993, 206.06104766849165, 416.70000000000266, 199.77446177916863, 409.8436420916603, 369.06837484577466, 161.24917122154213, 285.4999999999992, 219.488903545024, 281.4177318772378, 73.70000000000009, 153.59999999999718, 414.33833344884647, 602.3545259526645, 473.8981910381608, 80.32757873855842, 313.9299409464846, 392.76614731014155, 268.3881584947542, 765.0, 473.1520312833473, 258.0700451541186, 50.298685823925624, 242.5963917054242, 320.50585053745556, 136.299999999997, 138.79999999999953, 302.45372032520925, 439.47703329549904, 305.04801026807945, 252.099999999998, 228.1999999999978, 365.50202773143917, 427.8128562266817, 270.1171086285664, 356.9428073083489, 245.2999999999985, 331.8124546679668, 252.5639320224987, 199.48483531280476, 211.14547891712346, 505.5044354142618, 490.45573107516674, 186.8888182128186, 350.2265058398085, 17.114338646407063, 294.30650338877376, 377.30000000000155, 223.4028065230839, 169.61765207459752, 446.9479381504879, 208.87605188223276, 273.5449280118687, 235.14439926411615, 70.49075840524122, 429.48445690416014, 285.62737185211256, 330.2127364375203, 435.0298826829429, 345.39051870437913, 277.6999999999996, 254.330551182291, 71.90000000000019], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [244.4898978061673, 86.4366776481917, -70.86925510641997, 22.18558305259655, -132.53263325612977, -159.1687204038769, 133.77158209771608, -29.034027782663166, 279.07872544301534, 283.39689796074856, -414.86723494756154, 64.42246347392515, -76.98497752657141, 113.74986777186014, 212.16816549740503, 122.07865353222704, -47.454202860017425, 36.90644965363365, -7.308861005624804, -117.31209917374298, 288.56796204694615, -359.04723103694135, -31.83342364950822, 171.40581413293995, -373.87294056941636, -258.4428815239774, 73.70917223836501, -89.30678930792492, 16.554959840842955, -127.29200203523706, -165.89344777341609, 333.6772055171264, -16.51035061465834, -164.2428751073002, 226.931792750413, -87.76722832226665, 13.369699988122015, -91.8479504413443, -417.34633953376414, -157.49499398292866, -6.605584133803764, 106.6744129349632, -74.27604252402237, -181.35145448400306, 324.37169254375004, 18.981387498444022, 296.70820026863333, 53.56239090359908, -53.726997529492934, -254.82913077572204, 146.67805668670184, -2.8123818445797895, -252.46950429550634, -320.45438970041494, -252.58036782908158, -92.53256051807763, -40.61396037256026, 334.8695201456403, 141.25143605270637, 150.92204674280708, -59.74211289931435, 58.051910885074825, 208.51544794266056, -111.29182005191548, -362.94354737230736, -354.05080309317015, -34.609243057541846, 28.18725560200353, 33.97147717954135, -96.29424365162792, -136.47615563318854, -127.55285567342952, -81.39414039512889, 20.71647967964509, 271.79798593827053, -5.396706046965797, 68.40116022399846, -90.5090478842511, 289.3861586594953, 68.17208970740376, -12.597544384837498, 73.72696675375026, 19.61652100816481, 60.184252500395075, -99.75554653185449, 86.41433754630884, -32.794562316643706, -72.5871166474991, 195.9757842942535, -149.73824072986423, -35.376249165734244, -174.52593702024285, -69.68105167306263, -44.53748182412454, 20.18341930362485, -91.8578932469275, -0.9665732908148345, -1.0432898911843553, -258.51127509698324, 209.00414166400046, 90.34382239644786, 258.90936533207974, -96.43567935424846, 4.96701086333146, -23.05270064551386, -1.7562396285943316, -75.42849880802908, -92.42156846190262, -18.840315841517707, -29.468714153014545, -77.949391098934, -120.87743542223464, 321.3473494628521, 379.36203860587045, 170.35569210186858, -40.75319408565777, -14.696006611569846, -230.74018616289428, -214.600282135419, -561.1802415278005, -435.69552140188165, -319.2993069611055, -309.3604957890383, 113.02168582021612, 33.80712486898351, -92.03459636689088, 46.32227986901313, 27.735921745615737, -344.3009532317802, 30.179210655208642, 88.28184759572243, -250.1334498125012, 31.762220347020882, 27.08489864579678, -109.7003323793771, 133.8713063874825, 96.976456038752, -142.72234404223286, -47.15665809005747, -317.4786582935746, -407.50025903668273, 251.99339033807397, -62.85732358249489, -445.67369252386135, -484.7058977304096, -55.96497587069842, -238.7700636602542, 7.301374482355689, -222.02986741922484, -51.864334646965304, -24.333537560295206, 23.113626554069487, -402.2019405140751, -490.34480540654516, -106.67694976973303, -225.35012013416593, 71.997045515706, 20.37272113365705, 162.9421414380604, -290.76021473691907, -166.77120655260558, 97.59135345824279, -82.31257768771275, -214.67100448141957, -717.1271095128706, -620.8756155954987, -317.89804818831243, -461.5769278726187, 31.723180999161624, 328.81244204929465, -120.60800463001493, 14.986783278117889, -475.72970001679676, -919.1374409710456, -306.1083063792472, 272.26223857038667, -53.09543997799224, -380.1536019238286, 71.05046971000407, -259.96654170570787, 122.43603910023702, -562.343562955282, 16.059807753978376, 5.673438019697681, 60.97846985390523, -119.43862568488309, -151.40570733086417, -13.19098952449376, 148.95392049165716, -643.188935905065, -280.31486107538717, 64.66981157306337, -578.9695837349047, -63.60402134206318, -37.092074486771736, 94.31919474279351, 34.03501269092392, -47.69185993200183, -79.36875166742291, -21.084647044903278], "policy_predator_policy_reward": [89.38982546864247, 111.72103210706568, 250.62489859065894, 27.291603583578834, 177.8326332561299, 303.7687204038772, 141.4627144199544, 155.38424508452405, 0.0, 63.93328093253395, 412.6903582446017, 161.45246807047286, 114.04189982404732, 88.89320993066123, 87.7318345025949, 10.621346467772916, 382.5032255130105, 70.7629441101915, 44.10886100562505, 344.912099173743, 20.555697044115362, 376.0089620940519, 66.3334236495086, 54.794185867060214, 394.8729405694201, 281.0428815239801, 101.48425257245917, 178.08980645889423, 38.00268799309794, 329.7617084887599, 221.27351751739724, 0.9427247388904799, 186.9067458448498, 242.61405748769582, 71.12283198937229, 132.54796998024625, 133.0303000118772, 130.9479504413424, 517.2937729784959, 255.9096527971169, 185.89574473546608, 7.635426463371812, 274.22656260243616, 341.317589063666, 50.80599967959896, 82.35941358255586, 224.4303642415871, 25.36325577082924, 169.73466213773025, 341.93906759610604, 95.4219433132976, 262.01238184457975, 659.6496135550558, 113.7347824292391, 345.3803678290859, 127.43256051807568, 128.51396037256055, 0.0, 6.639606857863548, 217.5419612441162, 69.2354065397705, 303.8791661490334, 166.95628507004344, 107.1101048656525, 480.0099898407404, 373.28436062473963, 96.43368396291744, 329.27003508562257, 228.23861297832065, 264.20416198080125, 189.8397651453381, 248.19474020748527, 336.51120975352694, 183.553806111551, 32.90201406172944, 92.59670604696574, 173.34142415373003, 54.82751117501456, 11.41591511669615, 47.725836516404925, 121.53577457325493, 17.109264837000865, 250.42640790635983, 79.61646067674027, 195.34515822664744, 187.0644256046728, 24.797436631646207, 241.83341355403772, 50.72421570574651, 188.53824072986285, 146.5683409430558, 282.822748787946, 247.073835091675, 148.56243028274946, 18.31658069637516, 127.0578932469255, 38.86657329081512, 116.74328989118443, 49.73152566045534, 414.1139412213728, 0.0, 253.10133822413718, 34.59597247550811, 530.7708870535695, 58.652700645514365, 46.48381836715331, 134.2312416148527, 347.548766601562, 157.44022861668134, 283.63494868799046, 410.47208240570257, 56.742902610216355, 52.652650537147906, 11.63796139412958, 255.1019279460997, 88.4476053210329, 159.10622444943758, 344.4000134791466, 465.5750001962978, 360.5042092908465, 494.5749802314377, 503.0162398369744, 393.6869637455582, 123.15769676072057, 175.4707680512907, 19.056703446615767, 53.37772013098717, 11.364078254384365, 138.59107855956844, 477.9843843422121, 330.6648022917045, 270.663833220572, 39.2831990704309, 206.9176922048298, 222.71041573807784, 5.218610253814608, 92.31688061967488, 181.62900738380426, 455.0933402635041, 275.0440038515708, 362.30166179532523, 221.01806312996604, 588.5585769639024, 190.08954777101863, 526.5222460531012, 371.09143485635514, 49.81732752525826, 426.95136165264006, 547.4302408279665, 58.27641590618546, 7.677943531504815, 246.10589949722117, 639.0406509223887, 452.9909303110386, 302.9241941874349, 240.24835463358733, 357.74748928304234, 55.387179481855064, 469.7321602417631, 148.5416441322606, 222.78000030756195, 33.2886709996197, 399.1956900624375, 248.01439794649923, 720.2994777384815, 634.8175860162943, 723.30525564907, 350.4762238006356, 7.676819000838551, 9.087557950705365, 38.0634880772038, 290.96053979777906, 798.2731275266842, 766.2116655357576, 371.3403317871297, 109.45367417221847, 499.98272241727614, 142.14237136677795, 325.5443795172418, 136.9166204903293, 61.8566802865929, 613.1952428325685, 13.270932532050336, 35.486580099514754, 340.26226994807627, 147.6823427870605, 238.32886682443342, 211.89520188303774, 160.42701279967048, 664.0207390512552, 219.34842335305856, 431.3265088322082, 731.1695837349042, 256.79454004644106, 73.56981179888224, 146.90306794509573, 87.82559764319973, 180.16180078017092, 113.96875166742107, 58.384647044903765]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.101560648335961, "mean_inference_ms": 4.461382626523199, "mean_action_processing_ms": 1.7583293376658662, "mean_env_wait_ms": 11.306671889248143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010553956031799316, "StateBufferConnector_ms": 0.008569955825805664, "ViewRequirementAgentConnector_ms": 0.1397494077682495}, "num_episodes": 26, "episode_return_max": 765.0, "episode_return_min": 17.114338646407063, "episode_return_mean": 307.2923124943257, "episodes_this_iter": 26}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.58989735353683, "num_env_steps_trained_throughput_per_sec": 155.58989735353683, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 26084.813, "restore_workers_time_ms": 0.035, "training_step_time_ms": 26084.54, "sample_time_ms": 2566.532, "learn_time_ms": 23490.119, "learn_throughput": 170.284, "synch_weights_time_ms": 23.386}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 18, "trial_id": "0b608_00000", "date": "2024-08-22_13-52-54", "timestamp": 1724314974, "time_this_iter_s": 25.752820014953613, "time_total_s": 468.43940711021423, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31207c280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 468.43940711021423, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 32.80833333333334, "ram_util_percent": 83.08333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.081000129255668, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.521477972262751, "policy_loss": -0.01056951766725255, "vf_loss": 6.529886964767698, "vf_explained_var": 0.31138555372833576, "kl": 0.01080260205516227, "entropy": 0.9773288796187709, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17483.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.399452789119943, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.188027888504917, "policy_loss": -0.011514472206512456, "vf_loss": 7.197512790134975, "vf_explained_var": 0.03778347338318194, "kl": 0.010147741825255767, "entropy": 1.2043970381772076, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17483.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 765.0, "episode_reward_min": 17.114338646407063, "episode_reward_mean": 288.4788131041011, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -919.1374409710456, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 379.36203860587045, "predator_policy": 826.4211046477199}, "policy_reward_mean": {"prey_policy": -110.12369525136063, "predator_policy": 254.36310180341113}, "custom_metrics": {}, "hist_stats": {"episode_reward": [203.11760142861888, 501.30000000000007, 200.46050198837332, 127.70000000000009, 422.76952014563943, 516.3550508974929, 371.4243706745654, 371.2900178264415, 136.29999999999927, 419.28173159300263, 430.12000848703576, 174.0054940462068, 459.3873551495944, 391.8999999999993, 206.06104766849165, 416.70000000000266, 199.77446177916863, 409.8436420916603, 369.06837484577466, 161.24917122154213, 285.4999999999992, 219.488903545024, 281.4177318772378, 73.70000000000009, 153.59999999999718, 414.33833344884647, 602.3545259526645, 473.8981910381608, 80.32757873855842, 313.9299409464846, 392.76614731014155, 268.3881584947542, 765.0, 473.1520312833473, 258.0700451541186, 50.298685823925624, 242.5963917054242, 320.50585053745556, 136.299999999997, 138.79999999999953, 302.45372032520925, 439.47703329549904, 305.04801026807945, 252.099999999998, 228.1999999999978, 365.50202773143917, 427.8128562266817, 270.1171086285664, 356.9428073083489, 245.2999999999985, 331.8124546679668, 252.5639320224987, 199.48483531280476, 211.14547891712346, 505.5044354142618, 490.45573107516674, 186.8888182128186, 350.2265058398085, 17.114338646407063, 294.30650338877376, 377.30000000000155, 223.4028065230839, 169.61765207459752, 446.9479381504879, 208.87605188223276, 273.5449280118687, 235.14439926411615, 70.49075840524122, 429.48445690416014, 285.62737185211256, 330.2127364375203, 435.0298826829429, 345.39051870437913, 277.6999999999996, 254.330551182291, 71.90000000000019, 219.36124369041477, 170.55595223975902, 79.6999999999997, 245.8572855450376, 306.95218401088977, 179.39046998953702, 595.4817255872756, 87.99310892578687, 199.82121166089155, 376.99259375865904, 238.89773567709696, 152.52724479833952, 265.1538152407152, 205.85723649927147, 223.9436478442211, 270.7585958816518, 142.70521788418662, 83.38026108098983, 365.0640637040232, 441.69796076515456, 209.30141058220215, 526.2224287333767, 177.6684012544004, 182.59999999999894], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-53.726997529492934, -254.82913077572204, 146.67805668670184, -2.8123818445797895, -252.46950429550634, -320.45438970041494, -252.58036782908158, -92.53256051807763, -40.61396037256026, 334.8695201456403, 141.25143605270637, 150.92204674280708, -59.74211289931435, 58.051910885074825, 208.51544794266056, -111.29182005191548, -362.94354737230736, -354.05080309317015, -34.609243057541846, 28.18725560200353, 33.97147717954135, -96.29424365162792, -136.47615563318854, -127.55285567342952, -81.39414039512889, 20.71647967964509, 271.79798593827053, -5.396706046965797, 68.40116022399846, -90.5090478842511, 289.3861586594953, 68.17208970740376, -12.597544384837498, 73.72696675375026, 19.61652100816481, 60.184252500395075, -99.75554653185449, 86.41433754630884, -32.794562316643706, -72.5871166474991, 195.9757842942535, -149.73824072986423, -35.376249165734244, -174.52593702024285, -69.68105167306263, -44.53748182412454, 20.18341930362485, -91.8578932469275, -0.9665732908148345, -1.0432898911843553, -258.51127509698324, 209.00414166400046, 90.34382239644786, 258.90936533207974, -96.43567935424846, 4.96701086333146, -23.05270064551386, -1.7562396285943316, -75.42849880802908, -92.42156846190262, -18.840315841517707, -29.468714153014545, -77.949391098934, -120.87743542223464, 321.3473494628521, 379.36203860587045, 170.35569210186858, -40.75319408565777, -14.696006611569846, -230.74018616289428, -214.600282135419, -561.1802415278005, -435.69552140188165, -319.2993069611055, -309.3604957890383, 113.02168582021612, 33.80712486898351, -92.03459636689088, 46.32227986901313, 27.735921745615737, -344.3009532317802, 30.179210655208642, 88.28184759572243, -250.1334498125012, 31.762220347020882, 27.08489864579678, -109.7003323793771, 133.8713063874825, 96.976456038752, -142.72234404223286, -47.15665809005747, -317.4786582935746, -407.50025903668273, 251.99339033807397, -62.85732358249489, -445.67369252386135, -484.7058977304096, -55.96497587069842, -238.7700636602542, 7.301374482355689, -222.02986741922484, -51.864334646965304, -24.333537560295206, 23.113626554069487, -402.2019405140751, -490.34480540654516, -106.67694976973303, -225.35012013416593, 71.997045515706, 20.37272113365705, 162.9421414380604, -290.76021473691907, -166.77120655260558, 97.59135345824279, -82.31257768771275, -214.67100448141957, -717.1271095128706, -620.8756155954987, -317.89804818831243, -461.5769278726187, 31.723180999161624, 328.81244204929465, -120.60800463001493, 14.986783278117889, -475.72970001679676, -919.1374409710456, -306.1083063792472, 272.26223857038667, -53.09543997799224, -380.1536019238286, 71.05046971000407, -259.96654170570787, 122.43603910023702, -562.343562955282, 16.059807753978376, 5.673438019697681, 60.97846985390523, -119.43862568488309, -151.40570733086417, -13.19098952449376, 148.95392049165716, -643.188935905065, -280.31486107538717, 64.66981157306337, -578.9695837349047, -63.60402134206318, -37.092074486771736, 94.31919474279351, 34.03501269092392, -47.69185993200183, -79.36875166742291, -21.084647044903278, -281.0333652409874, -2.0722842909462695, -6.268410589051285, -691.145108197119, 25.51305476137101, 19.640094813341527, -52.57705468189713, -93.56891830000869, -146.45711430905857, -488.7489828085907, -396.503657383644, -495.1748725030613, 215.419232459669, 163.1521801563441, -10.036965981947958, 27.46562902876332, -7.313302201314867, -785.2635463467702, 87.7514443436249, 52.70400754103315, -55.68375008648778, -242.02457480669707, -766.7668881561716, -480.60089164887256, -129.74955528730268, -404.10052892593853, 25.175874378172058, -25.514783304996058, -56.82037981742464, -229.8738680026786, -90.19233338745833, -89.40551213516096, -94.93074129111986, -582.6761331809628, -412.7214327800315, -100.990567014377, 126.11015984957407, -666.391072713972, 42.19615496837693, -343.53165408461166, -765.0792139862236, -547.3956247219992, -41.653218596449555, -361.13162421249626, -281.36413572577544, -23.521228909007604, 120.28779057412213, 19.59611097986068], "policy_predator_policy_reward": [169.73466213773025, 341.93906759610604, 95.4219433132976, 262.01238184457975, 659.6496135550558, 113.7347824292391, 345.3803678290859, 127.43256051807568, 128.51396037256055, 0.0, 6.639606857863548, 217.5419612441162, 69.2354065397705, 303.8791661490334, 166.95628507004344, 107.1101048656525, 480.0099898407404, 373.28436062473963, 96.43368396291744, 329.27003508562257, 228.23861297832065, 264.20416198080125, 189.8397651453381, 248.19474020748527, 336.51120975352694, 183.553806111551, 32.90201406172944, 92.59670604696574, 173.34142415373003, 54.82751117501456, 11.41591511669615, 47.725836516404925, 121.53577457325493, 17.109264837000865, 250.42640790635983, 79.61646067674027, 195.34515822664744, 187.0644256046728, 24.797436631646207, 241.83341355403772, 50.72421570574651, 188.53824072986285, 146.5683409430558, 282.822748787946, 247.073835091675, 148.56243028274946, 18.31658069637516, 127.0578932469255, 38.86657329081512, 116.74328989118443, 49.73152566045534, 414.1139412213728, 0.0, 253.10133822413718, 34.59597247550811, 530.7708870535695, 58.652700645514365, 46.48381836715331, 134.2312416148527, 347.548766601562, 157.44022861668134, 283.63494868799046, 410.47208240570257, 56.742902610216355, 52.652650537147906, 11.63796139412958, 255.1019279460997, 88.4476053210329, 159.10622444943758, 344.4000134791466, 465.5750001962978, 360.5042092908465, 494.5749802314377, 503.0162398369744, 393.6869637455582, 123.15769676072057, 175.4707680512907, 19.056703446615767, 53.37772013098717, 11.364078254384365, 138.59107855956844, 477.9843843422121, 330.6648022917045, 270.663833220572, 39.2831990704309, 206.9176922048298, 222.71041573807784, 5.218610253814608, 92.31688061967488, 181.62900738380426, 455.0933402635041, 275.0440038515708, 362.30166179532523, 221.01806312996604, 588.5585769639024, 190.08954777101863, 526.5222460531012, 371.09143485635514, 49.81732752525826, 426.95136165264006, 547.4302408279665, 58.27641590618546, 7.677943531504815, 246.10589949722117, 639.0406509223887, 452.9909303110386, 302.9241941874349, 240.24835463358733, 357.74748928304234, 55.387179481855064, 469.7321602417631, 148.5416441322606, 222.78000030756195, 33.2886709996197, 399.1956900624375, 248.01439794649923, 720.2994777384815, 634.8175860162943, 723.30525564907, 350.4762238006356, 7.676819000838551, 9.087557950705365, 38.0634880772038, 290.96053979777906, 798.2731275266842, 766.2116655357576, 371.3403317871297, 109.45367417221847, 499.98272241727614, 142.14237136677795, 325.5443795172418, 136.9166204903293, 61.8566802865929, 613.1952428325685, 13.270932532050336, 35.486580099514754, 340.26226994807627, 147.6823427870605, 238.32886682443342, 211.89520188303774, 160.42701279967048, 664.0207390512552, 219.34842335305856, 431.3265088322082, 731.1695837349042, 256.79454004644106, 73.56981179888224, 146.90306794509573, 87.82559764319973, 180.16180078017092, 113.96875166742107, 58.384647044903765, 17.20012132670792, 485.26677189564174, 556.6910282055142, 311.278442820417, 13.486945238629055, 21.05990518665846, 228.07828013595926, 163.92497839098303, 367.0577325505382, 575.1005485779993, 789.9416314733321, 281.12736840290864, 80.34380145155352, 136.56651151970703, 35.066709191810176, 35.49773668716253, 274.6803848876337, 717.7176753213453, 161.2248357201102, 75.31230615389055, 244.8342485051108, 291.77181206517133, 792.3668881561716, 607.5281364472121, 283.07518414890865, 515.9287153050478, 48.05857356030668, 158.13757186578957, 168.17509376166444, 342.4628019026611, 14.824452352836754, 435.5319890514334, 715.9535721099045, 104.3585202463641, 425.60062731313906, 171.49163356226012, 682.4634479957411, 222.88152857267997, 311.1404542629668, 431.893005618422, 826.4211046477199, 695.3551446427051, 425.58957822934127, 503.4176933129818, 383.28687063102376, 99.26689525816144, 23.81220942587755, 18.903889020139307]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.161049985126757, "mean_inference_ms": 4.437632366990913, "mean_action_processing_ms": 1.9042220411510618, "mean_env_wait_ms": 11.428384848645756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005817294120788574, "StateBufferConnector_ms": 0.00851905345916748, "ViewRequirementAgentConnector_ms": 0.14074409008026123}, "num_episodes": 24, "episode_return_max": 765.0, "episode_return_min": 17.114338646407063, "episode_return_mean": 288.4788131041011, "episodes_this_iter": 24}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 157.56646207646105, "num_env_steps_trained_throughput_per_sec": 157.56646207646105, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 26029.369, "restore_workers_time_ms": 0.035, "training_step_time_ms": 26029.097, "sample_time_ms": 2541.07, "learn_time_ms": 23462.389, "learn_throughput": 170.486, "synch_weights_time_ms": 21.228}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 19, "trial_id": "0b608_00000", "date": "2024-08-22_13-53-19", "timestamp": 1724314999, "time_this_iter_s": 25.412829160690308, "time_total_s": 493.85223627090454, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x312051550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 493.85223627090454, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 31.880555555555556, "ram_util_percent": 83.25833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.055146149731186, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.517433045402406, "policy_loss": -0.011137776359147023, "vf_loss": 7.5267037053587575, "vf_explained_var": 0.2773195719592786, "kl": 0.009335652671301018, "entropy": 0.840805187553325, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 18428.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000004}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.481757661905238, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.014126851823594, "policy_loss": -0.011945058565547385, "vf_loss": 8.02401035551041, "vf_explained_var": 0.13510287199070845, "kl": 0.01030781333576198, "entropy": 1.1458307687567655, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 18428.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000004}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 765.0, "episode_reward_min": 17.114338646407063, "episode_reward_mean": 273.41827615116074, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -919.1374409710456, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 379.36203860587045, "predator_policy": 826.4211046477199}, "policy_reward_mean": {"prey_policy": -118.39687491778658, "predator_policy": 255.1060129933669}, "custom_metrics": {}, "hist_stats": {"episode_reward": [459.3873551495944, 391.8999999999993, 206.06104766849165, 416.70000000000266, 199.77446177916863, 409.8436420916603, 369.06837484577466, 161.24917122154213, 285.4999999999992, 219.488903545024, 281.4177318772378, 73.70000000000009, 153.59999999999718, 414.33833344884647, 602.3545259526645, 473.8981910381608, 80.32757873855842, 313.9299409464846, 392.76614731014155, 268.3881584947542, 765.0, 473.1520312833473, 258.0700451541186, 50.298685823925624, 242.5963917054242, 320.50585053745556, 136.299999999997, 138.79999999999953, 302.45372032520925, 439.47703329549904, 305.04801026807945, 252.099999999998, 228.1999999999978, 365.50202773143917, 427.8128562266817, 270.1171086285664, 356.9428073083489, 245.2999999999985, 331.8124546679668, 252.5639320224987, 199.48483531280476, 211.14547891712346, 505.5044354142618, 490.45573107516674, 186.8888182128186, 350.2265058398085, 17.114338646407063, 294.30650338877376, 377.30000000000155, 223.4028065230839, 169.61765207459752, 446.9479381504879, 208.87605188223276, 273.5449280118687, 235.14439926411615, 70.49075840524122, 429.48445690416014, 285.62737185211256, 330.2127364375203, 435.0298826829429, 345.39051870437913, 277.6999999999996, 254.330551182291, 71.90000000000019, 219.36124369041477, 170.55595223975902, 79.6999999999997, 245.8572855450376, 306.95218401088977, 179.39046998953702, 595.4817255872756, 87.99310892578687, 199.82121166089155, 376.99259375865904, 238.89773567709696, 152.52724479833952, 265.1538152407152, 205.85723649927147, 223.9436478442211, 270.7585958816518, 142.70521788418662, 83.38026108098983, 365.0640637040232, 441.69796076515456, 209.30141058220215, 526.2224287333767, 177.6684012544004, 182.59999999999894, 187.1167355271229, 207.13094436867257, 343.23628087054055, 93.20000000000039, 90.7485473168235, 206.86546358083177, 107.50438327720171, 101.19383262373952, 162.13222918765382, 315.30000000000075, 231.7675412911204, 321.8746437496385], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-81.39414039512889, 20.71647967964509, 271.79798593827053, -5.396706046965797, 68.40116022399846, -90.5090478842511, 289.3861586594953, 68.17208970740376, -12.597544384837498, 73.72696675375026, 19.61652100816481, 60.184252500395075, -99.75554653185449, 86.41433754630884, -32.794562316643706, -72.5871166474991, 195.9757842942535, -149.73824072986423, -35.376249165734244, -174.52593702024285, -69.68105167306263, -44.53748182412454, 20.18341930362485, -91.8578932469275, -0.9665732908148345, -1.0432898911843553, -258.51127509698324, 209.00414166400046, 90.34382239644786, 258.90936533207974, -96.43567935424846, 4.96701086333146, -23.05270064551386, -1.7562396285943316, -75.42849880802908, -92.42156846190262, -18.840315841517707, -29.468714153014545, -77.949391098934, -120.87743542223464, 321.3473494628521, 379.36203860587045, 170.35569210186858, -40.75319408565777, -14.696006611569846, -230.74018616289428, -214.600282135419, -561.1802415278005, -435.69552140188165, -319.2993069611055, -309.3604957890383, 113.02168582021612, 33.80712486898351, -92.03459636689088, 46.32227986901313, 27.735921745615737, -344.3009532317802, 30.179210655208642, 88.28184759572243, -250.1334498125012, 31.762220347020882, 27.08489864579678, -109.7003323793771, 133.8713063874825, 96.976456038752, -142.72234404223286, -47.15665809005747, -317.4786582935746, -407.50025903668273, 251.99339033807397, -62.85732358249489, -445.67369252386135, -484.7058977304096, -55.96497587069842, -238.7700636602542, 7.301374482355689, -222.02986741922484, -51.864334646965304, -24.333537560295206, 23.113626554069487, -402.2019405140751, -490.34480540654516, -106.67694976973303, -225.35012013416593, 71.997045515706, 20.37272113365705, 162.9421414380604, -290.76021473691907, -166.77120655260558, 97.59135345824279, -82.31257768771275, -214.67100448141957, -717.1271095128706, -620.8756155954987, -317.89804818831243, -461.5769278726187, 31.723180999161624, 328.81244204929465, -120.60800463001493, 14.986783278117889, -475.72970001679676, -919.1374409710456, -306.1083063792472, 272.26223857038667, -53.09543997799224, -380.1536019238286, 71.05046971000407, -259.96654170570787, 122.43603910023702, -562.343562955282, 16.059807753978376, 5.673438019697681, 60.97846985390523, -119.43862568488309, -151.40570733086417, -13.19098952449376, 148.95392049165716, -643.188935905065, -280.31486107538717, 64.66981157306337, -578.9695837349047, -63.60402134206318, -37.092074486771736, 94.31919474279351, 34.03501269092392, -47.69185993200183, -79.36875166742291, -21.084647044903278, -281.0333652409874, -2.0722842909462695, -6.268410589051285, -691.145108197119, 25.51305476137101, 19.640094813341527, -52.57705468189713, -93.56891830000869, -146.45711430905857, -488.7489828085907, -396.503657383644, -495.1748725030613, 215.419232459669, 163.1521801563441, -10.036965981947958, 27.46562902876332, -7.313302201314867, -785.2635463467702, 87.7514443436249, 52.70400754103315, -55.68375008648778, -242.02457480669707, -766.7668881561716, -480.60089164887256, -129.74955528730268, -404.10052892593853, 25.175874378172058, -25.514783304996058, -56.82037981742464, -229.8738680026786, -90.19233338745833, -89.40551213516096, -94.93074129111986, -582.6761331809628, -412.7214327800315, -100.990567014377, 126.11015984957407, -666.391072713972, 42.19615496837693, -343.53165408461166, -765.0792139862236, -547.3956247219992, -41.653218596449555, -361.13162421249626, -281.36413572577544, -23.521228909007604, 120.28779057412213, 19.59611097986068, 27.080202800589127, -403.1356619850714, -153.45225353660067, 92.81810487834726, 245.43726993078513, -658.7492896484599, 34.1553542003817, -118.51075096381976, 18.536249590204953, -116.23889966419839, -535.4481678190834, -388.7119484955752, -304.9896899991549, -53.71622771960582, -53.47068185626676, -239.38032925469255, -425.8658759514346, -65.27538236298668, 219.127024105565, 1.1473860291220281, -141.2256479020429, 39.420908179150025, -65.83148452059693, -58.88906438053968], "policy_predator_policy_reward": [336.51120975352694, 183.553806111551, 32.90201406172944, 92.59670604696574, 173.34142415373003, 54.82751117501456, 11.41591511669615, 47.725836516404925, 121.53577457325493, 17.109264837000865, 250.42640790635983, 79.61646067674027, 195.34515822664744, 187.0644256046728, 24.797436631646207, 241.83341355403772, 50.72421570574651, 188.53824072986285, 146.5683409430558, 282.822748787946, 247.073835091675, 148.56243028274946, 18.31658069637516, 127.0578932469255, 38.86657329081512, 116.74328989118443, 49.73152566045534, 414.1139412213728, 0.0, 253.10133822413718, 34.59597247550811, 530.7708870535695, 58.652700645514365, 46.48381836715331, 134.2312416148527, 347.548766601562, 157.44022861668134, 283.63494868799046, 410.47208240570257, 56.742902610216355, 52.652650537147906, 11.63796139412958, 255.1019279460997, 88.4476053210329, 159.10622444943758, 344.4000134791466, 465.5750001962978, 360.5042092908465, 494.5749802314377, 503.0162398369744, 393.6869637455582, 123.15769676072057, 175.4707680512907, 19.056703446615767, 53.37772013098717, 11.364078254384365, 138.59107855956844, 477.9843843422121, 330.6648022917045, 270.663833220572, 39.2831990704309, 206.9176922048298, 222.71041573807784, 5.218610253814608, 92.31688061967488, 181.62900738380426, 455.0933402635041, 275.0440038515708, 362.30166179532523, 221.01806312996604, 588.5585769639024, 190.08954777101863, 526.5222460531012, 371.09143485635514, 49.81732752525826, 426.95136165264006, 547.4302408279665, 58.27641590618546, 7.677943531504815, 246.10589949722117, 639.0406509223887, 452.9909303110386, 302.9241941874349, 240.24835463358733, 357.74748928304234, 55.387179481855064, 469.7321602417631, 148.5416441322606, 222.78000030756195, 33.2886709996197, 399.1956900624375, 248.01439794649923, 720.2994777384815, 634.8175860162943, 723.30525564907, 350.4762238006356, 7.676819000838551, 9.087557950705365, 38.0634880772038, 290.96053979777906, 798.2731275266842, 766.2116655357576, 371.3403317871297, 109.45367417221847, 499.98272241727614, 142.14237136677795, 325.5443795172418, 136.9166204903293, 61.8566802865929, 613.1952428325685, 13.270932532050336, 35.486580099514754, 340.26226994807627, 147.6823427870605, 238.32886682443342, 211.89520188303774, 160.42701279967048, 664.0207390512552, 219.34842335305856, 431.3265088322082, 731.1695837349042, 256.79454004644106, 73.56981179888224, 146.90306794509573, 87.82559764319973, 180.16180078017092, 113.96875166742107, 58.384647044903765, 17.20012132670792, 485.26677189564174, 556.6910282055142, 311.278442820417, 13.486945238629055, 21.05990518665846, 228.07828013595926, 163.92497839098303, 367.0577325505382, 575.1005485779993, 789.9416314733321, 281.12736840290864, 80.34380145155352, 136.56651151970703, 35.066709191810176, 35.49773668716253, 274.6803848876337, 717.7176753213453, 161.2248357201102, 75.31230615389055, 244.8342485051108, 291.77181206517133, 792.3668881561716, 607.5281364472121, 283.07518414890865, 515.9287153050478, 48.05857356030668, 158.13757186578957, 168.17509376166444, 342.4628019026611, 14.824452352836754, 435.5319890514334, 715.9535721099045, 104.3585202463641, 425.60062731313906, 171.49163356226012, 682.4634479957411, 222.88152857267997, 311.1404542629668, 431.893005618422, 826.4211046477199, 695.3551446427051, 425.58957822934127, 503.4176933129818, 383.28687063102376, 99.26689525816144, 23.81220942587755, 18.903889020139307, 71.177529817613, 491.9946648939938, 250.33414865825017, 17.43094436867576, 710.5512614121568, 45.99703917605915, 15.344645799618307, 162.210750963818, 63.374362669246814, 125.07683472156923, 728.1097631280592, 402.91581676743345, 216.47493756488598, 249.73536343107506, 227.70992909968274, 166.3349146350163, 372.12953259714055, 281.1439549049344, 58.27297589443523, 36.75261397087822, 22.831958657459722, 310.7403223565553, 304.445586076619, 142.14960657415256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.192655199358783, "mean_inference_ms": 4.4454330607937695, "mean_action_processing_ms": 1.9810165148634837, "mean_env_wait_ms": 11.450449314452385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00563502311706543, "StateBufferConnector_ms": 0.008316993713378906, "ViewRequirementAgentConnector_ms": 0.13993465900421143}, "num_episodes": 12, "episode_return_max": 765.0, "episode_return_min": 17.114338646407063, "episode_return_mean": 273.41827615116074, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.79579563165743, "num_env_steps_trained_throughput_per_sec": 154.79579563165743, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 26037.593, "restore_workers_time_ms": 0.034, "training_step_time_ms": 26037.354, "sample_time_ms": 2518.02, "learn_time_ms": 23493.944, "learn_throughput": 170.257, "synch_weights_time_ms": 21.038}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 20, "trial_id": "0b608_00000", "date": "2024-08-22_13-53-45", "timestamp": 1724315025, "time_this_iter_s": 25.898133993148804, "time_total_s": 519.7503702640533, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3120875e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 519.7503702640533, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 32.95405405405406, "ram_util_percent": 83.16486486486485}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.118200218614447, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.623363456019649, "policy_loss": -0.012262783596715914, "vf_loss": 7.633540037952403, "vf_explained_var": 0.27164017554944153, "kl": 0.010431067921497204, "entropy": 0.7943302377821907, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19373.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.45838347995092, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.938598963823268, "policy_loss": -0.011899523667636372, "vf_loss": 7.948475093942471, "vf_explained_var": 0.11919763321599001, "kl": 0.010116944893721551, "entropy": 1.1282160144634348, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19373.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 765.0, "episode_reward_min": 17.114338646407063, "episode_reward_mean": 273.41827615116074, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -919.1374409710456, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 379.36203860587045, "predator_policy": 826.4211046477199}, "policy_reward_mean": {"prey_policy": -118.39687491778658, "predator_policy": 255.1060129933669}, "custom_metrics": {}, "hist_stats": {"episode_reward": [459.3873551495944, 391.8999999999993, 206.06104766849165, 416.70000000000266, 199.77446177916863, 409.8436420916603, 369.06837484577466, 161.24917122154213, 285.4999999999992, 219.488903545024, 281.4177318772378, 73.70000000000009, 153.59999999999718, 414.33833344884647, 602.3545259526645, 473.8981910381608, 80.32757873855842, 313.9299409464846, 392.76614731014155, 268.3881584947542, 765.0, 473.1520312833473, 258.0700451541186, 50.298685823925624, 242.5963917054242, 320.50585053745556, 136.299999999997, 138.79999999999953, 302.45372032520925, 439.47703329549904, 305.04801026807945, 252.099999999998, 228.1999999999978, 365.50202773143917, 427.8128562266817, 270.1171086285664, 356.9428073083489, 245.2999999999985, 331.8124546679668, 252.5639320224987, 199.48483531280476, 211.14547891712346, 505.5044354142618, 490.45573107516674, 186.8888182128186, 350.2265058398085, 17.114338646407063, 294.30650338877376, 377.30000000000155, 223.4028065230839, 169.61765207459752, 446.9479381504879, 208.87605188223276, 273.5449280118687, 235.14439926411615, 70.49075840524122, 429.48445690416014, 285.62737185211256, 330.2127364375203, 435.0298826829429, 345.39051870437913, 277.6999999999996, 254.330551182291, 71.90000000000019, 219.36124369041477, 170.55595223975902, 79.6999999999997, 245.8572855450376, 306.95218401088977, 179.39046998953702, 595.4817255872756, 87.99310892578687, 199.82121166089155, 376.99259375865904, 238.89773567709696, 152.52724479833952, 265.1538152407152, 205.85723649927147, 223.9436478442211, 270.7585958816518, 142.70521788418662, 83.38026108098983, 365.0640637040232, 441.69796076515456, 209.30141058220215, 526.2224287333767, 177.6684012544004, 182.59999999999894, 187.1167355271229, 207.13094436867257, 343.23628087054055, 93.20000000000039, 90.7485473168235, 206.86546358083177, 107.50438327720171, 101.19383262373952, 162.13222918765382, 315.30000000000075, 231.7675412911204, 321.8746437496385], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-81.39414039512889, 20.71647967964509, 271.79798593827053, -5.396706046965797, 68.40116022399846, -90.5090478842511, 289.3861586594953, 68.17208970740376, -12.597544384837498, 73.72696675375026, 19.61652100816481, 60.184252500395075, -99.75554653185449, 86.41433754630884, -32.794562316643706, -72.5871166474991, 195.9757842942535, -149.73824072986423, -35.376249165734244, -174.52593702024285, -69.68105167306263, -44.53748182412454, 20.18341930362485, -91.8578932469275, -0.9665732908148345, -1.0432898911843553, -258.51127509698324, 209.00414166400046, 90.34382239644786, 258.90936533207974, -96.43567935424846, 4.96701086333146, -23.05270064551386, -1.7562396285943316, -75.42849880802908, -92.42156846190262, -18.840315841517707, -29.468714153014545, -77.949391098934, -120.87743542223464, 321.3473494628521, 379.36203860587045, 170.35569210186858, -40.75319408565777, -14.696006611569846, -230.74018616289428, -214.600282135419, -561.1802415278005, -435.69552140188165, -319.2993069611055, -309.3604957890383, 113.02168582021612, 33.80712486898351, -92.03459636689088, 46.32227986901313, 27.735921745615737, -344.3009532317802, 30.179210655208642, 88.28184759572243, -250.1334498125012, 31.762220347020882, 27.08489864579678, -109.7003323793771, 133.8713063874825, 96.976456038752, -142.72234404223286, -47.15665809005747, -317.4786582935746, -407.50025903668273, 251.99339033807397, -62.85732358249489, -445.67369252386135, -484.7058977304096, -55.96497587069842, -238.7700636602542, 7.301374482355689, -222.02986741922484, -51.864334646965304, -24.333537560295206, 23.113626554069487, -402.2019405140751, -490.34480540654516, -106.67694976973303, -225.35012013416593, 71.997045515706, 20.37272113365705, 162.9421414380604, -290.76021473691907, -166.77120655260558, 97.59135345824279, -82.31257768771275, -214.67100448141957, -717.1271095128706, -620.8756155954987, -317.89804818831243, -461.5769278726187, 31.723180999161624, 328.81244204929465, -120.60800463001493, 14.986783278117889, -475.72970001679676, -919.1374409710456, -306.1083063792472, 272.26223857038667, -53.09543997799224, -380.1536019238286, 71.05046971000407, -259.96654170570787, 122.43603910023702, -562.343562955282, 16.059807753978376, 5.673438019697681, 60.97846985390523, -119.43862568488309, -151.40570733086417, -13.19098952449376, 148.95392049165716, -643.188935905065, -280.31486107538717, 64.66981157306337, -578.9695837349047, -63.60402134206318, -37.092074486771736, 94.31919474279351, 34.03501269092392, -47.69185993200183, -79.36875166742291, -21.084647044903278, -281.0333652409874, -2.0722842909462695, -6.268410589051285, -691.145108197119, 25.51305476137101, 19.640094813341527, -52.57705468189713, -93.56891830000869, -146.45711430905857, -488.7489828085907, -396.503657383644, -495.1748725030613, 215.419232459669, 163.1521801563441, -10.036965981947958, 27.46562902876332, -7.313302201314867, -785.2635463467702, 87.7514443436249, 52.70400754103315, -55.68375008648778, -242.02457480669707, -766.7668881561716, -480.60089164887256, -129.74955528730268, -404.10052892593853, 25.175874378172058, -25.514783304996058, -56.82037981742464, -229.8738680026786, -90.19233338745833, -89.40551213516096, -94.93074129111986, -582.6761331809628, -412.7214327800315, -100.990567014377, 126.11015984957407, -666.391072713972, 42.19615496837693, -343.53165408461166, -765.0792139862236, -547.3956247219992, -41.653218596449555, -361.13162421249626, -281.36413572577544, -23.521228909007604, 120.28779057412213, 19.59611097986068, 27.080202800589127, -403.1356619850714, -153.45225353660067, 92.81810487834726, 245.43726993078513, -658.7492896484599, 34.1553542003817, -118.51075096381976, 18.536249590204953, -116.23889966419839, -535.4481678190834, -388.7119484955752, -304.9896899991549, -53.71622771960582, -53.47068185626676, -239.38032925469255, -425.8658759514346, -65.27538236298668, 219.127024105565, 1.1473860291220281, -141.2256479020429, 39.420908179150025, -65.83148452059693, -58.88906438053968], "policy_predator_policy_reward": [336.51120975352694, 183.553806111551, 32.90201406172944, 92.59670604696574, 173.34142415373003, 54.82751117501456, 11.41591511669615, 47.725836516404925, 121.53577457325493, 17.109264837000865, 250.42640790635983, 79.61646067674027, 195.34515822664744, 187.0644256046728, 24.797436631646207, 241.83341355403772, 50.72421570574651, 188.53824072986285, 146.5683409430558, 282.822748787946, 247.073835091675, 148.56243028274946, 18.31658069637516, 127.0578932469255, 38.86657329081512, 116.74328989118443, 49.73152566045534, 414.1139412213728, 0.0, 253.10133822413718, 34.59597247550811, 530.7708870535695, 58.652700645514365, 46.48381836715331, 134.2312416148527, 347.548766601562, 157.44022861668134, 283.63494868799046, 410.47208240570257, 56.742902610216355, 52.652650537147906, 11.63796139412958, 255.1019279460997, 88.4476053210329, 159.10622444943758, 344.4000134791466, 465.5750001962978, 360.5042092908465, 494.5749802314377, 503.0162398369744, 393.6869637455582, 123.15769676072057, 175.4707680512907, 19.056703446615767, 53.37772013098717, 11.364078254384365, 138.59107855956844, 477.9843843422121, 330.6648022917045, 270.663833220572, 39.2831990704309, 206.9176922048298, 222.71041573807784, 5.218610253814608, 92.31688061967488, 181.62900738380426, 455.0933402635041, 275.0440038515708, 362.30166179532523, 221.01806312996604, 588.5585769639024, 190.08954777101863, 526.5222460531012, 371.09143485635514, 49.81732752525826, 426.95136165264006, 547.4302408279665, 58.27641590618546, 7.677943531504815, 246.10589949722117, 639.0406509223887, 452.9909303110386, 302.9241941874349, 240.24835463358733, 357.74748928304234, 55.387179481855064, 469.7321602417631, 148.5416441322606, 222.78000030756195, 33.2886709996197, 399.1956900624375, 248.01439794649923, 720.2994777384815, 634.8175860162943, 723.30525564907, 350.4762238006356, 7.676819000838551, 9.087557950705365, 38.0634880772038, 290.96053979777906, 798.2731275266842, 766.2116655357576, 371.3403317871297, 109.45367417221847, 499.98272241727614, 142.14237136677795, 325.5443795172418, 136.9166204903293, 61.8566802865929, 613.1952428325685, 13.270932532050336, 35.486580099514754, 340.26226994807627, 147.6823427870605, 238.32886682443342, 211.89520188303774, 160.42701279967048, 664.0207390512552, 219.34842335305856, 431.3265088322082, 731.1695837349042, 256.79454004644106, 73.56981179888224, 146.90306794509573, 87.82559764319973, 180.16180078017092, 113.96875166742107, 58.384647044903765, 17.20012132670792, 485.26677189564174, 556.6910282055142, 311.278442820417, 13.486945238629055, 21.05990518665846, 228.07828013595926, 163.92497839098303, 367.0577325505382, 575.1005485779993, 789.9416314733321, 281.12736840290864, 80.34380145155352, 136.56651151970703, 35.066709191810176, 35.49773668716253, 274.6803848876337, 717.7176753213453, 161.2248357201102, 75.31230615389055, 244.8342485051108, 291.77181206517133, 792.3668881561716, 607.5281364472121, 283.07518414890865, 515.9287153050478, 48.05857356030668, 158.13757186578957, 168.17509376166444, 342.4628019026611, 14.824452352836754, 435.5319890514334, 715.9535721099045, 104.3585202463641, 425.60062731313906, 171.49163356226012, 682.4634479957411, 222.88152857267997, 311.1404542629668, 431.893005618422, 826.4211046477199, 695.3551446427051, 425.58957822934127, 503.4176933129818, 383.28687063102376, 99.26689525816144, 23.81220942587755, 18.903889020139307, 71.177529817613, 491.9946648939938, 250.33414865825017, 17.43094436867576, 710.5512614121568, 45.99703917605915, 15.344645799618307, 162.210750963818, 63.374362669246814, 125.07683472156923, 728.1097631280592, 402.91581676743345, 216.47493756488598, 249.73536343107506, 227.70992909968274, 166.3349146350163, 372.12953259714055, 281.1439549049344, 58.27297589443523, 36.75261397087822, 22.831958657459722, 310.7403223565553, 304.445586076619, 142.14960657415256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.192655199358783, "mean_inference_ms": 4.4454330607937695, "mean_action_processing_ms": 1.9810165148634837, "mean_env_wait_ms": 11.450449314452385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00563502311706543, "StateBufferConnector_ms": 0.008316993713378906, "ViewRequirementAgentConnector_ms": 0.13993465900421143}, "num_episodes": 0, "episode_return_max": 765.0, "episode_return_min": 17.114338646407063, "episode_return_mean": 273.41827615116074, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.02001479367254, "num_env_steps_trained_throughput_per_sec": 156.02001479367254, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 25982.075, "restore_workers_time_ms": 0.035, "training_step_time_ms": 25981.832, "sample_time_ms": 2512.477, "learn_time_ms": 23444.376, "learn_throughput": 170.617, "synch_weights_time_ms": 20.706}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 21, "trial_id": "0b608_00000", "date": "2024-08-22_13-54-11", "timestamp": 1724315051, "time_this_iter_s": 25.674659252166748, "time_total_s": 545.4250295162201, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3120818b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 545.4250295162201, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 32.80833333333334, "ram_util_percent": 83.1388888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.123941724388688, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.583582243843684, "policy_loss": -0.01022803817959453, "vf_loss": 7.592021624247233, "vf_explained_var": 0.30983055098346934, "kl": 0.008943434956202667, "entropy": 0.7859817476499649, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 20318.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.531562308911925, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.999698332630137, "policy_loss": -0.012491026602527768, "vf_loss": 8.009901815747458, "vf_explained_var": 0.18419337102345057, "kl": 0.011437797485776837, "entropy": 1.113156690357854, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 20318.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 765.0, "episode_reward_min": 17.114338646407063, "episode_reward_mean": 273.41827615116074, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -919.1374409710456, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 379.36203860587045, "predator_policy": 826.4211046477199}, "policy_reward_mean": {"prey_policy": -118.39687491778658, "predator_policy": 255.1060129933669}, "custom_metrics": {}, "hist_stats": {"episode_reward": [459.3873551495944, 391.8999999999993, 206.06104766849165, 416.70000000000266, 199.77446177916863, 409.8436420916603, 369.06837484577466, 161.24917122154213, 285.4999999999992, 219.488903545024, 281.4177318772378, 73.70000000000009, 153.59999999999718, 414.33833344884647, 602.3545259526645, 473.8981910381608, 80.32757873855842, 313.9299409464846, 392.76614731014155, 268.3881584947542, 765.0, 473.1520312833473, 258.0700451541186, 50.298685823925624, 242.5963917054242, 320.50585053745556, 136.299999999997, 138.79999999999953, 302.45372032520925, 439.47703329549904, 305.04801026807945, 252.099999999998, 228.1999999999978, 365.50202773143917, 427.8128562266817, 270.1171086285664, 356.9428073083489, 245.2999999999985, 331.8124546679668, 252.5639320224987, 199.48483531280476, 211.14547891712346, 505.5044354142618, 490.45573107516674, 186.8888182128186, 350.2265058398085, 17.114338646407063, 294.30650338877376, 377.30000000000155, 223.4028065230839, 169.61765207459752, 446.9479381504879, 208.87605188223276, 273.5449280118687, 235.14439926411615, 70.49075840524122, 429.48445690416014, 285.62737185211256, 330.2127364375203, 435.0298826829429, 345.39051870437913, 277.6999999999996, 254.330551182291, 71.90000000000019, 219.36124369041477, 170.55595223975902, 79.6999999999997, 245.8572855450376, 306.95218401088977, 179.39046998953702, 595.4817255872756, 87.99310892578687, 199.82121166089155, 376.99259375865904, 238.89773567709696, 152.52724479833952, 265.1538152407152, 205.85723649927147, 223.9436478442211, 270.7585958816518, 142.70521788418662, 83.38026108098983, 365.0640637040232, 441.69796076515456, 209.30141058220215, 526.2224287333767, 177.6684012544004, 182.59999999999894, 187.1167355271229, 207.13094436867257, 343.23628087054055, 93.20000000000039, 90.7485473168235, 206.86546358083177, 107.50438327720171, 101.19383262373952, 162.13222918765382, 315.30000000000075, 231.7675412911204, 321.8746437496385], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-81.39414039512889, 20.71647967964509, 271.79798593827053, -5.396706046965797, 68.40116022399846, -90.5090478842511, 289.3861586594953, 68.17208970740376, -12.597544384837498, 73.72696675375026, 19.61652100816481, 60.184252500395075, -99.75554653185449, 86.41433754630884, -32.794562316643706, -72.5871166474991, 195.9757842942535, -149.73824072986423, -35.376249165734244, -174.52593702024285, -69.68105167306263, -44.53748182412454, 20.18341930362485, -91.8578932469275, -0.9665732908148345, -1.0432898911843553, -258.51127509698324, 209.00414166400046, 90.34382239644786, 258.90936533207974, -96.43567935424846, 4.96701086333146, -23.05270064551386, -1.7562396285943316, -75.42849880802908, -92.42156846190262, -18.840315841517707, -29.468714153014545, -77.949391098934, -120.87743542223464, 321.3473494628521, 379.36203860587045, 170.35569210186858, -40.75319408565777, -14.696006611569846, -230.74018616289428, -214.600282135419, -561.1802415278005, -435.69552140188165, -319.2993069611055, -309.3604957890383, 113.02168582021612, 33.80712486898351, -92.03459636689088, 46.32227986901313, 27.735921745615737, -344.3009532317802, 30.179210655208642, 88.28184759572243, -250.1334498125012, 31.762220347020882, 27.08489864579678, -109.7003323793771, 133.8713063874825, 96.976456038752, -142.72234404223286, -47.15665809005747, -317.4786582935746, -407.50025903668273, 251.99339033807397, -62.85732358249489, -445.67369252386135, -484.7058977304096, -55.96497587069842, -238.7700636602542, 7.301374482355689, -222.02986741922484, -51.864334646965304, -24.333537560295206, 23.113626554069487, -402.2019405140751, -490.34480540654516, -106.67694976973303, -225.35012013416593, 71.997045515706, 20.37272113365705, 162.9421414380604, -290.76021473691907, -166.77120655260558, 97.59135345824279, -82.31257768771275, -214.67100448141957, -717.1271095128706, -620.8756155954987, -317.89804818831243, -461.5769278726187, 31.723180999161624, 328.81244204929465, -120.60800463001493, 14.986783278117889, -475.72970001679676, -919.1374409710456, -306.1083063792472, 272.26223857038667, -53.09543997799224, -380.1536019238286, 71.05046971000407, -259.96654170570787, 122.43603910023702, -562.343562955282, 16.059807753978376, 5.673438019697681, 60.97846985390523, -119.43862568488309, -151.40570733086417, -13.19098952449376, 148.95392049165716, -643.188935905065, -280.31486107538717, 64.66981157306337, -578.9695837349047, -63.60402134206318, -37.092074486771736, 94.31919474279351, 34.03501269092392, -47.69185993200183, -79.36875166742291, -21.084647044903278, -281.0333652409874, -2.0722842909462695, -6.268410589051285, -691.145108197119, 25.51305476137101, 19.640094813341527, -52.57705468189713, -93.56891830000869, -146.45711430905857, -488.7489828085907, -396.503657383644, -495.1748725030613, 215.419232459669, 163.1521801563441, -10.036965981947958, 27.46562902876332, -7.313302201314867, -785.2635463467702, 87.7514443436249, 52.70400754103315, -55.68375008648778, -242.02457480669707, -766.7668881561716, -480.60089164887256, -129.74955528730268, -404.10052892593853, 25.175874378172058, -25.514783304996058, -56.82037981742464, -229.8738680026786, -90.19233338745833, -89.40551213516096, -94.93074129111986, -582.6761331809628, -412.7214327800315, -100.990567014377, 126.11015984957407, -666.391072713972, 42.19615496837693, -343.53165408461166, -765.0792139862236, -547.3956247219992, -41.653218596449555, -361.13162421249626, -281.36413572577544, -23.521228909007604, 120.28779057412213, 19.59611097986068, 27.080202800589127, -403.1356619850714, -153.45225353660067, 92.81810487834726, 245.43726993078513, -658.7492896484599, 34.1553542003817, -118.51075096381976, 18.536249590204953, -116.23889966419839, -535.4481678190834, -388.7119484955752, -304.9896899991549, -53.71622771960582, -53.47068185626676, -239.38032925469255, -425.8658759514346, -65.27538236298668, 219.127024105565, 1.1473860291220281, -141.2256479020429, 39.420908179150025, -65.83148452059693, -58.88906438053968], "policy_predator_policy_reward": [336.51120975352694, 183.553806111551, 32.90201406172944, 92.59670604696574, 173.34142415373003, 54.82751117501456, 11.41591511669615, 47.725836516404925, 121.53577457325493, 17.109264837000865, 250.42640790635983, 79.61646067674027, 195.34515822664744, 187.0644256046728, 24.797436631646207, 241.83341355403772, 50.72421570574651, 188.53824072986285, 146.5683409430558, 282.822748787946, 247.073835091675, 148.56243028274946, 18.31658069637516, 127.0578932469255, 38.86657329081512, 116.74328989118443, 49.73152566045534, 414.1139412213728, 0.0, 253.10133822413718, 34.59597247550811, 530.7708870535695, 58.652700645514365, 46.48381836715331, 134.2312416148527, 347.548766601562, 157.44022861668134, 283.63494868799046, 410.47208240570257, 56.742902610216355, 52.652650537147906, 11.63796139412958, 255.1019279460997, 88.4476053210329, 159.10622444943758, 344.4000134791466, 465.5750001962978, 360.5042092908465, 494.5749802314377, 503.0162398369744, 393.6869637455582, 123.15769676072057, 175.4707680512907, 19.056703446615767, 53.37772013098717, 11.364078254384365, 138.59107855956844, 477.9843843422121, 330.6648022917045, 270.663833220572, 39.2831990704309, 206.9176922048298, 222.71041573807784, 5.218610253814608, 92.31688061967488, 181.62900738380426, 455.0933402635041, 275.0440038515708, 362.30166179532523, 221.01806312996604, 588.5585769639024, 190.08954777101863, 526.5222460531012, 371.09143485635514, 49.81732752525826, 426.95136165264006, 547.4302408279665, 58.27641590618546, 7.677943531504815, 246.10589949722117, 639.0406509223887, 452.9909303110386, 302.9241941874349, 240.24835463358733, 357.74748928304234, 55.387179481855064, 469.7321602417631, 148.5416441322606, 222.78000030756195, 33.2886709996197, 399.1956900624375, 248.01439794649923, 720.2994777384815, 634.8175860162943, 723.30525564907, 350.4762238006356, 7.676819000838551, 9.087557950705365, 38.0634880772038, 290.96053979777906, 798.2731275266842, 766.2116655357576, 371.3403317871297, 109.45367417221847, 499.98272241727614, 142.14237136677795, 325.5443795172418, 136.9166204903293, 61.8566802865929, 613.1952428325685, 13.270932532050336, 35.486580099514754, 340.26226994807627, 147.6823427870605, 238.32886682443342, 211.89520188303774, 160.42701279967048, 664.0207390512552, 219.34842335305856, 431.3265088322082, 731.1695837349042, 256.79454004644106, 73.56981179888224, 146.90306794509573, 87.82559764319973, 180.16180078017092, 113.96875166742107, 58.384647044903765, 17.20012132670792, 485.26677189564174, 556.6910282055142, 311.278442820417, 13.486945238629055, 21.05990518665846, 228.07828013595926, 163.92497839098303, 367.0577325505382, 575.1005485779993, 789.9416314733321, 281.12736840290864, 80.34380145155352, 136.56651151970703, 35.066709191810176, 35.49773668716253, 274.6803848876337, 717.7176753213453, 161.2248357201102, 75.31230615389055, 244.8342485051108, 291.77181206517133, 792.3668881561716, 607.5281364472121, 283.07518414890865, 515.9287153050478, 48.05857356030668, 158.13757186578957, 168.17509376166444, 342.4628019026611, 14.824452352836754, 435.5319890514334, 715.9535721099045, 104.3585202463641, 425.60062731313906, 171.49163356226012, 682.4634479957411, 222.88152857267997, 311.1404542629668, 431.893005618422, 826.4211046477199, 695.3551446427051, 425.58957822934127, 503.4176933129818, 383.28687063102376, 99.26689525816144, 23.81220942587755, 18.903889020139307, 71.177529817613, 491.9946648939938, 250.33414865825017, 17.43094436867576, 710.5512614121568, 45.99703917605915, 15.344645799618307, 162.210750963818, 63.374362669246814, 125.07683472156923, 728.1097631280592, 402.91581676743345, 216.47493756488598, 249.73536343107506, 227.70992909968274, 166.3349146350163, 372.12953259714055, 281.1439549049344, 58.27297589443523, 36.75261397087822, 22.831958657459722, 310.7403223565553, 304.445586076619, 142.14960657415256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.192655199358783, "mean_inference_ms": 4.4454330607937695, "mean_action_processing_ms": 1.9810165148634837, "mean_env_wait_ms": 11.450449314452385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00563502311706543, "StateBufferConnector_ms": 0.008316993713378906, "ViewRequirementAgentConnector_ms": 0.13993465900421143}, "num_episodes": 0, "episode_return_max": 765.0, "episode_return_min": 17.114338646407063, "episode_return_mean": 273.41827615116074, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 157.44342866363124, "num_env_steps_trained_throughput_per_sec": 157.44342866363124, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 25945.291, "restore_workers_time_ms": 0.035, "training_step_time_ms": 25945.018, "sample_time_ms": 2488.954, "learn_time_ms": 23431.685, "learn_throughput": 170.709, "synch_weights_time_ms": 20.21}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 22, "trial_id": "0b608_00000", "date": "2024-08-22_13-54-37", "timestamp": 1724315077, "time_this_iter_s": 25.471426010131836, "time_total_s": 570.8964555263519, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x312087940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 570.8964555263519, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 31.77777777777778, "ram_util_percent": 82.86944444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.743273516180654, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.742408732257823, "policy_loss": -0.010573104588147352, "vf_loss": 7.751097791157072, "vf_explained_var": 0.3322761313625114, "kl": 0.009420299857224106, "entropy": 0.7473178658535872, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21263.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.976283338713268, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.059959004921888, "policy_loss": -0.010983324482563943, "vf_loss": 8.068762870061965, "vf_explained_var": 0.2370189770819649, "kl": 0.010897363421246016, "entropy": 1.1242507100736023, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21263.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 765.0, "episode_reward_min": 17.114338646407063, "episode_reward_mean": 270.5818639993668, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -919.1374409710456, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 379.36203860587045, "predator_policy": 826.4211046477199}, "policy_reward_mean": {"prey_policy": -120.39256979248519, "predator_policy": 255.68350179216853}, "custom_metrics": {}, "hist_stats": {"episode_reward": [391.8999999999993, 206.06104766849165, 416.70000000000266, 199.77446177916863, 409.8436420916603, 369.06837484577466, 161.24917122154213, 285.4999999999992, 219.488903545024, 281.4177318772378, 73.70000000000009, 153.59999999999718, 414.33833344884647, 602.3545259526645, 473.8981910381608, 80.32757873855842, 313.9299409464846, 392.76614731014155, 268.3881584947542, 765.0, 473.1520312833473, 258.0700451541186, 50.298685823925624, 242.5963917054242, 320.50585053745556, 136.299999999997, 138.79999999999953, 302.45372032520925, 439.47703329549904, 305.04801026807945, 252.099999999998, 228.1999999999978, 365.50202773143917, 427.8128562266817, 270.1171086285664, 356.9428073083489, 245.2999999999985, 331.8124546679668, 252.5639320224987, 199.48483531280476, 211.14547891712346, 505.5044354142618, 490.45573107516674, 186.8888182128186, 350.2265058398085, 17.114338646407063, 294.30650338877376, 377.30000000000155, 223.4028065230839, 169.61765207459752, 446.9479381504879, 208.87605188223276, 273.5449280118687, 235.14439926411615, 70.49075840524122, 429.48445690416014, 285.62737185211256, 330.2127364375203, 435.0298826829429, 345.39051870437913, 277.6999999999996, 254.330551182291, 71.90000000000019, 219.36124369041477, 170.55595223975902, 79.6999999999997, 245.8572855450376, 306.95218401088977, 179.39046998953702, 595.4817255872756, 87.99310892578687, 199.82121166089155, 376.99259375865904, 238.89773567709696, 152.52724479833952, 265.1538152407152, 205.85723649927147, 223.9436478442211, 270.7585958816518, 142.70521788418662, 83.38026108098983, 365.0640637040232, 441.69796076515456, 209.30141058220215, 526.2224287333767, 177.6684012544004, 182.59999999999894, 187.1167355271229, 207.13094436867257, 343.23628087054055, 93.20000000000039, 90.7485473168235, 206.86546358083177, 107.50438327720171, 101.19383262373952, 162.13222918765382, 315.30000000000075, 231.7675412911204, 321.8746437496385, 175.74613997019708], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [271.79798593827053, -5.396706046965797, 68.40116022399846, -90.5090478842511, 289.3861586594953, 68.17208970740376, -12.597544384837498, 73.72696675375026, 19.61652100816481, 60.184252500395075, -99.75554653185449, 86.41433754630884, -32.794562316643706, -72.5871166474991, 195.9757842942535, -149.73824072986423, -35.376249165734244, -174.52593702024285, -69.68105167306263, -44.53748182412454, 20.18341930362485, -91.8578932469275, -0.9665732908148345, -1.0432898911843553, -258.51127509698324, 209.00414166400046, 90.34382239644786, 258.90936533207974, -96.43567935424846, 4.96701086333146, -23.05270064551386, -1.7562396285943316, -75.42849880802908, -92.42156846190262, -18.840315841517707, -29.468714153014545, -77.949391098934, -120.87743542223464, 321.3473494628521, 379.36203860587045, 170.35569210186858, -40.75319408565777, -14.696006611569846, -230.74018616289428, -214.600282135419, -561.1802415278005, -435.69552140188165, -319.2993069611055, -309.3604957890383, 113.02168582021612, 33.80712486898351, -92.03459636689088, 46.32227986901313, 27.735921745615737, -344.3009532317802, 30.179210655208642, 88.28184759572243, -250.1334498125012, 31.762220347020882, 27.08489864579678, -109.7003323793771, 133.8713063874825, 96.976456038752, -142.72234404223286, -47.15665809005747, -317.4786582935746, -407.50025903668273, 251.99339033807397, -62.85732358249489, -445.67369252386135, -484.7058977304096, -55.96497587069842, -238.7700636602542, 7.301374482355689, -222.02986741922484, -51.864334646965304, -24.333537560295206, 23.113626554069487, -402.2019405140751, -490.34480540654516, -106.67694976973303, -225.35012013416593, 71.997045515706, 20.37272113365705, 162.9421414380604, -290.76021473691907, -166.77120655260558, 97.59135345824279, -82.31257768771275, -214.67100448141957, -717.1271095128706, -620.8756155954987, -317.89804818831243, -461.5769278726187, 31.723180999161624, 328.81244204929465, -120.60800463001493, 14.986783278117889, -475.72970001679676, -919.1374409710456, -306.1083063792472, 272.26223857038667, -53.09543997799224, -380.1536019238286, 71.05046971000407, -259.96654170570787, 122.43603910023702, -562.343562955282, 16.059807753978376, 5.673438019697681, 60.97846985390523, -119.43862568488309, -151.40570733086417, -13.19098952449376, 148.95392049165716, -643.188935905065, -280.31486107538717, 64.66981157306337, -578.9695837349047, -63.60402134206318, -37.092074486771736, 94.31919474279351, 34.03501269092392, -47.69185993200183, -79.36875166742291, -21.084647044903278, -281.0333652409874, -2.0722842909462695, -6.268410589051285, -691.145108197119, 25.51305476137101, 19.640094813341527, -52.57705468189713, -93.56891830000869, -146.45711430905857, -488.7489828085907, -396.503657383644, -495.1748725030613, 215.419232459669, 163.1521801563441, -10.036965981947958, 27.46562902876332, -7.313302201314867, -785.2635463467702, 87.7514443436249, 52.70400754103315, -55.68375008648778, -242.02457480669707, -766.7668881561716, -480.60089164887256, -129.74955528730268, -404.10052892593853, 25.175874378172058, -25.514783304996058, -56.82037981742464, -229.8738680026786, -90.19233338745833, -89.40551213516096, -94.93074129111986, -582.6761331809628, -412.7214327800315, -100.990567014377, 126.11015984957407, -666.391072713972, 42.19615496837693, -343.53165408461166, -765.0792139862236, -547.3956247219992, -41.653218596449555, -361.13162421249626, -281.36413572577544, -23.521228909007604, 120.28779057412213, 19.59611097986068, 27.080202800589127, -403.1356619850714, -153.45225353660067, 92.81810487834726, 245.43726993078513, -658.7492896484599, 34.1553542003817, -118.51075096381976, 18.536249590204953, -116.23889966419839, -535.4481678190834, -388.7119484955752, -304.9896899991549, -53.71622771960582, -53.47068185626676, -239.38032925469255, -425.8658759514346, -65.27538236298668, 219.127024105565, 1.1473860291220281, -141.2256479020429, 39.420908179150025, -65.83148452059693, -58.88906438053968, -41.57623647727301, -418.24039917793306], "policy_predator_policy_reward": [32.90201406172944, 92.59670604696574, 173.34142415373003, 54.82751117501456, 11.41591511669615, 47.725836516404925, 121.53577457325493, 17.109264837000865, 250.42640790635983, 79.61646067674027, 195.34515822664744, 187.0644256046728, 24.797436631646207, 241.83341355403772, 50.72421570574651, 188.53824072986285, 146.5683409430558, 282.822748787946, 247.073835091675, 148.56243028274946, 18.31658069637516, 127.0578932469255, 38.86657329081512, 116.74328989118443, 49.73152566045534, 414.1139412213728, 0.0, 253.10133822413718, 34.59597247550811, 530.7708870535695, 58.652700645514365, 46.48381836715331, 134.2312416148527, 347.548766601562, 157.44022861668134, 283.63494868799046, 410.47208240570257, 56.742902610216355, 52.652650537147906, 11.63796139412958, 255.1019279460997, 88.4476053210329, 159.10622444943758, 344.4000134791466, 465.5750001962978, 360.5042092908465, 494.5749802314377, 503.0162398369744, 393.6869637455582, 123.15769676072057, 175.4707680512907, 19.056703446615767, 53.37772013098717, 11.364078254384365, 138.59107855956844, 477.9843843422121, 330.6648022917045, 270.663833220572, 39.2831990704309, 206.9176922048298, 222.71041573807784, 5.218610253814608, 92.31688061967488, 181.62900738380426, 455.0933402635041, 275.0440038515708, 362.30166179532523, 221.01806312996604, 588.5585769639024, 190.08954777101863, 526.5222460531012, 371.09143485635514, 49.81732752525826, 426.95136165264006, 547.4302408279665, 58.27641590618546, 7.677943531504815, 246.10589949722117, 639.0406509223887, 452.9909303110386, 302.9241941874349, 240.24835463358733, 357.74748928304234, 55.387179481855064, 469.7321602417631, 148.5416441322606, 222.78000030756195, 33.2886709996197, 399.1956900624375, 248.01439794649923, 720.2994777384815, 634.8175860162943, 723.30525564907, 350.4762238006356, 7.676819000838551, 9.087557950705365, 38.0634880772038, 290.96053979777906, 798.2731275266842, 766.2116655357576, 371.3403317871297, 109.45367417221847, 499.98272241727614, 142.14237136677795, 325.5443795172418, 136.9166204903293, 61.8566802865929, 613.1952428325685, 13.270932532050336, 35.486580099514754, 340.26226994807627, 147.6823427870605, 238.32886682443342, 211.89520188303774, 160.42701279967048, 664.0207390512552, 219.34842335305856, 431.3265088322082, 731.1695837349042, 256.79454004644106, 73.56981179888224, 146.90306794509573, 87.82559764319973, 180.16180078017092, 113.96875166742107, 58.384647044903765, 17.20012132670792, 485.26677189564174, 556.6910282055142, 311.278442820417, 13.486945238629055, 21.05990518665846, 228.07828013595926, 163.92497839098303, 367.0577325505382, 575.1005485779993, 789.9416314733321, 281.12736840290864, 80.34380145155352, 136.56651151970703, 35.066709191810176, 35.49773668716253, 274.6803848876337, 717.7176753213453, 161.2248357201102, 75.31230615389055, 244.8342485051108, 291.77181206517133, 792.3668881561716, 607.5281364472121, 283.07518414890865, 515.9287153050478, 48.05857356030668, 158.13757186578957, 168.17509376166444, 342.4628019026611, 14.824452352836754, 435.5319890514334, 715.9535721099045, 104.3585202463641, 425.60062731313906, 171.49163356226012, 682.4634479957411, 222.88152857267997, 311.1404542629668, 431.893005618422, 826.4211046477199, 695.3551446427051, 425.58957822934127, 503.4176933129818, 383.28687063102376, 99.26689525816144, 23.81220942587755, 18.903889020139307, 71.177529817613, 491.9946648939938, 250.33414865825017, 17.43094436867576, 710.5512614121568, 45.99703917605915, 15.344645799618307, 162.210750963818, 63.374362669246814, 125.07683472156923, 728.1097631280592, 402.91581676743345, 216.47493756488598, 249.73536343107506, 227.70992909968274, 166.3349146350163, 372.12953259714055, 281.1439549049344, 58.27297589443523, 36.75261397087822, 22.831958657459722, 310.7403223565553, 304.445586076619, 142.14960657415256, 279.47281802283396, 356.08995760257227]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.189320736651558, "mean_inference_ms": 4.448487991076564, "mean_action_processing_ms": 1.990495324439905, "mean_env_wait_ms": 11.450686792640633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005662202835083008, "StateBufferConnector_ms": 0.00832521915435791, "ViewRequirementAgentConnector_ms": 0.1402801275253296}, "num_episodes": 1, "episode_return_max": 765.0, "episode_return_min": 17.114338646407063, "episode_return_mean": 270.5818639993668, "episodes_this_iter": 1}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.9263378778285, "num_env_steps_trained_throughput_per_sec": 155.9263378778285, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 25926.831, "restore_workers_time_ms": 0.034, "training_step_time_ms": 25926.562, "sample_time_ms": 2489.458, "learn_time_ms": 23412.592, "learn_throughput": 170.848, "synch_weights_time_ms": 20.403}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 23, "trial_id": "0b608_00000", "date": "2024-08-22_13-55-02", "timestamp": 1724315102, "time_this_iter_s": 25.693796634674072, "time_total_s": 596.590252161026, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a34a5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 596.590252161026, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 31.340540540540545, "ram_util_percent": 83.2837837837838}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.732347112105637, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.655310587908225, "policy_loss": -0.006572666968263331, "vf_loss": 7.660286733839247, "vf_explained_var": 0.3533106085484621, "kl": 0.007982569656251048, "entropy": 0.745663842826924, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 22208.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.64982183837386, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.81082297532016, "policy_loss": -0.009204535638893802, "vf_loss": 7.818056367440199, "vf_explained_var": 0.3385557384718032, "kl": 0.009855868606015094, "entropy": 1.1074908470981335, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 22208.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 765.0, "episode_reward_min": 17.114338646407063, "episode_reward_mean": 263.129300439228, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1079.3191261147874, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 379.36203860587045, "predator_policy": 1135.3207319820938}, "policy_reward_mean": {"prey_policy": -149.4288388572674, "predator_policy": 280.99348907688136}, "custom_metrics": {}, "hist_stats": {"episode_reward": [369.06837484577466, 161.24917122154213, 285.4999999999992, 219.488903545024, 281.4177318772378, 73.70000000000009, 153.59999999999718, 414.33833344884647, 602.3545259526645, 473.8981910381608, 80.32757873855842, 313.9299409464846, 392.76614731014155, 268.3881584947542, 765.0, 473.1520312833473, 258.0700451541186, 50.298685823925624, 242.5963917054242, 320.50585053745556, 136.299999999997, 138.79999999999953, 302.45372032520925, 439.47703329549904, 305.04801026807945, 252.099999999998, 228.1999999999978, 365.50202773143917, 427.8128562266817, 270.1171086285664, 356.9428073083489, 245.2999999999985, 331.8124546679668, 252.5639320224987, 199.48483531280476, 211.14547891712346, 505.5044354142618, 490.45573107516674, 186.8888182128186, 350.2265058398085, 17.114338646407063, 294.30650338877376, 377.30000000000155, 223.4028065230839, 169.61765207459752, 446.9479381504879, 208.87605188223276, 273.5449280118687, 235.14439926411615, 70.49075840524122, 429.48445690416014, 285.62737185211256, 330.2127364375203, 435.0298826829429, 345.39051870437913, 277.6999999999996, 254.330551182291, 71.90000000000019, 219.36124369041477, 170.55595223975902, 79.6999999999997, 245.8572855450376, 306.95218401088977, 179.39046998953702, 595.4817255872756, 87.99310892578687, 199.82121166089155, 376.99259375865904, 238.89773567709696, 152.52724479833952, 265.1538152407152, 205.85723649927147, 223.9436478442211, 270.7585958816518, 142.70521788418662, 83.38026108098983, 365.0640637040232, 441.69796076515456, 209.30141058220215, 526.2224287333767, 177.6684012544004, 182.59999999999894, 187.1167355271229, 207.13094436867257, 343.23628087054055, 93.20000000000039, 90.7485473168235, 206.86546358083177, 107.50438327720171, 101.19383262373952, 162.13222918765382, 315.30000000000075, 231.7675412911204, 321.8746437496385, 175.74613997019708, 88.71578619086145, 72.50000000000016, 62.91611652351712, 251.4483098820457, 403.4425829290176], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-99.75554653185449, 86.41433754630884, -32.794562316643706, -72.5871166474991, 195.9757842942535, -149.73824072986423, -35.376249165734244, -174.52593702024285, -69.68105167306263, -44.53748182412454, 20.18341930362485, -91.8578932469275, -0.9665732908148345, -1.0432898911843553, -258.51127509698324, 209.00414166400046, 90.34382239644786, 258.90936533207974, -96.43567935424846, 4.96701086333146, -23.05270064551386, -1.7562396285943316, -75.42849880802908, -92.42156846190262, -18.840315841517707, -29.468714153014545, -77.949391098934, -120.87743542223464, 321.3473494628521, 379.36203860587045, 170.35569210186858, -40.75319408565777, -14.696006611569846, -230.74018616289428, -214.600282135419, -561.1802415278005, -435.69552140188165, -319.2993069611055, -309.3604957890383, 113.02168582021612, 33.80712486898351, -92.03459636689088, 46.32227986901313, 27.735921745615737, -344.3009532317802, 30.179210655208642, 88.28184759572243, -250.1334498125012, 31.762220347020882, 27.08489864579678, -109.7003323793771, 133.8713063874825, 96.976456038752, -142.72234404223286, -47.15665809005747, -317.4786582935746, -407.50025903668273, 251.99339033807397, -62.85732358249489, -445.67369252386135, -484.7058977304096, -55.96497587069842, -238.7700636602542, 7.301374482355689, -222.02986741922484, -51.864334646965304, -24.333537560295206, 23.113626554069487, -402.2019405140751, -490.34480540654516, -106.67694976973303, -225.35012013416593, 71.997045515706, 20.37272113365705, 162.9421414380604, -290.76021473691907, -166.77120655260558, 97.59135345824279, -82.31257768771275, -214.67100448141957, -717.1271095128706, -620.8756155954987, -317.89804818831243, -461.5769278726187, 31.723180999161624, 328.81244204929465, -120.60800463001493, 14.986783278117889, -475.72970001679676, -919.1374409710456, -306.1083063792472, 272.26223857038667, -53.09543997799224, -380.1536019238286, 71.05046971000407, -259.96654170570787, 122.43603910023702, -562.343562955282, 16.059807753978376, 5.673438019697681, 60.97846985390523, -119.43862568488309, -151.40570733086417, -13.19098952449376, 148.95392049165716, -643.188935905065, -280.31486107538717, 64.66981157306337, -578.9695837349047, -63.60402134206318, -37.092074486771736, 94.31919474279351, 34.03501269092392, -47.69185993200183, -79.36875166742291, -21.084647044903278, -281.0333652409874, -2.0722842909462695, -6.268410589051285, -691.145108197119, 25.51305476137101, 19.640094813341527, -52.57705468189713, -93.56891830000869, -146.45711430905857, -488.7489828085907, -396.503657383644, -495.1748725030613, 215.419232459669, 163.1521801563441, -10.036965981947958, 27.46562902876332, -7.313302201314867, -785.2635463467702, 87.7514443436249, 52.70400754103315, -55.68375008648778, -242.02457480669707, -766.7668881561716, -480.60089164887256, -129.74955528730268, -404.10052892593853, 25.175874378172058, -25.514783304996058, -56.82037981742464, -229.8738680026786, -90.19233338745833, -89.40551213516096, -94.93074129111986, -582.6761331809628, -412.7214327800315, -100.990567014377, 126.11015984957407, -666.391072713972, 42.19615496837693, -343.53165408461166, -765.0792139862236, -547.3956247219992, -41.653218596449555, -361.13162421249626, -281.36413572577544, -23.521228909007604, 120.28779057412213, 19.59611097986068, 27.080202800589127, -403.1356619850714, -153.45225353660067, 92.81810487834726, 245.43726993078513, -658.7492896484599, 34.1553542003817, -118.51075096381976, 18.536249590204953, -116.23889966419839, -535.4481678190834, -388.7119484955752, -304.9896899991549, -53.71622771960582, -53.47068185626676, -239.38032925469255, -425.8658759514346, -65.27538236298668, 219.127024105565, 1.1473860291220281, -141.2256479020429, 39.420908179150025, -65.83148452059693, -58.88906438053968, -41.57623647727301, -418.24039917793306, -909.9523888319471, -1069.121375290037, -2.603446259391082, -22.021515617898412, -1079.3191261147874, 57.921669785434034, -365.2921161975015, -1056.3745456950492, 157.55193276117586, -775.2610650210213], "policy_predator_policy_reward": [195.34515822664744, 187.0644256046728, 24.797436631646207, 241.83341355403772, 50.72421570574651, 188.53824072986285, 146.5683409430558, 282.822748787946, 247.073835091675, 148.56243028274946, 18.31658069637516, 127.0578932469255, 38.86657329081512, 116.74328989118443, 49.73152566045534, 414.1139412213728, 0.0, 253.10133822413718, 34.59597247550811, 530.7708870535695, 58.652700645514365, 46.48381836715331, 134.2312416148527, 347.548766601562, 157.44022861668134, 283.63494868799046, 410.47208240570257, 56.742902610216355, 52.652650537147906, 11.63796139412958, 255.1019279460997, 88.4476053210329, 159.10622444943758, 344.4000134791466, 465.5750001962978, 360.5042092908465, 494.5749802314377, 503.0162398369744, 393.6869637455582, 123.15769676072057, 175.4707680512907, 19.056703446615767, 53.37772013098717, 11.364078254384365, 138.59107855956844, 477.9843843422121, 330.6648022917045, 270.663833220572, 39.2831990704309, 206.9176922048298, 222.71041573807784, 5.218610253814608, 92.31688061967488, 181.62900738380426, 455.0933402635041, 275.0440038515708, 362.30166179532523, 221.01806312996604, 588.5585769639024, 190.08954777101863, 526.5222460531012, 371.09143485635514, 49.81732752525826, 426.95136165264006, 547.4302408279665, 58.27641590618546, 7.677943531504815, 246.10589949722117, 639.0406509223887, 452.9909303110386, 302.9241941874349, 240.24835463358733, 357.74748928304234, 55.387179481855064, 469.7321602417631, 148.5416441322606, 222.78000030756195, 33.2886709996197, 399.1956900624375, 248.01439794649923, 720.2994777384815, 634.8175860162943, 723.30525564907, 350.4762238006356, 7.676819000838551, 9.087557950705365, 38.0634880772038, 290.96053979777906, 798.2731275266842, 766.2116655357576, 371.3403317871297, 109.45367417221847, 499.98272241727614, 142.14237136677795, 325.5443795172418, 136.9166204903293, 61.8566802865929, 613.1952428325685, 13.270932532050336, 35.486580099514754, 340.26226994807627, 147.6823427870605, 238.32886682443342, 211.89520188303774, 160.42701279967048, 664.0207390512552, 219.34842335305856, 431.3265088322082, 731.1695837349042, 256.79454004644106, 73.56981179888224, 146.90306794509573, 87.82559764319973, 180.16180078017092, 113.96875166742107, 58.384647044903765, 17.20012132670792, 485.26677189564174, 556.6910282055142, 311.278442820417, 13.486945238629055, 21.05990518665846, 228.07828013595926, 163.92497839098303, 367.0577325505382, 575.1005485779993, 789.9416314733321, 281.12736840290864, 80.34380145155352, 136.56651151970703, 35.066709191810176, 35.49773668716253, 274.6803848876337, 717.7176753213453, 161.2248357201102, 75.31230615389055, 244.8342485051108, 291.77181206517133, 792.3668881561716, 607.5281364472121, 283.07518414890865, 515.9287153050478, 48.05857356030668, 158.13757186578957, 168.17509376166444, 342.4628019026611, 14.824452352836754, 435.5319890514334, 715.9535721099045, 104.3585202463641, 425.60062731313906, 171.49163356226012, 682.4634479957411, 222.88152857267997, 311.1404542629668, 431.893005618422, 826.4211046477199, 695.3551446427051, 425.58957822934127, 503.4176933129818, 383.28687063102376, 99.26689525816144, 23.81220942587755, 18.903889020139307, 71.177529817613, 491.9946648939938, 250.33414865825017, 17.43094436867576, 710.5512614121568, 45.99703917605915, 15.344645799618307, 162.210750963818, 63.374362669246814, 125.07683472156923, 728.1097631280592, 402.91581676743345, 216.47493756488598, 249.73536343107506, 227.70992909968274, 166.3349146350163, 372.12953259714055, 281.1439549049344, 58.27297589443523, 36.75261397087822, 22.831958657459722, 310.7403223565553, 304.445586076619, 142.14960657415256, 279.47281802283396, 356.08995760257227, 932.4688183307544, 1135.3207319820938, 91.95191577370834, 5.173046103581698, 1081.9191261147873, 2.3944467380830075, 591.4900418211105, 1081.624929953487, 318.62877005973763, 702.5229451291243]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.20123358568892, "mean_inference_ms": 4.452090672977079, "mean_action_processing_ms": 2.006491444700291, "mean_env_wait_ms": 11.470867387366944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056858062744140625, "StateBufferConnector_ms": 0.008295655250549316, "ViewRequirementAgentConnector_ms": 0.13010025024414062}, "num_episodes": 5, "episode_return_max": 765.0, "episode_return_min": 17.114338646407063, "episode_return_mean": 263.129300439228, "episodes_this_iter": 5}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.93238799584927, "num_env_steps_trained_throughput_per_sec": 156.93238799584927, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 25659.646, "restore_workers_time_ms": 0.034, "training_step_time_ms": 25659.377, "sample_time_ms": 2236.043, "learn_time_ms": 23399.008, "learn_throughput": 170.947, "synch_weights_time_ms": 20.236}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 24, "trial_id": "0b608_00000", "date": "2024-08-22_13-55-28", "timestamp": 1724315128, "time_this_iter_s": 25.533437967300415, "time_total_s": 622.1236901283264, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31207c310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 622.1236901283264, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 31.08888888888889, "ram_util_percent": 82.76111111111109}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.388425157940578, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.862176992527392, "policy_loss": -0.009481993996631848, "vf_loss": 7.869909547371839, "vf_explained_var": 0.34217875817465404, "kl": 0.008747329132473737, "entropy": 0.663598466045642, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23153.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000004}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.93381134668986, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.97907594347757, "policy_loss": -0.00939564085343764, "vf_loss": 7.98665439212133, "vf_explained_var": 0.3724849757063326, "kl": 0.009085907549326304, "entropy": 1.0734706030320869, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23153.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000004}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 765.0, "episode_reward_min": 0.6841194167876963, "episode_reward_mean": 259.1915470140225, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1248.7749171699052, "predator_policy": 2.3944467380830075}, "policy_reward_max": {"prey_policy": 379.36203860587045, "predator_policy": 1219.1621869952742}, "policy_reward_mean": {"prey_policy": -220.77248830880694, "predator_policy": 350.3682618158182}, "custom_metrics": {}, "hist_stats": {"episode_reward": [268.3881584947542, 765.0, 473.1520312833473, 258.0700451541186, 50.298685823925624, 242.5963917054242, 320.50585053745556, 136.299999999997, 138.79999999999953, 302.45372032520925, 439.47703329549904, 305.04801026807945, 252.099999999998, 228.1999999999978, 365.50202773143917, 427.8128562266817, 270.1171086285664, 356.9428073083489, 245.2999999999985, 331.8124546679668, 252.5639320224987, 199.48483531280476, 211.14547891712346, 505.5044354142618, 490.45573107516674, 186.8888182128186, 350.2265058398085, 17.114338646407063, 294.30650338877376, 377.30000000000155, 223.4028065230839, 169.61765207459752, 446.9479381504879, 208.87605188223276, 273.5449280118687, 235.14439926411615, 70.49075840524122, 429.48445690416014, 285.62737185211256, 330.2127364375203, 435.0298826829429, 345.39051870437913, 277.6999999999996, 254.330551182291, 71.90000000000019, 219.36124369041477, 170.55595223975902, 79.6999999999997, 245.8572855450376, 306.95218401088977, 179.39046998953702, 595.4817255872756, 87.99310892578687, 199.82121166089155, 376.99259375865904, 238.89773567709696, 152.52724479833952, 265.1538152407152, 205.85723649927147, 223.9436478442211, 270.7585958816518, 142.70521788418662, 83.38026108098983, 365.0640637040232, 441.69796076515456, 209.30141058220215, 526.2224287333767, 177.6684012544004, 182.59999999999894, 187.1167355271229, 207.13094436867257, 343.23628087054055, 93.20000000000039, 90.7485473168235, 206.86546358083177, 107.50438327720171, 101.19383262373952, 162.13222918765382, 315.30000000000075, 231.7675412911204, 321.8746437496385, 175.74613997019708, 88.71578619086145, 72.50000000000016, 62.91611652351712, 251.4483098820457, 403.4425829290176, 405.9265876579992, 221.77956232960707, 238.54325573717566, 9.299999999999997, 0.6841194167876963, 94.76249506073127, 181.29999999999944, 364.4949934342569, 379.75287337604686, 507.2471971412319, 199.0865456098932, 509.7916356836786, 315.19429095646893], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-77.949391098934, -120.87743542223464, 321.3473494628521, 379.36203860587045, 170.35569210186858, -40.75319408565777, -14.696006611569846, -230.74018616289428, -214.600282135419, -561.1802415278005, -435.69552140188165, -319.2993069611055, -309.3604957890383, 113.02168582021612, 33.80712486898351, -92.03459636689088, 46.32227986901313, 27.735921745615737, -344.3009532317802, 30.179210655208642, 88.28184759572243, -250.1334498125012, 31.762220347020882, 27.08489864579678, -109.7003323793771, 133.8713063874825, 96.976456038752, -142.72234404223286, -47.15665809005747, -317.4786582935746, -407.50025903668273, 251.99339033807397, -62.85732358249489, -445.67369252386135, -484.7058977304096, -55.96497587069842, -238.7700636602542, 7.301374482355689, -222.02986741922484, -51.864334646965304, -24.333537560295206, 23.113626554069487, -402.2019405140751, -490.34480540654516, -106.67694976973303, -225.35012013416593, 71.997045515706, 20.37272113365705, 162.9421414380604, -290.76021473691907, -166.77120655260558, 97.59135345824279, -82.31257768771275, -214.67100448141957, -717.1271095128706, -620.8756155954987, -317.89804818831243, -461.5769278726187, 31.723180999161624, 328.81244204929465, -120.60800463001493, 14.986783278117889, -475.72970001679676, -919.1374409710456, -306.1083063792472, 272.26223857038667, -53.09543997799224, -380.1536019238286, 71.05046971000407, -259.96654170570787, 122.43603910023702, -562.343562955282, 16.059807753978376, 5.673438019697681, 60.97846985390523, -119.43862568488309, -151.40570733086417, -13.19098952449376, 148.95392049165716, -643.188935905065, -280.31486107538717, 64.66981157306337, -578.9695837349047, -63.60402134206318, -37.092074486771736, 94.31919474279351, 34.03501269092392, -47.69185993200183, -79.36875166742291, -21.084647044903278, -281.0333652409874, -2.0722842909462695, -6.268410589051285, -691.145108197119, 25.51305476137101, 19.640094813341527, -52.57705468189713, -93.56891830000869, -146.45711430905857, -488.7489828085907, -396.503657383644, -495.1748725030613, 215.419232459669, 163.1521801563441, -10.036965981947958, 27.46562902876332, -7.313302201314867, -785.2635463467702, 87.7514443436249, 52.70400754103315, -55.68375008648778, -242.02457480669707, -766.7668881561716, -480.60089164887256, -129.74955528730268, -404.10052892593853, 25.175874378172058, -25.514783304996058, -56.82037981742464, -229.8738680026786, -90.19233338745833, -89.40551213516096, -94.93074129111986, -582.6761331809628, -412.7214327800315, -100.990567014377, 126.11015984957407, -666.391072713972, 42.19615496837693, -343.53165408461166, -765.0792139862236, -547.3956247219992, -41.653218596449555, -361.13162421249626, -281.36413572577544, -23.521228909007604, 120.28779057412213, 19.59611097986068, 27.080202800589127, -403.1356619850714, -153.45225353660067, 92.81810487834726, 245.43726993078513, -658.7492896484599, 34.1553542003817, -118.51075096381976, 18.536249590204953, -116.23889966419839, -535.4481678190834, -388.7119484955752, -304.9896899991549, -53.71622771960582, -53.47068185626676, -239.38032925469255, -425.8658759514346, -65.27538236298668, 219.127024105565, 1.1473860291220281, -141.2256479020429, 39.420908179150025, -65.83148452059693, -58.88906438053968, -41.57623647727301, -418.24039917793306, -909.9523888319471, -1069.121375290037, -2.603446259391082, -22.021515617898412, -1079.3191261147874, 57.921669785434034, -365.2921161975015, -1056.3745456950492, 157.55193276117586, -775.2610650210213, 125.6078112627337, -974.9150512520101, 134.6597389782679, -629.4069712981665, 62.78106538139736, -1248.7749171699052, -1187.7269733788696, -1095.1381985418175, -875.0238853921246, -1205.1326179019647, -785.0911168696178, -1070.1916265760005, -617.7367522399022, -602.7012217198762, -481.1272563886606, -175.31704314303346, -763.8005831445361, 11.072672220430647, -623.3752019477054, -132.87636241445696, -614.100546190493, -194.9481954151276, -567.3189922917338, -500.08583715518125, -797.2514119788619, 36.20853133160091], "policy_predator_policy_reward": [410.47208240570257, 56.742902610216355, 52.652650537147906, 11.63796139412958, 255.1019279460997, 88.4476053210329, 159.10622444943758, 344.4000134791466, 465.5750001962978, 360.5042092908465, 494.5749802314377, 503.0162398369744, 393.6869637455582, 123.15769676072057, 175.4707680512907, 19.056703446615767, 53.37772013098717, 11.364078254384365, 138.59107855956844, 477.9843843422121, 330.6648022917045, 270.663833220572, 39.2831990704309, 206.9176922048298, 222.71041573807784, 5.218610253814608, 92.31688061967488, 181.62900738380426, 455.0933402635041, 275.0440038515708, 362.30166179532523, 221.01806312996604, 588.5585769639024, 190.08954777101863, 526.5222460531012, 371.09143485635514, 49.81732752525826, 426.95136165264006, 547.4302408279665, 58.27641590618546, 7.677943531504815, 246.10589949722117, 639.0406509223887, 452.9909303110386, 302.9241941874349, 240.24835463358733, 357.74748928304234, 55.387179481855064, 469.7321602417631, 148.5416441322606, 222.78000030756195, 33.2886709996197, 399.1956900624375, 248.01439794649923, 720.2994777384815, 634.8175860162943, 723.30525564907, 350.4762238006356, 7.676819000838551, 9.087557950705365, 38.0634880772038, 290.96053979777906, 798.2731275266842, 766.2116655357576, 371.3403317871297, 109.45367417221847, 499.98272241727614, 142.14237136677795, 325.5443795172418, 136.9166204903293, 61.8566802865929, 613.1952428325685, 13.270932532050336, 35.486580099514754, 340.26226994807627, 147.6823427870605, 238.32886682443342, 211.89520188303774, 160.42701279967048, 664.0207390512552, 219.34842335305856, 431.3265088322082, 731.1695837349042, 256.79454004644106, 73.56981179888224, 146.90306794509573, 87.82559764319973, 180.16180078017092, 113.96875166742107, 58.384647044903765, 17.20012132670792, 485.26677189564174, 556.6910282055142, 311.278442820417, 13.486945238629055, 21.05990518665846, 228.07828013595926, 163.92497839098303, 367.0577325505382, 575.1005485779993, 789.9416314733321, 281.12736840290864, 80.34380145155352, 136.56651151970703, 35.066709191810176, 35.49773668716253, 274.6803848876337, 717.7176753213453, 161.2248357201102, 75.31230615389055, 244.8342485051108, 291.77181206517133, 792.3668881561716, 607.5281364472121, 283.07518414890865, 515.9287153050478, 48.05857356030668, 158.13757186578957, 168.17509376166444, 342.4628019026611, 14.824452352836754, 435.5319890514334, 715.9535721099045, 104.3585202463641, 425.60062731313906, 171.49163356226012, 682.4634479957411, 222.88152857267997, 311.1404542629668, 431.893005618422, 826.4211046477199, 695.3551446427051, 425.58957822934127, 503.4176933129818, 383.28687063102376, 99.26689525816144, 23.81220942587755, 18.903889020139307, 71.177529817613, 491.9946648939938, 250.33414865825017, 17.43094436867576, 710.5512614121568, 45.99703917605915, 15.344645799618307, 162.210750963818, 63.374362669246814, 125.07683472156923, 728.1097631280592, 402.91581676743345, 216.47493756488598, 249.73536343107506, 227.70992909968274, 166.3349146350163, 372.12953259714055, 281.1439549049344, 58.27297589443523, 36.75261397087822, 22.831958657459722, 310.7403223565553, 304.445586076619, 142.14960657415256, 279.47281802283396, 356.08995760257227, 932.4688183307544, 1135.3207319820938, 91.95191577370834, 5.173046103581698, 1081.9191261147873, 2.3944467380830075, 591.4900418211105, 1081.624929953487, 318.62877005973763, 702.5229451291243, 437.42872031242393, 817.805107334852, 28.82448969003969, 687.702304959468, 205.37492053041015, 1219.1621869952742, 1190.9269733788697, 1101.2381985418178, 875.7080048089124, 1205.1326179019647, 797.663184100524, 1152.3820544058233, 630.0367522399015, 771.701221719876, 378.97444156085777, 641.9648514050924, 759.7244898394664, 372.7562944606864, 1089.7121206797622, 173.78664082363395, 738.1092658469048, 270.0260213686124, 763.420036525792, 813.7764286048044, 471.3448880777194, 604.8922835260059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.176256674004374, "mean_inference_ms": 4.411563595425694, "mean_action_processing_ms": 2.018583671799046, "mean_env_wait_ms": 11.475766548659475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005530238151550293, "StateBufferConnector_ms": 0.008291959762573242, "ViewRequirementAgentConnector_ms": 0.12306416034698486}, "num_episodes": 13, "episode_return_max": 765.0, "episode_return_min": 0.6841194167876963, "episode_return_mean": 259.1915470140225, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.33877937797737, "num_env_steps_trained_throughput_per_sec": 153.33877937797737, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 25615.298, "restore_workers_time_ms": 0.035, "training_step_time_ms": 25615.085, "sample_time_ms": 2184.501, "learn_time_ms": 23407.277, "learn_throughput": 170.887, "synch_weights_time_ms": 20.778}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 25, "trial_id": "0b608_00000", "date": "2024-08-22_13-55-54", "timestamp": 1724315154, "time_this_iter_s": 26.12078309059143, "time_total_s": 648.2444732189178, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a3b4430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 648.2444732189178, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 35.95405405405405, "ram_util_percent": 82.87837837837837}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.489366976798527, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.025362751975893, "policy_loss": -0.008092558899864792, "vf_loss": 8.031576824188232, "vf_explained_var": 0.3496544845520504, "kl": 0.00939250041301998, "entropy": 0.6498325685344676, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 24098.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.97924640771573, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.252644012592457, "policy_loss": -0.013346146409789091, "vf_loss": 8.263774998982747, "vf_explained_var": 0.38105758542106266, "kl": 0.01107563076457058, "entropy": 1.0737221453555676, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 24098.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 595.4817255872756, "episode_reward_min": 0.3148585164907689, "episode_reward_mean": 243.13055421031441, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1443.2554900668176, "predator_policy": 2.3944467380830075}, "policy_reward_max": {"prey_policy": 328.81244204929465, "predator_policy": 1443.5554900668176}, "policy_reward_mean": {"prey_policy": -310.84420311060296, "predator_policy": 432.4094802157602}, "custom_metrics": {}, "hist_stats": {"episode_reward": [228.1999999999978, 365.50202773143917, 427.8128562266817, 270.1171086285664, 356.9428073083489, 245.2999999999985, 331.8124546679668, 252.5639320224987, 199.48483531280476, 211.14547891712346, 505.5044354142618, 490.45573107516674, 186.8888182128186, 350.2265058398085, 17.114338646407063, 294.30650338877376, 377.30000000000155, 223.4028065230839, 169.61765207459752, 446.9479381504879, 208.87605188223276, 273.5449280118687, 235.14439926411615, 70.49075840524122, 429.48445690416014, 285.62737185211256, 330.2127364375203, 435.0298826829429, 345.39051870437913, 277.6999999999996, 254.330551182291, 71.90000000000019, 219.36124369041477, 170.55595223975902, 79.6999999999997, 245.8572855450376, 306.95218401088977, 179.39046998953702, 595.4817255872756, 87.99310892578687, 199.82121166089155, 376.99259375865904, 238.89773567709696, 152.52724479833952, 265.1538152407152, 205.85723649927147, 223.9436478442211, 270.7585958816518, 142.70521788418662, 83.38026108098983, 365.0640637040232, 441.69796076515456, 209.30141058220215, 526.2224287333767, 177.6684012544004, 182.59999999999894, 187.1167355271229, 207.13094436867257, 343.23628087054055, 93.20000000000039, 90.7485473168235, 206.86546358083177, 107.50438327720171, 101.19383262373952, 162.13222918765382, 315.30000000000075, 231.7675412911204, 321.8746437496385, 175.74613997019708, 88.71578619086145, 72.50000000000016, 62.91611652351712, 251.4483098820457, 403.4425829290176, 405.9265876579992, 221.77956232960707, 238.54325573717566, 9.299999999999997, 0.6841194167876963, 94.76249506073127, 181.29999999999944, 364.4949934342569, 379.75287337604686, 507.2471971412319, 199.0865456098932, 509.7916356836786, 315.19429095646893, 107.67580088154261, 140.98318291960692, 9.400000000000007, 519.4157814180646, 255.9901631977132, 0.7336683704124334, 168.92003214259233, 205.04859690116982, 10.261015784221765, 456.60605384117036, 40.3, 0.3148585164907689, 430.44149254401754], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [96.976456038752, -142.72234404223286, -47.15665809005747, -317.4786582935746, -407.50025903668273, 251.99339033807397, -62.85732358249489, -445.67369252386135, -484.7058977304096, -55.96497587069842, -238.7700636602542, 7.301374482355689, -222.02986741922484, -51.864334646965304, -24.333537560295206, 23.113626554069487, -402.2019405140751, -490.34480540654516, -106.67694976973303, -225.35012013416593, 71.997045515706, 20.37272113365705, 162.9421414380604, -290.76021473691907, -166.77120655260558, 97.59135345824279, -82.31257768771275, -214.67100448141957, -717.1271095128706, -620.8756155954987, -317.89804818831243, -461.5769278726187, 31.723180999161624, 328.81244204929465, -120.60800463001493, 14.986783278117889, -475.72970001679676, -919.1374409710456, -306.1083063792472, 272.26223857038667, -53.09543997799224, -380.1536019238286, 71.05046971000407, -259.96654170570787, 122.43603910023702, -562.343562955282, 16.059807753978376, 5.673438019697681, 60.97846985390523, -119.43862568488309, -151.40570733086417, -13.19098952449376, 148.95392049165716, -643.188935905065, -280.31486107538717, 64.66981157306337, -578.9695837349047, -63.60402134206318, -37.092074486771736, 94.31919474279351, 34.03501269092392, -47.69185993200183, -79.36875166742291, -21.084647044903278, -281.0333652409874, -2.0722842909462695, -6.268410589051285, -691.145108197119, 25.51305476137101, 19.640094813341527, -52.57705468189713, -93.56891830000869, -146.45711430905857, -488.7489828085907, -396.503657383644, -495.1748725030613, 215.419232459669, 163.1521801563441, -10.036965981947958, 27.46562902876332, -7.313302201314867, -785.2635463467702, 87.7514443436249, 52.70400754103315, -55.68375008648778, -242.02457480669707, -766.7668881561716, -480.60089164887256, -129.74955528730268, -404.10052892593853, 25.175874378172058, -25.514783304996058, -56.82037981742464, -229.8738680026786, -90.19233338745833, -89.40551213516096, -94.93074129111986, -582.6761331809628, -412.7214327800315, -100.990567014377, 126.11015984957407, -666.391072713972, 42.19615496837693, -343.53165408461166, -765.0792139862236, -547.3956247219992, -41.653218596449555, -361.13162421249626, -281.36413572577544, -23.521228909007604, 120.28779057412213, 19.59611097986068, 27.080202800589127, -403.1356619850714, -153.45225353660067, 92.81810487834726, 245.43726993078513, -658.7492896484599, 34.1553542003817, -118.51075096381976, 18.536249590204953, -116.23889966419839, -535.4481678190834, -388.7119484955752, -304.9896899991549, -53.71622771960582, -53.47068185626676, -239.38032925469255, -425.8658759514346, -65.27538236298668, 219.127024105565, 1.1473860291220281, -141.2256479020429, 39.420908179150025, -65.83148452059693, -58.88906438053968, -41.57623647727301, -418.24039917793306, -909.9523888319471, -1069.121375290037, -2.603446259391082, -22.021515617898412, -1079.3191261147874, 57.921669785434034, -365.2921161975015, -1056.3745456950492, 157.55193276117586, -775.2610650210213, 125.6078112627337, -974.9150512520101, 134.6597389782679, -629.4069712981665, 62.78106538139736, -1248.7749171699052, -1187.7269733788696, -1095.1381985418175, -875.0238853921246, -1205.1326179019647, -785.0911168696178, -1070.1916265760005, -617.7367522399022, -602.7012217198762, -481.1272563886606, -175.31704314303346, -763.8005831445361, 11.072672220430647, -623.3752019477054, -132.87636241445696, -614.100546190493, -194.9481954151276, -567.3189922917338, -500.08583715518125, -797.2514119788619, 36.20853133160091, -588.3431671471179, -1132.6180320695796, -15.098360970392122, -32.29551535868849, -1015.6755325209434, -1297.300210526462, -834.3761594883817, 100.62676444756693, -690.0758570280707, -856.5929102220957, -1277.1215570774505, -992.1029709303942, -1071.8074498280248, -389.46384752400263, -1128.9165886017015, -290.73155663578933, -957.6798989859043, -1214.6093490263784, -386.18973668770604, -627.3401870995451, -1143.1195540633764, -1443.2554900668176, -1298.1654851685103, -1353.6261662670158, 157.83660635406338, 45.509435252081545], "policy_predator_policy_reward": [92.31688061967488, 181.62900738380426, 455.0933402635041, 275.0440038515708, 362.30166179532523, 221.01806312996604, 588.5585769639024, 190.08954777101863, 526.5222460531012, 371.09143485635514, 49.81732752525826, 426.95136165264006, 547.4302408279665, 58.27641590618546, 7.677943531504815, 246.10589949722117, 639.0406509223887, 452.9909303110386, 302.9241941874349, 240.24835463358733, 357.74748928304234, 55.387179481855064, 469.7321602417631, 148.5416441322606, 222.78000030756195, 33.2886709996197, 399.1956900624375, 248.01439794649923, 720.2994777384815, 634.8175860162943, 723.30525564907, 350.4762238006356, 7.676819000838551, 9.087557950705365, 38.0634880772038, 290.96053979777906, 798.2731275266842, 766.2116655357576, 371.3403317871297, 109.45367417221847, 499.98272241727614, 142.14237136677795, 325.5443795172418, 136.9166204903293, 61.8566802865929, 613.1952428325685, 13.270932532050336, 35.486580099514754, 340.26226994807627, 147.6823427870605, 238.32886682443342, 211.89520188303774, 160.42701279967048, 664.0207390512552, 219.34842335305856, 431.3265088322082, 731.1695837349042, 256.79454004644106, 73.56981179888224, 146.90306794509573, 87.82559764319973, 180.16180078017092, 113.96875166742107, 58.384647044903765, 17.20012132670792, 485.26677189564174, 556.6910282055142, 311.278442820417, 13.486945238629055, 21.05990518665846, 228.07828013595926, 163.92497839098303, 367.0577325505382, 575.1005485779993, 789.9416314733321, 281.12736840290864, 80.34380145155352, 136.56651151970703, 35.066709191810176, 35.49773668716253, 274.6803848876337, 717.7176753213453, 161.2248357201102, 75.31230615389055, 244.8342485051108, 291.77181206517133, 792.3668881561716, 607.5281364472121, 283.07518414890865, 515.9287153050478, 48.05857356030668, 158.13757186578957, 168.17509376166444, 342.4628019026611, 14.824452352836754, 435.5319890514334, 715.9535721099045, 104.3585202463641, 425.60062731313906, 171.49163356226012, 682.4634479957411, 222.88152857267997, 311.1404542629668, 431.893005618422, 826.4211046477199, 695.3551446427051, 425.58957822934127, 503.4176933129818, 383.28687063102376, 99.26689525816144, 23.81220942587755, 18.903889020139307, 71.177529817613, 491.9946648939938, 250.33414865825017, 17.43094436867576, 710.5512614121568, 45.99703917605915, 15.344645799618307, 162.210750963818, 63.374362669246814, 125.07683472156923, 728.1097631280592, 402.91581676743345, 216.47493756488598, 249.73536343107506, 227.70992909968274, 166.3349146350163, 372.12953259714055, 281.1439549049344, 58.27297589443523, 36.75261397087822, 22.831958657459722, 310.7403223565553, 304.445586076619, 142.14960657415256, 279.47281802283396, 356.08995760257227, 932.4688183307544, 1135.3207319820938, 91.95191577370834, 5.173046103581698, 1081.9191261147873, 2.3944467380830075, 591.4900418211105, 1081.624929953487, 318.62877005973763, 702.5229451291243, 437.42872031242393, 817.805107334852, 28.82448969003969, 687.702304959468, 205.37492053041015, 1219.1621869952742, 1190.9269733788697, 1101.2381985418178, 875.7080048089124, 1205.1326179019647, 797.663184100524, 1152.3820544058233, 630.0367522399015, 771.701221719876, 378.97444156085777, 641.9648514050924, 759.7244898394664, 372.7562944606864, 1089.7121206797622, 173.78664082363395, 738.1092658469048, 270.0260213686124, 763.420036525792, 813.7764286048044, 471.3448880777194, 604.8922835260059, 1132.6180320695796, 696.0189680286609, 119.38154388999827, 68.99551535868868, 1025.075532520944, 1297.300210526462, 696.7541618020953, 556.4110146567832, 674.9757949224158, 1127.6831355254637, 1277.2858716104067, 992.6723247678505, 533.1226094527434, 1097.0687200418774, 1122.7694261921781, 501.9273159464856, 967.9409147701277, 1214.6093490263784, 684.7373057585553, 785.3986718698666, 1183.1195540633764, 1443.5554900668176, 1298.4803436850011, 1353.6261662670158, 2.4091822461202885, 224.68626869174832]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.1449558860532045, "mean_inference_ms": 4.400308880969565, "mean_action_processing_ms": 1.9252970557258666, "mean_env_wait_ms": 11.514604635059772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005547046661376953, "StateBufferConnector_ms": 0.008560538291931152, "ViewRequirementAgentConnector_ms": 0.12069523334503174}, "num_episodes": 13, "episode_return_max": 595.4817255872756, "episode_return_min": 0.3148585164907689, "episode_return_mean": 243.13055421031441, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.45426387062355, "num_env_steps_trained_throughput_per_sec": 154.45426387062355, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 25642.259, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25642.087, "sample_time_ms": 2174.489, "learn_time_ms": 23444.658, "learn_throughput": 170.615, "synch_weights_time_ms": 20.489}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 26, "trial_id": "0b608_00000", "date": "2024-08-22_13-56-20", "timestamp": 1724315180, "time_this_iter_s": 25.972460985183716, "time_total_s": 674.2169342041016, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31207cf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 674.2169342041016, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 36.98333333333333, "ram_util_percent": 82.88611111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.082522834167278, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.297209702850019, "policy_loss": -0.007986406692939381, "vf_loss": 8.303842477445249, "vf_explained_var": 0.3113671693852339, "kl": 0.006768124249995386, "entropy": 0.5983152238780228, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25043.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.23158792427608, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.324298899514334, "policy_loss": -0.011762515103651418, "vf_loss": 8.334032404864276, "vf_explained_var": 0.3841321441862318, "kl": 0.010144998475652997, "entropy": 1.0221485687311365, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25043.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 628.5993090479408, "episode_reward_min": 0.3148585164907689, "episode_reward_mean": 216.36974962092097, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1453.401890338628, "predator_policy": 2.3944467380830075}, "policy_reward_max": {"prey_policy": 285.2580341880528, "predator_policy": 1453.401890338628}, "policy_reward_mean": {"prey_policy": -437.23920459315667, "predator_policy": 545.4240794036173}, "custom_metrics": {}, "hist_stats": {"episode_reward": [208.87605188223276, 273.5449280118687, 235.14439926411615, 70.49075840524122, 429.48445690416014, 285.62737185211256, 330.2127364375203, 435.0298826829429, 345.39051870437913, 277.6999999999996, 254.330551182291, 71.90000000000019, 219.36124369041477, 170.55595223975902, 79.6999999999997, 245.8572855450376, 306.95218401088977, 179.39046998953702, 595.4817255872756, 87.99310892578687, 199.82121166089155, 376.99259375865904, 238.89773567709696, 152.52724479833952, 265.1538152407152, 205.85723649927147, 223.9436478442211, 270.7585958816518, 142.70521788418662, 83.38026108098983, 365.0640637040232, 441.69796076515456, 209.30141058220215, 526.2224287333767, 177.6684012544004, 182.59999999999894, 187.1167355271229, 207.13094436867257, 343.23628087054055, 93.20000000000039, 90.7485473168235, 206.86546358083177, 107.50438327720171, 101.19383262373952, 162.13222918765382, 315.30000000000075, 231.7675412911204, 321.8746437496385, 175.74613997019708, 88.71578619086145, 72.50000000000016, 62.91611652351712, 251.4483098820457, 403.4425829290176, 405.9265876579992, 221.77956232960707, 238.54325573717566, 9.299999999999997, 0.6841194167876963, 94.76249506073127, 181.29999999999944, 364.4949934342569, 379.75287337604686, 507.2471971412319, 199.0865456098932, 509.7916356836786, 315.19429095646893, 107.67580088154261, 140.98318291960692, 9.400000000000007, 519.4157814180646, 255.9901631977132, 0.7336683704124334, 168.92003214259233, 205.04859690116982, 10.261015784221765, 456.60605384117036, 40.3, 0.3148585164907689, 430.44149254401754, 1.0037457532207243, 208.84956340830416, 1.8245676098490762, 137.52525850227926, 69.65673048203126, 102.9379080163478, 400.0266968867681, 344.64342873914353, 63.18577045673963, 628.5993090479408, 14.290644928122257, 5.39999999999999, 43.10931852177673, 480.75247294012, 74.46628095558508, 87.36347054038966, 3.0870842973965864, 249.18092553281537, 159.97262917063534, 198.68996541202154], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-53.09543997799224, -380.1536019238286, 71.05046971000407, -259.96654170570787, 122.43603910023702, -562.343562955282, 16.059807753978376, 5.673438019697681, 60.97846985390523, -119.43862568488309, -151.40570733086417, -13.19098952449376, 148.95392049165716, -643.188935905065, -280.31486107538717, 64.66981157306337, -578.9695837349047, -63.60402134206318, -37.092074486771736, 94.31919474279351, 34.03501269092392, -47.69185993200183, -79.36875166742291, -21.084647044903278, -281.0333652409874, -2.0722842909462695, -6.268410589051285, -691.145108197119, 25.51305476137101, 19.640094813341527, -52.57705468189713, -93.56891830000869, -146.45711430905857, -488.7489828085907, -396.503657383644, -495.1748725030613, 215.419232459669, 163.1521801563441, -10.036965981947958, 27.46562902876332, -7.313302201314867, -785.2635463467702, 87.7514443436249, 52.70400754103315, -55.68375008648778, -242.02457480669707, -766.7668881561716, -480.60089164887256, -129.74955528730268, -404.10052892593853, 25.175874378172058, -25.514783304996058, -56.82037981742464, -229.8738680026786, -90.19233338745833, -89.40551213516096, -94.93074129111986, -582.6761331809628, -412.7214327800315, -100.990567014377, 126.11015984957407, -666.391072713972, 42.19615496837693, -343.53165408461166, -765.0792139862236, -547.3956247219992, -41.653218596449555, -361.13162421249626, -281.36413572577544, -23.521228909007604, 120.28779057412213, 19.59611097986068, 27.080202800589127, -403.1356619850714, -153.45225353660067, 92.81810487834726, 245.43726993078513, -658.7492896484599, 34.1553542003817, -118.51075096381976, 18.536249590204953, -116.23889966419839, -535.4481678190834, -388.7119484955752, -304.9896899991549, -53.71622771960582, -53.47068185626676, -239.38032925469255, -425.8658759514346, -65.27538236298668, 219.127024105565, 1.1473860291220281, -141.2256479020429, 39.420908179150025, -65.83148452059693, -58.88906438053968, -41.57623647727301, -418.24039917793306, -909.9523888319471, -1069.121375290037, -2.603446259391082, -22.021515617898412, -1079.3191261147874, 57.921669785434034, -365.2921161975015, -1056.3745456950492, 157.55193276117586, -775.2610650210213, 125.6078112627337, -974.9150512520101, 134.6597389782679, -629.4069712981665, 62.78106538139736, -1248.7749171699052, -1187.7269733788696, -1095.1381985418175, -875.0238853921246, -1205.1326179019647, -785.0911168696178, -1070.1916265760005, -617.7367522399022, -602.7012217198762, -481.1272563886606, -175.31704314303346, -763.8005831445361, 11.072672220430647, -623.3752019477054, -132.87636241445696, -614.100546190493, -194.9481954151276, -567.3189922917338, -500.08583715518125, -797.2514119788619, 36.20853133160091, -588.3431671471179, -1132.6180320695796, -15.098360970392122, -32.29551535868849, -1015.6755325209434, -1297.300210526462, -834.3761594883817, 100.62676444756693, -690.0758570280707, -856.5929102220957, -1277.1215570774505, -992.1029709303942, -1071.8074498280248, -389.46384752400263, -1128.9165886017015, -290.73155663578933, -957.6798989859043, -1214.6093490263784, -386.18973668770604, -627.3401870995451, -1143.1195540633764, -1443.2554900668176, -1298.1654851685103, -1353.6261662670158, 157.83660635406338, 45.509435252081545, -1284.0552704402567, -1077.270712830816, -1223.2696588634935, -417.33053057870313, -1294.6650295600882, -1144.7778405995364, -1140.4026364975598, -881.8173245158699, -214.32780004500265, -1317.5016142817217, -1079.0983917841597, -1145.2528577771363, -1247.6845835516467, 272.03645703144167, -297.5257229338551, -579.9356831540206, -950.3348835548625, -1034.7129795607361, -1023.603430255386, 285.2580341880528, -899.682632606728, -1242.8824753174458, -924.7576521150643, -1453.401890338628, -1336.8411455760463, -1012.4033860658822, -734.7391127865507, -144.32558039771283, -26.29383149524861, -585.7376808501778, -955.5366797005638, -1041.117152763634, -1051.970379308063, -1326.0462553830375, -670.3991878620485, -1032.685794731415, -165.36739891231366, -647.5811167191016, -298.8649714862429, 28.771656420064105], "policy_predator_policy_reward": [499.98272241727614, 142.14237136677795, 325.5443795172418, 136.9166204903293, 61.8566802865929, 613.1952428325685, 13.270932532050336, 35.486580099514754, 340.26226994807627, 147.6823427870605, 238.32886682443342, 211.89520188303774, 160.42701279967048, 664.0207390512552, 219.34842335305856, 431.3265088322082, 731.1695837349042, 256.79454004644106, 73.56981179888224, 146.90306794509573, 87.82559764319973, 180.16180078017092, 113.96875166742107, 58.384647044903765, 17.20012132670792, 485.26677189564174, 556.6910282055142, 311.278442820417, 13.486945238629055, 21.05990518665846, 228.07828013595926, 163.92497839098303, 367.0577325505382, 575.1005485779993, 789.9416314733321, 281.12736840290864, 80.34380145155352, 136.56651151970703, 35.066709191810176, 35.49773668716253, 274.6803848876337, 717.7176753213453, 161.2248357201102, 75.31230615389055, 244.8342485051108, 291.77181206517133, 792.3668881561716, 607.5281364472121, 283.07518414890865, 515.9287153050478, 48.05857356030668, 158.13757186578957, 168.17509376166444, 342.4628019026611, 14.824452352836754, 435.5319890514334, 715.9535721099045, 104.3585202463641, 425.60062731313906, 171.49163356226012, 682.4634479957411, 222.88152857267997, 311.1404542629668, 431.893005618422, 826.4211046477199, 695.3551446427051, 425.58957822934127, 503.4176933129818, 383.28687063102376, 99.26689525816144, 23.81220942587755, 18.903889020139307, 71.177529817613, 491.9946648939938, 250.33414865825017, 17.43094436867576, 710.5512614121568, 45.99703917605915, 15.344645799618307, 162.210750963818, 63.374362669246814, 125.07683472156923, 728.1097631280592, 402.91581676743345, 216.47493756488598, 249.73536343107506, 227.70992909968274, 166.3349146350163, 372.12953259714055, 281.1439549049344, 58.27297589443523, 36.75261397087822, 22.831958657459722, 310.7403223565553, 304.445586076619, 142.14960657415256, 279.47281802283396, 356.08995760257227, 932.4688183307544, 1135.3207319820938, 91.95191577370834, 5.173046103581698, 1081.9191261147873, 2.3944467380830075, 591.4900418211105, 1081.624929953487, 318.62877005973763, 702.5229451291243, 437.42872031242393, 817.805107334852, 28.82448969003969, 687.702304959468, 205.37492053041015, 1219.1621869952742, 1190.9269733788697, 1101.2381985418178, 875.7080048089124, 1205.1326179019647, 797.663184100524, 1152.3820544058233, 630.0367522399015, 771.701221719876, 378.97444156085777, 641.9648514050924, 759.7244898394664, 372.7562944606864, 1089.7121206797622, 173.78664082363395, 738.1092658469048, 270.0260213686124, 763.420036525792, 813.7764286048044, 471.3448880777194, 604.8922835260059, 1132.6180320695796, 696.0189680286609, 119.38154388999827, 68.99551535868868, 1025.075532520944, 1297.300210526462, 696.7541618020953, 556.4110146567832, 674.9757949224158, 1127.6831355254637, 1277.2858716104067, 992.6723247678505, 533.1226094527434, 1097.0687200418774, 1122.7694261921781, 501.9273159464856, 967.9409147701277, 1214.6093490263784, 684.7373057585553, 785.3986718698666, 1183.1195540633764, 1443.5554900668176, 1298.4803436850011, 1353.6261662670158, 2.4091822461202885, 224.68626869174832, 1284.0552704402567, 1078.2744585840367, 1224.9690271917468, 624.480725658758, 1295.1895971699373, 1146.0778405995363, 1126.202167278729, 1033.5430522369813, 282.9845305270338, 1318.5016142817217, 1227.8073410340153, 1099.4818165436277, 782.8249933822682, 592.8498300246979, 316.5805233039433, 905.5243115230792, 948.6432492943095, 1099.5903842780288, 968.4193563092939, 398.52534880597807, 912.7030240259752, 1244.1527288263223, 930.1576521150655, 1453.401890338628, 1380.6395057934485, 1011.7143443702564, 1135.4401440719446, 224.37702205243912, 275.36649671207925, 411.1312965889356, 1005.5809218188845, 1078.4363811857036, 1053.4703793080632, 1327.6333396804341, 913.2839542832237, 1038.9819538430559, 653.2330693555193, 319.68807544652987, 270.5472679356509, 198.23601254255456]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.065247621855438, "mean_inference_ms": 4.360893986936431, "mean_action_processing_ms": 1.908503486557312, "mean_env_wait_ms": 11.546341189977557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006455540657043457, "StateBufferConnector_ms": 0.004326820373535156, "ViewRequirementAgentConnector_ms": 0.11224102973937988}, "num_episodes": 20, "episode_return_max": 628.5993090479408, "episode_return_min": 0.3148585164907689, "episode_return_mean": 216.36974962092097, "episodes_this_iter": 20}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.1262853820707, "num_env_steps_trained_throughput_per_sec": 155.1262853820707, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 25688.998, "restore_workers_time_ms": 0.022, "training_step_time_ms": 25688.821, "sample_time_ms": 2178.453, "learn_time_ms": 23488.539, "learn_throughput": 170.296, "synch_weights_time_ms": 19.238}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 27, "trial_id": "0b608_00000", "date": "2024-08-22_13-56-46", "timestamp": 1724315206, "time_this_iter_s": 25.84151291847229, "time_total_s": 700.0584471225739, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x312087790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 700.0584471225739, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 32.9, "ram_util_percent": 82.34594594594596}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.936246698117131, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.21099160865501, "policy_loss": -0.006374309185852922, "vf_loss": 8.215980145792482, "vf_explained_var": 0.34329583543949027, "kl": 0.006928963246188624, "entropy": 0.579068285416043, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25988.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.08019709599712, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.486544038379003, "policy_loss": -0.010747239519238333, "vf_loss": 8.495590007115924, "vf_explained_var": 0.44036200797116315, "kl": 0.008506292990463042, "entropy": 1.0172485135219715, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25988.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 628.5993090479408, "episode_reward_min": 0.3148585164907689, "episode_reward_mean": 207.9504037022377, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1591.6589516432064, "predator_policy": 2.3944467380830075}, "policy_reward_max": {"prey_policy": 285.2580341880528, "predator_policy": 1591.6589516432064}, "policy_reward_mean": {"prey_policy": -499.75645952026593, "predator_policy": 603.731661371385}, "custom_metrics": {}, "hist_stats": {"episode_reward": [254.330551182291, 71.90000000000019, 219.36124369041477, 170.55595223975902, 79.6999999999997, 245.8572855450376, 306.95218401088977, 179.39046998953702, 595.4817255872756, 87.99310892578687, 199.82121166089155, 376.99259375865904, 238.89773567709696, 152.52724479833952, 265.1538152407152, 205.85723649927147, 223.9436478442211, 270.7585958816518, 142.70521788418662, 83.38026108098983, 365.0640637040232, 441.69796076515456, 209.30141058220215, 526.2224287333767, 177.6684012544004, 182.59999999999894, 187.1167355271229, 207.13094436867257, 343.23628087054055, 93.20000000000039, 90.7485473168235, 206.86546358083177, 107.50438327720171, 101.19383262373952, 162.13222918765382, 315.30000000000075, 231.7675412911204, 321.8746437496385, 175.74613997019708, 88.71578619086145, 72.50000000000016, 62.91611652351712, 251.4483098820457, 403.4425829290176, 405.9265876579992, 221.77956232960707, 238.54325573717566, 9.299999999999997, 0.6841194167876963, 94.76249506073127, 181.29999999999944, 364.4949934342569, 379.75287337604686, 507.2471971412319, 199.0865456098932, 509.7916356836786, 315.19429095646893, 107.67580088154261, 140.98318291960692, 9.400000000000007, 519.4157814180646, 255.9901631977132, 0.7336683704124334, 168.92003214259233, 205.04859690116982, 10.261015784221765, 456.60605384117036, 40.3, 0.3148585164907689, 430.44149254401754, 1.0037457532207243, 208.84956340830416, 1.8245676098490762, 137.52525850227926, 69.65673048203126, 102.9379080163478, 400.0266968867681, 344.64342873914353, 63.18577045673963, 628.5993090479408, 14.290644928122257, 5.39999999999999, 43.10931852177673, 480.75247294012, 74.46628095558508, 87.36347054038966, 3.0870842973965864, 249.18092553281537, 159.97262917063534, 198.68996541202154, 446.610789542765, 1.4191503469543463, 151.5468473282976, 364.4683220281785, 31.20000000000006, 57.794089398826486, 211.20902290983358, 384.5243039237109, 0.7748427649074152, 400.01914403278056], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [34.03501269092392, -47.69185993200183, -79.36875166742291, -21.084647044903278, -281.0333652409874, -2.0722842909462695, -6.268410589051285, -691.145108197119, 25.51305476137101, 19.640094813341527, -52.57705468189713, -93.56891830000869, -146.45711430905857, -488.7489828085907, -396.503657383644, -495.1748725030613, 215.419232459669, 163.1521801563441, -10.036965981947958, 27.46562902876332, -7.313302201314867, -785.2635463467702, 87.7514443436249, 52.70400754103315, -55.68375008648778, -242.02457480669707, -766.7668881561716, -480.60089164887256, -129.74955528730268, -404.10052892593853, 25.175874378172058, -25.514783304996058, -56.82037981742464, -229.8738680026786, -90.19233338745833, -89.40551213516096, -94.93074129111986, -582.6761331809628, -412.7214327800315, -100.990567014377, 126.11015984957407, -666.391072713972, 42.19615496837693, -343.53165408461166, -765.0792139862236, -547.3956247219992, -41.653218596449555, -361.13162421249626, -281.36413572577544, -23.521228909007604, 120.28779057412213, 19.59611097986068, 27.080202800589127, -403.1356619850714, -153.45225353660067, 92.81810487834726, 245.43726993078513, -658.7492896484599, 34.1553542003817, -118.51075096381976, 18.536249590204953, -116.23889966419839, -535.4481678190834, -388.7119484955752, -304.9896899991549, -53.71622771960582, -53.47068185626676, -239.38032925469255, -425.8658759514346, -65.27538236298668, 219.127024105565, 1.1473860291220281, -141.2256479020429, 39.420908179150025, -65.83148452059693, -58.88906438053968, -41.57623647727301, -418.24039917793306, -909.9523888319471, -1069.121375290037, -2.603446259391082, -22.021515617898412, -1079.3191261147874, 57.921669785434034, -365.2921161975015, -1056.3745456950492, 157.55193276117586, -775.2610650210213, 125.6078112627337, -974.9150512520101, 134.6597389782679, -629.4069712981665, 62.78106538139736, -1248.7749171699052, -1187.7269733788696, -1095.1381985418175, -875.0238853921246, -1205.1326179019647, -785.0911168696178, -1070.1916265760005, -617.7367522399022, -602.7012217198762, -481.1272563886606, -175.31704314303346, -763.8005831445361, 11.072672220430647, -623.3752019477054, -132.87636241445696, -614.100546190493, -194.9481954151276, -567.3189922917338, -500.08583715518125, -797.2514119788619, 36.20853133160091, -588.3431671471179, -1132.6180320695796, -15.098360970392122, -32.29551535868849, -1015.6755325209434, -1297.300210526462, -834.3761594883817, 100.62676444756693, -690.0758570280707, -856.5929102220957, -1277.1215570774505, -992.1029709303942, -1071.8074498280248, -389.46384752400263, -1128.9165886017015, -290.73155663578933, -957.6798989859043, -1214.6093490263784, -386.18973668770604, -627.3401870995451, -1143.1195540633764, -1443.2554900668176, -1298.1654851685103, -1353.6261662670158, 157.83660635406338, 45.509435252081545, -1284.0552704402567, -1077.270712830816, -1223.2696588634935, -417.33053057870313, -1294.6650295600882, -1144.7778405995364, -1140.4026364975598, -881.8173245158699, -214.32780004500265, -1317.5016142817217, -1079.0983917841597, -1145.2528577771363, -1247.6845835516467, 272.03645703144167, -297.5257229338551, -579.9356831540206, -950.3348835548625, -1034.7129795607361, -1023.603430255386, 285.2580341880528, -899.682632606728, -1242.8824753174458, -924.7576521150643, -1453.401890338628, -1336.8411455760463, -1012.4033860658822, -734.7391127865507, -144.32558039771283, -26.29383149524861, -585.7376808501778, -955.5366797005638, -1041.117152763634, -1051.970379308063, -1326.0462553830375, -670.3991878620485, -1032.685794731415, -165.36739891231366, -647.5811167191016, -298.8649714862429, 28.771656420064105, -896.4707176615266, -64.94778158054415, -1108.0284653998283, -1236.0003758600762, -1040.6959824366597, -703.7245325368988, 110.37008762423231, -924.9928613914626, -640.1994924166862, -1195.064721406615, -1057.8099001592827, -203.57329286847, -167.13127969325643, -1013.7698107103928, -201.0840260985786, -1233.1339660844624, -914.7117047066325, -1591.6589516432064, -995.2939292841645, 15.8479244907467], "policy_predator_policy_reward": [87.82559764319973, 180.16180078017092, 113.96875166742107, 58.384647044903765, 17.20012132670792, 485.26677189564174, 556.6910282055142, 311.278442820417, 13.486945238629055, 21.05990518665846, 228.07828013595926, 163.92497839098303, 367.0577325505382, 575.1005485779993, 789.9416314733321, 281.12736840290864, 80.34380145155352, 136.56651151970703, 35.066709191810176, 35.49773668716253, 274.6803848876337, 717.7176753213453, 161.2248357201102, 75.31230615389055, 244.8342485051108, 291.77181206517133, 792.3668881561716, 607.5281364472121, 283.07518414890865, 515.9287153050478, 48.05857356030668, 158.13757186578957, 168.17509376166444, 342.4628019026611, 14.824452352836754, 435.5319890514334, 715.9535721099045, 104.3585202463641, 425.60062731313906, 171.49163356226012, 682.4634479957411, 222.88152857267997, 311.1404542629668, 431.893005618422, 826.4211046477199, 695.3551446427051, 425.58957822934127, 503.4176933129818, 383.28687063102376, 99.26689525816144, 23.81220942587755, 18.903889020139307, 71.177529817613, 491.9946648939938, 250.33414865825017, 17.43094436867576, 710.5512614121568, 45.99703917605915, 15.344645799618307, 162.210750963818, 63.374362669246814, 125.07683472156923, 728.1097631280592, 402.91581676743345, 216.47493756488598, 249.73536343107506, 227.70992909968274, 166.3349146350163, 372.12953259714055, 281.1439549049344, 58.27297589443523, 36.75261397087822, 22.831958657459722, 310.7403223565553, 304.445586076619, 142.14960657415256, 279.47281802283396, 356.08995760257227, 932.4688183307544, 1135.3207319820938, 91.95191577370834, 5.173046103581698, 1081.9191261147873, 2.3944467380830075, 591.4900418211105, 1081.624929953487, 318.62877005973763, 702.5229451291243, 437.42872031242393, 817.805107334852, 28.82448969003969, 687.702304959468, 205.37492053041015, 1219.1621869952742, 1190.9269733788697, 1101.2381985418178, 875.7080048089124, 1205.1326179019647, 797.663184100524, 1152.3820544058233, 630.0367522399015, 771.701221719876, 378.97444156085777, 641.9648514050924, 759.7244898394664, 372.7562944606864, 1089.7121206797622, 173.78664082363395, 738.1092658469048, 270.0260213686124, 763.420036525792, 813.7764286048044, 471.3448880777194, 604.8922835260059, 1132.6180320695796, 696.0189680286609, 119.38154388999827, 68.99551535868868, 1025.075532520944, 1297.300210526462, 696.7541618020953, 556.4110146567832, 674.9757949224158, 1127.6831355254637, 1277.2858716104067, 992.6723247678505, 533.1226094527434, 1097.0687200418774, 1122.7694261921781, 501.9273159464856, 967.9409147701277, 1214.6093490263784, 684.7373057585553, 785.3986718698666, 1183.1195540633764, 1443.5554900668176, 1298.4803436850011, 1353.6261662670158, 2.4091822461202885, 224.68626869174832, 1284.0552704402567, 1078.2744585840367, 1224.9690271917468, 624.480725658758, 1295.1895971699373, 1146.0778405995363, 1126.202167278729, 1033.5430522369813, 282.9845305270338, 1318.5016142817217, 1227.8073410340153, 1099.4818165436277, 782.8249933822682, 592.8498300246979, 316.5805233039433, 905.5243115230792, 948.6432492943095, 1099.5903842780288, 968.4193563092939, 398.52534880597807, 912.7030240259752, 1244.1527288263223, 930.1576521150655, 1453.401890338628, 1380.6395057934485, 1011.7143443702564, 1135.4401440719446, 224.37702205243912, 275.36649671207925, 411.1312965889356, 1005.5809218188845, 1078.4363811857036, 1053.4703793080632, 1327.6333396804341, 913.2839542832237, 1038.9819538430559, 653.2330693555193, 319.68807544652987, 270.5472679356509, 198.23601254255456, 820.7962515416732, 587.2330372431613, 1109.447615746783, 1236.0003758600762, 664.3043692835728, 1231.6629930182805, 272.4802074843308, 906.6108883110775, 660.3994924166863, 1206.0647214066155, 375.8577628293692, 943.319519597208, 283.7312796932606, 1108.3788336202272, 587.9778047265872, 1230.764491380165, 915.48654747154, 1591.6589516432064, 472.60431342758415, 906.8608353986103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.038672076796041, "mean_inference_ms": 4.356135714803217, "mean_action_processing_ms": 1.856652995056903, "mean_env_wait_ms": 11.584454814880772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006264209747314453, "StateBufferConnector_ms": 0.0043593645095825195, "ViewRequirementAgentConnector_ms": 0.11450910568237305}, "num_episodes": 10, "episode_return_max": 628.5993090479408, "episode_return_min": 0.3148585164907689, "episode_return_mean": 207.9504037022377, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.87167736609925, "num_env_steps_trained_throughput_per_sec": 156.87167736609925, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 25667.993, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25667.814, "sample_time_ms": 2182.633, "learn_time_ms": 23463.276, "learn_throughput": 170.479, "synch_weights_time_ms": 19.302}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 28, "trial_id": "0b608_00000", "date": "2024-08-22_13-57-11", "timestamp": 1724315231, "time_this_iter_s": 25.54163694381714, "time_total_s": 725.600084066391, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a3b41f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 725.600084066391, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 30.924999999999997, "ram_util_percent": 82.79444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.574208076794942, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.12253726928953, "policy_loss": -0.0107415893198873, "vf_loss": 8.131598278832813, "vf_explained_var": 0.3715472864095496, "kl": 0.008402893547752192, "entropy": 0.5562020677738089, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 26933.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.253202986086487, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.640514934882916, "policy_loss": -0.011232640516880171, "vf_loss": 8.649781793765921, "vf_explained_var": 0.46921460205915744, "kl": 0.009829043706376401, "entropy": 0.9699793746862462, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 26933.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 628.5993090479408, "episode_reward_min": 0.3148585164907689, "episode_reward_mean": 185.8755850086396, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1591.6589516432064, "predator_policy": 2.3944467380830075}, "policy_reward_max": {"prey_policy": 285.2580341880528, "predator_policy": 1591.6589516432064}, "policy_reward_mean": {"prey_policy": -631.1369038438785, "predator_policy": 724.0746963481985}, "custom_metrics": {}, "hist_stats": {"episode_reward": [83.38026108098983, 365.0640637040232, 441.69796076515456, 209.30141058220215, 526.2224287333767, 177.6684012544004, 182.59999999999894, 187.1167355271229, 207.13094436867257, 343.23628087054055, 93.20000000000039, 90.7485473168235, 206.86546358083177, 107.50438327720171, 101.19383262373952, 162.13222918765382, 315.30000000000075, 231.7675412911204, 321.8746437496385, 175.74613997019708, 88.71578619086145, 72.50000000000016, 62.91611652351712, 251.4483098820457, 403.4425829290176, 405.9265876579992, 221.77956232960707, 238.54325573717566, 9.299999999999997, 0.6841194167876963, 94.76249506073127, 181.29999999999944, 364.4949934342569, 379.75287337604686, 507.2471971412319, 199.0865456098932, 509.7916356836786, 315.19429095646893, 107.67580088154261, 140.98318291960692, 9.400000000000007, 519.4157814180646, 255.9901631977132, 0.7336683704124334, 168.92003214259233, 205.04859690116982, 10.261015784221765, 456.60605384117036, 40.3, 0.3148585164907689, 430.44149254401754, 1.0037457532207243, 208.84956340830416, 1.8245676098490762, 137.52525850227926, 69.65673048203126, 102.9379080163478, 400.0266968867681, 344.64342873914353, 63.18577045673963, 628.5993090479408, 14.290644928122257, 5.39999999999999, 43.10931852177673, 480.75247294012, 74.46628095558508, 87.36347054038966, 3.0870842973965864, 249.18092553281537, 159.97262917063534, 198.68996541202154, 446.610789542765, 1.4191503469543463, 151.5468473282976, 364.4683220281785, 31.20000000000006, 57.794089398826486, 211.20902290983358, 384.5243039237109, 0.7748427649074152, 400.01914403278056, 31.798621753339454, 121.60341949714604, 2.344339880319937, 103.13179633314726, 297.4764098372183, 358.4409898792912, 131.80878154037242, 20.38388347648314, 174.20902876640056, 5.989570617689042, 13.810829360020282, 52.83463781223085, 237.3530558507159, 3.2000000000000055, 1.3097086410023653, 9.60000000000002, 192.9127900485093, 124.99999999999994, 197.49008776232267], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-412.7214327800315, -100.990567014377, 126.11015984957407, -666.391072713972, 42.19615496837693, -343.53165408461166, -765.0792139862236, -547.3956247219992, -41.653218596449555, -361.13162421249626, -281.36413572577544, -23.521228909007604, 120.28779057412213, 19.59611097986068, 27.080202800589127, -403.1356619850714, -153.45225353660067, 92.81810487834726, 245.43726993078513, -658.7492896484599, 34.1553542003817, -118.51075096381976, 18.536249590204953, -116.23889966419839, -535.4481678190834, -388.7119484955752, -304.9896899991549, -53.71622771960582, -53.47068185626676, -239.38032925469255, -425.8658759514346, -65.27538236298668, 219.127024105565, 1.1473860291220281, -141.2256479020429, 39.420908179150025, -65.83148452059693, -58.88906438053968, -41.57623647727301, -418.24039917793306, -909.9523888319471, -1069.121375290037, -2.603446259391082, -22.021515617898412, -1079.3191261147874, 57.921669785434034, -365.2921161975015, -1056.3745456950492, 157.55193276117586, -775.2610650210213, 125.6078112627337, -974.9150512520101, 134.6597389782679, -629.4069712981665, 62.78106538139736, -1248.7749171699052, -1187.7269733788696, -1095.1381985418175, -875.0238853921246, -1205.1326179019647, -785.0911168696178, -1070.1916265760005, -617.7367522399022, -602.7012217198762, -481.1272563886606, -175.31704314303346, -763.8005831445361, 11.072672220430647, -623.3752019477054, -132.87636241445696, -614.100546190493, -194.9481954151276, -567.3189922917338, -500.08583715518125, -797.2514119788619, 36.20853133160091, -588.3431671471179, -1132.6180320695796, -15.098360970392122, -32.29551535868849, -1015.6755325209434, -1297.300210526462, -834.3761594883817, 100.62676444756693, -690.0758570280707, -856.5929102220957, -1277.1215570774505, -992.1029709303942, -1071.8074498280248, -389.46384752400263, -1128.9165886017015, -290.73155663578933, -957.6798989859043, -1214.6093490263784, -386.18973668770604, -627.3401870995451, -1143.1195540633764, -1443.2554900668176, -1298.1654851685103, -1353.6261662670158, 157.83660635406338, 45.509435252081545, -1284.0552704402567, -1077.270712830816, -1223.2696588634935, -417.33053057870313, -1294.6650295600882, -1144.7778405995364, -1140.4026364975598, -881.8173245158699, -214.32780004500265, -1317.5016142817217, -1079.0983917841597, -1145.2528577771363, -1247.6845835516467, 272.03645703144167, -297.5257229338551, -579.9356831540206, -950.3348835548625, -1034.7129795607361, -1023.603430255386, 285.2580341880528, -899.682632606728, -1242.8824753174458, -924.7576521150643, -1453.401890338628, -1336.8411455760463, -1012.4033860658822, -734.7391127865507, -144.32558039771283, -26.29383149524861, -585.7376808501778, -955.5366797005638, -1041.117152763634, -1051.970379308063, -1326.0462553830375, -670.3991878620485, -1032.685794731415, -165.36739891231366, -647.5811167191016, -298.8649714862429, 28.771656420064105, -896.4707176615266, -64.94778158054415, -1108.0284653998283, -1236.0003758600762, -1040.6959824366597, -703.7245325368988, 110.37008762423231, -924.9928613914626, -640.1994924166862, -1195.064721406615, -1057.8099001592827, -203.57329286847, -167.13127969325643, -1013.7698107103928, -201.0840260985786, -1233.1339660844624, -914.7117047066325, -1591.6589516432064, -995.2939292841645, 15.8479244907467, -1068.8509751779588, -1047.3238954597398, -926.8973464219523, -196.56339705291182, -946.1805889699534, -1202.1992878968033, -661.3435040445469, -1184.8200534990945, -648.4929241962805, -1003.0500086963953, -385.41038269148623, 148.408930492124, -998.5389446682223, -1145.9878166879366, -1343.664590891767, -647.9367515323069, -852.7887827766132, -158.92920978472725, -1243.972953507036, -919.4793532083107, -1114.2627881632511, -1152.6678130160335, -1056.1413853468498, -1226.710826805834, 33.49261526050825, -902.3752867315347, -1104.4730142348753, -1086.6556418429993, -1029.7836588336484, -1204.667803024344, -1499.3765282785776, -868.5244348473705, 16.72159085885485, -946.5080415673649, -736.2755192526572, -974.7939127303856, -1073.3144591265025, -117.54237170448664], "policy_predator_policy_reward": [425.60062731313906, 171.49163356226012, 682.4634479957411, 222.88152857267997, 311.1404542629668, 431.893005618422, 826.4211046477199, 695.3551446427051, 425.58957822934127, 503.4176933129818, 383.28687063102376, 99.26689525816144, 23.81220942587755, 18.903889020139307, 71.177529817613, 491.9946648939938, 250.33414865825017, 17.43094436867576, 710.5512614121568, 45.99703917605915, 15.344645799618307, 162.210750963818, 63.374362669246814, 125.07683472156923, 728.1097631280592, 402.91581676743345, 216.47493756488598, 249.73536343107506, 227.70992909968274, 166.3349146350163, 372.12953259714055, 281.1439549049344, 58.27297589443523, 36.75261397087822, 22.831958657459722, 310.7403223565553, 304.445586076619, 142.14960657415256, 279.47281802283396, 356.08995760257227, 932.4688183307544, 1135.3207319820938, 91.95191577370834, 5.173046103581698, 1081.9191261147873, 2.3944467380830075, 591.4900418211105, 1081.624929953487, 318.62877005973763, 702.5229451291243, 437.42872031242393, 817.805107334852, 28.82448969003969, 687.702304959468, 205.37492053041015, 1219.1621869952742, 1190.9269733788697, 1101.2381985418178, 875.7080048089124, 1205.1326179019647, 797.663184100524, 1152.3820544058233, 630.0367522399015, 771.701221719876, 378.97444156085777, 641.9648514050924, 759.7244898394664, 372.7562944606864, 1089.7121206797622, 173.78664082363395, 738.1092658469048, 270.0260213686124, 763.420036525792, 813.7764286048044, 471.3448880777194, 604.8922835260059, 1132.6180320695796, 696.0189680286609, 119.38154388999827, 68.99551535868868, 1025.075532520944, 1297.300210526462, 696.7541618020953, 556.4110146567832, 674.9757949224158, 1127.6831355254637, 1277.2858716104067, 992.6723247678505, 533.1226094527434, 1097.0687200418774, 1122.7694261921781, 501.9273159464856, 967.9409147701277, 1214.6093490263784, 684.7373057585553, 785.3986718698666, 1183.1195540633764, 1443.5554900668176, 1298.4803436850011, 1353.6261662670158, 2.4091822461202885, 224.68626869174832, 1284.0552704402567, 1078.2744585840367, 1224.9690271917468, 624.480725658758, 1295.1895971699373, 1146.0778405995363, 1126.202167278729, 1033.5430522369813, 282.9845305270338, 1318.5016142817217, 1227.8073410340153, 1099.4818165436277, 782.8249933822682, 592.8498300246979, 316.5805233039433, 905.5243115230792, 948.6432492943095, 1099.5903842780288, 968.4193563092939, 398.52534880597807, 912.7030240259752, 1244.1527288263223, 930.1576521150655, 1453.401890338628, 1380.6395057934485, 1011.7143443702564, 1135.4401440719446, 224.37702205243912, 275.36649671207925, 411.1312965889356, 1005.5809218188845, 1078.4363811857036, 1053.4703793080632, 1327.6333396804341, 913.2839542832237, 1038.9819538430559, 653.2330693555193, 319.68807544652987, 270.5472679356509, 198.23601254255456, 820.7962515416732, 587.2330372431613, 1109.447615746783, 1236.0003758600762, 664.3043692835728, 1231.6629930182805, 272.4802074843308, 906.6108883110775, 660.3994924166863, 1206.0647214066155, 375.8577628293692, 943.319519597208, 283.7312796932606, 1108.3788336202272, 587.9778047265872, 1230.764491380165, 915.48654747154, 1591.6589516432064, 472.60431342758415, 906.8608353986103, 1081.0488310329617, 1066.9246613580758, 964.6442003611432, 280.4199626108697, 948.1249288502732, 1202.599287896803, 764.6336042022109, 1184.6617496745791, 967.3866828048809, 981.6326599250151, 187.50483298432664, 407.9376090943269, 1191.8678561900176, 1084.4676867065143, 1345.4645908917666, 666.52063500879, 954.9149028135881, 231.01211851415496, 1245.2729535070348, 924.168923826, 1128.0736175232712, 1152.6678130160335, 1075.5169171576779, 1260.1699328072373, 463.2764470628078, 642.9592802589323, 1104.4730142348753, 1089.8556418429994, 935.7027972192362, 1300.0583732797581, 1499.3765282785776, 878.1244348473712, 515.5983272712391, 607.1009134857811, 852.2755192526561, 983.7939127303855, 1074.736737453648, 313.61018113966395]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.030446490926553, "mean_inference_ms": 4.322764671637526, "mean_action_processing_ms": 1.8163668065177716, "mean_env_wait_ms": 11.624919346494757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0049457550048828125, "StateBufferConnector_ms": 0.004351973533630371, "ViewRequirementAgentConnector_ms": 0.3865697383880615}, "num_episodes": 19, "episode_return_max": 628.5993090479408, "episode_return_min": 0.3148585164907689, "episode_return_mean": 185.8755850086396, "episodes_this_iter": 19}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 149.1519234980767, "num_env_steps_trained_throughput_per_sec": 149.1519234980767, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 25811.211, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25811.02, "sample_time_ms": 2269.769, "learn_time_ms": 23517.633, "learn_throughput": 170.085, "synch_weights_time_ms": 20.833}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 29, "trial_id": "0b608_00000", "date": "2024-08-22_13-57-38", "timestamp": 1724315258, "time_this_iter_s": 26.88097310066223, "time_total_s": 752.4810571670532, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a3b4a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 752.4810571670532, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 35.02368421052632, "ram_util_percent": 82.6105263157895}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.34014485450018, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.006054319654192, "policy_loss": -0.007977820597293357, "vf_loss": 8.012674000654272, "vf_explained_var": 0.36060422904907713, "kl": 0.006790614499163533, "entropy": 0.5342182643199093, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27878.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.93568397312568, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.617372835250128, "policy_loss": -0.00987330253701657, "vf_loss": 8.625436491688724, "vf_explained_var": 0.48863659907901097, "kl": 0.009048418596721989, "entropy": 0.9270975604259147, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27878.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 628.5993090479408, "episode_reward_min": -7.732964741703721, "episode_reward_mean": 172.27659721495377, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1591.6589516432064, "predator_policy": 2.3944467380830075}, "policy_reward_max": {"prey_policy": 285.2580341880528, "predator_policy": 1591.6589516432064}, "policy_reward_mean": {"prey_policy": -681.8860639665346, "predator_policy": 768.0243625740114}, "custom_metrics": {}, "hist_stats": {"episode_reward": [207.13094436867257, 343.23628087054055, 93.20000000000039, 90.7485473168235, 206.86546358083177, 107.50438327720171, 101.19383262373952, 162.13222918765382, 315.30000000000075, 231.7675412911204, 321.8746437496385, 175.74613997019708, 88.71578619086145, 72.50000000000016, 62.91611652351712, 251.4483098820457, 403.4425829290176, 405.9265876579992, 221.77956232960707, 238.54325573717566, 9.299999999999997, 0.6841194167876963, 94.76249506073127, 181.29999999999944, 364.4949934342569, 379.75287337604686, 507.2471971412319, 199.0865456098932, 509.7916356836786, 315.19429095646893, 107.67580088154261, 140.98318291960692, 9.400000000000007, 519.4157814180646, 255.9901631977132, 0.7336683704124334, 168.92003214259233, 205.04859690116982, 10.261015784221765, 456.60605384117036, 40.3, 0.3148585164907689, 430.44149254401754, 1.0037457532207243, 208.84956340830416, 1.8245676098490762, 137.52525850227926, 69.65673048203126, 102.9379080163478, 400.0266968867681, 344.64342873914353, 63.18577045673963, 628.5993090479408, 14.290644928122257, 5.39999999999999, 43.10931852177673, 480.75247294012, 74.46628095558508, 87.36347054038966, 3.0870842973965864, 249.18092553281537, 159.97262917063534, 198.68996541202154, 446.610789542765, 1.4191503469543463, 151.5468473282976, 364.4683220281785, 31.20000000000006, 57.794089398826486, 211.20902290983358, 384.5243039237109, 0.7748427649074152, 400.01914403278056, 31.798621753339454, 121.60341949714604, 2.344339880319937, 103.13179633314726, 297.4764098372183, 358.4409898792912, 131.80878154037242, 20.38388347648314, 174.20902876640056, 5.989570617689042, 13.810829360020282, 52.83463781223085, 237.3530558507159, 3.2000000000000055, 1.3097086410023653, 9.60000000000002, 192.9127900485093, 124.99999999999994, 197.49008776232267, 154.68555459097468, -7.732964741703721, 1.2000000000000064, 99.16262262648567, 95.57349209255938, 31.59999999999998, 432.2438090252027, 6.419968685164406], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-153.45225353660067, 92.81810487834726, 245.43726993078513, -658.7492896484599, 34.1553542003817, -118.51075096381976, 18.536249590204953, -116.23889966419839, -535.4481678190834, -388.7119484955752, -304.9896899991549, -53.71622771960582, -53.47068185626676, -239.38032925469255, -425.8658759514346, -65.27538236298668, 219.127024105565, 1.1473860291220281, -141.2256479020429, 39.420908179150025, -65.83148452059693, -58.88906438053968, -41.57623647727301, -418.24039917793306, -909.9523888319471, -1069.121375290037, -2.603446259391082, -22.021515617898412, -1079.3191261147874, 57.921669785434034, -365.2921161975015, -1056.3745456950492, 157.55193276117586, -775.2610650210213, 125.6078112627337, -974.9150512520101, 134.6597389782679, -629.4069712981665, 62.78106538139736, -1248.7749171699052, -1187.7269733788696, -1095.1381985418175, -875.0238853921246, -1205.1326179019647, -785.0911168696178, -1070.1916265760005, -617.7367522399022, -602.7012217198762, -481.1272563886606, -175.31704314303346, -763.8005831445361, 11.072672220430647, -623.3752019477054, -132.87636241445696, -614.100546190493, -194.9481954151276, -567.3189922917338, -500.08583715518125, -797.2514119788619, 36.20853133160091, -588.3431671471179, -1132.6180320695796, -15.098360970392122, -32.29551535868849, -1015.6755325209434, -1297.300210526462, -834.3761594883817, 100.62676444756693, -690.0758570280707, -856.5929102220957, -1277.1215570774505, -992.1029709303942, -1071.8074498280248, -389.46384752400263, -1128.9165886017015, -290.73155663578933, -957.6798989859043, -1214.6093490263784, -386.18973668770604, -627.3401870995451, -1143.1195540633764, -1443.2554900668176, -1298.1654851685103, -1353.6261662670158, 157.83660635406338, 45.509435252081545, -1284.0552704402567, -1077.270712830816, -1223.2696588634935, -417.33053057870313, -1294.6650295600882, -1144.7778405995364, -1140.4026364975598, -881.8173245158699, -214.32780004500265, -1317.5016142817217, -1079.0983917841597, -1145.2528577771363, -1247.6845835516467, 272.03645703144167, -297.5257229338551, -579.9356831540206, -950.3348835548625, -1034.7129795607361, -1023.603430255386, 285.2580341880528, -899.682632606728, -1242.8824753174458, -924.7576521150643, -1453.401890338628, -1336.8411455760463, -1012.4033860658822, -734.7391127865507, -144.32558039771283, -26.29383149524861, -585.7376808501778, -955.5366797005638, -1041.117152763634, -1051.970379308063, -1326.0462553830375, -670.3991878620485, -1032.685794731415, -165.36739891231366, -647.5811167191016, -298.8649714862429, 28.771656420064105, -896.4707176615266, -64.94778158054415, -1108.0284653998283, -1236.0003758600762, -1040.6959824366597, -703.7245325368988, 110.37008762423231, -924.9928613914626, -640.1994924166862, -1195.064721406615, -1057.8099001592827, -203.57329286847, -167.13127969325643, -1013.7698107103928, -201.0840260985786, -1233.1339660844624, -914.7117047066325, -1591.6589516432064, -995.2939292841645, 15.8479244907467, -1068.8509751779588, -1047.3238954597398, -926.8973464219523, -196.56339705291182, -946.1805889699534, -1202.1992878968033, -661.3435040445469, -1184.8200534990945, -648.4929241962805, -1003.0500086963953, -385.41038269148623, 148.408930492124, -998.5389446682223, -1145.9878166879366, -1343.664590891767, -647.9367515323069, -852.7887827766132, -158.92920978472725, -1243.972953507036, -919.4793532083107, -1114.2627881632511, -1152.6678130160335, -1056.1413853468498, -1226.710826805834, 33.49261526050825, -902.3752867315347, -1104.4730142348753, -1086.6556418429993, -1029.7836588336484, -1204.667803024344, -1499.3765282785776, -868.5244348473705, 16.72159085885485, -946.5080415673649, -736.2755192526572, -974.7939127303856, -1073.3144591265025, -117.54237170448664, -1167.972870024254, -90.15552574642975, -1258.3118747051155, -941.084639209615, -1459.6629656213397, -1181.660465445518, -718.275404925824, -1280.7843664615182, -828.9331380879737, 28.090090901592717, -1061.2735570385848, -868.2479225477485, -822.6668088776261, 113.98525639491015, -1097.3731700855205, -1127.149678608131], "policy_predator_policy_reward": [250.33414865825017, 17.43094436867576, 710.5512614121568, 45.99703917605915, 15.344645799618307, 162.210750963818, 63.374362669246814, 125.07683472156923, 728.1097631280592, 402.91581676743345, 216.47493756488598, 249.73536343107506, 227.70992909968274, 166.3349146350163, 372.12953259714055, 281.1439549049344, 58.27297589443523, 36.75261397087822, 22.831958657459722, 310.7403223565553, 304.445586076619, 142.14960657415256, 279.47281802283396, 356.08995760257227, 932.4688183307544, 1135.3207319820938, 91.95191577370834, 5.173046103581698, 1081.9191261147873, 2.3944467380830075, 591.4900418211105, 1081.624929953487, 318.62877005973763, 702.5229451291243, 437.42872031242393, 817.805107334852, 28.82448969003969, 687.702304959468, 205.37492053041015, 1219.1621869952742, 1190.9269733788697, 1101.2381985418178, 875.7080048089124, 1205.1326179019647, 797.663184100524, 1152.3820544058233, 630.0367522399015, 771.701221719876, 378.97444156085777, 641.9648514050924, 759.7244898394664, 372.7562944606864, 1089.7121206797622, 173.78664082363395, 738.1092658469048, 270.0260213686124, 763.420036525792, 813.7764286048044, 471.3448880777194, 604.8922835260059, 1132.6180320695796, 696.0189680286609, 119.38154388999827, 68.99551535868868, 1025.075532520944, 1297.300210526462, 696.7541618020953, 556.4110146567832, 674.9757949224158, 1127.6831355254637, 1277.2858716104067, 992.6723247678505, 533.1226094527434, 1097.0687200418774, 1122.7694261921781, 501.9273159464856, 967.9409147701277, 1214.6093490263784, 684.7373057585553, 785.3986718698666, 1183.1195540633764, 1443.5554900668176, 1298.4803436850011, 1353.6261662670158, 2.4091822461202885, 224.68626869174832, 1284.0552704402567, 1078.2744585840367, 1224.9690271917468, 624.480725658758, 1295.1895971699373, 1146.0778405995363, 1126.202167278729, 1033.5430522369813, 282.9845305270338, 1318.5016142817217, 1227.8073410340153, 1099.4818165436277, 782.8249933822682, 592.8498300246979, 316.5805233039433, 905.5243115230792, 948.6432492943095, 1099.5903842780288, 968.4193563092939, 398.52534880597807, 912.7030240259752, 1244.1527288263223, 930.1576521150655, 1453.401890338628, 1380.6395057934485, 1011.7143443702564, 1135.4401440719446, 224.37702205243912, 275.36649671207925, 411.1312965889356, 1005.5809218188845, 1078.4363811857036, 1053.4703793080632, 1327.6333396804341, 913.2839542832237, 1038.9819538430559, 653.2330693555193, 319.68807544652987, 270.5472679356509, 198.23601254255456, 820.7962515416732, 587.2330372431613, 1109.447615746783, 1236.0003758600762, 664.3043692835728, 1231.6629930182805, 272.4802074843308, 906.6108883110775, 660.3994924166863, 1206.0647214066155, 375.8577628293692, 943.319519597208, 283.7312796932606, 1108.3788336202272, 587.9778047265872, 1230.764491380165, 915.48654747154, 1591.6589516432064, 472.60431342758415, 906.8608353986103, 1081.0488310329617, 1066.9246613580758, 964.6442003611432, 280.4199626108697, 948.1249288502732, 1202.599287896803, 764.6336042022109, 1184.6617496745791, 967.3866828048809, 981.6326599250151, 187.50483298432664, 407.9376090943269, 1191.8678561900176, 1084.4676867065143, 1345.4645908917666, 666.52063500879, 954.9149028135881, 231.01211851415496, 1245.2729535070348, 924.168923826, 1128.0736175232712, 1152.6678130160335, 1075.5169171576779, 1260.1699328072373, 463.2764470628078, 642.9592802589323, 1104.4730142348753, 1089.8556418429994, 935.7027972192362, 1300.0583732797581, 1499.3765282785776, 878.1244348473712, 515.5983272712391, 607.1009134857811, 852.2755192526561, 983.7939127303855, 1074.736737453648, 313.61018113966395, 708.6672025482678, 704.1467478133897, 1275.2990574671305, 916.3644917058974, 1459.6629656213397, 1182.8604654455178, 817.4380275523107, 1280.7843664615182, 838.233138087974, 58.183401190966705, 1062.1735570385847, 898.9479225477487, 926.0510523195021, 214.8743091884167, 843.6962006852428, 1387.2466166935674]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.010972043970292, "mean_inference_ms": 4.315366113093874, "mean_action_processing_ms": 1.8290788426856113, "mean_env_wait_ms": 11.64548892963699, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004921913146972656, "StateBufferConnector_ms": 0.004510045051574707, "ViewRequirementAgentConnector_ms": 0.38817572593688965}, "num_episodes": 8, "episode_return_max": 628.5993090479408, "episode_return_min": -7.732964741703721, "episode_return_mean": 172.27659721495377, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 151.68053028935395, "num_env_steps_trained_throughput_per_sec": 151.68053028935395, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 25864.302, "restore_workers_time_ms": 0.074, "training_step_time_ms": 25864.058, "sample_time_ms": 2355.318, "learn_time_ms": 23485.873, "learn_throughput": 170.315, "synch_weights_time_ms": 19.966}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 30, "trial_id": "0b608_00000", "date": "2024-08-22_13-58-05", "timestamp": 1724315285, "time_this_iter_s": 26.417100191116333, "time_total_s": 778.8981573581696, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x312087a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 778.8981573581696, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 34.25675675675675, "ram_util_percent": 83.19189189189193}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.036881782642748, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.329892387591972, "policy_loss": -0.006911307653638894, "vf_loss": 8.33572586755904, "vf_explained_var": 0.3241154905349489, "kl": 0.0053892150336492155, "entropy": 0.4877163576385962, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 28823.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.058070295197624, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.405562656140201, "policy_loss": -0.010160635480233443, "vf_loss": 8.413968937989896, "vf_explained_var": 0.5554902180792793, "kl": 0.008771896879459735, "entropy": 0.9059438830330259, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 28823.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 628.5993090479408, "episode_reward_min": -7.732964741703721, "episode_reward_mean": 172.16822802412625, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1591.6589516432064, "predator_policy": 2.3944467380830075}, "policy_reward_max": {"prey_policy": 285.2580341880528, "predator_policy": 1591.6589516432064}, "policy_reward_mean": {"prey_policy": -686.6298900402966, "predator_policy": 772.7140040523598}, "custom_metrics": {}, "hist_stats": {"episode_reward": [343.23628087054055, 93.20000000000039, 90.7485473168235, 206.86546358083177, 107.50438327720171, 101.19383262373952, 162.13222918765382, 315.30000000000075, 231.7675412911204, 321.8746437496385, 175.74613997019708, 88.71578619086145, 72.50000000000016, 62.91611652351712, 251.4483098820457, 403.4425829290176, 405.9265876579992, 221.77956232960707, 238.54325573717566, 9.299999999999997, 0.6841194167876963, 94.76249506073127, 181.29999999999944, 364.4949934342569, 379.75287337604686, 507.2471971412319, 199.0865456098932, 509.7916356836786, 315.19429095646893, 107.67580088154261, 140.98318291960692, 9.400000000000007, 519.4157814180646, 255.9901631977132, 0.7336683704124334, 168.92003214259233, 205.04859690116982, 10.261015784221765, 456.60605384117036, 40.3, 0.3148585164907689, 430.44149254401754, 1.0037457532207243, 208.84956340830416, 1.8245676098490762, 137.52525850227926, 69.65673048203126, 102.9379080163478, 400.0266968867681, 344.64342873914353, 63.18577045673963, 628.5993090479408, 14.290644928122257, 5.39999999999999, 43.10931852177673, 480.75247294012, 74.46628095558508, 87.36347054038966, 3.0870842973965864, 249.18092553281537, 159.97262917063534, 198.68996541202154, 446.610789542765, 1.4191503469543463, 151.5468473282976, 364.4683220281785, 31.20000000000006, 57.794089398826486, 211.20902290983358, 384.5243039237109, 0.7748427649074152, 400.01914403278056, 31.798621753339454, 121.60341949714604, 2.344339880319937, 103.13179633314726, 297.4764098372183, 358.4409898792912, 131.80878154037242, 20.38388347648314, 174.20902876640056, 5.989570617689042, 13.810829360020282, 52.83463781223085, 237.3530558507159, 3.2000000000000055, 1.3097086410023653, 9.60000000000002, 192.9127900485093, 124.99999999999994, 197.49008776232267, 154.68555459097468, -7.732964741703721, 1.2000000000000064, 99.16262262648567, 95.57349209255938, 31.59999999999998, 432.2438090252027, 6.419968685164406, 196.29402528592712], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [245.43726993078513, -658.7492896484599, 34.1553542003817, -118.51075096381976, 18.536249590204953, -116.23889966419839, -535.4481678190834, -388.7119484955752, -304.9896899991549, -53.71622771960582, -53.47068185626676, -239.38032925469255, -425.8658759514346, -65.27538236298668, 219.127024105565, 1.1473860291220281, -141.2256479020429, 39.420908179150025, -65.83148452059693, -58.88906438053968, -41.57623647727301, -418.24039917793306, -909.9523888319471, -1069.121375290037, -2.603446259391082, -22.021515617898412, -1079.3191261147874, 57.921669785434034, -365.2921161975015, -1056.3745456950492, 157.55193276117586, -775.2610650210213, 125.6078112627337, -974.9150512520101, 134.6597389782679, -629.4069712981665, 62.78106538139736, -1248.7749171699052, -1187.7269733788696, -1095.1381985418175, -875.0238853921246, -1205.1326179019647, -785.0911168696178, -1070.1916265760005, -617.7367522399022, -602.7012217198762, -481.1272563886606, -175.31704314303346, -763.8005831445361, 11.072672220430647, -623.3752019477054, -132.87636241445696, -614.100546190493, -194.9481954151276, -567.3189922917338, -500.08583715518125, -797.2514119788619, 36.20853133160091, -588.3431671471179, -1132.6180320695796, -15.098360970392122, -32.29551535868849, -1015.6755325209434, -1297.300210526462, -834.3761594883817, 100.62676444756693, -690.0758570280707, -856.5929102220957, -1277.1215570774505, -992.1029709303942, -1071.8074498280248, -389.46384752400263, -1128.9165886017015, -290.73155663578933, -957.6798989859043, -1214.6093490263784, -386.18973668770604, -627.3401870995451, -1143.1195540633764, -1443.2554900668176, -1298.1654851685103, -1353.6261662670158, 157.83660635406338, 45.509435252081545, -1284.0552704402567, -1077.270712830816, -1223.2696588634935, -417.33053057870313, -1294.6650295600882, -1144.7778405995364, -1140.4026364975598, -881.8173245158699, -214.32780004500265, -1317.5016142817217, -1079.0983917841597, -1145.2528577771363, -1247.6845835516467, 272.03645703144167, -297.5257229338551, -579.9356831540206, -950.3348835548625, -1034.7129795607361, -1023.603430255386, 285.2580341880528, -899.682632606728, -1242.8824753174458, -924.7576521150643, -1453.401890338628, -1336.8411455760463, -1012.4033860658822, -734.7391127865507, -144.32558039771283, -26.29383149524861, -585.7376808501778, -955.5366797005638, -1041.117152763634, -1051.970379308063, -1326.0462553830375, -670.3991878620485, -1032.685794731415, -165.36739891231366, -647.5811167191016, -298.8649714862429, 28.771656420064105, -896.4707176615266, -64.94778158054415, -1108.0284653998283, -1236.0003758600762, -1040.6959824366597, -703.7245325368988, 110.37008762423231, -924.9928613914626, -640.1994924166862, -1195.064721406615, -1057.8099001592827, -203.57329286847, -167.13127969325643, -1013.7698107103928, -201.0840260985786, -1233.1339660844624, -914.7117047066325, -1591.6589516432064, -995.2939292841645, 15.8479244907467, -1068.8509751779588, -1047.3238954597398, -926.8973464219523, -196.56339705291182, -946.1805889699534, -1202.1992878968033, -661.3435040445469, -1184.8200534990945, -648.4929241962805, -1003.0500086963953, -385.41038269148623, 148.408930492124, -998.5389446682223, -1145.9878166879366, -1343.664590891767, -647.9367515323069, -852.7887827766132, -158.92920978472725, -1243.972953507036, -919.4793532083107, -1114.2627881632511, -1152.6678130160335, -1056.1413853468498, -1226.710826805834, 33.49261526050825, -902.3752867315347, -1104.4730142348753, -1086.6556418429993, -1029.7836588336484, -1204.667803024344, -1499.3765282785776, -868.5244348473705, 16.72159085885485, -946.5080415673649, -736.2755192526572, -974.7939127303856, -1073.3144591265025, -117.54237170448664, -1167.972870024254, -90.15552574642975, -1258.3118747051155, -941.084639209615, -1459.6629656213397, -1181.660465445518, -718.275404925824, -1280.7843664615182, -828.9331380879737, 28.090090901592717, -1061.2735570385848, -868.2479225477485, -822.6668088776261, 113.98525639491015, -1097.3731700855205, -1127.149678608131, -1188.5431155340182, 179.14375212334488], "policy_predator_policy_reward": [710.5512614121568, 45.99703917605915, 15.344645799618307, 162.210750963818, 63.374362669246814, 125.07683472156923, 728.1097631280592, 402.91581676743345, 216.47493756488598, 249.73536343107506, 227.70992909968274, 166.3349146350163, 372.12953259714055, 281.1439549049344, 58.27297589443523, 36.75261397087822, 22.831958657459722, 310.7403223565553, 304.445586076619, 142.14960657415256, 279.47281802283396, 356.08995760257227, 932.4688183307544, 1135.3207319820938, 91.95191577370834, 5.173046103581698, 1081.9191261147873, 2.3944467380830075, 591.4900418211105, 1081.624929953487, 318.62877005973763, 702.5229451291243, 437.42872031242393, 817.805107334852, 28.82448969003969, 687.702304959468, 205.37492053041015, 1219.1621869952742, 1190.9269733788697, 1101.2381985418178, 875.7080048089124, 1205.1326179019647, 797.663184100524, 1152.3820544058233, 630.0367522399015, 771.701221719876, 378.97444156085777, 641.9648514050924, 759.7244898394664, 372.7562944606864, 1089.7121206797622, 173.78664082363395, 738.1092658469048, 270.0260213686124, 763.420036525792, 813.7764286048044, 471.3448880777194, 604.8922835260059, 1132.6180320695796, 696.0189680286609, 119.38154388999827, 68.99551535868868, 1025.075532520944, 1297.300210526462, 696.7541618020953, 556.4110146567832, 674.9757949224158, 1127.6831355254637, 1277.2858716104067, 992.6723247678505, 533.1226094527434, 1097.0687200418774, 1122.7694261921781, 501.9273159464856, 967.9409147701277, 1214.6093490263784, 684.7373057585553, 785.3986718698666, 1183.1195540633764, 1443.5554900668176, 1298.4803436850011, 1353.6261662670158, 2.4091822461202885, 224.68626869174832, 1284.0552704402567, 1078.2744585840367, 1224.9690271917468, 624.480725658758, 1295.1895971699373, 1146.0778405995363, 1126.202167278729, 1033.5430522369813, 282.9845305270338, 1318.5016142817217, 1227.8073410340153, 1099.4818165436277, 782.8249933822682, 592.8498300246979, 316.5805233039433, 905.5243115230792, 948.6432492943095, 1099.5903842780288, 968.4193563092939, 398.52534880597807, 912.7030240259752, 1244.1527288263223, 930.1576521150655, 1453.401890338628, 1380.6395057934485, 1011.7143443702564, 1135.4401440719446, 224.37702205243912, 275.36649671207925, 411.1312965889356, 1005.5809218188845, 1078.4363811857036, 1053.4703793080632, 1327.6333396804341, 913.2839542832237, 1038.9819538430559, 653.2330693555193, 319.68807544652987, 270.5472679356509, 198.23601254255456, 820.7962515416732, 587.2330372431613, 1109.447615746783, 1236.0003758600762, 664.3043692835728, 1231.6629930182805, 272.4802074843308, 906.6108883110775, 660.3994924166863, 1206.0647214066155, 375.8577628293692, 943.319519597208, 283.7312796932606, 1108.3788336202272, 587.9778047265872, 1230.764491380165, 915.48654747154, 1591.6589516432064, 472.60431342758415, 906.8608353986103, 1081.0488310329617, 1066.9246613580758, 964.6442003611432, 280.4199626108697, 948.1249288502732, 1202.599287896803, 764.6336042022109, 1184.6617496745791, 967.3866828048809, 981.6326599250151, 187.50483298432664, 407.9376090943269, 1191.8678561900176, 1084.4676867065143, 1345.4645908917666, 666.52063500879, 954.9149028135881, 231.01211851415496, 1245.2729535070348, 924.168923826, 1128.0736175232712, 1152.6678130160335, 1075.5169171576779, 1260.1699328072373, 463.2764470628078, 642.9592802589323, 1104.4730142348753, 1089.8556418429994, 935.7027972192362, 1300.0583732797581, 1499.3765282785776, 878.1244348473712, 515.5983272712391, 607.1009134857811, 852.2755192526561, 983.7939127303855, 1074.736737453648, 313.61018113966395, 708.6672025482678, 704.1467478133897, 1275.2990574671305, 916.3644917058974, 1459.6629656213397, 1182.8604654455178, 817.4380275523107, 1280.7843664615182, 838.233138087974, 58.183401190966705, 1062.1735570385847, 898.9479225477487, 926.0510523195021, 214.8743091884167, 843.6962006852428, 1387.2466166935674, 1188.5431155340182, 17.150273162582238]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.997579078248602, "mean_inference_ms": 4.326857861200057, "mean_action_processing_ms": 1.8285864979360786, "mean_env_wait_ms": 11.646215041193859, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004964709281921387, "StateBufferConnector_ms": 0.004510164260864258, "ViewRequirementAgentConnector_ms": 0.3863595724105835}, "num_episodes": 1, "episode_return_max": 628.5993090479408, "episode_return_min": -7.732964741703721, "episode_return_mean": 172.16822802412625, "episodes_this_iter": 1}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.98883991868723, "num_env_steps_trained_throughput_per_sec": 156.98883991868723, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 25848.478, "restore_workers_time_ms": 0.073, "training_step_time_ms": 25848.234, "sample_time_ms": 2352.077, "learn_time_ms": 23472.519, "learn_throughput": 170.412, "synch_weights_time_ms": 20.745}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 31, "trial_id": "0b608_00000", "date": "2024-08-22_13-58-30", "timestamp": 1724315310, "time_this_iter_s": 25.50484609603882, "time_total_s": 804.4030034542084, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31207c670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 804.4030034542084, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 31.216666666666658, "ram_util_percent": 82.9277777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.082163005657296, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.398725981939407, "policy_loss": -0.010490243850896756, "vf_loss": 8.407748167350809, "vf_explained_var": 0.34865822741594266, "kl": 0.007340366866134067, "entropy": 0.47737278121489063, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29768.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.612442128746597, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.492020811858001, "policy_loss": -0.01094065228201173, "vf_loss": 8.50123098817452, "vf_explained_var": 0.6113230303481773, "kl": 0.00865240596535384, "entropy": 0.9149508728552117, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29768.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 728.150497810677, "episode_reward_min": -7.732964741703721, "episode_reward_mean": 173.09010613569887, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1591.6589516432064, "predator_policy": 2.3944467380830075}, "policy_reward_max": {"prey_policy": 291.1434419275504, "predator_policy": 1591.6589516432064}, "policy_reward_mean": {"prey_policy": -718.8170958461073, "predator_policy": 805.362148913957}, "custom_metrics": {}, "hist_stats": {"episode_reward": [101.19383262373952, 162.13222918765382, 315.30000000000075, 231.7675412911204, 321.8746437496385, 175.74613997019708, 88.71578619086145, 72.50000000000016, 62.91611652351712, 251.4483098820457, 403.4425829290176, 405.9265876579992, 221.77956232960707, 238.54325573717566, 9.299999999999997, 0.6841194167876963, 94.76249506073127, 181.29999999999944, 364.4949934342569, 379.75287337604686, 507.2471971412319, 199.0865456098932, 509.7916356836786, 315.19429095646893, 107.67580088154261, 140.98318291960692, 9.400000000000007, 519.4157814180646, 255.9901631977132, 0.7336683704124334, 168.92003214259233, 205.04859690116982, 10.261015784221765, 456.60605384117036, 40.3, 0.3148585164907689, 430.44149254401754, 1.0037457532207243, 208.84956340830416, 1.8245676098490762, 137.52525850227926, 69.65673048203126, 102.9379080163478, 400.0266968867681, 344.64342873914353, 63.18577045673963, 628.5993090479408, 14.290644928122257, 5.39999999999999, 43.10931852177673, 480.75247294012, 74.46628095558508, 87.36347054038966, 3.0870842973965864, 249.18092553281537, 159.97262917063534, 198.68996541202154, 446.610789542765, 1.4191503469543463, 151.5468473282976, 364.4683220281785, 31.20000000000006, 57.794089398826486, 211.20902290983358, 384.5243039237109, 0.7748427649074152, 400.01914403278056, 31.798621753339454, 121.60341949714604, 2.344339880319937, 103.13179633314726, 297.4764098372183, 358.4409898792912, 131.80878154037242, 20.38388347648314, 174.20902876640056, 5.989570617689042, 13.810829360020282, 52.83463781223085, 237.3530558507159, 3.2000000000000055, 1.3097086410023653, 9.60000000000002, 192.9127900485093, 124.99999999999994, 197.49008776232267, 154.68555459097468, -7.732964741703721, 1.2000000000000064, 99.16262262648567, 95.57349209255938, 31.59999999999998, 432.2438090252027, 6.419968685164406, 196.29402528592712, 33.68884800369396, 12.199999999999978, 154.8490384220333, 4.85410196624969, 728.150497810677], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-53.47068185626676, -239.38032925469255, -425.8658759514346, -65.27538236298668, 219.127024105565, 1.1473860291220281, -141.2256479020429, 39.420908179150025, -65.83148452059693, -58.88906438053968, -41.57623647727301, -418.24039917793306, -909.9523888319471, -1069.121375290037, -2.603446259391082, -22.021515617898412, -1079.3191261147874, 57.921669785434034, -365.2921161975015, -1056.3745456950492, 157.55193276117586, -775.2610650210213, 125.6078112627337, -974.9150512520101, 134.6597389782679, -629.4069712981665, 62.78106538139736, -1248.7749171699052, -1187.7269733788696, -1095.1381985418175, -875.0238853921246, -1205.1326179019647, -785.0911168696178, -1070.1916265760005, -617.7367522399022, -602.7012217198762, -481.1272563886606, -175.31704314303346, -763.8005831445361, 11.072672220430647, -623.3752019477054, -132.87636241445696, -614.100546190493, -194.9481954151276, -567.3189922917338, -500.08583715518125, -797.2514119788619, 36.20853133160091, -588.3431671471179, -1132.6180320695796, -15.098360970392122, -32.29551535868849, -1015.6755325209434, -1297.300210526462, -834.3761594883817, 100.62676444756693, -690.0758570280707, -856.5929102220957, -1277.1215570774505, -992.1029709303942, -1071.8074498280248, -389.46384752400263, -1128.9165886017015, -290.73155663578933, -957.6798989859043, -1214.6093490263784, -386.18973668770604, -627.3401870995451, -1143.1195540633764, -1443.2554900668176, -1298.1654851685103, -1353.6261662670158, 157.83660635406338, 45.509435252081545, -1284.0552704402567, -1077.270712830816, -1223.2696588634935, -417.33053057870313, -1294.6650295600882, -1144.7778405995364, -1140.4026364975598, -881.8173245158699, -214.32780004500265, -1317.5016142817217, -1079.0983917841597, -1145.2528577771363, -1247.6845835516467, 272.03645703144167, -297.5257229338551, -579.9356831540206, -950.3348835548625, -1034.7129795607361, -1023.603430255386, 285.2580341880528, -899.682632606728, -1242.8824753174458, -924.7576521150643, -1453.401890338628, -1336.8411455760463, -1012.4033860658822, -734.7391127865507, -144.32558039771283, -26.29383149524861, -585.7376808501778, -955.5366797005638, -1041.117152763634, -1051.970379308063, -1326.0462553830375, -670.3991878620485, -1032.685794731415, -165.36739891231366, -647.5811167191016, -298.8649714862429, 28.771656420064105, -896.4707176615266, -64.94778158054415, -1108.0284653998283, -1236.0003758600762, -1040.6959824366597, -703.7245325368988, 110.37008762423231, -924.9928613914626, -640.1994924166862, -1195.064721406615, -1057.8099001592827, -203.57329286847, -167.13127969325643, -1013.7698107103928, -201.0840260985786, -1233.1339660844624, -914.7117047066325, -1591.6589516432064, -995.2939292841645, 15.8479244907467, -1068.8509751779588, -1047.3238954597398, -926.8973464219523, -196.56339705291182, -946.1805889699534, -1202.1992878968033, -661.3435040445469, -1184.8200534990945, -648.4929241962805, -1003.0500086963953, -385.41038269148623, 148.408930492124, -998.5389446682223, -1145.9878166879366, -1343.664590891767, -647.9367515323069, -852.7887827766132, -158.92920978472725, -1243.972953507036, -919.4793532083107, -1114.2627881632511, -1152.6678130160335, -1056.1413853468498, -1226.710826805834, 33.49261526050825, -902.3752867315347, -1104.4730142348753, -1086.6556418429993, -1029.7836588336484, -1204.667803024344, -1499.3765282785776, -868.5244348473705, 16.72159085885485, -946.5080415673649, -736.2755192526572, -974.7939127303856, -1073.3144591265025, -117.54237170448664, -1167.972870024254, -90.15552574642975, -1258.3118747051155, -941.084639209615, -1459.6629656213397, -1181.660465445518, -718.275404925824, -1280.7843664615182, -828.9331380879737, 28.090090901592717, -1061.2735570385848, -868.2479225477485, -822.6668088776261, 113.98525639491015, -1097.3731700855205, -1127.149678608131, -1188.5431155340182, 179.14375212334488, -863.8851790427105, -1164.5621998125575, -1166.8614250103083, -790.3514830138718, -1490.2508375399261, 86.71857139152682, -1165.8309079608684, -1056.1196622251828, 291.1434419275504, -995.6775804643179], "policy_predator_policy_reward": [227.70992909968274, 166.3349146350163, 372.12953259714055, 281.1439549049344, 58.27297589443523, 36.75261397087822, 22.831958657459722, 310.7403223565553, 304.445586076619, 142.14960657415256, 279.47281802283396, 356.08995760257227, 932.4688183307544, 1135.3207319820938, 91.95191577370834, 5.173046103581698, 1081.9191261147873, 2.3944467380830075, 591.4900418211105, 1081.624929953487, 318.62877005973763, 702.5229451291243, 437.42872031242393, 817.805107334852, 28.82448969003969, 687.702304959468, 205.37492053041015, 1219.1621869952742, 1190.9269733788697, 1101.2381985418178, 875.7080048089124, 1205.1326179019647, 797.663184100524, 1152.3820544058233, 630.0367522399015, 771.701221719876, 378.97444156085777, 641.9648514050924, 759.7244898394664, 372.7562944606864, 1089.7121206797622, 173.78664082363395, 738.1092658469048, 270.0260213686124, 763.420036525792, 813.7764286048044, 471.3448880777194, 604.8922835260059, 1132.6180320695796, 696.0189680286609, 119.38154388999827, 68.99551535868868, 1025.075532520944, 1297.300210526462, 696.7541618020953, 556.4110146567832, 674.9757949224158, 1127.6831355254637, 1277.2858716104067, 992.6723247678505, 533.1226094527434, 1097.0687200418774, 1122.7694261921781, 501.9273159464856, 967.9409147701277, 1214.6093490263784, 684.7373057585553, 785.3986718698666, 1183.1195540633764, 1443.5554900668176, 1298.4803436850011, 1353.6261662670158, 2.4091822461202885, 224.68626869174832, 1284.0552704402567, 1078.2744585840367, 1224.9690271917468, 624.480725658758, 1295.1895971699373, 1146.0778405995363, 1126.202167278729, 1033.5430522369813, 282.9845305270338, 1318.5016142817217, 1227.8073410340153, 1099.4818165436277, 782.8249933822682, 592.8498300246979, 316.5805233039433, 905.5243115230792, 948.6432492943095, 1099.5903842780288, 968.4193563092939, 398.52534880597807, 912.7030240259752, 1244.1527288263223, 930.1576521150655, 1453.401890338628, 1380.6395057934485, 1011.7143443702564, 1135.4401440719446, 224.37702205243912, 275.36649671207925, 411.1312965889356, 1005.5809218188845, 1078.4363811857036, 1053.4703793080632, 1327.6333396804341, 913.2839542832237, 1038.9819538430559, 653.2330693555193, 319.68807544652987, 270.5472679356509, 198.23601254255456, 820.7962515416732, 587.2330372431613, 1109.447615746783, 1236.0003758600762, 664.3043692835728, 1231.6629930182805, 272.4802074843308, 906.6108883110775, 660.3994924166863, 1206.0647214066155, 375.8577628293692, 943.319519597208, 283.7312796932606, 1108.3788336202272, 587.9778047265872, 1230.764491380165, 915.48654747154, 1591.6589516432064, 472.60431342758415, 906.8608353986103, 1081.0488310329617, 1066.9246613580758, 964.6442003611432, 280.4199626108697, 948.1249288502732, 1202.599287896803, 764.6336042022109, 1184.6617496745791, 967.3866828048809, 981.6326599250151, 187.50483298432664, 407.9376090943269, 1191.8678561900176, 1084.4676867065143, 1345.4645908917666, 666.52063500879, 954.9149028135881, 231.01211851415496, 1245.2729535070348, 924.168923826, 1128.0736175232712, 1152.6678130160335, 1075.5169171576779, 1260.1699328072373, 463.2764470628078, 642.9592802589323, 1104.4730142348753, 1089.8556418429994, 935.7027972192362, 1300.0583732797581, 1499.3765282785776, 878.1244348473712, 515.5983272712391, 607.1009134857811, 852.2755192526561, 983.7939127303855, 1074.736737453648, 313.61018113966395, 708.6672025482678, 704.1467478133897, 1275.2990574671305, 916.3644917058974, 1459.6629656213397, 1182.8604654455178, 817.4380275523107, 1280.7843664615182, 838.233138087974, 58.183401190966705, 1062.1735570385847, 898.9479225477487, 926.0510523195021, 214.8743091884167, 843.6962006852428, 1387.2466166935674, 1188.5431155340182, 17.150273162582238, 897.2130281142078, 1164.9231987447542, 1167.8614250103083, 801.5514830138742, 1490.7508375399261, 67.63046703050611, 1167.0309079608683, 1059.773764191432, 908.406639792574, 524.27799655487]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.988669036995305, "mean_inference_ms": 4.333072323626097, "mean_action_processing_ms": 1.7868520223799345, "mean_env_wait_ms": 11.666179844587637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005001068115234375, "StateBufferConnector_ms": 0.004595518112182617, "ViewRequirementAgentConnector_ms": 0.3918488025665283}, "num_episodes": 5, "episode_return_max": 728.150497810677, "episode_return_min": -7.732964741703721, "episode_return_mean": 173.09010613569887, "episodes_this_iter": 5}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.41040057878095, "num_env_steps_trained_throughput_per_sec": 156.41040057878095, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 25865.259, "restore_workers_time_ms": 0.074, "training_step_time_ms": 25865.02, "sample_time_ms": 2348.165, "learn_time_ms": 23492.961, "learn_throughput": 170.264, "synch_weights_time_ms": 20.903}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 32, "trial_id": "0b608_00000", "date": "2024-08-22_13-58-56", "timestamp": 1724315336, "time_this_iter_s": 25.625885248184204, "time_total_s": 830.0288887023926, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x312081820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 830.0288887023926, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 31.300000000000004, "ram_util_percent": 82.63333333333331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.490037472790512, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.890564986133071, "policy_loss": -0.007943590437234551, "vf_loss": 7.897114840007964, "vf_explained_var": 0.3379169707575803, "kl": 0.006968711877103757, "entropy": 0.4991404632096568, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 30713.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.330543999318724, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.254620938578611, "policy_loss": -0.01045895468162757, "vf_loss": 8.263205956655835, "vf_explained_var": 0.6109194802228736, "kl": 0.009369657370483592, "entropy": 0.8999168109010767, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 30713.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 728.150497810677, "episode_reward_min": -7.732964741703721, "episode_reward_mean": 169.0745173356833, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1591.6589516432064, "predator_policy": 2.3944467380830075}, "policy_reward_max": {"prey_policy": 291.1434419275504, "predator_policy": 1591.6589516432064}, "policy_reward_mean": {"prey_policy": -760.8662760884722, "predator_policy": 845.4035347563139}, "custom_metrics": {}, "hist_stats": {"episode_reward": [72.50000000000016, 62.91611652351712, 251.4483098820457, 403.4425829290176, 405.9265876579992, 221.77956232960707, 238.54325573717566, 9.299999999999997, 0.6841194167876963, 94.76249506073127, 181.29999999999944, 364.4949934342569, 379.75287337604686, 507.2471971412319, 199.0865456098932, 509.7916356836786, 315.19429095646893, 107.67580088154261, 140.98318291960692, 9.400000000000007, 519.4157814180646, 255.9901631977132, 0.7336683704124334, 168.92003214259233, 205.04859690116982, 10.261015784221765, 456.60605384117036, 40.3, 0.3148585164907689, 430.44149254401754, 1.0037457532207243, 208.84956340830416, 1.8245676098490762, 137.52525850227926, 69.65673048203126, 102.9379080163478, 400.0266968867681, 344.64342873914353, 63.18577045673963, 628.5993090479408, 14.290644928122257, 5.39999999999999, 43.10931852177673, 480.75247294012, 74.46628095558508, 87.36347054038966, 3.0870842973965864, 249.18092553281537, 159.97262917063534, 198.68996541202154, 446.610789542765, 1.4191503469543463, 151.5468473282976, 364.4683220281785, 31.20000000000006, 57.794089398826486, 211.20902290983358, 384.5243039237109, 0.7748427649074152, 400.01914403278056, 31.798621753339454, 121.60341949714604, 2.344339880319937, 103.13179633314726, 297.4764098372183, 358.4409898792912, 131.80878154037242, 20.38388347648314, 174.20902876640056, 5.989570617689042, 13.810829360020282, 52.83463781223085, 237.3530558507159, 3.2000000000000055, 1.3097086410023653, 9.60000000000002, 192.9127900485093, 124.99999999999994, 197.49008776232267, 154.68555459097468, -7.732964741703721, 1.2000000000000064, 99.16262262648567, 95.57349209255938, 31.59999999999998, 432.2438090252027, 6.419968685164406, 196.29402528592712, 33.68884800369396, 12.199999999999978, 154.8490384220333, 4.85410196624969, 728.150497810677, 2.73847369653246, 4.247563260623918, 49.83638798453936, 399.3945659719712, 214.71724884279988, 149.9680967177054, 174.26895653748355], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-2.603446259391082, -22.021515617898412, -1079.3191261147874, 57.921669785434034, -365.2921161975015, -1056.3745456950492, 157.55193276117586, -775.2610650210213, 125.6078112627337, -974.9150512520101, 134.6597389782679, -629.4069712981665, 62.78106538139736, -1248.7749171699052, -1187.7269733788696, -1095.1381985418175, -875.0238853921246, -1205.1326179019647, -785.0911168696178, -1070.1916265760005, -617.7367522399022, -602.7012217198762, -481.1272563886606, -175.31704314303346, -763.8005831445361, 11.072672220430647, -623.3752019477054, -132.87636241445696, -614.100546190493, -194.9481954151276, -567.3189922917338, -500.08583715518125, -797.2514119788619, 36.20853133160091, -588.3431671471179, -1132.6180320695796, -15.098360970392122, -32.29551535868849, -1015.6755325209434, -1297.300210526462, -834.3761594883817, 100.62676444756693, -690.0758570280707, -856.5929102220957, -1277.1215570774505, -992.1029709303942, -1071.8074498280248, -389.46384752400263, -1128.9165886017015, -290.73155663578933, -957.6798989859043, -1214.6093490263784, -386.18973668770604, -627.3401870995451, -1143.1195540633764, -1443.2554900668176, -1298.1654851685103, -1353.6261662670158, 157.83660635406338, 45.509435252081545, -1284.0552704402567, -1077.270712830816, -1223.2696588634935, -417.33053057870313, -1294.6650295600882, -1144.7778405995364, -1140.4026364975598, -881.8173245158699, -214.32780004500265, -1317.5016142817217, -1079.0983917841597, -1145.2528577771363, -1247.6845835516467, 272.03645703144167, -297.5257229338551, -579.9356831540206, -950.3348835548625, -1034.7129795607361, -1023.603430255386, 285.2580341880528, -899.682632606728, -1242.8824753174458, -924.7576521150643, -1453.401890338628, -1336.8411455760463, -1012.4033860658822, -734.7391127865507, -144.32558039771283, -26.29383149524861, -585.7376808501778, -955.5366797005638, -1041.117152763634, -1051.970379308063, -1326.0462553830375, -670.3991878620485, -1032.685794731415, -165.36739891231366, -647.5811167191016, -298.8649714862429, 28.771656420064105, -896.4707176615266, -64.94778158054415, -1108.0284653998283, -1236.0003758600762, -1040.6959824366597, -703.7245325368988, 110.37008762423231, -924.9928613914626, -640.1994924166862, -1195.064721406615, -1057.8099001592827, -203.57329286847, -167.13127969325643, -1013.7698107103928, -201.0840260985786, -1233.1339660844624, -914.7117047066325, -1591.6589516432064, -995.2939292841645, 15.8479244907467, -1068.8509751779588, -1047.3238954597398, -926.8973464219523, -196.56339705291182, -946.1805889699534, -1202.1992878968033, -661.3435040445469, -1184.8200534990945, -648.4929241962805, -1003.0500086963953, -385.41038269148623, 148.408930492124, -998.5389446682223, -1145.9878166879366, -1343.664590891767, -647.9367515323069, -852.7887827766132, -158.92920978472725, -1243.972953507036, -919.4793532083107, -1114.2627881632511, -1152.6678130160335, -1056.1413853468498, -1226.710826805834, 33.49261526050825, -902.3752867315347, -1104.4730142348753, -1086.6556418429993, -1029.7836588336484, -1204.667803024344, -1499.3765282785776, -868.5244348473705, 16.72159085885485, -946.5080415673649, -736.2755192526572, -974.7939127303856, -1073.3144591265025, -117.54237170448664, -1167.972870024254, -90.15552574642975, -1258.3118747051155, -941.084639209615, -1459.6629656213397, -1181.660465445518, -718.275404925824, -1280.7843664615182, -828.9331380879737, 28.090090901592717, -1061.2735570385848, -868.2479225477485, -822.6668088776261, 113.98525639491015, -1097.3731700855205, -1127.149678608131, -1188.5431155340182, 179.14375212334488, -863.8851790427105, -1164.5621998125575, -1166.8614250103083, -790.3514830138718, -1490.2508375399261, 86.71857139152682, -1165.8309079608684, -1056.1196622251828, 291.1434419275504, -995.6775804643179, -1113.0213735353739, -1214.4123152818627, -911.1225583886312, -944.7826141292359, -1221.9021665967318, -1344.4206720198674, -488.30422276690035, 0.9042306141098209, 29.02908786082144, -1049.6402181291776, -970.5731859376058, -862.6838057824777, -635.2097290752575, -912.8300529966822], "policy_predator_policy_reward": [91.95191577370834, 5.173046103581698, 1081.9191261147873, 2.3944467380830075, 591.4900418211105, 1081.624929953487, 318.62877005973763, 702.5229451291243, 437.42872031242393, 817.805107334852, 28.82448969003969, 687.702304959468, 205.37492053041015, 1219.1621869952742, 1190.9269733788697, 1101.2381985418178, 875.7080048089124, 1205.1326179019647, 797.663184100524, 1152.3820544058233, 630.0367522399015, 771.701221719876, 378.97444156085777, 641.9648514050924, 759.7244898394664, 372.7562944606864, 1089.7121206797622, 173.78664082363395, 738.1092658469048, 270.0260213686124, 763.420036525792, 813.7764286048044, 471.3448880777194, 604.8922835260059, 1132.6180320695796, 696.0189680286609, 119.38154388999827, 68.99551535868868, 1025.075532520944, 1297.300210526462, 696.7541618020953, 556.4110146567832, 674.9757949224158, 1127.6831355254637, 1277.2858716104067, 992.6723247678505, 533.1226094527434, 1097.0687200418774, 1122.7694261921781, 501.9273159464856, 967.9409147701277, 1214.6093490263784, 684.7373057585553, 785.3986718698666, 1183.1195540633764, 1443.5554900668176, 1298.4803436850011, 1353.6261662670158, 2.4091822461202885, 224.68626869174832, 1284.0552704402567, 1078.2744585840367, 1224.9690271917468, 624.480725658758, 1295.1895971699373, 1146.0778405995363, 1126.202167278729, 1033.5430522369813, 282.9845305270338, 1318.5016142817217, 1227.8073410340153, 1099.4818165436277, 782.8249933822682, 592.8498300246979, 316.5805233039433, 905.5243115230792, 948.6432492943095, 1099.5903842780288, 968.4193563092939, 398.52534880597807, 912.7030240259752, 1244.1527288263223, 930.1576521150655, 1453.401890338628, 1380.6395057934485, 1011.7143443702564, 1135.4401440719446, 224.37702205243912, 275.36649671207925, 411.1312965889356, 1005.5809218188845, 1078.4363811857036, 1053.4703793080632, 1327.6333396804341, 913.2839542832237, 1038.9819538430559, 653.2330693555193, 319.68807544652987, 270.5472679356509, 198.23601254255456, 820.7962515416732, 587.2330372431613, 1109.447615746783, 1236.0003758600762, 664.3043692835728, 1231.6629930182805, 272.4802074843308, 906.6108883110775, 660.3994924166863, 1206.0647214066155, 375.8577628293692, 943.319519597208, 283.7312796932606, 1108.3788336202272, 587.9778047265872, 1230.764491380165, 915.48654747154, 1591.6589516432064, 472.60431342758415, 906.8608353986103, 1081.0488310329617, 1066.9246613580758, 964.6442003611432, 280.4199626108697, 948.1249288502732, 1202.599287896803, 764.6336042022109, 1184.6617496745791, 967.3866828048809, 981.6326599250151, 187.50483298432664, 407.9376090943269, 1191.8678561900176, 1084.4676867065143, 1345.4645908917666, 666.52063500879, 954.9149028135881, 231.01211851415496, 1245.2729535070348, 924.168923826, 1128.0736175232712, 1152.6678130160335, 1075.5169171576779, 1260.1699328072373, 463.2764470628078, 642.9592802589323, 1104.4730142348753, 1089.8556418429994, 935.7027972192362, 1300.0583732797581, 1499.3765282785776, 878.1244348473712, 515.5983272712391, 607.1009134857811, 852.2755192526561, 983.7939127303855, 1074.736737453648, 313.61018113966395, 708.6672025482678, 704.1467478133897, 1275.2990574671305, 916.3644917058974, 1459.6629656213397, 1182.8604654455178, 817.4380275523107, 1280.7843664615182, 838.233138087974, 58.183401190966705, 1062.1735570385847, 898.9479225477487, 926.0510523195021, 214.8743091884167, 843.6962006852428, 1387.2466166935674, 1188.5431155340182, 17.150273162582238, 897.2130281142078, 1164.9231987447542, 1167.8614250103083, 801.5514830138742, 1490.7508375399261, 67.63046703050611, 1167.0309079608683, 1059.773764191432, 908.406639792574, 524.27799655487, 1111.8981433634247, 1218.2740191503424, 911.1225583886312, 949.0301773898593, 1282.050089987545, 1334.1091366135947, 142.4167462187716, 744.3778119059891, 215.5955767959954, 1019.7328023151609, 1006.4086013478721, 976.8164870899188, 733.7370489156076, 988.571689693816]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.994748417128732, "mean_inference_ms": 4.295384798231428, "mean_action_processing_ms": 1.7853431353522087, "mean_env_wait_ms": 11.695636241109945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005056977272033691, "StateBufferConnector_ms": 0.004602670669555664, "ViewRequirementAgentConnector_ms": 0.39158523082733154}, "num_episodes": 7, "episode_return_max": 728.150497810677, "episode_return_min": -7.732964741703721, "episode_return_mean": 169.0745173356833, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.16731955139164, "num_env_steps_trained_throughput_per_sec": 154.16731955139164, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 25894.529, "restore_workers_time_ms": 0.075, "training_step_time_ms": 25894.289, "sample_time_ms": 2337.556, "learn_time_ms": 23532.646, "learn_throughput": 169.977, "synch_weights_time_ms": 20.889}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 33, "trial_id": "0b608_00000", "date": "2024-08-22_13-59-22", "timestamp": 1724315362, "time_this_iter_s": 25.9933979511261, "time_total_s": 856.0222866535187, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30e3d8d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 856.0222866535187, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 38.12432432432432, "ram_util_percent": 83.12432432432433}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.303161121423914, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.803651056844721, "policy_loss": -0.007099723271907322, "vf_loss": 7.809662064042672, "vf_explained_var": 0.4071579619059487, "kl": 0.005443515721092582, "entropy": 0.5095390460163197, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31658.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.579587124012136, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.054299021524097, "policy_loss": -0.011083979728735156, "vf_loss": 8.063719282705318, "vf_explained_var": 0.6048823175606904, "kl": 0.008318714720132963, "entropy": 0.8920846753650241, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31658.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 805.6894103904659, "episode_reward_min": -7.732964741703721, "episode_reward_mean": 186.71116771873477, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1591.6589516432064, "predator_policy": 2.4091822461202885}, "policy_reward_max": {"prey_policy": 376.5017728773215, "predator_policy": 1591.6589516432064}, "policy_reward_mean": {"prey_policy": -783.4527741153096, "predator_policy": 876.8083579746769}, "custom_metrics": {}, "hist_stats": {"episode_reward": [379.75287337604686, 507.2471971412319, 199.0865456098932, 509.7916356836786, 315.19429095646893, 107.67580088154261, 140.98318291960692, 9.400000000000007, 519.4157814180646, 255.9901631977132, 0.7336683704124334, 168.92003214259233, 205.04859690116982, 10.261015784221765, 456.60605384117036, 40.3, 0.3148585164907689, 430.44149254401754, 1.0037457532207243, 208.84956340830416, 1.8245676098490762, 137.52525850227926, 69.65673048203126, 102.9379080163478, 400.0266968867681, 344.64342873914353, 63.18577045673963, 628.5993090479408, 14.290644928122257, 5.39999999999999, 43.10931852177673, 480.75247294012, 74.46628095558508, 87.36347054038966, 3.0870842973965864, 249.18092553281537, 159.97262917063534, 198.68996541202154, 446.610789542765, 1.4191503469543463, 151.5468473282976, 364.4683220281785, 31.20000000000006, 57.794089398826486, 211.20902290983358, 384.5243039237109, 0.7748427649074152, 400.01914403278056, 31.798621753339454, 121.60341949714604, 2.344339880319937, 103.13179633314726, 297.4764098372183, 358.4409898792912, 131.80878154037242, 20.38388347648314, 174.20902876640056, 5.989570617689042, 13.810829360020282, 52.83463781223085, 237.3530558507159, 3.2000000000000055, 1.3097086410023653, 9.60000000000002, 192.9127900485093, 124.99999999999994, 197.49008776232267, 154.68555459097468, -7.732964741703721, 1.2000000000000064, 99.16262262648567, 95.57349209255938, 31.59999999999998, 432.2438090252027, 6.419968685164406, 196.29402528592712, 33.68884800369396, 12.199999999999978, 154.8490384220333, 4.85410196624969, 728.150497810677, 2.73847369653246, 4.247563260623918, 49.83638798453936, 399.3945659719712, 214.71724884279988, 149.9680967177054, 174.26895653748355, 205.5052793462835, 0.9999999999999964, 67.19686262512664, -0.21484548628526445, 805.6894103904659, 804.0056021833975, 519.0339461824012, 616.8149679153485, 73.49489474358448, 681.4280817493842, 269.5755525148789, 27.233309111698695], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-763.8005831445361, 11.072672220430647, -623.3752019477054, -132.87636241445696, -614.100546190493, -194.9481954151276, -567.3189922917338, -500.08583715518125, -797.2514119788619, 36.20853133160091, -588.3431671471179, -1132.6180320695796, -15.098360970392122, -32.29551535868849, -1015.6755325209434, -1297.300210526462, -834.3761594883817, 100.62676444756693, -690.0758570280707, -856.5929102220957, -1277.1215570774505, -992.1029709303942, -1071.8074498280248, -389.46384752400263, -1128.9165886017015, -290.73155663578933, -957.6798989859043, -1214.6093490263784, -386.18973668770604, -627.3401870995451, -1143.1195540633764, -1443.2554900668176, -1298.1654851685103, -1353.6261662670158, 157.83660635406338, 45.509435252081545, -1284.0552704402567, -1077.270712830816, -1223.2696588634935, -417.33053057870313, -1294.6650295600882, -1144.7778405995364, -1140.4026364975598, -881.8173245158699, -214.32780004500265, -1317.5016142817217, -1079.0983917841597, -1145.2528577771363, -1247.6845835516467, 272.03645703144167, -297.5257229338551, -579.9356831540206, -950.3348835548625, -1034.7129795607361, -1023.603430255386, 285.2580341880528, -899.682632606728, -1242.8824753174458, -924.7576521150643, -1453.401890338628, -1336.8411455760463, -1012.4033860658822, -734.7391127865507, -144.32558039771283, -26.29383149524861, -585.7376808501778, -955.5366797005638, -1041.117152763634, -1051.970379308063, -1326.0462553830375, -670.3991878620485, -1032.685794731415, -165.36739891231366, -647.5811167191016, -298.8649714862429, 28.771656420064105, -896.4707176615266, -64.94778158054415, -1108.0284653998283, -1236.0003758600762, -1040.6959824366597, -703.7245325368988, 110.37008762423231, -924.9928613914626, -640.1994924166862, -1195.064721406615, -1057.8099001592827, -203.57329286847, -167.13127969325643, -1013.7698107103928, -201.0840260985786, -1233.1339660844624, -914.7117047066325, -1591.6589516432064, -995.2939292841645, 15.8479244907467, -1068.8509751779588, -1047.3238954597398, -926.8973464219523, -196.56339705291182, -946.1805889699534, -1202.1992878968033, -661.3435040445469, -1184.8200534990945, -648.4929241962805, -1003.0500086963953, -385.41038269148623, 148.408930492124, -998.5389446682223, -1145.9878166879366, -1343.664590891767, -647.9367515323069, -852.7887827766132, -158.92920978472725, -1243.972953507036, -919.4793532083107, -1114.2627881632511, -1152.6678130160335, -1056.1413853468498, -1226.710826805834, 33.49261526050825, -902.3752867315347, -1104.4730142348753, -1086.6556418429993, -1029.7836588336484, -1204.667803024344, -1499.3765282785776, -868.5244348473705, 16.72159085885485, -946.5080415673649, -736.2755192526572, -974.7939127303856, -1073.3144591265025, -117.54237170448664, -1167.972870024254, -90.15552574642975, -1258.3118747051155, -941.084639209615, -1459.6629656213397, -1181.660465445518, -718.275404925824, -1280.7843664615182, -828.9331380879737, 28.090090901592717, -1061.2735570385848, -868.2479225477485, -822.6668088776261, 113.98525639491015, -1097.3731700855205, -1127.149678608131, -1188.5431155340182, 179.14375212334488, -863.8851790427105, -1164.5621998125575, -1166.8614250103083, -790.3514830138718, -1490.2508375399261, 86.71857139152682, -1165.8309079608684, -1056.1196622251828, 291.1434419275504, -995.6775804643179, -1113.0213735353739, -1214.4123152818627, -911.1225583886312, -944.7826141292359, -1221.9021665967318, -1344.4206720198674, -488.30422276690035, 0.9042306141098209, 29.02908786082144, -1049.6402181291776, -970.5731859376058, -862.6838057824777, -635.2097290752575, -912.8300529966822, -1092.5710141930897, -661.9493028712722, -1185.3919221605252, -1074.500935822292, -864.3888269288053, -1274.9873446611214, -979.0551397962296, -1124.7775402818518, 376.5017728773215, -885.4681609045003, 167.71725594200774, -991.5360602711486, -1028.0254235487796, -17.06909136438298, -66.95971373067206, -1012.8746944601986, -879.5315368885642, -1105.5278290259266, 243.74013705127155, -1102.406590162366, -1235.8837561427056, -233.4846098500242, -1117.3840587488305, -1082.1184480333766], "policy_predator_policy_reward": [759.7244898394664, 372.7562944606864, 1089.7121206797622, 173.78664082363395, 738.1092658469048, 270.0260213686124, 763.420036525792, 813.7764286048044, 471.3448880777194, 604.8922835260059, 1132.6180320695796, 696.0189680286609, 119.38154388999827, 68.99551535868868, 1025.075532520944, 1297.300210526462, 696.7541618020953, 556.4110146567832, 674.9757949224158, 1127.6831355254637, 1277.2858716104067, 992.6723247678505, 533.1226094527434, 1097.0687200418774, 1122.7694261921781, 501.9273159464856, 967.9409147701277, 1214.6093490263784, 684.7373057585553, 785.3986718698666, 1183.1195540633764, 1443.5554900668176, 1298.4803436850011, 1353.6261662670158, 2.4091822461202885, 224.68626869174832, 1284.0552704402567, 1078.2744585840367, 1224.9690271917468, 624.480725658758, 1295.1895971699373, 1146.0778405995363, 1126.202167278729, 1033.5430522369813, 282.9845305270338, 1318.5016142817217, 1227.8073410340153, 1099.4818165436277, 782.8249933822682, 592.8498300246979, 316.5805233039433, 905.5243115230792, 948.6432492943095, 1099.5903842780288, 968.4193563092939, 398.52534880597807, 912.7030240259752, 1244.1527288263223, 930.1576521150655, 1453.401890338628, 1380.6395057934485, 1011.7143443702564, 1135.4401440719446, 224.37702205243912, 275.36649671207925, 411.1312965889356, 1005.5809218188845, 1078.4363811857036, 1053.4703793080632, 1327.6333396804341, 913.2839542832237, 1038.9819538430559, 653.2330693555193, 319.68807544652987, 270.5472679356509, 198.23601254255456, 820.7962515416732, 587.2330372431613, 1109.447615746783, 1236.0003758600762, 664.3043692835728, 1231.6629930182805, 272.4802074843308, 906.6108883110775, 660.3994924166863, 1206.0647214066155, 375.8577628293692, 943.319519597208, 283.7312796932606, 1108.3788336202272, 587.9778047265872, 1230.764491380165, 915.48654747154, 1591.6589516432064, 472.60431342758415, 906.8608353986103, 1081.0488310329617, 1066.9246613580758, 964.6442003611432, 280.4199626108697, 948.1249288502732, 1202.599287896803, 764.6336042022109, 1184.6617496745791, 967.3866828048809, 981.6326599250151, 187.50483298432664, 407.9376090943269, 1191.8678561900176, 1084.4676867065143, 1345.4645908917666, 666.52063500879, 954.9149028135881, 231.01211851415496, 1245.2729535070348, 924.168923826, 1128.0736175232712, 1152.6678130160335, 1075.5169171576779, 1260.1699328072373, 463.2764470628078, 642.9592802589323, 1104.4730142348753, 1089.8556418429994, 935.7027972192362, 1300.0583732797581, 1499.3765282785776, 878.1244348473712, 515.5983272712391, 607.1009134857811, 852.2755192526561, 983.7939127303855, 1074.736737453648, 313.61018113966395, 708.6672025482678, 704.1467478133897, 1275.2990574671305, 916.3644917058974, 1459.6629656213397, 1182.8604654455178, 817.4380275523107, 1280.7843664615182, 838.233138087974, 58.183401190966705, 1062.1735570385847, 898.9479225477487, 926.0510523195021, 214.8743091884167, 843.6962006852428, 1387.2466166935674, 1188.5431155340182, 17.150273162582238, 897.2130281142078, 1164.9231987447542, 1167.8614250103083, 801.5514830138742, 1490.7508375399261, 67.63046703050611, 1167.0309079608683, 1059.773764191432, 908.406639792574, 524.27799655487, 1111.8981433634247, 1218.2740191503424, 911.1225583886312, 949.0301773898593, 1282.050089987545, 1334.1091366135947, 142.4167462187716, 744.3778119059891, 215.5955767959954, 1019.7328023151609, 1006.4086013478721, 976.8164870899188, 733.7370489156076, 988.571689693816, 818.2179557386457, 1141.807640672001, 1185.3919221605252, 1075.500935822292, 958.0729869843148, 1248.5000472307395, 978.8402943099443, 1124.7775402818518, 530.977705600761, 783.6780928168815, 908.609974157502, 719.2144323550364, 971.0859398741923, 593.0425212213692, 739.6088253634457, 957.040550742774, 864.0912639078311, 1194.4629967502365, 598.303461022443, 941.7910738380349, 1158.5522220259177, 580.3916964816916, 1143.6821919529943, 1083.0536239409118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.997862476722123, "mean_inference_ms": 4.300813944138005, "mean_action_processing_ms": 1.7818130146046758, "mean_env_wait_ms": 11.744948612184482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006039857864379883, "StateBufferConnector_ms": 0.0054579973220825195, "ViewRequirementAgentConnector_ms": 0.4024543762207031}, "num_episodes": 12, "episode_return_max": 805.6894103904659, "episode_return_min": -7.732964741703721, "episode_return_mean": 186.71116771873477, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 148.71688419366677, "num_env_steps_trained_throughput_per_sec": 148.71688419366677, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 26035.335, "restore_workers_time_ms": 0.075, "training_step_time_ms": 26035.103, "sample_time_ms": 2417.157, "learn_time_ms": 23593.86, "learn_throughput": 169.536, "synch_weights_time_ms": 21.008}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 34, "trial_id": "0b608_00000", "date": "2024-08-22_13-59-49", "timestamp": 1724315389, "time_this_iter_s": 26.925943613052368, "time_total_s": 882.948230266571, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x312081af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 882.948230266571, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 38.047368421052624, "ram_util_percent": 83.27368421052631}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.696886310754, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.934575368992236, "policy_loss": -0.007759718031243042, "vf_loss": 7.941127341638797, "vf_explained_var": 0.37955806980688106, "kl": 0.006038712333547809, "entropy": 0.4625864526897511, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 32603.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.354004801896515, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.940098286179638, "policy_loss": -0.010634080314683535, "vf_loss": 7.949284974860136, "vf_explained_var": 0.6412872989341696, "kl": 0.0072371156475994555, "entropy": 0.8254206865552872, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 32603.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 805.6894103904659, "episode_reward_min": -7.732964741703721, "episode_reward_mean": 174.96369529861485, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1591.6589516432064, "predator_policy": 2.4091822461202885}, "policy_reward_max": {"prey_policy": 376.5017728773215, "predator_policy": 1591.6589516432064}, "policy_reward_mean": {"prey_policy": -811.2331165501921, "predator_policy": 898.7149641994994}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.261015784221765, 456.60605384117036, 40.3, 0.3148585164907689, 430.44149254401754, 1.0037457532207243, 208.84956340830416, 1.8245676098490762, 137.52525850227926, 69.65673048203126, 102.9379080163478, 400.0266968867681, 344.64342873914353, 63.18577045673963, 628.5993090479408, 14.290644928122257, 5.39999999999999, 43.10931852177673, 480.75247294012, 74.46628095558508, 87.36347054038966, 3.0870842973965864, 249.18092553281537, 159.97262917063534, 198.68996541202154, 446.610789542765, 1.4191503469543463, 151.5468473282976, 364.4683220281785, 31.20000000000006, 57.794089398826486, 211.20902290983358, 384.5243039237109, 0.7748427649074152, 400.01914403278056, 31.798621753339454, 121.60341949714604, 2.344339880319937, 103.13179633314726, 297.4764098372183, 358.4409898792912, 131.80878154037242, 20.38388347648314, 174.20902876640056, 5.989570617689042, 13.810829360020282, 52.83463781223085, 237.3530558507159, 3.2000000000000055, 1.3097086410023653, 9.60000000000002, 192.9127900485093, 124.99999999999994, 197.49008776232267, 154.68555459097468, -7.732964741703721, 1.2000000000000064, 99.16262262648567, 95.57349209255938, 31.59999999999998, 432.2438090252027, 6.419968685164406, 196.29402528592712, 33.68884800369396, 12.199999999999978, 154.8490384220333, 4.85410196624969, 728.150497810677, 2.73847369653246, 4.247563260623918, 49.83638798453936, 399.3945659719712, 214.71724884279988, 149.9680967177054, 174.26895653748355, 205.5052793462835, 0.9999999999999964, 67.19686262512664, -0.21484548628526445, 805.6894103904659, 804.0056021833975, 519.0339461824012, 616.8149679153485, 73.49489474358448, 681.4280817493842, 269.5755525148789, 27.233309111698695, 347.2412034108971, 413.9384405201989, 6.861159469577194, 6.1799451742635885, 15.339300566808511, 104.37104150188495, 248.42052613213997, 62.236465871076135, 556.1484470477285, 294.2025672745399, -3.1086244689504383e-15, 50.867610343028886, 38.6858192742844], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-957.6798989859043, -1214.6093490263784, -386.18973668770604, -627.3401870995451, -1143.1195540633764, -1443.2554900668176, -1298.1654851685103, -1353.6261662670158, 157.83660635406338, 45.509435252081545, -1284.0552704402567, -1077.270712830816, -1223.2696588634935, -417.33053057870313, -1294.6650295600882, -1144.7778405995364, -1140.4026364975598, -881.8173245158699, -214.32780004500265, -1317.5016142817217, -1079.0983917841597, -1145.2528577771363, -1247.6845835516467, 272.03645703144167, -297.5257229338551, -579.9356831540206, -950.3348835548625, -1034.7129795607361, -1023.603430255386, 285.2580341880528, -899.682632606728, -1242.8824753174458, -924.7576521150643, -1453.401890338628, -1336.8411455760463, -1012.4033860658822, -734.7391127865507, -144.32558039771283, -26.29383149524861, -585.7376808501778, -955.5366797005638, -1041.117152763634, -1051.970379308063, -1326.0462553830375, -670.3991878620485, -1032.685794731415, -165.36739891231366, -647.5811167191016, -298.8649714862429, 28.771656420064105, -896.4707176615266, -64.94778158054415, -1108.0284653998283, -1236.0003758600762, -1040.6959824366597, -703.7245325368988, 110.37008762423231, -924.9928613914626, -640.1994924166862, -1195.064721406615, -1057.8099001592827, -203.57329286847, -167.13127969325643, -1013.7698107103928, -201.0840260985786, -1233.1339660844624, -914.7117047066325, -1591.6589516432064, -995.2939292841645, 15.8479244907467, -1068.8509751779588, -1047.3238954597398, -926.8973464219523, -196.56339705291182, -946.1805889699534, -1202.1992878968033, -661.3435040445469, -1184.8200534990945, -648.4929241962805, -1003.0500086963953, -385.41038269148623, 148.408930492124, -998.5389446682223, -1145.9878166879366, -1343.664590891767, -647.9367515323069, -852.7887827766132, -158.92920978472725, -1243.972953507036, -919.4793532083107, -1114.2627881632511, -1152.6678130160335, -1056.1413853468498, -1226.710826805834, 33.49261526050825, -902.3752867315347, -1104.4730142348753, -1086.6556418429993, -1029.7836588336484, -1204.667803024344, -1499.3765282785776, -868.5244348473705, 16.72159085885485, -946.5080415673649, -736.2755192526572, -974.7939127303856, -1073.3144591265025, -117.54237170448664, -1167.972870024254, -90.15552574642975, -1258.3118747051155, -941.084639209615, -1459.6629656213397, -1181.660465445518, -718.275404925824, -1280.7843664615182, -828.9331380879737, 28.090090901592717, -1061.2735570385848, -868.2479225477485, -822.6668088776261, 113.98525639491015, -1097.3731700855205, -1127.149678608131, -1188.5431155340182, 179.14375212334488, -863.8851790427105, -1164.5621998125575, -1166.8614250103083, -790.3514830138718, -1490.2508375399261, 86.71857139152682, -1165.8309079608684, -1056.1196622251828, 291.1434419275504, -995.6775804643179, -1113.0213735353739, -1214.4123152818627, -911.1225583886312, -944.7826141292359, -1221.9021665967318, -1344.4206720198674, -488.30422276690035, 0.9042306141098209, 29.02908786082144, -1049.6402181291776, -970.5731859376058, -862.6838057824777, -635.2097290752575, -912.8300529966822, -1092.5710141930897, -661.9493028712722, -1185.3919221605252, -1074.500935822292, -864.3888269288053, -1274.9873446611214, -979.0551397962296, -1124.7775402818518, 376.5017728773215, -885.4681609045003, 167.71725594200774, -991.5360602711486, -1028.0254235487796, -17.06909136438298, -66.95971373067206, -1012.8746944601986, -879.5315368885642, -1105.5278290259266, 243.74013705127155, -1102.406590162366, -1235.8837561427056, -233.4846098500242, -1117.3840587488305, -1082.1184480333766, -478.9463716305371, -247.61182543357495, -5.524414051058894, -1010.878150595379, -1252.2359494883492, -1296.0424684103773, -1288.512980140408, -866.3832590161367, -1190.7172730050722, -751.1964459311683, -975.652267512613, -697.2261875976234, -1299.9100294902642, 43.00594449871691, -187.48523848737335, -1153.0231510893173, -1286.8140443659613, 274.8325118989626, -1467.958478652196, -325.63406595503585, -1182.6039474550464, -1084.1452422551295, -558.7087759351296, -764.3018478871113, -1112.8254755889755, -1047.9379318679346], "policy_predator_policy_reward": [967.9409147701277, 1214.6093490263784, 684.7373057585553, 785.3986718698666, 1183.1195540633764, 1443.5554900668176, 1298.4803436850011, 1353.6261662670158, 2.4091822461202885, 224.68626869174832, 1284.0552704402567, 1078.2744585840367, 1224.9690271917468, 624.480725658758, 1295.1895971699373, 1146.0778405995363, 1126.202167278729, 1033.5430522369813, 282.9845305270338, 1318.5016142817217, 1227.8073410340153, 1099.4818165436277, 782.8249933822682, 592.8498300246979, 316.5805233039433, 905.5243115230792, 948.6432492943095, 1099.5903842780288, 968.4193563092939, 398.52534880597807, 912.7030240259752, 1244.1527288263223, 930.1576521150655, 1453.401890338628, 1380.6395057934485, 1011.7143443702564, 1135.4401440719446, 224.37702205243912, 275.36649671207925, 411.1312965889356, 1005.5809218188845, 1078.4363811857036, 1053.4703793080632, 1327.6333396804341, 913.2839542832237, 1038.9819538430559, 653.2330693555193, 319.68807544652987, 270.5472679356509, 198.23601254255456, 820.7962515416732, 587.2330372431613, 1109.447615746783, 1236.0003758600762, 664.3043692835728, 1231.6629930182805, 272.4802074843308, 906.6108883110775, 660.3994924166863, 1206.0647214066155, 375.8577628293692, 943.319519597208, 283.7312796932606, 1108.3788336202272, 587.9778047265872, 1230.764491380165, 915.48654747154, 1591.6589516432064, 472.60431342758415, 906.8608353986103, 1081.0488310329617, 1066.9246613580758, 964.6442003611432, 280.4199626108697, 948.1249288502732, 1202.599287896803, 764.6336042022109, 1184.6617496745791, 967.3866828048809, 981.6326599250151, 187.50483298432664, 407.9376090943269, 1191.8678561900176, 1084.4676867065143, 1345.4645908917666, 666.52063500879, 954.9149028135881, 231.01211851415496, 1245.2729535070348, 924.168923826, 1128.0736175232712, 1152.6678130160335, 1075.5169171576779, 1260.1699328072373, 463.2764470628078, 642.9592802589323, 1104.4730142348753, 1089.8556418429994, 935.7027972192362, 1300.0583732797581, 1499.3765282785776, 878.1244348473712, 515.5983272712391, 607.1009134857811, 852.2755192526561, 983.7939127303855, 1074.736737453648, 313.61018113966395, 708.6672025482678, 704.1467478133897, 1275.2990574671305, 916.3644917058974, 1459.6629656213397, 1182.8604654455178, 817.4380275523107, 1280.7843664615182, 838.233138087974, 58.183401190966705, 1062.1735570385847, 898.9479225477487, 926.0510523195021, 214.8743091884167, 843.6962006852428, 1387.2466166935674, 1188.5431155340182, 17.150273162582238, 897.2130281142078, 1164.9231987447542, 1167.8614250103083, 801.5514830138742, 1490.7508375399261, 67.63046703050611, 1167.0309079608683, 1059.773764191432, 908.406639792574, 524.27799655487, 1111.8981433634247, 1218.2740191503424, 911.1225583886312, 949.0301773898593, 1282.050089987545, 1334.1091366135947, 142.4167462187716, 744.3778119059891, 215.5955767959954, 1019.7328023151609, 1006.4086013478721, 976.8164870899188, 733.7370489156076, 988.571689693816, 818.2179557386457, 1141.807640672001, 1185.3919221605252, 1075.500935822292, 958.0729869843148, 1248.5000472307395, 978.8402943099443, 1124.7775402818518, 530.977705600761, 783.6780928168815, 908.609974157502, 719.2144323550364, 971.0859398741923, 593.0425212213692, 739.6088253634457, 957.040550742774, 864.0912639078311, 1194.4629967502365, 598.303461022443, 941.7910738380349, 1158.5522220259177, 580.3916964816916, 1143.6821919529943, 1083.0536239409118, 13.352129525738663, 1060.44727094927, 426.24479096763594, 1004.0962141990013, 1252.2359494883492, 1302.9036278799547, 1288.512980140408, 872.5632041904003, 1191.9172730050711, 765.3357464979773, 983.3522675126147, 793.8972290995086, 1299.9100294902642, 205.41458163342304, 328.9906859973102, 1073.754169450456, 758.9554338162377, 809.1745456984862, 1437.582355431176, 650.2127564505981, 1182.6039474550464, 1084.1452422551295, 439.43879180480684, 934.439442360461, 1172.3797964186053, 1027.0694303125886]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.0009718421844385, "mean_inference_ms": 4.313072083851219, "mean_action_processing_ms": 1.7829605820249095, "mean_env_wait_ms": 11.787802804126557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006211280822753906, "StateBufferConnector_ms": 0.0054045915603637695, "ViewRequirementAgentConnector_ms": 0.40064334869384766}, "num_episodes": 13, "episode_return_max": 805.6894103904659, "episode_return_min": -7.732964741703721, "episode_return_mean": 174.96369529861485, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.48867953355315, "num_env_steps_trained_throughput_per_sec": 154.48867953355315, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 26015.919, "restore_workers_time_ms": 0.075, "training_step_time_ms": 26015.692, "sample_time_ms": 2436.24, "learn_time_ms": 23556.917, "learn_throughput": 169.802, "synch_weights_time_ms": 19.584}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 35, "trial_id": "0b608_00000", "date": "2024-08-22_14-00-15", "timestamp": 1724315415, "time_this_iter_s": 25.9698166847229, "time_total_s": 908.918046951294, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a3b4dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 908.918046951294, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 33.48918918918919, "ram_util_percent": 83.17567567567568}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.270824563440192, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.0560630258429, "policy_loss": -0.009978204073197154, "vf_loss": 8.064207215283913, "vf_explained_var": 0.3437737715938104, "kl": 0.009170122250973705, "entropy": 0.45386221853513564, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33548.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.11843405085266, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.205702550575216, "policy_loss": -0.01012762493118841, "vf_loss": 8.214004562014626, "vf_explained_var": 0.595515844430873, "kl": 0.009127919538754714, "entropy": 0.8070840821695076, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33548.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 805.6894103904659, "episode_reward_min": -7.732964741703721, "episode_reward_mean": 178.2369047663041, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1591.6589516432064, "predator_policy": 13.352129525738663}, "policy_reward_max": {"prey_policy": 376.5017728773215, "predator_policy": 1591.6589516432064}, "policy_reward_mean": {"prey_policy": -793.3824324156705, "predator_policy": 882.5008847988225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [400.0266968867681, 344.64342873914353, 63.18577045673963, 628.5993090479408, 14.290644928122257, 5.39999999999999, 43.10931852177673, 480.75247294012, 74.46628095558508, 87.36347054038966, 3.0870842973965864, 249.18092553281537, 159.97262917063534, 198.68996541202154, 446.610789542765, 1.4191503469543463, 151.5468473282976, 364.4683220281785, 31.20000000000006, 57.794089398826486, 211.20902290983358, 384.5243039237109, 0.7748427649074152, 400.01914403278056, 31.798621753339454, 121.60341949714604, 2.344339880319937, 103.13179633314726, 297.4764098372183, 358.4409898792912, 131.80878154037242, 20.38388347648314, 174.20902876640056, 5.989570617689042, 13.810829360020282, 52.83463781223085, 237.3530558507159, 3.2000000000000055, 1.3097086410023653, 9.60000000000002, 192.9127900485093, 124.99999999999994, 197.49008776232267, 154.68555459097468, -7.732964741703721, 1.2000000000000064, 99.16262262648567, 95.57349209255938, 31.59999999999998, 432.2438090252027, 6.419968685164406, 196.29402528592712, 33.68884800369396, 12.199999999999978, 154.8490384220333, 4.85410196624969, 728.150497810677, 2.73847369653246, 4.247563260623918, 49.83638798453936, 399.3945659719712, 214.71724884279988, 149.9680967177054, 174.26895653748355, 205.5052793462835, 0.9999999999999964, 67.19686262512664, -0.21484548628526445, 805.6894103904659, 804.0056021833975, 519.0339461824012, 616.8149679153485, 73.49489474358448, 681.4280817493842, 269.5755525148789, 27.233309111698695, 347.2412034108971, 413.9384405201989, 6.861159469577194, 6.1799451742635885, 15.339300566808511, 104.37104150188495, 248.42052613213997, 62.236465871076135, 556.1484470477285, 294.2025672745399, -3.1086244689504383e-15, 50.867610343028886, 38.6858192742844, 123.39999999999995, 49.17546691300083, 403.11242863684265, -1.4760775350272337, 4.799999999999999, 73.37694214166828, 20.336700365192648, 172.57757453100524, 210.79643785031408, 579.8237927937749, 151.11887553009066], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1247.6845835516467, 272.03645703144167, -297.5257229338551, -579.9356831540206, -950.3348835548625, -1034.7129795607361, -1023.603430255386, 285.2580341880528, -899.682632606728, -1242.8824753174458, -924.7576521150643, -1453.401890338628, -1336.8411455760463, -1012.4033860658822, -734.7391127865507, -144.32558039771283, -26.29383149524861, -585.7376808501778, -955.5366797005638, -1041.117152763634, -1051.970379308063, -1326.0462553830375, -670.3991878620485, -1032.685794731415, -165.36739891231366, -647.5811167191016, -298.8649714862429, 28.771656420064105, -896.4707176615266, -64.94778158054415, -1108.0284653998283, -1236.0003758600762, -1040.6959824366597, -703.7245325368988, 110.37008762423231, -924.9928613914626, -640.1994924166862, -1195.064721406615, -1057.8099001592827, -203.57329286847, -167.13127969325643, -1013.7698107103928, -201.0840260985786, -1233.1339660844624, -914.7117047066325, -1591.6589516432064, -995.2939292841645, 15.8479244907467, -1068.8509751779588, -1047.3238954597398, -926.8973464219523, -196.56339705291182, -946.1805889699534, -1202.1992878968033, -661.3435040445469, -1184.8200534990945, -648.4929241962805, -1003.0500086963953, -385.41038269148623, 148.408930492124, -998.5389446682223, -1145.9878166879366, -1343.664590891767, -647.9367515323069, -852.7887827766132, -158.92920978472725, -1243.972953507036, -919.4793532083107, -1114.2627881632511, -1152.6678130160335, -1056.1413853468498, -1226.710826805834, 33.49261526050825, -902.3752867315347, -1104.4730142348753, -1086.6556418429993, -1029.7836588336484, -1204.667803024344, -1499.3765282785776, -868.5244348473705, 16.72159085885485, -946.5080415673649, -736.2755192526572, -974.7939127303856, -1073.3144591265025, -117.54237170448664, -1167.972870024254, -90.15552574642975, -1258.3118747051155, -941.084639209615, -1459.6629656213397, -1181.660465445518, -718.275404925824, -1280.7843664615182, -828.9331380879737, 28.090090901592717, -1061.2735570385848, -868.2479225477485, -822.6668088776261, 113.98525639491015, -1097.3731700855205, -1127.149678608131, -1188.5431155340182, 179.14375212334488, -863.8851790427105, -1164.5621998125575, -1166.8614250103083, -790.3514830138718, -1490.2508375399261, 86.71857139152682, -1165.8309079608684, -1056.1196622251828, 291.1434419275504, -995.6775804643179, -1113.0213735353739, -1214.4123152818627, -911.1225583886312, -944.7826141292359, -1221.9021665967318, -1344.4206720198674, -488.30422276690035, 0.9042306141098209, 29.02908786082144, -1049.6402181291776, -970.5731859376058, -862.6838057824777, -635.2097290752575, -912.8300529966822, -1092.5710141930897, -661.9493028712722, -1185.3919221605252, -1074.500935822292, -864.3888269288053, -1274.9873446611214, -979.0551397962296, -1124.7775402818518, 376.5017728773215, -885.4681609045003, 167.71725594200774, -991.5360602711486, -1028.0254235487796, -17.06909136438298, -66.95971373067206, -1012.8746944601986, -879.5315368885642, -1105.5278290259266, 243.74013705127155, -1102.406590162366, -1235.8837561427056, -233.4846098500242, -1117.3840587488305, -1082.1184480333766, -478.9463716305371, -247.61182543357495, -5.524414051058894, -1010.878150595379, -1252.2359494883492, -1296.0424684103773, -1288.512980140408, -866.3832590161367, -1190.7172730050722, -751.1964459311683, -975.652267512613, -697.2261875976234, -1299.9100294902642, 43.00594449871691, -187.48523848737335, -1153.0231510893173, -1286.8140443659613, 274.8325118989626, -1467.958478652196, -325.63406595503585, -1182.6039474550464, -1084.1452422551295, -558.7087759351296, -764.3018478871113, -1112.8254755889755, -1047.9379318679346, -642.0919931765353, -681.7144933265592, -1112.2992962178726, -716.8650669392824, 279.1543365836583, -927.2584546977121, -902.5924474259597, -1177.7074679115121, -1014.4047777143929, -1314.5169392580624, -1205.8241972404142, -476.5487826045771, -1111.949760473876, -1107.5085263313397, 41.52137905014392, -1028.7874336923467, -1101.9508081172348, -268.21182651186314, -1026.7413780504576, -47.84478459438685, -25.73077032647893, -1300.3991776520886], "policy_predator_policy_reward": [782.8249933822682, 592.8498300246979, 316.5805233039433, 905.5243115230792, 948.6432492943095, 1099.5903842780288, 968.4193563092939, 398.52534880597807, 912.7030240259752, 1244.1527288263223, 930.1576521150655, 1453.401890338628, 1380.6395057934485, 1011.7143443702564, 1135.4401440719446, 224.37702205243912, 275.36649671207925, 411.1312965889356, 1005.5809218188845, 1078.4363811857036, 1053.4703793080632, 1327.6333396804341, 913.2839542832237, 1038.9819538430559, 653.2330693555193, 319.68807544652987, 270.5472679356509, 198.23601254255456, 820.7962515416732, 587.2330372431613, 1109.447615746783, 1236.0003758600762, 664.3043692835728, 1231.6629930182805, 272.4802074843308, 906.6108883110775, 660.3994924166863, 1206.0647214066155, 375.8577628293692, 943.319519597208, 283.7312796932606, 1108.3788336202272, 587.9778047265872, 1230.764491380165, 915.48654747154, 1591.6589516432064, 472.60431342758415, 906.8608353986103, 1081.0488310329617, 1066.9246613580758, 964.6442003611432, 280.4199626108697, 948.1249288502732, 1202.599287896803, 764.6336042022109, 1184.6617496745791, 967.3866828048809, 981.6326599250151, 187.50483298432664, 407.9376090943269, 1191.8678561900176, 1084.4676867065143, 1345.4645908917666, 666.52063500879, 954.9149028135881, 231.01211851415496, 1245.2729535070348, 924.168923826, 1128.0736175232712, 1152.6678130160335, 1075.5169171576779, 1260.1699328072373, 463.2764470628078, 642.9592802589323, 1104.4730142348753, 1089.8556418429994, 935.7027972192362, 1300.0583732797581, 1499.3765282785776, 878.1244348473712, 515.5983272712391, 607.1009134857811, 852.2755192526561, 983.7939127303855, 1074.736737453648, 313.61018113966395, 708.6672025482678, 704.1467478133897, 1275.2990574671305, 916.3644917058974, 1459.6629656213397, 1182.8604654455178, 817.4380275523107, 1280.7843664615182, 838.233138087974, 58.183401190966705, 1062.1735570385847, 898.9479225477487, 926.0510523195021, 214.8743091884167, 843.6962006852428, 1387.2466166935674, 1188.5431155340182, 17.150273162582238, 897.2130281142078, 1164.9231987447542, 1167.8614250103083, 801.5514830138742, 1490.7508375399261, 67.63046703050611, 1167.0309079608683, 1059.773764191432, 908.406639792574, 524.27799655487, 1111.8981433634247, 1218.2740191503424, 911.1225583886312, 949.0301773898593, 1282.050089987545, 1334.1091366135947, 142.4167462187716, 744.3778119059891, 215.5955767959954, 1019.7328023151609, 1006.4086013478721, 976.8164870899188, 733.7370489156076, 988.571689693816, 818.2179557386457, 1141.807640672001, 1185.3919221605252, 1075.500935822292, 958.0729869843148, 1248.5000472307395, 978.8402943099443, 1124.7775402818518, 530.977705600761, 783.6780928168815, 908.609974157502, 719.2144323550364, 971.0859398741923, 593.0425212213692, 739.6088253634457, 957.040550742774, 864.0912639078311, 1194.4629967502365, 598.303461022443, 941.7910738380349, 1158.5522220259177, 580.3916964816916, 1143.6821919529943, 1083.0536239409118, 13.352129525738663, 1060.44727094927, 426.24479096763594, 1004.0962141990013, 1252.2359494883492, 1302.9036278799547, 1288.512980140408, 872.5632041904003, 1191.9172730050711, 765.3357464979773, 983.3522675126147, 793.8972290995086, 1299.9100294902642, 205.41458163342304, 328.9906859973102, 1073.754169450456, 758.9554338162377, 809.1745456984862, 1437.582355431176, 650.2127564505981, 1182.6039474550464, 1084.1452422551295, 439.43879180480684, 934.439442360461, 1172.3797964186053, 1027.0694303125886, 736.5666182013675, 710.6398683017256, 1022.2970186235818, 856.0428114465743, 212.21693283129912, 838.9996139195962, 900.6447027215746, 1178.17913508087, 1019.204777714393, 1314.5169392580624, 1128.9066973232316, 626.8432246634333, 1111.5955750705248, 1128.199412099883, 210.92799683267538, 948.9156323405334, 1101.1845480395552, 479.7745244398585, 734.363571980396, 920.0463834582212, 176.84964585656962, 1300.3991776520886]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.994994067151468, "mean_inference_ms": 4.318566835953237, "mean_action_processing_ms": 1.806766542873646, "mean_env_wait_ms": 11.83263392358289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005458474159240723, "StateBufferConnector_ms": 0.005258440971374512, "ViewRequirementAgentConnector_ms": 0.38833844661712646}, "num_episodes": 11, "episode_return_max": 805.6894103904659, "episode_return_min": -7.732964741703721, "episode_return_mean": 178.2369047663041, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.48483847722463, "num_env_steps_trained_throughput_per_sec": 155.48483847722463, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 25998.753, "restore_workers_time_ms": 0.073, "training_step_time_ms": 25998.519, "sample_time_ms": 2455.288, "learn_time_ms": 23519.39, "learn_throughput": 170.072, "synch_weights_time_ms": 20.58}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 36, "trial_id": "0b608_00000", "date": "2024-08-22_14-00-41", "timestamp": 1724315441, "time_this_iter_s": 25.773555994033813, "time_total_s": 934.6916029453278, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31207cca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 934.6916029453278, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 32.23888888888889, "ram_util_percent": 82.91388888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.06415643477566, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.320100021866894, "policy_loss": -0.007367720874765562, "vf_loss": 8.32620574608051, "vf_explained_var": 0.3345318601244972, "kl": 0.006309927506224503, "entropy": 0.3799194628284091, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34493.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.949786489981193, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.275301332322378, "policy_loss": -0.01046136450318117, "vf_loss": 8.284321610385147, "vf_explained_var": 0.6706762952148599, "kl": 0.007205437303141311, "entropy": 0.7468232564825229, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34493.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 1042.3641601111206, "episode_reward_min": -7.732964741703721, "episode_reward_mean": 189.6512930724557, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1591.6589516432064, "predator_policy": 13.352129525738663}, "policy_reward_max": {"prey_policy": 376.5017728773215, "predator_policy": 1591.6589516432064}, "policy_reward_mean": {"prey_policy": -777.4464539080378, "predator_policy": 872.2721004442657}, "custom_metrics": {}, "hist_stats": {"episode_reward": [159.97262917063534, 198.68996541202154, 446.610789542765, 1.4191503469543463, 151.5468473282976, 364.4683220281785, 31.20000000000006, 57.794089398826486, 211.20902290983358, 384.5243039237109, 0.7748427649074152, 400.01914403278056, 31.798621753339454, 121.60341949714604, 2.344339880319937, 103.13179633314726, 297.4764098372183, 358.4409898792912, 131.80878154037242, 20.38388347648314, 174.20902876640056, 5.989570617689042, 13.810829360020282, 52.83463781223085, 237.3530558507159, 3.2000000000000055, 1.3097086410023653, 9.60000000000002, 192.9127900485093, 124.99999999999994, 197.49008776232267, 154.68555459097468, -7.732964741703721, 1.2000000000000064, 99.16262262648567, 95.57349209255938, 31.59999999999998, 432.2438090252027, 6.419968685164406, 196.29402528592712, 33.68884800369396, 12.199999999999978, 154.8490384220333, 4.85410196624969, 728.150497810677, 2.73847369653246, 4.247563260623918, 49.83638798453936, 399.3945659719712, 214.71724884279988, 149.9680967177054, 174.26895653748355, 205.5052793462835, 0.9999999999999964, 67.19686262512664, -0.21484548628526445, 805.6894103904659, 804.0056021833975, 519.0339461824012, 616.8149679153485, 73.49489474358448, 681.4280817493842, 269.5755525148789, 27.233309111698695, 347.2412034108971, 413.9384405201989, 6.861159469577194, 6.1799451742635885, 15.339300566808511, 104.37104150188495, 248.42052613213997, 62.236465871076135, 556.1484470477285, 294.2025672745399, -3.1086244689504383e-15, 50.867610343028886, 38.6858192742844, 123.39999999999995, 49.17546691300083, 403.11242863684265, -1.4760775350272337, 4.799999999999999, 73.37694214166828, 20.336700365192648, 172.57757453100524, 210.79643785031408, 579.8237927937749, 151.11887553009066, 6.0, 952.3499264947486, 351.11746631577785, 347.0555391642599, 213.25426491837237, 144.38191604192215, -1.8207657603852567e-14, 1042.3641601111206, 0.3386193113504117, 408.08388347648565, 70.05759294851774, 0.5408646793972702], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-165.36739891231366, -647.5811167191016, -298.8649714862429, 28.771656420064105, -896.4707176615266, -64.94778158054415, -1108.0284653998283, -1236.0003758600762, -1040.6959824366597, -703.7245325368988, 110.37008762423231, -924.9928613914626, -640.1994924166862, -1195.064721406615, -1057.8099001592827, -203.57329286847, -167.13127969325643, -1013.7698107103928, -201.0840260985786, -1233.1339660844624, -914.7117047066325, -1591.6589516432064, -995.2939292841645, 15.8479244907467, -1068.8509751779588, -1047.3238954597398, -926.8973464219523, -196.56339705291182, -946.1805889699534, -1202.1992878968033, -661.3435040445469, -1184.8200534990945, -648.4929241962805, -1003.0500086963953, -385.41038269148623, 148.408930492124, -998.5389446682223, -1145.9878166879366, -1343.664590891767, -647.9367515323069, -852.7887827766132, -158.92920978472725, -1243.972953507036, -919.4793532083107, -1114.2627881632511, -1152.6678130160335, -1056.1413853468498, -1226.710826805834, 33.49261526050825, -902.3752867315347, -1104.4730142348753, -1086.6556418429993, -1029.7836588336484, -1204.667803024344, -1499.3765282785776, -868.5244348473705, 16.72159085885485, -946.5080415673649, -736.2755192526572, -974.7939127303856, -1073.3144591265025, -117.54237170448664, -1167.972870024254, -90.15552574642975, -1258.3118747051155, -941.084639209615, -1459.6629656213397, -1181.660465445518, -718.275404925824, -1280.7843664615182, -828.9331380879737, 28.090090901592717, -1061.2735570385848, -868.2479225477485, -822.6668088776261, 113.98525639491015, -1097.3731700855205, -1127.149678608131, -1188.5431155340182, 179.14375212334488, -863.8851790427105, -1164.5621998125575, -1166.8614250103083, -790.3514830138718, -1490.2508375399261, 86.71857139152682, -1165.8309079608684, -1056.1196622251828, 291.1434419275504, -995.6775804643179, -1113.0213735353739, -1214.4123152818627, -911.1225583886312, -944.7826141292359, -1221.9021665967318, -1344.4206720198674, -488.30422276690035, 0.9042306141098209, 29.02908786082144, -1049.6402181291776, -970.5731859376058, -862.6838057824777, -635.2097290752575, -912.8300529966822, -1092.5710141930897, -661.9493028712722, -1185.3919221605252, -1074.500935822292, -864.3888269288053, -1274.9873446611214, -979.0551397962296, -1124.7775402818518, 376.5017728773215, -885.4681609045003, 167.71725594200774, -991.5360602711486, -1028.0254235487796, -17.06909136438298, -66.95971373067206, -1012.8746944601986, -879.5315368885642, -1105.5278290259266, 243.74013705127155, -1102.406590162366, -1235.8837561427056, -233.4846098500242, -1117.3840587488305, -1082.1184480333766, -478.9463716305371, -247.61182543357495, -5.524414051058894, -1010.878150595379, -1252.2359494883492, -1296.0424684103773, -1288.512980140408, -866.3832590161367, -1190.7172730050722, -751.1964459311683, -975.652267512613, -697.2261875976234, -1299.9100294902642, 43.00594449871691, -187.48523848737335, -1153.0231510893173, -1286.8140443659613, 274.8325118989626, -1467.958478652196, -325.63406595503585, -1182.6039474550464, -1084.1452422551295, -558.7087759351296, -764.3018478871113, -1112.8254755889755, -1047.9379318679346, -642.0919931765353, -681.7144933265592, -1112.2992962178726, -716.8650669392824, 279.1543365836583, -927.2584546977121, -902.5924474259597, -1177.7074679115121, -1014.4047777143929, -1314.5169392580624, -1205.8241972404142, -476.5487826045771, -1111.949760473876, -1107.5085263313397, 41.52137905014392, -1028.7874336923467, -1101.9508081172348, -268.21182651186314, -1026.7413780504576, -47.84478459438685, -25.73077032647893, -1300.3991776520886, -1220.1676643749604, -1282.5417365034873, -814.3950516108503, 338.2418416621258, -1111.035378406077, 320.60750850635077, -883.8086875807192, -203.3970213437684, -710.4699860450578, 67.15762441397696, -1157.2467774891934, 38.97326212756845, -1397.954728914867, -1235.3706653496374, -994.0424515883385, 317.5838351634971, -1037.4106574043499, -1260.9198383086261, 339.9636348113893, -248.42491412672285, -797.3011150535269, -486.9554638075913, -1362.2080840231106, -1047.0054123167465], "policy_predator_policy_reward": [653.2330693555193, 319.68807544652987, 270.5472679356509, 198.23601254255456, 820.7962515416732, 587.2330372431613, 1109.447615746783, 1236.0003758600762, 664.3043692835728, 1231.6629930182805, 272.4802074843308, 906.6108883110775, 660.3994924166863, 1206.0647214066155, 375.8577628293692, 943.319519597208, 283.7312796932606, 1108.3788336202272, 587.9778047265872, 1230.764491380165, 915.48654747154, 1591.6589516432064, 472.60431342758415, 906.8608353986103, 1081.0488310329617, 1066.9246613580758, 964.6442003611432, 280.4199626108697, 948.1249288502732, 1202.599287896803, 764.6336042022109, 1184.6617496745791, 967.3866828048809, 981.6326599250151, 187.50483298432664, 407.9376090943269, 1191.8678561900176, 1084.4676867065143, 1345.4645908917666, 666.52063500879, 954.9149028135881, 231.01211851415496, 1245.2729535070348, 924.168923826, 1128.0736175232712, 1152.6678130160335, 1075.5169171576779, 1260.1699328072373, 463.2764470628078, 642.9592802589323, 1104.4730142348753, 1089.8556418429994, 935.7027972192362, 1300.0583732797581, 1499.3765282785776, 878.1244348473712, 515.5983272712391, 607.1009134857811, 852.2755192526561, 983.7939127303855, 1074.736737453648, 313.61018113966395, 708.6672025482678, 704.1467478133897, 1275.2990574671305, 916.3644917058974, 1459.6629656213397, 1182.8604654455178, 817.4380275523107, 1280.7843664615182, 838.233138087974, 58.183401190966705, 1062.1735570385847, 898.9479225477487, 926.0510523195021, 214.8743091884167, 843.6962006852428, 1387.2466166935674, 1188.5431155340182, 17.150273162582238, 897.2130281142078, 1164.9231987447542, 1167.8614250103083, 801.5514830138742, 1490.7508375399261, 67.63046703050611, 1167.0309079608683, 1059.773764191432, 908.406639792574, 524.27799655487, 1111.8981433634247, 1218.2740191503424, 911.1225583886312, 949.0301773898593, 1282.050089987545, 1334.1091366135947, 142.4167462187716, 744.3778119059891, 215.5955767959954, 1019.7328023151609, 1006.4086013478721, 976.8164870899188, 733.7370489156076, 988.571689693816, 818.2179557386457, 1141.807640672001, 1185.3919221605252, 1075.500935822292, 958.0729869843148, 1248.5000472307395, 978.8402943099443, 1124.7775402818518, 530.977705600761, 783.6780928168815, 908.609974157502, 719.2144323550364, 971.0859398741923, 593.0425212213692, 739.6088253634457, 957.040550742774, 864.0912639078311, 1194.4629967502365, 598.303461022443, 941.7910738380349, 1158.5522220259177, 580.3916964816916, 1143.6821919529943, 1083.0536239409118, 13.352129525738663, 1060.44727094927, 426.24479096763594, 1004.0962141990013, 1252.2359494883492, 1302.9036278799547, 1288.512980140408, 872.5632041904003, 1191.9172730050711, 765.3357464979773, 983.3522675126147, 793.8972290995086, 1299.9100294902642, 205.41458163342304, 328.9906859973102, 1073.754169450456, 758.9554338162377, 809.1745456984862, 1437.582355431176, 650.2127564505981, 1182.6039474550464, 1084.1452422551295, 439.43879180480684, 934.439442360461, 1172.3797964186053, 1027.0694303125886, 736.5666182013675, 710.6398683017256, 1022.2970186235818, 856.0428114465743, 212.21693283129912, 838.9996139195962, 900.6447027215746, 1178.17913508087, 1019.204777714393, 1314.5169392580624, 1128.9066973232316, 626.8432246634333, 1111.5955750705248, 1128.199412099883, 210.92799683267538, 948.9156323405334, 1101.1845480395552, 479.7745244398585, 734.363571980396, 920.0463834582212, 176.84964585656962, 1300.3991776520886, 1226.1676643749604, 1282.5417365034873, 703.451692047147, 725.0514443963242, 1111.035378406077, 30.509957809427267, 840.226597938208, 594.0346501505402, 445.61769976269585, 410.94892678675825, 1157.0786214606446, 105.5768099429033, 1397.954728914867, 1235.3706653496374, 806.5866542549654, 912.2361222809982, 1037.61065740435, 1261.0584576199767, 41.32024866509391, 275.2249141267266, 572.9693435576796, 781.344828251957, 1265.4095610688862, 1144.3447999503696]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.0138334363765855, "mean_inference_ms": 4.33808556802669, "mean_action_processing_ms": 1.7924639228039565, "mean_env_wait_ms": 11.881787686723198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005501508712768555, "StateBufferConnector_ms": 0.005240678787231445, "ViewRequirementAgentConnector_ms": 0.3979414701461792}, "num_episodes": 12, "episode_return_max": 1042.3641601111206, "episode_return_min": -7.732964741703721, "episode_return_mean": 189.6512930724557, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.63221381159983, "num_env_steps_trained_throughput_per_sec": 156.63221381159983, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 25973.963, "restore_workers_time_ms": 0.074, "training_step_time_ms": 25973.718, "sample_time_ms": 2458.864, "learn_time_ms": 23490.986, "learn_throughput": 170.278, "synch_weights_time_ms": 20.586}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 37, "trial_id": "0b608_00000", "date": "2024-08-22_14-01-06", "timestamp": 1724315466, "time_this_iter_s": 25.588272094726562, "time_total_s": 960.2798750400543, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a3c3820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 960.2798750400543, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 31.410810810810805, "ram_util_percent": 83.05675675675673}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.859678470520747, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.23927266004855, "policy_loss": -0.006859861015189419, "vf_loss": 8.245140816925694, "vf_explained_var": 0.32320574490481585, "kl": 0.004958532118637647, "entropy": 0.36728769793081534, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 35438.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.424331958457906, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.394229816759704, "policy_loss": -0.012072057011118405, "vf_loss": 8.404760166450783, "vf_explained_var": 0.6328425288200379, "kl": 0.007708571191197114, "entropy": 0.7332224381033075, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 35438.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 1042.3641601111206, "episode_reward_min": -7.732964741703721, "episode_reward_mean": 193.02320982076813, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1499.3765282785776, "predator_policy": 13.352129525738663}, "policy_reward_max": {"prey_policy": 376.5017728773215, "predator_policy": 1499.3765282785776}, "policy_reward_mean": {"prey_policy": -793.3259435831625, "predator_policy": 889.8375484935466}, "custom_metrics": {}, "hist_stats": {"episode_reward": [121.60341949714604, 2.344339880319937, 103.13179633314726, 297.4764098372183, 358.4409898792912, 131.80878154037242, 20.38388347648314, 174.20902876640056, 5.989570617689042, 13.810829360020282, 52.83463781223085, 237.3530558507159, 3.2000000000000055, 1.3097086410023653, 9.60000000000002, 192.9127900485093, 124.99999999999994, 197.49008776232267, 154.68555459097468, -7.732964741703721, 1.2000000000000064, 99.16262262648567, 95.57349209255938, 31.59999999999998, 432.2438090252027, 6.419968685164406, 196.29402528592712, 33.68884800369396, 12.199999999999978, 154.8490384220333, 4.85410196624969, 728.150497810677, 2.73847369653246, 4.247563260623918, 49.83638798453936, 399.3945659719712, 214.71724884279988, 149.9680967177054, 174.26895653748355, 205.5052793462835, 0.9999999999999964, 67.19686262512664, -0.21484548628526445, 805.6894103904659, 804.0056021833975, 519.0339461824012, 616.8149679153485, 73.49489474358448, 681.4280817493842, 269.5755525148789, 27.233309111698695, 347.2412034108971, 413.9384405201989, 6.861159469577194, 6.1799451742635885, 15.339300566808511, 104.37104150188495, 248.42052613213997, 62.236465871076135, 556.1484470477285, 294.2025672745399, -3.1086244689504383e-15, 50.867610343028886, 38.6858192742844, 123.39999999999995, 49.17546691300083, 403.11242863684265, -1.4760775350272337, 4.799999999999999, 73.37694214166828, 20.336700365192648, 172.57757453100524, 210.79643785031408, 579.8237927937749, 151.11887553009066, 6.0, 952.3499264947486, 351.11746631577785, 347.0555391642599, 213.25426491837237, 144.38191604192215, -1.8207657603852567e-14, 1042.3641601111206, 0.3386193113504117, 408.08388347648565, 70.05759294851774, 0.5408646793972702, 13.571633263954359, 1.6000000000000028, 121.555703879456, 78.86591973553075, 7.000000000000005, 401.20177370912967, -0.04969503203640713, 404.36408980454274, 651.1038593522759, 594.5117959420054, 8.159005703379862, 69.93676167152486, 425.39855541373583], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-926.8973464219523, -196.56339705291182, -946.1805889699534, -1202.1992878968033, -661.3435040445469, -1184.8200534990945, -648.4929241962805, -1003.0500086963953, -385.41038269148623, 148.408930492124, -998.5389446682223, -1145.9878166879366, -1343.664590891767, -647.9367515323069, -852.7887827766132, -158.92920978472725, -1243.972953507036, -919.4793532083107, -1114.2627881632511, -1152.6678130160335, -1056.1413853468498, -1226.710826805834, 33.49261526050825, -902.3752867315347, -1104.4730142348753, -1086.6556418429993, -1029.7836588336484, -1204.667803024344, -1499.3765282785776, -868.5244348473705, 16.72159085885485, -946.5080415673649, -736.2755192526572, -974.7939127303856, -1073.3144591265025, -117.54237170448664, -1167.972870024254, -90.15552574642975, -1258.3118747051155, -941.084639209615, -1459.6629656213397, -1181.660465445518, -718.275404925824, -1280.7843664615182, -828.9331380879737, 28.090090901592717, -1061.2735570385848, -868.2479225477485, -822.6668088776261, 113.98525639491015, -1097.3731700855205, -1127.149678608131, -1188.5431155340182, 179.14375212334488, -863.8851790427105, -1164.5621998125575, -1166.8614250103083, -790.3514830138718, -1490.2508375399261, 86.71857139152682, -1165.8309079608684, -1056.1196622251828, 291.1434419275504, -995.6775804643179, -1113.0213735353739, -1214.4123152818627, -911.1225583886312, -944.7826141292359, -1221.9021665967318, -1344.4206720198674, -488.30422276690035, 0.9042306141098209, 29.02908786082144, -1049.6402181291776, -970.5731859376058, -862.6838057824777, -635.2097290752575, -912.8300529966822, -1092.5710141930897, -661.9493028712722, -1185.3919221605252, -1074.500935822292, -864.3888269288053, -1274.9873446611214, -979.0551397962296, -1124.7775402818518, 376.5017728773215, -885.4681609045003, 167.71725594200774, -991.5360602711486, -1028.0254235487796, -17.06909136438298, -66.95971373067206, -1012.8746944601986, -879.5315368885642, -1105.5278290259266, 243.74013705127155, -1102.406590162366, -1235.8837561427056, -233.4846098500242, -1117.3840587488305, -1082.1184480333766, -478.9463716305371, -247.61182543357495, -5.524414051058894, -1010.878150595379, -1252.2359494883492, -1296.0424684103773, -1288.512980140408, -866.3832590161367, -1190.7172730050722, -751.1964459311683, -975.652267512613, -697.2261875976234, -1299.9100294902642, 43.00594449871691, -187.48523848737335, -1153.0231510893173, -1286.8140443659613, 274.8325118989626, -1467.958478652196, -325.63406595503585, -1182.6039474550464, -1084.1452422551295, -558.7087759351296, -764.3018478871113, -1112.8254755889755, -1047.9379318679346, -642.0919931765353, -681.7144933265592, -1112.2992962178726, -716.8650669392824, 279.1543365836583, -927.2584546977121, -902.5924474259597, -1177.7074679115121, -1014.4047777143929, -1314.5169392580624, -1205.8241972404142, -476.5487826045771, -1111.949760473876, -1107.5085263313397, 41.52137905014392, -1028.7874336923467, -1101.9508081172348, -268.21182651186314, -1026.7413780504576, -47.84478459438685, -25.73077032647893, -1300.3991776520886, -1220.1676643749604, -1282.5417365034873, -814.3950516108503, 338.2418416621258, -1111.035378406077, 320.60750850635077, -883.8086875807192, -203.3970213437684, -710.4699860450578, 67.15762441397696, -1157.2467774891934, 38.97326212756845, -1397.954728914867, -1235.3706653496374, -994.0424515883385, 317.5838351634971, -1037.4106574043499, -1260.9198383086261, 339.9636348113893, -248.42491412672285, -797.3011150535269, -486.9554638075913, -1362.2080840231106, -1047.0054123167465, -1108.2296849527693, -1015.9606808059766, -1286.4454359103963, -914.8688595634048, -460.6487668159404, -1025.37045677014, -803.9580563988014, -771.3797085318455, -1119.3702113929603, -1074.8022906757135, -1100.8938478494117, 342.71740218383013, -1182.5551691714065, -1418.2478352582564, -1119.8116535986626, 370.9916357041396, -690.4362684484928, -275.66012864829776, -931.8614021553733, -380.0672333861465, -958.5801361930817, -1213.246972815987, -1295.4301204671253, -959.0137807513934, -1246.3945018978166, 202.3357483874421], "policy_predator_policy_reward": [964.6442003611432, 280.4199626108697, 948.1249288502732, 1202.599287896803, 764.6336042022109, 1184.6617496745791, 967.3866828048809, 981.6326599250151, 187.50483298432664, 407.9376090943269, 1191.8678561900176, 1084.4676867065143, 1345.4645908917666, 666.52063500879, 954.9149028135881, 231.01211851415496, 1245.2729535070348, 924.168923826, 1128.0736175232712, 1152.6678130160335, 1075.5169171576779, 1260.1699328072373, 463.2764470628078, 642.9592802589323, 1104.4730142348753, 1089.8556418429994, 935.7027972192362, 1300.0583732797581, 1499.3765282785776, 878.1244348473712, 515.5983272712391, 607.1009134857811, 852.2755192526561, 983.7939127303855, 1074.736737453648, 313.61018113966395, 708.6672025482678, 704.1467478133897, 1275.2990574671305, 916.3644917058974, 1459.6629656213397, 1182.8604654455178, 817.4380275523107, 1280.7843664615182, 838.233138087974, 58.183401190966705, 1062.1735570385847, 898.9479225477487, 926.0510523195021, 214.8743091884167, 843.6962006852428, 1387.2466166935674, 1188.5431155340182, 17.150273162582238, 897.2130281142078, 1164.9231987447542, 1167.8614250103083, 801.5514830138742, 1490.7508375399261, 67.63046703050611, 1167.0309079608683, 1059.773764191432, 908.406639792574, 524.27799655487, 1111.8981433634247, 1218.2740191503424, 911.1225583886312, 949.0301773898593, 1282.050089987545, 1334.1091366135947, 142.4167462187716, 744.3778119059891, 215.5955767959954, 1019.7328023151609, 1006.4086013478721, 976.8164870899188, 733.7370489156076, 988.571689693816, 818.2179557386457, 1141.807640672001, 1185.3919221605252, 1075.500935822292, 958.0729869843148, 1248.5000472307395, 978.8402943099443, 1124.7775402818518, 530.977705600761, 783.6780928168815, 908.609974157502, 719.2144323550364, 971.0859398741923, 593.0425212213692, 739.6088253634457, 957.040550742774, 864.0912639078311, 1194.4629967502365, 598.303461022443, 941.7910738380349, 1158.5522220259177, 580.3916964816916, 1143.6821919529943, 1083.0536239409118, 13.352129525738663, 1060.44727094927, 426.24479096763594, 1004.0962141990013, 1252.2359494883492, 1302.9036278799547, 1288.512980140408, 872.5632041904003, 1191.9172730050711, 765.3357464979773, 983.3522675126147, 793.8972290995086, 1299.9100294902642, 205.41458163342304, 328.9906859973102, 1073.754169450456, 758.9554338162377, 809.1745456984862, 1437.582355431176, 650.2127564505981, 1182.6039474550464, 1084.1452422551295, 439.43879180480684, 934.439442360461, 1172.3797964186053, 1027.0694303125886, 736.5666182013675, 710.6398683017256, 1022.2970186235818, 856.0428114465743, 212.21693283129912, 838.9996139195962, 900.6447027215746, 1178.17913508087, 1019.204777714393, 1314.5169392580624, 1128.9066973232316, 626.8432246634333, 1111.5955750705248, 1128.199412099883, 210.92799683267538, 948.9156323405334, 1101.1845480395552, 479.7745244398585, 734.363571980396, 920.0463834582212, 176.84964585656962, 1300.3991776520886, 1226.1676643749604, 1282.5417365034873, 703.451692047147, 725.0514443963242, 1111.035378406077, 30.509957809427267, 840.226597938208, 594.0346501505402, 445.61769976269585, 410.94892678675825, 1157.0786214606446, 105.5768099429033, 1397.954728914867, 1235.3706653496374, 806.5866542549654, 912.2361222809982, 1037.61065740435, 1261.0584576199767, 41.32024866509391, 275.2249141267266, 572.9693435576796, 781.344828251957, 1265.4095610688862, 1144.3447999503696, 1108.2296849527693, 1029.532314069931, 1286.745435910396, 916.1688595634048, 678.2642077122381, 929.3107197532984, 876.4580563988015, 777.7456282673762, 1126.37021139296, 1074.8022906757135, 1100.8938478494117, 58.48437152529966, 1182.5551691714065, 1418.19814022622, 1114.8357940339877, 38.34831366507824, 895.4321607917342, 721.7680956573374, 895.6540636009553, 1010.786367882574, 964.5001257464927, 1215.4859889659558, 1294.1652293807565, 1030.2154335092873, 1243.0844729872217, 226.37283593688903]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.025460606671811, "mean_inference_ms": 4.329250208544204, "mean_action_processing_ms": 1.793985042750717, "mean_env_wait_ms": 11.91847913769795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005461692810058594, "StateBufferConnector_ms": 0.005213260650634766, "ViewRequirementAgentConnector_ms": 0.3978341817855835}, "num_episodes": 13, "episode_return_max": 1042.3641601111206, "episode_return_min": -7.732964741703721, "episode_return_mean": 193.02320982076813, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.810235810374, "num_env_steps_trained_throughput_per_sec": 155.810235810374, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 25991.334, "restore_workers_time_ms": 0.074, "training_step_time_ms": 25991.087, "sample_time_ms": 2456.434, "learn_time_ms": 23505.547, "learn_throughput": 170.173, "synch_weights_time_ms": 25.446}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 38, "trial_id": "0b608_00000", "date": "2024-08-22_14-01-32", "timestamp": 1724315492, "time_this_iter_s": 25.70896887779236, "time_total_s": 985.9888439178467, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31207cd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 985.9888439178467, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 31.21944444444444, "ram_util_percent": 82.55000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.720435336657934, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.357423342851105, "policy_loss": -0.008208929790706232, "vf_loss": 8.365032469532478, "vf_explained_var": 0.3308500918761763, "kl": 0.00599810319802374, "entropy": 0.3323174148640305, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36383.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.648939697326174, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.188287320717302, "policy_loss": -0.009892307768856723, "vf_loss": 8.196706774373533, "vf_explained_var": 0.6615490376003205, "kl": 0.0073642848591719354, "entropy": 0.7062027784882399, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36383.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 1042.3641601111206, "episode_reward_min": -7.732964741703721, "episode_reward_mean": 219.0550445749828, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1499.3765282785776, "predator_policy": 11.849302423726872}, "policy_reward_max": {"prey_policy": 376.5017728773215, "predator_policy": 1499.3765282785776}, "policy_reward_mean": {"prey_policy": -765.3141380040574, "predator_policy": 874.8416602915488}, "custom_metrics": {}, "hist_stats": {"episode_reward": [52.83463781223085, 237.3530558507159, 3.2000000000000055, 1.3097086410023653, 9.60000000000002, 192.9127900485093, 124.99999999999994, 197.49008776232267, 154.68555459097468, -7.732964741703721, 1.2000000000000064, 99.16262262648567, 95.57349209255938, 31.59999999999998, 432.2438090252027, 6.419968685164406, 196.29402528592712, 33.68884800369396, 12.199999999999978, 154.8490384220333, 4.85410196624969, 728.150497810677, 2.73847369653246, 4.247563260623918, 49.83638798453936, 399.3945659719712, 214.71724884279988, 149.9680967177054, 174.26895653748355, 205.5052793462835, 0.9999999999999964, 67.19686262512664, -0.21484548628526445, 805.6894103904659, 804.0056021833975, 519.0339461824012, 616.8149679153485, 73.49489474358448, 681.4280817493842, 269.5755525148789, 27.233309111698695, 347.2412034108971, 413.9384405201989, 6.861159469577194, 6.1799451742635885, 15.339300566808511, 104.37104150188495, 248.42052613213997, 62.236465871076135, 556.1484470477285, 294.2025672745399, -3.1086244689504383e-15, 50.867610343028886, 38.6858192742844, 123.39999999999995, 49.17546691300083, 403.11242863684265, -1.4760775350272337, 4.799999999999999, 73.37694214166828, 20.336700365192648, 172.57757453100524, 210.79643785031408, 579.8237927937749, 151.11887553009066, 6.0, 952.3499264947486, 351.11746631577785, 347.0555391642599, 213.25426491837237, 144.38191604192215, -1.8207657603852567e-14, 1042.3641601111206, 0.3386193113504117, 408.08388347648565, 70.05759294851774, 0.5408646793972702, 13.571633263954359, 1.6000000000000028, 121.555703879456, 78.86591973553075, 7.000000000000005, 401.20177370912967, -0.04969503203640713, 404.36408980454274, 651.1038593522759, 594.5117959420054, 8.159005703379862, 69.93676167152486, 425.39855541373583, 650.4360322602283, 475.3206197207522, 268.2622330244709, 8.199999999999996, 426.20044860576314, 706.242258681925, 672.7798475547659, 286.9509467272686, 322.5283381396764, 15.461799894698665], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1056.1413853468498, -1226.710826805834, 33.49261526050825, -902.3752867315347, -1104.4730142348753, -1086.6556418429993, -1029.7836588336484, -1204.667803024344, -1499.3765282785776, -868.5244348473705, 16.72159085885485, -946.5080415673649, -736.2755192526572, -974.7939127303856, -1073.3144591265025, -117.54237170448664, -1167.972870024254, -90.15552574642975, -1258.3118747051155, -941.084639209615, -1459.6629656213397, -1181.660465445518, -718.275404925824, -1280.7843664615182, -828.9331380879737, 28.090090901592717, -1061.2735570385848, -868.2479225477485, -822.6668088776261, 113.98525639491015, -1097.3731700855205, -1127.149678608131, -1188.5431155340182, 179.14375212334488, -863.8851790427105, -1164.5621998125575, -1166.8614250103083, -790.3514830138718, -1490.2508375399261, 86.71857139152682, -1165.8309079608684, -1056.1196622251828, 291.1434419275504, -995.6775804643179, -1113.0213735353739, -1214.4123152818627, -911.1225583886312, -944.7826141292359, -1221.9021665967318, -1344.4206720198674, -488.30422276690035, 0.9042306141098209, 29.02908786082144, -1049.6402181291776, -970.5731859376058, -862.6838057824777, -635.2097290752575, -912.8300529966822, -1092.5710141930897, -661.9493028712722, -1185.3919221605252, -1074.500935822292, -864.3888269288053, -1274.9873446611214, -979.0551397962296, -1124.7775402818518, 376.5017728773215, -885.4681609045003, 167.71725594200774, -991.5360602711486, -1028.0254235487796, -17.06909136438298, -66.95971373067206, -1012.8746944601986, -879.5315368885642, -1105.5278290259266, 243.74013705127155, -1102.406590162366, -1235.8837561427056, -233.4846098500242, -1117.3840587488305, -1082.1184480333766, -478.9463716305371, -247.61182543357495, -5.524414051058894, -1010.878150595379, -1252.2359494883492, -1296.0424684103773, -1288.512980140408, -866.3832590161367, -1190.7172730050722, -751.1964459311683, -975.652267512613, -697.2261875976234, -1299.9100294902642, 43.00594449871691, -187.48523848737335, -1153.0231510893173, -1286.8140443659613, 274.8325118989626, -1467.958478652196, -325.63406595503585, -1182.6039474550464, -1084.1452422551295, -558.7087759351296, -764.3018478871113, -1112.8254755889755, -1047.9379318679346, -642.0919931765353, -681.7144933265592, -1112.2992962178726, -716.8650669392824, 279.1543365836583, -927.2584546977121, -902.5924474259597, -1177.7074679115121, -1014.4047777143929, -1314.5169392580624, -1205.8241972404142, -476.5487826045771, -1111.949760473876, -1107.5085263313397, 41.52137905014392, -1028.7874336923467, -1101.9508081172348, -268.21182651186314, -1026.7413780504576, -47.84478459438685, -25.73077032647893, -1300.3991776520886, -1220.1676643749604, -1282.5417365034873, -814.3950516108503, 338.2418416621258, -1111.035378406077, 320.60750850635077, -883.8086875807192, -203.3970213437684, -710.4699860450578, 67.15762441397696, -1157.2467774891934, 38.97326212756845, -1397.954728914867, -1235.3706653496374, -994.0424515883385, 317.5838351634971, -1037.4106574043499, -1260.9198383086261, 339.9636348113893, -248.42491412672285, -797.3011150535269, -486.9554638075913, -1362.2080840231106, -1047.0054123167465, -1108.2296849527693, -1015.9606808059766, -1286.4454359103963, -914.8688595634048, -460.6487668159404, -1025.37045677014, -803.9580563988014, -771.3797085318455, -1119.3702113929603, -1074.8022906757135, -1100.8938478494117, 342.71740218383013, -1182.5551691714065, -1418.2478352582564, -1119.8116535986626, 370.9916357041396, -690.4362684484928, -275.66012864829776, -931.8614021553733, -380.0672333861465, -958.5801361930817, -1213.246972815987, -1295.4301204671253, -959.0137807513934, -1246.3945018978166, 202.3357483874421, -48.25572393479138, -1182.9167637643097, 15.49186124432947, -1332.1051251896533, 178.43311824031724, -1096.3787437025892, -907.5111798088365, -985.4939667168456, 82.66219474833062, -1171.7854703288845, 182.10288921868033, 345.0895220505373, -1041.9883403968715, 58.080695000094664, -119.72953206041788, -1009.3084687027579, -1279.3537318998308, 310.6612732626813, -1008.7596789836334, -971.3512796680567], "policy_predator_policy_reward": [1075.5169171576779, 1260.1699328072373, 463.2764470628078, 642.9592802589323, 1104.4730142348753, 1089.8556418429994, 935.7027972192362, 1300.0583732797581, 1499.3765282785776, 878.1244348473712, 515.5983272712391, 607.1009134857811, 852.2755192526561, 983.7939127303855, 1074.736737453648, 313.61018113966395, 708.6672025482678, 704.1467478133897, 1275.2990574671305, 916.3644917058974, 1459.6629656213397, 1182.8604654455178, 817.4380275523107, 1280.7843664615182, 838.233138087974, 58.183401190966705, 1062.1735570385847, 898.9479225477487, 926.0510523195021, 214.8743091884167, 843.6962006852428, 1387.2466166935674, 1188.5431155340182, 17.150273162582238, 897.2130281142078, 1164.9231987447542, 1167.8614250103083, 801.5514830138742, 1490.7508375399261, 67.63046703050611, 1167.0309079608683, 1059.773764191432, 908.406639792574, 524.27799655487, 1111.8981433634247, 1218.2740191503424, 911.1225583886312, 949.0301773898593, 1282.050089987545, 1334.1091366135947, 142.4167462187716, 744.3778119059891, 215.5955767959954, 1019.7328023151609, 1006.4086013478721, 976.8164870899188, 733.7370489156076, 988.571689693816, 818.2179557386457, 1141.807640672001, 1185.3919221605252, 1075.500935822292, 958.0729869843148, 1248.5000472307395, 978.8402943099443, 1124.7775402818518, 530.977705600761, 783.6780928168815, 908.609974157502, 719.2144323550364, 971.0859398741923, 593.0425212213692, 739.6088253634457, 957.040550742774, 864.0912639078311, 1194.4629967502365, 598.303461022443, 941.7910738380349, 1158.5522220259177, 580.3916964816916, 1143.6821919529943, 1083.0536239409118, 13.352129525738663, 1060.44727094927, 426.24479096763594, 1004.0962141990013, 1252.2359494883492, 1302.9036278799547, 1288.512980140408, 872.5632041904003, 1191.9172730050711, 765.3357464979773, 983.3522675126147, 793.8972290995086, 1299.9100294902642, 205.41458163342304, 328.9906859973102, 1073.754169450456, 758.9554338162377, 809.1745456984862, 1437.582355431176, 650.2127564505981, 1182.6039474550464, 1084.1452422551295, 439.43879180480684, 934.439442360461, 1172.3797964186053, 1027.0694303125886, 736.5666182013675, 710.6398683017256, 1022.2970186235818, 856.0428114465743, 212.21693283129912, 838.9996139195962, 900.6447027215746, 1178.17913508087, 1019.204777714393, 1314.5169392580624, 1128.9066973232316, 626.8432246634333, 1111.5955750705248, 1128.199412099883, 210.92799683267538, 948.9156323405334, 1101.1845480395552, 479.7745244398585, 734.363571980396, 920.0463834582212, 176.84964585656962, 1300.3991776520886, 1226.1676643749604, 1282.5417365034873, 703.451692047147, 725.0514443963242, 1111.035378406077, 30.509957809427267, 840.226597938208, 594.0346501505402, 445.61769976269585, 410.94892678675825, 1157.0786214606446, 105.5768099429033, 1397.954728914867, 1235.3706653496374, 806.5866542549654, 912.2361222809982, 1037.61065740435, 1261.0584576199767, 41.32024866509391, 275.2249141267266, 572.9693435576796, 781.344828251957, 1265.4095610688862, 1144.3447999503696, 1108.2296849527693, 1029.532314069931, 1286.745435910396, 916.1688595634048, 678.2642077122381, 929.3107197532984, 876.4580563988015, 777.7456282673762, 1126.37021139296, 1074.8022906757135, 1100.8938478494117, 58.48437152529966, 1182.5551691714065, 1418.19814022622, 1114.8357940339877, 38.34831366507824, 895.4321607917342, 721.7680956573374, 895.6540636009553, 1010.786367882574, 964.5001257464927, 1215.4859889659558, 1294.1652293807565, 1030.2154335092873, 1243.0844729872217, 226.37283593688903, 756.5832932057328, 1125.0252267535975, 540.3979128912297, 1251.5359707748457, 89.82911478415328, 1096.3787437025892, 915.7111798088363, 985.4939667168456, 1060.453781442409, 454.86994274390844, 112.4491073952645, 66.60074001744267, 705.1344934428389, 951.5529995087029, 571.2207133590094, 844.7682341314363, 1279.371494353099, 11.849302423726872, 1008.7596789836334, 986.8130795627554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.030631825394014, "mean_inference_ms": 4.355987561797811, "mean_action_processing_ms": 1.7829219821904352, "mean_env_wait_ms": 11.963154639835103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005611062049865723, "StateBufferConnector_ms": 0.0052874088287353516, "ViewRequirementAgentConnector_ms": 0.16117322444915771}, "num_episodes": 10, "episode_return_max": 1042.3641601111206, "episode_return_min": -7.732964741703721, "episode_return_mean": 219.0550445749828, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 148.36517206693935, "num_env_steps_trained_throughput_per_sec": 148.36517206693935, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 26005.555, "restore_workers_time_ms": 0.074, "training_step_time_ms": 26005.292, "sample_time_ms": 2501.739, "learn_time_ms": 23475.387, "learn_throughput": 170.391, "synch_weights_time_ms": 24.478}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 39, "trial_id": "0b608_00000", "date": "2024-08-22_14-01-59", "timestamp": 1724315519, "time_this_iter_s": 27.016914129257202, "time_total_s": 1013.0057580471039, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a3b4040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1013.0057580471039, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 36.38421052631579, "ram_util_percent": 83.09736842105266}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.214399619329544, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.375955481756302, "policy_loss": -0.006057689307878414, "vf_loss": 8.381369412639154, "vf_explained_var": 0.2661662271413854, "kl": 0.006437772303011524, "entropy": 0.3218560539856159, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 37328.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.508301077065646, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.133441680322878, "policy_loss": -0.010023629446341484, "vf_loss": 8.141987528119769, "vf_explained_var": 0.6222006639475545, "kl": 0.007388922491076368, "entropy": 0.6879078467056234, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 37328.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 1042.3641601111206, "episode_reward_min": -1.4760775350272337, "episode_reward_mean": 227.03830750880846, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1490.2508375399261, "predator_policy": 11.849302423726872}, "policy_reward_max": {"prey_policy": 376.5017728773215, "predator_policy": 1490.7508375399261}, "policy_reward_mean": {"prey_policy": -744.3479325308124, "predator_policy": 857.8670862852168}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.2000000000000064, 99.16262262648567, 95.57349209255938, 31.59999999999998, 432.2438090252027, 6.419968685164406, 196.29402528592712, 33.68884800369396, 12.199999999999978, 154.8490384220333, 4.85410196624969, 728.150497810677, 2.73847369653246, 4.247563260623918, 49.83638798453936, 399.3945659719712, 214.71724884279988, 149.9680967177054, 174.26895653748355, 205.5052793462835, 0.9999999999999964, 67.19686262512664, -0.21484548628526445, 805.6894103904659, 804.0056021833975, 519.0339461824012, 616.8149679153485, 73.49489474358448, 681.4280817493842, 269.5755525148789, 27.233309111698695, 347.2412034108971, 413.9384405201989, 6.861159469577194, 6.1799451742635885, 15.339300566808511, 104.37104150188495, 248.42052613213997, 62.236465871076135, 556.1484470477285, 294.2025672745399, -3.1086244689504383e-15, 50.867610343028886, 38.6858192742844, 123.39999999999995, 49.17546691300083, 403.11242863684265, -1.4760775350272337, 4.799999999999999, 73.37694214166828, 20.336700365192648, 172.57757453100524, 210.79643785031408, 579.8237927937749, 151.11887553009066, 6.0, 952.3499264947486, 351.11746631577785, 347.0555391642599, 213.25426491837237, 144.38191604192215, -1.8207657603852567e-14, 1042.3641601111206, 0.3386193113504117, 408.08388347648565, 70.05759294851774, 0.5408646793972702, 13.571633263954359, 1.6000000000000028, 121.555703879456, 78.86591973553075, 7.000000000000005, 401.20177370912967, -0.04969503203640713, 404.36408980454274, 651.1038593522759, 594.5117959420054, 8.159005703379862, 69.93676167152486, 425.39855541373583, 650.4360322602283, 475.3206197207522, 268.2622330244709, 8.199999999999996, 426.20044860576314, 706.242258681925, 672.7798475547659, 286.9509467272686, 322.5283381396764, 15.461799894698665, 226.52413318953708, 17.788216317850562, 142.60150519805796, 451.6673899841696, 0.11532821215825884, 5.13990634001977, 0.9999999999999858, 226.7431478068426, 481.0117876606119, 212.38774863737365], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1459.6629656213397, -1181.660465445518, -718.275404925824, -1280.7843664615182, -828.9331380879737, 28.090090901592717, -1061.2735570385848, -868.2479225477485, -822.6668088776261, 113.98525639491015, -1097.3731700855205, -1127.149678608131, -1188.5431155340182, 179.14375212334488, -863.8851790427105, -1164.5621998125575, -1166.8614250103083, -790.3514830138718, -1490.2508375399261, 86.71857139152682, -1165.8309079608684, -1056.1196622251828, 291.1434419275504, -995.6775804643179, -1113.0213735353739, -1214.4123152818627, -911.1225583886312, -944.7826141292359, -1221.9021665967318, -1344.4206720198674, -488.30422276690035, 0.9042306141098209, 29.02908786082144, -1049.6402181291776, -970.5731859376058, -862.6838057824777, -635.2097290752575, -912.8300529966822, -1092.5710141930897, -661.9493028712722, -1185.3919221605252, -1074.500935822292, -864.3888269288053, -1274.9873446611214, -979.0551397962296, -1124.7775402818518, 376.5017728773215, -885.4681609045003, 167.71725594200774, -991.5360602711486, -1028.0254235487796, -17.06909136438298, -66.95971373067206, -1012.8746944601986, -879.5315368885642, -1105.5278290259266, 243.74013705127155, -1102.406590162366, -1235.8837561427056, -233.4846098500242, -1117.3840587488305, -1082.1184480333766, -478.9463716305371, -247.61182543357495, -5.524414051058894, -1010.878150595379, -1252.2359494883492, -1296.0424684103773, -1288.512980140408, -866.3832590161367, -1190.7172730050722, -751.1964459311683, -975.652267512613, -697.2261875976234, -1299.9100294902642, 43.00594449871691, -187.48523848737335, -1153.0231510893173, -1286.8140443659613, 274.8325118989626, -1467.958478652196, -325.63406595503585, -1182.6039474550464, -1084.1452422551295, -558.7087759351296, -764.3018478871113, -1112.8254755889755, -1047.9379318679346, -642.0919931765353, -681.7144933265592, -1112.2992962178726, -716.8650669392824, 279.1543365836583, -927.2584546977121, -902.5924474259597, -1177.7074679115121, -1014.4047777143929, -1314.5169392580624, -1205.8241972404142, -476.5487826045771, -1111.949760473876, -1107.5085263313397, 41.52137905014392, -1028.7874336923467, -1101.9508081172348, -268.21182651186314, -1026.7413780504576, -47.84478459438685, -25.73077032647893, -1300.3991776520886, -1220.1676643749604, -1282.5417365034873, -814.3950516108503, 338.2418416621258, -1111.035378406077, 320.60750850635077, -883.8086875807192, -203.3970213437684, -710.4699860450578, 67.15762441397696, -1157.2467774891934, 38.97326212756845, -1397.954728914867, -1235.3706653496374, -994.0424515883385, 317.5838351634971, -1037.4106574043499, -1260.9198383086261, 339.9636348113893, -248.42491412672285, -797.3011150535269, -486.9554638075913, -1362.2080840231106, -1047.0054123167465, -1108.2296849527693, -1015.9606808059766, -1286.4454359103963, -914.8688595634048, -460.6487668159404, -1025.37045677014, -803.9580563988014, -771.3797085318455, -1119.3702113929603, -1074.8022906757135, -1100.8938478494117, 342.71740218383013, -1182.5551691714065, -1418.2478352582564, -1119.8116535986626, 370.9916357041396, -690.4362684484928, -275.66012864829776, -931.8614021553733, -380.0672333861465, -958.5801361930817, -1213.246972815987, -1295.4301204671253, -959.0137807513934, -1246.3945018978166, 202.3357483874421, -48.25572393479138, -1182.9167637643097, 15.49186124432947, -1332.1051251896533, 178.43311824031724, -1096.3787437025892, -907.5111798088365, -985.4939667168456, 82.66219474833062, -1171.7854703288845, 182.10288921868033, 345.0895220505373, -1041.9883403968715, 58.080695000094664, -119.72953206041788, -1009.3084687027579, -1279.3537318998308, 310.6612732626813, -1008.7596789836334, -971.3512796680567, -764.6633833819457, -41.787734081888814, -216.20053549619598, -963.7820741089089, -402.13917172648144, -1025.5051530139783, -257.26572883250486, 88.17989446648177, -847.1840970688465, -1148.9167711904647, -1135.9901498411145, -978.1157374021931, -1289.8847602240567, -1062.8845554713464, -236.621648299429, -554.1460645608016, 229.8935561908446, -689.6251068550648, -891.575384359919, -852.9978879866692], "policy_predator_policy_reward": [1459.6629656213397, 1182.8604654455178, 817.4380275523107, 1280.7843664615182, 838.233138087974, 58.183401190966705, 1062.1735570385847, 898.9479225477487, 926.0510523195021, 214.8743091884167, 843.6962006852428, 1387.2466166935674, 1188.5431155340182, 17.150273162582238, 897.2130281142078, 1164.9231987447542, 1167.8614250103083, 801.5514830138742, 1490.7508375399261, 67.63046703050611, 1167.0309079608683, 1059.773764191432, 908.406639792574, 524.27799655487, 1111.8981433634247, 1218.2740191503424, 911.1225583886312, 949.0301773898593, 1282.050089987545, 1334.1091366135947, 142.4167462187716, 744.3778119059891, 215.5955767959954, 1019.7328023151609, 1006.4086013478721, 976.8164870899188, 733.7370489156076, 988.571689693816, 818.2179557386457, 1141.807640672001, 1185.3919221605252, 1075.500935822292, 958.0729869843148, 1248.5000472307395, 978.8402943099443, 1124.7775402818518, 530.977705600761, 783.6780928168815, 908.609974157502, 719.2144323550364, 971.0859398741923, 593.0425212213692, 739.6088253634457, 957.040550742774, 864.0912639078311, 1194.4629967502365, 598.303461022443, 941.7910738380349, 1158.5522220259177, 580.3916964816916, 1143.6821919529943, 1083.0536239409118, 13.352129525738663, 1060.44727094927, 426.24479096763594, 1004.0962141990013, 1252.2359494883492, 1302.9036278799547, 1288.512980140408, 872.5632041904003, 1191.9172730050711, 765.3357464979773, 983.3522675126147, 793.8972290995086, 1299.9100294902642, 205.41458163342304, 328.9906859973102, 1073.754169450456, 758.9554338162377, 809.1745456984862, 1437.582355431176, 650.2127564505981, 1182.6039474550464, 1084.1452422551295, 439.43879180480684, 934.439442360461, 1172.3797964186053, 1027.0694303125886, 736.5666182013675, 710.6398683017256, 1022.2970186235818, 856.0428114465743, 212.21693283129912, 838.9996139195962, 900.6447027215746, 1178.17913508087, 1019.204777714393, 1314.5169392580624, 1128.9066973232316, 626.8432246634333, 1111.5955750705248, 1128.199412099883, 210.92799683267538, 948.9156323405334, 1101.1845480395552, 479.7745244398585, 734.363571980396, 920.0463834582212, 176.84964585656962, 1300.3991776520886, 1226.1676643749604, 1282.5417365034873, 703.451692047147, 725.0514443963242, 1111.035378406077, 30.509957809427267, 840.226597938208, 594.0346501505402, 445.61769976269585, 410.94892678675825, 1157.0786214606446, 105.5768099429033, 1397.954728914867, 1235.3706653496374, 806.5866542549654, 912.2361222809982, 1037.61065740435, 1261.0584576199767, 41.32024866509391, 275.2249141267266, 572.9693435576796, 781.344828251957, 1265.4095610688862, 1144.3447999503696, 1108.2296849527693, 1029.532314069931, 1286.745435910396, 916.1688595634048, 678.2642077122381, 929.3107197532984, 876.4580563988015, 777.7456282673762, 1126.37021139296, 1074.8022906757135, 1100.8938478494117, 58.48437152529966, 1182.5551691714065, 1418.19814022622, 1114.8357940339877, 38.34831366507824, 895.4321607917342, 721.7680956573374, 895.6540636009553, 1010.786367882574, 964.5001257464927, 1215.4859889659558, 1294.1652293807565, 1030.2154335092873, 1243.0844729872217, 226.37283593688903, 756.5832932057328, 1125.0252267535975, 540.3979128912297, 1251.5359707748457, 89.82911478415328, 1096.3787437025892, 915.7111798088363, 985.4939667168456, 1060.453781442409, 454.86994274390844, 112.4491073952645, 66.60074001744267, 705.1344934428389, 951.5529995087029, 571.2207133590094, 844.7682341314363, 1279.371494353099, 11.849302423726872, 1008.7596789836334, 986.8130795627554, 283.28260325829575, 749.6926473950764, 1016.5905780502762, 181.18024787267754, 545.9591834822082, 1024.286646456309, 69.16209473584843, 551.5911296143455, 847.9915267801887, 1148.2246696912807, 1141.1300561811345, 978.1157374021931, 1289.8847602240567, 1063.8845554713464, 667.6898746330551, 349.82098603402136, 294.848010955258, 645.8953273695732, 1146.9749395260355, 809.9860814579281]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.040319583887281, "mean_inference_ms": 4.369288351587307, "mean_action_processing_ms": 1.7561476022104439, "mean_env_wait_ms": 12.008379468730134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006202220916748047, "StateBufferConnector_ms": 0.005289435386657715, "ViewRequirementAgentConnector_ms": 0.16120946407318115}, "num_episodes": 10, "episode_return_max": 1042.3641601111206, "episode_return_min": -1.4760775350272337, "episode_return_mean": 227.03830750880846, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.08853512046838, "num_env_steps_trained_throughput_per_sec": 156.08853512046838, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 25931.064, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25930.862, "sample_time_ms": 2426.295, "learn_time_ms": 23476.695, "learn_throughput": 170.382, "synch_weights_time_ms": 24.418}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 40, "trial_id": "0b608_00000", "date": "2024-08-22_14-02-25", "timestamp": 1724315545, "time_this_iter_s": 25.675941228866577, "time_total_s": 1038.6816992759705, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a3c3670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1038.6816992759705, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 31.72222222222222, "ram_util_percent": 82.83055555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.385328218293568, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.276761710959137, "policy_loss": -0.007237387593421671, "vf_loss": 8.28328410809633, "vf_explained_var": 0.2713820224085813, "kl": 0.007149478438231483, "entropy": 0.34733482066285676, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38273.0, "diff_num_grad_updates_vs_sampler_policy": 493.0262500000026}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.878263497983337, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.261807389234109, "policy_loss": -0.006510891209519099, "vf_loss": 8.266926188191409, "vf_explained_var": 0.6043585832156833, "kl": 0.006960441010989367, "entropy": 0.661497612226577, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38273.0, "diff_num_grad_updates_vs_sampler_policy": 493.0262500000026}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 1042.3641601111206, "episode_reward_min": -1.4760775350272337, "episode_reward_mean": 238.450966537495, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1490.2508375399261, "predator_policy": 11.849302423726872}, "policy_reward_max": {"prey_policy": 376.5017728773215, "predator_policy": 1490.7508375399261}, "policy_reward_mean": {"prey_policy": -738.2294756002188, "predator_policy": 857.4549588689665}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.68884800369396, 12.199999999999978, 154.8490384220333, 4.85410196624969, 728.150497810677, 2.73847369653246, 4.247563260623918, 49.83638798453936, 399.3945659719712, 214.71724884279988, 149.9680967177054, 174.26895653748355, 205.5052793462835, 0.9999999999999964, 67.19686262512664, -0.21484548628526445, 805.6894103904659, 804.0056021833975, 519.0339461824012, 616.8149679153485, 73.49489474358448, 681.4280817493842, 269.5755525148789, 27.233309111698695, 347.2412034108971, 413.9384405201989, 6.861159469577194, 6.1799451742635885, 15.339300566808511, 104.37104150188495, 248.42052613213997, 62.236465871076135, 556.1484470477285, 294.2025672745399, -3.1086244689504383e-15, 50.867610343028886, 38.6858192742844, 123.39999999999995, 49.17546691300083, 403.11242863684265, -1.4760775350272337, 4.799999999999999, 73.37694214166828, 20.336700365192648, 172.57757453100524, 210.79643785031408, 579.8237927937749, 151.11887553009066, 6.0, 952.3499264947486, 351.11746631577785, 347.0555391642599, 213.25426491837237, 144.38191604192215, -1.8207657603852567e-14, 1042.3641601111206, 0.3386193113504117, 408.08388347648565, 70.05759294851774, 0.5408646793972702, 13.571633263954359, 1.6000000000000028, 121.555703879456, 78.86591973553075, 7.000000000000005, 401.20177370912967, -0.04969503203640713, 404.36408980454274, 651.1038593522759, 594.5117959420054, 8.159005703379862, 69.93676167152486, 425.39855541373583, 650.4360322602283, 475.3206197207522, 268.2622330244709, 8.199999999999996, 426.20044860576314, 706.242258681925, 672.7798475547659, 286.9509467272686, 322.5283381396764, 15.461799894698665, 226.52413318953708, 17.788216317850562, 142.60150519805796, 451.6673899841696, 0.11532821215825884, 5.13990634001977, 0.9999999999999858, 226.7431478068426, 481.0117876606119, 212.38774863737365, 667.3184293496411, -0.14748211975054204, 670.4567629673078, 37.27490826063476, 258.68481713304436, 368.65540549770395, 1.5169794954143563], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-863.8851790427105, -1164.5621998125575, -1166.8614250103083, -790.3514830138718, -1490.2508375399261, 86.71857139152682, -1165.8309079608684, -1056.1196622251828, 291.1434419275504, -995.6775804643179, -1113.0213735353739, -1214.4123152818627, -911.1225583886312, -944.7826141292359, -1221.9021665967318, -1344.4206720198674, -488.30422276690035, 0.9042306141098209, 29.02908786082144, -1049.6402181291776, -970.5731859376058, -862.6838057824777, -635.2097290752575, -912.8300529966822, -1092.5710141930897, -661.9493028712722, -1185.3919221605252, -1074.500935822292, -864.3888269288053, -1274.9873446611214, -979.0551397962296, -1124.7775402818518, 376.5017728773215, -885.4681609045003, 167.71725594200774, -991.5360602711486, -1028.0254235487796, -17.06909136438298, -66.95971373067206, -1012.8746944601986, -879.5315368885642, -1105.5278290259266, 243.74013705127155, -1102.406590162366, -1235.8837561427056, -233.4846098500242, -1117.3840587488305, -1082.1184480333766, -478.9463716305371, -247.61182543357495, -5.524414051058894, -1010.878150595379, -1252.2359494883492, -1296.0424684103773, -1288.512980140408, -866.3832590161367, -1190.7172730050722, -751.1964459311683, -975.652267512613, -697.2261875976234, -1299.9100294902642, 43.00594449871691, -187.48523848737335, -1153.0231510893173, -1286.8140443659613, 274.8325118989626, -1467.958478652196, -325.63406595503585, -1182.6039474550464, -1084.1452422551295, -558.7087759351296, -764.3018478871113, -1112.8254755889755, -1047.9379318679346, -642.0919931765353, -681.7144933265592, -1112.2992962178726, -716.8650669392824, 279.1543365836583, -927.2584546977121, -902.5924474259597, -1177.7074679115121, -1014.4047777143929, -1314.5169392580624, -1205.8241972404142, -476.5487826045771, -1111.949760473876, -1107.5085263313397, 41.52137905014392, -1028.7874336923467, -1101.9508081172348, -268.21182651186314, -1026.7413780504576, -47.84478459438685, -25.73077032647893, -1300.3991776520886, -1220.1676643749604, -1282.5417365034873, -814.3950516108503, 338.2418416621258, -1111.035378406077, 320.60750850635077, -883.8086875807192, -203.3970213437684, -710.4699860450578, 67.15762441397696, -1157.2467774891934, 38.97326212756845, -1397.954728914867, -1235.3706653496374, -994.0424515883385, 317.5838351634971, -1037.4106574043499, -1260.9198383086261, 339.9636348113893, -248.42491412672285, -797.3011150535269, -486.9554638075913, -1362.2080840231106, -1047.0054123167465, -1108.2296849527693, -1015.9606808059766, -1286.4454359103963, -914.8688595634048, -460.6487668159404, -1025.37045677014, -803.9580563988014, -771.3797085318455, -1119.3702113929603, -1074.8022906757135, -1100.8938478494117, 342.71740218383013, -1182.5551691714065, -1418.2478352582564, -1119.8116535986626, 370.9916357041396, -690.4362684484928, -275.66012864829776, -931.8614021553733, -380.0672333861465, -958.5801361930817, -1213.246972815987, -1295.4301204671253, -959.0137807513934, -1246.3945018978166, 202.3357483874421, -48.25572393479138, -1182.9167637643097, 15.49186124432947, -1332.1051251896533, 178.43311824031724, -1096.3787437025892, -907.5111798088365, -985.4939667168456, 82.66219474833062, -1171.7854703288845, 182.10288921868033, 345.0895220505373, -1041.9883403968715, 58.080695000094664, -119.72953206041788, -1009.3084687027579, -1279.3537318998308, 310.6612732626813, -1008.7596789836334, -971.3512796680567, -764.6633833819457, -41.787734081888814, -216.20053549619598, -963.7820741089089, -402.13917172648144, -1025.5051530139783, -257.26572883250486, 88.17989446648177, -847.1840970688465, -1148.9167711904647, -1135.9901498411145, -978.1157374021931, -1289.8847602240567, -1062.8845554713464, -236.621648299429, -554.1460645608016, 229.8935561908446, -689.6251068550648, -891.575384359919, -852.9978879866692, -4.012149995839991, -844.3418564979644, -1142.5390674415698, -1057.2427215036482, 40.13085739395676, -1052.5479033163633, -846.1996603822788, -853.7247363641086, -1077.2063984135666, -642.5621547641083, -621.8453384016956, -81.78195615951876, -766.5860099989147, -1139.2010118496112], "policy_predator_policy_reward": [897.2130281142078, 1164.9231987447542, 1167.8614250103083, 801.5514830138742, 1490.7508375399261, 67.63046703050611, 1167.0309079608683, 1059.773764191432, 908.406639792574, 524.27799655487, 1111.8981433634247, 1218.2740191503424, 911.1225583886312, 949.0301773898593, 1282.050089987545, 1334.1091366135947, 142.4167462187716, 744.3778119059891, 215.5955767959954, 1019.7328023151609, 1006.4086013478721, 976.8164870899188, 733.7370489156076, 988.571689693816, 818.2179557386457, 1141.807640672001, 1185.3919221605252, 1075.500935822292, 958.0729869843148, 1248.5000472307395, 978.8402943099443, 1124.7775402818518, 530.977705600761, 783.6780928168815, 908.609974157502, 719.2144323550364, 971.0859398741923, 593.0425212213692, 739.6088253634457, 957.040550742774, 864.0912639078311, 1194.4629967502365, 598.303461022443, 941.7910738380349, 1158.5522220259177, 580.3916964816916, 1143.6821919529943, 1083.0536239409118, 13.352129525738663, 1060.44727094927, 426.24479096763594, 1004.0962141990013, 1252.2359494883492, 1302.9036278799547, 1288.512980140408, 872.5632041904003, 1191.9172730050711, 765.3357464979773, 983.3522675126147, 793.8972290995086, 1299.9100294902642, 205.41458163342304, 328.9906859973102, 1073.754169450456, 758.9554338162377, 809.1745456984862, 1437.582355431176, 650.2127564505981, 1182.6039474550464, 1084.1452422551295, 439.43879180480684, 934.439442360461, 1172.3797964186053, 1027.0694303125886, 736.5666182013675, 710.6398683017256, 1022.2970186235818, 856.0428114465743, 212.21693283129912, 838.9996139195962, 900.6447027215746, 1178.17913508087, 1019.204777714393, 1314.5169392580624, 1128.9066973232316, 626.8432246634333, 1111.5955750705248, 1128.199412099883, 210.92799683267538, 948.9156323405334, 1101.1845480395552, 479.7745244398585, 734.363571980396, 920.0463834582212, 176.84964585656962, 1300.3991776520886, 1226.1676643749604, 1282.5417365034873, 703.451692047147, 725.0514443963242, 1111.035378406077, 30.509957809427267, 840.226597938208, 594.0346501505402, 445.61769976269585, 410.94892678675825, 1157.0786214606446, 105.5768099429033, 1397.954728914867, 1235.3706653496374, 806.5866542549654, 912.2361222809982, 1037.61065740435, 1261.0584576199767, 41.32024866509391, 275.2249141267266, 572.9693435576796, 781.344828251957, 1265.4095610688862, 1144.3447999503696, 1108.2296849527693, 1029.532314069931, 1286.745435910396, 916.1688595634048, 678.2642077122381, 929.3107197532984, 876.4580563988015, 777.7456282673762, 1126.37021139296, 1074.8022906757135, 1100.8938478494117, 58.48437152529966, 1182.5551691714065, 1418.19814022622, 1114.8357940339877, 38.34831366507824, 895.4321607917342, 721.7680956573374, 895.6540636009553, 1010.786367882574, 964.5001257464927, 1215.4859889659558, 1294.1652293807565, 1030.2154335092873, 1243.0844729872217, 226.37283593688903, 756.5832932057328, 1125.0252267535975, 540.3979128912297, 1251.5359707748457, 89.82911478415328, 1096.3787437025892, 915.7111798088363, 985.4939667168456, 1060.453781442409, 454.86994274390844, 112.4491073952645, 66.60074001744267, 705.1344934428389, 951.5529995087029, 571.2207133590094, 844.7682341314363, 1279.371494353099, 11.849302423726872, 1008.7596789836334, 986.8130795627554, 283.28260325829575, 749.6926473950764, 1016.5905780502762, 181.18024787267754, 545.9591834822082, 1024.286646456309, 69.16209473584843, 551.5911296143455, 847.9915267801887, 1148.2246696912807, 1141.1300561811345, 978.1157374021931, 1289.8847602240567, 1063.8845554713464, 667.6898746330551, 349.82098603402136, 294.848010955258, 645.8953273695732, 1146.9749395260355, 809.9860814579281, 430.0716126593929, 1085.6008231840513, 1142.5390674415698, 1057.0952393838977, 864.7209992291492, 818.1528096605601, 847.6303800407093, 889.5689249663134, 1012.2735559350691, 966.1798143756536, 560.0715165197836, 512.2111835391324, 771.4631630679894, 1135.840838275951]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.043802528829945, "mean_inference_ms": 4.350127987939686, "mean_action_processing_ms": 1.7534834896965887, "mean_env_wait_ms": 12.037790533498221, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006163597106933594, "StateBufferConnector_ms": 0.005258083343505859, "ViewRequirementAgentConnector_ms": 0.17751026153564453}, "num_episodes": 7, "episode_return_max": 1042.3641601111206, "episode_return_min": -1.4760775350272337, "episode_return_mean": 238.450966537495, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.67638798462107, "num_env_steps_trained_throughput_per_sec": 155.67638798462107, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 25952.545, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25952.326, "sample_time_ms": 2428.494, "learn_time_ms": 23493.654, "learn_throughput": 170.259, "synch_weights_time_ms": 26.585}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 41, "trial_id": "0b608_00000", "date": "2024-08-22_14-02-51", "timestamp": 1724315571, "time_this_iter_s": 25.750821828842163, "time_total_s": 1064.4325211048126, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a3c3700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1064.4325211048126, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 32.56388888888889, "ram_util_percent": 82.93055555555557}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.4853338515317, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.391598233722505, "policy_loss": -0.006293161356299327, "vf_loss": 8.397303078161976, "vf_explained_var": 0.1943243554029515, "kl": 0.005883094488776156, "entropy": 0.32267420812258646, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 39218.0, "diff_num_grad_updates_vs_sampler_policy": 482.39499999999674}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.29986401134067, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.285870279584612, "policy_loss": -0.009112612049652155, "vf_loss": 8.293578741790126, "vf_explained_var": 0.6413217991117447, "kl": 0.007020586522828255, "entropy": 0.6444459784598577, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 39218.0, "diff_num_grad_updates_vs_sampler_policy": 482.39499999999674}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 1042.3641601111206, "episode_reward_min": -7.277263343997163, "episode_reward_mean": 260.7686820619059, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1467.958478652196, "predator_policy": 11.849302423726872}, "policy_reward_max": {"prey_policy": 376.5017728773215, "predator_policy": 1437.582355431176}, "policy_reward_mean": {"prey_policy": -709.5320950637567, "predator_policy": 839.9164360947098}, "custom_metrics": {}, "hist_stats": {"episode_reward": [214.71724884279988, 149.9680967177054, 174.26895653748355, 205.5052793462835, 0.9999999999999964, 67.19686262512664, -0.21484548628526445, 805.6894103904659, 804.0056021833975, 519.0339461824012, 616.8149679153485, 73.49489474358448, 681.4280817493842, 269.5755525148789, 27.233309111698695, 347.2412034108971, 413.9384405201989, 6.861159469577194, 6.1799451742635885, 15.339300566808511, 104.37104150188495, 248.42052613213997, 62.236465871076135, 556.1484470477285, 294.2025672745399, -3.1086244689504383e-15, 50.867610343028886, 38.6858192742844, 123.39999999999995, 49.17546691300083, 403.11242863684265, -1.4760775350272337, 4.799999999999999, 73.37694214166828, 20.336700365192648, 172.57757453100524, 210.79643785031408, 579.8237927937749, 151.11887553009066, 6.0, 952.3499264947486, 351.11746631577785, 347.0555391642599, 213.25426491837237, 144.38191604192215, -1.8207657603852567e-14, 1042.3641601111206, 0.3386193113504117, 408.08388347648565, 70.05759294851774, 0.5408646793972702, 13.571633263954359, 1.6000000000000028, 121.555703879456, 78.86591973553075, 7.000000000000005, 401.20177370912967, -0.04969503203640713, 404.36408980454274, 651.1038593522759, 594.5117959420054, 8.159005703379862, 69.93676167152486, 425.39855541373583, 650.4360322602283, 475.3206197207522, 268.2622330244709, 8.199999999999996, 426.20044860576314, 706.242258681925, 672.7798475547659, 286.9509467272686, 322.5283381396764, 15.461799894698665, 226.52413318953708, 17.788216317850562, 142.60150519805796, 451.6673899841696, 0.11532821215825884, 5.13990634001977, 0.9999999999999858, 226.7431478068426, 481.0117876606119, 212.38774863737365, 667.3184293496411, -0.14748211975054204, 670.4567629673078, 37.27490826063476, 258.68481713304436, 368.65540549770395, 1.5169794954143563, 840.8881092306289, 739.1003531121827, 268.7080399462153, 118.58860689232841, -7.277263343997163, 466.3658434407079, 230.24000494399414, 630.0429066311392, 335.0744287042068], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [29.02908786082144, -1049.6402181291776, -970.5731859376058, -862.6838057824777, -635.2097290752575, -912.8300529966822, -1092.5710141930897, -661.9493028712722, -1185.3919221605252, -1074.500935822292, -864.3888269288053, -1274.9873446611214, -979.0551397962296, -1124.7775402818518, 376.5017728773215, -885.4681609045003, 167.71725594200774, -991.5360602711486, -1028.0254235487796, -17.06909136438298, -66.95971373067206, -1012.8746944601986, -879.5315368885642, -1105.5278290259266, 243.74013705127155, -1102.406590162366, -1235.8837561427056, -233.4846098500242, -1117.3840587488305, -1082.1184480333766, -478.9463716305371, -247.61182543357495, -5.524414051058894, -1010.878150595379, -1252.2359494883492, -1296.0424684103773, -1288.512980140408, -866.3832590161367, -1190.7172730050722, -751.1964459311683, -975.652267512613, -697.2261875976234, -1299.9100294902642, 43.00594449871691, -187.48523848737335, -1153.0231510893173, -1286.8140443659613, 274.8325118989626, -1467.958478652196, -325.63406595503585, -1182.6039474550464, -1084.1452422551295, -558.7087759351296, -764.3018478871113, -1112.8254755889755, -1047.9379318679346, -642.0919931765353, -681.7144933265592, -1112.2992962178726, -716.8650669392824, 279.1543365836583, -927.2584546977121, -902.5924474259597, -1177.7074679115121, -1014.4047777143929, -1314.5169392580624, -1205.8241972404142, -476.5487826045771, -1111.949760473876, -1107.5085263313397, 41.52137905014392, -1028.7874336923467, -1101.9508081172348, -268.21182651186314, -1026.7413780504576, -47.84478459438685, -25.73077032647893, -1300.3991776520886, -1220.1676643749604, -1282.5417365034873, -814.3950516108503, 338.2418416621258, -1111.035378406077, 320.60750850635077, -883.8086875807192, -203.3970213437684, -710.4699860450578, 67.15762441397696, -1157.2467774891934, 38.97326212756845, -1397.954728914867, -1235.3706653496374, -994.0424515883385, 317.5838351634971, -1037.4106574043499, -1260.9198383086261, 339.9636348113893, -248.42491412672285, -797.3011150535269, -486.9554638075913, -1362.2080840231106, -1047.0054123167465, -1108.2296849527693, -1015.9606808059766, -1286.4454359103963, -914.8688595634048, -460.6487668159404, -1025.37045677014, -803.9580563988014, -771.3797085318455, -1119.3702113929603, -1074.8022906757135, -1100.8938478494117, 342.71740218383013, -1182.5551691714065, -1418.2478352582564, -1119.8116535986626, 370.9916357041396, -690.4362684484928, -275.66012864829776, -931.8614021553733, -380.0672333861465, -958.5801361930817, -1213.246972815987, -1295.4301204671253, -959.0137807513934, -1246.3945018978166, 202.3357483874421, -48.25572393479138, -1182.9167637643097, 15.49186124432947, -1332.1051251896533, 178.43311824031724, -1096.3787437025892, -907.5111798088365, -985.4939667168456, 82.66219474833062, -1171.7854703288845, 182.10288921868033, 345.0895220505373, -1041.9883403968715, 58.080695000094664, -119.72953206041788, -1009.3084687027579, -1279.3537318998308, 310.6612732626813, -1008.7596789836334, -971.3512796680567, -764.6633833819457, -41.787734081888814, -216.20053549619598, -963.7820741089089, -402.13917172648144, -1025.5051530139783, -257.26572883250486, 88.17989446648177, -847.1840970688465, -1148.9167711904647, -1135.9901498411145, -978.1157374021931, -1289.8847602240567, -1062.8845554713464, -236.621648299429, -554.1460645608016, 229.8935561908446, -689.6251068550648, -891.575384359919, -852.9978879866692, -4.012149995839991, -844.3418564979644, -1142.5390674415698, -1057.2427215036482, 40.13085739395676, -1052.5479033163633, -846.1996603822788, -853.7247363641086, -1077.2063984135666, -642.5621547641083, -621.8453384016956, -81.78195615951876, -766.5860099989147, -1139.2010118496112, -1029.5888872088105, 282.44672983788905, -90.50014615594911, -933.2520613134714, -269.0379094620081, -994.6983597227978, -690.1796257961659, -986.8122714245026, -938.780849021955, -1095.4634330487775, -661.5881305967519, 327.50171838673106, -256.6991552721187, -819.9790998661427, -1068.3864096737407, 235.1420105698992, 271.08972326674257, -1094.4766900607965], "policy_predator_policy_reward": [215.5955767959954, 1019.7328023151609, 1006.4086013478721, 976.8164870899188, 733.7370489156076, 988.571689693816, 818.2179557386457, 1141.807640672001, 1185.3919221605252, 1075.500935822292, 958.0729869843148, 1248.5000472307395, 978.8402943099443, 1124.7775402818518, 530.977705600761, 783.6780928168815, 908.609974157502, 719.2144323550364, 971.0859398741923, 593.0425212213692, 739.6088253634457, 957.040550742774, 864.0912639078311, 1194.4629967502365, 598.303461022443, 941.7910738380349, 1158.5522220259177, 580.3916964816916, 1143.6821919529943, 1083.0536239409118, 13.352129525738663, 1060.44727094927, 426.24479096763594, 1004.0962141990013, 1252.2359494883492, 1302.9036278799547, 1288.512980140408, 872.5632041904003, 1191.9172730050711, 765.3357464979773, 983.3522675126147, 793.8972290995086, 1299.9100294902642, 205.41458163342304, 328.9906859973102, 1073.754169450456, 758.9554338162377, 809.1745456984862, 1437.582355431176, 650.2127564505981, 1182.6039474550464, 1084.1452422551295, 439.43879180480684, 934.439442360461, 1172.3797964186053, 1027.0694303125886, 736.5666182013675, 710.6398683017256, 1022.2970186235818, 856.0428114465743, 212.21693283129912, 838.9996139195962, 900.6447027215746, 1178.17913508087, 1019.204777714393, 1314.5169392580624, 1128.9066973232316, 626.8432246634333, 1111.5955750705248, 1128.199412099883, 210.92799683267538, 948.9156323405334, 1101.1845480395552, 479.7745244398585, 734.363571980396, 920.0463834582212, 176.84964585656962, 1300.3991776520886, 1226.1676643749604, 1282.5417365034873, 703.451692047147, 725.0514443963242, 1111.035378406077, 30.509957809427267, 840.226597938208, 594.0346501505402, 445.61769976269585, 410.94892678675825, 1157.0786214606446, 105.5768099429033, 1397.954728914867, 1235.3706653496374, 806.5866542549654, 912.2361222809982, 1037.61065740435, 1261.0584576199767, 41.32024866509391, 275.2249141267266, 572.9693435576796, 781.344828251957, 1265.4095610688862, 1144.3447999503696, 1108.2296849527693, 1029.532314069931, 1286.745435910396, 916.1688595634048, 678.2642077122381, 929.3107197532984, 876.4580563988015, 777.7456282673762, 1126.37021139296, 1074.8022906757135, 1100.8938478494117, 58.48437152529966, 1182.5551691714065, 1418.19814022622, 1114.8357940339877, 38.34831366507824, 895.4321607917342, 721.7680956573374, 895.6540636009553, 1010.786367882574, 964.5001257464927, 1215.4859889659558, 1294.1652293807565, 1030.2154335092873, 1243.0844729872217, 226.37283593688903, 756.5832932057328, 1125.0252267535975, 540.3979128912297, 1251.5359707748457, 89.82911478415328, 1096.3787437025892, 915.7111798088363, 985.4939667168456, 1060.453781442409, 454.86994274390844, 112.4491073952645, 66.60074001744267, 705.1344934428389, 951.5529995087029, 571.2207133590094, 844.7682341314363, 1279.371494353099, 11.849302423726872, 1008.7596789836334, 986.8130795627554, 283.28260325829575, 749.6926473950764, 1016.5905780502762, 181.18024787267754, 545.9591834822082, 1024.286646456309, 69.16209473584843, 551.5911296143455, 847.9915267801887, 1148.2246696912807, 1141.1300561811345, 978.1157374021931, 1289.8847602240567, 1063.8845554713464, 667.6898746330551, 349.82098603402136, 294.848010955258, 645.8953273695732, 1146.9749395260355, 809.9860814579281, 430.0716126593929, 1085.6008231840513, 1142.5390674415698, 1057.0952393838977, 864.7209992291492, 818.1528096605601, 847.6303800407093, 889.5689249663134, 1012.2735559350691, 966.1798143756536, 560.0715165197836, 512.2111835391324, 771.4631630679894, 1135.840838275951, 874.8944201071706, 713.1358464943805, 816.1781517595595, 946.6744088220426, 616.3999291676305, 916.0443799633898, 825.8472554185372, 969.7332486944578, 939.780849021955, 1087.1861697047805, 735.5293355570217, 64.92292009370762, 757.1844814949313, 549.7337785873236, 1024.2677832007307, 439.0195225342512, 63.98470543746432, 1094.4766900607965]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.04383648871339, "mean_inference_ms": 4.36584182372243, "mean_action_processing_ms": 1.757642665414211, "mean_env_wait_ms": 12.07387697567859, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006026148796081543, "StateBufferConnector_ms": 0.005184531211853027, "ViewRequirementAgentConnector_ms": 0.17324304580688477}, "num_episodes": 9, "episode_return_max": 1042.3641601111206, "episode_return_min": -7.277263343997163, "episode_return_mean": 260.7686820619059, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.31352076658064, "num_env_steps_trained_throughput_per_sec": 156.31352076658064, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 25954.132, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25953.924, "sample_time_ms": 2437.48, "learn_time_ms": 23486.267, "learn_throughput": 170.312, "synch_weights_time_ms": 26.575}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 42, "trial_id": "0b608_00000", "date": "2024-08-22_14-03-16", "timestamp": 1724315596, "time_this_iter_s": 25.637358903884888, "time_total_s": 1090.0698800086975, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30e3d8dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1090.0698800086975, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 31.29189189189189, "ram_util_percent": 83.24864864864867}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.122784883509237, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.48889839232914, "policy_loss": -0.005809264141258108, "vf_loss": 8.49416421204017, "vf_explained_var": 0.20330629752426552, "kl": 0.005434576011997051, "entropy": 0.2794503851542397, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40163.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.831082952085627, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.171869576671137, "policy_loss": -0.010861053630197175, "vf_loss": 8.181189749480556, "vf_explained_var": 0.5381136582642005, "kl": 0.007704451994319994, "entropy": 0.6255656597790895, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40163.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 1042.3641601111206, "episode_reward_min": -7.277263343997163, "episode_reward_mean": 253.84467059958362, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1467.958478652196, "predator_policy": 11.849302423726872}, "policy_reward_max": {"prey_policy": 370.9916357041396, "predator_policy": 1437.582355431176}, "policy_reward_mean": {"prey_policy": -701.5903373040424, "predator_policy": 828.5126726038341}, "custom_metrics": {}, "hist_stats": {"episode_reward": [519.0339461824012, 616.8149679153485, 73.49489474358448, 681.4280817493842, 269.5755525148789, 27.233309111698695, 347.2412034108971, 413.9384405201989, 6.861159469577194, 6.1799451742635885, 15.339300566808511, 104.37104150188495, 248.42052613213997, 62.236465871076135, 556.1484470477285, 294.2025672745399, -3.1086244689504383e-15, 50.867610343028886, 38.6858192742844, 123.39999999999995, 49.17546691300083, 403.11242863684265, -1.4760775350272337, 4.799999999999999, 73.37694214166828, 20.336700365192648, 172.57757453100524, 210.79643785031408, 579.8237927937749, 151.11887553009066, 6.0, 952.3499264947486, 351.11746631577785, 347.0555391642599, 213.25426491837237, 144.38191604192215, -1.8207657603852567e-14, 1042.3641601111206, 0.3386193113504117, 408.08388347648565, 70.05759294851774, 0.5408646793972702, 13.571633263954359, 1.6000000000000028, 121.555703879456, 78.86591973553075, 7.000000000000005, 401.20177370912967, -0.04969503203640713, 404.36408980454274, 651.1038593522759, 594.5117959420054, 8.159005703379862, 69.93676167152486, 425.39855541373583, 650.4360322602283, 475.3206197207522, 268.2622330244709, 8.199999999999996, 426.20044860576314, 706.242258681925, 672.7798475547659, 286.9509467272686, 322.5283381396764, 15.461799894698665, 226.52413318953708, 17.788216317850562, 142.60150519805796, 451.6673899841696, 0.11532821215825884, 5.13990634001977, 0.9999999999999858, 226.7431478068426, 481.0117876606119, 212.38774863737365, 667.3184293496411, -0.14748211975054204, 670.4567629673078, 37.27490826063476, 258.68481713304436, 368.65540549770395, 1.5169794954143563, 840.8881092306289, 739.1003531121827, 268.7080399462153, 118.58860689232841, -7.277263343997163, 466.3658434407079, 230.24000494399414, 630.0429066311392, 335.0744287042068, 451.6541632080451, 26.586111770817485, 157.59989469688333, 261.54077062187287, 8.414157457135403, 532.9213107554654, 188.23147248030287, 84.18758393423326, 18.600000000000055], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1028.0254235487796, -17.06909136438298, -66.95971373067206, -1012.8746944601986, -879.5315368885642, -1105.5278290259266, 243.74013705127155, -1102.406590162366, -1235.8837561427056, -233.4846098500242, -1117.3840587488305, -1082.1184480333766, -478.9463716305371, -247.61182543357495, -5.524414051058894, -1010.878150595379, -1252.2359494883492, -1296.0424684103773, -1288.512980140408, -866.3832590161367, -1190.7172730050722, -751.1964459311683, -975.652267512613, -697.2261875976234, -1299.9100294902642, 43.00594449871691, -187.48523848737335, -1153.0231510893173, -1286.8140443659613, 274.8325118989626, -1467.958478652196, -325.63406595503585, -1182.6039474550464, -1084.1452422551295, -558.7087759351296, -764.3018478871113, -1112.8254755889755, -1047.9379318679346, -642.0919931765353, -681.7144933265592, -1112.2992962178726, -716.8650669392824, 279.1543365836583, -927.2584546977121, -902.5924474259597, -1177.7074679115121, -1014.4047777143929, -1314.5169392580624, -1205.8241972404142, -476.5487826045771, -1111.949760473876, -1107.5085263313397, 41.52137905014392, -1028.7874336923467, -1101.9508081172348, -268.21182651186314, -1026.7413780504576, -47.84478459438685, -25.73077032647893, -1300.3991776520886, -1220.1676643749604, -1282.5417365034873, -814.3950516108503, 338.2418416621258, -1111.035378406077, 320.60750850635077, -883.8086875807192, -203.3970213437684, -710.4699860450578, 67.15762441397696, -1157.2467774891934, 38.97326212756845, -1397.954728914867, -1235.3706653496374, -994.0424515883385, 317.5838351634971, -1037.4106574043499, -1260.9198383086261, 339.9636348113893, -248.42491412672285, -797.3011150535269, -486.9554638075913, -1362.2080840231106, -1047.0054123167465, -1108.2296849527693, -1015.9606808059766, -1286.4454359103963, -914.8688595634048, -460.6487668159404, -1025.37045677014, -803.9580563988014, -771.3797085318455, -1119.3702113929603, -1074.8022906757135, -1100.8938478494117, 342.71740218383013, -1182.5551691714065, -1418.2478352582564, -1119.8116535986626, 370.9916357041396, -690.4362684484928, -275.66012864829776, -931.8614021553733, -380.0672333861465, -958.5801361930817, -1213.246972815987, -1295.4301204671253, -959.0137807513934, -1246.3945018978166, 202.3357483874421, -48.25572393479138, -1182.9167637643097, 15.49186124432947, -1332.1051251896533, 178.43311824031724, -1096.3787437025892, -907.5111798088365, -985.4939667168456, 82.66219474833062, -1171.7854703288845, 182.10288921868033, 345.0895220505373, -1041.9883403968715, 58.080695000094664, -119.72953206041788, -1009.3084687027579, -1279.3537318998308, 310.6612732626813, -1008.7596789836334, -971.3512796680567, -764.6633833819457, -41.787734081888814, -216.20053549619598, -963.7820741089089, -402.13917172648144, -1025.5051530139783, -257.26572883250486, 88.17989446648177, -847.1840970688465, -1148.9167711904647, -1135.9901498411145, -978.1157374021931, -1289.8847602240567, -1062.8845554713464, -236.621648299429, -554.1460645608016, 229.8935561908446, -689.6251068550648, -891.575384359919, -852.9978879866692, -4.012149995839991, -844.3418564979644, -1142.5390674415698, -1057.2427215036482, 40.13085739395676, -1052.5479033163633, -846.1996603822788, -853.7247363641086, -1077.2063984135666, -642.5621547641083, -621.8453384016956, -81.78195615951876, -766.5860099989147, -1139.2010118496112, -1029.5888872088105, 282.44672983788905, -90.50014615594911, -933.2520613134714, -269.0379094620081, -994.6983597227978, -690.1796257961659, -986.8122714245026, -938.780849021955, -1095.4634330487775, -661.5881305967519, 327.50171838673106, -256.6991552721187, -819.9790998661427, -1068.3864096737407, 235.1420105698992, 271.08972326674257, -1094.4766900607965, -924.6312284629837, 11.17653461815442, -716.405789558946, -860.8690642707562, -794.3865329198633, -83.16851106587299, -613.9849330916687, -1003.5872113225614, -872.3723665008439, -958.8239852742682, -128.64486116664526, -1011.3867735128056, -646.7796585087938, -514.8469263046336, -327.3985963170454, -1067.4968665885842, -948.2693349152537, -942.0874660256354], "policy_predator_policy_reward": [971.0859398741923, 593.0425212213692, 739.6088253634457, 957.040550742774, 864.0912639078311, 1194.4629967502365, 598.303461022443, 941.7910738380349, 1158.5522220259177, 580.3916964816916, 1143.6821919529943, 1083.0536239409118, 13.352129525738663, 1060.44727094927, 426.24479096763594, 1004.0962141990013, 1252.2359494883492, 1302.9036278799547, 1288.512980140408, 872.5632041904003, 1191.9172730050711, 765.3357464979773, 983.3522675126147, 793.8972290995086, 1299.9100294902642, 205.41458163342304, 328.9906859973102, 1073.754169450456, 758.9554338162377, 809.1745456984862, 1437.582355431176, 650.2127564505981, 1182.6039474550464, 1084.1452422551295, 439.43879180480684, 934.439442360461, 1172.3797964186053, 1027.0694303125886, 736.5666182013675, 710.6398683017256, 1022.2970186235818, 856.0428114465743, 212.21693283129912, 838.9996139195962, 900.6447027215746, 1178.17913508087, 1019.204777714393, 1314.5169392580624, 1128.9066973232316, 626.8432246634333, 1111.5955750705248, 1128.199412099883, 210.92799683267538, 948.9156323405334, 1101.1845480395552, 479.7745244398585, 734.363571980396, 920.0463834582212, 176.84964585656962, 1300.3991776520886, 1226.1676643749604, 1282.5417365034873, 703.451692047147, 725.0514443963242, 1111.035378406077, 30.509957809427267, 840.226597938208, 594.0346501505402, 445.61769976269585, 410.94892678675825, 1157.0786214606446, 105.5768099429033, 1397.954728914867, 1235.3706653496374, 806.5866542549654, 912.2361222809982, 1037.61065740435, 1261.0584576199767, 41.32024866509391, 275.2249141267266, 572.9693435576796, 781.344828251957, 1265.4095610688862, 1144.3447999503696, 1108.2296849527693, 1029.532314069931, 1286.745435910396, 916.1688595634048, 678.2642077122381, 929.3107197532984, 876.4580563988015, 777.7456282673762, 1126.37021139296, 1074.8022906757135, 1100.8938478494117, 58.48437152529966, 1182.5551691714065, 1418.19814022622, 1114.8357940339877, 38.34831366507824, 895.4321607917342, 721.7680956573374, 895.6540636009553, 1010.786367882574, 964.5001257464927, 1215.4859889659558, 1294.1652293807565, 1030.2154335092873, 1243.0844729872217, 226.37283593688903, 756.5832932057328, 1125.0252267535975, 540.3979128912297, 1251.5359707748457, 89.82911478415328, 1096.3787437025892, 915.7111798088363, 985.4939667168456, 1060.453781442409, 454.86994274390844, 112.4491073952645, 66.60074001744267, 705.1344934428389, 951.5529995087029, 571.2207133590094, 844.7682341314363, 1279.371494353099, 11.849302423726872, 1008.7596789836334, 986.8130795627554, 283.28260325829575, 749.6926473950764, 1016.5905780502762, 181.18024787267754, 545.9591834822082, 1024.286646456309, 69.16209473584843, 551.5911296143455, 847.9915267801887, 1148.2246696912807, 1141.1300561811345, 978.1157374021931, 1289.8847602240567, 1063.8845554713464, 667.6898746330551, 349.82098603402136, 294.848010955258, 645.8953273695732, 1146.9749395260355, 809.9860814579281, 430.0716126593929, 1085.6008231840513, 1142.5390674415698, 1057.0952393838977, 864.7209992291492, 818.1528096605601, 847.6303800407093, 889.5689249663134, 1012.2735559350691, 966.1798143756536, 560.0715165197836, 512.2111835391324, 771.4631630679894, 1135.840838275951, 874.8944201071706, 713.1358464943805, 816.1781517595595, 946.6744088220426, 616.3999291676305, 916.0443799633898, 825.8472554185372, 969.7332486944578, 939.780849021955, 1087.1861697047805, 735.5293355570217, 64.92292009370762, 757.1844814949313, 549.7337785873236, 1024.2677832007307, 439.0195225342512, 63.98470543746432, 1094.4766900607965, 886.5113597871887, 478.59749726568407, 766.3697462361091, 837.4912193644103, 635.3980789481117, 399.7568597345072, 1031.0240074596381, 848.0889075764641, 1034.4428996738095, 805.167609558437, 814.6029258686933, 858.3500195662172, 574.1174809743994, 775.7405763193276, 411.5861802512798, 1067.4968665885842, 966.3693349152537, 942.5874660256354]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.048582276276487, "mean_inference_ms": 4.364261404304332, "mean_action_processing_ms": 1.7536944190809234, "mean_env_wait_ms": 12.090648904408448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059473514556884766, "StateBufferConnector_ms": 0.005113720893859863, "ViewRequirementAgentConnector_ms": 0.16941797733306885}, "num_episodes": 9, "episode_return_max": 1042.3641601111206, "episode_return_min": -7.277263343997163, "episode_return_mean": 253.84467059958362, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.31102826860146, "num_env_steps_trained_throughput_per_sec": 153.31102826860146, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 25968.621, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25968.415, "sample_time_ms": 2473.133, "learn_time_ms": 23465.235, "learn_throughput": 170.465, "synch_weights_time_ms": 26.46}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 43, "trial_id": "0b608_00000", "date": "2024-08-22_14-03-43", "timestamp": 1724315623, "time_this_iter_s": 26.12598991394043, "time_total_s": 1116.195869922638, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x312081670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1116.195869922638, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 33.34864864864865, "ram_util_percent": 83.06486486486487}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.58348737418967, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.360806133633568, "policy_loss": -0.009235863892420653, "vf_loss": 8.369407081099414, "vf_explained_var": 0.2766799711045765, "kl": 0.006349161644860432, "entropy": 0.3109492659411102, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 41108.0, "diff_num_grad_updates_vs_sampler_policy": 482.39499999999674}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.245686010582737, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.162151724699314, "policy_loss": -0.011013191020875066, "vf_loss": 8.171582754831466, "vf_explained_var": 0.6189919314687214, "kl": 0.007910964256595997, "entropy": 0.6127806874494705, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 41108.0, "diff_num_grad_updates_vs_sampler_policy": 482.39499999999674}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 1042.3641601111206, "episode_reward_min": -7.277263343997163, "episode_reward_mean": 250.11993218581162, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1467.958478652196, "predator_policy": 0.8878464494874463}, "policy_reward_max": {"prey_policy": 370.9916357041396, "predator_policy": 1437.582355431176}, "policy_reward_mean": {"prey_policy": -681.9837468073889, "predator_policy": 807.0437129002947}, "custom_metrics": {}, "hist_stats": {"episode_reward": [248.42052613213997, 62.236465871076135, 556.1484470477285, 294.2025672745399, -3.1086244689504383e-15, 50.867610343028886, 38.6858192742844, 123.39999999999995, 49.17546691300083, 403.11242863684265, -1.4760775350272337, 4.799999999999999, 73.37694214166828, 20.336700365192648, 172.57757453100524, 210.79643785031408, 579.8237927937749, 151.11887553009066, 6.0, 952.3499264947486, 351.11746631577785, 347.0555391642599, 213.25426491837237, 144.38191604192215, -1.8207657603852567e-14, 1042.3641601111206, 0.3386193113504117, 408.08388347648565, 70.05759294851774, 0.5408646793972702, 13.571633263954359, 1.6000000000000028, 121.555703879456, 78.86591973553075, 7.000000000000005, 401.20177370912967, -0.04969503203640713, 404.36408980454274, 651.1038593522759, 594.5117959420054, 8.159005703379862, 69.93676167152486, 425.39855541373583, 650.4360322602283, 475.3206197207522, 268.2622330244709, 8.199999999999996, 426.20044860576314, 706.242258681925, 672.7798475547659, 286.9509467272686, 322.5283381396764, 15.461799894698665, 226.52413318953708, 17.788216317850562, 142.60150519805796, 451.6673899841696, 0.11532821215825884, 5.13990634001977, 0.9999999999999858, 226.7431478068426, 481.0117876606119, 212.38774863737365, 667.3184293496411, -0.14748211975054204, 670.4567629673078, 37.27490826063476, 258.68481713304436, 368.65540549770395, 1.5169794954143563, 840.8881092306289, 739.1003531121827, 268.7080399462153, 118.58860689232841, -7.277263343997163, 466.3658434407079, 230.24000494399414, 630.0429066311392, 335.0744287042068, 451.6541632080451, 26.586111770817485, 157.59989469688333, 261.54077062187287, 8.414157457135403, 532.9213107554654, 188.23147248030287, 84.18758393423326, 18.600000000000055, 255.51927399358277, 14.799999999999994, 291.4338018515583, 41.6253340130188, 480.2026086382048, 529.9923857707257, 294.2714521281412, 1.7763568394002505e-15, 497.0198493595572, 7.993605777301127e-15, 282.8732957289397, 21.30000000000001], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1299.9100294902642, 43.00594449871691, -187.48523848737335, -1153.0231510893173, -1286.8140443659613, 274.8325118989626, -1467.958478652196, -325.63406595503585, -1182.6039474550464, -1084.1452422551295, -558.7087759351296, -764.3018478871113, -1112.8254755889755, -1047.9379318679346, -642.0919931765353, -681.7144933265592, -1112.2992962178726, -716.8650669392824, 279.1543365836583, -927.2584546977121, -902.5924474259597, -1177.7074679115121, -1014.4047777143929, -1314.5169392580624, -1205.8241972404142, -476.5487826045771, -1111.949760473876, -1107.5085263313397, 41.52137905014392, -1028.7874336923467, -1101.9508081172348, -268.21182651186314, -1026.7413780504576, -47.84478459438685, -25.73077032647893, -1300.3991776520886, -1220.1676643749604, -1282.5417365034873, -814.3950516108503, 338.2418416621258, -1111.035378406077, 320.60750850635077, -883.8086875807192, -203.3970213437684, -710.4699860450578, 67.15762441397696, -1157.2467774891934, 38.97326212756845, -1397.954728914867, -1235.3706653496374, -994.0424515883385, 317.5838351634971, -1037.4106574043499, -1260.9198383086261, 339.9636348113893, -248.42491412672285, -797.3011150535269, -486.9554638075913, -1362.2080840231106, -1047.0054123167465, -1108.2296849527693, -1015.9606808059766, -1286.4454359103963, -914.8688595634048, -460.6487668159404, -1025.37045677014, -803.9580563988014, -771.3797085318455, -1119.3702113929603, -1074.8022906757135, -1100.8938478494117, 342.71740218383013, -1182.5551691714065, -1418.2478352582564, -1119.8116535986626, 370.9916357041396, -690.4362684484928, -275.66012864829776, -931.8614021553733, -380.0672333861465, -958.5801361930817, -1213.246972815987, -1295.4301204671253, -959.0137807513934, -1246.3945018978166, 202.3357483874421, -48.25572393479138, -1182.9167637643097, 15.49186124432947, -1332.1051251896533, 178.43311824031724, -1096.3787437025892, -907.5111798088365, -985.4939667168456, 82.66219474833062, -1171.7854703288845, 182.10288921868033, 345.0895220505373, -1041.9883403968715, 58.080695000094664, -119.72953206041788, -1009.3084687027579, -1279.3537318998308, 310.6612732626813, -1008.7596789836334, -971.3512796680567, -764.6633833819457, -41.787734081888814, -216.20053549619598, -963.7820741089089, -402.13917172648144, -1025.5051530139783, -257.26572883250486, 88.17989446648177, -847.1840970688465, -1148.9167711904647, -1135.9901498411145, -978.1157374021931, -1289.8847602240567, -1062.8845554713464, -236.621648299429, -554.1460645608016, 229.8935561908446, -689.6251068550648, -891.575384359919, -852.9978879866692, -4.012149995839991, -844.3418564979644, -1142.5390674415698, -1057.2427215036482, 40.13085739395676, -1052.5479033163633, -846.1996603822788, -853.7247363641086, -1077.2063984135666, -642.5621547641083, -621.8453384016956, -81.78195615951876, -766.5860099989147, -1139.2010118496112, -1029.5888872088105, 282.44672983788905, -90.50014615594911, -933.2520613134714, -269.0379094620081, -994.6983597227978, -690.1796257961659, -986.8122714245026, -938.780849021955, -1095.4634330487775, -661.5881305967519, 327.50171838673106, -256.6991552721187, -819.9790998661427, -1068.3864096737407, 235.1420105698992, 271.08972326674257, -1094.4766900607965, -924.6312284629837, 11.17653461815442, -716.405789558946, -860.8690642707562, -794.3865329198633, -83.16851106587299, -613.9849330916687, -1003.5872113225614, -872.3723665008439, -958.8239852742682, -128.64486116664526, -1011.3867735128056, -646.7796585087938, -514.8469263046336, -327.3985963170454, -1067.4968665885842, -948.2693349152537, -942.0874660256354, 24.843651340284758, -764.3906359675259, -983.0115836439948, -858.3490384427502, -891.715913555865, -361.2504575160083, -1135.3188366645966, -620.6172229363619, -38.06035983407125, 139.9293919474889, -738.4780257105889, 178.08079599569766, -150.6843360354399, -1034.9755228356257, -950.4647200609257, -1026.924910057712, 40.03614979508194, -1151.386944643099, -1057.1319130915315, -1104.0456606448572, 281.98544927945227, -1023.2458040623336, -1099.3386545915964, -452.62000644930663], "policy_predator_policy_reward": [1299.9100294902642, 205.41458163342304, 328.9906859973102, 1073.754169450456, 758.9554338162377, 809.1745456984862, 1437.582355431176, 650.2127564505981, 1182.6039474550464, 1084.1452422551295, 439.43879180480684, 934.439442360461, 1172.3797964186053, 1027.0694303125886, 736.5666182013675, 710.6398683017256, 1022.2970186235818, 856.0428114465743, 212.21693283129912, 838.9996139195962, 900.6447027215746, 1178.17913508087, 1019.204777714393, 1314.5169392580624, 1128.9066973232316, 626.8432246634333, 1111.5955750705248, 1128.199412099883, 210.92799683267538, 948.9156323405334, 1101.1845480395552, 479.7745244398585, 734.363571980396, 920.0463834582212, 176.84964585656962, 1300.3991776520886, 1226.1676643749604, 1282.5417365034873, 703.451692047147, 725.0514443963242, 1111.035378406077, 30.509957809427267, 840.226597938208, 594.0346501505402, 445.61769976269585, 410.94892678675825, 1157.0786214606446, 105.5768099429033, 1397.954728914867, 1235.3706653496374, 806.5866542549654, 912.2361222809982, 1037.61065740435, 1261.0584576199767, 41.32024866509391, 275.2249141267266, 572.9693435576796, 781.344828251957, 1265.4095610688862, 1144.3447999503696, 1108.2296849527693, 1029.532314069931, 1286.745435910396, 916.1688595634048, 678.2642077122381, 929.3107197532984, 876.4580563988015, 777.7456282673762, 1126.37021139296, 1074.8022906757135, 1100.8938478494117, 58.48437152529966, 1182.5551691714065, 1418.19814022622, 1114.8357940339877, 38.34831366507824, 895.4321607917342, 721.7680956573374, 895.6540636009553, 1010.786367882574, 964.5001257464927, 1215.4859889659558, 1294.1652293807565, 1030.2154335092873, 1243.0844729872217, 226.37283593688903, 756.5832932057328, 1125.0252267535975, 540.3979128912297, 1251.5359707748457, 89.82911478415328, 1096.3787437025892, 915.7111798088363, 985.4939667168456, 1060.453781442409, 454.86994274390844, 112.4491073952645, 66.60074001744267, 705.1344934428389, 951.5529995087029, 571.2207133590094, 844.7682341314363, 1279.371494353099, 11.849302423726872, 1008.7596789836334, 986.8130795627554, 283.28260325829575, 749.6926473950764, 1016.5905780502762, 181.18024787267754, 545.9591834822082, 1024.286646456309, 69.16209473584843, 551.5911296143455, 847.9915267801887, 1148.2246696912807, 1141.1300561811345, 978.1157374021931, 1289.8847602240567, 1063.8845554713464, 667.6898746330551, 349.82098603402136, 294.848010955258, 645.8953273695732, 1146.9749395260355, 809.9860814579281, 430.0716126593929, 1085.6008231840513, 1142.5390674415698, 1057.0952393838977, 864.7209992291492, 818.1528096605601, 847.6303800407093, 889.5689249663134, 1012.2735559350691, 966.1798143756536, 560.0715165197836, 512.2111835391324, 771.4631630679894, 1135.840838275951, 874.8944201071706, 713.1358464943805, 816.1781517595595, 946.6744088220426, 616.3999291676305, 916.0443799633898, 825.8472554185372, 969.7332486944578, 939.780849021955, 1087.1861697047805, 735.5293355570217, 64.92292009370762, 757.1844814949313, 549.7337785873236, 1024.2677832007307, 439.0195225342512, 63.98470543746432, 1094.4766900607965, 886.5113597871887, 478.59749726568407, 766.3697462361091, 837.4912193644103, 635.3980789481117, 399.7568597345072, 1031.0240074596381, 848.0889075764641, 1034.4428996738095, 805.167609558437, 814.6029258686933, 858.3500195662172, 574.1174809743994, 775.7405763193276, 411.5861802512798, 1067.4968665885842, 966.3693349152537, 942.5874660256354, 220.16301235975337, 774.9032462610728, 995.8115836439948, 860.3490384427502, 794.9648150509237, 749.4353578725103, 1145.307524461222, 652.2538691527583, 185.2555114739396, 193.0780650508476, 736.8106837420422, 353.578931743576, 522.8045760367206, 957.1267349624844, 950.4647200609257, 1026.924910057712, 566.1893819874432, 1042.1812622201276, 1057.1319130915315, 1104.0456606448572, 0.8878464494874463, 1023.2458040623336, 1099.3386545915964, 473.92000644930664]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.031783930699535, "mean_inference_ms": 4.374324708410112, "mean_action_processing_ms": 1.768552117469032, "mean_env_wait_ms": 12.109891334901244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005110025405883789, "StateBufferConnector_ms": 0.0044939517974853516, "ViewRequirementAgentConnector_ms": 0.16940808296203613}, "num_episodes": 12, "episode_return_max": 1042.3641601111206, "episode_return_min": -7.277263343997163, "episode_return_mean": 250.11993218581162, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 152.26175310692972, "num_env_steps_trained_throughput_per_sec": 152.26175310692972, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 25906.002, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25905.788, "sample_time_ms": 2453.955, "learn_time_ms": 23421.242, "learn_throughput": 170.785, "synch_weights_time_ms": 26.898}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 44, "trial_id": "0b608_00000", "date": "2024-08-22_14-04-09", "timestamp": 1724315649, "time_this_iter_s": 26.33212113380432, "time_total_s": 1142.5279910564423, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30e4154c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1142.5279910564423, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 33.98918918918918, "ram_util_percent": 83.09999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.07305439363712, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.136282378908188, "policy_loss": -0.009087227636741267, "vf_loss": 8.144713707575722, "vf_explained_var": 0.2595888437417449, "kl": 0.006558928950123055, "entropy": 0.30918184600809895, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42053.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.971211283042948, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.736682541660531, "policy_loss": -0.009024094734538012, "vf_loss": 7.744198425232418, "vf_explained_var": 0.7023266205081233, "kl": 0.007541063589551461, "entropy": 0.6339983142242229, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42053.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 1042.3641601111206, "episode_reward_min": -22.438281325711664, "episode_reward_mean": 249.84427724716764, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1418.2478352582564, "predator_policy": 0.8878464494874463}, "policy_reward_max": {"prey_policy": 370.9916357041396, "predator_policy": 1418.19814022622}, "policy_reward_mean": {"prey_policy": -677.9942707801472, "predator_policy": 802.9164094037311}, "custom_metrics": {}, "hist_stats": {"episode_reward": [403.11242863684265, -1.4760775350272337, 4.799999999999999, 73.37694214166828, 20.336700365192648, 172.57757453100524, 210.79643785031408, 579.8237927937749, 151.11887553009066, 6.0, 952.3499264947486, 351.11746631577785, 347.0555391642599, 213.25426491837237, 144.38191604192215, -1.8207657603852567e-14, 1042.3641601111206, 0.3386193113504117, 408.08388347648565, 70.05759294851774, 0.5408646793972702, 13.571633263954359, 1.6000000000000028, 121.555703879456, 78.86591973553075, 7.000000000000005, 401.20177370912967, -0.04969503203640713, 404.36408980454274, 651.1038593522759, 594.5117959420054, 8.159005703379862, 69.93676167152486, 425.39855541373583, 650.4360322602283, 475.3206197207522, 268.2622330244709, 8.199999999999996, 426.20044860576314, 706.242258681925, 672.7798475547659, 286.9509467272686, 322.5283381396764, 15.461799894698665, 226.52413318953708, 17.788216317850562, 142.60150519805796, 451.6673899841696, 0.11532821215825884, 5.13990634001977, 0.9999999999999858, 226.7431478068426, 481.0117876606119, 212.38774863737365, 667.3184293496411, -0.14748211975054204, 670.4567629673078, 37.27490826063476, 258.68481713304436, 368.65540549770395, 1.5169794954143563, 840.8881092306289, 739.1003531121827, 268.7080399462153, 118.58860689232841, -7.277263343997163, 466.3658434407079, 230.24000494399414, 630.0429066311392, 335.0744287042068, 451.6541632080451, 26.586111770817485, 157.59989469688333, 261.54077062187287, 8.414157457135403, 532.9213107554654, 188.23147248030287, 84.18758393423326, 18.600000000000055, 255.51927399358277, 14.799999999999994, 291.4338018515583, 41.6253340130188, 480.2026086382048, 529.9923857707257, 294.2714521281412, 1.7763568394002505e-15, 497.0198493595572, 7.993605777301127e-15, 282.8732957289397, 21.30000000000001, 2.9020428495225605, -22.438281325711664, 231.0223185413019, 28.99115039436936, 224.99624610121236, 210.4480502781889, 719.2700351681, 0.6999999999999982, -0.32015301559163456], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [279.1543365836583, -927.2584546977121, -902.5924474259597, -1177.7074679115121, -1014.4047777143929, -1314.5169392580624, -1205.8241972404142, -476.5487826045771, -1111.949760473876, -1107.5085263313397, 41.52137905014392, -1028.7874336923467, -1101.9508081172348, -268.21182651186314, -1026.7413780504576, -47.84478459438685, -25.73077032647893, -1300.3991776520886, -1220.1676643749604, -1282.5417365034873, -814.3950516108503, 338.2418416621258, -1111.035378406077, 320.60750850635077, -883.8086875807192, -203.3970213437684, -710.4699860450578, 67.15762441397696, -1157.2467774891934, 38.97326212756845, -1397.954728914867, -1235.3706653496374, -994.0424515883385, 317.5838351634971, -1037.4106574043499, -1260.9198383086261, 339.9636348113893, -248.42491412672285, -797.3011150535269, -486.9554638075913, -1362.2080840231106, -1047.0054123167465, -1108.2296849527693, -1015.9606808059766, -1286.4454359103963, -914.8688595634048, -460.6487668159404, -1025.37045677014, -803.9580563988014, -771.3797085318455, -1119.3702113929603, -1074.8022906757135, -1100.8938478494117, 342.71740218383013, -1182.5551691714065, -1418.2478352582564, -1119.8116535986626, 370.9916357041396, -690.4362684484928, -275.66012864829776, -931.8614021553733, -380.0672333861465, -958.5801361930817, -1213.246972815987, -1295.4301204671253, -959.0137807513934, -1246.3945018978166, 202.3357483874421, -48.25572393479138, -1182.9167637643097, 15.49186124432947, -1332.1051251896533, 178.43311824031724, -1096.3787437025892, -907.5111798088365, -985.4939667168456, 82.66219474833062, -1171.7854703288845, 182.10288921868033, 345.0895220505373, -1041.9883403968715, 58.080695000094664, -119.72953206041788, -1009.3084687027579, -1279.3537318998308, 310.6612732626813, -1008.7596789836334, -971.3512796680567, -764.6633833819457, -41.787734081888814, -216.20053549619598, -963.7820741089089, -402.13917172648144, -1025.5051530139783, -257.26572883250486, 88.17989446648177, -847.1840970688465, -1148.9167711904647, -1135.9901498411145, -978.1157374021931, -1289.8847602240567, -1062.8845554713464, -236.621648299429, -554.1460645608016, 229.8935561908446, -689.6251068550648, -891.575384359919, -852.9978879866692, -4.012149995839991, -844.3418564979644, -1142.5390674415698, -1057.2427215036482, 40.13085739395676, -1052.5479033163633, -846.1996603822788, -853.7247363641086, -1077.2063984135666, -642.5621547641083, -621.8453384016956, -81.78195615951876, -766.5860099989147, -1139.2010118496112, -1029.5888872088105, 282.44672983788905, -90.50014615594911, -933.2520613134714, -269.0379094620081, -994.6983597227978, -690.1796257961659, -986.8122714245026, -938.780849021955, -1095.4634330487775, -661.5881305967519, 327.50171838673106, -256.6991552721187, -819.9790998661427, -1068.3864096737407, 235.1420105698992, 271.08972326674257, -1094.4766900607965, -924.6312284629837, 11.17653461815442, -716.405789558946, -860.8690642707562, -794.3865329198633, -83.16851106587299, -613.9849330916687, -1003.5872113225614, -872.3723665008439, -958.8239852742682, -128.64486116664526, -1011.3867735128056, -646.7796585087938, -514.8469263046336, -327.3985963170454, -1067.4968665885842, -948.2693349152537, -942.0874660256354, 24.843651340284758, -764.3906359675259, -983.0115836439948, -858.3490384427502, -891.715913555865, -361.2504575160083, -1135.3188366645966, -620.6172229363619, -38.06035983407125, 139.9293919474889, -738.4780257105889, 178.08079599569766, -150.6843360354399, -1034.9755228356257, -950.4647200609257, -1026.924910057712, 40.03614979508194, -1151.386944643099, -1057.1319130915315, -1104.0456606448572, 281.98544927945227, -1023.2458040623336, -1099.3386545915964, -452.62000644930663, -1020.2429384843405, -700.8451596433407, -765.0095831491806, -690.2272164351268, -905.7258604974357, -746.537770425619, -836.7673578332452, -888.5534316145131, -265.0584022951205, -463.1553227537704, -952.2613712071914, -634.1101984962777, -802.1129768214523, 165.68989333179448, -964.8471801587802, -855.6538430651397, -1199.2140253490095, -983.9526719459352], "policy_predator_policy_reward": [212.21693283129912, 838.9996139195962, 900.6447027215746, 1178.17913508087, 1019.204777714393, 1314.5169392580624, 1128.9066973232316, 626.8432246634333, 1111.5955750705248, 1128.199412099883, 210.92799683267538, 948.9156323405334, 1101.1845480395552, 479.7745244398585, 734.363571980396, 920.0463834582212, 176.84964585656962, 1300.3991776520886, 1226.1676643749604, 1282.5417365034873, 703.451692047147, 725.0514443963242, 1111.035378406077, 30.509957809427267, 840.226597938208, 594.0346501505402, 445.61769976269585, 410.94892678675825, 1157.0786214606446, 105.5768099429033, 1397.954728914867, 1235.3706653496374, 806.5866542549654, 912.2361222809982, 1037.61065740435, 1261.0584576199767, 41.32024866509391, 275.2249141267266, 572.9693435576796, 781.344828251957, 1265.4095610688862, 1144.3447999503696, 1108.2296849527693, 1029.532314069931, 1286.745435910396, 916.1688595634048, 678.2642077122381, 929.3107197532984, 876.4580563988015, 777.7456282673762, 1126.37021139296, 1074.8022906757135, 1100.8938478494117, 58.48437152529966, 1182.5551691714065, 1418.19814022622, 1114.8357940339877, 38.34831366507824, 895.4321607917342, 721.7680956573374, 895.6540636009553, 1010.786367882574, 964.5001257464927, 1215.4859889659558, 1294.1652293807565, 1030.2154335092873, 1243.0844729872217, 226.37283593688903, 756.5832932057328, 1125.0252267535975, 540.3979128912297, 1251.5359707748457, 89.82911478415328, 1096.3787437025892, 915.7111798088363, 985.4939667168456, 1060.453781442409, 454.86994274390844, 112.4491073952645, 66.60074001744267, 705.1344934428389, 951.5529995087029, 571.2207133590094, 844.7682341314363, 1279.371494353099, 11.849302423726872, 1008.7596789836334, 986.8130795627554, 283.28260325829575, 749.6926473950764, 1016.5905780502762, 181.18024787267754, 545.9591834822082, 1024.286646456309, 69.16209473584843, 551.5911296143455, 847.9915267801887, 1148.2246696912807, 1141.1300561811345, 978.1157374021931, 1289.8847602240567, 1063.8845554713464, 667.6898746330551, 349.82098603402136, 294.848010955258, 645.8953273695732, 1146.9749395260355, 809.9860814579281, 430.0716126593929, 1085.6008231840513, 1142.5390674415698, 1057.0952393838977, 864.7209992291492, 818.1528096605601, 847.6303800407093, 889.5689249663134, 1012.2735559350691, 966.1798143756536, 560.0715165197836, 512.2111835391324, 771.4631630679894, 1135.840838275951, 874.8944201071706, 713.1358464943805, 816.1781517595595, 946.6744088220426, 616.3999291676305, 916.0443799633898, 825.8472554185372, 969.7332486944578, 939.780849021955, 1087.1861697047805, 735.5293355570217, 64.92292009370762, 757.1844814949313, 549.7337785873236, 1024.2677832007307, 439.0195225342512, 63.98470543746432, 1094.4766900607965, 886.5113597871887, 478.59749726568407, 766.3697462361091, 837.4912193644103, 635.3980789481117, 399.7568597345072, 1031.0240074596381, 848.0889075764641, 1034.4428996738095, 805.167609558437, 814.6029258686933, 858.3500195662172, 574.1174809743994, 775.7405763193276, 411.5861802512798, 1067.4968665885842, 966.3693349152537, 942.5874660256354, 220.16301235975337, 774.9032462610728, 995.8115836439948, 860.3490384427502, 794.9648150509237, 749.4353578725103, 1145.307524461222, 652.2538691527583, 185.2555114739396, 193.0780650508476, 736.8106837420422, 353.578931743576, 522.8045760367206, 957.1267349624844, 950.4647200609257, 1026.924910057712, 566.1893819874432, 1042.1812622201276, 1057.1319130915315, 1104.0456606448572, 0.8878464494874463, 1023.2458040623336, 1099.3386545915964, 473.92000644930664, 876.5371344542345, 847.4530065229698, 689.5958236502485, 743.2026946083474, 892.3036145204774, 990.982334943879, 861.7741389869038, 892.537800855224, 400.6746447556051, 552.5353263944982, 913.9444308327382, 882.8751891489209, 704.8919845909573, 650.8011340667994, 965.5471801587804, 855.6538430651397, 1199.2140253490095, 983.6325189303435]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.037675576431015, "mean_inference_ms": 4.374266895074673, "mean_action_processing_ms": 1.7561162419152645, "mean_env_wait_ms": 12.125470649426143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050106048583984375, "StateBufferConnector_ms": 0.004491448402404785, "ViewRequirementAgentConnector_ms": 0.17603635787963867}, "num_episodes": 9, "episode_return_max": 1042.3641601111206, "episode_return_min": -22.438281325711664, "episode_return_mean": 249.84427724716764, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.3503276088535, "num_env_steps_trained_throughput_per_sec": 155.3503276088535, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 25891.641, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25891.427, "sample_time_ms": 2444.943, "learn_time_ms": 23415.773, "learn_throughput": 170.825, "synch_weights_time_ms": 26.951}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 45, "trial_id": "0b608_00000", "date": "2024-08-22_14-04-35", "timestamp": 1724315675, "time_this_iter_s": 25.795846939086914, "time_total_s": 1168.3238379955292, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a35c820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1168.3238379955292, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 32.21944444444444, "ram_util_percent": 82.78888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.75050799606969, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.174015515443509, "policy_loss": -0.007274785530679519, "vf_loss": 8.180624040977033, "vf_explained_var": 0.2530790857537083, "kl": 0.006662498089169502, "entropy": 0.3038827970072075, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42998.0, "diff_num_grad_updates_vs_sampler_policy": 482.39499999999674}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.090699570519583, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.909458141730576, "policy_loss": -0.008949122537006304, "vf_loss": 7.916953406762825, "vf_explained_var": 0.6700979115471007, "kl": 0.007269318698703376, "entropy": 0.6192461873488452, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42998.0, "diff_num_grad_updates_vs_sampler_policy": 482.39499999999674}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 1042.3641601111206, "episode_reward_min": -22.438281325711664, "episode_reward_mean": 253.4832672880732, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1418.2478352582564, "predator_policy": 0.8878464494874463}, "policy_reward_max": {"prey_policy": 370.9916357041396, "predator_policy": 1418.19814022622}, "policy_reward_mean": {"prey_policy": -670.3081304899778, "predator_policy": 797.0497641340146}, "custom_metrics": {}, "hist_stats": {"episode_reward": [151.11887553009066, 6.0, 952.3499264947486, 351.11746631577785, 347.0555391642599, 213.25426491837237, 144.38191604192215, -1.8207657603852567e-14, 1042.3641601111206, 0.3386193113504117, 408.08388347648565, 70.05759294851774, 0.5408646793972702, 13.571633263954359, 1.6000000000000028, 121.555703879456, 78.86591973553075, 7.000000000000005, 401.20177370912967, -0.04969503203640713, 404.36408980454274, 651.1038593522759, 594.5117959420054, 8.159005703379862, 69.93676167152486, 425.39855541373583, 650.4360322602283, 475.3206197207522, 268.2622330244709, 8.199999999999996, 426.20044860576314, 706.242258681925, 672.7798475547659, 286.9509467272686, 322.5283381396764, 15.461799894698665, 226.52413318953708, 17.788216317850562, 142.60150519805796, 451.6673899841696, 0.11532821215825884, 5.13990634001977, 0.9999999999999858, 226.7431478068426, 481.0117876606119, 212.38774863737365, 667.3184293496411, -0.14748211975054204, 670.4567629673078, 37.27490826063476, 258.68481713304436, 368.65540549770395, 1.5169794954143563, 840.8881092306289, 739.1003531121827, 268.7080399462153, 118.58860689232841, -7.277263343997163, 466.3658434407079, 230.24000494399414, 630.0429066311392, 335.0744287042068, 451.6541632080451, 26.586111770817485, 157.59989469688333, 261.54077062187287, 8.414157457135403, 532.9213107554654, 188.23147248030287, 84.18758393423326, 18.600000000000055, 255.51927399358277, 14.799999999999994, 291.4338018515583, 41.6253340130188, 480.2026086382048, 529.9923857707257, 294.2714521281412, 1.7763568394002505e-15, 497.0198493595572, 7.993605777301127e-15, 282.8732957289397, 21.30000000000001, 2.9020428495225605, -22.438281325711664, 231.0223185413019, 28.99115039436936, 224.99624610121236, 210.4480502781889, 719.2700351681, 0.6999999999999982, -0.32015301559163456, -5.301264965872615, 156.2089424335749, -5.329070518200751e-15, 78.248760163328, 307.47163330889566, 232.64621791598682, 405.5981450612816, 652.3743689571353], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-25.73077032647893, -1300.3991776520886, -1220.1676643749604, -1282.5417365034873, -814.3950516108503, 338.2418416621258, -1111.035378406077, 320.60750850635077, -883.8086875807192, -203.3970213437684, -710.4699860450578, 67.15762441397696, -1157.2467774891934, 38.97326212756845, -1397.954728914867, -1235.3706653496374, -994.0424515883385, 317.5838351634971, -1037.4106574043499, -1260.9198383086261, 339.9636348113893, -248.42491412672285, -797.3011150535269, -486.9554638075913, -1362.2080840231106, -1047.0054123167465, -1108.2296849527693, -1015.9606808059766, -1286.4454359103963, -914.8688595634048, -460.6487668159404, -1025.37045677014, -803.9580563988014, -771.3797085318455, -1119.3702113929603, -1074.8022906757135, -1100.8938478494117, 342.71740218383013, -1182.5551691714065, -1418.2478352582564, -1119.8116535986626, 370.9916357041396, -690.4362684484928, -275.66012864829776, -931.8614021553733, -380.0672333861465, -958.5801361930817, -1213.246972815987, -1295.4301204671253, -959.0137807513934, -1246.3945018978166, 202.3357483874421, -48.25572393479138, -1182.9167637643097, 15.49186124432947, -1332.1051251896533, 178.43311824031724, -1096.3787437025892, -907.5111798088365, -985.4939667168456, 82.66219474833062, -1171.7854703288845, 182.10288921868033, 345.0895220505373, -1041.9883403968715, 58.080695000094664, -119.72953206041788, -1009.3084687027579, -1279.3537318998308, 310.6612732626813, -1008.7596789836334, -971.3512796680567, -764.6633833819457, -41.787734081888814, -216.20053549619598, -963.7820741089089, -402.13917172648144, -1025.5051530139783, -257.26572883250486, 88.17989446648177, -847.1840970688465, -1148.9167711904647, -1135.9901498411145, -978.1157374021931, -1289.8847602240567, -1062.8845554713464, -236.621648299429, -554.1460645608016, 229.8935561908446, -689.6251068550648, -891.575384359919, -852.9978879866692, -4.012149995839991, -844.3418564979644, -1142.5390674415698, -1057.2427215036482, 40.13085739395676, -1052.5479033163633, -846.1996603822788, -853.7247363641086, -1077.2063984135666, -642.5621547641083, -621.8453384016956, -81.78195615951876, -766.5860099989147, -1139.2010118496112, -1029.5888872088105, 282.44672983788905, -90.50014615594911, -933.2520613134714, -269.0379094620081, -994.6983597227978, -690.1796257961659, -986.8122714245026, -938.780849021955, -1095.4634330487775, -661.5881305967519, 327.50171838673106, -256.6991552721187, -819.9790998661427, -1068.3864096737407, 235.1420105698992, 271.08972326674257, -1094.4766900607965, -924.6312284629837, 11.17653461815442, -716.405789558946, -860.8690642707562, -794.3865329198633, -83.16851106587299, -613.9849330916687, -1003.5872113225614, -872.3723665008439, -958.8239852742682, -128.64486116664526, -1011.3867735128056, -646.7796585087938, -514.8469263046336, -327.3985963170454, -1067.4968665885842, -948.2693349152537, -942.0874660256354, 24.843651340284758, -764.3906359675259, -983.0115836439948, -858.3490384427502, -891.715913555865, -361.2504575160083, -1135.3188366645966, -620.6172229363619, -38.06035983407125, 139.9293919474889, -738.4780257105889, 178.08079599569766, -150.6843360354399, -1034.9755228356257, -950.4647200609257, -1026.924910057712, 40.03614979508194, -1151.386944643099, -1057.1319130915315, -1104.0456606448572, 281.98544927945227, -1023.2458040623336, -1099.3386545915964, -452.62000644930663, -1020.2429384843405, -700.8451596433407, -765.0095831491806, -690.2272164351268, -905.7258604974357, -746.537770425619, -836.7673578332452, -888.5534316145131, -265.0584022951205, -463.1553227537704, -952.2613712071914, -634.1101984962777, -802.1129768214523, 165.68989333179448, -964.8471801587802, -855.6538430651397, -1199.2140253490095, -983.9526719459352, -1038.9620174666434, -955.7875200562529, -364.2958947439972, -860.7175090783647, -1158.9020267254466, -858.4022232303714, -1054.1780610247836, -460.98349027872047, -96.31910060872644, -954.210360675706, -341.8643244448935, -1083.28930037143, -65.04218815419509, -1085.0938076905932, -694.5223930455571, 218.6264066392309], "policy_predator_policy_reward": [176.84964585656962, 1300.3991776520886, 1226.1676643749604, 1282.5417365034873, 703.451692047147, 725.0514443963242, 1111.035378406077, 30.509957809427267, 840.226597938208, 594.0346501505402, 445.61769976269585, 410.94892678675825, 1157.0786214606446, 105.5768099429033, 1397.954728914867, 1235.3706653496374, 806.5866542549654, 912.2361222809982, 1037.61065740435, 1261.0584576199767, 41.32024866509391, 275.2249141267266, 572.9693435576796, 781.344828251957, 1265.4095610688862, 1144.3447999503696, 1108.2296849527693, 1029.532314069931, 1286.745435910396, 916.1688595634048, 678.2642077122381, 929.3107197532984, 876.4580563988015, 777.7456282673762, 1126.37021139296, 1074.8022906757135, 1100.8938478494117, 58.48437152529966, 1182.5551691714065, 1418.19814022622, 1114.8357940339877, 38.34831366507824, 895.4321607917342, 721.7680956573374, 895.6540636009553, 1010.786367882574, 964.5001257464927, 1215.4859889659558, 1294.1652293807565, 1030.2154335092873, 1243.0844729872217, 226.37283593688903, 756.5832932057328, 1125.0252267535975, 540.3979128912297, 1251.5359707748457, 89.82911478415328, 1096.3787437025892, 915.7111798088363, 985.4939667168456, 1060.453781442409, 454.86994274390844, 112.4491073952645, 66.60074001744267, 705.1344934428389, 951.5529995087029, 571.2207133590094, 844.7682341314363, 1279.371494353099, 11.849302423726872, 1008.7596789836334, 986.8130795627554, 283.28260325829575, 749.6926473950764, 1016.5905780502762, 181.18024787267754, 545.9591834822082, 1024.286646456309, 69.16209473584843, 551.5911296143455, 847.9915267801887, 1148.2246696912807, 1141.1300561811345, 978.1157374021931, 1289.8847602240567, 1063.8845554713464, 667.6898746330551, 349.82098603402136, 294.848010955258, 645.8953273695732, 1146.9749395260355, 809.9860814579281, 430.0716126593929, 1085.6008231840513, 1142.5390674415698, 1057.0952393838977, 864.7209992291492, 818.1528096605601, 847.6303800407093, 889.5689249663134, 1012.2735559350691, 966.1798143756536, 560.0715165197836, 512.2111835391324, 771.4631630679894, 1135.840838275951, 874.8944201071706, 713.1358464943805, 816.1781517595595, 946.6744088220426, 616.3999291676305, 916.0443799633898, 825.8472554185372, 969.7332486944578, 939.780849021955, 1087.1861697047805, 735.5293355570217, 64.92292009370762, 757.1844814949313, 549.7337785873236, 1024.2677832007307, 439.0195225342512, 63.98470543746432, 1094.4766900607965, 886.5113597871887, 478.59749726568407, 766.3697462361091, 837.4912193644103, 635.3980789481117, 399.7568597345072, 1031.0240074596381, 848.0889075764641, 1034.4428996738095, 805.167609558437, 814.6029258686933, 858.3500195662172, 574.1174809743994, 775.7405763193276, 411.5861802512798, 1067.4968665885842, 966.3693349152537, 942.5874660256354, 220.16301235975337, 774.9032462610728, 995.8115836439948, 860.3490384427502, 794.9648150509237, 749.4353578725103, 1145.307524461222, 652.2538691527583, 185.2555114739396, 193.0780650508476, 736.8106837420422, 353.578931743576, 522.8045760367206, 957.1267349624844, 950.4647200609257, 1026.924910057712, 566.1893819874432, 1042.1812622201276, 1057.1319130915315, 1104.0456606448572, 0.8878464494874463, 1023.2458040623336, 1099.3386545915964, 473.92000644930664, 876.5371344542345, 847.4530065229698, 689.5958236502485, 743.2026946083474, 892.3036145204774, 990.982334943879, 861.7741389869038, 892.537800855224, 400.6746447556051, 552.5353263944982, 913.9444308327382, 882.8751891489209, 704.8919845909573, 650.8011340667994, 965.5471801587804, 855.6538430651397, 1199.2140253490095, 983.6325189303435, 950.4862550903802, 1038.9620174666434, 532.3026122310682, 848.9197340248702, 1158.9020267254466, 858.4022232303714, 927.9781159333131, 665.4321955335155, 956.3408064956715, 401.6602880976567, 1068.3473956723312, 589.4524470599866, 532.1925797173635, 1023.5415611887067, 597.5496608249966, 530.7206945384645]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.042886611680819, "mean_inference_ms": 4.3863549591145246, "mean_action_processing_ms": 1.7402019458031563, "mean_env_wait_ms": 12.134024382335024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047713518142700195, "StateBufferConnector_ms": 0.0042552947998046875, "ViewRequirementAgentConnector_ms": 0.17628693580627441}, "num_episodes": 8, "episode_return_max": 1042.3641601111206, "episode_return_min": -22.438281325711664, "episode_return_mean": 253.4832672880732, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.2940558270671, "num_env_steps_trained_throughput_per_sec": 156.2940558270671, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 25878.33, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25878.112, "sample_time_ms": 2448.988, "learn_time_ms": 23398.487, "learn_throughput": 170.951, "synch_weights_time_ms": 27.045}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 46, "trial_id": "0b608_00000", "date": "2024-08-22_14-05-00", "timestamp": 1724315700, "time_this_iter_s": 25.620160818099976, "time_total_s": 1193.9439988136292, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a34aaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1193.9439988136292, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 31.332432432432437, "ram_util_percent": 83.12432432432429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.206291409901212, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.3390860855264, "policy_loss": -0.007589925499386573, "vf_loss": 8.346051888238817, "vf_explained_var": 0.20010807160977964, "kl": 0.006241061150283607, "entropy": 0.28449757228452693, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 43943.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.076553542777976, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.806934912242586, "policy_loss": -0.008040348044719803, "vf_loss": 7.813584615313817, "vf_explained_var": 0.6692317470671638, "kl": 0.006953166266804729, "entropy": 0.6144111159617308, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 43943.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 840.8881092306289, "episode_reward_min": -22.438281325711664, "episode_reward_mean": 233.40564801002012, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1418.2478352582564, "predator_policy": 0.8878464494874463}, "policy_reward_max": {"prey_policy": 370.9916357041396, "predator_policy": 1418.19814022622}, "policy_reward_mean": {"prey_policy": -670.1536253184083, "predator_policy": 786.8564493234185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.3386193113504117, 408.08388347648565, 70.05759294851774, 0.5408646793972702, 13.571633263954359, 1.6000000000000028, 121.555703879456, 78.86591973553075, 7.000000000000005, 401.20177370912967, -0.04969503203640713, 404.36408980454274, 651.1038593522759, 594.5117959420054, 8.159005703379862, 69.93676167152486, 425.39855541373583, 650.4360322602283, 475.3206197207522, 268.2622330244709, 8.199999999999996, 426.20044860576314, 706.242258681925, 672.7798475547659, 286.9509467272686, 322.5283381396764, 15.461799894698665, 226.52413318953708, 17.788216317850562, 142.60150519805796, 451.6673899841696, 0.11532821215825884, 5.13990634001977, 0.9999999999999858, 226.7431478068426, 481.0117876606119, 212.38774863737365, 667.3184293496411, -0.14748211975054204, 670.4567629673078, 37.27490826063476, 258.68481713304436, 368.65540549770395, 1.5169794954143563, 840.8881092306289, 739.1003531121827, 268.7080399462153, 118.58860689232841, -7.277263343997163, 466.3658434407079, 230.24000494399414, 630.0429066311392, 335.0744287042068, 451.6541632080451, 26.586111770817485, 157.59989469688333, 261.54077062187287, 8.414157457135403, 532.9213107554654, 188.23147248030287, 84.18758393423326, 18.600000000000055, 255.51927399358277, 14.799999999999994, 291.4338018515583, 41.6253340130188, 480.2026086382048, 529.9923857707257, 294.2714521281412, 1.7763568394002505e-15, 497.0198493595572, 7.993605777301127e-15, 282.8732957289397, 21.30000000000001, 2.9020428495225605, -22.438281325711664, 231.0223185413019, 28.99115039436936, 224.99624610121236, 210.4480502781889, 719.2700351681, 0.6999999999999982, -0.32015301559163456, -5.301264965872615, 156.2089424335749, -5.329070518200751e-15, 78.248760163328, 307.47163330889566, 232.64621791598682, 405.5981450612816, 652.3743689571353, 10.64171439658251, 0.10000000000000031, 4.300000000000001, 1.999999999999997, 115.64451292049517, 1.1315392950974799, 289.89999999999884, 540.3617500095523, 235.8007041492604], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1037.4106574043499, -1260.9198383086261, 339.9636348113893, -248.42491412672285, -797.3011150535269, -486.9554638075913, -1362.2080840231106, -1047.0054123167465, -1108.2296849527693, -1015.9606808059766, -1286.4454359103963, -914.8688595634048, -460.6487668159404, -1025.37045677014, -803.9580563988014, -771.3797085318455, -1119.3702113929603, -1074.8022906757135, -1100.8938478494117, 342.71740218383013, -1182.5551691714065, -1418.2478352582564, -1119.8116535986626, 370.9916357041396, -690.4362684484928, -275.66012864829776, -931.8614021553733, -380.0672333861465, -958.5801361930817, -1213.246972815987, -1295.4301204671253, -959.0137807513934, -1246.3945018978166, 202.3357483874421, -48.25572393479138, -1182.9167637643097, 15.49186124432947, -1332.1051251896533, 178.43311824031724, -1096.3787437025892, -907.5111798088365, -985.4939667168456, 82.66219474833062, -1171.7854703288845, 182.10288921868033, 345.0895220505373, -1041.9883403968715, 58.080695000094664, -119.72953206041788, -1009.3084687027579, -1279.3537318998308, 310.6612732626813, -1008.7596789836334, -971.3512796680567, -764.6633833819457, -41.787734081888814, -216.20053549619598, -963.7820741089089, -402.13917172648144, -1025.5051530139783, -257.26572883250486, 88.17989446648177, -847.1840970688465, -1148.9167711904647, -1135.9901498411145, -978.1157374021931, -1289.8847602240567, -1062.8845554713464, -236.621648299429, -554.1460645608016, 229.8935561908446, -689.6251068550648, -891.575384359919, -852.9978879866692, -4.012149995839991, -844.3418564979644, -1142.5390674415698, -1057.2427215036482, 40.13085739395676, -1052.5479033163633, -846.1996603822788, -853.7247363641086, -1077.2063984135666, -642.5621547641083, -621.8453384016956, -81.78195615951876, -766.5860099989147, -1139.2010118496112, -1029.5888872088105, 282.44672983788905, -90.50014615594911, -933.2520613134714, -269.0379094620081, -994.6983597227978, -690.1796257961659, -986.8122714245026, -938.780849021955, -1095.4634330487775, -661.5881305967519, 327.50171838673106, -256.6991552721187, -819.9790998661427, -1068.3864096737407, 235.1420105698992, 271.08972326674257, -1094.4766900607965, -924.6312284629837, 11.17653461815442, -716.405789558946, -860.8690642707562, -794.3865329198633, -83.16851106587299, -613.9849330916687, -1003.5872113225614, -872.3723665008439, -958.8239852742682, -128.64486116664526, -1011.3867735128056, -646.7796585087938, -514.8469263046336, -327.3985963170454, -1067.4968665885842, -948.2693349152537, -942.0874660256354, 24.843651340284758, -764.3906359675259, -983.0115836439948, -858.3490384427502, -891.715913555865, -361.2504575160083, -1135.3188366645966, -620.6172229363619, -38.06035983407125, 139.9293919474889, -738.4780257105889, 178.08079599569766, -150.6843360354399, -1034.9755228356257, -950.4647200609257, -1026.924910057712, 40.03614979508194, -1151.386944643099, -1057.1319130915315, -1104.0456606448572, 281.98544927945227, -1023.2458040623336, -1099.3386545915964, -452.62000644930663, -1020.2429384843405, -700.8451596433407, -765.0095831491806, -690.2272164351268, -905.7258604974357, -746.537770425619, -836.7673578332452, -888.5534316145131, -265.0584022951205, -463.1553227537704, -952.2613712071914, -634.1101984962777, -802.1129768214523, 165.68989333179448, -964.8471801587802, -855.6538430651397, -1199.2140253490095, -983.9526719459352, -1038.9620174666434, -955.7875200562529, -364.2958947439972, -860.7175090783647, -1158.9020267254466, -858.4022232303714, -1054.1780610247836, -460.98349027872047, -96.31910060872644, -954.210360675706, -341.8643244448935, -1083.28930037143, -65.04218815419509, -1085.0938076905932, -694.5223930455571, 218.6264066392309, -896.9088544573955, -841.5692947226568, -1066.4151371548269, -1073.5679088229965, -881.4241897835082, -867.4207872282888, -905.0372415659021, -1058.6496755030205, -430.2556660352729, -768.3659063687718, -775.2095463446071, -914.5154779730971, -12.935670636391812, 78.31791930886055, 314.04491019868686, -760.5196076954619, 110.69985612535989, -473.36271233883394], "policy_predator_policy_reward": [1037.61065740435, 1261.0584576199767, 41.32024866509391, 275.2249141267266, 572.9693435576796, 781.344828251957, 1265.4095610688862, 1144.3447999503696, 1108.2296849527693, 1029.532314069931, 1286.745435910396, 916.1688595634048, 678.2642077122381, 929.3107197532984, 876.4580563988015, 777.7456282673762, 1126.37021139296, 1074.8022906757135, 1100.8938478494117, 58.48437152529966, 1182.5551691714065, 1418.19814022622, 1114.8357940339877, 38.34831366507824, 895.4321607917342, 721.7680956573374, 895.6540636009553, 1010.786367882574, 964.5001257464927, 1215.4859889659558, 1294.1652293807565, 1030.2154335092873, 1243.0844729872217, 226.37283593688903, 756.5832932057328, 1125.0252267535975, 540.3979128912297, 1251.5359707748457, 89.82911478415328, 1096.3787437025892, 915.7111798088363, 985.4939667168456, 1060.453781442409, 454.86994274390844, 112.4491073952645, 66.60074001744267, 705.1344934428389, 951.5529995087029, 571.2207133590094, 844.7682341314363, 1279.371494353099, 11.849302423726872, 1008.7596789836334, 986.8130795627554, 283.28260325829575, 749.6926473950764, 1016.5905780502762, 181.18024787267754, 545.9591834822082, 1024.286646456309, 69.16209473584843, 551.5911296143455, 847.9915267801887, 1148.2246696912807, 1141.1300561811345, 978.1157374021931, 1289.8847602240567, 1063.8845554713464, 667.6898746330551, 349.82098603402136, 294.848010955258, 645.8953273695732, 1146.9749395260355, 809.9860814579281, 430.0716126593929, 1085.6008231840513, 1142.5390674415698, 1057.0952393838977, 864.7209992291492, 818.1528096605601, 847.6303800407093, 889.5689249663134, 1012.2735559350691, 966.1798143756536, 560.0715165197836, 512.2111835391324, 771.4631630679894, 1135.840838275951, 874.8944201071706, 713.1358464943805, 816.1781517595595, 946.6744088220426, 616.3999291676305, 916.0443799633898, 825.8472554185372, 969.7332486944578, 939.780849021955, 1087.1861697047805, 735.5293355570217, 64.92292009370762, 757.1844814949313, 549.7337785873236, 1024.2677832007307, 439.0195225342512, 63.98470543746432, 1094.4766900607965, 886.5113597871887, 478.59749726568407, 766.3697462361091, 837.4912193644103, 635.3980789481117, 399.7568597345072, 1031.0240074596381, 848.0889075764641, 1034.4428996738095, 805.167609558437, 814.6029258686933, 858.3500195662172, 574.1174809743994, 775.7405763193276, 411.5861802512798, 1067.4968665885842, 966.3693349152537, 942.5874660256354, 220.16301235975337, 774.9032462610728, 995.8115836439948, 860.3490384427502, 794.9648150509237, 749.4353578725103, 1145.307524461222, 652.2538691527583, 185.2555114739396, 193.0780650508476, 736.8106837420422, 353.578931743576, 522.8045760367206, 957.1267349624844, 950.4647200609257, 1026.924910057712, 566.1893819874432, 1042.1812622201276, 1057.1319130915315, 1104.0456606448572, 0.8878464494874463, 1023.2458040623336, 1099.3386545915964, 473.92000644930664, 876.5371344542345, 847.4530065229698, 689.5958236502485, 743.2026946083474, 892.3036145204774, 990.982334943879, 861.7741389869038, 892.537800855224, 400.6746447556051, 552.5353263944982, 913.9444308327382, 882.8751891489209, 704.8919845909573, 650.8011340667994, 965.5471801587804, 855.6538430651397, 1199.2140253490095, 983.6325189303435, 950.4862550903802, 1038.9620174666434, 532.3026122310682, 848.9197340248702, 1158.9020267254466, 858.4022232303714, 927.9781159333131, 665.4321955335155, 956.3408064956715, 401.6602880976567, 1068.3473956723312, 589.4524470599866, 532.1925797173635, 1023.5415611887067, 597.5496608249966, 530.7206945384645, 941.773356231544, 807.3465073450913, 1066.515137154827, 1073.5679088229965, 881.4241897835082, 871.7207872282886, 907.0372415659021, 1058.6496755030205, 582.7106544210349, 731.5554309035119, 776.0095463446073, 914.8470172681945, 60.25890896166618, 164.25884236586526, 641.8792995974322, 344.95714790889633, 108.16510532896929, 490.2984550337655]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.039450884757845, "mean_inference_ms": 4.396921167956178, "mean_action_processing_ms": 1.7420886670404503, "mean_env_wait_ms": 12.157846956874941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004832148551940918, "StateBufferConnector_ms": 0.004234194755554199, "ViewRequirementAgentConnector_ms": 0.16478383541107178}, "num_episodes": 9, "episode_return_max": 840.8881092306289, "episode_return_min": -22.438281325711664, "episode_return_mean": 233.40564801002012, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.72260951284557, "num_env_steps_trained_throughput_per_sec": 156.72260951284557, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 25876.859, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25876.667, "sample_time_ms": 2456.517, "learn_time_ms": 23389.577, "learn_throughput": 171.016, "synch_weights_time_ms": 27.086}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 47, "trial_id": "0b608_00000", "date": "2024-08-22_14-05-26", "timestamp": 1724315726, "time_this_iter_s": 25.54780387878418, "time_total_s": 1219.4918026924133, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x312081820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1219.4918026924133, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 31.497222222222224, "ram_util_percent": 82.88611111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.195480020210226, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.1392040666449, "policy_loss": -0.007579963030195031, "vf_loss": 8.146186530400836, "vf_explained_var": 0.1932435367473219, "kl": 0.0059749732688365005, "entropy": 0.2867448340332697, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44888.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.397221075794683, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.553759834249184, "policy_loss": -0.0072412287732635545, "vf_loss": 7.559862171657501, "vf_explained_var": 0.6457300123083528, "kl": 0.00569443639821161, "entropy": 0.5920423452185575, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44888.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 976.9119840619019, "episode_reward_min": -22.50571797559193, "episode_reward_mean": 235.1830375685312, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1332.1051251896533, "predator_policy": 0.8878464494874463}, "policy_reward_max": {"prey_policy": 345.0895220505373, "predator_policy": 1294.1652293807565}, "policy_reward_mean": {"prey_policy": -661.2739544476598, "predator_policy": 778.8654732319255}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.159005703379862, 69.93676167152486, 425.39855541373583, 650.4360322602283, 475.3206197207522, 268.2622330244709, 8.199999999999996, 426.20044860576314, 706.242258681925, 672.7798475547659, 286.9509467272686, 322.5283381396764, 15.461799894698665, 226.52413318953708, 17.788216317850562, 142.60150519805796, 451.6673899841696, 0.11532821215825884, 5.13990634001977, 0.9999999999999858, 226.7431478068426, 481.0117876606119, 212.38774863737365, 667.3184293496411, -0.14748211975054204, 670.4567629673078, 37.27490826063476, 258.68481713304436, 368.65540549770395, 1.5169794954143563, 840.8881092306289, 739.1003531121827, 268.7080399462153, 118.58860689232841, -7.277263343997163, 466.3658434407079, 230.24000494399414, 630.0429066311392, 335.0744287042068, 451.6541632080451, 26.586111770817485, 157.59989469688333, 261.54077062187287, 8.414157457135403, 532.9213107554654, 188.23147248030287, 84.18758393423326, 18.600000000000055, 255.51927399358277, 14.799999999999994, 291.4338018515583, 41.6253340130188, 480.2026086382048, 529.9923857707257, 294.2714521281412, 1.7763568394002505e-15, 497.0198493595572, 7.993605777301127e-15, 282.8732957289397, 21.30000000000001, 2.9020428495225605, -22.438281325711664, 231.0223185413019, 28.99115039436936, 224.99624610121236, 210.4480502781889, 719.2700351681, 0.6999999999999982, -0.32015301559163456, -5.301264965872615, 156.2089424335749, -5.329070518200751e-15, 78.248760163328, 307.47163330889566, 232.64621791598682, 405.5981450612816, 652.3743689571353, 10.64171439658251, 0.10000000000000031, 4.300000000000001, 1.999999999999997, 115.64451292049517, 1.1315392950974799, 289.89999999999884, 540.3617500095523, 235.8007041492604, 83.5592273895888, -0.12371328526905989, 976.9119840619019, -22.50571797559193, 4.440892098500626e-16, 301.8791868147667, 12.399999999999999, 552.2469238571779, 311.414690864496, 576.1998236161738, 25.49522593173306, 37.450062957345104, 19.857302689392924, 55.700000000000045], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-958.5801361930817, -1213.246972815987, -1295.4301204671253, -959.0137807513934, -1246.3945018978166, 202.3357483874421, -48.25572393479138, -1182.9167637643097, 15.49186124432947, -1332.1051251896533, 178.43311824031724, -1096.3787437025892, -907.5111798088365, -985.4939667168456, 82.66219474833062, -1171.7854703288845, 182.10288921868033, 345.0895220505373, -1041.9883403968715, 58.080695000094664, -119.72953206041788, -1009.3084687027579, -1279.3537318998308, 310.6612732626813, -1008.7596789836334, -971.3512796680567, -764.6633833819457, -41.787734081888814, -216.20053549619598, -963.7820741089089, -402.13917172648144, -1025.5051530139783, -257.26572883250486, 88.17989446648177, -847.1840970688465, -1148.9167711904647, -1135.9901498411145, -978.1157374021931, -1289.8847602240567, -1062.8845554713464, -236.621648299429, -554.1460645608016, 229.8935561908446, -689.6251068550648, -891.575384359919, -852.9978879866692, -4.012149995839991, -844.3418564979644, -1142.5390674415698, -1057.2427215036482, 40.13085739395676, -1052.5479033163633, -846.1996603822788, -853.7247363641086, -1077.2063984135666, -642.5621547641083, -621.8453384016956, -81.78195615951876, -766.5860099989147, -1139.2010118496112, -1029.5888872088105, 282.44672983788905, -90.50014615594911, -933.2520613134714, -269.0379094620081, -994.6983597227978, -690.1796257961659, -986.8122714245026, -938.780849021955, -1095.4634330487775, -661.5881305967519, 327.50171838673106, -256.6991552721187, -819.9790998661427, -1068.3864096737407, 235.1420105698992, 271.08972326674257, -1094.4766900607965, -924.6312284629837, 11.17653461815442, -716.405789558946, -860.8690642707562, -794.3865329198633, -83.16851106587299, -613.9849330916687, -1003.5872113225614, -872.3723665008439, -958.8239852742682, -128.64486116664526, -1011.3867735128056, -646.7796585087938, -514.8469263046336, -327.3985963170454, -1067.4968665885842, -948.2693349152537, -942.0874660256354, 24.843651340284758, -764.3906359675259, -983.0115836439948, -858.3490384427502, -891.715913555865, -361.2504575160083, -1135.3188366645966, -620.6172229363619, -38.06035983407125, 139.9293919474889, -738.4780257105889, 178.08079599569766, -150.6843360354399, -1034.9755228356257, -950.4647200609257, -1026.924910057712, 40.03614979508194, -1151.386944643099, -1057.1319130915315, -1104.0456606448572, 281.98544927945227, -1023.2458040623336, -1099.3386545915964, -452.62000644930663, -1020.2429384843405, -700.8451596433407, -765.0095831491806, -690.2272164351268, -905.7258604974357, -746.537770425619, -836.7673578332452, -888.5534316145131, -265.0584022951205, -463.1553227537704, -952.2613712071914, -634.1101984962777, -802.1129768214523, 165.68989333179448, -964.8471801587802, -855.6538430651397, -1199.2140253490095, -983.9526719459352, -1038.9620174666434, -955.7875200562529, -364.2958947439972, -860.7175090783647, -1158.9020267254466, -858.4022232303714, -1054.1780610247836, -460.98349027872047, -96.31910060872644, -954.210360675706, -341.8643244448935, -1083.28930037143, -65.04218815419509, -1085.0938076905932, -694.5223930455571, 218.6264066392309, -896.9088544573955, -841.5692947226568, -1066.4151371548269, -1073.5679088229965, -881.4241897835082, -867.4207872282888, -905.0372415659021, -1058.6496755030205, -430.2556660352729, -768.3659063687718, -775.2095463446071, -914.5154779730971, -12.935670636391812, 78.31791930886055, 314.04491019868686, -760.5196076954619, 110.69985612535989, -473.36271233883394, -992.047510293264, -427.2527191384847, -788.8789409759238, -812.8042686647052, 326.84320830388515, -973.0452549661647, -1082.103322703885, -1095.8391476122542, -828.4327015869654, -975.2242437942261, -254.8048964584474, -464.00345546654825, -1038.816717299487, -974.1419203022563, -453.60152740389697, -539.2364813116042, -894.4322534840139, -277.8995759480701, -867.7602927287161, -275.5634674960537, -801.156989633418, -701.409512063225, -639.8365974219873, -1021.2904479478209, -701.9471031014613, -860.6523308507406, -939.8089554189786, -736.0389027568975], "policy_predator_policy_reward": [964.5001257464927, 1215.4859889659558, 1294.1652293807565, 1030.2154335092873, 1243.0844729872217, 226.37283593688903, 756.5832932057328, 1125.0252267535975, 540.3979128912297, 1251.5359707748457, 89.82911478415328, 1096.3787437025892, 915.7111798088363, 985.4939667168456, 1060.453781442409, 454.86994274390844, 112.4491073952645, 66.60074001744267, 705.1344934428389, 951.5529995087029, 571.2207133590094, 844.7682341314363, 1279.371494353099, 11.849302423726872, 1008.7596789836334, 986.8130795627554, 283.28260325829575, 749.6926473950764, 1016.5905780502762, 181.18024787267754, 545.9591834822082, 1024.286646456309, 69.16209473584843, 551.5911296143455, 847.9915267801887, 1148.2246696912807, 1141.1300561811345, 978.1157374021931, 1289.8847602240567, 1063.8845554713464, 667.6898746330551, 349.82098603402136, 294.848010955258, 645.8953273695732, 1146.9749395260355, 809.9860814579281, 430.0716126593929, 1085.6008231840513, 1142.5390674415698, 1057.0952393838977, 864.7209992291492, 818.1528096605601, 847.6303800407093, 889.5689249663134, 1012.2735559350691, 966.1798143756536, 560.0715165197836, 512.2111835391324, 771.4631630679894, 1135.840838275951, 874.8944201071706, 713.1358464943805, 816.1781517595595, 946.6744088220426, 616.3999291676305, 916.0443799633898, 825.8472554185372, 969.7332486944578, 939.780849021955, 1087.1861697047805, 735.5293355570217, 64.92292009370762, 757.1844814949313, 549.7337785873236, 1024.2677832007307, 439.0195225342512, 63.98470543746432, 1094.4766900607965, 886.5113597871887, 478.59749726568407, 766.3697462361091, 837.4912193644103, 635.3980789481117, 399.7568597345072, 1031.0240074596381, 848.0889075764641, 1034.4428996738095, 805.167609558437, 814.6029258686933, 858.3500195662172, 574.1174809743994, 775.7405763193276, 411.5861802512798, 1067.4968665885842, 966.3693349152537, 942.5874660256354, 220.16301235975337, 774.9032462610728, 995.8115836439948, 860.3490384427502, 794.9648150509237, 749.4353578725103, 1145.307524461222, 652.2538691527583, 185.2555114739396, 193.0780650508476, 736.8106837420422, 353.578931743576, 522.8045760367206, 957.1267349624844, 950.4647200609257, 1026.924910057712, 566.1893819874432, 1042.1812622201276, 1057.1319130915315, 1104.0456606448572, 0.8878464494874463, 1023.2458040623336, 1099.3386545915964, 473.92000644930664, 876.5371344542345, 847.4530065229698, 689.5958236502485, 743.2026946083474, 892.3036145204774, 990.982334943879, 861.7741389869038, 892.537800855224, 400.6746447556051, 552.5353263944982, 913.9444308327382, 882.8751891489209, 704.8919845909573, 650.8011340667994, 965.5471801587804, 855.6538430651397, 1199.2140253490095, 983.6325189303435, 950.4862550903802, 1038.9620174666434, 532.3026122310682, 848.9197340248702, 1158.9020267254466, 858.4022232303714, 927.9781159333131, 665.4321955335155, 956.3408064956715, 401.6602880976567, 1068.3473956723312, 589.4524470599866, 532.1925797173635, 1023.5415611887067, 597.5496608249966, 530.7206945384645, 941.773356231544, 807.3465073450913, 1066.515137154827, 1073.5679088229965, 881.4241897835082, 871.7207872282886, 907.0372415659021, 1058.6496755030205, 582.7106544210349, 731.5554309035119, 776.0095463446073, 914.8470172681945, 60.25890896166618, 164.25884236586526, 641.8792995974322, 344.95714790889633, 108.16510532896929, 490.2984550337655, 644.9094925650478, 857.9499642562923, 788.5552276906548, 813.0042686647053, 740.5823353922415, 882.5316953319407, 1179.4160561829622, 976.020696157585, 828.4327015869654, 975.2242437942261, 378.9457075157058, 641.741831224055, 1050.9167172994871, 974.4419203022562, 814.10396844481, 730.9809641278695, 590.5242589336588, 893.2222613629211, 736.8660525163231, 982.6575313246245, 750.2384972042242, 777.8232304241526, 676.9866603793337, 1021.590447947821, 714.3721913325901, 868.084545309005, 940.5089554189785, 791.0389027568978]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.028622180472929, "mean_inference_ms": 4.403454165869732, "mean_action_processing_ms": 1.7491394434891179, "mean_env_wait_ms": 12.179426179162785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01798832416534424, "StateBufferConnector_ms": 0.004385471343994141, "ViewRequirementAgentConnector_ms": 0.17578256130218506}, "num_episodes": 14, "episode_return_max": 976.9119840619019, "episode_return_min": -22.50571797559193, "episode_return_mean": 235.1830375685312, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.42331738105568, "num_env_steps_trained_throughput_per_sec": 155.42331738105568, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 25883.25, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25883.056, "sample_time_ms": 2459.421, "learn_time_ms": 23396.75, "learn_throughput": 170.964, "synch_weights_time_ms": 23.573}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 48, "trial_id": "0b608_00000", "date": "2024-08-22_14-05-52", "timestamp": 1724315752, "time_this_iter_s": 25.775309085845947, "time_total_s": 1245.2671117782593, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30e3d8940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1245.2671117782593, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 30.96111111111111, "ram_util_percent": 82.14999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.873054864166907, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.131329142353522, "policy_loss": -0.006618481923003124, "vf_loss": 8.137324512320221, "vf_explained_var": 0.18539021305306247, "kl": 0.006231511873439467, "entropy": 0.29503701742363986, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 45833.0, "diff_num_grad_updates_vs_sampler_policy": 493.2624999999971}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.716991149306928, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.612971590435694, "policy_loss": -0.009790242075052842, "vf_loss": 7.62128564289638, "vf_explained_var": 0.6643557617904017, "kl": 0.00738088496216627, "entropy": 0.5962339470310817, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 45833.0, "diff_num_grad_updates_vs_sampler_policy": 493.2624999999971}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 976.9119840619019, "episode_reward_min": -22.50571797559193, "episode_reward_mean": 231.17924827503356, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1289.8847602240567, "predator_policy": 0.8878464494874463}, "policy_reward_max": {"prey_policy": 327.50171838673106, "predator_policy": 1289.8847602240567}, "policy_reward_mean": {"prey_policy": -642.9110027648715, "predator_policy": 758.5006269023885}, "custom_metrics": {}, "hist_stats": {"episode_reward": [226.52413318953708, 17.788216317850562, 142.60150519805796, 451.6673899841696, 0.11532821215825884, 5.13990634001977, 0.9999999999999858, 226.7431478068426, 481.0117876606119, 212.38774863737365, 667.3184293496411, -0.14748211975054204, 670.4567629673078, 37.27490826063476, 258.68481713304436, 368.65540549770395, 1.5169794954143563, 840.8881092306289, 739.1003531121827, 268.7080399462153, 118.58860689232841, -7.277263343997163, 466.3658434407079, 230.24000494399414, 630.0429066311392, 335.0744287042068, 451.6541632080451, 26.586111770817485, 157.59989469688333, 261.54077062187287, 8.414157457135403, 532.9213107554654, 188.23147248030287, 84.18758393423326, 18.600000000000055, 255.51927399358277, 14.799999999999994, 291.4338018515583, 41.6253340130188, 480.2026086382048, 529.9923857707257, 294.2714521281412, 1.7763568394002505e-15, 497.0198493595572, 7.993605777301127e-15, 282.8732957289397, 21.30000000000001, 2.9020428495225605, -22.438281325711664, 231.0223185413019, 28.99115039436936, 224.99624610121236, 210.4480502781889, 719.2700351681, 0.6999999999999982, -0.32015301559163456, -5.301264965872615, 156.2089424335749, -5.329070518200751e-15, 78.248760163328, 307.47163330889566, 232.64621791598682, 405.5981450612816, 652.3743689571353, 10.64171439658251, 0.10000000000000031, 4.300000000000001, 1.999999999999997, 115.64451292049517, 1.1315392950974799, 289.89999999999884, 540.3617500095523, 235.8007041492604, 83.5592273895888, -0.12371328526905989, 976.9119840619019, -22.50571797559193, 4.440892098500626e-16, 301.8791868147667, 12.399999999999999, 552.2469238571779, 311.414690864496, 576.1998236161738, 25.49522593173306, 37.450062957345104, 19.857302689392924, 55.700000000000045, 227.3382096601433, 22.560030076277073, 43.517404530650694, 435.26547281821587, 49.765415700120755, 392.15349699773077, 450.2574535900942, 497.9558343088777, 562.7702266311575, 165.104452261607, 668.9891027238638, 398.90544983731115, 20.915368912377623], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-764.6633833819457, -41.787734081888814, -216.20053549619598, -963.7820741089089, -402.13917172648144, -1025.5051530139783, -257.26572883250486, 88.17989446648177, -847.1840970688465, -1148.9167711904647, -1135.9901498411145, -978.1157374021931, -1289.8847602240567, -1062.8845554713464, -236.621648299429, -554.1460645608016, 229.8935561908446, -689.6251068550648, -891.575384359919, -852.9978879866692, -4.012149995839991, -844.3418564979644, -1142.5390674415698, -1057.2427215036482, 40.13085739395676, -1052.5479033163633, -846.1996603822788, -853.7247363641086, -1077.2063984135666, -642.5621547641083, -621.8453384016956, -81.78195615951876, -766.5860099989147, -1139.2010118496112, -1029.5888872088105, 282.44672983788905, -90.50014615594911, -933.2520613134714, -269.0379094620081, -994.6983597227978, -690.1796257961659, -986.8122714245026, -938.780849021955, -1095.4634330487775, -661.5881305967519, 327.50171838673106, -256.6991552721187, -819.9790998661427, -1068.3864096737407, 235.1420105698992, 271.08972326674257, -1094.4766900607965, -924.6312284629837, 11.17653461815442, -716.405789558946, -860.8690642707562, -794.3865329198633, -83.16851106587299, -613.9849330916687, -1003.5872113225614, -872.3723665008439, -958.8239852742682, -128.64486116664526, -1011.3867735128056, -646.7796585087938, -514.8469263046336, -327.3985963170454, -1067.4968665885842, -948.2693349152537, -942.0874660256354, 24.843651340284758, -764.3906359675259, -983.0115836439948, -858.3490384427502, -891.715913555865, -361.2504575160083, -1135.3188366645966, -620.6172229363619, -38.06035983407125, 139.9293919474889, -738.4780257105889, 178.08079599569766, -150.6843360354399, -1034.9755228356257, -950.4647200609257, -1026.924910057712, 40.03614979508194, -1151.386944643099, -1057.1319130915315, -1104.0456606448572, 281.98544927945227, -1023.2458040623336, -1099.3386545915964, -452.62000644930663, -1020.2429384843405, -700.8451596433407, -765.0095831491806, -690.2272164351268, -905.7258604974357, -746.537770425619, -836.7673578332452, -888.5534316145131, -265.0584022951205, -463.1553227537704, -952.2613712071914, -634.1101984962777, -802.1129768214523, 165.68989333179448, -964.8471801587802, -855.6538430651397, -1199.2140253490095, -983.9526719459352, -1038.9620174666434, -955.7875200562529, -364.2958947439972, -860.7175090783647, -1158.9020267254466, -858.4022232303714, -1054.1780610247836, -460.98349027872047, -96.31910060872644, -954.210360675706, -341.8643244448935, -1083.28930037143, -65.04218815419509, -1085.0938076905932, -694.5223930455571, 218.6264066392309, -896.9088544573955, -841.5692947226568, -1066.4151371548269, -1073.5679088229965, -881.4241897835082, -867.4207872282888, -905.0372415659021, -1058.6496755030205, -430.2556660352729, -768.3659063687718, -775.2095463446071, -914.5154779730971, -12.935670636391812, 78.31791930886055, 314.04491019868686, -760.5196076954619, 110.69985612535989, -473.36271233883394, -992.047510293264, -427.2527191384847, -788.8789409759238, -812.8042686647052, 326.84320830388515, -973.0452549661647, -1082.103322703885, -1095.8391476122542, -828.4327015869654, -975.2242437942261, -254.8048964584474, -464.00345546654825, -1038.816717299487, -974.1419203022563, -453.60152740389697, -539.2364813116042, -894.4322534840139, -277.8995759480701, -867.7602927287161, -275.5634674960537, -801.156989633418, -701.409512063225, -639.8365974219873, -1021.2904479478209, -701.9471031014613, -860.6523308507406, -939.8089554189786, -736.0389027568975, -361.9361796317842, -951.7167190717195, -620.3462682608337, -1007.6519633392903, -648.4795049109764, -767.2319733158648, -866.6257659205735, 59.69262920231512, -836.0687532370777, -307.08925535069943, -823.2309868062986, -93.06404936263088, -808.6185116205252, -158.19622129858942, 167.57296420238862, -650.02115230949, -391.03852132837665, 147.58595385896905, -662.9801642931858, -51.91545295986659, -76.96538150290277, -1112.5787070845126, -878.5246788679054, -176.17194910686, -859.1622749567109, -45.39299129979647], "policy_predator_policy_reward": [283.28260325829575, 749.6926473950764, 1016.5905780502762, 181.18024787267754, 545.9591834822082, 1024.286646456309, 69.16209473584843, 551.5911296143455, 847.9915267801887, 1148.2246696912807, 1141.1300561811345, 978.1157374021931, 1289.8847602240567, 1063.8845554713464, 667.6898746330551, 349.82098603402136, 294.848010955258, 645.8953273695732, 1146.9749395260355, 809.9860814579281, 430.0716126593929, 1085.6008231840513, 1142.5390674415698, 1057.0952393838977, 864.7209992291492, 818.1528096605601, 847.6303800407093, 889.5689249663134, 1012.2735559350691, 966.1798143756536, 560.0715165197836, 512.2111835391324, 771.4631630679894, 1135.840838275951, 874.8944201071706, 713.1358464943805, 816.1781517595595, 946.6744088220426, 616.3999291676305, 916.0443799633898, 825.8472554185372, 969.7332486944578, 939.780849021955, 1087.1861697047805, 735.5293355570217, 64.92292009370762, 757.1844814949313, 549.7337785873236, 1024.2677832007307, 439.0195225342512, 63.98470543746432, 1094.4766900607965, 886.5113597871887, 478.59749726568407, 766.3697462361091, 837.4912193644103, 635.3980789481117, 399.7568597345072, 1031.0240074596381, 848.0889075764641, 1034.4428996738095, 805.167609558437, 814.6029258686933, 858.3500195662172, 574.1174809743994, 775.7405763193276, 411.5861802512798, 1067.4968665885842, 966.3693349152537, 942.5874660256354, 220.16301235975337, 774.9032462610728, 995.8115836439948, 860.3490384427502, 794.9648150509237, 749.4353578725103, 1145.307524461222, 652.2538691527583, 185.2555114739396, 193.0780650508476, 736.8106837420422, 353.578931743576, 522.8045760367206, 957.1267349624844, 950.4647200609257, 1026.924910057712, 566.1893819874432, 1042.1812622201276, 1057.1319130915315, 1104.0456606448572, 0.8878464494874463, 1023.2458040623336, 1099.3386545915964, 473.92000644930664, 876.5371344542345, 847.4530065229698, 689.5958236502485, 743.2026946083474, 892.3036145204774, 990.982334943879, 861.7741389869038, 892.537800855224, 400.6746447556051, 552.5353263944982, 913.9444308327382, 882.8751891489209, 704.8919845909573, 650.8011340667994, 965.5471801587804, 855.6538430651397, 1199.2140253490095, 983.6325189303435, 950.4862550903802, 1038.9620174666434, 532.3026122310682, 848.9197340248702, 1158.9020267254466, 858.4022232303714, 927.9781159333131, 665.4321955335155, 956.3408064956715, 401.6602880976567, 1068.3473956723312, 589.4524470599866, 532.1925797173635, 1023.5415611887067, 597.5496608249966, 530.7206945384645, 941.773356231544, 807.3465073450913, 1066.515137154827, 1073.5679088229965, 881.4241897835082, 871.7207872282886, 907.0372415659021, 1058.6496755030205, 582.7106544210349, 731.5554309035119, 776.0095463446073, 914.8470172681945, 60.25890896166618, 164.25884236586526, 641.8792995974322, 344.95714790889633, 108.16510532896929, 490.2984550337655, 644.9094925650478, 857.9499642562923, 788.5552276906548, 813.0042686647053, 740.5823353922415, 882.5316953319407, 1179.4160561829622, 976.020696157585, 828.4327015869654, 975.2242437942261, 378.9457075157058, 641.741831224055, 1050.9167172994871, 974.4419203022562, 814.10396844481, 730.9809641278695, 590.5242589336588, 893.2222613629211, 736.8660525163231, 982.6575313246245, 750.2384972042242, 777.8232304241526, 676.9866603793337, 1021.590447947821, 714.3721913325901, 868.084545309005, 940.5089554189785, 791.0389027568978, 671.7890079966465, 869.2021003670015, 638.5424608431032, 1012.0158008332995, 660.7880004970943, 798.4408822603982, 747.3526215596225, 494.84598797684913, 462.9840049179132, 729.9394193699893, 767.716812621944, 540.7317205447117, 690.4582670710903, 726.6139194381192, 491.7250515062092, 488.6789709097723, 349.3567640465415, 456.8660300540238, 669.4428081625107, 210.55726135215008, 919.3748152951185, 939.1583760161639, 747.3189966633228, 706.28308114875, 596.1456305286578, 329.3250046402256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.028375646619465, "mean_inference_ms": 4.4027016426683305, "mean_action_processing_ms": 1.7339727187770437, "mean_env_wait_ms": 12.201586681082702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018252849578857422, "StateBufferConnector_ms": 0.004454493522644043, "ViewRequirementAgentConnector_ms": 0.13755357265472412}, "num_episodes": 13, "episode_return_max": 976.9119840619019, "episode_return_min": -22.50571797559193, "episode_return_mean": 231.17924827503356, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 152.7288021556068, "num_env_steps_trained_throughput_per_sec": 152.7288021556068, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 25806.221, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25806.04, "sample_time_ms": 2383.645, "learn_time_ms": 23395.919, "learn_throughput": 170.97, "synch_weights_time_ms": 23.297}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 49, "trial_id": "0b608_00000", "date": "2024-08-22_14-06-18", "timestamp": 1724315778, "time_this_iter_s": 26.253297805786133, "time_total_s": 1271.5204095840454, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a3b80d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1271.5204095840454, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 34.67837837837839, "ram_util_percent": 83.08648648648649}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.421345104237712, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.246024470354515, "policy_loss": -0.006187624694217765, "vf_loss": 8.251500546490705, "vf_explained_var": 0.18025507945863029, "kl": 0.007115506346549385, "entropy": 0.2971314213578663, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46778.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.855259521928414, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.68468214721276, "policy_loss": -0.00680375670836795, "vf_loss": 7.689971088227772, "vf_explained_var": 0.6846442435784315, "kl": 0.007574177746015488, "entropy": 0.6160888982828332, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46778.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 976.9119840619019, "episode_reward_min": -22.50571797559193, "episode_reward_mean": 232.99037421899698, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1199.2140253490095, "predator_policy": 0.8878464494874463}, "policy_reward_max": {"prey_policy": 327.50171838673106, "predator_policy": 1199.2140253490095}, "policy_reward_mean": {"prey_policy": -644.0230809109464, "predator_policy": 760.5182680204449}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.14748211975054204, 670.4567629673078, 37.27490826063476, 258.68481713304436, 368.65540549770395, 1.5169794954143563, 840.8881092306289, 739.1003531121827, 268.7080399462153, 118.58860689232841, -7.277263343997163, 466.3658434407079, 230.24000494399414, 630.0429066311392, 335.0744287042068, 451.6541632080451, 26.586111770817485, 157.59989469688333, 261.54077062187287, 8.414157457135403, 532.9213107554654, 188.23147248030287, 84.18758393423326, 18.600000000000055, 255.51927399358277, 14.799999999999994, 291.4338018515583, 41.6253340130188, 480.2026086382048, 529.9923857707257, 294.2714521281412, 1.7763568394002505e-15, 497.0198493595572, 7.993605777301127e-15, 282.8732957289397, 21.30000000000001, 2.9020428495225605, -22.438281325711664, 231.0223185413019, 28.99115039436936, 224.99624610121236, 210.4480502781889, 719.2700351681, 0.6999999999999982, -0.32015301559163456, -5.301264965872615, 156.2089424335749, -5.329070518200751e-15, 78.248760163328, 307.47163330889566, 232.64621791598682, 405.5981450612816, 652.3743689571353, 10.64171439658251, 0.10000000000000031, 4.300000000000001, 1.999999999999997, 115.64451292049517, 1.1315392950974799, 289.89999999999884, 540.3617500095523, 235.8007041492604, 83.5592273895888, -0.12371328526905989, 976.9119840619019, -22.50571797559193, 4.440892098500626e-16, 301.8791868147667, 12.399999999999999, 552.2469238571779, 311.414690864496, 576.1998236161738, 25.49522593173306, 37.450062957345104, 19.857302689392924, 55.700000000000045, 227.3382096601433, 22.560030076277073, 43.517404530650694, 435.26547281821587, 49.765415700120755, 392.15349699773077, 450.2574535900942, 497.9558343088777, 562.7702266311575, 165.104452261607, 668.9891027238638, 398.90544983731115, 20.915368912377623, 228.7035443990689, 957.3294937160558, 428.83810208782427, 98.49999999999997, 22.684625928145223, 3.2053558635682258, 817.7020485599398, -4.203578645604483, 28.061496055565826, -4.9815561015035765, 37.57065522954305], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1142.5390674415698, -1057.2427215036482, 40.13085739395676, -1052.5479033163633, -846.1996603822788, -853.7247363641086, -1077.2063984135666, -642.5621547641083, -621.8453384016956, -81.78195615951876, -766.5860099989147, -1139.2010118496112, -1029.5888872088105, 282.44672983788905, -90.50014615594911, -933.2520613134714, -269.0379094620081, -994.6983597227978, -690.1796257961659, -986.8122714245026, -938.780849021955, -1095.4634330487775, -661.5881305967519, 327.50171838673106, -256.6991552721187, -819.9790998661427, -1068.3864096737407, 235.1420105698992, 271.08972326674257, -1094.4766900607965, -924.6312284629837, 11.17653461815442, -716.405789558946, -860.8690642707562, -794.3865329198633, -83.16851106587299, -613.9849330916687, -1003.5872113225614, -872.3723665008439, -958.8239852742682, -128.64486116664526, -1011.3867735128056, -646.7796585087938, -514.8469263046336, -327.3985963170454, -1067.4968665885842, -948.2693349152537, -942.0874660256354, 24.843651340284758, -764.3906359675259, -983.0115836439948, -858.3490384427502, -891.715913555865, -361.2504575160083, -1135.3188366645966, -620.6172229363619, -38.06035983407125, 139.9293919474889, -738.4780257105889, 178.08079599569766, -150.6843360354399, -1034.9755228356257, -950.4647200609257, -1026.924910057712, 40.03614979508194, -1151.386944643099, -1057.1319130915315, -1104.0456606448572, 281.98544927945227, -1023.2458040623336, -1099.3386545915964, -452.62000644930663, -1020.2429384843405, -700.8451596433407, -765.0095831491806, -690.2272164351268, -905.7258604974357, -746.537770425619, -836.7673578332452, -888.5534316145131, -265.0584022951205, -463.1553227537704, -952.2613712071914, -634.1101984962777, -802.1129768214523, 165.68989333179448, -964.8471801587802, -855.6538430651397, -1199.2140253490095, -983.9526719459352, -1038.9620174666434, -955.7875200562529, -364.2958947439972, -860.7175090783647, -1158.9020267254466, -858.4022232303714, -1054.1780610247836, -460.98349027872047, -96.31910060872644, -954.210360675706, -341.8643244448935, -1083.28930037143, -65.04218815419509, -1085.0938076905932, -694.5223930455571, 218.6264066392309, -896.9088544573955, -841.5692947226568, -1066.4151371548269, -1073.5679088229965, -881.4241897835082, -867.4207872282888, -905.0372415659021, -1058.6496755030205, -430.2556660352729, -768.3659063687718, -775.2095463446071, -914.5154779730971, -12.935670636391812, 78.31791930886055, 314.04491019868686, -760.5196076954619, 110.69985612535989, -473.36271233883394, -992.047510293264, -427.2527191384847, -788.8789409759238, -812.8042686647052, 326.84320830388515, -973.0452549661647, -1082.103322703885, -1095.8391476122542, -828.4327015869654, -975.2242437942261, -254.8048964584474, -464.00345546654825, -1038.816717299487, -974.1419203022563, -453.60152740389697, -539.2364813116042, -894.4322534840139, -277.8995759480701, -867.7602927287161, -275.5634674960537, -801.156989633418, -701.409512063225, -639.8365974219873, -1021.2904479478209, -701.9471031014613, -860.6523308507406, -939.8089554189786, -736.0389027568975, -361.9361796317842, -951.7167190717195, -620.3462682608337, -1007.6519633392903, -648.4795049109764, -767.2319733158648, -866.6257659205735, 59.69262920231512, -836.0687532370777, -307.08925535069943, -823.2309868062986, -93.06404936263088, -808.6185116205252, -158.19622129858942, 167.57296420238862, -650.02115230949, -391.03852132837665, 147.58595385896905, -662.9801642931858, -51.91545295986659, -76.96538150290277, -1112.5787070845126, -878.5246788679054, -176.17194910686, -859.1622749567109, -45.39299129979647, -717.9408725371821, -49.79284876094222, 197.40968656973197, -1084.615970081035, 53.84441976133593, -897.7885270426684, -838.775524134128, -671.7883217475354, -904.1296595556089, -88.26959842800939, -978.3324002912345, -669.8899338212037, 105.66344330870278, -1028.8596628998423, -749.818646886714, -1085.8146880138056, -705.4724775354946, -745.1855412779336, -881.9485015746708, -822.0999660937538, -703.7506806685905, -844.6258572426902], "policy_predator_policy_reward": [1142.5390674415698, 1057.0952393838977, 864.7209992291492, 818.1528096605601, 847.6303800407093, 889.5689249663134, 1012.2735559350691, 966.1798143756536, 560.0715165197836, 512.2111835391324, 771.4631630679894, 1135.840838275951, 874.8944201071706, 713.1358464943805, 816.1781517595595, 946.6744088220426, 616.3999291676305, 916.0443799633898, 825.8472554185372, 969.7332486944578, 939.780849021955, 1087.1861697047805, 735.5293355570217, 64.92292009370762, 757.1844814949313, 549.7337785873236, 1024.2677832007307, 439.0195225342512, 63.98470543746432, 1094.4766900607965, 886.5113597871887, 478.59749726568407, 766.3697462361091, 837.4912193644103, 635.3980789481117, 399.7568597345072, 1031.0240074596381, 848.0889075764641, 1034.4428996738095, 805.167609558437, 814.6029258686933, 858.3500195662172, 574.1174809743994, 775.7405763193276, 411.5861802512798, 1067.4968665885842, 966.3693349152537, 942.5874660256354, 220.16301235975337, 774.9032462610728, 995.8115836439948, 860.3490384427502, 794.9648150509237, 749.4353578725103, 1145.307524461222, 652.2538691527583, 185.2555114739396, 193.0780650508476, 736.8106837420422, 353.578931743576, 522.8045760367206, 957.1267349624844, 950.4647200609257, 1026.924910057712, 566.1893819874432, 1042.1812622201276, 1057.1319130915315, 1104.0456606448572, 0.8878464494874463, 1023.2458040623336, 1099.3386545915964, 473.92000644930664, 876.5371344542345, 847.4530065229698, 689.5958236502485, 743.2026946083474, 892.3036145204774, 990.982334943879, 861.7741389869038, 892.537800855224, 400.6746447556051, 552.5353263944982, 913.9444308327382, 882.8751891489209, 704.8919845909573, 650.8011340667994, 965.5471801587804, 855.6538430651397, 1199.2140253490095, 983.6325189303435, 950.4862550903802, 1038.9620174666434, 532.3026122310682, 848.9197340248702, 1158.9020267254466, 858.4022232303714, 927.9781159333131, 665.4321955335155, 956.3408064956715, 401.6602880976567, 1068.3473956723312, 589.4524470599866, 532.1925797173635, 1023.5415611887067, 597.5496608249966, 530.7206945384645, 941.773356231544, 807.3465073450913, 1066.515137154827, 1073.5679088229965, 881.4241897835082, 871.7207872282886, 907.0372415659021, 1058.6496755030205, 582.7106544210349, 731.5554309035119, 776.0095463446073, 914.8470172681945, 60.25890896166618, 164.25884236586526, 641.8792995974322, 344.95714790889633, 108.16510532896929, 490.2984550337655, 644.9094925650478, 857.9499642562923, 788.5552276906548, 813.0042686647053, 740.5823353922415, 882.5316953319407, 1179.4160561829622, 976.020696157585, 828.4327015869654, 975.2242437942261, 378.9457075157058, 641.741831224055, 1050.9167172994871, 974.4419203022562, 814.10396844481, 730.9809641278695, 590.5242589336588, 893.2222613629211, 736.8660525163231, 982.6575313246245, 750.2384972042242, 777.8232304241526, 676.9866603793337, 1021.590447947821, 714.3721913325901, 868.084545309005, 940.5089554189785, 791.0389027568978, 671.7890079966465, 869.2021003670015, 638.5424608431032, 1012.0158008332995, 660.7880004970943, 798.4408822603982, 747.3526215596225, 494.84598797684913, 462.9840049179132, 729.9394193699893, 767.716812621944, 540.7317205447117, 690.4582670710903, 726.6139194381192, 491.7250515062092, 488.6789709097723, 349.3567640465415, 456.8660300540238, 669.4428081625107, 210.55726135215008, 919.3748152951185, 939.1583760161639, 747.3189966633228, 706.28308114875, 596.1456305286578, 329.3250046402256, 943.7763122972342, 52.66095339996108, 963.0452818869503, 881.4904953404096, 380.7081744943708, 892.074034874786, 838.875524134128, 770.1883217475355, 834.9249256136862, 180.15895829807582, 978.3324002912345, 673.0952896847726, 899.9236564009232, 840.9746117501509, 738.0053672952956, 1093.4243889596194, 735.5703178389668, 743.1491970300302, 871.7986755226901, 827.26823604423, 704.2706360554556, 881.6765570853682]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.015123673049959, "mean_inference_ms": 4.39623302209993, "mean_action_processing_ms": 1.7531914159926536, "mean_env_wait_ms": 12.222466394645403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017256975173950195, "StateBufferConnector_ms": 0.0042868852615356445, "ViewRequirementAgentConnector_ms": 0.13544774055480957}, "num_episodes": 11, "episode_return_max": 976.9119840619019, "episode_return_min": -22.50571797559193, "episode_return_mean": 232.99037421899698, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 157.5693551695457, "num_env_steps_trained_throughput_per_sec": 157.5693551695457, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 25782.137, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25781.93, "sample_time_ms": 2385.741, "learn_time_ms": 23368.941, "learn_throughput": 171.167, "synch_weights_time_ms": 24.029}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 50, "trial_id": "0b608_00000", "date": "2024-08-22_14-06-44", "timestamp": 1724315804, "time_this_iter_s": 25.44474697113037, "time_total_s": 1296.9651565551758, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a35c8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1296.9651565551758, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 31.62777777777778, "ram_util_percent": 83.00555555555553}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.664351434556266, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.622751480687864, "policy_loss": -0.006961219361120904, "vf_loss": 8.62898263224849, "vf_explained_var": 0.14336675121670678, "kl": 0.007300890546794685, "entropy": 0.2812651022874489, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 47723.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.264357498713903, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.184230392193669, "policy_loss": -0.00989903717809332, "vf_loss": 8.192595459166027, "vf_explained_var": 0.5124029392287844, "kl": 0.00766990681834243, "entropy": 0.5696283552697096, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 47723.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 1150.4215974239341, "episode_reward_min": -22.50571797559193, "episode_reward_mean": 227.1170410741376, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1199.2140253490095, "predator_policy": 0.8878464494874463}, "policy_reward_max": {"prey_policy": 327.50171838673106, "predator_policy": 1199.2140253490095}, "policy_reward_mean": {"prey_policy": -630.7672408492938, "predator_policy": 744.3257613863627}, "custom_metrics": {}, "hist_stats": {"episode_reward": [118.58860689232841, -7.277263343997163, 466.3658434407079, 230.24000494399414, 630.0429066311392, 335.0744287042068, 451.6541632080451, 26.586111770817485, 157.59989469688333, 261.54077062187287, 8.414157457135403, 532.9213107554654, 188.23147248030287, 84.18758393423326, 18.600000000000055, 255.51927399358277, 14.799999999999994, 291.4338018515583, 41.6253340130188, 480.2026086382048, 529.9923857707257, 294.2714521281412, 1.7763568394002505e-15, 497.0198493595572, 7.993605777301127e-15, 282.8732957289397, 21.30000000000001, 2.9020428495225605, -22.438281325711664, 231.0223185413019, 28.99115039436936, 224.99624610121236, 210.4480502781889, 719.2700351681, 0.6999999999999982, -0.32015301559163456, -5.301264965872615, 156.2089424335749, -5.329070518200751e-15, 78.248760163328, 307.47163330889566, 232.64621791598682, 405.5981450612816, 652.3743689571353, 10.64171439658251, 0.10000000000000031, 4.300000000000001, 1.999999999999997, 115.64451292049517, 1.1315392950974799, 289.89999999999884, 540.3617500095523, 235.8007041492604, 83.5592273895888, -0.12371328526905989, 976.9119840619019, -22.50571797559193, 4.440892098500626e-16, 301.8791868147667, 12.399999999999999, 552.2469238571779, 311.414690864496, 576.1998236161738, 25.49522593173306, 37.450062957345104, 19.857302689392924, 55.700000000000045, 227.3382096601433, 22.560030076277073, 43.517404530650694, 435.26547281821587, 49.765415700120755, 392.15349699773077, 450.2574535900942, 497.9558343088777, 562.7702266311575, 165.104452261607, 668.9891027238638, 398.90544983731115, 20.915368912377623, 228.7035443990689, 957.3294937160558, 428.83810208782427, 98.49999999999997, 22.684625928145223, 3.2053558635682258, 817.7020485599398, -4.203578645604483, 28.061496055565826, -4.9815561015035765, 37.57065522954305, 267.8039100505928, 163.1930357996359, 40.09001839434966, 1150.4215974239341, 62.815528341286594, 61.98370811494342, 406.18339114494876, 157.18938702011172, 288.12400274763826], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-690.1796257961659, -986.8122714245026, -938.780849021955, -1095.4634330487775, -661.5881305967519, 327.50171838673106, -256.6991552721187, -819.9790998661427, -1068.3864096737407, 235.1420105698992, 271.08972326674257, -1094.4766900607965, -924.6312284629837, 11.17653461815442, -716.405789558946, -860.8690642707562, -794.3865329198633, -83.16851106587299, -613.9849330916687, -1003.5872113225614, -872.3723665008439, -958.8239852742682, -128.64486116664526, -1011.3867735128056, -646.7796585087938, -514.8469263046336, -327.3985963170454, -1067.4968665885842, -948.2693349152537, -942.0874660256354, 24.843651340284758, -764.3906359675259, -983.0115836439948, -858.3490384427502, -891.715913555865, -361.2504575160083, -1135.3188366645966, -620.6172229363619, -38.06035983407125, 139.9293919474889, -738.4780257105889, 178.08079599569766, -150.6843360354399, -1034.9755228356257, -950.4647200609257, -1026.924910057712, 40.03614979508194, -1151.386944643099, -1057.1319130915315, -1104.0456606448572, 281.98544927945227, -1023.2458040623336, -1099.3386545915964, -452.62000644930663, -1020.2429384843405, -700.8451596433407, -765.0095831491806, -690.2272164351268, -905.7258604974357, -746.537770425619, -836.7673578332452, -888.5534316145131, -265.0584022951205, -463.1553227537704, -952.2613712071914, -634.1101984962777, -802.1129768214523, 165.68989333179448, -964.8471801587802, -855.6538430651397, -1199.2140253490095, -983.9526719459352, -1038.9620174666434, -955.7875200562529, -364.2958947439972, -860.7175090783647, -1158.9020267254466, -858.4022232303714, -1054.1780610247836, -460.98349027872047, -96.31910060872644, -954.210360675706, -341.8643244448935, -1083.28930037143, -65.04218815419509, -1085.0938076905932, -694.5223930455571, 218.6264066392309, -896.9088544573955, -841.5692947226568, -1066.4151371548269, -1073.5679088229965, -881.4241897835082, -867.4207872282888, -905.0372415659021, -1058.6496755030205, -430.2556660352729, -768.3659063687718, -775.2095463446071, -914.5154779730971, -12.935670636391812, 78.31791930886055, 314.04491019868686, -760.5196076954619, 110.69985612535989, -473.36271233883394, -992.047510293264, -427.2527191384847, -788.8789409759238, -812.8042686647052, 326.84320830388515, -973.0452549661647, -1082.103322703885, -1095.8391476122542, -828.4327015869654, -975.2242437942261, -254.8048964584474, -464.00345546654825, -1038.816717299487, -974.1419203022563, -453.60152740389697, -539.2364813116042, -894.4322534840139, -277.8995759480701, -867.7602927287161, -275.5634674960537, -801.156989633418, -701.409512063225, -639.8365974219873, -1021.2904479478209, -701.9471031014613, -860.6523308507406, -939.8089554189786, -736.0389027568975, -361.9361796317842, -951.7167190717195, -620.3462682608337, -1007.6519633392903, -648.4795049109764, -767.2319733158648, -866.6257659205735, 59.69262920231512, -836.0687532370777, -307.08925535069943, -823.2309868062986, -93.06404936263088, -808.6185116205252, -158.19622129858942, 167.57296420238862, -650.02115230949, -391.03852132837665, 147.58595385896905, -662.9801642931858, -51.91545295986659, -76.96538150290277, -1112.5787070845126, -878.5246788679054, -176.17194910686, -859.1622749567109, -45.39299129979647, -717.9408725371821, -49.79284876094222, 197.40968656973197, -1084.615970081035, 53.84441976133593, -897.7885270426684, -838.775524134128, -671.7883217475354, -904.1296595556089, -88.26959842800939, -978.3324002912345, -669.8899338212037, 105.66344330870278, -1028.8596628998423, -749.818646886714, -1085.8146880138056, -705.4724775354946, -745.1855412779336, -881.9485015746708, -822.0999660937538, -703.7506806685905, -844.6258572426902, 1.8524883742487852, -759.7543486782574, -784.8779784934914, -143.34451002981913, -501.0019149444163, -770.3081283267647, -1003.8909051332041, 296.81066414670966, -177.98717986289574, -1012.0163901374008, -364.1359098337468, -843.3678864601354, -188.45981119189983, -801.5348089791286, -948.4986428675579, -593.7346505293199, -859.2235948526683, -171.29521509628452], "policy_predator_policy_reward": [825.8472554185372, 969.7332486944578, 939.780849021955, 1087.1861697047805, 735.5293355570217, 64.92292009370762, 757.1844814949313, 549.7337785873236, 1024.2677832007307, 439.0195225342512, 63.98470543746432, 1094.4766900607965, 886.5113597871887, 478.59749726568407, 766.3697462361091, 837.4912193644103, 635.3980789481117, 399.7568597345072, 1031.0240074596381, 848.0889075764641, 1034.4428996738095, 805.167609558437, 814.6029258686933, 858.3500195662172, 574.1174809743994, 775.7405763193276, 411.5861802512798, 1067.4968665885842, 966.3693349152537, 942.5874660256354, 220.16301235975337, 774.9032462610728, 995.8115836439948, 860.3490384427502, 794.9648150509237, 749.4353578725103, 1145.307524461222, 652.2538691527583, 185.2555114739396, 193.0780650508476, 736.8106837420422, 353.578931743576, 522.8045760367206, 957.1267349624844, 950.4647200609257, 1026.924910057712, 566.1893819874432, 1042.1812622201276, 1057.1319130915315, 1104.0456606448572, 0.8878464494874463, 1023.2458040623336, 1099.3386545915964, 473.92000644930664, 876.5371344542345, 847.4530065229698, 689.5958236502485, 743.2026946083474, 892.3036145204774, 990.982334943879, 861.7741389869038, 892.537800855224, 400.6746447556051, 552.5353263944982, 913.9444308327382, 882.8751891489209, 704.8919845909573, 650.8011340667994, 965.5471801587804, 855.6538430651397, 1199.2140253490095, 983.6325189303435, 950.4862550903802, 1038.9620174666434, 532.3026122310682, 848.9197340248702, 1158.9020267254466, 858.4022232303714, 927.9781159333131, 665.4321955335155, 956.3408064956715, 401.6602880976567, 1068.3473956723312, 589.4524470599866, 532.1925797173635, 1023.5415611887067, 597.5496608249966, 530.7206945384645, 941.773356231544, 807.3465073450913, 1066.515137154827, 1073.5679088229965, 881.4241897835082, 871.7207872282886, 907.0372415659021, 1058.6496755030205, 582.7106544210349, 731.5554309035119, 776.0095463446073, 914.8470172681945, 60.25890896166618, 164.25884236586526, 641.8792995974322, 344.95714790889633, 108.16510532896929, 490.2984550337655, 644.9094925650478, 857.9499642562923, 788.5552276906548, 813.0042686647053, 740.5823353922415, 882.5316953319407, 1179.4160561829622, 976.020696157585, 828.4327015869654, 975.2242437942261, 378.9457075157058, 641.741831224055, 1050.9167172994871, 974.4419203022562, 814.10396844481, 730.9809641278695, 590.5242589336588, 893.2222613629211, 736.8660525163231, 982.6575313246245, 750.2384972042242, 777.8232304241526, 676.9866603793337, 1021.590447947821, 714.3721913325901, 868.084545309005, 940.5089554189785, 791.0389027568978, 671.7890079966465, 869.2021003670015, 638.5424608431032, 1012.0158008332995, 660.7880004970943, 798.4408822603982, 747.3526215596225, 494.84598797684913, 462.9840049179132, 729.9394193699893, 767.716812621944, 540.7317205447117, 690.4582670710903, 726.6139194381192, 491.7250515062092, 488.6789709097723, 349.3567640465415, 456.8660300540238, 669.4428081625107, 210.55726135215008, 919.3748152951185, 939.1583760161639, 747.3189966633228, 706.28308114875, 596.1456305286578, 329.3250046402256, 943.7763122972342, 52.66095339996108, 963.0452818869503, 881.4904953404096, 380.7081744943708, 892.074034874786, 838.875524134128, 770.1883217475355, 834.9249256136862, 180.15895829807582, 978.3324002912345, 673.0952896847726, 899.9236564009232, 840.9746117501509, 738.0053672952956, 1093.4243889596194, 735.5703178389668, 743.1491970300302, 871.7986755226901, 827.26823604423, 704.2706360554556, 881.6765570853682, 329.9899365931548, 695.715833761446, 539.5465451075261, 551.8689792154186, 745.853554914687, 565.5465067508482, 945.2481681799262, 912.2536702305064, 1054.1766948961522, 198.6424034454295, 442.83722325186216, 826.6502811569635, 604.8655055306103, 791.3125057853636, 939.2585562205726, 760.1641241964185, 633.7843536103165, 684.8584590862722]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.008149674085065, "mean_inference_ms": 4.401541556398457, "mean_action_processing_ms": 1.755598262163541, "mean_env_wait_ms": 12.236124089050755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017217278480529785, "StateBufferConnector_ms": 0.00417637825012207, "ViewRequirementAgentConnector_ms": 0.1279771327972412}, "num_episodes": 9, "episode_return_max": 1150.4215974239341, "episode_return_min": -22.50571797559193, "episode_return_mean": 227.1170410741376, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.30956884676607, "num_env_steps_trained_throughput_per_sec": 155.30956884676607, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 25788.208, "restore_workers_time_ms": 0.025, "training_step_time_ms": 25788.02, "sample_time_ms": 2401.175, "learn_time_ms": 23362.529, "learn_throughput": 171.214, "synch_weights_time_ms": 21.061}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 51, "trial_id": "0b608_00000", "date": "2024-08-22_14-07-09", "timestamp": 1724315829, "time_this_iter_s": 25.78934097290039, "time_total_s": 1322.7544975280762, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3120819d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1322.7544975280762, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 31.74054054054053, "ram_util_percent": 83.19189189189188}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.237925626108886, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.164159762165534, "policy_loss": -0.008455506109795164, "vf_loss": 8.171884962616774, "vf_explained_var": 0.22957753081801077, "kl": 0.007303081161623436, "entropy": 0.271464490448987, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48668.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.089270035678116, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.607157088082934, "policy_loss": -0.010846341206450704, "vf_loss": 7.616365294481711, "vf_explained_var": 0.6120091708879623, "kl": 0.00819057100033634, "entropy": 0.5681950732513711, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48668.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 1150.4215974239341, "episode_reward_min": -22.50571797559193, "episode_reward_mean": 221.45431827042415, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1199.2140253490095, "predator_policy": 0.8878464494874463}, "policy_reward_max": {"prey_policy": 326.84320830388515, "predator_policy": 1199.2140253490095}, "policy_reward_mean": {"prey_policy": -623.3515801364229, "predator_policy": 734.0787392716352}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.414157457135403, 532.9213107554654, 188.23147248030287, 84.18758393423326, 18.600000000000055, 255.51927399358277, 14.799999999999994, 291.4338018515583, 41.6253340130188, 480.2026086382048, 529.9923857707257, 294.2714521281412, 1.7763568394002505e-15, 497.0198493595572, 7.993605777301127e-15, 282.8732957289397, 21.30000000000001, 2.9020428495225605, -22.438281325711664, 231.0223185413019, 28.99115039436936, 224.99624610121236, 210.4480502781889, 719.2700351681, 0.6999999999999982, -0.32015301559163456, -5.301264965872615, 156.2089424335749, -5.329070518200751e-15, 78.248760163328, 307.47163330889566, 232.64621791598682, 405.5981450612816, 652.3743689571353, 10.64171439658251, 0.10000000000000031, 4.300000000000001, 1.999999999999997, 115.64451292049517, 1.1315392950974799, 289.89999999999884, 540.3617500095523, 235.8007041492604, 83.5592273895888, -0.12371328526905989, 976.9119840619019, -22.50571797559193, 4.440892098500626e-16, 301.8791868147667, 12.399999999999999, 552.2469238571779, 311.414690864496, 576.1998236161738, 25.49522593173306, 37.450062957345104, 19.857302689392924, 55.700000000000045, 227.3382096601433, 22.560030076277073, 43.517404530650694, 435.26547281821587, 49.765415700120755, 392.15349699773077, 450.2574535900942, 497.9558343088777, 562.7702266311575, 165.104452261607, 668.9891027238638, 398.90544983731115, 20.915368912377623, 228.7035443990689, 957.3294937160558, 428.83810208782427, 98.49999999999997, 22.684625928145223, 3.2053558635682258, 817.7020485599398, -4.203578645604483, 28.061496055565826, -4.9815561015035765, 37.57065522954305, 267.8039100505928, 163.1930357996359, 40.09001839434966, 1150.4215974239341, 62.815528341286594, 61.98370811494342, 406.18339114494876, 157.18938702011172, 288.12400274763826, 84.50000000000001, 304.35428257815306, 39.699999999999996, 409.36550068371906, 377.56854157091925, 196.38031350519933, 68.5000000000004, 96.69696304064716, 151.83342148032241, 375.2441643356955], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-872.3723665008439, -958.8239852742682, -128.64486116664526, -1011.3867735128056, -646.7796585087938, -514.8469263046336, -327.3985963170454, -1067.4968665885842, -948.2693349152537, -942.0874660256354, 24.843651340284758, -764.3906359675259, -983.0115836439948, -858.3490384427502, -891.715913555865, -361.2504575160083, -1135.3188366645966, -620.6172229363619, -38.06035983407125, 139.9293919474889, -738.4780257105889, 178.08079599569766, -150.6843360354399, -1034.9755228356257, -950.4647200609257, -1026.924910057712, 40.03614979508194, -1151.386944643099, -1057.1319130915315, -1104.0456606448572, 281.98544927945227, -1023.2458040623336, -1099.3386545915964, -452.62000644930663, -1020.2429384843405, -700.8451596433407, -765.0095831491806, -690.2272164351268, -905.7258604974357, -746.537770425619, -836.7673578332452, -888.5534316145131, -265.0584022951205, -463.1553227537704, -952.2613712071914, -634.1101984962777, -802.1129768214523, 165.68989333179448, -964.8471801587802, -855.6538430651397, -1199.2140253490095, -983.9526719459352, -1038.9620174666434, -955.7875200562529, -364.2958947439972, -860.7175090783647, -1158.9020267254466, -858.4022232303714, -1054.1780610247836, -460.98349027872047, -96.31910060872644, -954.210360675706, -341.8643244448935, -1083.28930037143, -65.04218815419509, -1085.0938076905932, -694.5223930455571, 218.6264066392309, -896.9088544573955, -841.5692947226568, -1066.4151371548269, -1073.5679088229965, -881.4241897835082, -867.4207872282888, -905.0372415659021, -1058.6496755030205, -430.2556660352729, -768.3659063687718, -775.2095463446071, -914.5154779730971, -12.935670636391812, 78.31791930886055, 314.04491019868686, -760.5196076954619, 110.69985612535989, -473.36271233883394, -992.047510293264, -427.2527191384847, -788.8789409759238, -812.8042686647052, 326.84320830388515, -973.0452549661647, -1082.103322703885, -1095.8391476122542, -828.4327015869654, -975.2242437942261, -254.8048964584474, -464.00345546654825, -1038.816717299487, -974.1419203022563, -453.60152740389697, -539.2364813116042, -894.4322534840139, -277.8995759480701, -867.7602927287161, -275.5634674960537, -801.156989633418, -701.409512063225, -639.8365974219873, -1021.2904479478209, -701.9471031014613, -860.6523308507406, -939.8089554189786, -736.0389027568975, -361.9361796317842, -951.7167190717195, -620.3462682608337, -1007.6519633392903, -648.4795049109764, -767.2319733158648, -866.6257659205735, 59.69262920231512, -836.0687532370777, -307.08925535069943, -823.2309868062986, -93.06404936263088, -808.6185116205252, -158.19622129858942, 167.57296420238862, -650.02115230949, -391.03852132837665, 147.58595385896905, -662.9801642931858, -51.91545295986659, -76.96538150290277, -1112.5787070845126, -878.5246788679054, -176.17194910686, -859.1622749567109, -45.39299129979647, -717.9408725371821, -49.79284876094222, 197.40968656973197, -1084.615970081035, 53.84441976133593, -897.7885270426684, -838.775524134128, -671.7883217475354, -904.1296595556089, -88.26959842800939, -978.3324002912345, -669.8899338212037, 105.66344330870278, -1028.8596628998423, -749.818646886714, -1085.8146880138056, -705.4724775354946, -745.1855412779336, -881.9485015746708, -822.0999660937538, -703.7506806685905, -844.6258572426902, 1.8524883742487852, -759.7543486782574, -784.8779784934914, -143.34451002981913, -501.0019149444163, -770.3081283267647, -1003.8909051332041, 296.81066414670966, -177.98717986289574, -1012.0163901374008, -364.1359098337468, -843.3678864601354, -188.45981119189983, -801.5348089791286, -948.4986428675579, -593.7346505293199, -859.2235948526683, -171.29521509628452, -104.46838734444557, -826.6151278193578, -995.574176048659, -49.985921956960176, -705.6552072551328, -718.4748597380328, -240.1524254541731, -831.743751132115, -789.2229043890054, -484.23220480966296, -778.0677144761992, -281.58995674696456, -111.44189647204587, 8.786972633665817, -636.3185337269166, -720.3174607366267, -447.77528144148044, -996.7165529429294, -182.14768215739787, -389.64373402344717], "policy_predator_policy_reward": [1034.4428996738095, 805.167609558437, 814.6029258686933, 858.3500195662172, 574.1174809743994, 775.7405763193276, 411.5861802512798, 1067.4968665885842, 966.3693349152537, 942.5874660256354, 220.16301235975337, 774.9032462610728, 995.8115836439948, 860.3490384427502, 794.9648150509237, 749.4353578725103, 1145.307524461222, 652.2538691527583, 185.2555114739396, 193.0780650508476, 736.8106837420422, 353.578931743576, 522.8045760367206, 957.1267349624844, 950.4647200609257, 1026.924910057712, 566.1893819874432, 1042.1812622201276, 1057.1319130915315, 1104.0456606448572, 0.8878464494874463, 1023.2458040623336, 1099.3386545915964, 473.92000644930664, 876.5371344542345, 847.4530065229698, 689.5958236502485, 743.2026946083474, 892.3036145204774, 990.982334943879, 861.7741389869038, 892.537800855224, 400.6746447556051, 552.5353263944982, 913.9444308327382, 882.8751891489209, 704.8919845909573, 650.8011340667994, 965.5471801587804, 855.6538430651397, 1199.2140253490095, 983.6325189303435, 950.4862550903802, 1038.9620174666434, 532.3026122310682, 848.9197340248702, 1158.9020267254466, 858.4022232303714, 927.9781159333131, 665.4321955335155, 956.3408064956715, 401.6602880976567, 1068.3473956723312, 589.4524470599866, 532.1925797173635, 1023.5415611887067, 597.5496608249966, 530.7206945384645, 941.773356231544, 807.3465073450913, 1066.515137154827, 1073.5679088229965, 881.4241897835082, 871.7207872282886, 907.0372415659021, 1058.6496755030205, 582.7106544210349, 731.5554309035119, 776.0095463446073, 914.8470172681945, 60.25890896166618, 164.25884236586526, 641.8792995974322, 344.95714790889633, 108.16510532896929, 490.2984550337655, 644.9094925650478, 857.9499642562923, 788.5552276906548, 813.0042686647053, 740.5823353922415, 882.5316953319407, 1179.4160561829622, 976.020696157585, 828.4327015869654, 975.2242437942261, 378.9457075157058, 641.741831224055, 1050.9167172994871, 974.4419203022562, 814.10396844481, 730.9809641278695, 590.5242589336588, 893.2222613629211, 736.8660525163231, 982.6575313246245, 750.2384972042242, 777.8232304241526, 676.9866603793337, 1021.590447947821, 714.3721913325901, 868.084545309005, 940.5089554189785, 791.0389027568978, 671.7890079966465, 869.2021003670015, 638.5424608431032, 1012.0158008332995, 660.7880004970943, 798.4408822603982, 747.3526215596225, 494.84598797684913, 462.9840049179132, 729.9394193699893, 767.716812621944, 540.7317205447117, 690.4582670710903, 726.6139194381192, 491.7250515062092, 488.6789709097723, 349.3567640465415, 456.8660300540238, 669.4428081625107, 210.55726135215008, 919.3748152951185, 939.1583760161639, 747.3189966633228, 706.28308114875, 596.1456305286578, 329.3250046402256, 943.7763122972342, 52.66095339996108, 963.0452818869503, 881.4904953404096, 380.7081744943708, 892.074034874786, 838.875524134128, 770.1883217475355, 834.9249256136862, 180.15895829807582, 978.3324002912345, 673.0952896847726, 899.9236564009232, 840.9746117501509, 738.0053672952956, 1093.4243889596194, 735.5703178389668, 743.1491970300302, 871.7986755226901, 827.26823604423, 704.2706360554556, 881.6765570853682, 329.9899365931548, 695.715833761446, 539.5465451075261, 551.8689792154186, 745.853554914687, 565.5465067508482, 945.2481681799262, 912.2536702305064, 1054.1766948961522, 198.6424034454295, 442.83722325186216, 826.6502811569635, 604.8655055306103, 791.3125057853636, 939.2585562205726, 760.1641241964185, 633.7843536103165, 684.8584590862722, 187.5683873444446, 828.0151278193579, 911.8519386796008, 438.0624419041738, 706.5552072551329, 757.2748597380327, 655.7279868425106, 825.5336904274974, 895.2277618132435, 755.7958889563487, 721.8703686160828, 534.1676161122866, 142.54189647204618, 28.613027366334308, 798.355448791451, 654.97750871274, 650.9144235599767, 945.4108323047566, 522.1313801839964, 424.9042003325424]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.998279289537249, "mean_inference_ms": 4.384799426315339, "mean_action_processing_ms": 1.7639179608923932, "mean_env_wait_ms": 12.242981539841642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01732015609741211, "StateBufferConnector_ms": 0.004191756248474121, "ViewRequirementAgentConnector_ms": 0.1301097869873047}, "num_episodes": 10, "episode_return_max": 1150.4215974239341, "episode_return_min": -22.50571797559193, "episode_return_mean": 221.45431827042415, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 158.2917041826636, "num_env_steps_trained_throughput_per_sec": 158.2917041826636, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 25756.226, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25756.029, "sample_time_ms": 2382.109, "learn_time_ms": 23348.993, "learn_throughput": 171.314, "synch_weights_time_ms": 21.742}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 52, "trial_id": "0b608_00000", "date": "2024-08-22_14-07-35", "timestamp": 1724315855, "time_this_iter_s": 25.31101107597351, "time_total_s": 1348.0655086040497, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30e415a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1348.0655086040497, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 30.53055555555555, "ram_util_percent": 82.47222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.44699587544436, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.504099940244483, "policy_loss": -0.004580888130933677, "vf_loss": 8.50805201505227, "vf_explained_var": -0.07182466189066569, "kl": 0.006288090599306598, "entropy": 0.2546998688625911, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 49613.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.698812243799683, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.744442573426261, "policy_loss": -0.010655261981227095, "vf_loss": 7.753585378959696, "vf_explained_var": 0.576655795586803, "kl": 0.0075622147870639325, "entropy": 0.5388568627455878, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 49613.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "env_runners": {"episode_reward_max": 1150.4215974239341, "episode_reward_min": -22.50571797559193, "episode_reward_mean": 249.44020379749583, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1199.2140253490095, "predator_policy": 0.8878464494874463}, "policy_reward_max": {"prey_policy": 379.94185724661145, "predator_policy": 1199.2140253490095}, "policy_reward_mean": {"prey_policy": -600.7022490160605, "predator_policy": 725.4223509148086}, "custom_metrics": {}, "hist_stats": {"episode_reward": [291.4338018515583, 41.6253340130188, 480.2026086382048, 529.9923857707257, 294.2714521281412, 1.7763568394002505e-15, 497.0198493595572, 7.993605777301127e-15, 282.8732957289397, 21.30000000000001, 2.9020428495225605, -22.438281325711664, 231.0223185413019, 28.99115039436936, 224.99624610121236, 210.4480502781889, 719.2700351681, 0.6999999999999982, -0.32015301559163456, -5.301264965872615, 156.2089424335749, -5.329070518200751e-15, 78.248760163328, 307.47163330889566, 232.64621791598682, 405.5981450612816, 652.3743689571353, 10.64171439658251, 0.10000000000000031, 4.300000000000001, 1.999999999999997, 115.64451292049517, 1.1315392950974799, 289.89999999999884, 540.3617500095523, 235.8007041492604, 83.5592273895888, -0.12371328526905989, 976.9119840619019, -22.50571797559193, 4.440892098500626e-16, 301.8791868147667, 12.399999999999999, 552.2469238571779, 311.414690864496, 576.1998236161738, 25.49522593173306, 37.450062957345104, 19.857302689392924, 55.700000000000045, 227.3382096601433, 22.560030076277073, 43.517404530650694, 435.26547281821587, 49.765415700120755, 392.15349699773077, 450.2574535900942, 497.9558343088777, 562.7702266311575, 165.104452261607, 668.9891027238638, 398.90544983731115, 20.915368912377623, 228.7035443990689, 957.3294937160558, 428.83810208782427, 98.49999999999997, 22.684625928145223, 3.2053558635682258, 817.7020485599398, -4.203578645604483, 28.061496055565826, -4.9815561015035765, 37.57065522954305, 267.8039100505928, 163.1930357996359, 40.09001839434966, 1150.4215974239341, 62.815528341286594, 61.98370811494342, 406.18339114494876, 157.18938702011172, 288.12400274763826, 84.50000000000001, 304.35428257815306, 39.699999999999996, 409.36550068371906, 377.56854157091925, 196.38031350519933, 68.5000000000004, 96.69696304064716, 151.83342148032241, 375.2441643356955, -0.49747145883548605, 645.167949163576, 885.4740546023669, 894.0867765136334, 624.6563334059294, 798.1871898558131, 54.1875192454019], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-891.715913555865, -361.2504575160083, -1135.3188366645966, -620.6172229363619, -38.06035983407125, 139.9293919474889, -738.4780257105889, 178.08079599569766, -150.6843360354399, -1034.9755228356257, -950.4647200609257, -1026.924910057712, 40.03614979508194, -1151.386944643099, -1057.1319130915315, -1104.0456606448572, 281.98544927945227, -1023.2458040623336, -1099.3386545915964, -452.62000644930663, -1020.2429384843405, -700.8451596433407, -765.0095831491806, -690.2272164351268, -905.7258604974357, -746.537770425619, -836.7673578332452, -888.5534316145131, -265.0584022951205, -463.1553227537704, -952.2613712071914, -634.1101984962777, -802.1129768214523, 165.68989333179448, -964.8471801587802, -855.6538430651397, -1199.2140253490095, -983.9526719459352, -1038.9620174666434, -955.7875200562529, -364.2958947439972, -860.7175090783647, -1158.9020267254466, -858.4022232303714, -1054.1780610247836, -460.98349027872047, -96.31910060872644, -954.210360675706, -341.8643244448935, -1083.28930037143, -65.04218815419509, -1085.0938076905932, -694.5223930455571, 218.6264066392309, -896.9088544573955, -841.5692947226568, -1066.4151371548269, -1073.5679088229965, -881.4241897835082, -867.4207872282888, -905.0372415659021, -1058.6496755030205, -430.2556660352729, -768.3659063687718, -775.2095463446071, -914.5154779730971, -12.935670636391812, 78.31791930886055, 314.04491019868686, -760.5196076954619, 110.69985612535989, -473.36271233883394, -992.047510293264, -427.2527191384847, -788.8789409759238, -812.8042686647052, 326.84320830388515, -973.0452549661647, -1082.103322703885, -1095.8391476122542, -828.4327015869654, -975.2242437942261, -254.8048964584474, -464.00345546654825, -1038.816717299487, -974.1419203022563, -453.60152740389697, -539.2364813116042, -894.4322534840139, -277.8995759480701, -867.7602927287161, -275.5634674960537, -801.156989633418, -701.409512063225, -639.8365974219873, -1021.2904479478209, -701.9471031014613, -860.6523308507406, -939.8089554189786, -736.0389027568975, -361.9361796317842, -951.7167190717195, -620.3462682608337, -1007.6519633392903, -648.4795049109764, -767.2319733158648, -866.6257659205735, 59.69262920231512, -836.0687532370777, -307.08925535069943, -823.2309868062986, -93.06404936263088, -808.6185116205252, -158.19622129858942, 167.57296420238862, -650.02115230949, -391.03852132837665, 147.58595385896905, -662.9801642931858, -51.91545295986659, -76.96538150290277, -1112.5787070845126, -878.5246788679054, -176.17194910686, -859.1622749567109, -45.39299129979647, -717.9408725371821, -49.79284876094222, 197.40968656973197, -1084.615970081035, 53.84441976133593, -897.7885270426684, -838.775524134128, -671.7883217475354, -904.1296595556089, -88.26959842800939, -978.3324002912345, -669.8899338212037, 105.66344330870278, -1028.8596628998423, -749.818646886714, -1085.8146880138056, -705.4724775354946, -745.1855412779336, -881.9485015746708, -822.0999660937538, -703.7506806685905, -844.6258572426902, 1.8524883742487852, -759.7543486782574, -784.8779784934914, -143.34451002981913, -501.0019149444163, -770.3081283267647, -1003.8909051332041, 296.81066414670966, -177.98717986289574, -1012.0163901374008, -364.1359098337468, -843.3678864601354, -188.45981119189983, -801.5348089791286, -948.4986428675579, -593.7346505293199, -859.2235948526683, -171.29521509628452, -104.46838734444557, -826.6151278193578, -995.574176048659, -49.985921956960176, -705.6552072551328, -718.4748597380328, -240.1524254541731, -831.743751132115, -789.2229043890054, -484.23220480966296, -778.0677144761992, -281.58995674696456, -111.44189647204587, 8.786972633665817, -636.3185337269166, -720.3174607366267, -447.77528144148044, -996.7165529429294, -182.14768215739787, -389.64373402344717, -1044.2796737196538, -852.6909277364806, 345.6645174819379, -570.6252629369636, 339.03323481115467, -791.5329489016997, 379.94185724661145, -799.4033844636299, 221.06453693940003, -791.7937450876865, -727.9506546050003, 183.15767695730943, -730.3332850434823, -629.4001586978513], "policy_predator_policy_reward": [794.9648150509237, 749.4353578725103, 1145.307524461222, 652.2538691527583, 185.2555114739396, 193.0780650508476, 736.8106837420422, 353.578931743576, 522.8045760367206, 957.1267349624844, 950.4647200609257, 1026.924910057712, 566.1893819874432, 1042.1812622201276, 1057.1319130915315, 1104.0456606448572, 0.8878464494874463, 1023.2458040623336, 1099.3386545915964, 473.92000644930664, 876.5371344542345, 847.4530065229698, 689.5958236502485, 743.2026946083474, 892.3036145204774, 990.982334943879, 861.7741389869038, 892.537800855224, 400.6746447556051, 552.5353263944982, 913.9444308327382, 882.8751891489209, 704.8919845909573, 650.8011340667994, 965.5471801587804, 855.6538430651397, 1199.2140253490095, 983.6325189303435, 950.4862550903802, 1038.9620174666434, 532.3026122310682, 848.9197340248702, 1158.9020267254466, 858.4022232303714, 927.9781159333131, 665.4321955335155, 956.3408064956715, 401.6602880976567, 1068.3473956723312, 589.4524470599866, 532.1925797173635, 1023.5415611887067, 597.5496608249966, 530.7206945384645, 941.773356231544, 807.3465073450913, 1066.515137154827, 1073.5679088229965, 881.4241897835082, 871.7207872282886, 907.0372415659021, 1058.6496755030205, 582.7106544210349, 731.5554309035119, 776.0095463446073, 914.8470172681945, 60.25890896166618, 164.25884236586526, 641.8792995974322, 344.95714790889633, 108.16510532896929, 490.2984550337655, 644.9094925650478, 857.9499642562923, 788.5552276906548, 813.0042686647053, 740.5823353922415, 882.5316953319407, 1179.4160561829622, 976.020696157585, 828.4327015869654, 975.2242437942261, 378.9457075157058, 641.741831224055, 1050.9167172994871, 974.4419203022562, 814.10396844481, 730.9809641278695, 590.5242589336588, 893.2222613629211, 736.8660525163231, 982.6575313246245, 750.2384972042242, 777.8232304241526, 676.9866603793337, 1021.590447947821, 714.3721913325901, 868.084545309005, 940.5089554189785, 791.0389027568978, 671.7890079966465, 869.2021003670015, 638.5424608431032, 1012.0158008332995, 660.7880004970943, 798.4408822603982, 747.3526215596225, 494.84598797684913, 462.9840049179132, 729.9394193699893, 767.716812621944, 540.7317205447117, 690.4582670710903, 726.6139194381192, 491.7250515062092, 488.6789709097723, 349.3567640465415, 456.8660300540238, 669.4428081625107, 210.55726135215008, 919.3748152951185, 939.1583760161639, 747.3189966633228, 706.28308114875, 596.1456305286578, 329.3250046402256, 943.7763122972342, 52.66095339996108, 963.0452818869503, 881.4904953404096, 380.7081744943708, 892.074034874786, 838.875524134128, 770.1883217475355, 834.9249256136862, 180.15895829807582, 978.3324002912345, 673.0952896847726, 899.9236564009232, 840.9746117501509, 738.0053672952956, 1093.4243889596194, 735.5703178389668, 743.1491970300302, 871.7986755226901, 827.26823604423, 704.2706360554556, 881.6765570853682, 329.9899365931548, 695.715833761446, 539.5465451075261, 551.8689792154186, 745.853554914687, 565.5465067508482, 945.2481681799262, 912.2536702305064, 1054.1766948961522, 198.6424034454295, 442.83722325186216, 826.6502811569635, 604.8655055306103, 791.3125057853636, 939.2585562205726, 760.1641241964185, 633.7843536103165, 684.8584590862722, 187.5683873444446, 828.0151278193579, 911.8519386796008, 438.0624419041738, 706.5552072551329, 757.2748597380327, 655.7279868425106, 825.5336904274974, 895.2277618132435, 755.7958889563487, 721.8703686160828, 534.1676161122866, 142.54189647204618, 28.613027366334308, 798.355448791451, 654.97750871274, 650.9144235599767, 945.4108323047566, 522.1313801839964, 424.9042003325424, 1046.6675418788543, 849.8055881184446, 489.4186415184165, 380.710053100186, 610.6492860887591, 727.3244826041544, 594.5902508134275, 718.958052917223, 530.496379137762, 664.8891624164494, 699.9150778855213, 643.0650896179842, 761.1603885378661, 652.7605744488721]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.004736427182042, "mean_inference_ms": 4.394291232357326, "mean_action_processing_ms": 1.753729438813151, "mean_env_wait_ms": 12.265213566177836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017366766929626465, "StateBufferConnector_ms": 0.004256844520568848, "ViewRequirementAgentConnector_ms": 0.13224554061889648}, "num_episodes": 7, "episode_return_max": 1150.4215974239341, "episode_return_min": -22.50571797559193, "episode_return_mean": 249.44020379749583, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 149.1176056847091, "num_env_steps_trained_throughput_per_sec": 149.1176056847091, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 25829.597, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25829.402, "sample_time_ms": 2468.647, "learn_time_ms": 23335.754, "learn_throughput": 171.411, "synch_weights_time_ms": 21.668}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "training_iteration": 53, "trial_id": "0b608_00000", "date": "2024-08-22_14-08-02", "timestamp": 1724315882, "time_this_iter_s": 26.89889693260193, "time_total_s": 1374.9644055366516, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a3b8d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1374.9644055366516, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 35.72631578947369, "ram_util_percent": 83.12105263157895}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.7718758527564, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.192118843522652, "policy_loss": -0.009037263539161474, "vf_loss": 8.200596024245812, "vf_explained_var": 0.08385742681997793, "kl": 0.0056005693228038216, "entropy": 0.27449922637333946, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50558.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.982780772163753, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.5879816423648245, "policy_loss": -0.005920443112380487, "vf_loss": 7.592406329906806, "vf_explained_var": 0.611938711448952, "kl": 0.007478674142695372, "entropy": 0.5313098057867989, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50558.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 1150.4215974239341, "episode_reward_min": -22.50571797559193, "episode_reward_mean": 251.3530708318151, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1199.2140253490095, "predator_policy": 0.8878464494874463}, "policy_reward_max": {"prey_policy": 379.94185724661145, "predator_policy": 1199.2140253490095}, "policy_reward_mean": {"prey_policy": -591.1313570976035, "predator_policy": 716.8078925135114}, "custom_metrics": {}, "hist_stats": {"episode_reward": [282.8732957289397, 21.30000000000001, 2.9020428495225605, -22.438281325711664, 231.0223185413019, 28.99115039436936, 224.99624610121236, 210.4480502781889, 719.2700351681, 0.6999999999999982, -0.32015301559163456, -5.301264965872615, 156.2089424335749, -5.329070518200751e-15, 78.248760163328, 307.47163330889566, 232.64621791598682, 405.5981450612816, 652.3743689571353, 10.64171439658251, 0.10000000000000031, 4.300000000000001, 1.999999999999997, 115.64451292049517, 1.1315392950974799, 289.89999999999884, 540.3617500095523, 235.8007041492604, 83.5592273895888, -0.12371328526905989, 976.9119840619019, -22.50571797559193, 4.440892098500626e-16, 301.8791868147667, 12.399999999999999, 552.2469238571779, 311.414690864496, 576.1998236161738, 25.49522593173306, 37.450062957345104, 19.857302689392924, 55.700000000000045, 227.3382096601433, 22.560030076277073, 43.517404530650694, 435.26547281821587, 49.765415700120755, 392.15349699773077, 450.2574535900942, 497.9558343088777, 562.7702266311575, 165.104452261607, 668.9891027238638, 398.90544983731115, 20.915368912377623, 228.7035443990689, 957.3294937160558, 428.83810208782427, 98.49999999999997, 22.684625928145223, 3.2053558635682258, 817.7020485599398, -4.203578645604483, 28.061496055565826, -4.9815561015035765, 37.57065522954305, 267.8039100505928, 163.1930357996359, 40.09001839434966, 1150.4215974239341, 62.815528341286594, 61.98370811494342, 406.18339114494876, 157.18938702011172, 288.12400274763826, 84.50000000000001, 304.35428257815306, 39.699999999999996, 409.36550068371906, 377.56854157091925, 196.38031350519933, 68.5000000000004, 96.69696304064716, 151.83342148032241, 375.2441643356955, -0.49747145883548605, 645.167949163576, 885.4740546023669, 894.0867765136334, 624.6563334059294, 798.1871898558131, 54.1875192454019, 623.3165771651677, 163.80772798210472, 364.2257990679377, 4.262565385453451, 190.66840698235552, 27.54331008971744, 336.7491185810801, 615.258629939319], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [281.98544927945227, -1023.2458040623336, -1099.3386545915964, -452.62000644930663, -1020.2429384843405, -700.8451596433407, -765.0095831491806, -690.2272164351268, -905.7258604974357, -746.537770425619, -836.7673578332452, -888.5534316145131, -265.0584022951205, -463.1553227537704, -952.2613712071914, -634.1101984962777, -802.1129768214523, 165.68989333179448, -964.8471801587802, -855.6538430651397, -1199.2140253490095, -983.9526719459352, -1038.9620174666434, -955.7875200562529, -364.2958947439972, -860.7175090783647, -1158.9020267254466, -858.4022232303714, -1054.1780610247836, -460.98349027872047, -96.31910060872644, -954.210360675706, -341.8643244448935, -1083.28930037143, -65.04218815419509, -1085.0938076905932, -694.5223930455571, 218.6264066392309, -896.9088544573955, -841.5692947226568, -1066.4151371548269, -1073.5679088229965, -881.4241897835082, -867.4207872282888, -905.0372415659021, -1058.6496755030205, -430.2556660352729, -768.3659063687718, -775.2095463446071, -914.5154779730971, -12.935670636391812, 78.31791930886055, 314.04491019868686, -760.5196076954619, 110.69985612535989, -473.36271233883394, -992.047510293264, -427.2527191384847, -788.8789409759238, -812.8042686647052, 326.84320830388515, -973.0452549661647, -1082.103322703885, -1095.8391476122542, -828.4327015869654, -975.2242437942261, -254.8048964584474, -464.00345546654825, -1038.816717299487, -974.1419203022563, -453.60152740389697, -539.2364813116042, -894.4322534840139, -277.8995759480701, -867.7602927287161, -275.5634674960537, -801.156989633418, -701.409512063225, -639.8365974219873, -1021.2904479478209, -701.9471031014613, -860.6523308507406, -939.8089554189786, -736.0389027568975, -361.9361796317842, -951.7167190717195, -620.3462682608337, -1007.6519633392903, -648.4795049109764, -767.2319733158648, -866.6257659205735, 59.69262920231512, -836.0687532370777, -307.08925535069943, -823.2309868062986, -93.06404936263088, -808.6185116205252, -158.19622129858942, 167.57296420238862, -650.02115230949, -391.03852132837665, 147.58595385896905, -662.9801642931858, -51.91545295986659, -76.96538150290277, -1112.5787070845126, -878.5246788679054, -176.17194910686, -859.1622749567109, -45.39299129979647, -717.9408725371821, -49.79284876094222, 197.40968656973197, -1084.615970081035, 53.84441976133593, -897.7885270426684, -838.775524134128, -671.7883217475354, -904.1296595556089, -88.26959842800939, -978.3324002912345, -669.8899338212037, 105.66344330870278, -1028.8596628998423, -749.818646886714, -1085.8146880138056, -705.4724775354946, -745.1855412779336, -881.9485015746708, -822.0999660937538, -703.7506806685905, -844.6258572426902, 1.8524883742487852, -759.7543486782574, -784.8779784934914, -143.34451002981913, -501.0019149444163, -770.3081283267647, -1003.8909051332041, 296.81066414670966, -177.98717986289574, -1012.0163901374008, -364.1359098337468, -843.3678864601354, -188.45981119189983, -801.5348089791286, -948.4986428675579, -593.7346505293199, -859.2235948526683, -171.29521509628452, -104.46838734444557, -826.6151278193578, -995.574176048659, -49.985921956960176, -705.6552072551328, -718.4748597380328, -240.1524254541731, -831.743751132115, -789.2229043890054, -484.23220480966296, -778.0677144761992, -281.58995674696456, -111.44189647204587, 8.786972633665817, -636.3185337269166, -720.3174607366267, -447.77528144148044, -996.7165529429294, -182.14768215739787, -389.64373402344717, -1044.2796737196538, -852.6909277364806, 345.6645174819379, -570.6252629369636, 339.03323481115467, -791.5329489016997, 379.94185724661145, -799.4033844636299, 221.06453693940003, -791.7937450876865, -727.9506546050003, 183.15767695730943, -730.3332850434823, -629.4001586978513, -171.13042827242717, -354.7183489976295, -579.8775594749623, -696.4997692467128, -517.4942988464595, -406.4199461775335, -698.1709917162531, -626.2131266995658, -256.7351419103198, -717.8610445355195, -450.36295199764925, -733.1796334377858, -335.3082985169226, -808.4988091880805, 50.45331851424319, -686.8130716534583], "policy_predator_policy_reward": [0.8878464494874463, 1023.2458040623336, 1099.3386545915964, 473.92000644930664, 876.5371344542345, 847.4530065229698, 689.5958236502485, 743.2026946083474, 892.3036145204774, 990.982334943879, 861.7741389869038, 892.537800855224, 400.6746447556051, 552.5353263944982, 913.9444308327382, 882.8751891489209, 704.8919845909573, 650.8011340667994, 965.5471801587804, 855.6538430651397, 1199.2140253490095, 983.6325189303435, 950.4862550903802, 1038.9620174666434, 532.3026122310682, 848.9197340248702, 1158.9020267254466, 858.4022232303714, 927.9781159333131, 665.4321955335155, 956.3408064956715, 401.6602880976567, 1068.3473956723312, 589.4524470599866, 532.1925797173635, 1023.5415611887067, 597.5496608249966, 530.7206945384645, 941.773356231544, 807.3465073450913, 1066.515137154827, 1073.5679088229965, 881.4241897835082, 871.7207872282886, 907.0372415659021, 1058.6496755030205, 582.7106544210349, 731.5554309035119, 776.0095463446073, 914.8470172681945, 60.25890896166618, 164.25884236586526, 641.8792995974322, 344.95714790889633, 108.16510532896929, 490.2984550337655, 644.9094925650478, 857.9499642562923, 788.5552276906548, 813.0042686647053, 740.5823353922415, 882.5316953319407, 1179.4160561829622, 976.020696157585, 828.4327015869654, 975.2242437942261, 378.9457075157058, 641.741831224055, 1050.9167172994871, 974.4419203022562, 814.10396844481, 730.9809641278695, 590.5242589336588, 893.2222613629211, 736.8660525163231, 982.6575313246245, 750.2384972042242, 777.8232304241526, 676.9866603793337, 1021.590447947821, 714.3721913325901, 868.084545309005, 940.5089554189785, 791.0389027568978, 671.7890079966465, 869.2021003670015, 638.5424608431032, 1012.0158008332995, 660.7880004970943, 798.4408822603982, 747.3526215596225, 494.84598797684913, 462.9840049179132, 729.9394193699893, 767.716812621944, 540.7317205447117, 690.4582670710903, 726.6139194381192, 491.7250515062092, 488.6789709097723, 349.3567640465415, 456.8660300540238, 669.4428081625107, 210.55726135215008, 919.3748152951185, 939.1583760161639, 747.3189966633228, 706.28308114875, 596.1456305286578, 329.3250046402256, 943.7763122972342, 52.66095339996108, 963.0452818869503, 881.4904953404096, 380.7081744943708, 892.074034874786, 838.875524134128, 770.1883217475355, 834.9249256136862, 180.15895829807582, 978.3324002912345, 673.0952896847726, 899.9236564009232, 840.9746117501509, 738.0053672952956, 1093.4243889596194, 735.5703178389668, 743.1491970300302, 871.7986755226901, 827.26823604423, 704.2706360554556, 881.6765570853682, 329.9899365931548, 695.715833761446, 539.5465451075261, 551.8689792154186, 745.853554914687, 565.5465067508482, 945.2481681799262, 912.2536702305064, 1054.1766948961522, 198.6424034454295, 442.83722325186216, 826.6502811569635, 604.8655055306103, 791.3125057853636, 939.2585562205726, 760.1641241964185, 633.7843536103165, 684.8584590862722, 187.5683873444446, 828.0151278193579, 911.8519386796008, 438.0624419041738, 706.5552072551329, 757.2748597380327, 655.7279868425106, 825.5336904274974, 895.2277618132435, 755.7958889563487, 721.8703686160828, 534.1676161122866, 142.54189647204618, 28.613027366334308, 798.355448791451, 654.97750871274, 650.9144235599767, 945.4108323047566, 522.1313801839964, 424.9042003325424, 1046.6675418788543, 849.8055881184446, 489.4186415184165, 380.710053100186, 610.6492860887591, 727.3244826041544, 594.5902508134275, 718.958052917223, 530.496379137762, 664.8891624164494, 699.9150778855213, 643.0650896179842, 761.1603885378661, 652.7605744488721, 648.3478081160438, 500.8175463191776, 744.3416032264364, 695.8434534773438, 794.0332860075043, 494.1067580844259, 700.086602562223, 628.5600812390502, 769.5584719072594, 395.70612152094105, 701.0394198581045, 510.0464756670473, 715.9545850534923, 764.6016412325971, 673.7392741855355, 577.8791088929987]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.9975865820385454, "mean_inference_ms": 4.402530822163997, "mean_action_processing_ms": 1.7407798601441118, "mean_env_wait_ms": 12.282597139064938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017232298851013184, "StateBufferConnector_ms": 0.005153179168701172, "ViewRequirementAgentConnector_ms": 0.138619065284729}, "num_episodes": 8, "episode_return_max": 1150.4215974239341, "episode_return_min": -22.50571797559193, "episode_return_mean": 251.3530708318151, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.45035472751877, "num_env_steps_trained_throughput_per_sec": 156.45035472751877, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 25759.264, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25759.045, "sample_time_ms": 2398.226, "learn_time_ms": 23335.945, "learn_throughput": 171.409, "synch_weights_time_ms": 21.363}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 54, "trial_id": "0b608_00000", "date": "2024-08-22_14-08-27", "timestamp": 1724315907, "time_this_iter_s": 25.634010076522827, "time_total_s": 1400.5984156131744, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30e415a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1400.5984156131744, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 31.51666666666667, "ram_util_percent": 82.73888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.018334695018787, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.951678854321677, "policy_loss": -0.008051283302268496, "vf_loss": 7.959091782948327, "vf_explained_var": 0.17111082505927513, "kl": 0.0063835270564865185, "entropy": 0.29226131208989986, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51503.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.55684383861602, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.580522333377253, "policy_loss": -0.010833642617479046, "vf_loss": 7.589851409165317, "vf_explained_var": 0.6184267768784175, "kl": 0.0075228998329115926, "entropy": 0.5379852143545, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51503.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 1150.4215974239341, "episode_reward_min": -22.50571797559193, "episode_reward_mean": 264.4368766533207, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1199.2140253490095, "predator_policy": 28.613027366334308}, "policy_reward_max": {"prey_policy": 379.94185724661145, "predator_policy": 1199.2140253490095}, "policy_reward_mean": {"prey_policy": -574.3850939831497, "predator_policy": 706.6035323098104}, "custom_metrics": {}, "hist_stats": {"episode_reward": [719.2700351681, 0.6999999999999982, -0.32015301559163456, -5.301264965872615, 156.2089424335749, -5.329070518200751e-15, 78.248760163328, 307.47163330889566, 232.64621791598682, 405.5981450612816, 652.3743689571353, 10.64171439658251, 0.10000000000000031, 4.300000000000001, 1.999999999999997, 115.64451292049517, 1.1315392950974799, 289.89999999999884, 540.3617500095523, 235.8007041492604, 83.5592273895888, -0.12371328526905989, 976.9119840619019, -22.50571797559193, 4.440892098500626e-16, 301.8791868147667, 12.399999999999999, 552.2469238571779, 311.414690864496, 576.1998236161738, 25.49522593173306, 37.450062957345104, 19.857302689392924, 55.700000000000045, 227.3382096601433, 22.560030076277073, 43.517404530650694, 435.26547281821587, 49.765415700120755, 392.15349699773077, 450.2574535900942, 497.9558343088777, 562.7702266311575, 165.104452261607, 668.9891027238638, 398.90544983731115, 20.915368912377623, 228.7035443990689, 957.3294937160558, 428.83810208782427, 98.49999999999997, 22.684625928145223, 3.2053558635682258, 817.7020485599398, -4.203578645604483, 28.061496055565826, -4.9815561015035765, 37.57065522954305, 267.8039100505928, 163.1930357996359, 40.09001839434966, 1150.4215974239341, 62.815528341286594, 61.98370811494342, 406.18339114494876, 157.18938702011172, 288.12400274763826, 84.50000000000001, 304.35428257815306, 39.699999999999996, 409.36550068371906, 377.56854157091925, 196.38031350519933, 68.5000000000004, 96.69696304064716, 151.83342148032241, 375.2441643356955, -0.49747145883548605, 645.167949163576, 885.4740546023669, 894.0867765136334, 624.6563334059294, 798.1871898558131, 54.1875192454019, 623.3165771651677, 163.80772798210472, 364.2257990679377, 4.262565385453451, 190.66840698235552, 27.54331008971744, 336.7491185810801, 615.258629939319, -3.552713678800501e-15, 8.853577982120804, 549.8886421747661, 80.68033391665715, 416.76643652703217, 126.24370857472394, 405.076828726246, 700.965876816839], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-802.1129768214523, 165.68989333179448, -964.8471801587802, -855.6538430651397, -1199.2140253490095, -983.9526719459352, -1038.9620174666434, -955.7875200562529, -364.2958947439972, -860.7175090783647, -1158.9020267254466, -858.4022232303714, -1054.1780610247836, -460.98349027872047, -96.31910060872644, -954.210360675706, -341.8643244448935, -1083.28930037143, -65.04218815419509, -1085.0938076905932, -694.5223930455571, 218.6264066392309, -896.9088544573955, -841.5692947226568, -1066.4151371548269, -1073.5679088229965, -881.4241897835082, -867.4207872282888, -905.0372415659021, -1058.6496755030205, -430.2556660352729, -768.3659063687718, -775.2095463446071, -914.5154779730971, -12.935670636391812, 78.31791930886055, 314.04491019868686, -760.5196076954619, 110.69985612535989, -473.36271233883394, -992.047510293264, -427.2527191384847, -788.8789409759238, -812.8042686647052, 326.84320830388515, -973.0452549661647, -1082.103322703885, -1095.8391476122542, -828.4327015869654, -975.2242437942261, -254.8048964584474, -464.00345546654825, -1038.816717299487, -974.1419203022563, -453.60152740389697, -539.2364813116042, -894.4322534840139, -277.8995759480701, -867.7602927287161, -275.5634674960537, -801.156989633418, -701.409512063225, -639.8365974219873, -1021.2904479478209, -701.9471031014613, -860.6523308507406, -939.8089554189786, -736.0389027568975, -361.9361796317842, -951.7167190717195, -620.3462682608337, -1007.6519633392903, -648.4795049109764, -767.2319733158648, -866.6257659205735, 59.69262920231512, -836.0687532370777, -307.08925535069943, -823.2309868062986, -93.06404936263088, -808.6185116205252, -158.19622129858942, 167.57296420238862, -650.02115230949, -391.03852132837665, 147.58595385896905, -662.9801642931858, -51.91545295986659, -76.96538150290277, -1112.5787070845126, -878.5246788679054, -176.17194910686, -859.1622749567109, -45.39299129979647, -717.9408725371821, -49.79284876094222, 197.40968656973197, -1084.615970081035, 53.84441976133593, -897.7885270426684, -838.775524134128, -671.7883217475354, -904.1296595556089, -88.26959842800939, -978.3324002912345, -669.8899338212037, 105.66344330870278, -1028.8596628998423, -749.818646886714, -1085.8146880138056, -705.4724775354946, -745.1855412779336, -881.9485015746708, -822.0999660937538, -703.7506806685905, -844.6258572426902, 1.8524883742487852, -759.7543486782574, -784.8779784934914, -143.34451002981913, -501.0019149444163, -770.3081283267647, -1003.8909051332041, 296.81066414670966, -177.98717986289574, -1012.0163901374008, -364.1359098337468, -843.3678864601354, -188.45981119189983, -801.5348089791286, -948.4986428675579, -593.7346505293199, -859.2235948526683, -171.29521509628452, -104.46838734444557, -826.6151278193578, -995.574176048659, -49.985921956960176, -705.6552072551328, -718.4748597380328, -240.1524254541731, -831.743751132115, -789.2229043890054, -484.23220480966296, -778.0677144761992, -281.58995674696456, -111.44189647204587, 8.786972633665817, -636.3185337269166, -720.3174607366267, -447.77528144148044, -996.7165529429294, -182.14768215739787, -389.64373402344717, -1044.2796737196538, -852.6909277364806, 345.6645174819379, -570.6252629369636, 339.03323481115467, -791.5329489016997, 379.94185724661145, -799.4033844636299, 221.06453693940003, -791.7937450876865, -727.9506546050003, 183.15767695730943, -730.3332850434823, -629.4001586978513, -171.13042827242717, -354.7183489976295, -579.8775594749623, -696.4997692467128, -517.4942988464595, -406.4199461775335, -698.1709917162531, -626.2131266995658, -256.7351419103198, -717.8610445355195, -450.36295199764925, -733.1796334377858, -335.3082985169226, -808.4988091880805, 50.45331851424319, -686.8130716534583, -871.6023094786115, -1165.5266108457952, -888.488927630698, -599.3734005198695, -85.41749438046685, -737.6359285694708, -262.94658189570566, -526.7577629757747, -234.94004357412837, -779.7332258354802, -208.77941713779683, -99.34738270637678, -602.7219271713811, 142.80803052938538, -833.361303834366, -58.63671974164953], "policy_predator_policy_reward": [704.8919845909573, 650.8011340667994, 965.5471801587804, 855.6538430651397, 1199.2140253490095, 983.6325189303435, 950.4862550903802, 1038.9620174666434, 532.3026122310682, 848.9197340248702, 1158.9020267254466, 858.4022232303714, 927.9781159333131, 665.4321955335155, 956.3408064956715, 401.6602880976567, 1068.3473956723312, 589.4524470599866, 532.1925797173635, 1023.5415611887067, 597.5496608249966, 530.7206945384645, 941.773356231544, 807.3465073450913, 1066.515137154827, 1073.5679088229965, 881.4241897835082, 871.7207872282886, 907.0372415659021, 1058.6496755030205, 582.7106544210349, 731.5554309035119, 776.0095463446073, 914.8470172681945, 60.25890896166618, 164.25884236586526, 641.8792995974322, 344.95714790889633, 108.16510532896929, 490.2984550337655, 644.9094925650478, 857.9499642562923, 788.5552276906548, 813.0042686647053, 740.5823353922415, 882.5316953319407, 1179.4160561829622, 976.020696157585, 828.4327015869654, 975.2242437942261, 378.9457075157058, 641.741831224055, 1050.9167172994871, 974.4419203022562, 814.10396844481, 730.9809641278695, 590.5242589336588, 893.2222613629211, 736.8660525163231, 982.6575313246245, 750.2384972042242, 777.8232304241526, 676.9866603793337, 1021.590447947821, 714.3721913325901, 868.084545309005, 940.5089554189785, 791.0389027568978, 671.7890079966465, 869.2021003670015, 638.5424608431032, 1012.0158008332995, 660.7880004970943, 798.4408822603982, 747.3526215596225, 494.84598797684913, 462.9840049179132, 729.9394193699893, 767.716812621944, 540.7317205447117, 690.4582670710903, 726.6139194381192, 491.7250515062092, 488.6789709097723, 349.3567640465415, 456.8660300540238, 669.4428081625107, 210.55726135215008, 919.3748152951185, 939.1583760161639, 747.3189966633228, 706.28308114875, 596.1456305286578, 329.3250046402256, 943.7763122972342, 52.66095339996108, 963.0452818869503, 881.4904953404096, 380.7081744943708, 892.074034874786, 838.875524134128, 770.1883217475355, 834.9249256136862, 180.15895829807582, 978.3324002912345, 673.0952896847726, 899.9236564009232, 840.9746117501509, 738.0053672952956, 1093.4243889596194, 735.5703178389668, 743.1491970300302, 871.7986755226901, 827.26823604423, 704.2706360554556, 881.6765570853682, 329.9899365931548, 695.715833761446, 539.5465451075261, 551.8689792154186, 745.853554914687, 565.5465067508482, 945.2481681799262, 912.2536702305064, 1054.1766948961522, 198.6424034454295, 442.83722325186216, 826.6502811569635, 604.8655055306103, 791.3125057853636, 939.2585562205726, 760.1641241964185, 633.7843536103165, 684.8584590862722, 187.5683873444446, 828.0151278193579, 911.8519386796008, 438.0624419041738, 706.5552072551329, 757.2748597380327, 655.7279868425106, 825.5336904274974, 895.2277618132435, 755.7958889563487, 721.8703686160828, 534.1676161122866, 142.54189647204618, 28.613027366334308, 798.355448791451, 654.97750871274, 650.9144235599767, 945.4108323047566, 522.1313801839964, 424.9042003325424, 1046.6675418788543, 849.8055881184446, 489.4186415184165, 380.710053100186, 610.6492860887591, 727.3244826041544, 594.5902508134275, 718.958052917223, 530.496379137762, 664.8891624164494, 699.9150778855213, 643.0650896179842, 761.1603885378661, 652.7605744488721, 648.3478081160438, 500.8175463191776, 744.3416032264364, 695.8434534773438, 794.0332860075043, 494.1067580844259, 700.086602562223, 628.5600812390502, 769.5584719072594, 395.70612152094105, 701.0394198581045, 510.0464756670473, 715.9545850534923, 764.6016412325971, 673.7392741855355, 577.8791088929987, 871.6023094786115, 1165.5266108457952, 897.5884399475796, 599.1274661851097, 690.946090362982, 681.9959747617197, 276.9610270447192, 593.4236517434204, 685.4257279073074, 746.0139780293324, 387.3054854203903, 47.065022998507246, 263.1601968820608, 601.8305284861761, 708.3465033702676, 884.6173970225867]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.998124644985584, "mean_inference_ms": 4.3961987777649565, "mean_action_processing_ms": 1.733191551018925, "mean_env_wait_ms": 12.296572520989839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01717519760131836, "StateBufferConnector_ms": 0.00513303279876709, "ViewRequirementAgentConnector_ms": 0.13052189350128174}, "num_episodes": 8, "episode_return_max": 1150.4215974239341, "episode_return_min": -22.50571797559193, "episode_return_mean": 264.4368766533207, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.7471369311254, "num_env_steps_trained_throughput_per_sec": 155.7471369311254, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 25752.704, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25752.398, "sample_time_ms": 2393.44, "learn_time_ms": 23332.771, "learn_throughput": 171.433, "synch_weights_time_ms": 22.583}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 55, "trial_id": "0b608_00000", "date": "2024-08-22_14-08-53", "timestamp": 1724315933, "time_this_iter_s": 25.729795932769775, "time_total_s": 1426.3282115459442, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30e4151f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1426.3282115459442, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 33.13055555555555, "ram_util_percent": 82.88333333333337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.543595599623583, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.177690370751437, "policy_loss": -0.009552516041707898, "vf_loss": 8.18657963011, "vf_explained_var": 0.10911093527677829, "kl": 0.006632778647099499, "entropy": 0.29224810114613287, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 52448.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.46191964729753, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.019465461609856, "policy_loss": -0.008105905963078378, "vf_loss": 8.026258437847964, "vf_explained_var": 0.6311880336236702, "kl": 0.006564570002987114, "entropy": 0.5471592938458478, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 52448.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 1150.4215974239341, "episode_reward_min": -22.50571797559193, "episode_reward_mean": 274.9191224966404, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1165.5266108457952, "predator_policy": 28.613027366334308}, "policy_reward_max": {"prey_policy": 379.94185724661145, "predator_policy": 1179.4160561829622}, "policy_reward_mean": {"prey_policy": -560.375662221671, "predator_policy": 697.8352234699914}, "custom_metrics": {}, "hist_stats": {"episode_reward": [405.5981450612816, 652.3743689571353, 10.64171439658251, 0.10000000000000031, 4.300000000000001, 1.999999999999997, 115.64451292049517, 1.1315392950974799, 289.89999999999884, 540.3617500095523, 235.8007041492604, 83.5592273895888, -0.12371328526905989, 976.9119840619019, -22.50571797559193, 4.440892098500626e-16, 301.8791868147667, 12.399999999999999, 552.2469238571779, 311.414690864496, 576.1998236161738, 25.49522593173306, 37.450062957345104, 19.857302689392924, 55.700000000000045, 227.3382096601433, 22.560030076277073, 43.517404530650694, 435.26547281821587, 49.765415700120755, 392.15349699773077, 450.2574535900942, 497.9558343088777, 562.7702266311575, 165.104452261607, 668.9891027238638, 398.90544983731115, 20.915368912377623, 228.7035443990689, 957.3294937160558, 428.83810208782427, 98.49999999999997, 22.684625928145223, 3.2053558635682258, 817.7020485599398, -4.203578645604483, 28.061496055565826, -4.9815561015035765, 37.57065522954305, 267.8039100505928, 163.1930357996359, 40.09001839434966, 1150.4215974239341, 62.815528341286594, 61.98370811494342, 406.18339114494876, 157.18938702011172, 288.12400274763826, 84.50000000000001, 304.35428257815306, 39.699999999999996, 409.36550068371906, 377.56854157091925, 196.38031350519933, 68.5000000000004, 96.69696304064716, 151.83342148032241, 375.2441643356955, -0.49747145883548605, 645.167949163576, 885.4740546023669, 894.0867765136334, 624.6563334059294, 798.1871898558131, 54.1875192454019, 623.3165771651677, 163.80772798210472, 364.2257990679377, 4.262565385453451, 190.66840698235552, 27.54331008971744, 336.7491185810801, 615.258629939319, -3.552713678800501e-15, 8.853577982120804, 549.8886421747661, 80.68033391665715, 416.76643652703217, 126.24370857472394, 405.076828726246, 700.965876816839, -3.8248149545723797, 0.30000000000000426, 145.47166827494848, 603.3086261951104, 789.8000206442364, 0.18075794841748838, 748.5934906990357, 252.34168271423346, 0.9773238189854694], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-65.04218815419509, -1085.0938076905932, -694.5223930455571, 218.6264066392309, -896.9088544573955, -841.5692947226568, -1066.4151371548269, -1073.5679088229965, -881.4241897835082, -867.4207872282888, -905.0372415659021, -1058.6496755030205, -430.2556660352729, -768.3659063687718, -775.2095463446071, -914.5154779730971, -12.935670636391812, 78.31791930886055, 314.04491019868686, -760.5196076954619, 110.69985612535989, -473.36271233883394, -992.047510293264, -427.2527191384847, -788.8789409759238, -812.8042686647052, 326.84320830388515, -973.0452549661647, -1082.103322703885, -1095.8391476122542, -828.4327015869654, -975.2242437942261, -254.8048964584474, -464.00345546654825, -1038.816717299487, -974.1419203022563, -453.60152740389697, -539.2364813116042, -894.4322534840139, -277.8995759480701, -867.7602927287161, -275.5634674960537, -801.156989633418, -701.409512063225, -639.8365974219873, -1021.2904479478209, -701.9471031014613, -860.6523308507406, -939.8089554189786, -736.0389027568975, -361.9361796317842, -951.7167190717195, -620.3462682608337, -1007.6519633392903, -648.4795049109764, -767.2319733158648, -866.6257659205735, 59.69262920231512, -836.0687532370777, -307.08925535069943, -823.2309868062986, -93.06404936263088, -808.6185116205252, -158.19622129858942, 167.57296420238862, -650.02115230949, -391.03852132837665, 147.58595385896905, -662.9801642931858, -51.91545295986659, -76.96538150290277, -1112.5787070845126, -878.5246788679054, -176.17194910686, -859.1622749567109, -45.39299129979647, -717.9408725371821, -49.79284876094222, 197.40968656973197, -1084.615970081035, 53.84441976133593, -897.7885270426684, -838.775524134128, -671.7883217475354, -904.1296595556089, -88.26959842800939, -978.3324002912345, -669.8899338212037, 105.66344330870278, -1028.8596628998423, -749.818646886714, -1085.8146880138056, -705.4724775354946, -745.1855412779336, -881.9485015746708, -822.0999660937538, -703.7506806685905, -844.6258572426902, 1.8524883742487852, -759.7543486782574, -784.8779784934914, -143.34451002981913, -501.0019149444163, -770.3081283267647, -1003.8909051332041, 296.81066414670966, -177.98717986289574, -1012.0163901374008, -364.1359098337468, -843.3678864601354, -188.45981119189983, -801.5348089791286, -948.4986428675579, -593.7346505293199, -859.2235948526683, -171.29521509628452, -104.46838734444557, -826.6151278193578, -995.574176048659, -49.985921956960176, -705.6552072551328, -718.4748597380328, -240.1524254541731, -831.743751132115, -789.2229043890054, -484.23220480966296, -778.0677144761992, -281.58995674696456, -111.44189647204587, 8.786972633665817, -636.3185337269166, -720.3174607366267, -447.77528144148044, -996.7165529429294, -182.14768215739787, -389.64373402344717, -1044.2796737196538, -852.6909277364806, 345.6645174819379, -570.6252629369636, 339.03323481115467, -791.5329489016997, 379.94185724661145, -799.4033844636299, 221.06453693940003, -791.7937450876865, -727.9506546050003, 183.15767695730943, -730.3332850434823, -629.4001586978513, -171.13042827242717, -354.7183489976295, -579.8775594749623, -696.4997692467128, -517.4942988464595, -406.4199461775335, -698.1709917162531, -626.2131266995658, -256.7351419103198, -717.8610445355195, -450.36295199764925, -733.1796334377858, -335.3082985169226, -808.4988091880805, 50.45331851424319, -686.8130716534583, -871.6023094786115, -1165.5266108457952, -888.488927630698, -599.3734005198695, -85.41749438046685, -737.6359285694708, -262.94658189570566, -526.7577629757747, -234.94004357412837, -779.7332258354802, -208.77941713779683, -99.34738270637678, -602.7219271713811, 142.80803052938538, -833.361303834366, -58.63671974164953, -630.4827065339513, -985.9056690917422, -980.8502577409665, -728.3381002073714, -203.5000138152705, -817.0326263444416, -67.31423058820477, -924.291465355291, 229.5169447098878, -781.0326654097438, -852.5758418180203, -861.3413201413174, -775.4951031238925, 296.1815475719118, -1107.8685988305642, -354.9289466571434, -784.2805830213463, -736.5766440206389], "policy_predator_policy_reward": [532.1925797173635, 1023.5415611887067, 597.5496608249966, 530.7206945384645, 941.773356231544, 807.3465073450913, 1066.515137154827, 1073.5679088229965, 881.4241897835082, 871.7207872282886, 907.0372415659021, 1058.6496755030205, 582.7106544210349, 731.5554309035119, 776.0095463446073, 914.8470172681945, 60.25890896166618, 164.25884236586526, 641.8792995974322, 344.95714790889633, 108.16510532896929, 490.2984550337655, 644.9094925650478, 857.9499642562923, 788.5552276906548, 813.0042686647053, 740.5823353922415, 882.5316953319407, 1179.4160561829622, 976.020696157585, 828.4327015869654, 975.2242437942261, 378.9457075157058, 641.741831224055, 1050.9167172994871, 974.4419203022562, 814.10396844481, 730.9809641278695, 590.5242589336588, 893.2222613629211, 736.8660525163231, 982.6575313246245, 750.2384972042242, 777.8232304241526, 676.9866603793337, 1021.590447947821, 714.3721913325901, 868.084545309005, 940.5089554189785, 791.0389027568978, 671.7890079966465, 869.2021003670015, 638.5424608431032, 1012.0158008332995, 660.7880004970943, 798.4408822603982, 747.3526215596225, 494.84598797684913, 462.9840049179132, 729.9394193699893, 767.716812621944, 540.7317205447117, 690.4582670710903, 726.6139194381192, 491.7250515062092, 488.6789709097723, 349.3567640465415, 456.8660300540238, 669.4428081625107, 210.55726135215008, 919.3748152951185, 939.1583760161639, 747.3189966633228, 706.28308114875, 596.1456305286578, 329.3250046402256, 943.7763122972342, 52.66095339996108, 963.0452818869503, 881.4904953404096, 380.7081744943708, 892.074034874786, 838.875524134128, 770.1883217475355, 834.9249256136862, 180.15895829807582, 978.3324002912345, 673.0952896847726, 899.9236564009232, 840.9746117501509, 738.0053672952956, 1093.4243889596194, 735.5703178389668, 743.1491970300302, 871.7986755226901, 827.26823604423, 704.2706360554556, 881.6765570853682, 329.9899365931548, 695.715833761446, 539.5465451075261, 551.8689792154186, 745.853554914687, 565.5465067508482, 945.2481681799262, 912.2536702305064, 1054.1766948961522, 198.6424034454295, 442.83722325186216, 826.6502811569635, 604.8655055306103, 791.3125057853636, 939.2585562205726, 760.1641241964185, 633.7843536103165, 684.8584590862722, 187.5683873444446, 828.0151278193579, 911.8519386796008, 438.0624419041738, 706.5552072551329, 757.2748597380327, 655.7279868425106, 825.5336904274974, 895.2277618132435, 755.7958889563487, 721.8703686160828, 534.1676161122866, 142.54189647204618, 28.613027366334308, 798.355448791451, 654.97750871274, 650.9144235599767, 945.4108323047566, 522.1313801839964, 424.9042003325424, 1046.6675418788543, 849.8055881184446, 489.4186415184165, 380.710053100186, 610.6492860887591, 727.3244826041544, 594.5902508134275, 718.958052917223, 530.496379137762, 664.8891624164494, 699.9150778855213, 643.0650896179842, 761.1603885378661, 652.7605744488721, 648.3478081160438, 500.8175463191776, 744.3416032264364, 695.8434534773438, 794.0332860075043, 494.1067580844259, 700.086602562223, 628.5600812390502, 769.5584719072594, 395.70612152094105, 701.0394198581045, 510.0464756670473, 715.9545850534923, 764.6016412325971, 673.7392741855355, 577.8791088929987, 871.6023094786115, 1165.5266108457952, 897.5884399475796, 599.1274661851097, 690.946090362982, 681.9959747617197, 276.9610270447192, 593.4236517434204, 685.4257279073074, 746.0139780293324, 387.3054854203903, 47.065022998507246, 263.1601968820608, 601.8305284861761, 708.3465033702676, 884.6173970225867, 626.6578915793792, 985.9056690917422, 981.1502577409666, 728.3381002073714, 345.27168209021966, 820.7326263444425, 751.5690593622888, 843.3452627763082, 647.9665056382264, 693.3492357058651, 852.756599766438, 861.3413201413174, 719.0357611237139, 508.8712851273046, 1045.704759630322, 669.4344685716231, 784.5579068403318, 737.2766440206391]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.993737835151067, "mean_inference_ms": 4.403883761410336, "mean_action_processing_ms": 1.726540096714966, "mean_env_wait_ms": 12.321870728455064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01759648323059082, "StateBufferConnector_ms": 0.005574464797973633, "ViewRequirementAgentConnector_ms": 0.13620758056640625}, "num_episodes": 9, "episode_return_max": 1150.4215974239341, "episode_return_min": -22.50571797559193, "episode_return_mean": 274.9191224966404, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.6746428040166, "num_env_steps_trained_throughput_per_sec": 156.6746428040166, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 25746.479, "restore_workers_time_ms": 0.024, "training_step_time_ms": 25746.184, "sample_time_ms": 2379.026, "learn_time_ms": 23342.004, "learn_throughput": 171.365, "synch_weights_time_ms": 21.665}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 56, "trial_id": "0b608_00000", "date": "2024-08-22_14-09-19", "timestamp": 1724315959, "time_this_iter_s": 25.575273036956787, "time_total_s": 1451.903484582901, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a35c1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1451.903484582901, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 31.247222222222224, "ram_util_percent": 82.99444444444443}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.114756843021937, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.274781233166891, "policy_loss": -0.008352522510621282, "vf_loss": 8.282484463787583, "vf_explained_var": 0.1146804065300674, "kl": 0.006492864367399345, "entropy": 0.25933755716634177, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53393.0, "diff_num_grad_updates_vs_sampler_policy": 482.39499999999674}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.540852731119386, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.918468079238973, "policy_loss": -0.008425197731604966, "vf_loss": 7.925469865748491, "vf_explained_var": 0.5348652720451355, "kl": 0.007117176669891234, "entropy": 0.5193326510134197, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53393.0, "diff_num_grad_updates_vs_sampler_policy": 482.39499999999674}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 1150.4215974239341, "episode_reward_min": -22.50571797559193, "episode_reward_mean": 277.469263885021, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1170.2923326104956, "predator_policy": 28.613027366334308}, "policy_reward_max": {"prey_policy": 379.94185724661145, "predator_policy": 1179.4160561829622}, "policy_reward_mean": {"prey_policy": -558.3965609934401, "predator_policy": 697.1311929359508}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.12371328526905989, 976.9119840619019, -22.50571797559193, 4.440892098500626e-16, 301.8791868147667, 12.399999999999999, 552.2469238571779, 311.414690864496, 576.1998236161738, 25.49522593173306, 37.450062957345104, 19.857302689392924, 55.700000000000045, 227.3382096601433, 22.560030076277073, 43.517404530650694, 435.26547281821587, 49.765415700120755, 392.15349699773077, 450.2574535900942, 497.9558343088777, 562.7702266311575, 165.104452261607, 668.9891027238638, 398.90544983731115, 20.915368912377623, 228.7035443990689, 957.3294937160558, 428.83810208782427, 98.49999999999997, 22.684625928145223, 3.2053558635682258, 817.7020485599398, -4.203578645604483, 28.061496055565826, -4.9815561015035765, 37.57065522954305, 267.8039100505928, 163.1930357996359, 40.09001839434966, 1150.4215974239341, 62.815528341286594, 61.98370811494342, 406.18339114494876, 157.18938702011172, 288.12400274763826, 84.50000000000001, 304.35428257815306, 39.699999999999996, 409.36550068371906, 377.56854157091925, 196.38031350519933, 68.5000000000004, 96.69696304064716, 151.83342148032241, 375.2441643356955, -0.49747145883548605, 645.167949163576, 885.4740546023669, 894.0867765136334, 624.6563334059294, 798.1871898558131, 54.1875192454019, 623.3165771651677, 163.80772798210472, 364.2257990679377, 4.262565385453451, 190.66840698235552, 27.54331008971744, 336.7491185810801, 615.258629939319, -3.552713678800501e-15, 8.853577982120804, 549.8886421747661, 80.68033391665715, 416.76643652703217, 126.24370857472394, 405.076828726246, 700.965876816839, -3.8248149545723797, 0.30000000000000426, 145.47166827494848, 603.3086261951104, 789.8000206442364, 0.18075794841748838, 748.5934906990357, 252.34168271423346, 0.9773238189854694, 4.529181545848257, 769.0454991864949, 163.67640131003336, 239.88816316016025, 158.56745533509522, 230.22213948106318, 7.598578028402089, 20.004963145810446, 85.68041865193646, 255.52003494183788, 661.7022514000353, -0.008985169663161097], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-788.8789409759238, -812.8042686647052, 326.84320830388515, -973.0452549661647, -1082.103322703885, -1095.8391476122542, -828.4327015869654, -975.2242437942261, -254.8048964584474, -464.00345546654825, -1038.816717299487, -974.1419203022563, -453.60152740389697, -539.2364813116042, -894.4322534840139, -277.8995759480701, -867.7602927287161, -275.5634674960537, -801.156989633418, -701.409512063225, -639.8365974219873, -1021.2904479478209, -701.9471031014613, -860.6523308507406, -939.8089554189786, -736.0389027568975, -361.9361796317842, -951.7167190717195, -620.3462682608337, -1007.6519633392903, -648.4795049109764, -767.2319733158648, -866.6257659205735, 59.69262920231512, -836.0687532370777, -307.08925535069943, -823.2309868062986, -93.06404936263088, -808.6185116205252, -158.19622129858942, 167.57296420238862, -650.02115230949, -391.03852132837665, 147.58595385896905, -662.9801642931858, -51.91545295986659, -76.96538150290277, -1112.5787070845126, -878.5246788679054, -176.17194910686, -859.1622749567109, -45.39299129979647, -717.9408725371821, -49.79284876094222, 197.40968656973197, -1084.615970081035, 53.84441976133593, -897.7885270426684, -838.775524134128, -671.7883217475354, -904.1296595556089, -88.26959842800939, -978.3324002912345, -669.8899338212037, 105.66344330870278, -1028.8596628998423, -749.818646886714, -1085.8146880138056, -705.4724775354946, -745.1855412779336, -881.9485015746708, -822.0999660937538, -703.7506806685905, -844.6258572426902, 1.8524883742487852, -759.7543486782574, -784.8779784934914, -143.34451002981913, -501.0019149444163, -770.3081283267647, -1003.8909051332041, 296.81066414670966, -177.98717986289574, -1012.0163901374008, -364.1359098337468, -843.3678864601354, -188.45981119189983, -801.5348089791286, -948.4986428675579, -593.7346505293199, -859.2235948526683, -171.29521509628452, -104.46838734444557, -826.6151278193578, -995.574176048659, -49.985921956960176, -705.6552072551328, -718.4748597380328, -240.1524254541731, -831.743751132115, -789.2229043890054, -484.23220480966296, -778.0677144761992, -281.58995674696456, -111.44189647204587, 8.786972633665817, -636.3185337269166, -720.3174607366267, -447.77528144148044, -996.7165529429294, -182.14768215739787, -389.64373402344717, -1044.2796737196538, -852.6909277364806, 345.6645174819379, -570.6252629369636, 339.03323481115467, -791.5329489016997, 379.94185724661145, -799.4033844636299, 221.06453693940003, -791.7937450876865, -727.9506546050003, 183.15767695730943, -730.3332850434823, -629.4001586978513, -171.13042827242717, -354.7183489976295, -579.8775594749623, -696.4997692467128, -517.4942988464595, -406.4199461775335, -698.1709917162531, -626.2131266995658, -256.7351419103198, -717.8610445355195, -450.36295199764925, -733.1796334377858, -335.3082985169226, -808.4988091880805, 50.45331851424319, -686.8130716534583, -871.6023094786115, -1165.5266108457952, -888.488927630698, -599.3734005198695, -85.41749438046685, -737.6359285694708, -262.94658189570566, -526.7577629757747, -234.94004357412837, -779.7332258354802, -208.77941713779683, -99.34738270637678, -602.7219271713811, 142.80803052938538, -833.361303834366, -58.63671974164953, -630.4827065339513, -985.9056690917422, -980.8502577409665, -728.3381002073714, -203.5000138152705, -817.0326263444416, -67.31423058820477, -924.291465355291, 229.5169447098878, -781.0326654097438, -852.5758418180203, -861.3413201413174, -775.4951031238925, 296.1815475719118, -1107.8685988305642, -354.9289466571434, -784.2805830213463, -736.5766440206389, -724.016768856235, -715.4396279856799, 68.81637239745584, -1170.2923326104956, -432.7141214465296, -305.28461499827375, -213.36469093535712, -756.4735045059357, -527.3563743774084, -700.5708674023781, -740.2754185879201, -252.76000099579804, -759.0570538289855, -697.1415267576781, -941.8938841993842, -395.2016828852305, -549.4119910385617, -644.4789548654916, -498.1876490610334, -192.98904985466953, -968.7170459333539, -1.81364571986785, -807.0389973336308, -946.9435252523679], "policy_predator_policy_reward": [788.5552276906548, 813.0042686647053, 740.5823353922415, 882.5316953319407, 1179.4160561829622, 976.020696157585, 828.4327015869654, 975.2242437942261, 378.9457075157058, 641.741831224055, 1050.9167172994871, 974.4419203022562, 814.10396844481, 730.9809641278695, 590.5242589336588, 893.2222613629211, 736.8660525163231, 982.6575313246245, 750.2384972042242, 777.8232304241526, 676.9866603793337, 1021.590447947821, 714.3721913325901, 868.084545309005, 940.5089554189785, 791.0389027568978, 671.7890079966465, 869.2021003670015, 638.5424608431032, 1012.0158008332995, 660.7880004970943, 798.4408822603982, 747.3526215596225, 494.84598797684913, 462.9840049179132, 729.9394193699893, 767.716812621944, 540.7317205447117, 690.4582670710903, 726.6139194381192, 491.7250515062092, 488.6789709097723, 349.3567640465415, 456.8660300540238, 669.4428081625107, 210.55726135215008, 919.3748152951185, 939.1583760161639, 747.3189966633228, 706.28308114875, 596.1456305286578, 329.3250046402256, 943.7763122972342, 52.66095339996108, 963.0452818869503, 881.4904953404096, 380.7081744943708, 892.074034874786, 838.875524134128, 770.1883217475355, 834.9249256136862, 180.15895829807582, 978.3324002912345, 673.0952896847726, 899.9236564009232, 840.9746117501509, 738.0053672952956, 1093.4243889596194, 735.5703178389668, 743.1491970300302, 871.7986755226901, 827.26823604423, 704.2706360554556, 881.6765570853682, 329.9899365931548, 695.715833761446, 539.5465451075261, 551.8689792154186, 745.853554914687, 565.5465067508482, 945.2481681799262, 912.2536702305064, 1054.1766948961522, 198.6424034454295, 442.83722325186216, 826.6502811569635, 604.8655055306103, 791.3125057853636, 939.2585562205726, 760.1641241964185, 633.7843536103165, 684.8584590862722, 187.5683873444446, 828.0151278193579, 911.8519386796008, 438.0624419041738, 706.5552072551329, 757.2748597380327, 655.7279868425106, 825.5336904274974, 895.2277618132435, 755.7958889563487, 721.8703686160828, 534.1676161122866, 142.54189647204618, 28.613027366334308, 798.355448791451, 654.97750871274, 650.9144235599767, 945.4108323047566, 522.1313801839964, 424.9042003325424, 1046.6675418788543, 849.8055881184446, 489.4186415184165, 380.710053100186, 610.6492860887591, 727.3244826041544, 594.5902508134275, 718.958052917223, 530.496379137762, 664.8891624164494, 699.9150778855213, 643.0650896179842, 761.1603885378661, 652.7605744488721, 648.3478081160438, 500.8175463191776, 744.3416032264364, 695.8434534773438, 794.0332860075043, 494.1067580844259, 700.086602562223, 628.5600812390502, 769.5584719072594, 395.70612152094105, 701.0394198581045, 510.0464756670473, 715.9545850534923, 764.6016412325971, 673.7392741855355, 577.8791088929987, 871.6023094786115, 1165.5266108457952, 897.5884399475796, 599.1274661851097, 690.946090362982, 681.9959747617197, 276.9610270447192, 593.4236517434204, 685.4257279073074, 746.0139780293324, 387.3054854203903, 47.065022998507246, 263.1601968820608, 601.8305284861761, 708.3465033702676, 884.6173970225867, 626.6578915793792, 985.9056690917422, 981.1502577409666, 728.3381002073714, 345.27168209021966, 820.7326263444425, 751.5690593622888, 843.3452627763082, 647.9665056382264, 693.3492357058651, 852.756599766438, 861.3413201413174, 719.0357611237139, 508.8712851273046, 1045.704759630322, 669.4344685716231, 784.5579068403318, 737.2766440206391, 724.6167688562351, 719.3688095315284, 1034.3013976756752, 836.2200617238567, 445.065814152239, 456.60932360259784, 781.5707432361422, 428.1556153653111, 714.5359887759565, 671.9587083389242, 587.7239954594471, 635.5335636053397, 759.1711184827375, 704.6260401323282, 941.8938841993842, 415.20664603104376, 698.645135902445, 580.9262286535475, 427.8814829039654, 518.815250953578, 803.4743883532253, 828.7585547000293, 807.6463376218418, 946.3271997944942]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.990332347487368, "mean_inference_ms": 4.392913615521537, "mean_action_processing_ms": 1.7185748119511448, "mean_env_wait_ms": 12.341344758405631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017400026321411133, "StateBufferConnector_ms": 0.005591750144958496, "ViewRequirementAgentConnector_ms": 0.1377638578414917}, "num_episodes": 12, "episode_return_max": 1150.4215974239341, "episode_return_min": -22.50571797559193, "episode_return_mean": 277.469263885021, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.8498187425011, "num_env_steps_trained_throughput_per_sec": 155.8498187425011, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 25760.769, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25760.375, "sample_time_ms": 2371.989, "learn_time_ms": 23362.882, "learn_throughput": 171.212, "synch_weights_time_ms": 21.916}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 57, "trial_id": "0b608_00000", "date": "2024-08-22_14-09-45", "timestamp": 1724315985, "time_this_iter_s": 25.722442865371704, "time_total_s": 1477.6259274482727, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a35cee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1477.6259274482727, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 31.705405405405404, "ram_util_percent": 82.47837837837837}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.646180763446466, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.155719942769046, "policy_loss": -0.00720649482337413, "vf_loss": 8.162316142188178, "vf_explained_var": 0.1200578425927137, "kl": 0.0061029952391489315, "entropy": 0.27024728329408737, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 54338.0, "diff_num_grad_updates_vs_sampler_policy": 482.39499999999674}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.586121613134154, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.877958430941143, "policy_loss": -0.01109399875236685, "vf_loss": 7.887419951403582, "vf_explained_var": 0.5314493880070076, "kl": 0.008162320640539287, "entropy": 0.5234095915284737, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 54338.0, "diff_num_grad_updates_vs_sampler_policy": 482.39499999999674}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 1150.4215974239341, "episode_reward_min": -4.9815561015035765, "episode_reward_mean": 283.7500960494426, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1170.2923326104956, "predator_policy": 14.728755748391883}, "policy_reward_max": {"prey_policy": 379.94185724661145, "predator_policy": 1165.5266108457952}, "policy_reward_mean": {"prey_policy": -527.3701844509462, "predator_policy": 669.2452324756678}, "custom_metrics": {}, "hist_stats": {"episode_reward": [227.3382096601433, 22.560030076277073, 43.517404530650694, 435.26547281821587, 49.765415700120755, 392.15349699773077, 450.2574535900942, 497.9558343088777, 562.7702266311575, 165.104452261607, 668.9891027238638, 398.90544983731115, 20.915368912377623, 228.7035443990689, 957.3294937160558, 428.83810208782427, 98.49999999999997, 22.684625928145223, 3.2053558635682258, 817.7020485599398, -4.203578645604483, 28.061496055565826, -4.9815561015035765, 37.57065522954305, 267.8039100505928, 163.1930357996359, 40.09001839434966, 1150.4215974239341, 62.815528341286594, 61.98370811494342, 406.18339114494876, 157.18938702011172, 288.12400274763826, 84.50000000000001, 304.35428257815306, 39.699999999999996, 409.36550068371906, 377.56854157091925, 196.38031350519933, 68.5000000000004, 96.69696304064716, 151.83342148032241, 375.2441643356955, -0.49747145883548605, 645.167949163576, 885.4740546023669, 894.0867765136334, 624.6563334059294, 798.1871898558131, 54.1875192454019, 623.3165771651677, 163.80772798210472, 364.2257990679377, 4.262565385453451, 190.66840698235552, 27.54331008971744, 336.7491185810801, 615.258629939319, -3.552713678800501e-15, 8.853577982120804, 549.8886421747661, 80.68033391665715, 416.76643652703217, 126.24370857472394, 405.076828726246, 700.965876816839, -3.8248149545723797, 0.30000000000000426, 145.47166827494848, 603.3086261951104, 789.8000206442364, 0.18075794841748838, 748.5934906990357, 252.34168271423346, 0.9773238189854694, 4.529181545848257, 769.0454991864949, 163.67640131003336, 239.88816316016025, 158.56745533509522, 230.22213948106318, 7.598578028402089, 20.004963145810446, 85.68041865193646, 255.52003494183788, 661.7022514000353, -0.008985169663161097, 173.70989082308512, 7.504328805820434, 0.34348924408449344, 465.72477529501305, 328.69717313434313, 705.2880725886203, 156.80358298593444, 417.5387006512647, 171.31988861714873, 462.5679886251735, 14.3616197647526, 27.632913915782183, 543.5165615232553], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-361.9361796317842, -951.7167190717195, -620.3462682608337, -1007.6519633392903, -648.4795049109764, -767.2319733158648, -866.6257659205735, 59.69262920231512, -836.0687532370777, -307.08925535069943, -823.2309868062986, -93.06404936263088, -808.6185116205252, -158.19622129858942, 167.57296420238862, -650.02115230949, -391.03852132837665, 147.58595385896905, -662.9801642931858, -51.91545295986659, -76.96538150290277, -1112.5787070845126, -878.5246788679054, -176.17194910686, -859.1622749567109, -45.39299129979647, -717.9408725371821, -49.79284876094222, 197.40968656973197, -1084.615970081035, 53.84441976133593, -897.7885270426684, -838.775524134128, -671.7883217475354, -904.1296595556089, -88.26959842800939, -978.3324002912345, -669.8899338212037, 105.66344330870278, -1028.8596628998423, -749.818646886714, -1085.8146880138056, -705.4724775354946, -745.1855412779336, -881.9485015746708, -822.0999660937538, -703.7506806685905, -844.6258572426902, 1.8524883742487852, -759.7543486782574, -784.8779784934914, -143.34451002981913, -501.0019149444163, -770.3081283267647, -1003.8909051332041, 296.81066414670966, -177.98717986289574, -1012.0163901374008, -364.1359098337468, -843.3678864601354, -188.45981119189983, -801.5348089791286, -948.4986428675579, -593.7346505293199, -859.2235948526683, -171.29521509628452, -104.46838734444557, -826.6151278193578, -995.574176048659, -49.985921956960176, -705.6552072551328, -718.4748597380328, -240.1524254541731, -831.743751132115, -789.2229043890054, -484.23220480966296, -778.0677144761992, -281.58995674696456, -111.44189647204587, 8.786972633665817, -636.3185337269166, -720.3174607366267, -447.77528144148044, -996.7165529429294, -182.14768215739787, -389.64373402344717, -1044.2796737196538, -852.6909277364806, 345.6645174819379, -570.6252629369636, 339.03323481115467, -791.5329489016997, 379.94185724661145, -799.4033844636299, 221.06453693940003, -791.7937450876865, -727.9506546050003, 183.15767695730943, -730.3332850434823, -629.4001586978513, -171.13042827242717, -354.7183489976295, -579.8775594749623, -696.4997692467128, -517.4942988464595, -406.4199461775335, -698.1709917162531, -626.2131266995658, -256.7351419103198, -717.8610445355195, -450.36295199764925, -733.1796334377858, -335.3082985169226, -808.4988091880805, 50.45331851424319, -686.8130716534583, -871.6023094786115, -1165.5266108457952, -888.488927630698, -599.3734005198695, -85.41749438046685, -737.6359285694708, -262.94658189570566, -526.7577629757747, -234.94004357412837, -779.7332258354802, -208.77941713779683, -99.34738270637678, -602.7219271713811, 142.80803052938538, -833.361303834366, -58.63671974164953, -630.4827065339513, -985.9056690917422, -980.8502577409665, -728.3381002073714, -203.5000138152705, -817.0326263444416, -67.31423058820477, -924.291465355291, 229.5169447098878, -781.0326654097438, -852.5758418180203, -861.3413201413174, -775.4951031238925, 296.1815475719118, -1107.8685988305642, -354.9289466571434, -784.2805830213463, -736.5766440206389, -724.016768856235, -715.4396279856799, 68.81637239745584, -1170.2923326104956, -432.7141214465296, -305.28461499827375, -213.36469093535712, -756.4735045059357, -527.3563743774084, -700.5708674023781, -740.2754185879201, -252.76000099579804, -759.0570538289855, -697.1415267576781, -941.8938841993842, -395.2016828852305, -549.4119910385617, -644.4789548654916, -498.1876490610334, -192.98904985466953, -968.7170459333539, -1.81364571986785, -807.0389973336308, -946.9435252523679, -361.76911135214834, -817.8431123802353, -855.0175256191271, -661.6632136949746, -609.8999489140667, -831.2690201479776, -149.71167814150738, -224.60383811656706, -322.0161685874548, -802.3384224870604, 318.0279253009585, -554.8522443804746, -422.2801257103992, -626.3646984402017, -726.2637370091026, -200.946183142154, -577.0565558351032, 148.2524193327533, -107.60997486578334, -1009.9900257084648, -706.6044316913432, -734.9156268410587, -641.1115474893597, -762.2329186775512, -512.8916787891549, 286.36065279247225], "policy_predator_policy_reward": [671.7890079966465, 869.2021003670015, 638.5424608431032, 1012.0158008332995, 660.7880004970943, 798.4408822603982, 747.3526215596225, 494.84598797684913, 462.9840049179132, 729.9394193699893, 767.716812621944, 540.7317205447117, 690.4582670710903, 726.6139194381192, 491.7250515062092, 488.6789709097723, 349.3567640465415, 456.8660300540238, 669.4428081625107, 210.55726135215008, 919.3748152951185, 939.1583760161639, 747.3189966633228, 706.28308114875, 596.1456305286578, 329.3250046402256, 943.7763122972342, 52.66095339996108, 963.0452818869503, 881.4904953404096, 380.7081744943708, 892.074034874786, 838.875524134128, 770.1883217475355, 834.9249256136862, 180.15895829807582, 978.3324002912345, 673.0952896847726, 899.9236564009232, 840.9746117501509, 738.0053672952956, 1093.4243889596194, 735.5703178389668, 743.1491970300302, 871.7986755226901, 827.26823604423, 704.2706360554556, 881.6765570853682, 329.9899365931548, 695.715833761446, 539.5465451075261, 551.8689792154186, 745.853554914687, 565.5465067508482, 945.2481681799262, 912.2536702305064, 1054.1766948961522, 198.6424034454295, 442.83722325186216, 826.6502811569635, 604.8655055306103, 791.3125057853636, 939.2585562205726, 760.1641241964185, 633.7843536103165, 684.8584590862722, 187.5683873444446, 828.0151278193579, 911.8519386796008, 438.0624419041738, 706.5552072551329, 757.2748597380327, 655.7279868425106, 825.5336904274974, 895.2277618132435, 755.7958889563487, 721.8703686160828, 534.1676161122866, 142.54189647204618, 28.613027366334308, 798.355448791451, 654.97750871274, 650.9144235599767, 945.4108323047566, 522.1313801839964, 424.9042003325424, 1046.6675418788543, 849.8055881184446, 489.4186415184165, 380.710053100186, 610.6492860887591, 727.3244826041544, 594.5902508134275, 718.958052917223, 530.496379137762, 664.8891624164494, 699.9150778855213, 643.0650896179842, 761.1603885378661, 652.7605744488721, 648.3478081160438, 500.8175463191776, 744.3416032264364, 695.8434534773438, 794.0332860075043, 494.1067580844259, 700.086602562223, 628.5600812390502, 769.5584719072594, 395.70612152094105, 701.0394198581045, 510.0464756670473, 715.9545850534923, 764.6016412325971, 673.7392741855355, 577.8791088929987, 871.6023094786115, 1165.5266108457952, 897.5884399475796, 599.1274661851097, 690.946090362982, 681.9959747617197, 276.9610270447192, 593.4236517434204, 685.4257279073074, 746.0139780293324, 387.3054854203903, 47.065022998507246, 263.1601968820608, 601.8305284861761, 708.3465033702676, 884.6173970225867, 626.6578915793792, 985.9056690917422, 981.1502577409666, 728.3381002073714, 345.27168209021966, 820.7326263444425, 751.5690593622888, 843.3452627763082, 647.9665056382264, 693.3492357058651, 852.756599766438, 861.3413201413174, 719.0357611237139, 508.8712851273046, 1045.704759630322, 669.4344685716231, 784.5579068403318, 737.2766440206391, 724.6167688562351, 719.3688095315284, 1034.3013976756752, 836.2200617238567, 445.065814152239, 456.60932360259784, 781.5707432361422, 428.1556153653111, 714.5359887759565, 671.9587083389242, 587.7239954594471, 635.5335636053397, 759.1711184827375, 704.6260401323282, 941.8938841993842, 415.20664603104376, 698.645135902445, 580.9262286535475, 427.8814829039654, 518.815250953578, 803.4743883532253, 828.7585547000293, 807.6463376218418, 946.3271997944942, 874.7342859813414, 478.58782857412746, 868.8194569788024, 655.3656111411224, 609.8615695251186, 831.65088878101, 302.53513203763924, 537.5051595154482, 656.9054595266199, 796.146304682242, 427.46729483450275, 514.645096833634, 616.259599425526, 589.1888077110113, 680.8248213684155, 663.9237994341016, 14.728755748391883, 585.3952693711084, 681.268267686404, 898.8997215130115, 716.9660514560969, 738.9156268410588, 644.8769564995115, 786.1004235831816, 294.57241172110025, 475.47517579883913]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.999694310650512, "mean_inference_ms": 4.393033138375221, "mean_action_processing_ms": 1.7132895690761591, "mean_env_wait_ms": 12.37857126412118, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004752755165100098, "StateBufferConnector_ms": 0.007379055023193359, "ViewRequirementAgentConnector_ms": 0.1479198932647705}, "num_episodes": 13, "episode_return_max": 1150.4215974239341, "episode_return_min": -4.9815561015035765, "episode_return_mean": 283.7500960494426, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.53672888596074, "num_env_steps_trained_throughput_per_sec": 153.53672888596074, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 25792.392, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25792.003, "sample_time_ms": 2430.8, "learn_time_ms": 23337.018, "learn_throughput": 171.402, "synch_weights_time_ms": 20.731}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 58, "trial_id": "0b608_00000", "date": "2024-08-22_14-10-11", "timestamp": 1724316011, "time_this_iter_s": 26.11051106452942, "time_total_s": 1503.7364385128021, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30e3d8c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1503.7364385128021, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 33.86666666666667, "ram_util_percent": 83.15833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.404582459586006, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.37689200305434, "policy_loss": -0.008110361647048089, "vf_loss": 8.38442615125545, "vf_explained_var": 0.1575957119149506, "kl": 0.005762036233430817, "entropy": 0.26058127213092075, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55283.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.95665473029727, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.217728537100333, "policy_loss": -0.008576486359483429, "vf_loss": 8.224756436120897, "vf_explained_var": 0.45019962037051164, "kl": 0.007742960201379247, "entropy": 0.5125505740365023, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55283.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "env_runners": {"episode_reward_max": 1150.4215974239341, "episode_reward_min": -37.16610958587709, "episode_reward_mean": 274.75311073475365, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1170.2923326104956, "predator_policy": 14.728755748391883}, "policy_reward_max": {"prey_policy": 379.94185724661145, "predator_policy": 1165.5266108457952}, "policy_reward_mean": {"prey_policy": -531.9756917516751, "predator_policy": 669.3522471190521}, "custom_metrics": {}, "hist_stats": {"episode_reward": [957.3294937160558, 428.83810208782427, 98.49999999999997, 22.684625928145223, 3.2053558635682258, 817.7020485599398, -4.203578645604483, 28.061496055565826, -4.9815561015035765, 37.57065522954305, 267.8039100505928, 163.1930357996359, 40.09001839434966, 1150.4215974239341, 62.815528341286594, 61.98370811494342, 406.18339114494876, 157.18938702011172, 288.12400274763826, 84.50000000000001, 304.35428257815306, 39.699999999999996, 409.36550068371906, 377.56854157091925, 196.38031350519933, 68.5000000000004, 96.69696304064716, 151.83342148032241, 375.2441643356955, -0.49747145883548605, 645.167949163576, 885.4740546023669, 894.0867765136334, 624.6563334059294, 798.1871898558131, 54.1875192454019, 623.3165771651677, 163.80772798210472, 364.2257990679377, 4.262565385453451, 190.66840698235552, 27.54331008971744, 336.7491185810801, 615.258629939319, -3.552713678800501e-15, 8.853577982120804, 549.8886421747661, 80.68033391665715, 416.76643652703217, 126.24370857472394, 405.076828726246, 700.965876816839, -3.8248149545723797, 0.30000000000000426, 145.47166827494848, 603.3086261951104, 789.8000206442364, 0.18075794841748838, 748.5934906990357, 252.34168271423346, 0.9773238189854694, 4.529181545848257, 769.0454991864949, 163.67640131003336, 239.88816316016025, 158.56745533509522, 230.22213948106318, 7.598578028402089, 20.004963145810446, 85.68041865193646, 255.52003494183788, 661.7022514000353, -0.008985169663161097, 173.70989082308512, 7.504328805820434, 0.34348924408449344, 465.72477529501305, 328.69717313434313, 705.2880725886203, 156.80358298593444, 417.5387006512647, 171.31988861714873, 462.5679886251735, 14.3616197647526, 27.632913915782183, 543.5165615232553, 573.3823520786726, 195.13863770661158, 200.73989841795495, 611.5378194471853, 5.713253459832041, 509.76978241711237, 46.29589130421314, -37.16610958587709, 9.298113114448082, 434.66542334579276, 150.0598056703133, 22.999999999999986, 505.9789413571838, 36.089122245157924], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [197.40968656973197, -1084.615970081035, 53.84441976133593, -897.7885270426684, -838.775524134128, -671.7883217475354, -904.1296595556089, -88.26959842800939, -978.3324002912345, -669.8899338212037, 105.66344330870278, -1028.8596628998423, -749.818646886714, -1085.8146880138056, -705.4724775354946, -745.1855412779336, -881.9485015746708, -822.0999660937538, -703.7506806685905, -844.6258572426902, 1.8524883742487852, -759.7543486782574, -784.8779784934914, -143.34451002981913, -501.0019149444163, -770.3081283267647, -1003.8909051332041, 296.81066414670966, -177.98717986289574, -1012.0163901374008, -364.1359098337468, -843.3678864601354, -188.45981119189983, -801.5348089791286, -948.4986428675579, -593.7346505293199, -859.2235948526683, -171.29521509628452, -104.46838734444557, -826.6151278193578, -995.574176048659, -49.985921956960176, -705.6552072551328, -718.4748597380328, -240.1524254541731, -831.743751132115, -789.2229043890054, -484.23220480966296, -778.0677144761992, -281.58995674696456, -111.44189647204587, 8.786972633665817, -636.3185337269166, -720.3174607366267, -447.77528144148044, -996.7165529429294, -182.14768215739787, -389.64373402344717, -1044.2796737196538, -852.6909277364806, 345.6645174819379, -570.6252629369636, 339.03323481115467, -791.5329489016997, 379.94185724661145, -799.4033844636299, 221.06453693940003, -791.7937450876865, -727.9506546050003, 183.15767695730943, -730.3332850434823, -629.4001586978513, -171.13042827242717, -354.7183489976295, -579.8775594749623, -696.4997692467128, -517.4942988464595, -406.4199461775335, -698.1709917162531, -626.2131266995658, -256.7351419103198, -717.8610445355195, -450.36295199764925, -733.1796334377858, -335.3082985169226, -808.4988091880805, 50.45331851424319, -686.8130716534583, -871.6023094786115, -1165.5266108457952, -888.488927630698, -599.3734005198695, -85.41749438046685, -737.6359285694708, -262.94658189570566, -526.7577629757747, -234.94004357412837, -779.7332258354802, -208.77941713779683, -99.34738270637678, -602.7219271713811, 142.80803052938538, -833.361303834366, -58.63671974164953, -630.4827065339513, -985.9056690917422, -980.8502577409665, -728.3381002073714, -203.5000138152705, -817.0326263444416, -67.31423058820477, -924.291465355291, 229.5169447098878, -781.0326654097438, -852.5758418180203, -861.3413201413174, -775.4951031238925, 296.1815475719118, -1107.8685988305642, -354.9289466571434, -784.2805830213463, -736.5766440206389, -724.016768856235, -715.4396279856799, 68.81637239745584, -1170.2923326104956, -432.7141214465296, -305.28461499827375, -213.36469093535712, -756.4735045059357, -527.3563743774084, -700.5708674023781, -740.2754185879201, -252.76000099579804, -759.0570538289855, -697.1415267576781, -941.8938841993842, -395.2016828852305, -549.4119910385617, -644.4789548654916, -498.1876490610334, -192.98904985466953, -968.7170459333539, -1.81364571986785, -807.0389973336308, -946.9435252523679, -361.76911135214834, -817.8431123802353, -855.0175256191271, -661.6632136949746, -609.8999489140667, -831.2690201479776, -149.71167814150738, -224.60383811656706, -322.0161685874548, -802.3384224870604, 318.0279253009585, -554.8522443804746, -422.2801257103992, -626.3646984402017, -726.2637370091026, -200.946183142154, -577.0565558351032, 148.2524193327533, -107.60997486578334, -1009.9900257084648, -706.6044316913432, -734.9156268410587, -641.1115474893597, -762.2329186775512, -512.8916787891549, 286.36065279247225, 104.44400448800634, -721.533121160054, -682.2317405908904, -401.4434875731894, -811.3484500994535, -347.40592179208863, 105.31432764953047, -379.78921146509936, -788.786533937902, -867.0185731278533, -781.8515183658778, -87.02154379399946, -759.9363561209102, -713.5468000500701, -536.5393765900068, -238.17601793129816, -808.4553395459135, -557.5260667828675, -849.3311069612403, -41.75063692115775, -965.2018858990067, -384.9876914510576, -692.0311095394119, -578.0044721147151, 119.94359400797948, -736.6443390005347, -598.0066058857209, -470.1250794618713], "policy_predator_policy_reward": [963.0452818869503, 881.4904953404096, 380.7081744943708, 892.074034874786, 838.875524134128, 770.1883217475355, 834.9249256136862, 180.15895829807582, 978.3324002912345, 673.0952896847726, 899.9236564009232, 840.9746117501509, 738.0053672952956, 1093.4243889596194, 735.5703178389668, 743.1491970300302, 871.7986755226901, 827.26823604423, 704.2706360554556, 881.6765570853682, 329.9899365931548, 695.715833761446, 539.5465451075261, 551.8689792154186, 745.853554914687, 565.5465067508482, 945.2481681799262, 912.2536702305064, 1054.1766948961522, 198.6424034454295, 442.83722325186216, 826.6502811569635, 604.8655055306103, 791.3125057853636, 939.2585562205726, 760.1641241964185, 633.7843536103165, 684.8584590862722, 187.5683873444446, 828.0151278193579, 911.8519386796008, 438.0624419041738, 706.5552072551329, 757.2748597380327, 655.7279868425106, 825.5336904274974, 895.2277618132435, 755.7958889563487, 721.8703686160828, 534.1676161122866, 142.54189647204618, 28.613027366334308, 798.355448791451, 654.97750871274, 650.9144235599767, 945.4108323047566, 522.1313801839964, 424.9042003325424, 1046.6675418788543, 849.8055881184446, 489.4186415184165, 380.710053100186, 610.6492860887591, 727.3244826041544, 594.5902508134275, 718.958052917223, 530.496379137762, 664.8891624164494, 699.9150778855213, 643.0650896179842, 761.1603885378661, 652.7605744488721, 648.3478081160438, 500.8175463191776, 744.3416032264364, 695.8434534773438, 794.0332860075043, 494.1067580844259, 700.086602562223, 628.5600812390502, 769.5584719072594, 395.70612152094105, 701.0394198581045, 510.0464756670473, 715.9545850534923, 764.6016412325971, 673.7392741855355, 577.8791088929987, 871.6023094786115, 1165.5266108457952, 897.5884399475796, 599.1274661851097, 690.946090362982, 681.9959747617197, 276.9610270447192, 593.4236517434204, 685.4257279073074, 746.0139780293324, 387.3054854203903, 47.065022998507246, 263.1601968820608, 601.8305284861761, 708.3465033702676, 884.6173970225867, 626.6578915793792, 985.9056690917422, 981.1502577409666, 728.3381002073714, 345.27168209021966, 820.7326263444425, 751.5690593622888, 843.3452627763082, 647.9665056382264, 693.3492357058651, 852.756599766438, 861.3413201413174, 719.0357611237139, 508.8712851273046, 1045.704759630322, 669.4344685716231, 784.5579068403318, 737.2766440206391, 724.6167688562351, 719.3688095315284, 1034.3013976756752, 836.2200617238567, 445.065814152239, 456.60932360259784, 781.5707432361422, 428.1556153653111, 714.5359887759565, 671.9587083389242, 587.7239954594471, 635.5335636053397, 759.1711184827375, 704.6260401323282, 941.8938841993842, 415.20664603104376, 698.645135902445, 580.9262286535475, 427.8814829039654, 518.815250953578, 803.4743883532253, 828.7585547000293, 807.6463376218418, 946.3271997944942, 874.7342859813414, 478.58782857412746, 868.8194569788024, 655.3656111411224, 609.8615695251186, 831.65088878101, 302.53513203763924, 537.5051595154482, 656.9054595266199, 796.146304682242, 427.46729483450275, 514.645096833634, 616.259599425526, 589.1888077110113, 680.8248213684155, 663.9237994341016, 14.728755748391883, 585.3952693711084, 681.268267686404, 898.8997215130115, 716.9660514560969, 738.9156268410588, 644.8769564995115, 786.1004235831816, 294.57241172110025, 475.47517579883913, 540.4098945025061, 650.0615742482127, 570.4150806977956, 708.3987851728981, 528.61845482513, 830.8758154843676, 301.00479658363423, 585.0079066791205, 794.4997873977342, 867.0185731278533, 693.4880744980696, 685.1547700789158, 760.1229555950308, 759.6560918801631, 464.90486808865694, 272.6444168467733, 808.4553395459135, 566.8241798973148, 734.4120921521579, 591.3350750760366, 965.2018858990067, 535.0474971213707, 698.5311095394134, 594.5044721147159, 420.0954880549246, 702.5841982948141, 463.0017016527683, 641.2191059399876]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.003175069970874, "mean_inference_ms": 4.404295204536947, "mean_action_processing_ms": 1.704725439221246, "mean_env_wait_ms": 12.412687898354365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004494071006774902, "StateBufferConnector_ms": 0.011337637901306152, "ViewRequirementAgentConnector_ms": 0.15255117416381836}, "num_episodes": 14, "episode_return_max": 1150.4215974239341, "episode_return_min": -37.16610958587709, "episode_return_mean": 274.75311073475365, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 152.8009895059577, "num_env_steps_trained_throughput_per_sec": 152.8009895059577, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 25791.155, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25790.741, "sample_time_ms": 2439.107, "learn_time_ms": 23326.996, "learn_throughput": 171.475, "synch_weights_time_ms": 21.115}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "training_iteration": 59, "trial_id": "0b608_00000", "date": "2024-08-22_14-10-37", "timestamp": 1724316037, "time_this_iter_s": 26.23880124092102, "time_total_s": 1529.9752397537231, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30e415670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1529.9752397537231, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 33.85, "ram_util_percent": 82.80526315789473}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.42383251568628, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.343772975982182, "policy_loss": -0.009331206311151464, "vf_loss": 8.352460423222295, "vf_explained_var": -0.04299273074619354, "kl": 0.006437735672591737, "entropy": 0.25294632104338793, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 56228.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.018222339569576, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.132615821575992, "policy_loss": -0.00711144862607831, "vf_loss": 8.138528039720324, "vf_explained_var": 0.48260250766441304, "kl": 0.005995891371091444, "entropy": 0.4764254456790036, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 56228.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 1150.4215974239341, "episode_reward_min": -37.16610958587709, "episode_reward_mean": 276.82931359038434, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1170.2923326104956, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 379.94185724661145, "predator_policy": 1165.5266108457952}, "policy_reward_mean": {"prey_policy": -513.6694016524971, "predator_policy": 652.0840584476896}, "custom_metrics": {}, "hist_stats": {"episode_reward": [267.8039100505928, 163.1930357996359, 40.09001839434966, 1150.4215974239341, 62.815528341286594, 61.98370811494342, 406.18339114494876, 157.18938702011172, 288.12400274763826, 84.50000000000001, 304.35428257815306, 39.699999999999996, 409.36550068371906, 377.56854157091925, 196.38031350519933, 68.5000000000004, 96.69696304064716, 151.83342148032241, 375.2441643356955, -0.49747145883548605, 645.167949163576, 885.4740546023669, 894.0867765136334, 624.6563334059294, 798.1871898558131, 54.1875192454019, 623.3165771651677, 163.80772798210472, 364.2257990679377, 4.262565385453451, 190.66840698235552, 27.54331008971744, 336.7491185810801, 615.258629939319, -3.552713678800501e-15, 8.853577982120804, 549.8886421747661, 80.68033391665715, 416.76643652703217, 126.24370857472394, 405.076828726246, 700.965876816839, -3.8248149545723797, 0.30000000000000426, 145.47166827494848, 603.3086261951104, 789.8000206442364, 0.18075794841748838, 748.5934906990357, 252.34168271423346, 0.9773238189854694, 4.529181545848257, 769.0454991864949, 163.67640131003336, 239.88816316016025, 158.56745533509522, 230.22213948106318, 7.598578028402089, 20.004963145810446, 85.68041865193646, 255.52003494183788, 661.7022514000353, -0.008985169663161097, 173.70989082308512, 7.504328805820434, 0.34348924408449344, 465.72477529501305, 328.69717313434313, 705.2880725886203, 156.80358298593444, 417.5387006512647, 171.31988861714873, 462.5679886251735, 14.3616197647526, 27.632913915782183, 543.5165615232553, 573.3823520786726, 195.13863770661158, 200.73989841795495, 611.5378194471853, 5.713253459832041, 509.76978241711237, 46.29589130421314, -37.16610958587709, 9.298113114448082, 434.66542334579276, 150.0598056703133, 22.999999999999986, 505.9789413571838, 36.089122245157924, 6.344076303523567, 161.09510424943127, 8.093403702751269, 7.569734167485784, 139.7255130207287, 569.5435726714521, 223.0453571930972, 398.6711693537607, 124.98332637826452, 953.2556712161095], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [1.8524883742487852, -759.7543486782574, -784.8779784934914, -143.34451002981913, -501.0019149444163, -770.3081283267647, -1003.8909051332041, 296.81066414670966, -177.98717986289574, -1012.0163901374008, -364.1359098337468, -843.3678864601354, -188.45981119189983, -801.5348089791286, -948.4986428675579, -593.7346505293199, -859.2235948526683, -171.29521509628452, -104.46838734444557, -826.6151278193578, -995.574176048659, -49.985921956960176, -705.6552072551328, -718.4748597380328, -240.1524254541731, -831.743751132115, -789.2229043890054, -484.23220480966296, -778.0677144761992, -281.58995674696456, -111.44189647204587, 8.786972633665817, -636.3185337269166, -720.3174607366267, -447.77528144148044, -996.7165529429294, -182.14768215739787, -389.64373402344717, -1044.2796737196538, -852.6909277364806, 345.6645174819379, -570.6252629369636, 339.03323481115467, -791.5329489016997, 379.94185724661145, -799.4033844636299, 221.06453693940003, -791.7937450876865, -727.9506546050003, 183.15767695730943, -730.3332850434823, -629.4001586978513, -171.13042827242717, -354.7183489976295, -579.8775594749623, -696.4997692467128, -517.4942988464595, -406.4199461775335, -698.1709917162531, -626.2131266995658, -256.7351419103198, -717.8610445355195, -450.36295199764925, -733.1796334377858, -335.3082985169226, -808.4988091880805, 50.45331851424319, -686.8130716534583, -871.6023094786115, -1165.5266108457952, -888.488927630698, -599.3734005198695, -85.41749438046685, -737.6359285694708, -262.94658189570566, -526.7577629757747, -234.94004357412837, -779.7332258354802, -208.77941713779683, -99.34738270637678, -602.7219271713811, 142.80803052938538, -833.361303834366, -58.63671974164953, -630.4827065339513, -985.9056690917422, -980.8502577409665, -728.3381002073714, -203.5000138152705, -817.0326263444416, -67.31423058820477, -924.291465355291, 229.5169447098878, -781.0326654097438, -852.5758418180203, -861.3413201413174, -775.4951031238925, 296.1815475719118, -1107.8685988305642, -354.9289466571434, -784.2805830213463, -736.5766440206389, -724.016768856235, -715.4396279856799, 68.81637239745584, -1170.2923326104956, -432.7141214465296, -305.28461499827375, -213.36469093535712, -756.4735045059357, -527.3563743774084, -700.5708674023781, -740.2754185879201, -252.76000099579804, -759.0570538289855, -697.1415267576781, -941.8938841993842, -395.2016828852305, -549.4119910385617, -644.4789548654916, -498.1876490610334, -192.98904985466953, -968.7170459333539, -1.81364571986785, -807.0389973336308, -946.9435252523679, -361.76911135214834, -817.8431123802353, -855.0175256191271, -661.6632136949746, -609.8999489140667, -831.2690201479776, -149.71167814150738, -224.60383811656706, -322.0161685874548, -802.3384224870604, 318.0279253009585, -554.8522443804746, -422.2801257103992, -626.3646984402017, -726.2637370091026, -200.946183142154, -577.0565558351032, 148.2524193327533, -107.60997486578334, -1009.9900257084648, -706.6044316913432, -734.9156268410587, -641.1115474893597, -762.2329186775512, -512.8916787891549, 286.36065279247225, 104.44400448800634, -721.533121160054, -682.2317405908904, -401.4434875731894, -811.3484500994535, -347.40592179208863, 105.31432764953047, -379.78921146509936, -788.786533937902, -867.0185731278533, -781.8515183658778, -87.02154379399946, -759.9363561209102, -713.5468000500701, -536.5393765900068, -238.17601793129816, -808.4553395459135, -557.5260667828675, -849.3311069612403, -41.75063692115775, -965.2018858990067, -384.9876914510576, -692.0311095394119, -578.0044721147151, 119.94359400797948, -736.6443390005347, -598.0066058857209, -470.1250794618713, -902.8765212696984, -736.5720792275405, -254.98812462497253, -526.0742093255973, -630.9969595497296, -724.4863312089378, -731.6430904031579, -688.4591625492843, -1065.241193092608, -572.3200029787096, -754.8422238451647, 181.5914451665019, -627.8848866322489, -56.185102949125195, -70.35286331285619, 80.21000784143109, -660.229836241894, -434.18392676260913, 353.6126677331044, -861.067994586476], "policy_predator_policy_reward": [329.9899365931548, 695.715833761446, 539.5465451075261, 551.8689792154186, 745.853554914687, 565.5465067508482, 945.2481681799262, 912.2536702305064, 1054.1766948961522, 198.6424034454295, 442.83722325186216, 826.6502811569635, 604.8655055306103, 791.3125057853636, 939.2585562205726, 760.1641241964185, 633.7843536103165, 684.8584590862722, 187.5683873444446, 828.0151278193579, 911.8519386796008, 438.0624419041738, 706.5552072551329, 757.2748597380327, 655.7279868425106, 825.5336904274974, 895.2277618132435, 755.7958889563487, 721.8703686160828, 534.1676161122866, 142.54189647204618, 28.613027366334308, 798.355448791451, 654.97750871274, 650.9144235599767, 945.4108323047566, 522.1313801839964, 424.9042003325424, 1046.6675418788543, 849.8055881184446, 489.4186415184165, 380.710053100186, 610.6492860887591, 727.3244826041544, 594.5902508134275, 718.958052917223, 530.496379137762, 664.8891624164494, 699.9150778855213, 643.0650896179842, 761.1603885378661, 652.7605744488721, 648.3478081160438, 500.8175463191776, 744.3416032264364, 695.8434534773438, 794.0332860075043, 494.1067580844259, 700.086602562223, 628.5600812390502, 769.5584719072594, 395.70612152094105, 701.0394198581045, 510.0464756670473, 715.9545850534923, 764.6016412325971, 673.7392741855355, 577.8791088929987, 871.6023094786115, 1165.5266108457952, 897.5884399475796, 599.1274661851097, 690.946090362982, 681.9959747617197, 276.9610270447192, 593.4236517434204, 685.4257279073074, 746.0139780293324, 387.3054854203903, 47.065022998507246, 263.1601968820608, 601.8305284861761, 708.3465033702676, 884.6173970225867, 626.6578915793792, 985.9056690917422, 981.1502577409666, 728.3381002073714, 345.27168209021966, 820.7326263444425, 751.5690593622888, 843.3452627763082, 647.9665056382264, 693.3492357058651, 852.756599766438, 861.3413201413174, 719.0357611237139, 508.8712851273046, 1045.704759630322, 669.4344685716231, 784.5579068403318, 737.2766440206391, 724.6167688562351, 719.3688095315284, 1034.3013976756752, 836.2200617238567, 445.065814152239, 456.60932360259784, 781.5707432361422, 428.1556153653111, 714.5359887759565, 671.9587083389242, 587.7239954594471, 635.5335636053397, 759.1711184827375, 704.6260401323282, 941.8938841993842, 415.20664603104376, 698.645135902445, 580.9262286535475, 427.8814829039654, 518.815250953578, 803.4743883532253, 828.7585547000293, 807.6463376218418, 946.3271997944942, 874.7342859813414, 478.58782857412746, 868.8194569788024, 655.3656111411224, 609.8615695251186, 831.65088878101, 302.53513203763924, 537.5051595154482, 656.9054595266199, 796.146304682242, 427.46729483450275, 514.645096833634, 616.259599425526, 589.1888077110113, 680.8248213684155, 663.9237994341016, 14.728755748391883, 585.3952693711084, 681.268267686404, 898.8997215130115, 716.9660514560969, 738.9156268410588, 644.8769564995115, 786.1004235831816, 294.57241172110025, 475.47517579883913, 540.4098945025061, 650.0615742482127, 570.4150806977956, 708.3987851728981, 528.61845482513, 830.8758154843676, 301.00479658363423, 585.0079066791205, 794.4997873977342, 867.0185731278533, 693.4880744980696, 685.1547700789158, 760.1229555950308, 759.6560918801631, 464.90486808865694, 272.6444168467733, 808.4553395459135, 566.8241798973148, 734.4120921521579, 591.3350750760366, 965.2018858990067, 535.0474971213707, 698.5311095394134, 594.5044721147159, 420.0954880549246, 702.5841982948141, 463.0017016527683, 641.2191059399876, 905.4178629290556, 740.3748138717071, 529.1682552624395, 412.9891829375673, 639.0903632524802, 724.4863312089378, 780.9764858442667, 646.6955012756617, 981.8563520748547, 795.430357017192, 706.7406319408998, 436.05371940921384, 636.1848866322496, 270.9304601422225, 388.8140248251834, 0.0, 619.9949513815468, 599.4021380012182, 728.1779414082486, 732.5330566612338]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.00002442960742, "mean_inference_ms": 4.400924220002377, "mean_action_processing_ms": 1.7016314239525168, "mean_env_wait_ms": 12.423284263863698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004564166069030762, "StateBufferConnector_ms": 0.012067437171936035, "ViewRequirementAgentConnector_ms": 0.15166139602661133}, "num_episodes": 10, "episode_return_max": 1150.4215974239341, "episode_return_min": -37.16610958587709, "episode_return_mean": 276.82931359038434, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.39474752831245, "num_env_steps_trained_throughput_per_sec": 154.39474752831245, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 25843.352, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25842.974, "sample_time_ms": 2458.414, "learn_time_ms": 23360.745, "learn_throughput": 171.227, "synch_weights_time_ms": 20.296}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 60, "trial_id": "0b608_00000", "date": "2024-08-22_14-11-03", "timestamp": 1724316063, "time_this_iter_s": 25.97293710708618, "time_total_s": 1555.9481768608093, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a3b8a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1555.9481768608093, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 32.22222222222223, "ram_util_percent": 83.16111111111113}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.14138312390242, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.108409583379352, "policy_loss": -0.008009914439368658, "vf_loss": 8.115895676486707, "vf_explained_var": 0.2006144261864758, "kl": 0.005237935134948838, "entropy": 0.2684481679447113, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57173.0, "diff_num_grad_updates_vs_sampler_policy": 482.39499999999674}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.578593251314114, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.9403110246809705, "policy_loss": -0.009118673503004684, "vf_loss": 7.94783084859293, "vf_explained_var": 0.46645634180654294, "kl": 0.007994175871844015, "entropy": 0.5225745208048946, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57173.0, "diff_num_grad_updates_vs_sampler_policy": 482.39499999999674}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "env_runners": {"episode_reward_max": 953.2556712161095, "episode_reward_min": -37.16610958587709, "episode_reward_mean": 263.2272787253248, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1170.2923326104956, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 379.94185724661145, "predator_policy": 1165.5266108457952}, "policy_reward_mean": {"prey_policy": -517.3096794893452, "predator_policy": 648.9233188520078}, "custom_metrics": {}, "hist_stats": {"episode_reward": [304.35428257815306, 39.699999999999996, 409.36550068371906, 377.56854157091925, 196.38031350519933, 68.5000000000004, 96.69696304064716, 151.83342148032241, 375.2441643356955, -0.49747145883548605, 645.167949163576, 885.4740546023669, 894.0867765136334, 624.6563334059294, 798.1871898558131, 54.1875192454019, 623.3165771651677, 163.80772798210472, 364.2257990679377, 4.262565385453451, 190.66840698235552, 27.54331008971744, 336.7491185810801, 615.258629939319, -3.552713678800501e-15, 8.853577982120804, 549.8886421747661, 80.68033391665715, 416.76643652703217, 126.24370857472394, 405.076828726246, 700.965876816839, -3.8248149545723797, 0.30000000000000426, 145.47166827494848, 603.3086261951104, 789.8000206442364, 0.18075794841748838, 748.5934906990357, 252.34168271423346, 0.9773238189854694, 4.529181545848257, 769.0454991864949, 163.67640131003336, 239.88816316016025, 158.56745533509522, 230.22213948106318, 7.598578028402089, 20.004963145810446, 85.68041865193646, 255.52003494183788, 661.7022514000353, -0.008985169663161097, 173.70989082308512, 7.504328805820434, 0.34348924408449344, 465.72477529501305, 328.69717313434313, 705.2880725886203, 156.80358298593444, 417.5387006512647, 171.31988861714873, 462.5679886251735, 14.3616197647526, 27.632913915782183, 543.5165615232553, 573.3823520786726, 195.13863770661158, 200.73989841795495, 611.5378194471853, 5.713253459832041, 509.76978241711237, 46.29589130421314, -37.16610958587709, 9.298113114448082, 434.66542334579276, 150.0598056703133, 22.999999999999986, 505.9789413571838, 36.089122245157924, 6.344076303523567, 161.09510424943127, 8.093403702751269, 7.569734167485784, 139.7255130207287, 569.5435726714521, 223.0453571930972, 398.6711693537607, 124.98332637826452, 953.2556712161095, 635.9865668614013, 24.696545290727478, 11.699999999999969, 80.46284116611153, 3.774758283725532e-15, 83.10990324594515, 245.76119014397258, 46.02925629796715, 54.2711357612002, 140.08365376416035], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-995.574176048659, -49.985921956960176, -705.6552072551328, -718.4748597380328, -240.1524254541731, -831.743751132115, -789.2229043890054, -484.23220480966296, -778.0677144761992, -281.58995674696456, -111.44189647204587, 8.786972633665817, -636.3185337269166, -720.3174607366267, -447.77528144148044, -996.7165529429294, -182.14768215739787, -389.64373402344717, -1044.2796737196538, -852.6909277364806, 345.6645174819379, -570.6252629369636, 339.03323481115467, -791.5329489016997, 379.94185724661145, -799.4033844636299, 221.06453693940003, -791.7937450876865, -727.9506546050003, 183.15767695730943, -730.3332850434823, -629.4001586978513, -171.13042827242717, -354.7183489976295, -579.8775594749623, -696.4997692467128, -517.4942988464595, -406.4199461775335, -698.1709917162531, -626.2131266995658, -256.7351419103198, -717.8610445355195, -450.36295199764925, -733.1796334377858, -335.3082985169226, -808.4988091880805, 50.45331851424319, -686.8130716534583, -871.6023094786115, -1165.5266108457952, -888.488927630698, -599.3734005198695, -85.41749438046685, -737.6359285694708, -262.94658189570566, -526.7577629757747, -234.94004357412837, -779.7332258354802, -208.77941713779683, -99.34738270637678, -602.7219271713811, 142.80803052938538, -833.361303834366, -58.63671974164953, -630.4827065339513, -985.9056690917422, -980.8502577409665, -728.3381002073714, -203.5000138152705, -817.0326263444416, -67.31423058820477, -924.291465355291, 229.5169447098878, -781.0326654097438, -852.5758418180203, -861.3413201413174, -775.4951031238925, 296.1815475719118, -1107.8685988305642, -354.9289466571434, -784.2805830213463, -736.5766440206389, -724.016768856235, -715.4396279856799, 68.81637239745584, -1170.2923326104956, -432.7141214465296, -305.28461499827375, -213.36469093535712, -756.4735045059357, -527.3563743774084, -700.5708674023781, -740.2754185879201, -252.76000099579804, -759.0570538289855, -697.1415267576781, -941.8938841993842, -395.2016828852305, -549.4119910385617, -644.4789548654916, -498.1876490610334, -192.98904985466953, -968.7170459333539, -1.81364571986785, -807.0389973336308, -946.9435252523679, -361.76911135214834, -817.8431123802353, -855.0175256191271, -661.6632136949746, -609.8999489140667, -831.2690201479776, -149.71167814150738, -224.60383811656706, -322.0161685874548, -802.3384224870604, 318.0279253009585, -554.8522443804746, -422.2801257103992, -626.3646984402017, -726.2637370091026, -200.946183142154, -577.0565558351032, 148.2524193327533, -107.60997486578334, -1009.9900257084648, -706.6044316913432, -734.9156268410587, -641.1115474893597, -762.2329186775512, -512.8916787891549, 286.36065279247225, 104.44400448800634, -721.533121160054, -682.2317405908904, -401.4434875731894, -811.3484500994535, -347.40592179208863, 105.31432764953047, -379.78921146509936, -788.786533937902, -867.0185731278533, -781.8515183658778, -87.02154379399946, -759.9363561209102, -713.5468000500701, -536.5393765900068, -238.17601793129816, -808.4553395459135, -557.5260667828675, -849.3311069612403, -41.75063692115775, -965.2018858990067, -384.9876914510576, -692.0311095394119, -578.0044721147151, 119.94359400797948, -736.6443390005347, -598.0066058857209, -470.1250794618713, -902.8765212696984, -736.5720792275405, -254.98812462497253, -526.0742093255973, -630.9969595497296, -724.4863312089378, -731.6430904031579, -688.4591625492843, -1065.241193092608, -572.3200029787096, -754.8422238451647, 181.5914451665019, -627.8848866322489, -56.185102949125195, -70.35286331285619, 80.21000784143109, -660.229836241894, -434.18392676260913, 353.6126677331044, -861.067994586476, 14.030544042576095, -904.2700795683382, -556.0693595127108, -717.5465682423918, -816.7938993212613, -488.4150040518236, -439.0068386024469, -683.2328851863564, -960.775462469109, -748.1510927584112, -970.7024295667999, -412.59979199311385, 3.855210938374011, -341.55885225029857, -760.2078679817661, -407.3001043838228, -554.1962893103076, -297.21289506213344, -821.1467959352356, -422.6073442140493], "policy_predator_policy_reward": [911.8519386796008, 438.0624419041738, 706.5552072551329, 757.2748597380327, 655.7279868425106, 825.5336904274974, 895.2277618132435, 755.7958889563487, 721.8703686160828, 534.1676161122866, 142.54189647204618, 28.613027366334308, 798.355448791451, 654.97750871274, 650.9144235599767, 945.4108323047566, 522.1313801839964, 424.9042003325424, 1046.6675418788543, 849.8055881184446, 489.4186415184165, 380.710053100186, 610.6492860887591, 727.3244826041544, 594.5902508134275, 718.958052917223, 530.496379137762, 664.8891624164494, 699.9150778855213, 643.0650896179842, 761.1603885378661, 652.7605744488721, 648.3478081160438, 500.8175463191776, 744.3416032264364, 695.8434534773438, 794.0332860075043, 494.1067580844259, 700.086602562223, 628.5600812390502, 769.5584719072594, 395.70612152094105, 701.0394198581045, 510.0464756670473, 715.9545850534923, 764.6016412325971, 673.7392741855355, 577.8791088929987, 871.6023094786115, 1165.5266108457952, 897.5884399475796, 599.1274661851097, 690.946090362982, 681.9959747617197, 276.9610270447192, 593.4236517434204, 685.4257279073074, 746.0139780293324, 387.3054854203903, 47.065022998507246, 263.1601968820608, 601.8305284861761, 708.3465033702676, 884.6173970225867, 626.6578915793792, 985.9056690917422, 981.1502577409666, 728.3381002073714, 345.27168209021966, 820.7326263444425, 751.5690593622888, 843.3452627763082, 647.9665056382264, 693.3492357058651, 852.756599766438, 861.3413201413174, 719.0357611237139, 508.8712851273046, 1045.704759630322, 669.4344685716231, 784.5579068403318, 737.2766440206391, 724.6167688562351, 719.3688095315284, 1034.3013976756752, 836.2200617238567, 445.065814152239, 456.60932360259784, 781.5707432361422, 428.1556153653111, 714.5359887759565, 671.9587083389242, 587.7239954594471, 635.5335636053397, 759.1711184827375, 704.6260401323282, 941.8938841993842, 415.20664603104376, 698.645135902445, 580.9262286535475, 427.8814829039654, 518.815250953578, 803.4743883532253, 828.7585547000293, 807.6463376218418, 946.3271997944942, 874.7342859813414, 478.58782857412746, 868.8194569788024, 655.3656111411224, 609.8615695251186, 831.65088878101, 302.53513203763924, 537.5051595154482, 656.9054595266199, 796.146304682242, 427.46729483450275, 514.645096833634, 616.259599425526, 589.1888077110113, 680.8248213684155, 663.9237994341016, 14.728755748391883, 585.3952693711084, 681.268267686404, 898.8997215130115, 716.9660514560969, 738.9156268410588, 644.8769564995115, 786.1004235831816, 294.57241172110025, 475.47517579883913, 540.4098945025061, 650.0615742482127, 570.4150806977956, 708.3987851728981, 528.61845482513, 830.8758154843676, 301.00479658363423, 585.0079066791205, 794.4997873977342, 867.0185731278533, 693.4880744980696, 685.1547700789158, 760.1229555950308, 759.6560918801631, 464.90486808865694, 272.6444168467733, 808.4553395459135, 566.8241798973148, 734.4120921521579, 591.3350750760366, 965.2018858990067, 535.0474971213707, 698.5311095394134, 594.5044721147159, 420.0954880549246, 702.5841982948141, 463.0017016527683, 641.2191059399876, 905.4178629290556, 740.3748138717071, 529.1682552624395, 412.9891829375673, 639.0903632524802, 724.4863312089378, 780.9764858442667, 646.6955012756617, 981.8563520748547, 795.430357017192, 706.7406319408998, 436.05371940921384, 636.1848866322496, 270.9304601422225, 388.8140248251834, 0.0, 619.9949513815468, 599.4021380012182, 728.1779414082486, 732.5330566612338, 728.662890821697, 797.5632115654661, 580.5659048034386, 717.7465682423918, 817.2938993212614, 499.61500405182613, 447.19949690728527, 755.5030680476373, 960.775462469109, 748.1510927584112, 956.6060728348263, 509.80605197103455, 40.580578174724174, 542.8842532811742, 810.9142128517203, 402.62301581184005, 561.5723109894669, 344.10800914417393, 822.5467959352359, 561.2909979782096]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.990754633642976, "mean_inference_ms": 4.398361062782183, "mean_action_processing_ms": 1.7157540298888956, "mean_env_wait_ms": 12.4356285103561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005805373191833496, "StateBufferConnector_ms": 0.012169837951660156, "ViewRequirementAgentConnector_ms": 0.15336978435516357}, "num_episodes": 10, "episode_return_max": 953.2556712161095, "episode_return_min": -37.16610958587709, "episode_return_mean": 263.2272787253248, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.1299014207359, "num_env_steps_trained_throughput_per_sec": 156.1299014207359, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 25829.817, "restore_workers_time_ms": 0.022, "training_step_time_ms": 25829.438, "sample_time_ms": 2446.154, "learn_time_ms": 23358.717, "learn_throughput": 171.242, "synch_weights_time_ms": 21.171}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "training_iteration": 61, "trial_id": "0b608_00000", "date": "2024-08-22_14-11-29", "timestamp": 1724316089, "time_this_iter_s": 25.631885051727295, "time_total_s": 1581.5800619125366, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a3669d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1581.5800619125366, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 32.17777777777778, "ram_util_percent": 83.08055555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.791273425621963, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.934883785247803, "policy_loss": -0.008474473710413332, "vf_loss": 7.942703803632625, "vf_explained_var": 0.21965597186769759, "kl": 0.006544251144720764, "entropy": 0.29741862424151605, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 58118.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.147377990036414, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.803082899567942, "policy_loss": -0.00979878372616238, "vf_loss": 7.81130778802135, "vf_explained_var": 0.5715818004002646, "kl": 0.007869537451018692, "entropy": 0.5122898118205802, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 58118.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 953.2556712161095, "episode_reward_min": -37.16610958587709, "episode_reward_mean": 254.5571177334863, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1170.2923326104956, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 379.94185724661145, "predator_policy": 1165.5266108457952}, "policy_reward_mean": {"prey_policy": -522.2091373212539, "predator_policy": 649.4876961879974}, "custom_metrics": {}, "hist_stats": {"episode_reward": [96.69696304064716, 151.83342148032241, 375.2441643356955, -0.49747145883548605, 645.167949163576, 885.4740546023669, 894.0867765136334, 624.6563334059294, 798.1871898558131, 54.1875192454019, 623.3165771651677, 163.80772798210472, 364.2257990679377, 4.262565385453451, 190.66840698235552, 27.54331008971744, 336.7491185810801, 615.258629939319, -3.552713678800501e-15, 8.853577982120804, 549.8886421747661, 80.68033391665715, 416.76643652703217, 126.24370857472394, 405.076828726246, 700.965876816839, -3.8248149545723797, 0.30000000000000426, 145.47166827494848, 603.3086261951104, 789.8000206442364, 0.18075794841748838, 748.5934906990357, 252.34168271423346, 0.9773238189854694, 4.529181545848257, 769.0454991864949, 163.67640131003336, 239.88816316016025, 158.56745533509522, 230.22213948106318, 7.598578028402089, 20.004963145810446, 85.68041865193646, 255.52003494183788, 661.7022514000353, -0.008985169663161097, 173.70989082308512, 7.504328805820434, 0.34348924408449344, 465.72477529501305, 328.69717313434313, 705.2880725886203, 156.80358298593444, 417.5387006512647, 171.31988861714873, 462.5679886251735, 14.3616197647526, 27.632913915782183, 543.5165615232553, 573.3823520786726, 195.13863770661158, 200.73989841795495, 611.5378194471853, 5.713253459832041, 509.76978241711237, 46.29589130421314, -37.16610958587709, 9.298113114448082, 434.66542334579276, 150.0598056703133, 22.999999999999986, 505.9789413571838, 36.089122245157924, 6.344076303523567, 161.09510424943127, 8.093403702751269, 7.569734167485784, 139.7255130207287, 569.5435726714521, 223.0453571930972, 398.6711693537607, 124.98332637826452, 953.2556712161095, 635.9865668614013, 24.696545290727478, 11.699999999999969, 80.46284116611153, 3.774758283725532e-15, 83.10990324594515, 245.76119014397258, 46.02925629796715, 54.2711357612002, 140.08365376416035, 33.400000000000205, 2.345547239677093, 10.02242183962737, 136.72440810798523, 210.0601619668506, 136.29999999999976], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-636.3185337269166, -720.3174607366267, -447.77528144148044, -996.7165529429294, -182.14768215739787, -389.64373402344717, -1044.2796737196538, -852.6909277364806, 345.6645174819379, -570.6252629369636, 339.03323481115467, -791.5329489016997, 379.94185724661145, -799.4033844636299, 221.06453693940003, -791.7937450876865, -727.9506546050003, 183.15767695730943, -730.3332850434823, -629.4001586978513, -171.13042827242717, -354.7183489976295, -579.8775594749623, -696.4997692467128, -517.4942988464595, -406.4199461775335, -698.1709917162531, -626.2131266995658, -256.7351419103198, -717.8610445355195, -450.36295199764925, -733.1796334377858, -335.3082985169226, -808.4988091880805, 50.45331851424319, -686.8130716534583, -871.6023094786115, -1165.5266108457952, -888.488927630698, -599.3734005198695, -85.41749438046685, -737.6359285694708, -262.94658189570566, -526.7577629757747, -234.94004357412837, -779.7332258354802, -208.77941713779683, -99.34738270637678, -602.7219271713811, 142.80803052938538, -833.361303834366, -58.63671974164953, -630.4827065339513, -985.9056690917422, -980.8502577409665, -728.3381002073714, -203.5000138152705, -817.0326263444416, -67.31423058820477, -924.291465355291, 229.5169447098878, -781.0326654097438, -852.5758418180203, -861.3413201413174, -775.4951031238925, 296.1815475719118, -1107.8685988305642, -354.9289466571434, -784.2805830213463, -736.5766440206389, -724.016768856235, -715.4396279856799, 68.81637239745584, -1170.2923326104956, -432.7141214465296, -305.28461499827375, -213.36469093535712, -756.4735045059357, -527.3563743774084, -700.5708674023781, -740.2754185879201, -252.76000099579804, -759.0570538289855, -697.1415267576781, -941.8938841993842, -395.2016828852305, -549.4119910385617, -644.4789548654916, -498.1876490610334, -192.98904985466953, -968.7170459333539, -1.81364571986785, -807.0389973336308, -946.9435252523679, -361.76911135214834, -817.8431123802353, -855.0175256191271, -661.6632136949746, -609.8999489140667, -831.2690201479776, -149.71167814150738, -224.60383811656706, -322.0161685874548, -802.3384224870604, 318.0279253009585, -554.8522443804746, -422.2801257103992, -626.3646984402017, -726.2637370091026, -200.946183142154, -577.0565558351032, 148.2524193327533, -107.60997486578334, -1009.9900257084648, -706.6044316913432, -734.9156268410587, -641.1115474893597, -762.2329186775512, -512.8916787891549, 286.36065279247225, 104.44400448800634, -721.533121160054, -682.2317405908904, -401.4434875731894, -811.3484500994535, -347.40592179208863, 105.31432764953047, -379.78921146509936, -788.786533937902, -867.0185731278533, -781.8515183658778, -87.02154379399946, -759.9363561209102, -713.5468000500701, -536.5393765900068, -238.17601793129816, -808.4553395459135, -557.5260667828675, -849.3311069612403, -41.75063692115775, -965.2018858990067, -384.9876914510576, -692.0311095394119, -578.0044721147151, 119.94359400797948, -736.6443390005347, -598.0066058857209, -470.1250794618713, -902.8765212696984, -736.5720792275405, -254.98812462497253, -526.0742093255973, -630.9969595497296, -724.4863312089378, -731.6430904031579, -688.4591625492843, -1065.241193092608, -572.3200029787096, -754.8422238451647, 181.5914451665019, -627.8848866322489, -56.185102949125195, -70.35286331285619, 80.21000784143109, -660.229836241894, -434.18392676260913, 353.6126677331044, -861.067994586476, 14.030544042576095, -904.2700795683382, -556.0693595127108, -717.5465682423918, -816.7938993212613, -488.4150040518236, -439.0068386024469, -683.2328851863564, -960.775462469109, -748.1510927584112, -970.7024295667999, -412.59979199311385, 3.855210938374011, -341.55885225029857, -760.2078679817661, -407.3001043838228, -554.1962893103076, -297.21289506213344, -821.1467959352356, -422.6073442140493, -406.24574056142524, -339.9306834165792, -712.5090505612475, -721.2312356222895, -837.8775540625315, -568.1601463500926, -566.204318027539, -863.0836133152795, 39.02984568331092, -973.3444492262296, -372.3566272721032, -635.3320394950418], "policy_predator_policy_reward": [798.355448791451, 654.97750871274, 650.9144235599767, 945.4108323047566, 522.1313801839964, 424.9042003325424, 1046.6675418788543, 849.8055881184446, 489.4186415184165, 380.710053100186, 610.6492860887591, 727.3244826041544, 594.5902508134275, 718.958052917223, 530.496379137762, 664.8891624164494, 699.9150778855213, 643.0650896179842, 761.1603885378661, 652.7605744488721, 648.3478081160438, 500.8175463191776, 744.3416032264364, 695.8434534773438, 794.0332860075043, 494.1067580844259, 700.086602562223, 628.5600812390502, 769.5584719072594, 395.70612152094105, 701.0394198581045, 510.0464756670473, 715.9545850534923, 764.6016412325971, 673.7392741855355, 577.8791088929987, 871.6023094786115, 1165.5266108457952, 897.5884399475796, 599.1274661851097, 690.946090362982, 681.9959747617197, 276.9610270447192, 593.4236517434204, 685.4257279073074, 746.0139780293324, 387.3054854203903, 47.065022998507246, 263.1601968820608, 601.8305284861761, 708.3465033702676, 884.6173970225867, 626.6578915793792, 985.9056690917422, 981.1502577409666, 728.3381002073714, 345.27168209021966, 820.7326263444425, 751.5690593622888, 843.3452627763082, 647.9665056382264, 693.3492357058651, 852.756599766438, 861.3413201413174, 719.0357611237139, 508.8712851273046, 1045.704759630322, 669.4344685716231, 784.5579068403318, 737.2766440206391, 724.6167688562351, 719.3688095315284, 1034.3013976756752, 836.2200617238567, 445.065814152239, 456.60932360259784, 781.5707432361422, 428.1556153653111, 714.5359887759565, 671.9587083389242, 587.7239954594471, 635.5335636053397, 759.1711184827375, 704.6260401323282, 941.8938841993842, 415.20664603104376, 698.645135902445, 580.9262286535475, 427.8814829039654, 518.815250953578, 803.4743883532253, 828.7585547000293, 807.6463376218418, 946.3271997944942, 874.7342859813414, 478.58782857412746, 868.8194569788024, 655.3656111411224, 609.8615695251186, 831.65088878101, 302.53513203763924, 537.5051595154482, 656.9054595266199, 796.146304682242, 427.46729483450275, 514.645096833634, 616.259599425526, 589.1888077110113, 680.8248213684155, 663.9237994341016, 14.728755748391883, 585.3952693711084, 681.268267686404, 898.8997215130115, 716.9660514560969, 738.9156268410588, 644.8769564995115, 786.1004235831816, 294.57241172110025, 475.47517579883913, 540.4098945025061, 650.0615742482127, 570.4150806977956, 708.3987851728981, 528.61845482513, 830.8758154843676, 301.00479658363423, 585.0079066791205, 794.4997873977342, 867.0185731278533, 693.4880744980696, 685.1547700789158, 760.1229555950308, 759.6560918801631, 464.90486808865694, 272.6444168467733, 808.4553395459135, 566.8241798973148, 734.4120921521579, 591.3350750760366, 965.2018858990067, 535.0474971213707, 698.5311095394134, 594.5044721147159, 420.0954880549246, 702.5841982948141, 463.0017016527683, 641.2191059399876, 905.4178629290556, 740.3748138717071, 529.1682552624395, 412.9891829375673, 639.0903632524802, 724.4863312089378, 780.9764858442667, 646.6955012756617, 981.8563520748547, 795.430357017192, 706.7406319408998, 436.05371940921384, 636.1848866322496, 270.9304601422225, 388.8140248251834, 0.0, 619.9949513815468, 599.4021380012182, 728.1779414082486, 732.5330566612338, 728.662890821697, 797.5632115654661, 580.5659048034386, 717.7465682423918, 817.2938993212614, 499.61500405182613, 447.19949690728527, 755.5030680476373, 960.775462469109, 748.1510927584112, 956.6060728348263, 509.80605197103455, 40.580578174724174, 542.8842532811742, 810.9142128517203, 402.62301581184005, 561.5723109894669, 344.10800914417393, 822.5467959352359, 561.2909979782096, 376.24383826795065, 403.33258571006155, 713.5735114901759, 722.5123219330382, 705.893022206605, 710.1671000456477, 723.1163378977556, 842.8960015530458, 679.7967043533363, 464.5780611564358, 607.2713318910328, 536.7173348761137]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.995065934857513, "mean_inference_ms": 4.410153773274158, "mean_action_processing_ms": 1.706055370363032, "mean_env_wait_ms": 12.455006360501907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005917668342590332, "StateBufferConnector_ms": 0.012181282043457031, "ViewRequirementAgentConnector_ms": 0.15803754329681396}, "num_episodes": 6, "episode_return_max": 953.2556712161095, "episode_return_min": -37.16610958587709, "episode_return_mean": 254.5571177334863, "episodes_this_iter": 6}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.41012961984634, "num_env_steps_trained_throughput_per_sec": 155.41012961984634, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 25876.673, "restore_workers_time_ms": 0.024, "training_step_time_ms": 25876.294, "sample_time_ms": 2455.65, "learn_time_ms": 23397.044, "learn_throughput": 170.962, "synch_weights_time_ms": 20.226}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 62, "trial_id": "0b608_00000", "date": "2024-08-22_14-11-54", "timestamp": 1724316114, "time_this_iter_s": 25.798156023025513, "time_total_s": 1607.3782179355621, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a3b8dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1607.3782179355621, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 32.372972972972974, "ram_util_percent": 82.8108108108108}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.317237049435814, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.2049933322523, "policy_loss": -0.006867698246425895, "vf_loss": 8.21112084716716, "vf_explained_var": 0.14642633073544375, "kl": 0.007401848563963853, "entropy": 0.28847884157347303, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59063.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.243759152498196, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.848692571549188, "policy_loss": -0.008849990210944304, "vf_loss": 7.856254550893471, "vf_explained_var": 0.47417481822311563, "kl": 0.00644002028854278, "entropy": 0.4991023935653545, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59063.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 953.2556712161095, "episode_reward_min": -37.16610958587709, "episode_reward_mean": 226.07570506116517, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1170.2923326104956, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 353.6126677331044, "predator_policy": 1165.5266108457952}, "policy_reward_mean": {"prey_policy": -538.3861511209523, "predator_policy": 651.4240036515351}, "custom_metrics": {}, "hist_stats": {"episode_reward": [623.3165771651677, 163.80772798210472, 364.2257990679377, 4.262565385453451, 190.66840698235552, 27.54331008971744, 336.7491185810801, 615.258629939319, -3.552713678800501e-15, 8.853577982120804, 549.8886421747661, 80.68033391665715, 416.76643652703217, 126.24370857472394, 405.076828726246, 700.965876816839, -3.8248149545723797, 0.30000000000000426, 145.47166827494848, 603.3086261951104, 789.8000206442364, 0.18075794841748838, 748.5934906990357, 252.34168271423346, 0.9773238189854694, 4.529181545848257, 769.0454991864949, 163.67640131003336, 239.88816316016025, 158.56745533509522, 230.22213948106318, 7.598578028402089, 20.004963145810446, 85.68041865193646, 255.52003494183788, 661.7022514000353, -0.008985169663161097, 173.70989082308512, 7.504328805820434, 0.34348924408449344, 465.72477529501305, 328.69717313434313, 705.2880725886203, 156.80358298593444, 417.5387006512647, 171.31988861714873, 462.5679886251735, 14.3616197647526, 27.632913915782183, 543.5165615232553, 573.3823520786726, 195.13863770661158, 200.73989841795495, 611.5378194471853, 5.713253459832041, 509.76978241711237, 46.29589130421314, -37.16610958587709, 9.298113114448082, 434.66542334579276, 150.0598056703133, 22.999999999999986, 505.9789413571838, 36.089122245157924, 6.344076303523567, 161.09510424943127, 8.093403702751269, 7.569734167485784, 139.7255130207287, 569.5435726714521, 223.0453571930972, 398.6711693537607, 124.98332637826452, 953.2556712161095, 635.9865668614013, 24.696545290727478, 11.699999999999969, 80.46284116611153, 3.774758283725532e-15, 83.10990324594515, 245.76119014397258, 46.02925629796715, 54.2711357612002, 140.08365376416035, 33.400000000000205, 2.345547239677093, 10.02242183962737, 136.72440810798523, 210.0601619668506, 136.29999999999976, 142.46080739159754, 82.09323699619304, -10.937305192975764, 72.79643223650885, 1.7763568394002505e-15, 4.899999999999999, 657.0918415651369, 220.01505694555192, 498.411480173034, 10.064082837390554], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-171.13042827242717, -354.7183489976295, -579.8775594749623, -696.4997692467128, -517.4942988464595, -406.4199461775335, -698.1709917162531, -626.2131266995658, -256.7351419103198, -717.8610445355195, -450.36295199764925, -733.1796334377858, -335.3082985169226, -808.4988091880805, 50.45331851424319, -686.8130716534583, -871.6023094786115, -1165.5266108457952, -888.488927630698, -599.3734005198695, -85.41749438046685, -737.6359285694708, -262.94658189570566, -526.7577629757747, -234.94004357412837, -779.7332258354802, -208.77941713779683, -99.34738270637678, -602.7219271713811, 142.80803052938538, -833.361303834366, -58.63671974164953, -630.4827065339513, -985.9056690917422, -980.8502577409665, -728.3381002073714, -203.5000138152705, -817.0326263444416, -67.31423058820477, -924.291465355291, 229.5169447098878, -781.0326654097438, -852.5758418180203, -861.3413201413174, -775.4951031238925, 296.1815475719118, -1107.8685988305642, -354.9289466571434, -784.2805830213463, -736.5766440206389, -724.016768856235, -715.4396279856799, 68.81637239745584, -1170.2923326104956, -432.7141214465296, -305.28461499827375, -213.36469093535712, -756.4735045059357, -527.3563743774084, -700.5708674023781, -740.2754185879201, -252.76000099579804, -759.0570538289855, -697.1415267576781, -941.8938841993842, -395.2016828852305, -549.4119910385617, -644.4789548654916, -498.1876490610334, -192.98904985466953, -968.7170459333539, -1.81364571986785, -807.0389973336308, -946.9435252523679, -361.76911135214834, -817.8431123802353, -855.0175256191271, -661.6632136949746, -609.8999489140667, -831.2690201479776, -149.71167814150738, -224.60383811656706, -322.0161685874548, -802.3384224870604, 318.0279253009585, -554.8522443804746, -422.2801257103992, -626.3646984402017, -726.2637370091026, -200.946183142154, -577.0565558351032, 148.2524193327533, -107.60997486578334, -1009.9900257084648, -706.6044316913432, -734.9156268410587, -641.1115474893597, -762.2329186775512, -512.8916787891549, 286.36065279247225, 104.44400448800634, -721.533121160054, -682.2317405908904, -401.4434875731894, -811.3484500994535, -347.40592179208863, 105.31432764953047, -379.78921146509936, -788.786533937902, -867.0185731278533, -781.8515183658778, -87.02154379399946, -759.9363561209102, -713.5468000500701, -536.5393765900068, -238.17601793129816, -808.4553395459135, -557.5260667828675, -849.3311069612403, -41.75063692115775, -965.2018858990067, -384.9876914510576, -692.0311095394119, -578.0044721147151, 119.94359400797948, -736.6443390005347, -598.0066058857209, -470.1250794618713, -902.8765212696984, -736.5720792275405, -254.98812462497253, -526.0742093255973, -630.9969595497296, -724.4863312089378, -731.6430904031579, -688.4591625492843, -1065.241193092608, -572.3200029787096, -754.8422238451647, 181.5914451665019, -627.8848866322489, -56.185102949125195, -70.35286331285619, 80.21000784143109, -660.229836241894, -434.18392676260913, 353.6126677331044, -861.067994586476, 14.030544042576095, -904.2700795683382, -556.0693595127108, -717.5465682423918, -816.7938993212613, -488.4150040518236, -439.0068386024469, -683.2328851863564, -960.775462469109, -748.1510927584112, -970.7024295667999, -412.59979199311385, 3.855210938374011, -341.55885225029857, -760.2078679817661, -407.3001043838228, -554.1962893103076, -297.21289506213344, -821.1467959352356, -422.6073442140493, -406.24574056142524, -339.9306834165792, -712.5090505612475, -721.2312356222895, -837.8775540625315, -568.1601463500926, -566.204318027539, -863.0836133152795, 39.02984568331092, -973.3444492262296, -372.3566272721032, -635.3320394950418, -528.5233530356801, -723.114506451233, -485.2505901466131, -800.8896441949585, -830.4694828330561, -870.0428035387715, -210.870117242579, -235.8741867950913, -684.3370886878624, -863.0715090362147, -567.3870494200847, -840.7093735541209, -841.4659330327743, -4.354737279742475, -310.81098513713465, -884.3338288298488, -41.340555095062626, -752.9842884398713, -928.9368511924532, -672.7033387813534], "policy_predator_policy_reward": [648.3478081160438, 500.8175463191776, 744.3416032264364, 695.8434534773438, 794.0332860075043, 494.1067580844259, 700.086602562223, 628.5600812390502, 769.5584719072594, 395.70612152094105, 701.0394198581045, 510.0464756670473, 715.9545850534923, 764.6016412325971, 673.7392741855355, 577.8791088929987, 871.6023094786115, 1165.5266108457952, 897.5884399475796, 599.1274661851097, 690.946090362982, 681.9959747617197, 276.9610270447192, 593.4236517434204, 685.4257279073074, 746.0139780293324, 387.3054854203903, 47.065022998507246, 263.1601968820608, 601.8305284861761, 708.3465033702676, 884.6173970225867, 626.6578915793792, 985.9056690917422, 981.1502577409666, 728.3381002073714, 345.27168209021966, 820.7326263444425, 751.5690593622888, 843.3452627763082, 647.9665056382264, 693.3492357058651, 852.756599766438, 861.3413201413174, 719.0357611237139, 508.8712851273046, 1045.704759630322, 669.4344685716231, 784.5579068403318, 737.2766440206391, 724.6167688562351, 719.3688095315284, 1034.3013976756752, 836.2200617238567, 445.065814152239, 456.60932360259784, 781.5707432361422, 428.1556153653111, 714.5359887759565, 671.9587083389242, 587.7239954594471, 635.5335636053397, 759.1711184827375, 704.6260401323282, 941.8938841993842, 415.20664603104376, 698.645135902445, 580.9262286535475, 427.8814829039654, 518.815250953578, 803.4743883532253, 828.7585547000293, 807.6463376218418, 946.3271997944942, 874.7342859813414, 478.58782857412746, 868.8194569788024, 655.3656111411224, 609.8615695251186, 831.65088878101, 302.53513203763924, 537.5051595154482, 656.9054595266199, 796.146304682242, 427.46729483450275, 514.645096833634, 616.259599425526, 589.1888077110113, 680.8248213684155, 663.9237994341016, 14.728755748391883, 585.3952693711084, 681.268267686404, 898.8997215130115, 716.9660514560969, 738.9156268410588, 644.8769564995115, 786.1004235831816, 294.57241172110025, 475.47517579883913, 540.4098945025061, 650.0615742482127, 570.4150806977956, 708.3987851728981, 528.61845482513, 830.8758154843676, 301.00479658363423, 585.0079066791205, 794.4997873977342, 867.0185731278533, 693.4880744980696, 685.1547700789158, 760.1229555950308, 759.6560918801631, 464.90486808865694, 272.6444168467733, 808.4553395459135, 566.8241798973148, 734.4120921521579, 591.3350750760366, 965.2018858990067, 535.0474971213707, 698.5311095394134, 594.5044721147159, 420.0954880549246, 702.5841982948141, 463.0017016527683, 641.2191059399876, 905.4178629290556, 740.3748138717071, 529.1682552624395, 412.9891829375673, 639.0903632524802, 724.4863312089378, 780.9764858442667, 646.6955012756617, 981.8563520748547, 795.430357017192, 706.7406319408998, 436.05371940921384, 636.1848866322496, 270.9304601422225, 388.8140248251834, 0.0, 619.9949513815468, 599.4021380012182, 728.1779414082486, 732.5330566612338, 728.662890821697, 797.5632115654661, 580.5659048034386, 717.7465682423918, 817.2938993212614, 499.61500405182613, 447.19949690728527, 755.5030680476373, 960.775462469109, 748.1510927584112, 956.6060728348263, 509.80605197103455, 40.580578174724174, 542.8842532811742, 810.9142128517203, 402.62301581184005, 561.5723109894669, 344.10800914417393, 822.5467959352359, 561.2909979782096, 376.24383826795065, 403.33258571006155, 713.5735114901759, 722.5123219330382, 705.893022206605, 710.1671000456477, 723.1163378977556, 842.8960015530458, 679.7967043533363, 464.5780611564358, 607.2713318910328, 536.7173348761137, 670.3841604272776, 723.714506451233, 567.8404108170436, 800.3930605207266, 816.062350650419, 873.5126305284327, 274.55583897784163, 244.98489729633758, 684.3370886878624, 863.0715090362147, 572.2870494200859, 840.7093735541209, 784.993910330713, 717.918601546938, 713.0181046793284, 702.1417662332035, 591.2362583031359, 701.5000654048289, 929.2195394028489, 682.4847334083494]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.986177618805503, "mean_inference_ms": 4.410228339019052, "mean_action_processing_ms": 1.7069857768320695, "mean_env_wait_ms": 12.456492376773337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006025195121765137, "StateBufferConnector_ms": 0.012082576751708984, "ViewRequirementAgentConnector_ms": 0.1621149778366089}, "num_episodes": 10, "episode_return_max": 953.2556712161095, "episode_return_min": -37.16610958587709, "episode_return_mean": 226.07570506116517, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.9727468350128, "num_env_steps_trained_throughput_per_sec": 155.9727468350128, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 25758.779, "restore_workers_time_ms": 0.024, "training_step_time_ms": 25758.398, "sample_time_ms": 2350.752, "learn_time_ms": 23384.546, "learn_throughput": 171.053, "synch_weights_time_ms": 20.089}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 63, "trial_id": "0b608_00000", "date": "2024-08-22_14-12-20", "timestamp": 1724316140, "time_this_iter_s": 25.706177949905396, "time_total_s": 1633.0843958854675, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x311fd7430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1633.0843958854675, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 31.808333333333323, "ram_util_percent": 83.1277777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.40874539228974, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.951742692473074, "policy_loss": -0.009102303957537054, "vf_loss": 7.960183031596834, "vf_explained_var": 0.11974667954066442, "kl": 0.00661988289676922, "entropy": 0.2918888430116038, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 60008.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.62251018039764, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.6033508053532355, "policy_loss": -0.009632736854698686, "vf_loss": 7.611582449252013, "vf_explained_var": 0.48687240125010256, "kl": 0.0070053825834913855, "entropy": 0.5068860763910586, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 60008.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 953.2556712161095, "episode_reward_min": -37.16610958587709, "episode_reward_mean": 222.80069376849482, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1170.2923326104956, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 353.6126677331044, "predator_policy": 1165.5266108457952}, "policy_reward_mean": {"prey_policy": -540.747800900703, "predator_policy": 652.1481477849507}, "custom_metrics": {}, "hist_stats": {"episode_reward": [190.66840698235552, 27.54331008971744, 336.7491185810801, 615.258629939319, -3.552713678800501e-15, 8.853577982120804, 549.8886421747661, 80.68033391665715, 416.76643652703217, 126.24370857472394, 405.076828726246, 700.965876816839, -3.8248149545723797, 0.30000000000000426, 145.47166827494848, 603.3086261951104, 789.8000206442364, 0.18075794841748838, 748.5934906990357, 252.34168271423346, 0.9773238189854694, 4.529181545848257, 769.0454991864949, 163.67640131003336, 239.88816316016025, 158.56745533509522, 230.22213948106318, 7.598578028402089, 20.004963145810446, 85.68041865193646, 255.52003494183788, 661.7022514000353, -0.008985169663161097, 173.70989082308512, 7.504328805820434, 0.34348924408449344, 465.72477529501305, 328.69717313434313, 705.2880725886203, 156.80358298593444, 417.5387006512647, 171.31988861714873, 462.5679886251735, 14.3616197647526, 27.632913915782183, 543.5165615232553, 573.3823520786726, 195.13863770661158, 200.73989841795495, 611.5378194471853, 5.713253459832041, 509.76978241711237, 46.29589130421314, -37.16610958587709, 9.298113114448082, 434.66542334579276, 150.0598056703133, 22.999999999999986, 505.9789413571838, 36.089122245157924, 6.344076303523567, 161.09510424943127, 8.093403702751269, 7.569734167485784, 139.7255130207287, 569.5435726714521, 223.0453571930972, 398.6711693537607, 124.98332637826452, 953.2556712161095, 635.9865668614013, 24.696545290727478, 11.699999999999969, 80.46284116611153, 3.774758283725532e-15, 83.10990324594515, 245.76119014397258, 46.02925629796715, 54.2711357612002, 140.08365376416035, 33.400000000000205, 2.345547239677093, 10.02242183962737, 136.72440810798523, 210.0601619668506, 136.29999999999976, 142.46080739159754, 82.09323699619304, -10.937305192975764, 72.79643223650885, 1.7763568394002505e-15, 4.899999999999999, 657.0918415651369, 220.01505694555192, 498.411480173034, 10.064082837390554, 7.4, 437.9164411676329, 365.71818727201327, 17.07691189397884], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-256.7351419103198, -717.8610445355195, -450.36295199764925, -733.1796334377858, -335.3082985169226, -808.4988091880805, 50.45331851424319, -686.8130716534583, -871.6023094786115, -1165.5266108457952, -888.488927630698, -599.3734005198695, -85.41749438046685, -737.6359285694708, -262.94658189570566, -526.7577629757747, -234.94004357412837, -779.7332258354802, -208.77941713779683, -99.34738270637678, -602.7219271713811, 142.80803052938538, -833.361303834366, -58.63671974164953, -630.4827065339513, -985.9056690917422, -980.8502577409665, -728.3381002073714, -203.5000138152705, -817.0326263444416, -67.31423058820477, -924.291465355291, 229.5169447098878, -781.0326654097438, -852.5758418180203, -861.3413201413174, -775.4951031238925, 296.1815475719118, -1107.8685988305642, -354.9289466571434, -784.2805830213463, -736.5766440206389, -724.016768856235, -715.4396279856799, 68.81637239745584, -1170.2923326104956, -432.7141214465296, -305.28461499827375, -213.36469093535712, -756.4735045059357, -527.3563743774084, -700.5708674023781, -740.2754185879201, -252.76000099579804, -759.0570538289855, -697.1415267576781, -941.8938841993842, -395.2016828852305, -549.4119910385617, -644.4789548654916, -498.1876490610334, -192.98904985466953, -968.7170459333539, -1.81364571986785, -807.0389973336308, -946.9435252523679, -361.76911135214834, -817.8431123802353, -855.0175256191271, -661.6632136949746, -609.8999489140667, -831.2690201479776, -149.71167814150738, -224.60383811656706, -322.0161685874548, -802.3384224870604, 318.0279253009585, -554.8522443804746, -422.2801257103992, -626.3646984402017, -726.2637370091026, -200.946183142154, -577.0565558351032, 148.2524193327533, -107.60997486578334, -1009.9900257084648, -706.6044316913432, -734.9156268410587, -641.1115474893597, -762.2329186775512, -512.8916787891549, 286.36065279247225, 104.44400448800634, -721.533121160054, -682.2317405908904, -401.4434875731894, -811.3484500994535, -347.40592179208863, 105.31432764953047, -379.78921146509936, -788.786533937902, -867.0185731278533, -781.8515183658778, -87.02154379399946, -759.9363561209102, -713.5468000500701, -536.5393765900068, -238.17601793129816, -808.4553395459135, -557.5260667828675, -849.3311069612403, -41.75063692115775, -965.2018858990067, -384.9876914510576, -692.0311095394119, -578.0044721147151, 119.94359400797948, -736.6443390005347, -598.0066058857209, -470.1250794618713, -902.8765212696984, -736.5720792275405, -254.98812462497253, -526.0742093255973, -630.9969595497296, -724.4863312089378, -731.6430904031579, -688.4591625492843, -1065.241193092608, -572.3200029787096, -754.8422238451647, 181.5914451665019, -627.8848866322489, -56.185102949125195, -70.35286331285619, 80.21000784143109, -660.229836241894, -434.18392676260913, 353.6126677331044, -861.067994586476, 14.030544042576095, -904.2700795683382, -556.0693595127108, -717.5465682423918, -816.7938993212613, -488.4150040518236, -439.0068386024469, -683.2328851863564, -960.775462469109, -748.1510927584112, -970.7024295667999, -412.59979199311385, 3.855210938374011, -341.55885225029857, -760.2078679817661, -407.3001043838228, -554.1962893103076, -297.21289506213344, -821.1467959352356, -422.6073442140493, -406.24574056142524, -339.9306834165792, -712.5090505612475, -721.2312356222895, -837.8775540625315, -568.1601463500926, -566.204318027539, -863.0836133152795, 39.02984568331092, -973.3444492262296, -372.3566272721032, -635.3320394950418, -528.5233530356801, -723.114506451233, -485.2505901466131, -800.8896441949585, -830.4694828330561, -870.0428035387715, -210.870117242579, -235.8741867950913, -684.3370886878624, -863.0715090362147, -567.3870494200847, -840.7093735541209, -841.4659330327743, -4.354737279742475, -310.81098513713465, -884.3338288298488, -41.340555095062626, -752.9842884398713, -928.9368511924532, -672.7033387813534, -729.5677222832735, -757.0410610229369, -498.2353024584577, -106.39660834869258, -767.0928933781086, -91.88958893326142, -890.4130239255358, -682.2182250314355], "policy_predator_policy_reward": [769.5584719072594, 395.70612152094105, 701.0394198581045, 510.0464756670473, 715.9545850534923, 764.6016412325971, 673.7392741855355, 577.8791088929987, 871.6023094786115, 1165.5266108457952, 897.5884399475796, 599.1274661851097, 690.946090362982, 681.9959747617197, 276.9610270447192, 593.4236517434204, 685.4257279073074, 746.0139780293324, 387.3054854203903, 47.065022998507246, 263.1601968820608, 601.8305284861761, 708.3465033702676, 884.6173970225867, 626.6578915793792, 985.9056690917422, 981.1502577409666, 728.3381002073714, 345.27168209021966, 820.7326263444425, 751.5690593622888, 843.3452627763082, 647.9665056382264, 693.3492357058651, 852.756599766438, 861.3413201413174, 719.0357611237139, 508.8712851273046, 1045.704759630322, 669.4344685716231, 784.5579068403318, 737.2766440206391, 724.6167688562351, 719.3688095315284, 1034.3013976756752, 836.2200617238567, 445.065814152239, 456.60932360259784, 781.5707432361422, 428.1556153653111, 714.5359887759565, 671.9587083389242, 587.7239954594471, 635.5335636053397, 759.1711184827375, 704.6260401323282, 941.8938841993842, 415.20664603104376, 698.645135902445, 580.9262286535475, 427.8814829039654, 518.815250953578, 803.4743883532253, 828.7585547000293, 807.6463376218418, 946.3271997944942, 874.7342859813414, 478.58782857412746, 868.8194569788024, 655.3656111411224, 609.8615695251186, 831.65088878101, 302.53513203763924, 537.5051595154482, 656.9054595266199, 796.146304682242, 427.46729483450275, 514.645096833634, 616.259599425526, 589.1888077110113, 680.8248213684155, 663.9237994341016, 14.728755748391883, 585.3952693711084, 681.268267686404, 898.8997215130115, 716.9660514560969, 738.9156268410588, 644.8769564995115, 786.1004235831816, 294.57241172110025, 475.47517579883913, 540.4098945025061, 650.0615742482127, 570.4150806977956, 708.3987851728981, 528.61845482513, 830.8758154843676, 301.00479658363423, 585.0079066791205, 794.4997873977342, 867.0185731278533, 693.4880744980696, 685.1547700789158, 760.1229555950308, 759.6560918801631, 464.90486808865694, 272.6444168467733, 808.4553395459135, 566.8241798973148, 734.4120921521579, 591.3350750760366, 965.2018858990067, 535.0474971213707, 698.5311095394134, 594.5044721147159, 420.0954880549246, 702.5841982948141, 463.0017016527683, 641.2191059399876, 905.4178629290556, 740.3748138717071, 529.1682552624395, 412.9891829375673, 639.0903632524802, 724.4863312089378, 780.9764858442667, 646.6955012756617, 981.8563520748547, 795.430357017192, 706.7406319408998, 436.05371940921384, 636.1848866322496, 270.9304601422225, 388.8140248251834, 0.0, 619.9949513815468, 599.4021380012182, 728.1779414082486, 732.5330566612338, 728.662890821697, 797.5632115654661, 580.5659048034386, 717.7465682423918, 817.2938993212614, 499.61500405182613, 447.19949690728527, 755.5030680476373, 960.775462469109, 748.1510927584112, 956.6060728348263, 509.80605197103455, 40.580578174724174, 542.8842532811742, 810.9142128517203, 402.62301581184005, 561.5723109894669, 344.10800914417393, 822.5467959352359, 561.2909979782096, 376.24383826795065, 403.33258571006155, 713.5735114901759, 722.5123219330382, 705.893022206605, 710.1671000456477, 723.1163378977556, 842.8960015530458, 679.7967043533363, 464.5780611564358, 607.2713318910328, 536.7173348761137, 670.3841604272776, 723.714506451233, 567.8404108170436, 800.3930605207266, 816.062350650419, 873.5126305284327, 274.55583897784163, 244.98489729633758, 684.3370886878624, 863.0715090362147, 572.2870494200859, 840.7093735541209, 784.993910330713, 717.918601546938, 713.0181046793284, 702.1417662332035, 591.2362583031359, 701.5000654048289, 929.2195394028489, 682.4847334083494, 729.7677222832735, 764.2410610229379, 513.0540319681304, 529.4943200066524, 756.4659327551578, 468.2347368282237, 896.4183392525636, 693.2898215983862]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.993009197907241, "mean_inference_ms": 4.415624129186636, "mean_action_processing_ms": 1.69751713283826, "mean_env_wait_ms": 12.46895986899625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00612330436706543, "StateBufferConnector_ms": 0.011079788208007812, "ViewRequirementAgentConnector_ms": 0.1523672342300415}, "num_episodes": 4, "episode_return_max": 953.2556712161095, "episode_return_min": -37.16610958587709, "episode_return_mean": 222.80069376849482, "episodes_this_iter": 4}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 158.0303297526899, "num_env_steps_trained_throughput_per_sec": 158.0303297526899, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 25733.217, "restore_workers_time_ms": 0.024, "training_step_time_ms": 25732.848, "sample_time_ms": 2337.801, "learn_time_ms": 23372.177, "learn_throughput": 171.144, "synch_weights_time_ms": 19.969}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 64, "trial_id": "0b608_00000", "date": "2024-08-22_14-12-46", "timestamp": 1724316166, "time_this_iter_s": 25.378415822982788, "time_total_s": 1658.4628117084503, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30e3d8940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1658.4628117084503, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 31.191666666666663, "ram_util_percent": 83.0027777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.180854948487863, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.10818914130882, "policy_loss": -0.009066969608621939, "vf_loss": 8.116631593149176, "vf_explained_var": 0.11845772556526951, "kl": 0.006244818436686521, "entropy": 0.2618532576573589, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 60953.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.8846146639062, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.805049301833702, "policy_loss": -0.008999797958318912, "vf_loss": 7.812415994916644, "vf_explained_var": 0.5165477595001301, "kl": 0.00816555831300479, "entropy": 0.5019325230172071, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 60953.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 953.2556712161095, "episode_reward_min": -37.16610958587709, "episode_reward_mean": 204.90999241986302, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1170.2923326104956, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 353.6126677331044, "predator_policy": 1045.704759630322}, "policy_reward_mean": {"prey_policy": -549.7924099480223, "predator_policy": 652.247406157954}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.8248149545723797, 0.30000000000000426, 145.47166827494848, 603.3086261951104, 789.8000206442364, 0.18075794841748838, 748.5934906990357, 252.34168271423346, 0.9773238189854694, 4.529181545848257, 769.0454991864949, 163.67640131003336, 239.88816316016025, 158.56745533509522, 230.22213948106318, 7.598578028402089, 20.004963145810446, 85.68041865193646, 255.52003494183788, 661.7022514000353, -0.008985169663161097, 173.70989082308512, 7.504328805820434, 0.34348924408449344, 465.72477529501305, 328.69717313434313, 705.2880725886203, 156.80358298593444, 417.5387006512647, 171.31988861714873, 462.5679886251735, 14.3616197647526, 27.632913915782183, 543.5165615232553, 573.3823520786726, 195.13863770661158, 200.73989841795495, 611.5378194471853, 5.713253459832041, 509.76978241711237, 46.29589130421314, -37.16610958587709, 9.298113114448082, 434.66542334579276, 150.0598056703133, 22.999999999999986, 505.9789413571838, 36.089122245157924, 6.344076303523567, 161.09510424943127, 8.093403702751269, 7.569734167485784, 139.7255130207287, 569.5435726714521, 223.0453571930972, 398.6711693537607, 124.98332637826452, 953.2556712161095, 635.9865668614013, 24.696545290727478, 11.699999999999969, 80.46284116611153, 3.774758283725532e-15, 83.10990324594515, 245.76119014397258, 46.02925629796715, 54.2711357612002, 140.08365376416035, 33.400000000000205, 2.345547239677093, 10.02242183962737, 136.72440810798523, 210.0601619668506, 136.29999999999976, 142.46080739159754, 82.09323699619304, -10.937305192975764, 72.79643223650885, 1.7763568394002505e-15, 4.899999999999999, 657.0918415651369, 220.01505694555192, 498.411480173034, 10.064082837390554, 7.4, 437.9164411676329, 365.71818727201327, 17.07691189397884, 96.0897418364257, -1.3667008010521915, 4.349790791987448, 303.4024593338257, 12.997966697305701, 27.44734427756494, 4.864116448415487, 320.1858709676171, 13.742175971572934, 475.2713417497059, 353.9621216262185, 58.678506548091], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-630.4827065339513, -985.9056690917422, -980.8502577409665, -728.3381002073714, -203.5000138152705, -817.0326263444416, -67.31423058820477, -924.291465355291, 229.5169447098878, -781.0326654097438, -852.5758418180203, -861.3413201413174, -775.4951031238925, 296.1815475719118, -1107.8685988305642, -354.9289466571434, -784.2805830213463, -736.5766440206389, -724.016768856235, -715.4396279856799, 68.81637239745584, -1170.2923326104956, -432.7141214465296, -305.28461499827375, -213.36469093535712, -756.4735045059357, -527.3563743774084, -700.5708674023781, -740.2754185879201, -252.76000099579804, -759.0570538289855, -697.1415267576781, -941.8938841993842, -395.2016828852305, -549.4119910385617, -644.4789548654916, -498.1876490610334, -192.98904985466953, -968.7170459333539, -1.81364571986785, -807.0389973336308, -946.9435252523679, -361.76911135214834, -817.8431123802353, -855.0175256191271, -661.6632136949746, -609.8999489140667, -831.2690201479776, -149.71167814150738, -224.60383811656706, -322.0161685874548, -802.3384224870604, 318.0279253009585, -554.8522443804746, -422.2801257103992, -626.3646984402017, -726.2637370091026, -200.946183142154, -577.0565558351032, 148.2524193327533, -107.60997486578334, -1009.9900257084648, -706.6044316913432, -734.9156268410587, -641.1115474893597, -762.2329186775512, -512.8916787891549, 286.36065279247225, 104.44400448800634, -721.533121160054, -682.2317405908904, -401.4434875731894, -811.3484500994535, -347.40592179208863, 105.31432764953047, -379.78921146509936, -788.786533937902, -867.0185731278533, -781.8515183658778, -87.02154379399946, -759.9363561209102, -713.5468000500701, -536.5393765900068, -238.17601793129816, -808.4553395459135, -557.5260667828675, -849.3311069612403, -41.75063692115775, -965.2018858990067, -384.9876914510576, -692.0311095394119, -578.0044721147151, 119.94359400797948, -736.6443390005347, -598.0066058857209, -470.1250794618713, -902.8765212696984, -736.5720792275405, -254.98812462497253, -526.0742093255973, -630.9969595497296, -724.4863312089378, -731.6430904031579, -688.4591625492843, -1065.241193092608, -572.3200029787096, -754.8422238451647, 181.5914451665019, -627.8848866322489, -56.185102949125195, -70.35286331285619, 80.21000784143109, -660.229836241894, -434.18392676260913, 353.6126677331044, -861.067994586476, 14.030544042576095, -904.2700795683382, -556.0693595127108, -717.5465682423918, -816.7938993212613, -488.4150040518236, -439.0068386024469, -683.2328851863564, -960.775462469109, -748.1510927584112, -970.7024295667999, -412.59979199311385, 3.855210938374011, -341.55885225029857, -760.2078679817661, -407.3001043838228, -554.1962893103076, -297.21289506213344, -821.1467959352356, -422.6073442140493, -406.24574056142524, -339.9306834165792, -712.5090505612475, -721.2312356222895, -837.8775540625315, -568.1601463500926, -566.204318027539, -863.0836133152795, 39.02984568331092, -973.3444492262296, -372.3566272721032, -635.3320394950418, -528.5233530356801, -723.114506451233, -485.2505901466131, -800.8896441949585, -830.4694828330561, -870.0428035387715, -210.870117242579, -235.8741867950913, -684.3370886878624, -863.0715090362147, -567.3870494200847, -840.7093735541209, -841.4659330327743, -4.354737279742475, -310.81098513713465, -884.3338288298488, -41.340555095062626, -752.9842884398713, -928.9368511924532, -672.7033387813534, -729.5677222832735, -757.0410610229369, -498.2353024584577, -106.39660834869258, -767.0928933781086, -91.88958893326142, -890.4130239255358, -682.2182250314355, -500.6385741802575, -673.2852936978738, -763.0191316172198, -958.0653881462705, -739.5678329079318, -511.62883413565663, -146.47839816070018, -407.16707561567154, -708.3517686766676, -689.4623405832474, -631.6258693691674, -223.26366930661715, -707.3871075084628, -641.7214994426957, -633.8771091002292, -299.61959759505544, -826.6687847052168, -678.4459982169477, -67.76231552880125, -123.92941206955312, -983.8705994950166, -282.3040083575064, -1041.446905824189, -320.10093371655654], "policy_predator_policy_reward": [626.6578915793792, 985.9056690917422, 981.1502577409666, 728.3381002073714, 345.27168209021966, 820.7326263444425, 751.5690593622888, 843.3452627763082, 647.9665056382264, 693.3492357058651, 852.756599766438, 861.3413201413174, 719.0357611237139, 508.8712851273046, 1045.704759630322, 669.4344685716231, 784.5579068403318, 737.2766440206391, 724.6167688562351, 719.3688095315284, 1034.3013976756752, 836.2200617238567, 445.065814152239, 456.60932360259784, 781.5707432361422, 428.1556153653111, 714.5359887759565, 671.9587083389242, 587.7239954594471, 635.5335636053397, 759.1711184827375, 704.6260401323282, 941.8938841993842, 415.20664603104376, 698.645135902445, 580.9262286535475, 427.8814829039654, 518.815250953578, 803.4743883532253, 828.7585547000293, 807.6463376218418, 946.3271997944942, 874.7342859813414, 478.58782857412746, 868.8194569788024, 655.3656111411224, 609.8615695251186, 831.65088878101, 302.53513203763924, 537.5051595154482, 656.9054595266199, 796.146304682242, 427.46729483450275, 514.645096833634, 616.259599425526, 589.1888077110113, 680.8248213684155, 663.9237994341016, 14.728755748391883, 585.3952693711084, 681.268267686404, 898.8997215130115, 716.9660514560969, 738.9156268410588, 644.8769564995115, 786.1004235831816, 294.57241172110025, 475.47517579883913, 540.4098945025061, 650.0615742482127, 570.4150806977956, 708.3987851728981, 528.61845482513, 830.8758154843676, 301.00479658363423, 585.0079066791205, 794.4997873977342, 867.0185731278533, 693.4880744980696, 685.1547700789158, 760.1229555950308, 759.6560918801631, 464.90486808865694, 272.6444168467733, 808.4553395459135, 566.8241798973148, 734.4120921521579, 591.3350750760366, 965.2018858990067, 535.0474971213707, 698.5311095394134, 594.5044721147159, 420.0954880549246, 702.5841982948141, 463.0017016527683, 641.2191059399876, 905.4178629290556, 740.3748138717071, 529.1682552624395, 412.9891829375673, 639.0903632524802, 724.4863312089378, 780.9764858442667, 646.6955012756617, 981.8563520748547, 795.430357017192, 706.7406319408998, 436.05371940921384, 636.1848866322496, 270.9304601422225, 388.8140248251834, 0.0, 619.9949513815468, 599.4021380012182, 728.1779414082486, 732.5330566612338, 728.662890821697, 797.5632115654661, 580.5659048034386, 717.7465682423918, 817.2938993212614, 499.61500405182613, 447.19949690728527, 755.5030680476373, 960.775462469109, 748.1510927584112, 956.6060728348263, 509.80605197103455, 40.580578174724174, 542.8842532811742, 810.9142128517203, 402.62301581184005, 561.5723109894669, 344.10800914417393, 822.5467959352359, 561.2909979782096, 376.24383826795065, 403.33258571006155, 713.5735114901759, 722.5123219330382, 705.893022206605, 710.1671000456477, 723.1163378977556, 842.8960015530458, 679.7967043533363, 464.5780611564358, 607.2713318910328, 536.7173348761137, 670.3841604272776, 723.714506451233, 567.8404108170436, 800.3930605207266, 816.062350650419, 873.5126305284327, 274.55583897784163, 244.98489729633758, 684.3370886878624, 863.0715090362147, 572.2870494200859, 840.7093735541209, 784.993910330713, 717.918601546938, 713.0181046793284, 702.1417662332035, 591.2362583031359, 701.5000654048289, 929.2195394028489, 682.4847334083494, 729.7677222832735, 764.2410610229379, 513.0540319681304, 529.4943200066524, 756.4659327551578, 468.2347368282237, 896.4183392525636, 693.2898215983862, 610.7531077405389, 659.2605019740182, 763.0191316172198, 956.6986873452183, 740.2512997695829, 515.295158065993, 624.1750493271368, 232.87288378306155, 712.2517686766685, 698.5603072805535, 638.6905402122372, 243.64634274111165, 711.6612273512632, 642.3114960483109, 719.851265895396, 533.8313117675028, 827.0687847052168, 691.7881741885203, 285.25328094862874, 381.7097883994276, 812.777299927436, 807.3594295513058, 1038.253928042617, 381.97241804622286]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.985458264630058, "mean_inference_ms": 4.415925615095294, "mean_action_processing_ms": 1.6946068893400408, "mean_env_wait_ms": 12.471774319037884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006263375282287598, "StateBufferConnector_ms": 0.011086106300354004, "ViewRequirementAgentConnector_ms": 0.15337085723876953}, "num_episodes": 12, "episode_return_max": 953.2556712161095, "episode_return_min": -37.16610958587709, "episode_return_mean": 204.90999241986302, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.70748618999016, "num_env_steps_trained_throughput_per_sec": 155.70748618999016, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 25733.871, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25733.588, "sample_time_ms": 2349.12, "learn_time_ms": 23362.78, "learn_throughput": 171.213, "synch_weights_time_ms": 18.839}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 65, "trial_id": "0b608_00000", "date": "2024-08-22_14-13-11", "timestamp": 1724316191, "time_this_iter_s": 25.721755981445312, "time_total_s": 1684.1845676898956, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a34e670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1684.1845676898956, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 31.833333333333332, "ram_util_percent": 83.23055555555554}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.94201328514745, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.981414030468653, "policy_loss": -0.009915088859716894, "vf_loss": 7.990617899415354, "vf_explained_var": 0.08095334730451069, "kl": 0.007112007349650696, "entropy": 0.28925314261799767, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61898.0, "diff_num_grad_updates_vs_sampler_policy": 482.39499999999674}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.440661315060165, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.5194875293307835, "policy_loss": -0.013452006082134272, "vf_loss": 7.531023015420904, "vf_explained_var": 0.507128919621624, "kl": 0.009582467090890364, "entropy": 0.5200231551493286, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61898.0, "diff_num_grad_updates_vs_sampler_policy": 482.39499999999674}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 953.2556712161095, "episode_reward_min": -37.16610958587709, "episode_reward_mean": 211.37810036995688, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1170.2923326104956, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 353.6126677331044, "predator_policy": 1038.253928042617}, "policy_reward_mean": {"prey_policy": -528.1457730604343, "predator_policy": 633.834823245413}, "custom_metrics": {}, "hist_stats": {"episode_reward": [769.0454991864949, 163.67640131003336, 239.88816316016025, 158.56745533509522, 230.22213948106318, 7.598578028402089, 20.004963145810446, 85.68041865193646, 255.52003494183788, 661.7022514000353, -0.008985169663161097, 173.70989082308512, 7.504328805820434, 0.34348924408449344, 465.72477529501305, 328.69717313434313, 705.2880725886203, 156.80358298593444, 417.5387006512647, 171.31988861714873, 462.5679886251735, 14.3616197647526, 27.632913915782183, 543.5165615232553, 573.3823520786726, 195.13863770661158, 200.73989841795495, 611.5378194471853, 5.713253459832041, 509.76978241711237, 46.29589130421314, -37.16610958587709, 9.298113114448082, 434.66542334579276, 150.0598056703133, 22.999999999999986, 505.9789413571838, 36.089122245157924, 6.344076303523567, 161.09510424943127, 8.093403702751269, 7.569734167485784, 139.7255130207287, 569.5435726714521, 223.0453571930972, 398.6711693537607, 124.98332637826452, 953.2556712161095, 635.9865668614013, 24.696545290727478, 11.699999999999969, 80.46284116611153, 3.774758283725532e-15, 83.10990324594515, 245.76119014397258, 46.02925629796715, 54.2711357612002, 140.08365376416035, 33.400000000000205, 2.345547239677093, 10.02242183962737, 136.72440810798523, 210.0601619668506, 136.29999999999976, 142.46080739159754, 82.09323699619304, -10.937305192975764, 72.79643223650885, 1.7763568394002505e-15, 4.899999999999999, 657.0918415651369, 220.01505694555192, 498.411480173034, 10.064082837390554, 7.4, 437.9164411676329, 365.71818727201327, 17.07691189397884, 96.0897418364257, -1.3667008010521915, 4.349790791987448, 303.4024593338257, 12.997966697305701, 27.44734427756494, 4.864116448415487, 320.1858709676171, 13.742175971572934, 475.2713417497059, 353.9621216262185, 58.678506548091, 182.50358674834385, 472.568870199411, 374.2294303202486, 296.9897898910443, 35.30000000000005, 635.7886104953916, 117.22342971525215, 12.79999999999999, 314.3963818267384, 746.6886326992066], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [68.81637239745584, -1170.2923326104956, -432.7141214465296, -305.28461499827375, -213.36469093535712, -756.4735045059357, -527.3563743774084, -700.5708674023781, -740.2754185879201, -252.76000099579804, -759.0570538289855, -697.1415267576781, -941.8938841993842, -395.2016828852305, -549.4119910385617, -644.4789548654916, -498.1876490610334, -192.98904985466953, -968.7170459333539, -1.81364571986785, -807.0389973336308, -946.9435252523679, -361.76911135214834, -817.8431123802353, -855.0175256191271, -661.6632136949746, -609.8999489140667, -831.2690201479776, -149.71167814150738, -224.60383811656706, -322.0161685874548, -802.3384224870604, 318.0279253009585, -554.8522443804746, -422.2801257103992, -626.3646984402017, -726.2637370091026, -200.946183142154, -577.0565558351032, 148.2524193327533, -107.60997486578334, -1009.9900257084648, -706.6044316913432, -734.9156268410587, -641.1115474893597, -762.2329186775512, -512.8916787891549, 286.36065279247225, 104.44400448800634, -721.533121160054, -682.2317405908904, -401.4434875731894, -811.3484500994535, -347.40592179208863, 105.31432764953047, -379.78921146509936, -788.786533937902, -867.0185731278533, -781.8515183658778, -87.02154379399946, -759.9363561209102, -713.5468000500701, -536.5393765900068, -238.17601793129816, -808.4553395459135, -557.5260667828675, -849.3311069612403, -41.75063692115775, -965.2018858990067, -384.9876914510576, -692.0311095394119, -578.0044721147151, 119.94359400797948, -736.6443390005347, -598.0066058857209, -470.1250794618713, -902.8765212696984, -736.5720792275405, -254.98812462497253, -526.0742093255973, -630.9969595497296, -724.4863312089378, -731.6430904031579, -688.4591625492843, -1065.241193092608, -572.3200029787096, -754.8422238451647, 181.5914451665019, -627.8848866322489, -56.185102949125195, -70.35286331285619, 80.21000784143109, -660.229836241894, -434.18392676260913, 353.6126677331044, -861.067994586476, 14.030544042576095, -904.2700795683382, -556.0693595127108, -717.5465682423918, -816.7938993212613, -488.4150040518236, -439.0068386024469, -683.2328851863564, -960.775462469109, -748.1510927584112, -970.7024295667999, -412.59979199311385, 3.855210938374011, -341.55885225029857, -760.2078679817661, -407.3001043838228, -554.1962893103076, -297.21289506213344, -821.1467959352356, -422.6073442140493, -406.24574056142524, -339.9306834165792, -712.5090505612475, -721.2312356222895, -837.8775540625315, -568.1601463500926, -566.204318027539, -863.0836133152795, 39.02984568331092, -973.3444492262296, -372.3566272721032, -635.3320394950418, -528.5233530356801, -723.114506451233, -485.2505901466131, -800.8896441949585, -830.4694828330561, -870.0428035387715, -210.870117242579, -235.8741867950913, -684.3370886878624, -863.0715090362147, -567.3870494200847, -840.7093735541209, -841.4659330327743, -4.354737279742475, -310.81098513713465, -884.3338288298488, -41.340555095062626, -752.9842884398713, -928.9368511924532, -672.7033387813534, -729.5677222832735, -757.0410610229369, -498.2353024584577, -106.39660834869258, -767.0928933781086, -91.88958893326142, -890.4130239255358, -682.2182250314355, -500.6385741802575, -673.2852936978738, -763.0191316172198, -958.0653881462705, -739.5678329079318, -511.62883413565663, -146.47839816070018, -407.16707561567154, -708.3517686766676, -689.4623405832474, -631.6258693691674, -223.26366930661715, -707.3871075084628, -641.7214994426957, -633.8771091002292, -299.61959759505544, -826.6687847052168, -678.4459982169477, -67.76231552880125, -123.92941206955312, -983.8705994950166, -282.3040083575064, -1041.446905824189, -320.10093371655654, -674.135215931944, 1.7033665449719944, 208.55642533751904, -476.9320314263537, 40.0000000000003, -778.9681983072719, -1026.386577540336, -164.777611138116, -478.06926765109495, -525.2036877681029, -146.24912338604565, -205.86399818502218, -511.7157466207677, -766.4388175917991, -733.8166061866256, -562.7456100074654, -523.3419345138367, 69.2255653910877, -924.9124497856614, 3.8262190244280196], "policy_predator_policy_reward": [1034.3013976756752, 836.2200617238567, 445.065814152239, 456.60932360259784, 781.5707432361422, 428.1556153653111, 714.5359887759565, 671.9587083389242, 587.7239954594471, 635.5335636053397, 759.1711184827375, 704.6260401323282, 941.8938841993842, 415.20664603104376, 698.645135902445, 580.9262286535475, 427.8814829039654, 518.815250953578, 803.4743883532253, 828.7585547000293, 807.6463376218418, 946.3271997944942, 874.7342859813414, 478.58782857412746, 868.8194569788024, 655.3656111411224, 609.8615695251186, 831.65088878101, 302.53513203763924, 537.5051595154482, 656.9054595266199, 796.146304682242, 427.46729483450275, 514.645096833634, 616.259599425526, 589.1888077110113, 680.8248213684155, 663.9237994341016, 14.728755748391883, 585.3952693711084, 681.268267686404, 898.8997215130115, 716.9660514560969, 738.9156268410588, 644.8769564995115, 786.1004235831816, 294.57241172110025, 475.47517579883913, 540.4098945025061, 650.0615742482127, 570.4150806977956, 708.3987851728981, 528.61845482513, 830.8758154843676, 301.00479658363423, 585.0079066791205, 794.4997873977342, 867.0185731278533, 693.4880744980696, 685.1547700789158, 760.1229555950308, 759.6560918801631, 464.90486808865694, 272.6444168467733, 808.4553395459135, 566.8241798973148, 734.4120921521579, 591.3350750760366, 965.2018858990067, 535.0474971213707, 698.5311095394134, 594.5044721147159, 420.0954880549246, 702.5841982948141, 463.0017016527683, 641.2191059399876, 905.4178629290556, 740.3748138717071, 529.1682552624395, 412.9891829375673, 639.0903632524802, 724.4863312089378, 780.9764858442667, 646.6955012756617, 981.8563520748547, 795.430357017192, 706.7406319408998, 436.05371940921384, 636.1848866322496, 270.9304601422225, 388.8140248251834, 0.0, 619.9949513815468, 599.4021380012182, 728.1779414082486, 732.5330566612338, 728.662890821697, 797.5632115654661, 580.5659048034386, 717.7465682423918, 817.2938993212614, 499.61500405182613, 447.19949690728527, 755.5030680476373, 960.775462469109, 748.1510927584112, 956.6060728348263, 509.80605197103455, 40.580578174724174, 542.8842532811742, 810.9142128517203, 402.62301581184005, 561.5723109894669, 344.10800914417393, 822.5467959352359, 561.2909979782096, 376.24383826795065, 403.33258571006155, 713.5735114901759, 722.5123219330382, 705.893022206605, 710.1671000456477, 723.1163378977556, 842.8960015530458, 679.7967043533363, 464.5780611564358, 607.2713318910328, 536.7173348761137, 670.3841604272776, 723.714506451233, 567.8404108170436, 800.3930605207266, 816.062350650419, 873.5126305284327, 274.55583897784163, 244.98489729633758, 684.3370886878624, 863.0715090362147, 572.2870494200859, 840.7093735541209, 784.993910330713, 717.918601546938, 713.0181046793284, 702.1417662332035, 591.2362583031359, 701.5000654048289, 929.2195394028489, 682.4847334083494, 729.7677222832735, 764.2410610229379, 513.0540319681304, 529.4943200066524, 756.4659327551578, 468.2347368282237, 896.4183392525636, 693.2898215983862, 610.7531077405389, 659.2605019740182, 763.0191316172198, 956.6986873452183, 740.2512997695829, 515.295158065993, 624.1750493271368, 232.87288378306155, 712.2517686766685, 698.5603072805535, 638.6905402122372, 243.64634274111165, 711.6612273512632, 642.3114960483109, 719.851265895396, 533.8313117675028, 827.0687847052168, 691.7881741885203, 285.25328094862874, 381.7097883994276, 812.777299927436, 807.3594295513058, 1038.253928042617, 381.97241804622286, 608.0187539259783, 246.91668220933954, 339.151317018544, 401.7931592697001, 640.8921599195844, 472.30546870793677, 976.2881998863393, 511.8657786831539, 509.16926765109577, 529.4036877681039, 339.54567064163166, 648.3560614248282, 605.3480069133279, 790.0299870144944, 744.9166061866259, 564.4456100074656, 535.6325046116622, 232.88024633782527, 804.0998312041488, 863.6750322562859]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.982231207592, "mean_inference_ms": 4.411573278266465, "mean_action_processing_ms": 1.7078666132253968, "mean_env_wait_ms": 12.47824661793841, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008075714111328125, "StateBufferConnector_ms": 0.01077282428741455, "ViewRequirementAgentConnector_ms": 0.14859795570373535}, "num_episodes": 10, "episode_return_max": 953.2556712161095, "episode_return_min": -37.16610958587709, "episode_return_mean": 211.37810036995688, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.33924958586428, "num_env_steps_trained_throughput_per_sec": 154.33924958586428, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 25772.502, "restore_workers_time_ms": 0.022, "training_step_time_ms": 25772.193, "sample_time_ms": 2356.307, "learn_time_ms": 23392.607, "learn_throughput": 170.994, "synch_weights_time_ms": 20.36}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 66, "trial_id": "0b608_00000", "date": "2024-08-22_14-13-37", "timestamp": 1724316217, "time_this_iter_s": 25.96142578125, "time_total_s": 1710.1459934711456, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a35c1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1710.1459934711456, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 33.78378378378378, "ram_util_percent": 83.04864864864867}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.769008925099854, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.067850390943901, "policy_loss": -0.007022245741996264, "vf_loss": 8.07428397173604, "vf_explained_var": 0.050328925046971236, "kl": 0.005886407458671817, "entropy": 0.25655265329060734, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 62843.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.82196111830454, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.484103091305526, "policy_loss": -0.008006133471255896, "vf_loss": 7.490700787841958, "vf_explained_var": 0.5110049281170759, "kl": 0.007042212846871248, "entropy": 0.4731570863849902, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 62843.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "env_runners": {"episode_reward_max": 953.2556712161095, "episode_reward_min": -37.16610958587709, "episode_reward_mean": 207.17428033234876, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1065.241193092608, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 353.6126677331044, "predator_policy": 1038.253928042617}, "policy_reward_mean": {"prey_policy": -522.1440000309985, "predator_policy": 625.7311401971731}, "custom_metrics": {}, "hist_stats": {"episode_reward": [465.72477529501305, 328.69717313434313, 705.2880725886203, 156.80358298593444, 417.5387006512647, 171.31988861714873, 462.5679886251735, 14.3616197647526, 27.632913915782183, 543.5165615232553, 573.3823520786726, 195.13863770661158, 200.73989841795495, 611.5378194471853, 5.713253459832041, 509.76978241711237, 46.29589130421314, -37.16610958587709, 9.298113114448082, 434.66542334579276, 150.0598056703133, 22.999999999999986, 505.9789413571838, 36.089122245157924, 6.344076303523567, 161.09510424943127, 8.093403702751269, 7.569734167485784, 139.7255130207287, 569.5435726714521, 223.0453571930972, 398.6711693537607, 124.98332637826452, 953.2556712161095, 635.9865668614013, 24.696545290727478, 11.699999999999969, 80.46284116611153, 3.774758283725532e-15, 83.10990324594515, 245.76119014397258, 46.02925629796715, 54.2711357612002, 140.08365376416035, 33.400000000000205, 2.345547239677093, 10.02242183962737, 136.72440810798523, 210.0601619668506, 136.29999999999976, 142.46080739159754, 82.09323699619304, -10.937305192975764, 72.79643223650885, 1.7763568394002505e-15, 4.899999999999999, 657.0918415651369, 220.01505694555192, 498.411480173034, 10.064082837390554, 7.4, 437.9164411676329, 365.71818727201327, 17.07691189397884, 96.0897418364257, -1.3667008010521915, 4.349790791987448, 303.4024593338257, 12.997966697305701, 27.44734427756494, 4.864116448415487, 320.1858709676171, 13.742175971572934, 475.2713417497059, 353.9621216262185, 58.678506548091, 182.50358674834385, 472.568870199411, 374.2294303202486, 296.9897898910443, 35.30000000000005, 635.7886104953916, 117.22342971525215, 12.79999999999999, 314.3963818267384, 746.6886326992066, 19.200000000000014, 266.96343520273615, 311.446305096632, 193.17629285364134, 14.093645196394618, 110.11315223544337, 333.81963698143596, 65.49075888380565, 172.93303071998417, 151.2313080080027, 486.9771052299614, 135.02197103279735, 12.677600425060888, 79.92838271748512], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-149.71167814150738, -224.60383811656706, -322.0161685874548, -802.3384224870604, 318.0279253009585, -554.8522443804746, -422.2801257103992, -626.3646984402017, -726.2637370091026, -200.946183142154, -577.0565558351032, 148.2524193327533, -107.60997486578334, -1009.9900257084648, -706.6044316913432, -734.9156268410587, -641.1115474893597, -762.2329186775512, -512.8916787891549, 286.36065279247225, 104.44400448800634, -721.533121160054, -682.2317405908904, -401.4434875731894, -811.3484500994535, -347.40592179208863, 105.31432764953047, -379.78921146509936, -788.786533937902, -867.0185731278533, -781.8515183658778, -87.02154379399946, -759.9363561209102, -713.5468000500701, -536.5393765900068, -238.17601793129816, -808.4553395459135, -557.5260667828675, -849.3311069612403, -41.75063692115775, -965.2018858990067, -384.9876914510576, -692.0311095394119, -578.0044721147151, 119.94359400797948, -736.6443390005347, -598.0066058857209, -470.1250794618713, -902.8765212696984, -736.5720792275405, -254.98812462497253, -526.0742093255973, -630.9969595497296, -724.4863312089378, -731.6430904031579, -688.4591625492843, -1065.241193092608, -572.3200029787096, -754.8422238451647, 181.5914451665019, -627.8848866322489, -56.185102949125195, -70.35286331285619, 80.21000784143109, -660.229836241894, -434.18392676260913, 353.6126677331044, -861.067994586476, 14.030544042576095, -904.2700795683382, -556.0693595127108, -717.5465682423918, -816.7938993212613, -488.4150040518236, -439.0068386024469, -683.2328851863564, -960.775462469109, -748.1510927584112, -970.7024295667999, -412.59979199311385, 3.855210938374011, -341.55885225029857, -760.2078679817661, -407.3001043838228, -554.1962893103076, -297.21289506213344, -821.1467959352356, -422.6073442140493, -406.24574056142524, -339.9306834165792, -712.5090505612475, -721.2312356222895, -837.8775540625315, -568.1601463500926, -566.204318027539, -863.0836133152795, 39.02984568331092, -973.3444492262296, -372.3566272721032, -635.3320394950418, -528.5233530356801, -723.114506451233, -485.2505901466131, -800.8896441949585, -830.4694828330561, -870.0428035387715, -210.870117242579, -235.8741867950913, -684.3370886878624, -863.0715090362147, -567.3870494200847, -840.7093735541209, -841.4659330327743, -4.354737279742475, -310.81098513713465, -884.3338288298488, -41.340555095062626, -752.9842884398713, -928.9368511924532, -672.7033387813534, -729.5677222832735, -757.0410610229369, -498.2353024584577, -106.39660834869258, -767.0928933781086, -91.88958893326142, -890.4130239255358, -682.2182250314355, -500.6385741802575, -673.2852936978738, -763.0191316172198, -958.0653881462705, -739.5678329079318, -511.62883413565663, -146.47839816070018, -407.16707561567154, -708.3517686766676, -689.4623405832474, -631.6258693691674, -223.26366930661715, -707.3871075084628, -641.7214994426957, -633.8771091002292, -299.61959759505544, -826.6687847052168, -678.4459982169477, -67.76231552880125, -123.92941206955312, -983.8705994950166, -282.3040083575064, -1041.446905824189, -320.10093371655654, -674.135215931944, 1.7033665449719944, 208.55642533751904, -476.9320314263537, 40.0000000000003, -778.9681983072719, -1026.386577540336, -164.777611138116, -478.06926765109495, -525.2036877681029, -146.24912338604565, -205.86399818502218, -511.7157466207677, -766.4388175917991, -733.8166061866256, -562.7456100074654, -523.3419345138367, 69.2255653910877, -924.9124497856614, 3.8262190244280196, -774.5846811545186, -780.3009741175448, -720.7483937894827, -159.76602011511895, -643.5616453727773, -6.006325100560332, -300.8248881835664, -160.32169239212777, -941.6319285147312, -878.202611774345, -317.90840923905057, -551.9464871275056, -257.8044214871005, -662.8479488470041, -648.4727189071813, -415.76577792519726, -837.6643332095152, -439.3724554217969, -579.5792616272927, -448.45766046204653, -451.3290370105932, -805.5578503684565, -755.2156328512069, -507.4617900000701, -646.7333545419086, -589.2813628479896, -196.43695544269286, -892.4732685828997], "policy_predator_policy_reward": [302.53513203763924, 537.5051595154482, 656.9054595266199, 796.146304682242, 427.46729483450275, 514.645096833634, 616.259599425526, 589.1888077110113, 680.8248213684155, 663.9237994341016, 14.728755748391883, 585.3952693711084, 681.268267686404, 898.8997215130115, 716.9660514560969, 738.9156268410588, 644.8769564995115, 786.1004235831816, 294.57241172110025, 475.47517579883913, 540.4098945025061, 650.0615742482127, 570.4150806977956, 708.3987851728981, 528.61845482513, 830.8758154843676, 301.00479658363423, 585.0079066791205, 794.4997873977342, 867.0185731278533, 693.4880744980696, 685.1547700789158, 760.1229555950308, 759.6560918801631, 464.90486808865694, 272.6444168467733, 808.4553395459135, 566.8241798973148, 734.4120921521579, 591.3350750760366, 965.2018858990067, 535.0474971213707, 698.5311095394134, 594.5044721147159, 420.0954880549246, 702.5841982948141, 463.0017016527683, 641.2191059399876, 905.4178629290556, 740.3748138717071, 529.1682552624395, 412.9891829375673, 639.0903632524802, 724.4863312089378, 780.9764858442667, 646.6955012756617, 981.8563520748547, 795.430357017192, 706.7406319408998, 436.05371940921384, 636.1848866322496, 270.9304601422225, 388.8140248251834, 0.0, 619.9949513815468, 599.4021380012182, 728.1779414082486, 732.5330566612338, 728.662890821697, 797.5632115654661, 580.5659048034386, 717.7465682423918, 817.2938993212614, 499.61500405182613, 447.19949690728527, 755.5030680476373, 960.775462469109, 748.1510927584112, 956.6060728348263, 509.80605197103455, 40.580578174724174, 542.8842532811742, 810.9142128517203, 402.62301581184005, 561.5723109894669, 344.10800914417393, 822.5467959352359, 561.2909979782096, 376.24383826795065, 403.33258571006155, 713.5735114901759, 722.5123219330382, 705.893022206605, 710.1671000456477, 723.1163378977556, 842.8960015530458, 679.7967043533363, 464.5780611564358, 607.2713318910328, 536.7173348761137, 670.3841604272776, 723.714506451233, 567.8404108170436, 800.3930605207266, 816.062350650419, 873.5126305284327, 274.55583897784163, 244.98489729633758, 684.3370886878624, 863.0715090362147, 572.2870494200859, 840.7093735541209, 784.993910330713, 717.918601546938, 713.0181046793284, 702.1417662332035, 591.2362583031359, 701.5000654048289, 929.2195394028489, 682.4847334083494, 729.7677222832735, 764.2410610229379, 513.0540319681304, 529.4943200066524, 756.4659327551578, 468.2347368282237, 896.4183392525636, 693.2898215983862, 610.7531077405389, 659.2605019740182, 763.0191316172198, 956.6986873452183, 740.2512997695829, 515.295158065993, 624.1750493271368, 232.87288378306155, 712.2517686766685, 698.5603072805535, 638.6905402122372, 243.64634274111165, 711.6612273512632, 642.3114960483109, 719.851265895396, 533.8313117675028, 827.0687847052168, 691.7881741885203, 285.25328094862874, 381.7097883994276, 812.777299927436, 807.3594295513058, 1038.253928042617, 381.97241804622286, 608.0187539259783, 246.91668220933954, 339.151317018544, 401.7931592697001, 640.8921599195844, 472.30546870793677, 976.2881998863393, 511.8657786831539, 509.16926765109577, 529.4036877681039, 339.54567064163166, 648.3560614248282, 605.3480069133279, 790.0299870144944, 744.9166061866259, 564.4456100074656, 535.6325046116622, 232.88024633782527, 804.0998312041488, 863.6750322562859, 777.884681154519, 796.2009741175447, 616.5330765618685, 530.9447725454661, 341.88474945326374, 619.1295261167068, 120.07832793670687, 534.2445454926273, 967.9382211103629, 865.9899643751081, 296.95163462430094, 683.016413977699, 722.9911915414883, 531.4808157740531, 654.2087045099224, 475.52055120626585, 574.838659382806, 875.1311599684968, 473.6364790952193, 705.6317510021248, 753.2542888157582, 990.6097037932471, 614.4186519188082, 783.2807419652669, 629.261594097994, 619.4307237169652, 323.06795368419154, 845.7706530588831]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.982004626731287, "mean_inference_ms": 4.41467771816705, "mean_action_processing_ms": 1.700495486797237, "mean_env_wait_ms": 12.482282400003655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011036157608032227, "StateBufferConnector_ms": 0.009193062782287598, "ViewRequirementAgentConnector_ms": 0.1377401351928711}, "num_episodes": 14, "episode_return_max": 953.2556712161095, "episode_return_min": -37.16610958587709, "episode_return_mean": 207.17428033234876, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.12043781474887, "num_env_steps_trained_throughput_per_sec": 155.12043781474887, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 25784.572, "restore_workers_time_ms": 0.025, "training_step_time_ms": 25784.372, "sample_time_ms": 2376.481, "learn_time_ms": 23385.687, "learn_throughput": 171.045, "synch_weights_time_ms": 19.235}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "training_iteration": 67, "trial_id": "0b608_00000", "date": "2024-08-22_14-14-03", "timestamp": 1724316243, "time_this_iter_s": 25.82470393180847, "time_total_s": 1735.970697402954, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30e415670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1735.970697402954, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 32.199999999999996, "ram_util_percent": 83.16486486486485}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32.05096785328376, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.646780892023965, "policy_loss": -0.007507350963969079, "vf_loss": 7.653688435327439, "vf_explained_var": 0.07717597541354951, "kl": 0.00599794501719612, "entropy": 0.32262153377924013, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63788.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.25650444207368, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.5611824913630405, "policy_loss": -0.008915561850049667, "vf_loss": 7.5685836040153704, "vf_explained_var": 0.3968681612973491, "kl": 0.007572211737857846, "entropy": 0.5258014041595358, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63788.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "env_runners": {"episode_reward_max": 953.2556712161095, "episode_reward_min": -37.16610958587709, "episode_reward_mean": 192.2605416686286, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1065.241193092608, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 363.5208703994206, "predator_policy": 1038.253928042617}, "policy_reward_mean": {"prey_policy": -536.980403577134, "predator_policy": 633.1106744114484}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.73989841795495, 611.5378194471853, 5.713253459832041, 509.76978241711237, 46.29589130421314, -37.16610958587709, 9.298113114448082, 434.66542334579276, 150.0598056703133, 22.999999999999986, 505.9789413571838, 36.089122245157924, 6.344076303523567, 161.09510424943127, 8.093403702751269, 7.569734167485784, 139.7255130207287, 569.5435726714521, 223.0453571930972, 398.6711693537607, 124.98332637826452, 953.2556712161095, 635.9865668614013, 24.696545290727478, 11.699999999999969, 80.46284116611153, 3.774758283725532e-15, 83.10990324594515, 245.76119014397258, 46.02925629796715, 54.2711357612002, 140.08365376416035, 33.400000000000205, 2.345547239677093, 10.02242183962737, 136.72440810798523, 210.0601619668506, 136.29999999999976, 142.46080739159754, 82.09323699619304, -10.937305192975764, 72.79643223650885, 1.7763568394002505e-15, 4.899999999999999, 657.0918415651369, 220.01505694555192, 498.411480173034, 10.064082837390554, 7.4, 437.9164411676329, 365.71818727201327, 17.07691189397884, 96.0897418364257, -1.3667008010521915, 4.349790791987448, 303.4024593338257, 12.997966697305701, 27.44734427756494, 4.864116448415487, 320.1858709676171, 13.742175971572934, 475.2713417497059, 353.9621216262185, 58.678506548091, 182.50358674834385, 472.568870199411, 374.2294303202486, 296.9897898910443, 35.30000000000005, 635.7886104953916, 117.22342971525215, 12.79999999999999, 314.3963818267384, 746.6886326992066, 19.200000000000014, 266.96343520273615, 311.446305096632, 193.17629285364134, 14.093645196394618, 110.11315223544337, 333.81963698143596, 65.49075888380565, 172.93303071998417, 151.2313080080027, 486.9771052299614, 135.02197103279735, 12.677600425060888, 79.92838271748512, 1.4000000000000008, 726.5323219252269, 334.4594948965098, 6.117731031253248, 172.09315673205012, 631.4684678010257, 29.245388075379292, 176.69420906134215, 237.9203978361267, 22.89426822299461, 162.8734470073433, 68.89951792530566], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-811.3484500994535, -347.40592179208863, 105.31432764953047, -379.78921146509936, -788.786533937902, -867.0185731278533, -781.8515183658778, -87.02154379399946, -759.9363561209102, -713.5468000500701, -536.5393765900068, -238.17601793129816, -808.4553395459135, -557.5260667828675, -849.3311069612403, -41.75063692115775, -965.2018858990067, -384.9876914510576, -692.0311095394119, -578.0044721147151, 119.94359400797948, -736.6443390005347, -598.0066058857209, -470.1250794618713, -902.8765212696984, -736.5720792275405, -254.98812462497253, -526.0742093255973, -630.9969595497296, -724.4863312089378, -731.6430904031579, -688.4591625492843, -1065.241193092608, -572.3200029787096, -754.8422238451647, 181.5914451665019, -627.8848866322489, -56.185102949125195, -70.35286331285619, 80.21000784143109, -660.229836241894, -434.18392676260913, 353.6126677331044, -861.067994586476, 14.030544042576095, -904.2700795683382, -556.0693595127108, -717.5465682423918, -816.7938993212613, -488.4150040518236, -439.0068386024469, -683.2328851863564, -960.775462469109, -748.1510927584112, -970.7024295667999, -412.59979199311385, 3.855210938374011, -341.55885225029857, -760.2078679817661, -407.3001043838228, -554.1962893103076, -297.21289506213344, -821.1467959352356, -422.6073442140493, -406.24574056142524, -339.9306834165792, -712.5090505612475, -721.2312356222895, -837.8775540625315, -568.1601463500926, -566.204318027539, -863.0836133152795, 39.02984568331092, -973.3444492262296, -372.3566272721032, -635.3320394950418, -528.5233530356801, -723.114506451233, -485.2505901466131, -800.8896441949585, -830.4694828330561, -870.0428035387715, -210.870117242579, -235.8741867950913, -684.3370886878624, -863.0715090362147, -567.3870494200847, -840.7093735541209, -841.4659330327743, -4.354737279742475, -310.81098513713465, -884.3338288298488, -41.340555095062626, -752.9842884398713, -928.9368511924532, -672.7033387813534, -729.5677222832735, -757.0410610229369, -498.2353024584577, -106.39660834869258, -767.0928933781086, -91.88958893326142, -890.4130239255358, -682.2182250314355, -500.6385741802575, -673.2852936978738, -763.0191316172198, -958.0653881462705, -739.5678329079318, -511.62883413565663, -146.47839816070018, -407.16707561567154, -708.3517686766676, -689.4623405832474, -631.6258693691674, -223.26366930661715, -707.3871075084628, -641.7214994426957, -633.8771091002292, -299.61959759505544, -826.6687847052168, -678.4459982169477, -67.76231552880125, -123.92941206955312, -983.8705994950166, -282.3040083575064, -1041.446905824189, -320.10093371655654, -674.135215931944, 1.7033665449719944, 208.55642533751904, -476.9320314263537, 40.0000000000003, -778.9681983072719, -1026.386577540336, -164.777611138116, -478.06926765109495, -525.2036877681029, -146.24912338604565, -205.86399818502218, -511.7157466207677, -766.4388175917991, -733.8166061866256, -562.7456100074654, -523.3419345138367, 69.2255653910877, -924.9124497856614, 3.8262190244280196, -774.5846811545186, -780.3009741175448, -720.7483937894827, -159.76602011511895, -643.5616453727773, -6.006325100560332, -300.8248881835664, -160.32169239212777, -941.6319285147312, -878.202611774345, -317.90840923905057, -551.9464871275056, -257.8044214871005, -662.8479488470041, -648.4727189071813, -415.76577792519726, -837.6643332095152, -439.3724554217969, -579.5792616272927, -448.45766046204653, -451.3290370105932, -805.5578503684565, -755.2156328512069, -507.4617900000701, -646.7333545419086, -589.2813628479896, -196.43695544269286, -892.4732685828997, -499.02321835419406, -576.2581806656902, 363.5208703994206, -661.2544626828263, -684.1224469074, 23.81998686955795, -323.65320530307145, -682.5380296547894, -410.9637719533902, -745.643456088008, 44.63109026630619, -976.1332992131956, -811.5953733827995, -629.991981776055, -359.69786512194844, -781.232255438772, -833.5666834861963, -370.5034996875901, -694.1799156042105, -896.7865374463291, -512.9803496901704, -660.5260799109549, -694.5342946508142, -623.9809530666324], "policy_predator_policy_reward": [528.61845482513, 830.8758154843676, 301.00479658363423, 585.0079066791205, 794.4997873977342, 867.0185731278533, 693.4880744980696, 685.1547700789158, 760.1229555950308, 759.6560918801631, 464.90486808865694, 272.6444168467733, 808.4553395459135, 566.8241798973148, 734.4120921521579, 591.3350750760366, 965.2018858990067, 535.0474971213707, 698.5311095394134, 594.5044721147159, 420.0954880549246, 702.5841982948141, 463.0017016527683, 641.2191059399876, 905.4178629290556, 740.3748138717071, 529.1682552624395, 412.9891829375673, 639.0903632524802, 724.4863312089378, 780.9764858442667, 646.6955012756617, 981.8563520748547, 795.430357017192, 706.7406319408998, 436.05371940921384, 636.1848866322496, 270.9304601422225, 388.8140248251834, 0.0, 619.9949513815468, 599.4021380012182, 728.1779414082486, 732.5330566612338, 728.662890821697, 797.5632115654661, 580.5659048034386, 717.7465682423918, 817.2938993212614, 499.61500405182613, 447.19949690728527, 755.5030680476373, 960.775462469109, 748.1510927584112, 956.6060728348263, 509.80605197103455, 40.580578174724174, 542.8842532811742, 810.9142128517203, 402.62301581184005, 561.5723109894669, 344.10800914417393, 822.5467959352359, 561.2909979782096, 376.24383826795065, 403.33258571006155, 713.5735114901759, 722.5123219330382, 705.893022206605, 710.1671000456477, 723.1163378977556, 842.8960015530458, 679.7967043533363, 464.5780611564358, 607.2713318910328, 536.7173348761137, 670.3841604272776, 723.714506451233, 567.8404108170436, 800.3930605207266, 816.062350650419, 873.5126305284327, 274.55583897784163, 244.98489729633758, 684.3370886878624, 863.0715090362147, 572.2870494200859, 840.7093735541209, 784.993910330713, 717.918601546938, 713.0181046793284, 702.1417662332035, 591.2362583031359, 701.5000654048289, 929.2195394028489, 682.4847334083494, 729.7677222832735, 764.2410610229379, 513.0540319681304, 529.4943200066524, 756.4659327551578, 468.2347368282237, 896.4183392525636, 693.2898215983862, 610.7531077405389, 659.2605019740182, 763.0191316172198, 956.6986873452183, 740.2512997695829, 515.295158065993, 624.1750493271368, 232.87288378306155, 712.2517686766685, 698.5603072805535, 638.6905402122372, 243.64634274111165, 711.6612273512632, 642.3114960483109, 719.851265895396, 533.8313117675028, 827.0687847052168, 691.7881741885203, 285.25328094862874, 381.7097883994276, 812.777299927436, 807.3594295513058, 1038.253928042617, 381.97241804622286, 608.0187539259783, 246.91668220933954, 339.151317018544, 401.7931592697001, 640.8921599195844, 472.30546870793677, 976.2881998863393, 511.8657786831539, 509.16926765109577, 529.4036877681039, 339.54567064163166, 648.3560614248282, 605.3480069133279, 790.0299870144944, 744.9166061866259, 564.4456100074656, 535.6325046116622, 232.88024633782527, 804.0998312041488, 863.6750322562859, 777.884681154519, 796.2009741175447, 616.5330765618685, 530.9447725454661, 341.88474945326374, 619.1295261167068, 120.07832793670687, 534.2445454926273, 967.9382211103629, 865.9899643751081, 296.95163462430094, 683.016413977699, 722.9911915414883, 531.4808157740531, 654.2087045099224, 475.52055120626585, 574.838659382806, 875.1311599684968, 473.6364790952193, 705.6317510021248, 753.2542888157582, 990.6097037932471, 614.4186519188082, 783.2807419652669, 629.261594097994, 619.4307237169652, 323.06795368419154, 845.7706530588831, 500.42321835419426, 576.2581806656902, 364.9131210774944, 659.3527931311405, 538.2137061745098, 456.54824875983985, 327.1658101893453, 685.1431557997713, 598.3386746353942, 730.3617101380559, 670.4862301868616, 892.4844465610486, 815.6233922409476, 655.2093509932861, 541.416192129862, 776.2081374922032, 799.3016428681159, 642.6889381417986, 700.507818582097, 913.3529026914337, 684.3431971009916, 652.0366795074789, 588.8685858589254, 798.5461797838284]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.979005017703943, "mean_inference_ms": 4.417214645493971, "mean_action_processing_ms": 1.693527015797302, "mean_env_wait_ms": 12.488376628511567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01308739185333252, "StateBufferConnector_ms": 0.016755342483520508, "ViewRequirementAgentConnector_ms": 0.1320807933807373}, "num_episodes": 12, "episode_return_max": 953.2556712161095, "episode_return_min": -37.16610958587709, "episode_return_mean": 192.2605416686286, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 150.52173002211322, "num_env_steps_trained_throughput_per_sec": 150.52173002211322, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 25836.755, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25836.531, "sample_time_ms": 2350.053, "learn_time_ms": 23461.739, "learn_throughput": 170.49, "synch_weights_time_ms": 21.732}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "training_iteration": 68, "trial_id": "0b608_00000", "date": "2024-08-22_14-14-30", "timestamp": 1724316270, "time_this_iter_s": 26.606974363327026, "time_total_s": 1762.5776717662811, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a34e700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1762.5776717662811, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 43.68648648648648, "ram_util_percent": 83.13243243243244}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.33765125325117, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.839907572509119, "policy_loss": -0.009813912392707257, "vf_loss": 7.848932846008785, "vf_explained_var": -0.029693758992291, "kl": 0.007886350699133737, "entropy": 0.34543673331459995, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 64733.0, "diff_num_grad_updates_vs_sampler_policy": 503.6575000000011}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.51261577126841, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.497895177205404, "policy_loss": -0.007638872472973413, "vf_loss": 7.504353374400467, "vf_explained_var": 0.4081815209969011, "kl": 0.0059033390023701246, "entropy": 0.4999554218123199, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 64733.0, "diff_num_grad_updates_vs_sampler_policy": 503.6575000000011}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 953.2556712161095, "episode_reward_min": -10.937305192975764, "episode_reward_mean": 190.86094335049282, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1065.241193092608, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 363.5208703994206, "predator_policy": 1038.253928042617}, "policy_reward_mean": {"prey_policy": -534.778632115836, "predator_policy": 630.2091037910827}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.344076303523567, 161.09510424943127, 8.093403702751269, 7.569734167485784, 139.7255130207287, 569.5435726714521, 223.0453571930972, 398.6711693537607, 124.98332637826452, 953.2556712161095, 635.9865668614013, 24.696545290727478, 11.699999999999969, 80.46284116611153, 3.774758283725532e-15, 83.10990324594515, 245.76119014397258, 46.02925629796715, 54.2711357612002, 140.08365376416035, 33.400000000000205, 2.345547239677093, 10.02242183962737, 136.72440810798523, 210.0601619668506, 136.29999999999976, 142.46080739159754, 82.09323699619304, -10.937305192975764, 72.79643223650885, 1.7763568394002505e-15, 4.899999999999999, 657.0918415651369, 220.01505694555192, 498.411480173034, 10.064082837390554, 7.4, 437.9164411676329, 365.71818727201327, 17.07691189397884, 96.0897418364257, -1.3667008010521915, 4.349790791987448, 303.4024593338257, 12.997966697305701, 27.44734427756494, 4.864116448415487, 320.1858709676171, 13.742175971572934, 475.2713417497059, 353.9621216262185, 58.678506548091, 182.50358674834385, 472.568870199411, 374.2294303202486, 296.9897898910443, 35.30000000000005, 635.7886104953916, 117.22342971525215, 12.79999999999999, 314.3963818267384, 746.6886326992066, 19.200000000000014, 266.96343520273615, 311.446305096632, 193.17629285364134, 14.093645196394618, 110.11315223544337, 333.81963698143596, 65.49075888380565, 172.93303071998417, 151.2313080080027, 486.9771052299614, 135.02197103279735, 12.677600425060888, 79.92838271748512, 1.4000000000000008, 726.5323219252269, 334.4594948965098, 6.117731031253248, 172.09315673205012, 631.4684678010257, 29.245388075379292, 176.69420906134215, 237.9203978361267, 22.89426822299461, 162.8734470073433, 68.89951792530566, 1.6316155314232423, 19.542769233275425, 116.83634012832584, 5.190636128677177, 279.3623392621018, 4.449511875522037, 527.1127438404055, 536.2462763132831, 350.2148278882423, 52.821614741337605, 8.808183987657074, 453.80525044948376], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-902.8765212696984, -736.5720792275405, -254.98812462497253, -526.0742093255973, -630.9969595497296, -724.4863312089378, -731.6430904031579, -688.4591625492843, -1065.241193092608, -572.3200029787096, -754.8422238451647, 181.5914451665019, -627.8848866322489, -56.185102949125195, -70.35286331285619, 80.21000784143109, -660.229836241894, -434.18392676260913, 353.6126677331044, -861.067994586476, 14.030544042576095, -904.2700795683382, -556.0693595127108, -717.5465682423918, -816.7938993212613, -488.4150040518236, -439.0068386024469, -683.2328851863564, -960.775462469109, -748.1510927584112, -970.7024295667999, -412.59979199311385, 3.855210938374011, -341.55885225029857, -760.2078679817661, -407.3001043838228, -554.1962893103076, -297.21289506213344, -821.1467959352356, -422.6073442140493, -406.24574056142524, -339.9306834165792, -712.5090505612475, -721.2312356222895, -837.8775540625315, -568.1601463500926, -566.204318027539, -863.0836133152795, 39.02984568331092, -973.3444492262296, -372.3566272721032, -635.3320394950418, -528.5233530356801, -723.114506451233, -485.2505901466131, -800.8896441949585, -830.4694828330561, -870.0428035387715, -210.870117242579, -235.8741867950913, -684.3370886878624, -863.0715090362147, -567.3870494200847, -840.7093735541209, -841.4659330327743, -4.354737279742475, -310.81098513713465, -884.3338288298488, -41.340555095062626, -752.9842884398713, -928.9368511924532, -672.7033387813534, -729.5677222832735, -757.0410610229369, -498.2353024584577, -106.39660834869258, -767.0928933781086, -91.88958893326142, -890.4130239255358, -682.2182250314355, -500.6385741802575, -673.2852936978738, -763.0191316172198, -958.0653881462705, -739.5678329079318, -511.62883413565663, -146.47839816070018, -407.16707561567154, -708.3517686766676, -689.4623405832474, -631.6258693691674, -223.26366930661715, -707.3871075084628, -641.7214994426957, -633.8771091002292, -299.61959759505544, -826.6687847052168, -678.4459982169477, -67.76231552880125, -123.92941206955312, -983.8705994950166, -282.3040083575064, -1041.446905824189, -320.10093371655654, -674.135215931944, 1.7033665449719944, 208.55642533751904, -476.9320314263537, 40.0000000000003, -778.9681983072719, -1026.386577540336, -164.777611138116, -478.06926765109495, -525.2036877681029, -146.24912338604565, -205.86399818502218, -511.7157466207677, -766.4388175917991, -733.8166061866256, -562.7456100074654, -523.3419345138367, 69.2255653910877, -924.9124497856614, 3.8262190244280196, -774.5846811545186, -780.3009741175448, -720.7483937894827, -159.76602011511895, -643.5616453727773, -6.006325100560332, -300.8248881835664, -160.32169239212777, -941.6319285147312, -878.202611774345, -317.90840923905057, -551.9464871275056, -257.8044214871005, -662.8479488470041, -648.4727189071813, -415.76577792519726, -837.6643332095152, -439.3724554217969, -579.5792616272927, -448.45766046204653, -451.3290370105932, -805.5578503684565, -755.2156328512069, -507.4617900000701, -646.7333545419086, -589.2813628479896, -196.43695544269286, -892.4732685828997, -499.02321835419406, -576.2581806656902, 363.5208703994206, -661.2544626828263, -684.1224469074, 23.81998686955795, -323.65320530307145, -682.5380296547894, -410.9637719533902, -745.643456088008, 44.63109026630619, -976.1332992131956, -811.5953733827995, -629.991981776055, -359.69786512194844, -781.232255438772, -833.5666834861963, -370.5034996875901, -694.1799156042105, -896.7865374463291, -512.9803496901704, -660.5260799109549, -694.5342946508142, -623.9809530666324, -610.2531772051916, -622.5702222002766, -486.06914241496236, -654.3169065446315, -899.2463368449446, -594.482964945319, -717.9761544471069, -362.04125147873737, -319.118409760766, -276.38196271884624, -517.6723106690006, -718.5253297171213, -734.7182798189036, 318.74248110075865, -94.30386566329283, -1059.4682076768208, -145.1723123525123, -452.8320438745616, -378.7990523666858, -597.8782961489072, -648.5292614334239, -747.4411614421812, -776.3098794743241, -232.50837482321072], "policy_predator_policy_reward": [905.4178629290556, 740.3748138717071, 529.1682552624395, 412.9891829375673, 639.0903632524802, 724.4863312089378, 780.9764858442667, 646.6955012756617, 981.8563520748547, 795.430357017192, 706.7406319408998, 436.05371940921384, 636.1848866322496, 270.9304601422225, 388.8140248251834, 0.0, 619.9949513815468, 599.4021380012182, 728.1779414082486, 732.5330566612338, 728.662890821697, 797.5632115654661, 580.5659048034386, 717.7465682423918, 817.2938993212614, 499.61500405182613, 447.19949690728527, 755.5030680476373, 960.775462469109, 748.1510927584112, 956.6060728348263, 509.80605197103455, 40.580578174724174, 542.8842532811742, 810.9142128517203, 402.62301581184005, 561.5723109894669, 344.10800914417393, 822.5467959352359, 561.2909979782096, 376.24383826795065, 403.33258571006155, 713.5735114901759, 722.5123219330382, 705.893022206605, 710.1671000456477, 723.1163378977556, 842.8960015530458, 679.7967043533363, 464.5780611564358, 607.2713318910328, 536.7173348761137, 670.3841604272776, 723.714506451233, 567.8404108170436, 800.3930605207266, 816.062350650419, 873.5126305284327, 274.55583897784163, 244.98489729633758, 684.3370886878624, 863.0715090362147, 572.2870494200859, 840.7093735541209, 784.993910330713, 717.918601546938, 713.0181046793284, 702.1417662332035, 591.2362583031359, 701.5000654048289, 929.2195394028489, 682.4847334083494, 729.7677222832735, 764.2410610229379, 513.0540319681304, 529.4943200066524, 756.4659327551578, 468.2347368282237, 896.4183392525636, 693.2898215983862, 610.7531077405389, 659.2605019740182, 763.0191316172198, 956.6986873452183, 740.2512997695829, 515.295158065993, 624.1750493271368, 232.87288378306155, 712.2517686766685, 698.5603072805535, 638.6905402122372, 243.64634274111165, 711.6612273512632, 642.3114960483109, 719.851265895396, 533.8313117675028, 827.0687847052168, 691.7881741885203, 285.25328094862874, 381.7097883994276, 812.777299927436, 807.3594295513058, 1038.253928042617, 381.97241804622286, 608.0187539259783, 246.91668220933954, 339.151317018544, 401.7931592697001, 640.8921599195844, 472.30546870793677, 976.2881998863393, 511.8657786831539, 509.16926765109577, 529.4036877681039, 339.54567064163166, 648.3560614248282, 605.3480069133279, 790.0299870144944, 744.9166061866259, 564.4456100074656, 535.6325046116622, 232.88024633782527, 804.0998312041488, 863.6750322562859, 777.884681154519, 796.2009741175447, 616.5330765618685, 530.9447725454661, 341.88474945326374, 619.1295261167068, 120.07832793670687, 534.2445454926273, 967.9382211103629, 865.9899643751081, 296.95163462430094, 683.016413977699, 722.9911915414883, 531.4808157740531, 654.2087045099224, 475.52055120626585, 574.838659382806, 875.1311599684968, 473.6364790952193, 705.6317510021248, 753.2542888157582, 990.6097037932471, 614.4186519188082, 783.2807419652669, 629.261594097994, 619.4307237169652, 323.06795368419154, 845.7706530588831, 500.42321835419426, 576.2581806656902, 364.9131210774944, 659.3527931311405, 538.2137061745098, 456.54824875983985, 327.1658101893453, 685.1431557997713, 598.3386746353942, 730.3617101380559, 670.4862301868616, 892.4844465610486, 815.6233922409476, 655.2093509932861, 541.416192129862, 776.2081374922032, 799.3016428681159, 642.6889381417986, 700.507818582097, 913.3529026914337, 684.3431971009916, 652.0366795074789, 588.8685858589254, 798.5461797838284, 608.5183767904332, 625.9366381464599, 504.91191164824005, 655.0169065446316, 929.969471158778, 680.5961707598129, 444.85261361030314, 640.3554284442179, 544.465416540773, 330.39729520094744, 512.1396888711181, 728.5074633905285, 507.85715596182683, 435.23138659672384, 766.2676764206755, 923.7506732327194, 445.48361792381905, 502.73556619149764, 390.79905236668833, 638.6999108902453, 651.3374454210816, 753.4411614421814, 687.2671559999512, 775.3563487470643]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.971705864142187, "mean_inference_ms": 4.403501239935164, "mean_action_processing_ms": 1.6874372402586315, "mean_env_wait_ms": 12.484233879439527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012862920761108398, "StateBufferConnector_ms": 0.01663649082183838, "ViewRequirementAgentConnector_ms": 0.1331787109375}, "num_episodes": 12, "episode_return_max": 953.2556712161095, "episode_return_min": -10.937305192975764, "episode_return_mean": 190.86094335049282, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 157.78120630055497, "num_env_steps_trained_throughput_per_sec": 157.78120630055497, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 25754.129, "restore_workers_time_ms": 0.024, "training_step_time_ms": 25753.915, "sample_time_ms": 2262.263, "learn_time_ms": 23466.926, "learn_throughput": 170.453, "synch_weights_time_ms": 21.675}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 69, "trial_id": "0b608_00000", "date": "2024-08-22_14-14-55", "timestamp": 1724316295, "time_this_iter_s": 25.404613733291626, "time_total_s": 1787.9822854995728, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a34ef70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1787.9822854995728, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 32.17222222222222, "ram_util_percent": 81.39166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.452155706869863, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.831622707023822, "policy_loss": -0.009160760696977377, "vf_loss": 7.840035206426388, "vf_explained_var": -0.06569734742401769, "kl": 0.007482562419618406, "entropy": 0.2855728698312921, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65678.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.799409038049202, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.9795772688729425, "policy_loss": -0.01008444357141064, "vf_loss": 7.98822930704349, "vf_explained_var": 0.4564068720454261, "kl": 0.007162148708344571, "entropy": 0.4968876505339587, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65678.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 953.2556712161095, "episode_reward_min": -10.937305192975764, "episode_reward_mean": 201.67453940640098, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1059.4682076768208, "predator_policy": 40.580578174724174}, "policy_reward_max": {"prey_policy": 363.5208703994206, "predator_policy": 1038.253928042617}, "policy_reward_mean": {"prey_policy": -527.1116780822786, "predator_policy": 627.9489477854794}, "custom_metrics": {}, "hist_stats": {"episode_reward": [124.98332637826452, 953.2556712161095, 635.9865668614013, 24.696545290727478, 11.699999999999969, 80.46284116611153, 3.774758283725532e-15, 83.10990324594515, 245.76119014397258, 46.02925629796715, 54.2711357612002, 140.08365376416035, 33.400000000000205, 2.345547239677093, 10.02242183962737, 136.72440810798523, 210.0601619668506, 136.29999999999976, 142.46080739159754, 82.09323699619304, -10.937305192975764, 72.79643223650885, 1.7763568394002505e-15, 4.899999999999999, 657.0918415651369, 220.01505694555192, 498.411480173034, 10.064082837390554, 7.4, 437.9164411676329, 365.71818727201327, 17.07691189397884, 96.0897418364257, -1.3667008010521915, 4.349790791987448, 303.4024593338257, 12.997966697305701, 27.44734427756494, 4.864116448415487, 320.1858709676171, 13.742175971572934, 475.2713417497059, 353.9621216262185, 58.678506548091, 182.50358674834385, 472.568870199411, 374.2294303202486, 296.9897898910443, 35.30000000000005, 635.7886104953916, 117.22342971525215, 12.79999999999999, 314.3963818267384, 746.6886326992066, 19.200000000000014, 266.96343520273615, 311.446305096632, 193.17629285364134, 14.093645196394618, 110.11315223544337, 333.81963698143596, 65.49075888380565, 172.93303071998417, 151.2313080080027, 486.9771052299614, 135.02197103279735, 12.677600425060888, 79.92838271748512, 1.4000000000000008, 726.5323219252269, 334.4594948965098, 6.117731031253248, 172.09315673205012, 631.4684678010257, 29.245388075379292, 176.69420906134215, 237.9203978361267, 22.89426822299461, 162.8734470073433, 68.89951792530566, 1.6316155314232423, 19.542769233275425, 116.83634012832584, 5.190636128677177, 279.3623392621018, 4.449511875522037, 527.1127438404055, 536.2462763132831, 350.2148278882423, 52.821614741337605, 8.808183987657074, 453.80525044948376, 616.2112518536981, 462.472015943553, 136.2763391080148, 1.4172494993952536, 325.51187249648063, 680.7441979454821, 223.37125155242717, 149.44335785399232], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-660.229836241894, -434.18392676260913, 353.6126677331044, -861.067994586476, 14.030544042576095, -904.2700795683382, -556.0693595127108, -717.5465682423918, -816.7938993212613, -488.4150040518236, -439.0068386024469, -683.2328851863564, -960.775462469109, -748.1510927584112, -970.7024295667999, -412.59979199311385, 3.855210938374011, -341.55885225029857, -760.2078679817661, -407.3001043838228, -554.1962893103076, -297.21289506213344, -821.1467959352356, -422.6073442140493, -406.24574056142524, -339.9306834165792, -712.5090505612475, -721.2312356222895, -837.8775540625315, -568.1601463500926, -566.204318027539, -863.0836133152795, 39.02984568331092, -973.3444492262296, -372.3566272721032, -635.3320394950418, -528.5233530356801, -723.114506451233, -485.2505901466131, -800.8896441949585, -830.4694828330561, -870.0428035387715, -210.870117242579, -235.8741867950913, -684.3370886878624, -863.0715090362147, -567.3870494200847, -840.7093735541209, -841.4659330327743, -4.354737279742475, -310.81098513713465, -884.3338288298488, -41.340555095062626, -752.9842884398713, -928.9368511924532, -672.7033387813534, -729.5677222832735, -757.0410610229369, -498.2353024584577, -106.39660834869258, -767.0928933781086, -91.88958893326142, -890.4130239255358, -682.2182250314355, -500.6385741802575, -673.2852936978738, -763.0191316172198, -958.0653881462705, -739.5678329079318, -511.62883413565663, -146.47839816070018, -407.16707561567154, -708.3517686766676, -689.4623405832474, -631.6258693691674, -223.26366930661715, -707.3871075084628, -641.7214994426957, -633.8771091002292, -299.61959759505544, -826.6687847052168, -678.4459982169477, -67.76231552880125, -123.92941206955312, -983.8705994950166, -282.3040083575064, -1041.446905824189, -320.10093371655654, -674.135215931944, 1.7033665449719944, 208.55642533751904, -476.9320314263537, 40.0000000000003, -778.9681983072719, -1026.386577540336, -164.777611138116, -478.06926765109495, -525.2036877681029, -146.24912338604565, -205.86399818502218, -511.7157466207677, -766.4388175917991, -733.8166061866256, -562.7456100074654, -523.3419345138367, 69.2255653910877, -924.9124497856614, 3.8262190244280196, -774.5846811545186, -780.3009741175448, -720.7483937894827, -159.76602011511895, -643.5616453727773, -6.006325100560332, -300.8248881835664, -160.32169239212777, -941.6319285147312, -878.202611774345, -317.90840923905057, -551.9464871275056, -257.8044214871005, -662.8479488470041, -648.4727189071813, -415.76577792519726, -837.6643332095152, -439.3724554217969, -579.5792616272927, -448.45766046204653, -451.3290370105932, -805.5578503684565, -755.2156328512069, -507.4617900000701, -646.7333545419086, -589.2813628479896, -196.43695544269286, -892.4732685828997, -499.02321835419406, -576.2581806656902, 363.5208703994206, -661.2544626828263, -684.1224469074, 23.81998686955795, -323.65320530307145, -682.5380296547894, -410.9637719533902, -745.643456088008, 44.63109026630619, -976.1332992131956, -811.5953733827995, -629.991981776055, -359.69786512194844, -781.232255438772, -833.5666834861963, -370.5034996875901, -694.1799156042105, -896.7865374463291, -512.9803496901704, -660.5260799109549, -694.5342946508142, -623.9809530666324, -610.2531772051916, -622.5702222002766, -486.06914241496236, -654.3169065446315, -899.2463368449446, -594.482964945319, -717.9761544471069, -362.04125147873737, -319.118409760766, -276.38196271884624, -517.6723106690006, -718.5253297171213, -734.7182798189036, 318.74248110075865, -94.30386566329283, -1059.4682076768208, -145.1723123525123, -452.8320438745616, -378.7990523666858, -597.8782961489072, -648.5292614334239, -747.4411614421812, -776.3098794743241, -232.50837482321072, -838.1261943874212, 275.6237650251913, -91.03568837906396, -560.7335852246209, -603.6445416490735, -123.88468321562792, -479.7199559681842, -350.1461987727106, -215.55071493984377, -488.7190425436826, -73.22268910997553, -832.8232387842684, -403.0083300815703, -908.4488450387566, -21.295704763427793, -832.9948434171824], "policy_predator_policy_reward": [619.9949513815468, 599.4021380012182, 728.1779414082486, 732.5330566612338, 728.662890821697, 797.5632115654661, 580.5659048034386, 717.7465682423918, 817.2938993212614, 499.61500405182613, 447.19949690728527, 755.5030680476373, 960.775462469109, 748.1510927584112, 956.6060728348263, 509.80605197103455, 40.580578174724174, 542.8842532811742, 810.9142128517203, 402.62301581184005, 561.5723109894669, 344.10800914417393, 822.5467959352359, 561.2909979782096, 376.24383826795065, 403.33258571006155, 713.5735114901759, 722.5123219330382, 705.893022206605, 710.1671000456477, 723.1163378977556, 842.8960015530458, 679.7967043533363, 464.5780611564358, 607.2713318910328, 536.7173348761137, 670.3841604272776, 723.714506451233, 567.8404108170436, 800.3930605207266, 816.062350650419, 873.5126305284327, 274.55583897784163, 244.98489729633758, 684.3370886878624, 863.0715090362147, 572.2870494200859, 840.7093735541209, 784.993910330713, 717.918601546938, 713.0181046793284, 702.1417662332035, 591.2362583031359, 701.5000654048289, 929.2195394028489, 682.4847334083494, 729.7677222832735, 764.2410610229379, 513.0540319681304, 529.4943200066524, 756.4659327551578, 468.2347368282237, 896.4183392525636, 693.2898215983862, 610.7531077405389, 659.2605019740182, 763.0191316172198, 956.6986873452183, 740.2512997695829, 515.295158065993, 624.1750493271368, 232.87288378306155, 712.2517686766685, 698.5603072805535, 638.6905402122372, 243.64634274111165, 711.6612273512632, 642.3114960483109, 719.851265895396, 533.8313117675028, 827.0687847052168, 691.7881741885203, 285.25328094862874, 381.7097883994276, 812.777299927436, 807.3594295513058, 1038.253928042617, 381.97241804622286, 608.0187539259783, 246.91668220933954, 339.151317018544, 401.7931592697001, 640.8921599195844, 472.30546870793677, 976.2881998863393, 511.8657786831539, 509.16926765109577, 529.4036877681039, 339.54567064163166, 648.3560614248282, 605.3480069133279, 790.0299870144944, 744.9166061866259, 564.4456100074656, 535.6325046116622, 232.88024633782527, 804.0998312041488, 863.6750322562859, 777.884681154519, 796.2009741175447, 616.5330765618685, 530.9447725454661, 341.88474945326374, 619.1295261167068, 120.07832793670687, 534.2445454926273, 967.9382211103629, 865.9899643751081, 296.95163462430094, 683.016413977699, 722.9911915414883, 531.4808157740531, 654.2087045099224, 475.52055120626585, 574.838659382806, 875.1311599684968, 473.6364790952193, 705.6317510021248, 753.2542888157582, 990.6097037932471, 614.4186519188082, 783.2807419652669, 629.261594097994, 619.4307237169652, 323.06795368419154, 845.7706530588831, 500.42321835419426, 576.2581806656902, 364.9131210774944, 659.3527931311405, 538.2137061745098, 456.54824875983985, 327.1658101893453, 685.1431557997713, 598.3386746353942, 730.3617101380559, 670.4862301868616, 892.4844465610486, 815.6233922409476, 655.2093509932861, 541.416192129862, 776.2081374922032, 799.3016428681159, 642.6889381417986, 700.507818582097, 913.3529026914337, 684.3431971009916, 652.0366795074789, 588.8685858589254, 798.5461797838284, 608.5183767904332, 625.9366381464599, 504.91191164824005, 655.0169065446316, 929.969471158778, 680.5961707598129, 444.85261361030314, 640.3554284442179, 544.465416540773, 330.39729520094744, 512.1396888711181, 728.5074633905285, 507.85715596182683, 435.23138659672384, 766.2676764206755, 923.7506732327194, 445.48361792381905, 502.73556619149764, 390.79905236668833, 638.6999108902453, 651.3374454210816, 753.4411614421814, 687.2671559999512, 775.3563487470643, 844.2881603714601, 334.4255208444671, 694.0947409691743, 420.1465485780619, 581.1296547843142, 282.6759091884047, 383.4141160206325, 447.86928821966376, 567.326654279804, 462.45497570020484, 812.7541025951883, 774.0360232445391, 673.3879566240657, 861.4404700486886, 170.92671203278056, 832.807194001822]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.96573828964834, "mean_inference_ms": 4.402587535343211, "mean_action_processing_ms": 1.6814111264488838, "mean_env_wait_ms": 12.484430894710378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01288306713104248, "StateBufferConnector_ms": 0.01592075824737549, "ViewRequirementAgentConnector_ms": 0.14610540866851807}, "num_episodes": 8, "episode_return_max": 953.2556712161095, "episode_return_min": -10.937305192975764, "episode_return_mean": 201.67453940640098, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.49038066144593, "num_env_steps_trained_throughput_per_sec": 155.49038066144593, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 25735.874, "restore_workers_time_ms": 0.024, "training_step_time_ms": 25735.661, "sample_time_ms": 2239.857, "learn_time_ms": 23471.348, "learn_throughput": 170.421, "synch_weights_time_ms": 21.482}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 70, "trial_id": "0b608_00000", "date": "2024-08-22_14-15-21", "timestamp": 1724316321, "time_this_iter_s": 25.783632040023804, "time_total_s": 1813.7659175395966, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a38dee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1813.7659175395966, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 32.26216216216217, "ram_util_percent": 82.02432432432431}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.316084349849238, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.843072716647355, "policy_loss": -0.009863628529347282, "vf_loss": 7.852064240672601, "vf_explained_var": 0.0002045172232168692, "kl": 0.008720706289180766, "entropy": 0.28886673220250975, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 66623.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.663025976362682, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.531926982112663, "policy_loss": -0.007662235470439391, "vf_loss": 7.5382358949651165, "vf_explained_var": 0.44698237943901586, "kl": 0.006766623280272282, "entropy": 0.4755427671172631, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 66623.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "env_runners": {"episode_reward_max": 746.6886326992066, "episode_reward_min": -18.158560437270452, "episode_reward_mean": 193.9629247462864, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1059.4682076768208, "predator_policy": 59.58784788958357}, "policy_reward_max": {"prey_policy": 363.5208703994206, "predator_policy": 1038.253928042617}, "policy_reward_mean": {"prey_policy": -521.3563059582928, "predator_policy": 618.3377683314362}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.02925629796715, 54.2711357612002, 140.08365376416035, 33.400000000000205, 2.345547239677093, 10.02242183962737, 136.72440810798523, 210.0601619668506, 136.29999999999976, 142.46080739159754, 82.09323699619304, -10.937305192975764, 72.79643223650885, 1.7763568394002505e-15, 4.899999999999999, 657.0918415651369, 220.01505694555192, 498.411480173034, 10.064082837390554, 7.4, 437.9164411676329, 365.71818727201327, 17.07691189397884, 96.0897418364257, -1.3667008010521915, 4.349790791987448, 303.4024593338257, 12.997966697305701, 27.44734427756494, 4.864116448415487, 320.1858709676171, 13.742175971572934, 475.2713417497059, 353.9621216262185, 58.678506548091, 182.50358674834385, 472.568870199411, 374.2294303202486, 296.9897898910443, 35.30000000000005, 635.7886104953916, 117.22342971525215, 12.79999999999999, 314.3963818267384, 746.6886326992066, 19.200000000000014, 266.96343520273615, 311.446305096632, 193.17629285364134, 14.093645196394618, 110.11315223544337, 333.81963698143596, 65.49075888380565, 172.93303071998417, 151.2313080080027, 486.9771052299614, 135.02197103279735, 12.677600425060888, 79.92838271748512, 1.4000000000000008, 726.5323219252269, 334.4594948965098, 6.117731031253248, 172.09315673205012, 631.4684678010257, 29.245388075379292, 176.69420906134215, 237.9203978361267, 22.89426822299461, 162.8734470073433, 68.89951792530566, 1.6316155314232423, 19.542769233275425, 116.83634012832584, 5.190636128677177, 279.3623392621018, 4.449511875522037, 527.1127438404055, 536.2462763132831, 350.2148278882423, 52.821614741337605, 8.808183987657074, 453.80525044948376, 616.2112518536981, 462.472015943553, 136.2763391080148, 1.4172494993952536, 325.51187249648063, 680.7441979454821, 223.37125155242717, 149.44335785399232, 120.08168867184115, -18.158560437270452, 239.0282275626621, 7.782891632747981, 744.0255341164683, 86.29973182480515, 25.62678125181678, 144.68109110172855, 39.427192566285086], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-760.2078679817661, -407.3001043838228, -554.1962893103076, -297.21289506213344, -821.1467959352356, -422.6073442140493, -406.24574056142524, -339.9306834165792, -712.5090505612475, -721.2312356222895, -837.8775540625315, -568.1601463500926, -566.204318027539, -863.0836133152795, 39.02984568331092, -973.3444492262296, -372.3566272721032, -635.3320394950418, -528.5233530356801, -723.114506451233, -485.2505901466131, -800.8896441949585, -830.4694828330561, -870.0428035387715, -210.870117242579, -235.8741867950913, -684.3370886878624, -863.0715090362147, -567.3870494200847, -840.7093735541209, -841.4659330327743, -4.354737279742475, -310.81098513713465, -884.3338288298488, -41.340555095062626, -752.9842884398713, -928.9368511924532, -672.7033387813534, -729.5677222832735, -757.0410610229369, -498.2353024584577, -106.39660834869258, -767.0928933781086, -91.88958893326142, -890.4130239255358, -682.2182250314355, -500.6385741802575, -673.2852936978738, -763.0191316172198, -958.0653881462705, -739.5678329079318, -511.62883413565663, -146.47839816070018, -407.16707561567154, -708.3517686766676, -689.4623405832474, -631.6258693691674, -223.26366930661715, -707.3871075084628, -641.7214994426957, -633.8771091002292, -299.61959759505544, -826.6687847052168, -678.4459982169477, -67.76231552880125, -123.92941206955312, -983.8705994950166, -282.3040083575064, -1041.446905824189, -320.10093371655654, -674.135215931944, 1.7033665449719944, 208.55642533751904, -476.9320314263537, 40.0000000000003, -778.9681983072719, -1026.386577540336, -164.777611138116, -478.06926765109495, -525.2036877681029, -146.24912338604565, -205.86399818502218, -511.7157466207677, -766.4388175917991, -733.8166061866256, -562.7456100074654, -523.3419345138367, 69.2255653910877, -924.9124497856614, 3.8262190244280196, -774.5846811545186, -780.3009741175448, -720.7483937894827, -159.76602011511895, -643.5616453727773, -6.006325100560332, -300.8248881835664, -160.32169239212777, -941.6319285147312, -878.202611774345, -317.90840923905057, -551.9464871275056, -257.8044214871005, -662.8479488470041, -648.4727189071813, -415.76577792519726, -837.6643332095152, -439.3724554217969, -579.5792616272927, -448.45766046204653, -451.3290370105932, -805.5578503684565, -755.2156328512069, -507.4617900000701, -646.7333545419086, -589.2813628479896, -196.43695544269286, -892.4732685828997, -499.02321835419406, -576.2581806656902, 363.5208703994206, -661.2544626828263, -684.1224469074, 23.81998686955795, -323.65320530307145, -682.5380296547894, -410.9637719533902, -745.643456088008, 44.63109026630619, -976.1332992131956, -811.5953733827995, -629.991981776055, -359.69786512194844, -781.232255438772, -833.5666834861963, -370.5034996875901, -694.1799156042105, -896.7865374463291, -512.9803496901704, -660.5260799109549, -694.5342946508142, -623.9809530666324, -610.2531772051916, -622.5702222002766, -486.06914241496236, -654.3169065446315, -899.2463368449446, -594.482964945319, -717.9761544471069, -362.04125147873737, -319.118409760766, -276.38196271884624, -517.6723106690006, -718.5253297171213, -734.7182798189036, 318.74248110075865, -94.30386566329283, -1059.4682076768208, -145.1723123525123, -452.8320438745616, -378.7990523666858, -597.8782961489072, -648.5292614334239, -747.4411614421812, -776.3098794743241, -232.50837482321072, -838.1261943874212, 275.6237650251913, -91.03568837906396, -560.7335852246209, -603.6445416490735, -123.88468321562792, -479.7199559681842, -350.1461987727106, -215.55071493984377, -488.7190425436826, -73.22268910997553, -832.8232387842684, -403.0083300815703, -908.4488450387566, -21.295704763427793, -832.9948434171824, -401.5839059188357, -133.85605997465083, -498.5708320604365, -788.068832369545, 16.94431043716812, -92.54017563917463, -714.7711786128249, -837.0086067815972, -904.173649571877, 168.3063552966244, -326.4489471429074, -586.7427313511034, -425.6858041811654, -788.7308845024082, -740.8479949226694, 0.6185431951921757, -788.0174027445997, -630.8533767580087], "policy_predator_policy_reward": [810.9142128517203, 402.62301581184005, 561.5723109894669, 344.10800914417393, 822.5467959352359, 561.2909979782096, 376.24383826795065, 403.33258571006155, 713.5735114901759, 722.5123219330382, 705.893022206605, 710.1671000456477, 723.1163378977556, 842.8960015530458, 679.7967043533363, 464.5780611564358, 607.2713318910328, 536.7173348761137, 670.3841604272776, 723.714506451233, 567.8404108170436, 800.3930605207266, 816.062350650419, 873.5126305284327, 274.55583897784163, 244.98489729633758, 684.3370886878624, 863.0715090362147, 572.2870494200859, 840.7093735541209, 784.993910330713, 717.918601546938, 713.0181046793284, 702.1417662332035, 591.2362583031359, 701.5000654048289, 929.2195394028489, 682.4847334083494, 729.7677222832735, 764.2410610229379, 513.0540319681304, 529.4943200066524, 756.4659327551578, 468.2347368282237, 896.4183392525636, 693.2898215983862, 610.7531077405389, 659.2605019740182, 763.0191316172198, 956.6986873452183, 740.2512997695829, 515.295158065993, 624.1750493271368, 232.87288378306155, 712.2517686766685, 698.5603072805535, 638.6905402122372, 243.64634274111165, 711.6612273512632, 642.3114960483109, 719.851265895396, 533.8313117675028, 827.0687847052168, 691.7881741885203, 285.25328094862874, 381.7097883994276, 812.777299927436, 807.3594295513058, 1038.253928042617, 381.97241804622286, 608.0187539259783, 246.91668220933954, 339.151317018544, 401.7931592697001, 640.8921599195844, 472.30546870793677, 976.2881998863393, 511.8657786831539, 509.16926765109577, 529.4036877681039, 339.54567064163166, 648.3560614248282, 605.3480069133279, 790.0299870144944, 744.9166061866259, 564.4456100074656, 535.6325046116622, 232.88024633782527, 804.0998312041488, 863.6750322562859, 777.884681154519, 796.2009741175447, 616.5330765618685, 530.9447725454661, 341.88474945326374, 619.1295261167068, 120.07832793670687, 534.2445454926273, 967.9382211103629, 865.9899643751081, 296.95163462430094, 683.016413977699, 722.9911915414883, 531.4808157740531, 654.2087045099224, 475.52055120626585, 574.838659382806, 875.1311599684968, 473.6364790952193, 705.6317510021248, 753.2542888157582, 990.6097037932471, 614.4186519188082, 783.2807419652669, 629.261594097994, 619.4307237169652, 323.06795368419154, 845.7706530588831, 500.42321835419426, 576.2581806656902, 364.9131210774944, 659.3527931311405, 538.2137061745098, 456.54824875983985, 327.1658101893453, 685.1431557997713, 598.3386746353942, 730.3617101380559, 670.4862301868616, 892.4844465610486, 815.6233922409476, 655.2093509932861, 541.416192129862, 776.2081374922032, 799.3016428681159, 642.6889381417986, 700.507818582097, 913.3529026914337, 684.3431971009916, 652.0366795074789, 588.8685858589254, 798.5461797838284, 608.5183767904332, 625.9366381464599, 504.91191164824005, 655.0169065446316, 929.969471158778, 680.5961707598129, 444.85261361030314, 640.3554284442179, 544.465416540773, 330.39729520094744, 512.1396888711181, 728.5074633905285, 507.85715596182683, 435.23138659672384, 766.2676764206755, 923.7506732327194, 445.48361792381905, 502.73556619149764, 390.79905236668833, 638.6999108902453, 651.3374454210816, 753.4411614421814, 687.2671559999512, 775.3563487470643, 844.2881603714601, 334.4255208444671, 694.0947409691743, 420.1465485780619, 581.1296547843142, 282.6759091884047, 383.4141160206325, 447.86928821966376, 567.326654279804, 462.45497570020484, 812.7541025951883, 774.0360232445391, 673.3879566240657, 861.4404700486886, 170.92671203278056, 832.807194001822, 566.472334149306, 89.04932041602414, 806.746990872346, 461.7341131203655, 255.036244875085, 59.58784788958357, 722.5711786128267, 836.9914984143452, 839.1640782214504, 640.7287501702668, 376.7535694650589, 622.7378408537597, 451.0125854329848, 789.0308845024082, 742.7073727387426, 142.20317009046497, 788.0174027445997, 670.2805693242943]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.970683690033172, "mean_inference_ms": 4.412139838327331, "mean_action_processing_ms": 1.661630901083737, "mean_env_wait_ms": 12.49999294741816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011653304100036621, "StateBufferConnector_ms": 0.015822529792785645, "ViewRequirementAgentConnector_ms": 0.13779890537261963}, "num_episodes": 9, "episode_return_max": 746.6886326992066, "episode_return_min": -18.158560437270452, "episode_return_mean": 193.9629247462864, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.45619574704676, "num_env_steps_trained_throughput_per_sec": 155.45619574704676, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 1136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 25746.977, "restore_workers_time_ms": 0.024, "training_step_time_ms": 25746.739, "sample_time_ms": 2218.436, "learn_time_ms": 23503.442, "learn_throughput": 170.188, "synch_weights_time_ms": 21.47}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "done": false, "training_iteration": 71, "trial_id": "0b608_00000", "date": "2024-08-22_14-15-47", "timestamp": 1724316347, "time_this_iter_s": 25.784213066101074, "time_total_s": 1839.5501306056976, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30e415dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1839.5501306056976, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 34.50277777777777, "ram_util_percent": 81.95833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.805463659447966, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.037949265878668, "policy_loss": -0.008892843106061851, "vf_loss": 8.046006144669951, "vf_explained_var": 0.0710354661815381, "kl": 0.008359818928012694, "entropy": 0.25221126445386777, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67568.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000576}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.191750603756578, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.464467124333457, "policy_loss": -0.008635066224942131, "vf_loss": 7.471443684391244, "vf_explained_var": 0.4713687629926772, "kl": 0.008292559699140608, "entropy": 0.5037260386994276, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67568.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000576}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 746.6886326992066, "episode_reward_min": -18.158560437270452, "episode_reward_mean": 195.64224492265433, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1059.4682076768208, "predator_policy": 59.58784788958357}, "policy_reward_max": {"prey_policy": 363.5208703994206, "predator_policy": 1038.253928042617}, "policy_reward_mean": {"prey_policy": -516.8201524127309, "predator_policy": 614.6412748740581}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.937305192975764, 72.79643223650885, 1.7763568394002505e-15, 4.899999999999999, 657.0918415651369, 220.01505694555192, 498.411480173034, 10.064082837390554, 7.4, 437.9164411676329, 365.71818727201327, 17.07691189397884, 96.0897418364257, -1.3667008010521915, 4.349790791987448, 303.4024593338257, 12.997966697305701, 27.44734427756494, 4.864116448415487, 320.1858709676171, 13.742175971572934, 475.2713417497059, 353.9621216262185, 58.678506548091, 182.50358674834385, 472.568870199411, 374.2294303202486, 296.9897898910443, 35.30000000000005, 635.7886104953916, 117.22342971525215, 12.79999999999999, 314.3963818267384, 746.6886326992066, 19.200000000000014, 266.96343520273615, 311.446305096632, 193.17629285364134, 14.093645196394618, 110.11315223544337, 333.81963698143596, 65.49075888380565, 172.93303071998417, 151.2313080080027, 486.9771052299614, 135.02197103279735, 12.677600425060888, 79.92838271748512, 1.4000000000000008, 726.5323219252269, 334.4594948965098, 6.117731031253248, 172.09315673205012, 631.4684678010257, 29.245388075379292, 176.69420906134215, 237.9203978361267, 22.89426822299461, 162.8734470073433, 68.89951792530566, 1.6316155314232423, 19.542769233275425, 116.83634012832584, 5.190636128677177, 279.3623392621018, 4.449511875522037, 527.1127438404055, 536.2462763132831, 350.2148278882423, 52.821614741337605, 8.808183987657074, 453.80525044948376, 616.2112518536981, 462.472015943553, 136.2763391080148, 1.4172494993952536, 325.51187249648063, 680.7441979454821, 223.37125155242717, 149.44335785399232, 120.08168867184115, -18.158560437270452, 239.0282275626621, 7.782891632747981, 744.0255341164683, 86.29973182480515, 25.62678125181678, 144.68109110172855, 39.427192566285086, 19.0452414085533, 294.64004488921984, 7.29999999999999, 41.327726423745546, 218.47717166129587, 79.34906596823126, 8.140331935407776, 15.299999999999976, 319.4255118748112, 8.899999999999979, 149.81755284077673], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-830.4694828330561, -870.0428035387715, -210.870117242579, -235.8741867950913, -684.3370886878624, -863.0715090362147, -567.3870494200847, -840.7093735541209, -841.4659330327743, -4.354737279742475, -310.81098513713465, -884.3338288298488, -41.340555095062626, -752.9842884398713, -928.9368511924532, -672.7033387813534, -729.5677222832735, -757.0410610229369, -498.2353024584577, -106.39660834869258, -767.0928933781086, -91.88958893326142, -890.4130239255358, -682.2182250314355, -500.6385741802575, -673.2852936978738, -763.0191316172198, -958.0653881462705, -739.5678329079318, -511.62883413565663, -146.47839816070018, -407.16707561567154, -708.3517686766676, -689.4623405832474, -631.6258693691674, -223.26366930661715, -707.3871075084628, -641.7214994426957, -633.8771091002292, -299.61959759505544, -826.6687847052168, -678.4459982169477, -67.76231552880125, -123.92941206955312, -983.8705994950166, -282.3040083575064, -1041.446905824189, -320.10093371655654, -674.135215931944, 1.7033665449719944, 208.55642533751904, -476.9320314263537, 40.0000000000003, -778.9681983072719, -1026.386577540336, -164.777611138116, -478.06926765109495, -525.2036877681029, -146.24912338604565, -205.86399818502218, -511.7157466207677, -766.4388175917991, -733.8166061866256, -562.7456100074654, -523.3419345138367, 69.2255653910877, -924.9124497856614, 3.8262190244280196, -774.5846811545186, -780.3009741175448, -720.7483937894827, -159.76602011511895, -643.5616453727773, -6.006325100560332, -300.8248881835664, -160.32169239212777, -941.6319285147312, -878.202611774345, -317.90840923905057, -551.9464871275056, -257.8044214871005, -662.8479488470041, -648.4727189071813, -415.76577792519726, -837.6643332095152, -439.3724554217969, -579.5792616272927, -448.45766046204653, -451.3290370105932, -805.5578503684565, -755.2156328512069, -507.4617900000701, -646.7333545419086, -589.2813628479896, -196.43695544269286, -892.4732685828997, -499.02321835419406, -576.2581806656902, 363.5208703994206, -661.2544626828263, -684.1224469074, 23.81998686955795, -323.65320530307145, -682.5380296547894, -410.9637719533902, -745.643456088008, 44.63109026630619, -976.1332992131956, -811.5953733827995, -629.991981776055, -359.69786512194844, -781.232255438772, -833.5666834861963, -370.5034996875901, -694.1799156042105, -896.7865374463291, -512.9803496901704, -660.5260799109549, -694.5342946508142, -623.9809530666324, -610.2531772051916, -622.5702222002766, -486.06914241496236, -654.3169065446315, -899.2463368449446, -594.482964945319, -717.9761544471069, -362.04125147873737, -319.118409760766, -276.38196271884624, -517.6723106690006, -718.5253297171213, -734.7182798189036, 318.74248110075865, -94.30386566329283, -1059.4682076768208, -145.1723123525123, -452.8320438745616, -378.7990523666858, -597.8782961489072, -648.5292614334239, -747.4411614421812, -776.3098794743241, -232.50837482321072, -838.1261943874212, 275.6237650251913, -91.03568837906396, -560.7335852246209, -603.6445416490735, -123.88468321562792, -479.7199559681842, -350.1461987727106, -215.55071493984377, -488.7190425436826, -73.22268910997553, -832.8232387842684, -403.0083300815703, -908.4488450387566, -21.295704763427793, -832.9948434171824, -401.5839059188357, -133.85605997465083, -498.5708320604365, -788.068832369545, 16.94431043716812, -92.54017563917463, -714.7711786128249, -837.0086067815972, -904.173649571877, 168.3063552966244, -326.4489471429074, -586.7427313511034, -425.6858041811654, -788.7308845024082, -740.8479949226694, 0.6185431951921757, -788.0174027445997, -630.8533767580087, -616.8621830000667, -800.7965256471718, 90.8275578008627, -582.2370812774293, -551.6886111337235, -872.4521042692202, -508.7183902567281, -695.6820146670958, -122.24043438508696, -751.800628071084, -369.07874245306357, -643.6168689807699, -662.1216738953652, -656.0218890406741, -412.55326860916193, -584.6589464799764, -736.4964697089653, -63.96812982034456, -678.0900590319147, -380.7030101150849, -848.2165645484681, -403.2882562399033], "policy_predator_policy_reward": [816.062350650419, 873.5126305284327, 274.55583897784163, 244.98489729633758, 684.3370886878624, 863.0715090362147, 572.2870494200859, 840.7093735541209, 784.993910330713, 717.918601546938, 713.0181046793284, 702.1417662332035, 591.2362583031359, 701.5000654048289, 929.2195394028489, 682.4847334083494, 729.7677222832735, 764.2410610229379, 513.0540319681304, 529.4943200066524, 756.4659327551578, 468.2347368282237, 896.4183392525636, 693.2898215983862, 610.7531077405389, 659.2605019740182, 763.0191316172198, 956.6986873452183, 740.2512997695829, 515.295158065993, 624.1750493271368, 232.87288378306155, 712.2517686766685, 698.5603072805535, 638.6905402122372, 243.64634274111165, 711.6612273512632, 642.3114960483109, 719.851265895396, 533.8313117675028, 827.0687847052168, 691.7881741885203, 285.25328094862874, 381.7097883994276, 812.777299927436, 807.3594295513058, 1038.253928042617, 381.97241804622286, 608.0187539259783, 246.91668220933954, 339.151317018544, 401.7931592697001, 640.8921599195844, 472.30546870793677, 976.2881998863393, 511.8657786831539, 509.16926765109577, 529.4036877681039, 339.54567064163166, 648.3560614248282, 605.3480069133279, 790.0299870144944, 744.9166061866259, 564.4456100074656, 535.6325046116622, 232.88024633782527, 804.0998312041488, 863.6750322562859, 777.884681154519, 796.2009741175447, 616.5330765618685, 530.9447725454661, 341.88474945326374, 619.1295261167068, 120.07832793670687, 534.2445454926273, 967.9382211103629, 865.9899643751081, 296.95163462430094, 683.016413977699, 722.9911915414883, 531.4808157740531, 654.2087045099224, 475.52055120626585, 574.838659382806, 875.1311599684968, 473.6364790952193, 705.6317510021248, 753.2542888157582, 990.6097037932471, 614.4186519188082, 783.2807419652669, 629.261594097994, 619.4307237169652, 323.06795368419154, 845.7706530588831, 500.42321835419426, 576.2581806656902, 364.9131210774944, 659.3527931311405, 538.2137061745098, 456.54824875983985, 327.1658101893453, 685.1431557997713, 598.3386746353942, 730.3617101380559, 670.4862301868616, 892.4844465610486, 815.6233922409476, 655.2093509932861, 541.416192129862, 776.2081374922032, 799.3016428681159, 642.6889381417986, 700.507818582097, 913.3529026914337, 684.3431971009916, 652.0366795074789, 588.8685858589254, 798.5461797838284, 608.5183767904332, 625.9366381464599, 504.91191164824005, 655.0169065446316, 929.969471158778, 680.5961707598129, 444.85261361030314, 640.3554284442179, 544.465416540773, 330.39729520094744, 512.1396888711181, 728.5074633905285, 507.85715596182683, 435.23138659672384, 766.2676764206755, 923.7506732327194, 445.48361792381905, 502.73556619149764, 390.79905236668833, 638.6999108902453, 651.3374454210816, 753.4411614421814, 687.2671559999512, 775.3563487470643, 844.2881603714601, 334.4255208444671, 694.0947409691743, 420.1465485780619, 581.1296547843142, 282.6759091884047, 383.4141160206325, 447.86928821966376, 567.326654279804, 462.45497570020484, 812.7541025951883, 774.0360232445391, 673.3879566240657, 861.4404700486886, 170.92671203278056, 832.807194001822, 566.472334149306, 89.04932041602414, 806.746990872346, 461.7341131203655, 255.036244875085, 59.58784788958357, 722.5711786128267, 836.9914984143452, 839.1640782214504, 640.7287501702668, 376.7535694650589, 622.7378408537597, 451.0125854329848, 789.0308845024082, 742.7073727387426, 142.20317009046497, 788.0174027445997, 670.2805693242943, 610.9210256474115, 825.782924408381, 213.340522615083, 572.7090457507036, 557.7886111337244, 873.6521042692204, 528.018390256729, 717.7097410908423, 692.4102069574304, 400.10802716003684, 517.0392681614949, 575.0054092405704, 674.2879252130833, 651.9959696583645, 423.9532686091642, 588.5589464799765, 501.82657151262435, 618.0635398914978, 682.7900590319158, 384.90301011508643, 847.068205057228, 554.2541685719191]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.961468604611702, "mean_inference_ms": 4.400166139871738, "mean_action_processing_ms": 1.6684175187881032, "mean_env_wait_ms": 12.486766407230014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011558890342712402, "StateBufferConnector_ms": 0.015814661979675293, "ViewRequirementAgentConnector_ms": 0.13219070434570312}, "num_episodes": 11, "episode_return_max": 746.6886326992066, "episode_return_min": -18.158560437270452, "episode_return_mean": 195.64224492265433, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 151.60478744712256, "num_env_steps_trained_throughput_per_sec": 151.60478744712256, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 25811.582, "restore_workers_time_ms": 0.024, "training_step_time_ms": 25811.368, "sample_time_ms": 2256.783, "learn_time_ms": 23530.062, "learn_throughput": 169.995, "synch_weights_time_ms": 20.891}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 72, "trial_id": "0b608_00000", "date": "2024-08-22_14-16-13", "timestamp": 1724316373, "time_this_iter_s": 26.430214881896973, "time_total_s": 1865.9803454875946, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a366820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1865.9803454875946, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 33.57567567567568, "ram_util_percent": 82.61891891891892}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.711737574723664, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.574322468389279, "policy_loss": -0.008509935225759234, "vf_loss": 7.5820468811761765, "vf_explained_var": 0.24888364587511336, "kl": 0.00785524497749826, "entropy": 0.30932114868567734, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68513.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 31.425540763108188, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.695658176664322, "policy_loss": -0.007199022637571765, "vf_loss": 7.701411039867098, "vf_explained_var": 0.6080534131438644, "kl": 0.007230608383804639, "entropy": 0.5240340835833676, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68513.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "env_runners": {"episode_reward_max": 746.6886326992066, "episode_reward_min": -18.158560437270452, "episode_reward_mean": 201.41733780716604, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1059.4682076768208, "predator_policy": 59.58784788958357}, "policy_reward_max": {"prey_policy": 363.5208703994206, "predator_policy": 1038.253928042617}, "policy_reward_mean": {"prey_policy": -509.93602556969506, "predator_policy": 610.6446944732783}, "custom_metrics": {}, "hist_stats": {"episode_reward": [498.411480173034, 10.064082837390554, 7.4, 437.9164411676329, 365.71818727201327, 17.07691189397884, 96.0897418364257, -1.3667008010521915, 4.349790791987448, 303.4024593338257, 12.997966697305701, 27.44734427756494, 4.864116448415487, 320.1858709676171, 13.742175971572934, 475.2713417497059, 353.9621216262185, 58.678506548091, 182.50358674834385, 472.568870199411, 374.2294303202486, 296.9897898910443, 35.30000000000005, 635.7886104953916, 117.22342971525215, 12.79999999999999, 314.3963818267384, 746.6886326992066, 19.200000000000014, 266.96343520273615, 311.446305096632, 193.17629285364134, 14.093645196394618, 110.11315223544337, 333.81963698143596, 65.49075888380565, 172.93303071998417, 151.2313080080027, 486.9771052299614, 135.02197103279735, 12.677600425060888, 79.92838271748512, 1.4000000000000008, 726.5323219252269, 334.4594948965098, 6.117731031253248, 172.09315673205012, 631.4684678010257, 29.245388075379292, 176.69420906134215, 237.9203978361267, 22.89426822299461, 162.8734470073433, 68.89951792530566, 1.6316155314232423, 19.542769233275425, 116.83634012832584, 5.190636128677177, 279.3623392621018, 4.449511875522037, 527.1127438404055, 536.2462763132831, 350.2148278882423, 52.821614741337605, 8.808183987657074, 453.80525044948376, 616.2112518536981, 462.472015943553, 136.2763391080148, 1.4172494993952536, 325.51187249648063, 680.7441979454821, 223.37125155242717, 149.44335785399232, 120.08168867184115, -18.158560437270452, 239.0282275626621, 7.782891632747981, 744.0255341164683, 86.29973182480515, 25.62678125181678, 144.68109110172855, 39.427192566285086, 19.0452414085533, 294.64004488921984, 7.29999999999999, 41.327726423745546, 218.47717166129587, 79.34906596823126, 8.140331935407776, 15.299999999999976, 319.4255118748112, 8.899999999999979, 149.81755284077673, 197.00669132037527, 5.591044010978802, 92.86944333076819, 23.700000000000088, 502.7270691403733, 699.4810662029023], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-41.340555095062626, -752.9842884398713, -928.9368511924532, -672.7033387813534, -729.5677222832735, -757.0410610229369, -498.2353024584577, -106.39660834869258, -767.0928933781086, -91.88958893326142, -890.4130239255358, -682.2182250314355, -500.6385741802575, -673.2852936978738, -763.0191316172198, -958.0653881462705, -739.5678329079318, -511.62883413565663, -146.47839816070018, -407.16707561567154, -708.3517686766676, -689.4623405832474, -631.6258693691674, -223.26366930661715, -707.3871075084628, -641.7214994426957, -633.8771091002292, -299.61959759505544, -826.6687847052168, -678.4459982169477, -67.76231552880125, -123.92941206955312, -983.8705994950166, -282.3040083575064, -1041.446905824189, -320.10093371655654, -674.135215931944, 1.7033665449719944, 208.55642533751904, -476.9320314263537, 40.0000000000003, -778.9681983072719, -1026.386577540336, -164.777611138116, -478.06926765109495, -525.2036877681029, -146.24912338604565, -205.86399818502218, -511.7157466207677, -766.4388175917991, -733.8166061866256, -562.7456100074654, -523.3419345138367, 69.2255653910877, -924.9124497856614, 3.8262190244280196, -774.5846811545186, -780.3009741175448, -720.7483937894827, -159.76602011511895, -643.5616453727773, -6.006325100560332, -300.8248881835664, -160.32169239212777, -941.6319285147312, -878.202611774345, -317.90840923905057, -551.9464871275056, -257.8044214871005, -662.8479488470041, -648.4727189071813, -415.76577792519726, -837.6643332095152, -439.3724554217969, -579.5792616272927, -448.45766046204653, -451.3290370105932, -805.5578503684565, -755.2156328512069, -507.4617900000701, -646.7333545419086, -589.2813628479896, -196.43695544269286, -892.4732685828997, -499.02321835419406, -576.2581806656902, 363.5208703994206, -661.2544626828263, -684.1224469074, 23.81998686955795, -323.65320530307145, -682.5380296547894, -410.9637719533902, -745.643456088008, 44.63109026630619, -976.1332992131956, -811.5953733827995, -629.991981776055, -359.69786512194844, -781.232255438772, -833.5666834861963, -370.5034996875901, -694.1799156042105, -896.7865374463291, -512.9803496901704, -660.5260799109549, -694.5342946508142, -623.9809530666324, -610.2531772051916, -622.5702222002766, -486.06914241496236, -654.3169065446315, -899.2463368449446, -594.482964945319, -717.9761544471069, -362.04125147873737, -319.118409760766, -276.38196271884624, -517.6723106690006, -718.5253297171213, -734.7182798189036, 318.74248110075865, -94.30386566329283, -1059.4682076768208, -145.1723123525123, -452.8320438745616, -378.7990523666858, -597.8782961489072, -648.5292614334239, -747.4411614421812, -776.3098794743241, -232.50837482321072, -838.1261943874212, 275.6237650251913, -91.03568837906396, -560.7335852246209, -603.6445416490735, -123.88468321562792, -479.7199559681842, -350.1461987727106, -215.55071493984377, -488.7190425436826, -73.22268910997553, -832.8232387842684, -403.0083300815703, -908.4488450387566, -21.295704763427793, -832.9948434171824, -401.5839059188357, -133.85605997465083, -498.5708320604365, -788.068832369545, 16.94431043716812, -92.54017563917463, -714.7711786128249, -837.0086067815972, -904.173649571877, 168.3063552966244, -326.4489471429074, -586.7427313511034, -425.6858041811654, -788.7308845024082, -740.8479949226694, 0.6185431951921757, -788.0174027445997, -630.8533767580087, -616.8621830000667, -800.7965256471718, 90.8275578008627, -582.2370812774293, -551.6886111337235, -872.4521042692202, -508.7183902567281, -695.6820146670958, -122.24043438508696, -751.800628071084, -369.07874245306357, -643.6168689807699, -662.1216738953652, -656.0218890406741, -412.55326860916193, -584.6589464799764, -736.4964697089653, -63.96812982034456, -678.0900590319147, -380.7030101150849, -848.2165645484681, -403.2882562399033, -825.8863457203915, -127.79192428437202, -726.9373291940125, -597.990044901338, -421.6733466067216, -967.4893892951532, -307.2552041929435, -729.4638875200496, -702.2269514528169, 153.7837067951988, 220.72221340353286, -734.693223811062], "policy_predator_policy_reward": [591.2362583031359, 701.5000654048289, 929.2195394028489, 682.4847334083494, 729.7677222832735, 764.2410610229379, 513.0540319681304, 529.4943200066524, 756.4659327551578, 468.2347368282237, 896.4183392525636, 693.2898215983862, 610.7531077405389, 659.2605019740182, 763.0191316172198, 956.6986873452183, 740.2512997695829, 515.295158065993, 624.1750493271368, 232.87288378306155, 712.2517686766685, 698.5603072805535, 638.6905402122372, 243.64634274111165, 711.6612273512632, 642.3114960483109, 719.851265895396, 533.8313117675028, 827.0687847052168, 691.7881741885203, 285.25328094862874, 381.7097883994276, 812.777299927436, 807.3594295513058, 1038.253928042617, 381.97241804622286, 608.0187539259783, 246.91668220933954, 339.151317018544, 401.7931592697001, 640.8921599195844, 472.30546870793677, 976.2881998863393, 511.8657786831539, 509.16926765109577, 529.4036877681039, 339.54567064163166, 648.3560614248282, 605.3480069133279, 790.0299870144944, 744.9166061866259, 564.4456100074656, 535.6325046116622, 232.88024633782527, 804.0998312041488, 863.6750322562859, 777.884681154519, 796.2009741175447, 616.5330765618685, 530.9447725454661, 341.88474945326374, 619.1295261167068, 120.07832793670687, 534.2445454926273, 967.9382211103629, 865.9899643751081, 296.95163462430094, 683.016413977699, 722.9911915414883, 531.4808157740531, 654.2087045099224, 475.52055120626585, 574.838659382806, 875.1311599684968, 473.6364790952193, 705.6317510021248, 753.2542888157582, 990.6097037932471, 614.4186519188082, 783.2807419652669, 629.261594097994, 619.4307237169652, 323.06795368419154, 845.7706530588831, 500.42321835419426, 576.2581806656902, 364.9131210774944, 659.3527931311405, 538.2137061745098, 456.54824875983985, 327.1658101893453, 685.1431557997713, 598.3386746353942, 730.3617101380559, 670.4862301868616, 892.4844465610486, 815.6233922409476, 655.2093509932861, 541.416192129862, 776.2081374922032, 799.3016428681159, 642.6889381417986, 700.507818582097, 913.3529026914337, 684.3431971009916, 652.0366795074789, 588.8685858589254, 798.5461797838284, 608.5183767904332, 625.9366381464599, 504.91191164824005, 655.0169065446316, 929.969471158778, 680.5961707598129, 444.85261361030314, 640.3554284442179, 544.465416540773, 330.39729520094744, 512.1396888711181, 728.5074633905285, 507.85715596182683, 435.23138659672384, 766.2676764206755, 923.7506732327194, 445.48361792381905, 502.73556619149764, 390.79905236668833, 638.6999108902453, 651.3374454210816, 753.4411614421814, 687.2671559999512, 775.3563487470643, 844.2881603714601, 334.4255208444671, 694.0947409691743, 420.1465485780619, 581.1296547843142, 282.6759091884047, 383.4141160206325, 447.86928821966376, 567.326654279804, 462.45497570020484, 812.7541025951883, 774.0360232445391, 673.3879566240657, 861.4404700486886, 170.92671203278056, 832.807194001822, 566.472334149306, 89.04932041602414, 806.746990872346, 461.7341131203655, 255.036244875085, 59.58784788958357, 722.5711786128267, 836.9914984143452, 839.1640782214504, 640.7287501702668, 376.7535694650589, 622.7378408537597, 451.0125854329848, 789.0308845024082, 742.7073727387426, 142.20317009046497, 788.0174027445997, 670.2805693242943, 610.9210256474115, 825.782924408381, 213.340522615083, 572.7090457507036, 557.7886111337244, 873.6521042692204, 528.018390256729, 717.7097410908423, 692.4102069574304, 400.10802716003684, 517.0392681614949, 575.0054092405704, 674.2879252130833, 651.9959696583645, 423.9532686091642, 588.5589464799765, 501.82657151262435, 618.0635398914978, 682.7900590319158, 384.90301011508643, 847.068205057228, 554.2541685719191, 823.1563935195654, 327.52856780557164, 714.0374309128104, 616.4809871935219, 814.5133937543524, 667.5187854782902, 324.7552041929437, 735.6638875200497, 686.8507310899383, 364.3195827080508, 592.8334673605407, 620.618609249892]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.964924231119783, "mean_inference_ms": 4.406062845262109, "mean_action_processing_ms": 1.6485775617187863, "mean_env_wait_ms": 12.496509227625323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011940479278564453, "StateBufferConnector_ms": 0.0158768892288208, "ViewRequirementAgentConnector_ms": 0.12354588508605957}, "num_episodes": 6, "episode_return_max": 746.6886326992066, "episode_return_min": -18.158560437270452, "episode_return_mean": 201.41733780716604, "episodes_this_iter": 6}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 152.8213159790842, "num_env_steps_trained_throughput_per_sec": 152.8213159790842, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 1168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 25864.466, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25864.218, "sample_time_ms": 2287.8, "learn_time_ms": 23550.277, "learn_throughput": 169.849, "synch_weights_time_ms": 22.247}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "done": false, "training_iteration": 73, "trial_id": "0b608_00000", "date": "2024-08-22_14-16-40", "timestamp": 1724316400, "time_this_iter_s": 26.227904796600342, "time_total_s": 1892.208250284195, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a370ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1892.208250284195, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 40.65405405405406, "ram_util_percent": 82.82162162162163}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.759949186617735, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.485640701415047, "policy_loss": -0.009800563371498828, "vf_loss": 7.494792504789968, "vf_explained_var": 0.1691073224658058, "kl": 0.006487519816598958, "entropy": 0.31525236644126753, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 69458.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 31.637412486000667, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.271858117946241, "policy_loss": -0.010629598273053056, "vf_loss": 7.28069321062199, "vf_explained_var": 0.6155457499796751, "kl": 0.008972451069870244, "entropy": 0.5477848922764813, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 69458.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "env_runners": {"episode_reward_max": 746.6886326992066, "episode_reward_min": -25.485869173930343, "episode_reward_mean": 196.13480180736167, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1059.4682076768208, "predator_policy": 59.58784788958357}, "policy_reward_max": {"prey_policy": 363.5208703994206, "predator_policy": 1038.253928042617}, "policy_reward_mean": {"prey_policy": -500.7735258917887, "predator_policy": 598.8409267954697}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.997966697305701, 27.44734427756494, 4.864116448415487, 320.1858709676171, 13.742175971572934, 475.2713417497059, 353.9621216262185, 58.678506548091, 182.50358674834385, 472.568870199411, 374.2294303202486, 296.9897898910443, 35.30000000000005, 635.7886104953916, 117.22342971525215, 12.79999999999999, 314.3963818267384, 746.6886326992066, 19.200000000000014, 266.96343520273615, 311.446305096632, 193.17629285364134, 14.093645196394618, 110.11315223544337, 333.81963698143596, 65.49075888380565, 172.93303071998417, 151.2313080080027, 486.9771052299614, 135.02197103279735, 12.677600425060888, 79.92838271748512, 1.4000000000000008, 726.5323219252269, 334.4594948965098, 6.117731031253248, 172.09315673205012, 631.4684678010257, 29.245388075379292, 176.69420906134215, 237.9203978361267, 22.89426822299461, 162.8734470073433, 68.89951792530566, 1.6316155314232423, 19.542769233275425, 116.83634012832584, 5.190636128677177, 279.3623392621018, 4.449511875522037, 527.1127438404055, 536.2462763132831, 350.2148278882423, 52.821614741337605, 8.808183987657074, 453.80525044948376, 616.2112518536981, 462.472015943553, 136.2763391080148, 1.4172494993952536, 325.51187249648063, 680.7441979454821, 223.37125155242717, 149.44335785399232, 120.08168867184115, -18.158560437270452, 239.0282275626621, 7.782891632747981, 744.0255341164683, 86.29973182480515, 25.62678125181678, 144.68109110172855, 39.427192566285086, 19.0452414085533, 294.64004488921984, 7.29999999999999, 41.327726423745546, 218.47717166129587, 79.34906596823126, 8.140331935407776, 15.299999999999976, 319.4255118748112, 8.899999999999979, 149.81755284077673, 197.00669132037527, 5.591044010978802, 92.86944333076819, 23.700000000000088, 502.7270691403733, 699.4810662029023, 31.755001552520362, 16.743010095487524, 175.61089660576906, -25.485869173930343, 64.06047932150237, 37.09999999999999, 373.6642846593616, 261.6789432634274, 24.900000000000006, 250.78204820065565], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-708.3517686766676, -689.4623405832474, -631.6258693691674, -223.26366930661715, -707.3871075084628, -641.7214994426957, -633.8771091002292, -299.61959759505544, -826.6687847052168, -678.4459982169477, -67.76231552880125, -123.92941206955312, -983.8705994950166, -282.3040083575064, -1041.446905824189, -320.10093371655654, -674.135215931944, 1.7033665449719944, 208.55642533751904, -476.9320314263537, 40.0000000000003, -778.9681983072719, -1026.386577540336, -164.777611138116, -478.06926765109495, -525.2036877681029, -146.24912338604565, -205.86399818502218, -511.7157466207677, -766.4388175917991, -733.8166061866256, -562.7456100074654, -523.3419345138367, 69.2255653910877, -924.9124497856614, 3.8262190244280196, -774.5846811545186, -780.3009741175448, -720.7483937894827, -159.76602011511895, -643.5616453727773, -6.006325100560332, -300.8248881835664, -160.32169239212777, -941.6319285147312, -878.202611774345, -317.90840923905057, -551.9464871275056, -257.8044214871005, -662.8479488470041, -648.4727189071813, -415.76577792519726, -837.6643332095152, -439.3724554217969, -579.5792616272927, -448.45766046204653, -451.3290370105932, -805.5578503684565, -755.2156328512069, -507.4617900000701, -646.7333545419086, -589.2813628479896, -196.43695544269286, -892.4732685828997, -499.02321835419406, -576.2581806656902, 363.5208703994206, -661.2544626828263, -684.1224469074, 23.81998686955795, -323.65320530307145, -682.5380296547894, -410.9637719533902, -745.643456088008, 44.63109026630619, -976.1332992131956, -811.5953733827995, -629.991981776055, -359.69786512194844, -781.232255438772, -833.5666834861963, -370.5034996875901, -694.1799156042105, -896.7865374463291, -512.9803496901704, -660.5260799109549, -694.5342946508142, -623.9809530666324, -610.2531772051916, -622.5702222002766, -486.06914241496236, -654.3169065446315, -899.2463368449446, -594.482964945319, -717.9761544471069, -362.04125147873737, -319.118409760766, -276.38196271884624, -517.6723106690006, -718.5253297171213, -734.7182798189036, 318.74248110075865, -94.30386566329283, -1059.4682076768208, -145.1723123525123, -452.8320438745616, -378.7990523666858, -597.8782961489072, -648.5292614334239, -747.4411614421812, -776.3098794743241, -232.50837482321072, -838.1261943874212, 275.6237650251913, -91.03568837906396, -560.7335852246209, -603.6445416490735, -123.88468321562792, -479.7199559681842, -350.1461987727106, -215.55071493984377, -488.7190425436826, -73.22268910997553, -832.8232387842684, -403.0083300815703, -908.4488450387566, -21.295704763427793, -832.9948434171824, -401.5839059188357, -133.85605997465083, -498.5708320604365, -788.068832369545, 16.94431043716812, -92.54017563917463, -714.7711786128249, -837.0086067815972, -904.173649571877, 168.3063552966244, -326.4489471429074, -586.7427313511034, -425.6858041811654, -788.7308845024082, -740.8479949226694, 0.6185431951921757, -788.0174027445997, -630.8533767580087, -616.8621830000667, -800.7965256471718, 90.8275578008627, -582.2370812774293, -551.6886111337235, -872.4521042692202, -508.7183902567281, -695.6820146670958, -122.24043438508696, -751.800628071084, -369.07874245306357, -643.6168689807699, -662.1216738953652, -656.0218890406741, -412.55326860916193, -584.6589464799764, -736.4964697089653, -63.96812982034456, -678.0900590319147, -380.7030101150849, -848.2165645484681, -403.2882562399033, -825.8863457203915, -127.79192428437202, -726.9373291940125, -597.990044901338, -421.6733466067216, -967.4893892951532, -307.2552041929435, -729.4638875200496, -702.2269514528169, 153.7837067951988, 220.72221340353286, -734.693223811062, -573.6771179959738, -217.98130170459842, -635.3010698023552, -918.7104464855441, -770.1838606754701, -528.6026495284738, -716.653228317292, -243.15838737220457, -493.1547141386317, -421.2918328642092, -667.1902337493167, -281.72591258203636, -298.54432450206605, -524.9838005019566, -432.5728506423836, -178.4306446710287, -340.9684181952704, -559.5623349819705, -688.5343167753274, -294.9426062846554], "policy_predator_policy_reward": [712.2517686766685, 698.5603072805535, 638.6905402122372, 243.64634274111165, 711.6612273512632, 642.3114960483109, 719.851265895396, 533.8313117675028, 827.0687847052168, 691.7881741885203, 285.25328094862874, 381.7097883994276, 812.777299927436, 807.3594295513058, 1038.253928042617, 381.97241804622286, 608.0187539259783, 246.91668220933954, 339.151317018544, 401.7931592697001, 640.8921599195844, 472.30546870793677, 976.2881998863393, 511.8657786831539, 509.16926765109577, 529.4036877681039, 339.54567064163166, 648.3560614248282, 605.3480069133279, 790.0299870144944, 744.9166061866259, 564.4456100074656, 535.6325046116622, 232.88024633782527, 804.0998312041488, 863.6750322562859, 777.884681154519, 796.2009741175447, 616.5330765618685, 530.9447725454661, 341.88474945326374, 619.1295261167068, 120.07832793670687, 534.2445454926273, 967.9382211103629, 865.9899643751081, 296.95163462430094, 683.016413977699, 722.9911915414883, 531.4808157740531, 654.2087045099224, 475.52055120626585, 574.838659382806, 875.1311599684968, 473.6364790952193, 705.6317510021248, 753.2542888157582, 990.6097037932471, 614.4186519188082, 783.2807419652669, 629.261594097994, 619.4307237169652, 323.06795368419154, 845.7706530588831, 500.42321835419426, 576.2581806656902, 364.9131210774944, 659.3527931311405, 538.2137061745098, 456.54824875983985, 327.1658101893453, 685.1431557997713, 598.3386746353942, 730.3617101380559, 670.4862301868616, 892.4844465610486, 815.6233922409476, 655.2093509932861, 541.416192129862, 776.2081374922032, 799.3016428681159, 642.6889381417986, 700.507818582097, 913.3529026914337, 684.3431971009916, 652.0366795074789, 588.8685858589254, 798.5461797838284, 608.5183767904332, 625.9366381464599, 504.91191164824005, 655.0169065446316, 929.969471158778, 680.5961707598129, 444.85261361030314, 640.3554284442179, 544.465416540773, 330.39729520094744, 512.1396888711181, 728.5074633905285, 507.85715596182683, 435.23138659672384, 766.2676764206755, 923.7506732327194, 445.48361792381905, 502.73556619149764, 390.79905236668833, 638.6999108902453, 651.3374454210816, 753.4411614421814, 687.2671559999512, 775.3563487470643, 844.2881603714601, 334.4255208444671, 694.0947409691743, 420.1465485780619, 581.1296547843142, 282.6759091884047, 383.4141160206325, 447.86928821966376, 567.326654279804, 462.45497570020484, 812.7541025951883, 774.0360232445391, 673.3879566240657, 861.4404700486886, 170.92671203278056, 832.807194001822, 566.472334149306, 89.04932041602414, 806.746990872346, 461.7341131203655, 255.036244875085, 59.58784788958357, 722.5711786128267, 836.9914984143452, 839.1640782214504, 640.7287501702668, 376.7535694650589, 622.7378408537597, 451.0125854329848, 789.0308845024082, 742.7073727387426, 142.20317009046497, 788.0174027445997, 670.2805693242943, 610.9210256474115, 825.782924408381, 213.340522615083, 572.7090457507036, 557.7886111337244, 873.6521042692204, 528.018390256729, 717.7097410908423, 692.4102069574304, 400.10802716003684, 517.0392681614949, 575.0054092405704, 674.2879252130833, 651.9959696583645, 423.9532686091642, 588.5589464799765, 501.82657151262435, 618.0635398914978, 682.7900590319158, 384.90301011508643, 847.068205057228, 554.2541685719191, 823.1563935195654, 327.52856780557164, 714.0374309128104, 616.4809871935219, 814.5133937543524, 667.5187854782902, 324.7552041929437, 735.6638875200497, 686.8507310899383, 364.3195827080508, 592.8334673605407, 620.618609249892, 325.13467027744196, 498.27875097565146, 651.6726839444823, 919.0818424389046, 758.7187269594118, 715.6786798503073, 734.2832839119874, 200.04246260357806, 559.5117761118765, 418.99525021246757, 669.1902337493171, 316.8259125820356, 557.8256305780997, 639.3667790852844, 408.7211445167969, 463.96129406004127, 358.4684181952702, 566.9623349819709, 652.4696498417139, 581.7893214189287]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.9633948266442145, "mean_inference_ms": 4.398792704209441, "mean_action_processing_ms": 1.6674849801414087, "mean_env_wait_ms": 12.499006055322049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011864185333251953, "StateBufferConnector_ms": 0.01587820053100586, "ViewRequirementAgentConnector_ms": 0.12339377403259277}, "num_episodes": 10, "episode_return_max": 746.6886326992066, "episode_return_min": -25.485869173930343, "episode_return_mean": 196.13480180736167, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.50952551079163, "num_env_steps_trained_throughput_per_sec": 153.50952551079163, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 1184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 25939.01, "restore_workers_time_ms": 0.024, "training_step_time_ms": 25938.763, "sample_time_ms": 2337.368, "learn_time_ms": 23574.855, "learn_throughput": 169.672, "synch_weights_time_ms": 22.338}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "training_iteration": 74, "trial_id": "0b608_00000", "date": "2024-08-22_14-17-06", "timestamp": 1724316426, "time_this_iter_s": 26.108181953430176, "time_total_s": 1918.3164322376251, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a3701f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1918.3164322376251, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 35.275675675675686, "ram_util_percent": 82.02972972972972}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.632051563515233, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.074398702793021, "policy_loss": -0.00975529708746801, "vf_loss": 7.083422605322783, "vf_explained_var": 0.20453688669457007, "kl": 0.007314215533474766, "entropy": 0.33225185398071533, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70403.0, "diff_num_grad_updates_vs_sampler_policy": 493.02624999999534}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 31.470209298310458, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.276656613021931, "policy_loss": -0.008021686143838067, "vf_loss": 7.283047336497635, "vf_explained_var": 0.5637294412289978, "kl": 0.008154696592489484, "entropy": 0.5334574264193338, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70403.0, "diff_num_grad_updates_vs_sampler_policy": 493.02624999999534}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 908.5658341687821, "episode_reward_min": -25.485869173930343, "episode_reward_mean": 218.52495548116497, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1059.4682076768208, "predator_policy": 59.58784788958357}, "policy_reward_max": {"prey_policy": 363.5208703994206, "predator_policy": 990.6097037932471}, "policy_reward_mean": {"prey_policy": -488.5015789192922, "predator_policy": 597.7640566598749}, "custom_metrics": {}, "hist_stats": {"episode_reward": [296.9897898910443, 35.30000000000005, 635.7886104953916, 117.22342971525215, 12.79999999999999, 314.3963818267384, 746.6886326992066, 19.200000000000014, 266.96343520273615, 311.446305096632, 193.17629285364134, 14.093645196394618, 110.11315223544337, 333.81963698143596, 65.49075888380565, 172.93303071998417, 151.2313080080027, 486.9771052299614, 135.02197103279735, 12.677600425060888, 79.92838271748512, 1.4000000000000008, 726.5323219252269, 334.4594948965098, 6.117731031253248, 172.09315673205012, 631.4684678010257, 29.245388075379292, 176.69420906134215, 237.9203978361267, 22.89426822299461, 162.8734470073433, 68.89951792530566, 1.6316155314232423, 19.542769233275425, 116.83634012832584, 5.190636128677177, 279.3623392621018, 4.449511875522037, 527.1127438404055, 536.2462763132831, 350.2148278882423, 52.821614741337605, 8.808183987657074, 453.80525044948376, 616.2112518536981, 462.472015943553, 136.2763391080148, 1.4172494993952536, 325.51187249648063, 680.7441979454821, 223.37125155242717, 149.44335785399232, 120.08168867184115, -18.158560437270452, 239.0282275626621, 7.782891632747981, 744.0255341164683, 86.29973182480515, 25.62678125181678, 144.68109110172855, 39.427192566285086, 19.0452414085533, 294.64004488921984, 7.29999999999999, 41.327726423745546, 218.47717166129587, 79.34906596823126, 8.140331935407776, 15.299999999999976, 319.4255118748112, 8.899999999999979, 149.81755284077673, 197.00669132037527, 5.591044010978802, 92.86944333076819, 23.700000000000088, 502.7270691403733, 699.4810662029023, 31.755001552520362, 16.743010095487524, 175.61089660576906, -25.485869173930343, 64.06047932150237, 37.09999999999999, 373.6642846593616, 261.6789432634274, 24.900000000000006, 250.78204820065565, 28.000000000000142, 0.7000000000000046, 598.0064012087877, 544.1969041835579, 455.9968385725917, 248.1468033896551, 472.1466334639948, 908.5658341687821, 357.09408255248553, 499.9438325127116, 422.66936888226843], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1026.386577540336, -164.777611138116, -478.06926765109495, -525.2036877681029, -146.24912338604565, -205.86399818502218, -511.7157466207677, -766.4388175917991, -733.8166061866256, -562.7456100074654, -523.3419345138367, 69.2255653910877, -924.9124497856614, 3.8262190244280196, -774.5846811545186, -780.3009741175448, -720.7483937894827, -159.76602011511895, -643.5616453727773, -6.006325100560332, -300.8248881835664, -160.32169239212777, -941.6319285147312, -878.202611774345, -317.90840923905057, -551.9464871275056, -257.8044214871005, -662.8479488470041, -648.4727189071813, -415.76577792519726, -837.6643332095152, -439.3724554217969, -579.5792616272927, -448.45766046204653, -451.3290370105932, -805.5578503684565, -755.2156328512069, -507.4617900000701, -646.7333545419086, -589.2813628479896, -196.43695544269286, -892.4732685828997, -499.02321835419406, -576.2581806656902, 363.5208703994206, -661.2544626828263, -684.1224469074, 23.81998686955795, -323.65320530307145, -682.5380296547894, -410.9637719533902, -745.643456088008, 44.63109026630619, -976.1332992131956, -811.5953733827995, -629.991981776055, -359.69786512194844, -781.232255438772, -833.5666834861963, -370.5034996875901, -694.1799156042105, -896.7865374463291, -512.9803496901704, -660.5260799109549, -694.5342946508142, -623.9809530666324, -610.2531772051916, -622.5702222002766, -486.06914241496236, -654.3169065446315, -899.2463368449446, -594.482964945319, -717.9761544471069, -362.04125147873737, -319.118409760766, -276.38196271884624, -517.6723106690006, -718.5253297171213, -734.7182798189036, 318.74248110075865, -94.30386566329283, -1059.4682076768208, -145.1723123525123, -452.8320438745616, -378.7990523666858, -597.8782961489072, -648.5292614334239, -747.4411614421812, -776.3098794743241, -232.50837482321072, -838.1261943874212, 275.6237650251913, -91.03568837906396, -560.7335852246209, -603.6445416490735, -123.88468321562792, -479.7199559681842, -350.1461987727106, -215.55071493984377, -488.7190425436826, -73.22268910997553, -832.8232387842684, -403.0083300815703, -908.4488450387566, -21.295704763427793, -832.9948434171824, -401.5839059188357, -133.85605997465083, -498.5708320604365, -788.068832369545, 16.94431043716812, -92.54017563917463, -714.7711786128249, -837.0086067815972, -904.173649571877, 168.3063552966244, -326.4489471429074, -586.7427313511034, -425.6858041811654, -788.7308845024082, -740.8479949226694, 0.6185431951921757, -788.0174027445997, -630.8533767580087, -616.8621830000667, -800.7965256471718, 90.8275578008627, -582.2370812774293, -551.6886111337235, -872.4521042692202, -508.7183902567281, -695.6820146670958, -122.24043438508696, -751.800628071084, -369.07874245306357, -643.6168689807699, -662.1216738953652, -656.0218890406741, -412.55326860916193, -584.6589464799764, -736.4964697089653, -63.96812982034456, -678.0900590319147, -380.7030101150849, -848.2165645484681, -403.2882562399033, -825.8863457203915, -127.79192428437202, -726.9373291940125, -597.990044901338, -421.6733466067216, -967.4893892951532, -307.2552041929435, -729.4638875200496, -702.2269514528169, 153.7837067951988, 220.72221340353286, -734.693223811062, -573.6771179959738, -217.98130170459842, -635.3010698023552, -918.7104464855441, -770.1838606754701, -528.6026495284738, -716.653228317292, -243.15838737220457, -493.1547141386317, -421.2918328642092, -667.1902337493167, -281.72591258203636, -298.54432450206605, -524.9838005019566, -432.5728506423836, -178.4306446710287, -340.9684181952704, -559.5623349819705, -688.5343167753274, -294.9426062846554, -217.64620161372676, -673.8854366349709, -704.1183107835213, -658.9397656855499, -931.9306980683697, 208.96129299964545, -159.43494564770393, -641.8030775598421, -65.76669252808388, -707.6784145335636, -119.96060217672508, -638.3974127022424, 32.9370553386422, -419.41825476230105, 279.5521288522981, -816.3334423579383, -613.5519977992356, 73.82138065943572, -732.1386545728542, 188.8882957673383, 40.0000000000003, -808.3804249704394], "policy_predator_policy_reward": [976.2881998863393, 511.8657786831539, 509.16926765109577, 529.4036877681039, 339.54567064163166, 648.3560614248282, 605.3480069133279, 790.0299870144944, 744.9166061866259, 564.4456100074656, 535.6325046116622, 232.88024633782527, 804.0998312041488, 863.6750322562859, 777.884681154519, 796.2009741175447, 616.5330765618685, 530.9447725454661, 341.88474945326374, 619.1295261167068, 120.07832793670687, 534.2445454926273, 967.9382211103629, 865.9899643751081, 296.95163462430094, 683.016413977699, 722.9911915414883, 531.4808157740531, 654.2087045099224, 475.52055120626585, 574.838659382806, 875.1311599684968, 473.6364790952193, 705.6317510021248, 753.2542888157582, 990.6097037932471, 614.4186519188082, 783.2807419652669, 629.261594097994, 619.4307237169652, 323.06795368419154, 845.7706530588831, 500.42321835419426, 576.2581806656902, 364.9131210774944, 659.3527931311405, 538.2137061745098, 456.54824875983985, 327.1658101893453, 685.1431557997713, 598.3386746353942, 730.3617101380559, 670.4862301868616, 892.4844465610486, 815.6233922409476, 655.2093509932861, 541.416192129862, 776.2081374922032, 799.3016428681159, 642.6889381417986, 700.507818582097, 913.3529026914337, 684.3431971009916, 652.0366795074789, 588.8685858589254, 798.5461797838284, 608.5183767904332, 625.9366381464599, 504.91191164824005, 655.0169065446316, 929.969471158778, 680.5961707598129, 444.85261361030314, 640.3554284442179, 544.465416540773, 330.39729520094744, 512.1396888711181, 728.5074633905285, 507.85715596182683, 435.23138659672384, 766.2676764206755, 923.7506732327194, 445.48361792381905, 502.73556619149764, 390.79905236668833, 638.6999108902453, 651.3374454210816, 753.4411614421814, 687.2671559999512, 775.3563487470643, 844.2881603714601, 334.4255208444671, 694.0947409691743, 420.1465485780619, 581.1296547843142, 282.6759091884047, 383.4141160206325, 447.86928821966376, 567.326654279804, 462.45497570020484, 812.7541025951883, 774.0360232445391, 673.3879566240657, 861.4404700486886, 170.92671203278056, 832.807194001822, 566.472334149306, 89.04932041602414, 806.746990872346, 461.7341131203655, 255.036244875085, 59.58784788958357, 722.5711786128267, 836.9914984143452, 839.1640782214504, 640.7287501702668, 376.7535694650589, 622.7378408537597, 451.0125854329848, 789.0308845024082, 742.7073727387426, 142.20317009046497, 788.0174027445997, 670.2805693242943, 610.9210256474115, 825.782924408381, 213.340522615083, 572.7090457507036, 557.7886111337244, 873.6521042692204, 528.018390256729, 717.7097410908423, 692.4102069574304, 400.10802716003684, 517.0392681614949, 575.0054092405704, 674.2879252130833, 651.9959696583645, 423.9532686091642, 588.5589464799765, 501.82657151262435, 618.0635398914978, 682.7900590319158, 384.90301011508643, 847.068205057228, 554.2541685719191, 823.1563935195654, 327.52856780557164, 714.0374309128104, 616.4809871935219, 814.5133937543524, 667.5187854782902, 324.7552041929437, 735.6638875200497, 686.8507310899383, 364.3195827080508, 592.8334673605407, 620.618609249892, 325.13467027744196, 498.27875097565146, 651.6726839444823, 919.0818424389046, 758.7187269594118, 715.6786798503073, 734.2832839119874, 200.04246260357806, 559.5117761118765, 418.99525021246757, 669.1902337493171, 316.8259125820356, 557.8256305780997, 639.3667790852844, 408.7211445167969, 463.96129406004127, 358.4684181952702, 566.9623349819709, 652.4696498417139, 581.7893214189287, 241.5462016137254, 677.9854366349718, 704.8183107835215, 658.9397656855499, 857.0142012214611, 463.9616050560477, 668.5181510130732, 676.9167763780265, 538.8133762083639, 690.6285694258726, 384.1268676839044, 622.3779505847186, 374.19615655428487, 484.4316763333639, 724.4865440685295, 720.8606036058915, 504.34858714858024, 392.47611254370673, 536.2746546466683, 506.91953667155485, 502.6060139618643, 688.4437798908416]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.963269973696098, "mean_inference_ms": 4.403030885073778, "mean_action_processing_ms": 1.6621740510550294, "mean_env_wait_ms": 12.507464475964815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011346697807312012, "StateBufferConnector_ms": 0.015855073928833008, "ViewRequirementAgentConnector_ms": 0.12330389022827148}, "num_episodes": 11, "episode_return_max": 908.5658341687821, "episode_return_min": -25.485869173930343, "episode_return_mean": 218.52495548116497, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.56229414549577, "num_env_steps_trained_throughput_per_sec": 154.56229414549577, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 25958.043, "restore_workers_time_ms": 0.024, "training_step_time_ms": 25957.791, "sample_time_ms": 2334.107, "learn_time_ms": 23596.732, "learn_throughput": 169.515, "synch_weights_time_ms": 22.454}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 75, "trial_id": "0b608_00000", "date": "2024-08-22_14-17-32", "timestamp": 1724316452, "time_this_iter_s": 25.937108993530273, "time_total_s": 1944.2535412311554, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a3b8dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1944.2535412311554, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 33.95945945945946, "ram_util_percent": 83.14054054054056}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.506311934587185, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.515828283501681, "policy_loss": -0.012399956214157914, "vf_loss": 7.527411134911593, "vf_explained_var": 0.03523363493106983, "kl": 0.008170827874352062, "entropy": 0.31482396305553495, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 71348.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.47074000141608, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.133498979497839, "policy_loss": -0.008619256579272804, "vf_loss": 7.140477282408053, "vf_explained_var": 0.4255551997946684, "kl": 0.008204854208798636, "entropy": 0.5280458183831008, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 71348.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "env_runners": {"episode_reward_max": 908.5658341687821, "episode_reward_min": -25.485869173930343, "episode_reward_mean": 214.87649099543108, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1059.4682076768208, "predator_policy": 16.25}, "policy_reward_max": {"prey_policy": 363.5208703994206, "predator_policy": 990.6097037932471}, "policy_reward_mean": {"prey_policy": -480.60216616740564, "predator_policy": 588.0404116651215}, "custom_metrics": {}, "hist_stats": {"episode_reward": [193.17629285364134, 14.093645196394618, 110.11315223544337, 333.81963698143596, 65.49075888380565, 172.93303071998417, 151.2313080080027, 486.9771052299614, 135.02197103279735, 12.677600425060888, 79.92838271748512, 1.4000000000000008, 726.5323219252269, 334.4594948965098, 6.117731031253248, 172.09315673205012, 631.4684678010257, 29.245388075379292, 176.69420906134215, 237.9203978361267, 22.89426822299461, 162.8734470073433, 68.89951792530566, 1.6316155314232423, 19.542769233275425, 116.83634012832584, 5.190636128677177, 279.3623392621018, 4.449511875522037, 527.1127438404055, 536.2462763132831, 350.2148278882423, 52.821614741337605, 8.808183987657074, 453.80525044948376, 616.2112518536981, 462.472015943553, 136.2763391080148, 1.4172494993952536, 325.51187249648063, 680.7441979454821, 223.37125155242717, 149.44335785399232, 120.08168867184115, -18.158560437270452, 239.0282275626621, 7.782891632747981, 744.0255341164683, 86.29973182480515, 25.62678125181678, 144.68109110172855, 39.427192566285086, 19.0452414085533, 294.64004488921984, 7.29999999999999, 41.327726423745546, 218.47717166129587, 79.34906596823126, 8.140331935407776, 15.299999999999976, 319.4255118748112, 8.899999999999979, 149.81755284077673, 197.00669132037527, 5.591044010978802, 92.86944333076819, 23.700000000000088, 502.7270691403733, 699.4810662029023, 31.755001552520362, 16.743010095487524, 175.61089660576906, -25.485869173930343, 64.06047932150237, 37.09999999999999, 373.6642846593616, 261.6789432634274, 24.900000000000006, 250.78204820065565, 28.000000000000142, 0.7000000000000046, 598.0064012087877, 544.1969041835579, 455.9968385725917, 248.1468033896551, 472.1466334639948, 908.5658341687821, 357.09408255248553, 499.9438325127116, 422.66936888226843, 530.7721059598886, 396.6833501103423, 0.28044944472567324, 434.2320674246923, 133.39718112288242, 388.85399874947126, 17.070886094768547, 364.04120824798883, 95.179747914828, 31.43914128402276], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-300.8248881835664, -160.32169239212777, -941.6319285147312, -878.202611774345, -317.90840923905057, -551.9464871275056, -257.8044214871005, -662.8479488470041, -648.4727189071813, -415.76577792519726, -837.6643332095152, -439.3724554217969, -579.5792616272927, -448.45766046204653, -451.3290370105932, -805.5578503684565, -755.2156328512069, -507.4617900000701, -646.7333545419086, -589.2813628479896, -196.43695544269286, -892.4732685828997, -499.02321835419406, -576.2581806656902, 363.5208703994206, -661.2544626828263, -684.1224469074, 23.81998686955795, -323.65320530307145, -682.5380296547894, -410.9637719533902, -745.643456088008, 44.63109026630619, -976.1332992131956, -811.5953733827995, -629.991981776055, -359.69786512194844, -781.232255438772, -833.5666834861963, -370.5034996875901, -694.1799156042105, -896.7865374463291, -512.9803496901704, -660.5260799109549, -694.5342946508142, -623.9809530666324, -610.2531772051916, -622.5702222002766, -486.06914241496236, -654.3169065446315, -899.2463368449446, -594.482964945319, -717.9761544471069, -362.04125147873737, -319.118409760766, -276.38196271884624, -517.6723106690006, -718.5253297171213, -734.7182798189036, 318.74248110075865, -94.30386566329283, -1059.4682076768208, -145.1723123525123, -452.8320438745616, -378.7990523666858, -597.8782961489072, -648.5292614334239, -747.4411614421812, -776.3098794743241, -232.50837482321072, -838.1261943874212, 275.6237650251913, -91.03568837906396, -560.7335852246209, -603.6445416490735, -123.88468321562792, -479.7199559681842, -350.1461987727106, -215.55071493984377, -488.7190425436826, -73.22268910997553, -832.8232387842684, -403.0083300815703, -908.4488450387566, -21.295704763427793, -832.9948434171824, -401.5839059188357, -133.85605997465083, -498.5708320604365, -788.068832369545, 16.94431043716812, -92.54017563917463, -714.7711786128249, -837.0086067815972, -904.173649571877, 168.3063552966244, -326.4489471429074, -586.7427313511034, -425.6858041811654, -788.7308845024082, -740.8479949226694, 0.6185431951921757, -788.0174027445997, -630.8533767580087, -616.8621830000667, -800.7965256471718, 90.8275578008627, -582.2370812774293, -551.6886111337235, -872.4521042692202, -508.7183902567281, -695.6820146670958, -122.24043438508696, -751.800628071084, -369.07874245306357, -643.6168689807699, -662.1216738953652, -656.0218890406741, -412.55326860916193, -584.6589464799764, -736.4964697089653, -63.96812982034456, -678.0900590319147, -380.7030101150849, -848.2165645484681, -403.2882562399033, -825.8863457203915, -127.79192428437202, -726.9373291940125, -597.990044901338, -421.6733466067216, -967.4893892951532, -307.2552041929435, -729.4638875200496, -702.2269514528169, 153.7837067951988, 220.72221340353286, -734.693223811062, -573.6771179959738, -217.98130170459842, -635.3010698023552, -918.7104464855441, -770.1838606754701, -528.6026495284738, -716.653228317292, -243.15838737220457, -493.1547141386317, -421.2918328642092, -667.1902337493167, -281.72591258203636, -298.54432450206605, -524.9838005019566, -432.5728506423836, -178.4306446710287, -340.9684181952704, -559.5623349819705, -688.5343167753274, -294.9426062846554, -217.64620161372676, -673.8854366349709, -704.1183107835213, -658.9397656855499, -931.9306980683697, 208.96129299964545, -159.43494564770393, -641.8030775598421, -65.76669252808388, -707.6784145335636, -119.96060217672508, -638.3974127022424, 32.9370553386422, -419.41825476230105, 279.5521288522981, -816.3334423579383, -613.5519977992356, 73.82138065943572, -732.1386545728542, 188.8882957673383, 40.0000000000003, -808.3804249704394, -297.07146261195595, 252.45019862041573, 28.235794092487033, -720.7389490269162, -735.3582869686545, -781.8490730750374, 222.37539108079812, -110.81850602725552, -510.9345838957821, -575.8053517259813, -216.13229772907988, -541.903985025584, -750.4514496253798, -532.7871327635928, -730.2148553003314, 100.9377303955404, -256.67267753064215, -603.1860056179968, -662.8100500028229, -578.8195824942842], "policy_predator_policy_reward": [120.07832793670687, 534.2445454926273, 967.9382211103629, 865.9899643751081, 296.95163462430094, 683.016413977699, 722.9911915414883, 531.4808157740531, 654.2087045099224, 475.52055120626585, 574.838659382806, 875.1311599684968, 473.6364790952193, 705.6317510021248, 753.2542888157582, 990.6097037932471, 614.4186519188082, 783.2807419652669, 629.261594097994, 619.4307237169652, 323.06795368419154, 845.7706530588831, 500.42321835419426, 576.2581806656902, 364.9131210774944, 659.3527931311405, 538.2137061745098, 456.54824875983985, 327.1658101893453, 685.1431557997713, 598.3386746353942, 730.3617101380559, 670.4862301868616, 892.4844465610486, 815.6233922409476, 655.2093509932861, 541.416192129862, 776.2081374922032, 799.3016428681159, 642.6889381417986, 700.507818582097, 913.3529026914337, 684.3431971009916, 652.0366795074789, 588.8685858589254, 798.5461797838284, 608.5183767904332, 625.9366381464599, 504.91191164824005, 655.0169065446316, 929.969471158778, 680.5961707598129, 444.85261361030314, 640.3554284442179, 544.465416540773, 330.39729520094744, 512.1396888711181, 728.5074633905285, 507.85715596182683, 435.23138659672384, 766.2676764206755, 923.7506732327194, 445.48361792381905, 502.73556619149764, 390.79905236668833, 638.6999108902453, 651.3374454210816, 753.4411614421814, 687.2671559999512, 775.3563487470643, 844.2881603714601, 334.4255208444671, 694.0947409691743, 420.1465485780619, 581.1296547843142, 282.6759091884047, 383.4141160206325, 447.86928821966376, 567.326654279804, 462.45497570020484, 812.7541025951883, 774.0360232445391, 673.3879566240657, 861.4404700486886, 170.92671203278056, 832.807194001822, 566.472334149306, 89.04932041602414, 806.746990872346, 461.7341131203655, 255.036244875085, 59.58784788958357, 722.5711786128267, 836.9914984143452, 839.1640782214504, 640.7287501702668, 376.7535694650589, 622.7378408537597, 451.0125854329848, 789.0308845024082, 742.7073727387426, 142.20317009046497, 788.0174027445997, 670.2805693242943, 610.9210256474115, 825.782924408381, 213.340522615083, 572.7090457507036, 557.7886111337244, 873.6521042692204, 528.018390256729, 717.7097410908423, 692.4102069574304, 400.10802716003684, 517.0392681614949, 575.0054092405704, 674.2879252130833, 651.9959696583645, 423.9532686091642, 588.5589464799765, 501.82657151262435, 618.0635398914978, 682.7900590319158, 384.90301011508643, 847.068205057228, 554.2541685719191, 823.1563935195654, 327.52856780557164, 714.0374309128104, 616.4809871935219, 814.5133937543524, 667.5187854782902, 324.7552041929437, 735.6638875200497, 686.8507310899383, 364.3195827080508, 592.8334673605407, 620.618609249892, 325.13467027744196, 498.27875097565146, 651.6726839444823, 919.0818424389046, 758.7187269594118, 715.6786798503073, 734.2832839119874, 200.04246260357806, 559.5117761118765, 418.99525021246757, 669.1902337493171, 316.8259125820356, 557.8256305780997, 639.3667790852844, 408.7211445167969, 463.96129406004127, 358.4684181952702, 566.9623349819709, 652.4696498417139, 581.7893214189287, 241.5462016137254, 677.9854366349718, 704.8183107835215, 658.9397656855499, 857.0142012214611, 463.9616050560477, 668.5181510130732, 676.9167763780265, 538.8133762083639, 690.6285694258726, 384.1268676839044, 622.3779505847186, 374.19615655428487, 484.4316763333639, 724.4865440685295, 720.8606036058915, 504.34858714858024, 392.47611254370673, 536.2746546466683, 506.91953667155485, 502.6060139618643, 688.4437798908416, 195.93904757492936, 379.4543223764951, 423.5456322181538, 665.6408728266141, 735.7008028540581, 781.7870066343595, 16.25, 306.4251823711513, 680.758540560894, 539.3785761837518, 352.8837453602544, 794.0065361438853, 751.3932578849096, 548.9162105988313, 580.9323087667276, 412.38602438605585, 348.6524254454733, 606.3860056179966, 738.751364216175, 534.3174095649564]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.968820759597519, "mean_inference_ms": 4.403676659491163, "mean_action_processing_ms": 1.645025433926339, "mean_env_wait_ms": 12.508723915706316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009559988975524902, "StateBufferConnector_ms": 0.01672995090484619, "ViewRequirementAgentConnector_ms": 0.12477004528045654}, "num_episodes": 10, "episode_return_max": 908.5658341687821, "episode_return_min": -25.485869173930343, "episode_return_mean": 214.87649099543108, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.25797513439795, "num_env_steps_trained_throughput_per_sec": 154.25797513439795, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 1216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1216000, "timers": {"training_iteration_time_ms": 25959.433, "restore_workers_time_ms": 0.024, "training_step_time_ms": 25959.173, "sample_time_ms": 2346.262, "learn_time_ms": 23586.086, "learn_throughput": 169.592, "synch_weights_time_ms": 22.094}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "done": false, "training_iteration": 76, "trial_id": "0b608_00000", "date": "2024-08-22_14-17-58", "timestamp": 1724316478, "time_this_iter_s": 25.967422008514404, "time_total_s": 1970.2209632396698, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a34e430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1970.2209632396698, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 34.72702702702702, "ram_util_percent": 83.01891891891893}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.85967336912004, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.330984971889112, "policy_loss": -0.009245184044940052, "vf_loss": 7.339448338463193, "vf_explained_var": 0.19037276720874524, "kl": 0.007818286159327106, "entropy": 0.3332808263245083, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72293.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 35.991191383644384, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.2017308840675955, "policy_loss": -0.007407961434945858, "vf_loss": 7.207778063274565, "vf_explained_var": 0.49119204150305856, "kl": 0.006803940680548155, "entropy": 0.537912869894946, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72293.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "env_runners": {"episode_reward_max": 908.5658341687821, "episode_reward_min": -25.485869173930343, "episode_reward_mean": 228.87637076117286, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1059.4682076768208, "predator_policy": 16.25}, "policy_reward_max": {"prey_policy": 363.5208703994206, "predator_policy": 975.7927733347462}, "policy_reward_mean": {"prey_policy": -469.6630813514728, "predator_policy": 584.1012667320596}, "custom_metrics": {}, "hist_stats": {"episode_reward": [726.5323219252269, 334.4594948965098, 6.117731031253248, 172.09315673205012, 631.4684678010257, 29.245388075379292, 176.69420906134215, 237.9203978361267, 22.89426822299461, 162.8734470073433, 68.89951792530566, 1.6316155314232423, 19.542769233275425, 116.83634012832584, 5.190636128677177, 279.3623392621018, 4.449511875522037, 527.1127438404055, 536.2462763132831, 350.2148278882423, 52.821614741337605, 8.808183987657074, 453.80525044948376, 616.2112518536981, 462.472015943553, 136.2763391080148, 1.4172494993952536, 325.51187249648063, 680.7441979454821, 223.37125155242717, 149.44335785399232, 120.08168867184115, -18.158560437270452, 239.0282275626621, 7.782891632747981, 744.0255341164683, 86.29973182480515, 25.62678125181678, 144.68109110172855, 39.427192566285086, 19.0452414085533, 294.64004488921984, 7.29999999999999, 41.327726423745546, 218.47717166129587, 79.34906596823126, 8.140331935407776, 15.299999999999976, 319.4255118748112, 8.899999999999979, 149.81755284077673, 197.00669132037527, 5.591044010978802, 92.86944333076819, 23.700000000000088, 502.7270691403733, 699.4810662029023, 31.755001552520362, 16.743010095487524, 175.61089660576906, -25.485869173930343, 64.06047932150237, 37.09999999999999, 373.6642846593616, 261.6789432634274, 24.900000000000006, 250.78204820065565, 28.000000000000142, 0.7000000000000046, 598.0064012087877, 544.1969041835579, 455.9968385725917, 248.1468033896551, 472.1466334639948, 908.5658341687821, 357.09408255248553, 499.9438325127116, 422.66936888226843, 530.7721059598886, 396.6833501103423, 0.28044944472567324, 434.2320674246923, 133.39718112288242, 388.85399874947126, 17.070886094768547, 364.04120824798883, 95.179747914828, 31.43914128402276, 29.596990180730053, 516.6423499339288, 66.32262190592452, 361.1354748193234, 264.5492166891976, 369.8346721231744, 267.0870940849436, 6.157911493714837, 16.91252527779776, 865.227595050954, 12.26320845290659, 381.12120084559155], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [363.5208703994206, -661.2544626828263, -684.1224469074, 23.81998686955795, -323.65320530307145, -682.5380296547894, -410.9637719533902, -745.643456088008, 44.63109026630619, -976.1332992131956, -811.5953733827995, -629.991981776055, -359.69786512194844, -781.232255438772, -833.5666834861963, -370.5034996875901, -694.1799156042105, -896.7865374463291, -512.9803496901704, -660.5260799109549, -694.5342946508142, -623.9809530666324, -610.2531772051916, -622.5702222002766, -486.06914241496236, -654.3169065446315, -899.2463368449446, -594.482964945319, -717.9761544471069, -362.04125147873737, -319.118409760766, -276.38196271884624, -517.6723106690006, -718.5253297171213, -734.7182798189036, 318.74248110075865, -94.30386566329283, -1059.4682076768208, -145.1723123525123, -452.8320438745616, -378.7990523666858, -597.8782961489072, -648.5292614334239, -747.4411614421812, -776.3098794743241, -232.50837482321072, -838.1261943874212, 275.6237650251913, -91.03568837906396, -560.7335852246209, -603.6445416490735, -123.88468321562792, -479.7199559681842, -350.1461987727106, -215.55071493984377, -488.7190425436826, -73.22268910997553, -832.8232387842684, -403.0083300815703, -908.4488450387566, -21.295704763427793, -832.9948434171824, -401.5839059188357, -133.85605997465083, -498.5708320604365, -788.068832369545, 16.94431043716812, -92.54017563917463, -714.7711786128249, -837.0086067815972, -904.173649571877, 168.3063552966244, -326.4489471429074, -586.7427313511034, -425.6858041811654, -788.7308845024082, -740.8479949226694, 0.6185431951921757, -788.0174027445997, -630.8533767580087, -616.8621830000667, -800.7965256471718, 90.8275578008627, -582.2370812774293, -551.6886111337235, -872.4521042692202, -508.7183902567281, -695.6820146670958, -122.24043438508696, -751.800628071084, -369.07874245306357, -643.6168689807699, -662.1216738953652, -656.0218890406741, -412.55326860916193, -584.6589464799764, -736.4964697089653, -63.96812982034456, -678.0900590319147, -380.7030101150849, -848.2165645484681, -403.2882562399033, -825.8863457203915, -127.79192428437202, -726.9373291940125, -597.990044901338, -421.6733466067216, -967.4893892951532, -307.2552041929435, -729.4638875200496, -702.2269514528169, 153.7837067951988, 220.72221340353286, -734.693223811062, -573.6771179959738, -217.98130170459842, -635.3010698023552, -918.7104464855441, -770.1838606754701, -528.6026495284738, -716.653228317292, -243.15838737220457, -493.1547141386317, -421.2918328642092, -667.1902337493167, -281.72591258203636, -298.54432450206605, -524.9838005019566, -432.5728506423836, -178.4306446710287, -340.9684181952704, -559.5623349819705, -688.5343167753274, -294.9426062846554, -217.64620161372676, -673.8854366349709, -704.1183107835213, -658.9397656855499, -931.9306980683697, 208.96129299964545, -159.43494564770393, -641.8030775598421, -65.76669252808388, -707.6784145335636, -119.96060217672508, -638.3974127022424, 32.9370553386422, -419.41825476230105, 279.5521288522981, -816.3334423579383, -613.5519977992356, 73.82138065943572, -732.1386545728542, 188.8882957673383, 40.0000000000003, -808.3804249704394, -297.07146261195595, 252.45019862041573, 28.235794092487033, -720.7389490269162, -735.3582869686545, -781.8490730750374, 222.37539108079812, -110.81850602725552, -510.9345838957821, -575.8053517259813, -216.13229772907988, -541.903985025584, -750.4514496253798, -532.7871327635928, -730.2148553003314, 100.9377303955404, -256.67267753064215, -603.1860056179968, -662.8100500028229, -578.8195824942842, -350.7498666072824, -644.6498484502902, 35.485149972818746, -624.0135806673269, -571.1388517021954, -403.28035508815765, -682.885203850724, 6.030913762449217, 8.755643053298552, -652.864229860671, -272.572322549207, -715.6705874115648, 188.84061534143126, -540.4439046813325, -874.951660676166, -741.8388951307883, -464.81422424463756, -841.0690043996119, -679.9189583748994, 344.4771884532982, -975.6556044289956, -594.6716084634729, -324.44940526165055, -800.7056813319167], "policy_predator_policy_reward": [364.9131210774944, 659.3527931311405, 538.2137061745098, 456.54824875983985, 327.1658101893453, 685.1431557997713, 598.3386746353942, 730.3617101380559, 670.4862301868616, 892.4844465610486, 815.6233922409476, 655.2093509932861, 541.416192129862, 776.2081374922032, 799.3016428681159, 642.6889381417986, 700.507818582097, 913.3529026914337, 684.3431971009916, 652.0366795074789, 588.8685858589254, 798.5461797838284, 608.5183767904332, 625.9366381464599, 504.91191164824005, 655.0169065446316, 929.969471158778, 680.5961707598129, 444.85261361030314, 640.3554284442179, 544.465416540773, 330.39729520094744, 512.1396888711181, 728.5074633905285, 507.85715596182683, 435.23138659672384, 766.2676764206755, 923.7506732327194, 445.48361792381905, 502.73556619149764, 390.79905236668833, 638.6999108902453, 651.3374454210816, 753.4411614421814, 687.2671559999512, 775.3563487470643, 844.2881603714601, 334.4255208444671, 694.0947409691743, 420.1465485780619, 581.1296547843142, 282.6759091884047, 383.4141160206325, 447.86928821966376, 567.326654279804, 462.45497570020484, 812.7541025951883, 774.0360232445391, 673.3879566240657, 861.4404700486886, 170.92671203278056, 832.807194001822, 566.472334149306, 89.04932041602414, 806.746990872346, 461.7341131203655, 255.036244875085, 59.58784788958357, 722.5711786128267, 836.9914984143452, 839.1640782214504, 640.7287501702668, 376.7535694650589, 622.7378408537597, 451.0125854329848, 789.0308845024082, 742.7073727387426, 142.20317009046497, 788.0174027445997, 670.2805693242943, 610.9210256474115, 825.782924408381, 213.340522615083, 572.7090457507036, 557.7886111337244, 873.6521042692204, 528.018390256729, 717.7097410908423, 692.4102069574304, 400.10802716003684, 517.0392681614949, 575.0054092405704, 674.2879252130833, 651.9959696583645, 423.9532686091642, 588.5589464799765, 501.82657151262435, 618.0635398914978, 682.7900590319158, 384.90301011508643, 847.068205057228, 554.2541685719191, 823.1563935195654, 327.52856780557164, 714.0374309128104, 616.4809871935219, 814.5133937543524, 667.5187854782902, 324.7552041929437, 735.6638875200497, 686.8507310899383, 364.3195827080508, 592.8334673605407, 620.618609249892, 325.13467027744196, 498.27875097565146, 651.6726839444823, 919.0818424389046, 758.7187269594118, 715.6786798503073, 734.2832839119874, 200.04246260357806, 559.5117761118765, 418.99525021246757, 669.1902337493171, 316.8259125820356, 557.8256305780997, 639.3667790852844, 408.7211445167969, 463.96129406004127, 358.4684181952702, 566.9623349819709, 652.4696498417139, 581.7893214189287, 241.5462016137254, 677.9854366349718, 704.8183107835215, 658.9397656855499, 857.0142012214611, 463.9616050560477, 668.5181510130732, 676.9167763780265, 538.8133762083639, 690.6285694258726, 384.1268676839044, 622.3779505847186, 374.19615655428487, 484.4316763333639, 724.4865440685295, 720.8606036058915, 504.34858714858024, 392.47611254370673, 536.2746546466683, 506.91953667155485, 502.6060139618643, 688.4437798908416, 195.93904757492936, 379.4543223764951, 423.5456322181538, 665.6408728266141, 735.7008028540581, 781.7870066343595, 16.25, 306.4251823711513, 680.758540560894, 539.3785761837518, 352.8837453602544, 794.0065361438853, 751.3932578849096, 548.9162105988313, 580.9323087667276, 412.38602438605585, 348.6524254454733, 606.3860056179966, 738.751364216175, 534.3174095649564, 522.6264683825442, 502.37023685575804, 490.019603873109, 615.1511767553309, 546.9993501141048, 493.7424785821754, 671.710507700891, 366.27925720670714, 230.45294501071106, 678.2048584858601, 676.7444686654363, 681.3331134185091, 492.2801289420833, 126.4102544827621, 881.1367697870845, 741.8116975135845, 477.426749522438, 845.3690043996123, 556.2520410822797, 644.4173238902754, 975.7927733347462, 606.7976480106305, 712.6185498869817, 793.6577375521815]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.9643854048076355, "mean_inference_ms": 4.397054278057241, "mean_action_processing_ms": 1.650470206430976, "mean_env_wait_ms": 12.507465308403338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006772756576538086, "StateBufferConnector_ms": 0.016794681549072266, "ViewRequirementAgentConnector_ms": 0.16363346576690674}, "num_episodes": 12, "episode_return_max": 908.5658341687821, "episode_return_min": -25.485869173930343, "episode_return_mean": 228.87637076117286, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 157.15252176670694, "num_env_steps_trained_throughput_per_sec": 157.15252176670694, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 1232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1232000, "timers": {"training_iteration_time_ms": 25926.093, "restore_workers_time_ms": 0.049, "training_step_time_ms": 25925.764, "sample_time_ms": 2335.739, "learn_time_ms": 23561.301, "learn_throughput": 169.77, "synch_weights_time_ms": 23.207}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "done": false, "training_iteration": 77, "trial_id": "0b608_00000", "date": "2024-08-22_14-18-23", "timestamp": 1724316503, "time_this_iter_s": 25.504610776901245, "time_total_s": 1995.725574016571, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30e474a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1995.725574016571, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 33.486111111111114, "ram_util_percent": 83.11666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.86938695655298, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 6.80416727116499, "policy_loss": -0.009861735171495528, "vf_loss": 6.8132258995500194, "vf_explained_var": 0.1854119787771235, "kl": 0.008031235678397395, "entropy": 0.3777887448589638, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 73238.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.523969866232896, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.042400029096654, "policy_loss": -0.008937000953370617, "vf_loss": 7.0497418751792305, "vf_explained_var": 0.4125489077870808, "kl": 0.007975738611387671, "entropy": 0.5806519468625386, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 73238.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 908.5658341687821, "episode_reward_min": -25.485869173930343, "episode_reward_mean": 227.54786939741382, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1059.4682076768208, "predator_policy": 16.25}, "policy_reward_max": {"prey_policy": 344.4771884532982, "predator_policy": 975.7927733347462}, "policy_reward_mean": {"prey_policy": -462.5443531358644, "predator_policy": 576.3182878345717}, "custom_metrics": {}, "hist_stats": {"episode_reward": [162.8734470073433, 68.89951792530566, 1.6316155314232423, 19.542769233275425, 116.83634012832584, 5.190636128677177, 279.3623392621018, 4.449511875522037, 527.1127438404055, 536.2462763132831, 350.2148278882423, 52.821614741337605, 8.808183987657074, 453.80525044948376, 616.2112518536981, 462.472015943553, 136.2763391080148, 1.4172494993952536, 325.51187249648063, 680.7441979454821, 223.37125155242717, 149.44335785399232, 120.08168867184115, -18.158560437270452, 239.0282275626621, 7.782891632747981, 744.0255341164683, 86.29973182480515, 25.62678125181678, 144.68109110172855, 39.427192566285086, 19.0452414085533, 294.64004488921984, 7.29999999999999, 41.327726423745546, 218.47717166129587, 79.34906596823126, 8.140331935407776, 15.299999999999976, 319.4255118748112, 8.899999999999979, 149.81755284077673, 197.00669132037527, 5.591044010978802, 92.86944333076819, 23.700000000000088, 502.7270691403733, 699.4810662029023, 31.755001552520362, 16.743010095487524, 175.61089660576906, -25.485869173930343, 64.06047932150237, 37.09999999999999, 373.6642846593616, 261.6789432634274, 24.900000000000006, 250.78204820065565, 28.000000000000142, 0.7000000000000046, 598.0064012087877, 544.1969041835579, 455.9968385725917, 248.1468033896551, 472.1466334639948, 908.5658341687821, 357.09408255248553, 499.9438325127116, 422.66936888226843, 530.7721059598886, 396.6833501103423, 0.28044944472567324, 434.2320674246923, 133.39718112288242, 388.85399874947126, 17.070886094768547, 364.04120824798883, 95.179747914828, 31.43914128402276, 29.596990180730053, 516.6423499339288, 66.32262190592452, 361.1354748193234, 264.5492166891976, 369.8346721231744, 267.0870940849436, 6.157911493714837, 16.91252527779776, 865.227595050954, 12.26320845290659, 381.12120084559155, 342.2804659704815, 542.2222732620157, 108.64098758878792, 17.667595630429666, 85.77700944070408, 80.53802571551024, 205.5819011616503, 215.26683467917675, 606.6002057572456], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-512.9803496901704, -660.5260799109549, -694.5342946508142, -623.9809530666324, -610.2531772051916, -622.5702222002766, -486.06914241496236, -654.3169065446315, -899.2463368449446, -594.482964945319, -717.9761544471069, -362.04125147873737, -319.118409760766, -276.38196271884624, -517.6723106690006, -718.5253297171213, -734.7182798189036, 318.74248110075865, -94.30386566329283, -1059.4682076768208, -145.1723123525123, -452.8320438745616, -378.7990523666858, -597.8782961489072, -648.5292614334239, -747.4411614421812, -776.3098794743241, -232.50837482321072, -838.1261943874212, 275.6237650251913, -91.03568837906396, -560.7335852246209, -603.6445416490735, -123.88468321562792, -479.7199559681842, -350.1461987727106, -215.55071493984377, -488.7190425436826, -73.22268910997553, -832.8232387842684, -403.0083300815703, -908.4488450387566, -21.295704763427793, -832.9948434171824, -401.5839059188357, -133.85605997465083, -498.5708320604365, -788.068832369545, 16.94431043716812, -92.54017563917463, -714.7711786128249, -837.0086067815972, -904.173649571877, 168.3063552966244, -326.4489471429074, -586.7427313511034, -425.6858041811654, -788.7308845024082, -740.8479949226694, 0.6185431951921757, -788.0174027445997, -630.8533767580087, -616.8621830000667, -800.7965256471718, 90.8275578008627, -582.2370812774293, -551.6886111337235, -872.4521042692202, -508.7183902567281, -695.6820146670958, -122.24043438508696, -751.800628071084, -369.07874245306357, -643.6168689807699, -662.1216738953652, -656.0218890406741, -412.55326860916193, -584.6589464799764, -736.4964697089653, -63.96812982034456, -678.0900590319147, -380.7030101150849, -848.2165645484681, -403.2882562399033, -825.8863457203915, -127.79192428437202, -726.9373291940125, -597.990044901338, -421.6733466067216, -967.4893892951532, -307.2552041929435, -729.4638875200496, -702.2269514528169, 153.7837067951988, 220.72221340353286, -734.693223811062, -573.6771179959738, -217.98130170459842, -635.3010698023552, -918.7104464855441, -770.1838606754701, -528.6026495284738, -716.653228317292, -243.15838737220457, -493.1547141386317, -421.2918328642092, -667.1902337493167, -281.72591258203636, -298.54432450206605, -524.9838005019566, -432.5728506423836, -178.4306446710287, -340.9684181952704, -559.5623349819705, -688.5343167753274, -294.9426062846554, -217.64620161372676, -673.8854366349709, -704.1183107835213, -658.9397656855499, -931.9306980683697, 208.96129299964545, -159.43494564770393, -641.8030775598421, -65.76669252808388, -707.6784145335636, -119.96060217672508, -638.3974127022424, 32.9370553386422, -419.41825476230105, 279.5521288522981, -816.3334423579383, -613.5519977992356, 73.82138065943572, -732.1386545728542, 188.8882957673383, 40.0000000000003, -808.3804249704394, -297.07146261195595, 252.45019862041573, 28.235794092487033, -720.7389490269162, -735.3582869686545, -781.8490730750374, 222.37539108079812, -110.81850602725552, -510.9345838957821, -575.8053517259813, -216.13229772907988, -541.903985025584, -750.4514496253798, -532.7871327635928, -730.2148553003314, 100.9377303955404, -256.67267753064215, -603.1860056179968, -662.8100500028229, -578.8195824942842, -350.7498666072824, -644.6498484502902, 35.485149972818746, -624.0135806673269, -571.1388517021954, -403.28035508815765, -682.885203850724, 6.030913762449217, 8.755643053298552, -652.864229860671, -272.572322549207, -715.6705874115648, 188.84061534143126, -540.4439046813325, -874.951660676166, -741.8388951307883, -464.81422424463756, -841.0690043996119, -679.9189583748994, 344.4771884532982, -975.6556044289956, -594.6716084634729, -324.44940526165055, -800.7056813319167, -419.5625347977425, -307.04562104157105, -717.3865941179364, -46.425102933134724, -442.3990305999482, -611.3744555764406, -746.2650780144339, -624.0266252191383, -672.1712134909671, -289.03702320931865, -514.3313128245816, -630.0560154093112, -598.292883781619, 27.776832183535795, -216.29274501086985, -459.5568723592181, -622.41520636611, -117.2837105208175], "policy_predator_policy_reward": [684.3431971009916, 652.0366795074789, 588.8685858589254, 798.5461797838284, 608.5183767904332, 625.9366381464599, 504.91191164824005, 655.0169065446316, 929.969471158778, 680.5961707598129, 444.85261361030314, 640.3554284442179, 544.465416540773, 330.39729520094744, 512.1396888711181, 728.5074633905285, 507.85715596182683, 435.23138659672384, 766.2676764206755, 923.7506732327194, 445.48361792381905, 502.73556619149764, 390.79905236668833, 638.6999108902453, 651.3374454210816, 753.4411614421814, 687.2671559999512, 775.3563487470643, 844.2881603714601, 334.4255208444671, 694.0947409691743, 420.1465485780619, 581.1296547843142, 282.6759091884047, 383.4141160206325, 447.86928821966376, 567.326654279804, 462.45497570020484, 812.7541025951883, 774.0360232445391, 673.3879566240657, 861.4404700486886, 170.92671203278056, 832.807194001822, 566.472334149306, 89.04932041602414, 806.746990872346, 461.7341131203655, 255.036244875085, 59.58784788958357, 722.5711786128267, 836.9914984143452, 839.1640782214504, 640.7287501702668, 376.7535694650589, 622.7378408537597, 451.0125854329848, 789.0308845024082, 742.7073727387426, 142.20317009046497, 788.0174027445997, 670.2805693242943, 610.9210256474115, 825.782924408381, 213.340522615083, 572.7090457507036, 557.7886111337244, 873.6521042692204, 528.018390256729, 717.7097410908423, 692.4102069574304, 400.10802716003684, 517.0392681614949, 575.0054092405704, 674.2879252130833, 651.9959696583645, 423.9532686091642, 588.5589464799765, 501.82657151262435, 618.0635398914978, 682.7900590319158, 384.90301011508643, 847.068205057228, 554.2541685719191, 823.1563935195654, 327.52856780557164, 714.0374309128104, 616.4809871935219, 814.5133937543524, 667.5187854782902, 324.7552041929437, 735.6638875200497, 686.8507310899383, 364.3195827080508, 592.8334673605407, 620.618609249892, 325.13467027744196, 498.27875097565146, 651.6726839444823, 919.0818424389046, 758.7187269594118, 715.6786798503073, 734.2832839119874, 200.04246260357806, 559.5117761118765, 418.99525021246757, 669.1902337493171, 316.8259125820356, 557.8256305780997, 639.3667790852844, 408.7211445167969, 463.96129406004127, 358.4684181952702, 566.9623349819709, 652.4696498417139, 581.7893214189287, 241.5462016137254, 677.9854366349718, 704.8183107835215, 658.9397656855499, 857.0142012214611, 463.9616050560477, 668.5181510130732, 676.9167763780265, 538.8133762083639, 690.6285694258726, 384.1268676839044, 622.3779505847186, 374.19615655428487, 484.4316763333639, 724.4865440685295, 720.8606036058915, 504.34858714858024, 392.47611254370673, 536.2746546466683, 506.91953667155485, 502.6060139618643, 688.4437798908416, 195.93904757492936, 379.4543223764951, 423.5456322181538, 665.6408728266141, 735.7008028540581, 781.7870066343595, 16.25, 306.4251823711513, 680.758540560894, 539.3785761837518, 352.8837453602544, 794.0065361438853, 751.3932578849096, 548.9162105988313, 580.9323087667276, 412.38602438605585, 348.6524254454733, 606.3860056179966, 738.751364216175, 534.3174095649564, 522.6264683825442, 502.37023685575804, 490.019603873109, 615.1511767553309, 546.9993501141048, 493.7424785821754, 671.710507700891, 366.27925720670714, 230.45294501071106, 678.2048584858601, 676.7444686654363, 681.3331134185091, 492.2801289420833, 126.4102544827621, 881.1367697870845, 741.8116975135845, 477.426749522438, 845.3690043996123, 556.2520410822797, 644.4173238902754, 975.7927733347462, 606.7976480106305, 712.6185498869817, 793.6577375521815, 672.3602817090405, 396.5283401007531, 645.8161941992258, 660.2177761138632, 593.900966235423, 568.5135075297578, 747.9650780144343, 639.9942208495679, 553.8913990636188, 493.0938470773756, 616.376435691086, 608.5489182583168, 425.9873916513158, 350.11056110842236, 521.1672972746399, 369.94915477462695, 585.3212174177578, 760.9779052264091]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.951541344822966, "mean_inference_ms": 4.399920940540608, "mean_action_processing_ms": 1.6529700915057615, "mean_env_wait_ms": 12.510374975564094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004551410675048828, "StateBufferConnector_ms": 0.005216836929321289, "ViewRequirementAgentConnector_ms": 0.16167736053466797}, "num_episodes": 9, "episode_return_max": 908.5658341687821, "episode_return_min": -25.485869173930343, "episode_return_mean": 227.54786939741382, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.7762698937923, "num_env_steps_trained_throughput_per_sec": 154.7762698937923, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 25853.045, "restore_workers_time_ms": 0.051, "training_step_time_ms": 25852.733, "sample_time_ms": 2346.938, "learn_time_ms": 23478.307, "learn_throughput": 170.37, "synch_weights_time_ms": 22.056}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 78, "trial_id": "0b608_00000", "date": "2024-08-22_14-18-49", "timestamp": 1724316529, "time_this_iter_s": 25.899736881256104, "time_total_s": 2021.6253108978271, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x311fd7430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2021.6253108978271, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 32.775, "ram_util_percent": 83.19722222222225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.730772093616466, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 6.6665496916998, "policy_loss": -0.010085281340907963, "vf_loss": 6.675869464369678, "vf_explained_var": 0.28968274549201684, "kl": 0.007654994755623636, "entropy": 0.39386769567847885, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74183.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 31.299963188171386, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.631692861627649, "policy_loss": -0.008364904639138668, "vf_loss": 6.638164257877087, "vf_explained_var": 0.600008753935496, "kl": 0.009467596809562079, "entropy": 0.6022404326017572, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74183.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "env_runners": {"episode_reward_max": 908.5658341687821, "episode_reward_min": -25.485869173930343, "episode_reward_mean": 230.2280970270083, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -975.6556044289956, "predator_policy": 16.25}, "policy_reward_max": {"prey_policy": 387.55574381085427, "predator_policy": 975.7927733347462}, "policy_reward_mean": {"prey_policy": -440.0158140345676, "predator_policy": 555.129862548072}, "custom_metrics": {}, "hist_stats": {"episode_reward": [616.2112518536981, 462.472015943553, 136.2763391080148, 1.4172494993952536, 325.51187249648063, 680.7441979454821, 223.37125155242717, 149.44335785399232, 120.08168867184115, -18.158560437270452, 239.0282275626621, 7.782891632747981, 744.0255341164683, 86.29973182480515, 25.62678125181678, 144.68109110172855, 39.427192566285086, 19.0452414085533, 294.64004488921984, 7.29999999999999, 41.327726423745546, 218.47717166129587, 79.34906596823126, 8.140331935407776, 15.299999999999976, 319.4255118748112, 8.899999999999979, 149.81755284077673, 197.00669132037527, 5.591044010978802, 92.86944333076819, 23.700000000000088, 502.7270691403733, 699.4810662029023, 31.755001552520362, 16.743010095487524, 175.61089660576906, -25.485869173930343, 64.06047932150237, 37.09999999999999, 373.6642846593616, 261.6789432634274, 24.900000000000006, 250.78204820065565, 28.000000000000142, 0.7000000000000046, 598.0064012087877, 544.1969041835579, 455.9968385725917, 248.1468033896551, 472.1466334639948, 908.5658341687821, 357.09408255248553, 499.9438325127116, 422.66936888226843, 530.7721059598886, 396.6833501103423, 0.28044944472567324, 434.2320674246923, 133.39718112288242, 388.85399874947126, 17.070886094768547, 364.04120824798883, 95.179747914828, 31.43914128402276, 29.596990180730053, 516.6423499339288, 66.32262190592452, 361.1354748193234, 264.5492166891976, 369.8346721231744, 267.0870940849436, 6.157911493714837, 16.91252527779776, 865.227595050954, 12.26320845290659, 381.12120084559155, 342.2804659704815, 542.2222732620157, 108.64098758878792, 17.667595630429666, 85.77700944070408, 80.53802571551024, 205.5819011616503, 215.26683467917675, 606.6002057572456, 69.10000000000036, 44.11132727611512, 10.369000420553226, 179.64681100052314, 56.16773097192949, 66.17022625710982, 123.91492639942084, 221.32860807976363, 840.8174665572095, 31.03365222390934, 60.62913747514318, 386.82420878105495, 545.8975089296754, 219.80723289942912], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-838.1261943874212, 275.6237650251913, -91.03568837906396, -560.7335852246209, -603.6445416490735, -123.88468321562792, -479.7199559681842, -350.1461987727106, -215.55071493984377, -488.7190425436826, -73.22268910997553, -832.8232387842684, -403.0083300815703, -908.4488450387566, -21.295704763427793, -832.9948434171824, -401.5839059188357, -133.85605997465083, -498.5708320604365, -788.068832369545, 16.94431043716812, -92.54017563917463, -714.7711786128249, -837.0086067815972, -904.173649571877, 168.3063552966244, -326.4489471429074, -586.7427313511034, -425.6858041811654, -788.7308845024082, -740.8479949226694, 0.6185431951921757, -788.0174027445997, -630.8533767580087, -616.8621830000667, -800.7965256471718, 90.8275578008627, -582.2370812774293, -551.6886111337235, -872.4521042692202, -508.7183902567281, -695.6820146670958, -122.24043438508696, -751.800628071084, -369.07874245306357, -643.6168689807699, -662.1216738953652, -656.0218890406741, -412.55326860916193, -584.6589464799764, -736.4964697089653, -63.96812982034456, -678.0900590319147, -380.7030101150849, -848.2165645484681, -403.2882562399033, -825.8863457203915, -127.79192428437202, -726.9373291940125, -597.990044901338, -421.6733466067216, -967.4893892951532, -307.2552041929435, -729.4638875200496, -702.2269514528169, 153.7837067951988, 220.72221340353286, -734.693223811062, -573.6771179959738, -217.98130170459842, -635.3010698023552, -918.7104464855441, -770.1838606754701, -528.6026495284738, -716.653228317292, -243.15838737220457, -493.1547141386317, -421.2918328642092, -667.1902337493167, -281.72591258203636, -298.54432450206605, -524.9838005019566, -432.5728506423836, -178.4306446710287, -340.9684181952704, -559.5623349819705, -688.5343167753274, -294.9426062846554, -217.64620161372676, -673.8854366349709, -704.1183107835213, -658.9397656855499, -931.9306980683697, 208.96129299964545, -159.43494564770393, -641.8030775598421, -65.76669252808388, -707.6784145335636, -119.96060217672508, -638.3974127022424, 32.9370553386422, -419.41825476230105, 279.5521288522981, -816.3334423579383, -613.5519977992356, 73.82138065943572, -732.1386545728542, 188.8882957673383, 40.0000000000003, -808.3804249704394, -297.07146261195595, 252.45019862041573, 28.235794092487033, -720.7389490269162, -735.3582869686545, -781.8490730750374, 222.37539108079812, -110.81850602725552, -510.9345838957821, -575.8053517259813, -216.13229772907988, -541.903985025584, -750.4514496253798, -532.7871327635928, -730.2148553003314, 100.9377303955404, -256.67267753064215, -603.1860056179968, -662.8100500028229, -578.8195824942842, -350.7498666072824, -644.6498484502902, 35.485149972818746, -624.0135806673269, -571.1388517021954, -403.28035508815765, -682.885203850724, 6.030913762449217, 8.755643053298552, -652.864229860671, -272.572322549207, -715.6705874115648, 188.84061534143126, -540.4439046813325, -874.951660676166, -741.8388951307883, -464.81422424463756, -841.0690043996119, -679.9189583748994, 344.4771884532982, -975.6556044289956, -594.6716084634729, -324.44940526165055, -800.7056813319167, -419.5625347977425, -307.04562104157105, -717.3865941179364, -46.425102933134724, -442.3990305999482, -611.3744555764406, -746.2650780144339, -624.0266252191383, -672.1712134909671, -289.03702320931865, -514.3313128245816, -630.0560154093112, -598.292883781619, 27.776832183535795, -216.29274501086985, -459.5568723592181, -622.41520636611, -117.2837105208175, -16.786545254058503, -69.83523062161593, -219.92457652247086, -317.8885525936786, -522.221842017172, -210.5825450622014, -458.7582996272031, -289.3309043952778, -265.6209747256004, -875.7707211078443, -434.5082046602713, -478.4162096763683, -246.74285612918246, -638.6296677294139, -610.2620581496742, -237.72009484128978, -632.1638645053928, 387.55574381085427, -280.0818440163538, -610.0829031544397, -496.7932641108409, -346.6210057619862, -31.706529015637464, -571.4834904536136, -886.3393030240085, 170.89736835597756, -333.38690983425187, -790.9809951571427], "policy_predator_policy_reward": [844.2881603714601, 334.4255208444671, 694.0947409691743, 420.1465485780619, 581.1296547843142, 282.6759091884047, 383.4141160206325, 447.86928821966376, 567.326654279804, 462.45497570020484, 812.7541025951883, 774.0360232445391, 673.3879566240657, 861.4404700486886, 170.92671203278056, 832.807194001822, 566.472334149306, 89.04932041602414, 806.746990872346, 461.7341131203655, 255.036244875085, 59.58784788958357, 722.5711786128267, 836.9914984143452, 839.1640782214504, 640.7287501702668, 376.7535694650589, 622.7378408537597, 451.0125854329848, 789.0308845024082, 742.7073727387426, 142.20317009046497, 788.0174027445997, 670.2805693242943, 610.9210256474115, 825.782924408381, 213.340522615083, 572.7090457507036, 557.7886111337244, 873.6521042692204, 528.018390256729, 717.7097410908423, 692.4102069574304, 400.10802716003684, 517.0392681614949, 575.0054092405704, 674.2879252130833, 651.9959696583645, 423.9532686091642, 588.5589464799765, 501.82657151262435, 618.0635398914978, 682.7900590319158, 384.90301011508643, 847.068205057228, 554.2541685719191, 823.1563935195654, 327.52856780557164, 714.0374309128104, 616.4809871935219, 814.5133937543524, 667.5187854782902, 324.7552041929437, 735.6638875200497, 686.8507310899383, 364.3195827080508, 592.8334673605407, 620.618609249892, 325.13467027744196, 498.27875097565146, 651.6726839444823, 919.0818424389046, 758.7187269594118, 715.6786798503073, 734.2832839119874, 200.04246260357806, 559.5117761118765, 418.99525021246757, 669.1902337493171, 316.8259125820356, 557.8256305780997, 639.3667790852844, 408.7211445167969, 463.96129406004127, 358.4684181952702, 566.9623349819709, 652.4696498417139, 581.7893214189287, 241.5462016137254, 677.9854366349718, 704.8183107835215, 658.9397656855499, 857.0142012214611, 463.9616050560477, 668.5181510130732, 676.9167763780265, 538.8133762083639, 690.6285694258726, 384.1268676839044, 622.3779505847186, 374.19615655428487, 484.4316763333639, 724.4865440685295, 720.8606036058915, 504.34858714858024, 392.47611254370673, 536.2746546466683, 506.91953667155485, 502.6060139618643, 688.4437798908416, 195.93904757492936, 379.4543223764951, 423.5456322181538, 665.6408728266141, 735.7008028540581, 781.7870066343595, 16.25, 306.4251823711513, 680.758540560894, 539.3785761837518, 352.8837453602544, 794.0065361438853, 751.3932578849096, 548.9162105988313, 580.9323087667276, 412.38602438605585, 348.6524254454733, 606.3860056179966, 738.751364216175, 534.3174095649564, 522.6264683825442, 502.37023685575804, 490.019603873109, 615.1511767553309, 546.9993501141048, 493.7424785821754, 671.710507700891, 366.27925720670714, 230.45294501071106, 678.2048584858601, 676.7444686654363, 681.3331134185091, 492.2801289420833, 126.4102544827621, 881.1367697870845, 741.8116975135845, 477.426749522438, 845.3690043996123, 556.2520410822797, 644.4173238902754, 975.7927733347462, 606.7976480106305, 712.6185498869817, 793.6577375521815, 672.3602817090405, 396.5283401007531, 645.8161941992258, 660.2177761138632, 593.900966235423, 568.5135075297578, 747.9650780144343, 639.9942208495679, 553.8913990636188, 493.0938470773756, 616.376435691086, 608.5489182583168, 425.9873916513158, 350.11056110842236, 521.1672972746399, 369.94915477462695, 585.3212174177578, 760.9779052264091, 112.86604316587344, 42.855732709799845, 490.0107835852273, 91.91367280703724, 426.6095854523822, 316.5638020475414, 454.24963335608305, 473.4863816669225, 321.6887056975334, 875.8707211078444, 593.5063208529303, 385.58831974082335, 481.0980176681908, 528.189432589828, 591.7479925429926, 477.56276852773595, 607.1297203481353, 478.29586690361214, 300.51549624026427, 620.68290315444, 595.0790693315664, 308.9643380164041, 426.35328796102914, 563.6609402892745, 816.1566730006596, 445.1827705970485, 587.5869609819395, 756.5881769088876]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.951200374842799, "mean_inference_ms": 4.391762840808227, "mean_action_processing_ms": 1.6510980530768324, "mean_env_wait_ms": 12.50671511177764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0045729875564575195, "StateBufferConnector_ms": 0.00519251823425293, "ViewRequirementAgentConnector_ms": 0.16089081764221191}, "num_episodes": 14, "episode_return_max": 908.5658341687821, "episode_return_min": -25.485869173930343, "episode_return_mean": 230.2280970270083, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.74729345427744, "num_env_steps_trained_throughput_per_sec": 153.74729345427744, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 1264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1264000, "timers": {"training_iteration_time_ms": 25919.56, "restore_workers_time_ms": 0.051, "training_step_time_ms": 25919.119, "sample_time_ms": 2393.668, "learn_time_ms": 23496.917, "learn_throughput": 170.235, "synch_weights_time_ms": 22.237}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "done": false, "training_iteration": 79, "trial_id": "0b608_00000", "date": "2024-08-22_14-19-15", "timestamp": 1724316555, "time_this_iter_s": 26.058406829833984, "time_total_s": 2047.6837177276611, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a34e4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2047.6837177276611, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 33.86216216216216, "ram_util_percent": 83.05945945945946}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.036647835231964, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 6.755963505134381, "policy_loss": -0.0081040404330466, "vf_loss": 6.763365163248052, "vf_explained_var": 0.15846163993159298, "kl": 0.007023867398313193, "entropy": 0.38355007997896307, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 75128.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 33.96829723151273, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.849203885295403, "policy_loss": -0.00872887882315332, "vf_loss": 6.856592237381708, "vf_explained_var": 0.45201304614859283, "kl": 0.00670252733558377, "entropy": 0.534715887636104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 75128.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 908.5658341687821, "episode_reward_min": -25.485869173930343, "episode_reward_mean": 229.15569050996078, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -975.6556044289956, "predator_policy": 16.25}, "policy_reward_max": {"prey_policy": 387.55574381085427, "predator_policy": 975.7927733347462}, "policy_reward_mean": {"prey_policy": -432.6290967643148, "predator_policy": 547.2069420192954}, "custom_metrics": {}, "hist_stats": {"episode_reward": [149.44335785399232, 120.08168867184115, -18.158560437270452, 239.0282275626621, 7.782891632747981, 744.0255341164683, 86.29973182480515, 25.62678125181678, 144.68109110172855, 39.427192566285086, 19.0452414085533, 294.64004488921984, 7.29999999999999, 41.327726423745546, 218.47717166129587, 79.34906596823126, 8.140331935407776, 15.299999999999976, 319.4255118748112, 8.899999999999979, 149.81755284077673, 197.00669132037527, 5.591044010978802, 92.86944333076819, 23.700000000000088, 502.7270691403733, 699.4810662029023, 31.755001552520362, 16.743010095487524, 175.61089660576906, -25.485869173930343, 64.06047932150237, 37.09999999999999, 373.6642846593616, 261.6789432634274, 24.900000000000006, 250.78204820065565, 28.000000000000142, 0.7000000000000046, 598.0064012087877, 544.1969041835579, 455.9968385725917, 248.1468033896551, 472.1466334639948, 908.5658341687821, 357.09408255248553, 499.9438325127116, 422.66936888226843, 530.7721059598886, 396.6833501103423, 0.28044944472567324, 434.2320674246923, 133.39718112288242, 388.85399874947126, 17.070886094768547, 364.04120824798883, 95.179747914828, 31.43914128402276, 29.596990180730053, 516.6423499339288, 66.32262190592452, 361.1354748193234, 264.5492166891976, 369.8346721231744, 267.0870940849436, 6.157911493714837, 16.91252527779776, 865.227595050954, 12.26320845290659, 381.12120084559155, 342.2804659704815, 542.2222732620157, 108.64098758878792, 17.667595630429666, 85.77700944070408, 80.53802571551024, 205.5819011616503, 215.26683467917675, 606.6002057572456, 69.10000000000036, 44.11132727611512, 10.369000420553226, 179.64681100052314, 56.16773097192949, 66.17022625710982, 123.91492639942084, 221.32860807976363, 840.8174665572095, 31.03365222390934, 60.62913747514318, 386.82420878105495, 545.8975089296754, 219.80723289942912, 109.833300855867, 600.1862330898695, 442.7374469405456, -5.154924194328297, 501.0498905007937, 301.17427877241374, 388.93730072913155], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-21.295704763427793, -832.9948434171824, -401.5839059188357, -133.85605997465083, -498.5708320604365, -788.068832369545, 16.94431043716812, -92.54017563917463, -714.7711786128249, -837.0086067815972, -904.173649571877, 168.3063552966244, -326.4489471429074, -586.7427313511034, -425.6858041811654, -788.7308845024082, -740.8479949226694, 0.6185431951921757, -788.0174027445997, -630.8533767580087, -616.8621830000667, -800.7965256471718, 90.8275578008627, -582.2370812774293, -551.6886111337235, -872.4521042692202, -508.7183902567281, -695.6820146670958, -122.24043438508696, -751.800628071084, -369.07874245306357, -643.6168689807699, -662.1216738953652, -656.0218890406741, -412.55326860916193, -584.6589464799764, -736.4964697089653, -63.96812982034456, -678.0900590319147, -380.7030101150849, -848.2165645484681, -403.2882562399033, -825.8863457203915, -127.79192428437202, -726.9373291940125, -597.990044901338, -421.6733466067216, -967.4893892951532, -307.2552041929435, -729.4638875200496, -702.2269514528169, 153.7837067951988, 220.72221340353286, -734.693223811062, -573.6771179959738, -217.98130170459842, -635.3010698023552, -918.7104464855441, -770.1838606754701, -528.6026495284738, -716.653228317292, -243.15838737220457, -493.1547141386317, -421.2918328642092, -667.1902337493167, -281.72591258203636, -298.54432450206605, -524.9838005019566, -432.5728506423836, -178.4306446710287, -340.9684181952704, -559.5623349819705, -688.5343167753274, -294.9426062846554, -217.64620161372676, -673.8854366349709, -704.1183107835213, -658.9397656855499, -931.9306980683697, 208.96129299964545, -159.43494564770393, -641.8030775598421, -65.76669252808388, -707.6784145335636, -119.96060217672508, -638.3974127022424, 32.9370553386422, -419.41825476230105, 279.5521288522981, -816.3334423579383, -613.5519977992356, 73.82138065943572, -732.1386545728542, 188.8882957673383, 40.0000000000003, -808.3804249704394, -297.07146261195595, 252.45019862041573, 28.235794092487033, -720.7389490269162, -735.3582869686545, -781.8490730750374, 222.37539108079812, -110.81850602725552, -510.9345838957821, -575.8053517259813, -216.13229772907988, -541.903985025584, -750.4514496253798, -532.7871327635928, -730.2148553003314, 100.9377303955404, -256.67267753064215, -603.1860056179968, -662.8100500028229, -578.8195824942842, -350.7498666072824, -644.6498484502902, 35.485149972818746, -624.0135806673269, -571.1388517021954, -403.28035508815765, -682.885203850724, 6.030913762449217, 8.755643053298552, -652.864229860671, -272.572322549207, -715.6705874115648, 188.84061534143126, -540.4439046813325, -874.951660676166, -741.8388951307883, -464.81422424463756, -841.0690043996119, -679.9189583748994, 344.4771884532982, -975.6556044289956, -594.6716084634729, -324.44940526165055, -800.7056813319167, -419.5625347977425, -307.04562104157105, -717.3865941179364, -46.425102933134724, -442.3990305999482, -611.3744555764406, -746.2650780144339, -624.0266252191383, -672.1712134909671, -289.03702320931865, -514.3313128245816, -630.0560154093112, -598.292883781619, 27.776832183535795, -216.29274501086985, -459.5568723592181, -622.41520636611, -117.2837105208175, -16.786545254058503, -69.83523062161593, -219.92457652247086, -317.8885525936786, -522.221842017172, -210.5825450622014, -458.7582996272031, -289.3309043952778, -265.6209747256004, -875.7707211078443, -434.5082046602713, -478.4162096763683, -246.74285612918246, -638.6296677294139, -610.2620581496742, -237.72009484128978, -632.1638645053928, 387.55574381085427, -280.0818440163538, -610.0829031544397, -496.7932641108409, -346.6210057619862, -31.706529015637464, -571.4834904536136, -886.3393030240085, 170.89736835597756, -333.38690983425187, -790.9809951571427, -65.49432499444328, -572.8869043195417, -628.2804401453834, 222.101267384457, 381.63221038310354, -37.193808524640936, -636.1827159880723, -799.2974372215065, -784.0294600506329, -29.418238554420128, -499.3524058582564, -219.40039305197254, -542.6684818851738, -5.625356192583315], "policy_predator_policy_reward": [170.92671203278056, 832.807194001822, 566.472334149306, 89.04932041602414, 806.746990872346, 461.7341131203655, 255.036244875085, 59.58784788958357, 722.5711786128267, 836.9914984143452, 839.1640782214504, 640.7287501702668, 376.7535694650589, 622.7378408537597, 451.0125854329848, 789.0308845024082, 742.7073727387426, 142.20317009046497, 788.0174027445997, 670.2805693242943, 610.9210256474115, 825.782924408381, 213.340522615083, 572.7090457507036, 557.7886111337244, 873.6521042692204, 528.018390256729, 717.7097410908423, 692.4102069574304, 400.10802716003684, 517.0392681614949, 575.0054092405704, 674.2879252130833, 651.9959696583645, 423.9532686091642, 588.5589464799765, 501.82657151262435, 618.0635398914978, 682.7900590319158, 384.90301011508643, 847.068205057228, 554.2541685719191, 823.1563935195654, 327.52856780557164, 714.0374309128104, 616.4809871935219, 814.5133937543524, 667.5187854782902, 324.7552041929437, 735.6638875200497, 686.8507310899383, 364.3195827080508, 592.8334673605407, 620.618609249892, 325.13467027744196, 498.27875097565146, 651.6726839444823, 919.0818424389046, 758.7187269594118, 715.6786798503073, 734.2832839119874, 200.04246260357806, 559.5117761118765, 418.99525021246757, 669.1902337493171, 316.8259125820356, 557.8256305780997, 639.3667790852844, 408.7211445167969, 463.96129406004127, 358.4684181952702, 566.9623349819709, 652.4696498417139, 581.7893214189287, 241.5462016137254, 677.9854366349718, 704.8183107835215, 658.9397656855499, 857.0142012214611, 463.9616050560477, 668.5181510130732, 676.9167763780265, 538.8133762083639, 690.6285694258726, 384.1268676839044, 622.3779505847186, 374.19615655428487, 484.4316763333639, 724.4865440685295, 720.8606036058915, 504.34858714858024, 392.47611254370673, 536.2746546466683, 506.91953667155485, 502.6060139618643, 688.4437798908416, 195.93904757492936, 379.4543223764951, 423.5456322181538, 665.6408728266141, 735.7008028540581, 781.7870066343595, 16.25, 306.4251823711513, 680.758540560894, 539.3785761837518, 352.8837453602544, 794.0065361438853, 751.3932578849096, 548.9162105988313, 580.9323087667276, 412.38602438605585, 348.6524254454733, 606.3860056179966, 738.751364216175, 534.3174095649564, 522.6264683825442, 502.37023685575804, 490.019603873109, 615.1511767553309, 546.9993501141048, 493.7424785821754, 671.710507700891, 366.27925720670714, 230.45294501071106, 678.2048584858601, 676.7444686654363, 681.3331134185091, 492.2801289420833, 126.4102544827621, 881.1367697870845, 741.8116975135845, 477.426749522438, 845.3690043996123, 556.2520410822797, 644.4173238902754, 975.7927733347462, 606.7976480106305, 712.6185498869817, 793.6577375521815, 672.3602817090405, 396.5283401007531, 645.8161941992258, 660.2177761138632, 593.900966235423, 568.5135075297578, 747.9650780144343, 639.9942208495679, 553.8913990636188, 493.0938470773756, 616.376435691086, 608.5489182583168, 425.9873916513158, 350.11056110842236, 521.1672972746399, 369.94915477462695, 585.3212174177578, 760.9779052264091, 112.86604316587344, 42.855732709799845, 490.0107835852273, 91.91367280703724, 426.6095854523822, 316.5638020475414, 454.24963335608305, 473.4863816669225, 321.6887056975334, 875.8707211078444, 593.5063208529303, 385.58831974082335, 481.0980176681908, 528.189432589828, 591.7479925429926, 477.56276852773595, 607.1297203481353, 478.29586690361214, 300.51549624026427, 620.68290315444, 595.0790693315664, 308.9643380164041, 426.35328796102914, 563.6609402892745, 816.1566730006596, 445.1827705970485, 587.5869609819395, 756.5881769088876, 480.9236006226976, 267.2909295471549, 541.3760027196771, 464.9894031311192, 70.39473362341666, 27.90431145866343, 629.5547143116918, 800.7705147035595, 763.4452831825741, 551.052305923268, 503.763139382659, 516.1639382999793, 553.9440458709996, 383.28709293588565]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.947492781040981, "mean_inference_ms": 4.398477305713644, "mean_action_processing_ms": 1.6508586262029885, "mean_env_wait_ms": 12.522115620386677, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004911661148071289, "StateBufferConnector_ms": 0.0052013397216796875, "ViewRequirementAgentConnector_ms": 0.14751720428466797}, "num_episodes": 7, "episode_return_max": 908.5658341687821, "episode_return_min": -25.485869173930343, "episode_return_mean": 229.15569050996078, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.43805548041522, "num_env_steps_trained_throughput_per_sec": 155.43805548041522, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 25920.427, "restore_workers_time_ms": 0.052, "training_step_time_ms": 25919.984, "sample_time_ms": 2403.793, "learn_time_ms": 23487.151, "learn_throughput": 170.306, "synch_weights_time_ms": 22.607}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 80, "trial_id": "0b608_00000", "date": "2024-08-22_14-19-41", "timestamp": 1724316581, "time_this_iter_s": 25.774451971054077, "time_total_s": 2073.458169698715, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a3b8b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2073.458169698715, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 32.12702702702702, "ram_util_percent": 83.06486486486487}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.209096144872998, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 6.984920565287272, "policy_loss": -0.01117416605373066, "vf_loss": 6.995270201264235, "vf_explained_var": 0.2354566362799791, "kl": 0.00824527886977035, "entropy": 0.3715374835269161, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76073.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 38.07908235882956, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.12061093345521, "policy_loss": -0.010673917589521912, "vf_loss": 7.129476640085695, "vf_explained_var": 0.4808980244808096, "kl": 0.009041058905816898, "entropy": 0.5852204507620877, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76073.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 908.5658341687821, "episode_reward_min": -59.355539261638405, "episode_reward_mean": 237.1975356480984, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -975.6556044289956, "predator_policy": 13.427993234048339}, "policy_reward_max": {"prey_policy": 387.55574381085427, "predator_policy": 975.7927733347462}, "policy_reward_mean": {"prey_policy": -418.52771380079184, "predator_policy": 537.1264816248414}, "custom_metrics": {}, "hist_stats": {"episode_reward": [79.34906596823126, 8.140331935407776, 15.299999999999976, 319.4255118748112, 8.899999999999979, 149.81755284077673, 197.00669132037527, 5.591044010978802, 92.86944333076819, 23.700000000000088, 502.7270691403733, 699.4810662029023, 31.755001552520362, 16.743010095487524, 175.61089660576906, -25.485869173930343, 64.06047932150237, 37.09999999999999, 373.6642846593616, 261.6789432634274, 24.900000000000006, 250.78204820065565, 28.000000000000142, 0.7000000000000046, 598.0064012087877, 544.1969041835579, 455.9968385725917, 248.1468033896551, 472.1466334639948, 908.5658341687821, 357.09408255248553, 499.9438325127116, 422.66936888226843, 530.7721059598886, 396.6833501103423, 0.28044944472567324, 434.2320674246923, 133.39718112288242, 388.85399874947126, 17.070886094768547, 364.04120824798883, 95.179747914828, 31.43914128402276, 29.596990180730053, 516.6423499339288, 66.32262190592452, 361.1354748193234, 264.5492166891976, 369.8346721231744, 267.0870940849436, 6.157911493714837, 16.91252527779776, 865.227595050954, 12.26320845290659, 381.12120084559155, 342.2804659704815, 542.2222732620157, 108.64098758878792, 17.667595630429666, 85.77700944070408, 80.53802571551024, 205.5819011616503, 215.26683467917675, 606.6002057572456, 69.10000000000036, 44.11132727611512, 10.369000420553226, 179.64681100052314, 56.16773097192949, 66.17022625710982, 123.91492639942084, 221.32860807976363, 840.8174665572095, 31.03365222390934, 60.62913747514318, 386.82420878105495, 545.8975089296754, 219.80723289942912, 109.833300855867, 600.1862330898695, 442.7374469405456, -5.154924194328297, 501.0498905007937, 301.17427877241374, 388.93730072913155, 362.46399707234724, 124.467056271741, 320.25486808234746, -59.355539261638405, 339.73856467983524, 119.73952983087403, 186.37721678802262, 3.525905533251142, 307.2119909729557, 35.90000000000025, 429.4287922394224, 189.4367359872972, 149.73245712531167, 269.7483124050152, 144.54274661487418], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-369.07874245306357, -643.6168689807699, -662.1216738953652, -656.0218890406741, -412.55326860916193, -584.6589464799764, -736.4964697089653, -63.96812982034456, -678.0900590319147, -380.7030101150849, -848.2165645484681, -403.2882562399033, -825.8863457203915, -127.79192428437202, -726.9373291940125, -597.990044901338, -421.6733466067216, -967.4893892951532, -307.2552041929435, -729.4638875200496, -702.2269514528169, 153.7837067951988, 220.72221340353286, -734.693223811062, -573.6771179959738, -217.98130170459842, -635.3010698023552, -918.7104464855441, -770.1838606754701, -528.6026495284738, -716.653228317292, -243.15838737220457, -493.1547141386317, -421.2918328642092, -667.1902337493167, -281.72591258203636, -298.54432450206605, -524.9838005019566, -432.5728506423836, -178.4306446710287, -340.9684181952704, -559.5623349819705, -688.5343167753274, -294.9426062846554, -217.64620161372676, -673.8854366349709, -704.1183107835213, -658.9397656855499, -931.9306980683697, 208.96129299964545, -159.43494564770393, -641.8030775598421, -65.76669252808388, -707.6784145335636, -119.96060217672508, -638.3974127022424, 32.9370553386422, -419.41825476230105, 279.5521288522981, -816.3334423579383, -613.5519977992356, 73.82138065943572, -732.1386545728542, 188.8882957673383, 40.0000000000003, -808.3804249704394, -297.07146261195595, 252.45019862041573, 28.235794092487033, -720.7389490269162, -735.3582869686545, -781.8490730750374, 222.37539108079812, -110.81850602725552, -510.9345838957821, -575.8053517259813, -216.13229772907988, -541.903985025584, -750.4514496253798, -532.7871327635928, -730.2148553003314, 100.9377303955404, -256.67267753064215, -603.1860056179968, -662.8100500028229, -578.8195824942842, -350.7498666072824, -644.6498484502902, 35.485149972818746, -624.0135806673269, -571.1388517021954, -403.28035508815765, -682.885203850724, 6.030913762449217, 8.755643053298552, -652.864229860671, -272.572322549207, -715.6705874115648, 188.84061534143126, -540.4439046813325, -874.951660676166, -741.8388951307883, -464.81422424463756, -841.0690043996119, -679.9189583748994, 344.4771884532982, -975.6556044289956, -594.6716084634729, -324.44940526165055, -800.7056813319167, -419.5625347977425, -307.04562104157105, -717.3865941179364, -46.425102933134724, -442.3990305999482, -611.3744555764406, -746.2650780144339, -624.0266252191383, -672.1712134909671, -289.03702320931865, -514.3313128245816, -630.0560154093112, -598.292883781619, 27.776832183535795, -216.29274501086985, -459.5568723592181, -622.41520636611, -117.2837105208175, -16.786545254058503, -69.83523062161593, -219.92457652247086, -317.8885525936786, -522.221842017172, -210.5825450622014, -458.7582996272031, -289.3309043952778, -265.6209747256004, -875.7707211078443, -434.5082046602713, -478.4162096763683, -246.74285612918246, -638.6296677294139, -610.2620581496742, -237.72009484128978, -632.1638645053928, 387.55574381085427, -280.0818440163538, -610.0829031544397, -496.7932641108409, -346.6210057619862, -31.706529015637464, -571.4834904536136, -886.3393030240085, 170.89736835597756, -333.38690983425187, -790.9809951571427, -65.49432499444328, -572.8869043195417, -628.2804401453834, 222.101267384457, 381.63221038310354, -37.193808524640936, -636.1827159880723, -799.2974372215065, -784.0294600506329, -29.418238554420128, -499.3524058582564, -219.40039305197254, -542.6684818851738, -5.625356192583315, -832.4308690319536, 186.99696252660695, -25.509701947187303, 35.39927197693339, -496.84054933607325, -32.79195170795579, -221.06936739269383, -642.0152834644357, -469.97987251178324, -164.8930037469667, -755.553120486779, -608.5153680287525, -255.983144131099, 52.083181055592846, -813.7046333895744, -546.5744969081156, 14.220097833235142, -843.2281567666264, -375.6900983999038, -272.791122343372, -112.34577492087777, -830.6334145022092, -279.44645454578523, -812.4581668349537, -346.8950951645421, -547.6586699364781, -49.2910519433719, -631.4370529026263, -479.21653078953966, -759.4421062442931], "policy_predator_policy_reward": [517.0392681614949, 575.0054092405704, 674.2879252130833, 651.9959696583645, 423.9532686091642, 588.5589464799765, 501.82657151262435, 618.0635398914978, 682.7900590319158, 384.90301011508643, 847.068205057228, 554.2541685719191, 823.1563935195654, 327.52856780557164, 714.0374309128104, 616.4809871935219, 814.5133937543524, 667.5187854782902, 324.7552041929437, 735.6638875200497, 686.8507310899383, 364.3195827080508, 592.8334673605407, 620.618609249892, 325.13467027744196, 498.27875097565146, 651.6726839444823, 919.0818424389046, 758.7187269594118, 715.6786798503073, 734.2832839119874, 200.04246260357806, 559.5117761118765, 418.99525021246757, 669.1902337493171, 316.8259125820356, 557.8256305780997, 639.3667790852844, 408.7211445167969, 463.96129406004127, 358.4684181952702, 566.9623349819709, 652.4696498417139, 581.7893214189287, 241.5462016137254, 677.9854366349718, 704.8183107835215, 658.9397656855499, 857.0142012214611, 463.9616050560477, 668.5181510130732, 676.9167763780265, 538.8133762083639, 690.6285694258726, 384.1268676839044, 622.3779505847186, 374.19615655428487, 484.4316763333639, 724.4865440685295, 720.8606036058915, 504.34858714858024, 392.47611254370673, 536.2746546466683, 506.91953667155485, 502.6060139618643, 688.4437798908416, 195.93904757492936, 379.4543223764951, 423.5456322181538, 665.6408728266141, 735.7008028540581, 781.7870066343595, 16.25, 306.4251823711513, 680.758540560894, 539.3785761837518, 352.8837453602544, 794.0065361438853, 751.3932578849096, 548.9162105988313, 580.9323087667276, 412.38602438605585, 348.6524254454733, 606.3860056179966, 738.751364216175, 534.3174095649564, 522.6264683825442, 502.37023685575804, 490.019603873109, 615.1511767553309, 546.9993501141048, 493.7424785821754, 671.710507700891, 366.27925720670714, 230.45294501071106, 678.2048584858601, 676.7444686654363, 681.3331134185091, 492.2801289420833, 126.4102544827621, 881.1367697870845, 741.8116975135845, 477.426749522438, 845.3690043996123, 556.2520410822797, 644.4173238902754, 975.7927733347462, 606.7976480106305, 712.6185498869817, 793.6577375521815, 672.3602817090405, 396.5283401007531, 645.8161941992258, 660.2177761138632, 593.900966235423, 568.5135075297578, 747.9650780144343, 639.9942208495679, 553.8913990636188, 493.0938470773756, 616.376435691086, 608.5489182583168, 425.9873916513158, 350.11056110842236, 521.1672972746399, 369.94915477462695, 585.3212174177578, 760.9779052264091, 112.86604316587344, 42.855732709799845, 490.0107835852273, 91.91367280703724, 426.6095854523822, 316.5638020475414, 454.24963335608305, 473.4863816669225, 321.6887056975334, 875.8707211078444, 593.5063208529303, 385.58831974082335, 481.0980176681908, 528.189432589828, 591.7479925429926, 477.56276852773595, 607.1297203481353, 478.29586690361214, 300.51549624026427, 620.68290315444, 595.0790693315664, 308.9643380164041, 426.35328796102914, 563.6609402892745, 816.1566730006596, 445.1827705970485, 587.5869609819395, 756.5881769088876, 480.9236006226976, 267.2909295471549, 541.3760027196771, 464.9894031311192, 70.39473362341666, 27.90431145866343, 629.5547143116918, 800.7705147035595, 763.4452831825741, 551.052305923268, 503.763139382659, 516.1639382999793, 553.9440458709996, 383.28709293588565, 420.6207980118912, 587.2771055658047, 60.11610775947025, 54.46137848252865, 458.7690946140422, 391.1182745123347, 180.66974382705268, 623.0593677684382, 371.00967403708796, 603.6017669014984, 826.6529951605391, 657.1550231858672, 376.8491866294866, 13.427993234048339, 601.5675582782052, 762.2374775527402, 454.73368141943445, 681.4863684869113, 394.6900983999081, 289.6911223433744, 565.4953826643606, 806.9125989981476, 468.97943532150987, 812.3619220465282, 496.6096712805812, 547.6765509457547, 354.14325037920383, 596.3331668718084, 658.2954070906278, 724.9059765580788]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.943945263193071, "mean_inference_ms": 4.404453471541437, "mean_action_processing_ms": 1.653485676817808, "mean_env_wait_ms": 12.533846382081778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004845738410949707, "StateBufferConnector_ms": 0.005261898040771484, "ViewRequirementAgentConnector_ms": 0.14651107788085938}, "num_episodes": 15, "episode_return_max": 908.5658341687821, "episode_return_min": -59.355539261638405, "episode_return_mean": 237.1975356480984, "episodes_this_iter": 15}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.0196868885057, "num_env_steps_trained_throughput_per_sec": 156.0196868885057, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 25911.135, "restore_workers_time_ms": 0.052, "training_step_time_ms": 25910.716, "sample_time_ms": 2444.364, "learn_time_ms": 23437.645, "learn_throughput": 170.666, "synch_weights_time_ms": 22.572}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 81, "trial_id": "0b608_00000", "date": "2024-08-22_14-20-07", "timestamp": 1724316607, "time_this_iter_s": 25.67880415916443, "time_total_s": 2099.1369738578796, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30e474c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2099.1369738578796, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 33.222222222222214, "ram_util_percent": 83.19444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.75558030567472, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 6.978528635842459, "policy_loss": -0.009675831516721734, "vf_loss": 6.987444878129101, "vf_explained_var": 0.33553562996879455, "kl": 0.007595763515641608, "entropy": 0.36233380613503635, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 77018.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 38.324670705593455, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.04430142104941, "policy_loss": -0.009095550518206976, "vf_loss": 7.051507407395297, "vf_explained_var": 0.4765004347871851, "kl": 0.009447721945782188, "entropy": 0.5617296412823692, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 77018.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "env_runners": {"episode_reward_max": 908.5658341687821, "episode_reward_min": -59.355539261638405, "episode_reward_mean": 237.487572155646, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -975.6556044289956, "predator_policy": 13.427993234048339}, "policy_reward_max": {"prey_policy": 387.55574381085427, "predator_policy": 975.7927733347462}, "policy_reward_mean": {"prey_policy": -410.45888499260684, "predator_policy": 529.2026710704301}, "custom_metrics": {}, "hist_stats": {"episode_reward": [319.4255118748112, 8.899999999999979, 149.81755284077673, 197.00669132037527, 5.591044010978802, 92.86944333076819, 23.700000000000088, 502.7270691403733, 699.4810662029023, 31.755001552520362, 16.743010095487524, 175.61089660576906, -25.485869173930343, 64.06047932150237, 37.09999999999999, 373.6642846593616, 261.6789432634274, 24.900000000000006, 250.78204820065565, 28.000000000000142, 0.7000000000000046, 598.0064012087877, 544.1969041835579, 455.9968385725917, 248.1468033896551, 472.1466334639948, 908.5658341687821, 357.09408255248553, 499.9438325127116, 422.66936888226843, 530.7721059598886, 396.6833501103423, 0.28044944472567324, 434.2320674246923, 133.39718112288242, 388.85399874947126, 17.070886094768547, 364.04120824798883, 95.179747914828, 31.43914128402276, 29.596990180730053, 516.6423499339288, 66.32262190592452, 361.1354748193234, 264.5492166891976, 369.8346721231744, 267.0870940849436, 6.157911493714837, 16.91252527779776, 865.227595050954, 12.26320845290659, 381.12120084559155, 342.2804659704815, 542.2222732620157, 108.64098758878792, 17.667595630429666, 85.77700944070408, 80.53802571551024, 205.5819011616503, 215.26683467917675, 606.6002057572456, 69.10000000000036, 44.11132727611512, 10.369000420553226, 179.64681100052314, 56.16773097192949, 66.17022625710982, 123.91492639942084, 221.32860807976363, 840.8174665572095, 31.03365222390934, 60.62913747514318, 386.82420878105495, 545.8975089296754, 219.80723289942912, 109.833300855867, 600.1862330898695, 442.7374469405456, -5.154924194328297, 501.0498905007937, 301.17427877241374, 388.93730072913155, 362.46399707234724, 124.467056271741, 320.25486808234746, -59.355539261638405, 339.73856467983524, 119.73952983087403, 186.37721678802262, 3.525905533251142, 307.2119909729557, 35.90000000000025, 429.4287922394224, 189.4367359872972, 149.73245712531167, 269.7483124050152, 144.54274661487418, 35.2663095505894, -49.52162595018278, 146.04836505799005], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-736.4964697089653, -63.96812982034456, -678.0900590319147, -380.7030101150849, -848.2165645484681, -403.2882562399033, -825.8863457203915, -127.79192428437202, -726.9373291940125, -597.990044901338, -421.6733466067216, -967.4893892951532, -307.2552041929435, -729.4638875200496, -702.2269514528169, 153.7837067951988, 220.72221340353286, -734.693223811062, -573.6771179959738, -217.98130170459842, -635.3010698023552, -918.7104464855441, -770.1838606754701, -528.6026495284738, -716.653228317292, -243.15838737220457, -493.1547141386317, -421.2918328642092, -667.1902337493167, -281.72591258203636, -298.54432450206605, -524.9838005019566, -432.5728506423836, -178.4306446710287, -340.9684181952704, -559.5623349819705, -688.5343167753274, -294.9426062846554, -217.64620161372676, -673.8854366349709, -704.1183107835213, -658.9397656855499, -931.9306980683697, 208.96129299964545, -159.43494564770393, -641.8030775598421, -65.76669252808388, -707.6784145335636, -119.96060217672508, -638.3974127022424, 32.9370553386422, -419.41825476230105, 279.5521288522981, -816.3334423579383, -613.5519977992356, 73.82138065943572, -732.1386545728542, 188.8882957673383, 40.0000000000003, -808.3804249704394, -297.07146261195595, 252.45019862041573, 28.235794092487033, -720.7389490269162, -735.3582869686545, -781.8490730750374, 222.37539108079812, -110.81850602725552, -510.9345838957821, -575.8053517259813, -216.13229772907988, -541.903985025584, -750.4514496253798, -532.7871327635928, -730.2148553003314, 100.9377303955404, -256.67267753064215, -603.1860056179968, -662.8100500028229, -578.8195824942842, -350.7498666072824, -644.6498484502902, 35.485149972818746, -624.0135806673269, -571.1388517021954, -403.28035508815765, -682.885203850724, 6.030913762449217, 8.755643053298552, -652.864229860671, -272.572322549207, -715.6705874115648, 188.84061534143126, -540.4439046813325, -874.951660676166, -741.8388951307883, -464.81422424463756, -841.0690043996119, -679.9189583748994, 344.4771884532982, -975.6556044289956, -594.6716084634729, -324.44940526165055, -800.7056813319167, -419.5625347977425, -307.04562104157105, -717.3865941179364, -46.425102933134724, -442.3990305999482, -611.3744555764406, -746.2650780144339, -624.0266252191383, -672.1712134909671, -289.03702320931865, -514.3313128245816, -630.0560154093112, -598.292883781619, 27.776832183535795, -216.29274501086985, -459.5568723592181, -622.41520636611, -117.2837105208175, -16.786545254058503, -69.83523062161593, -219.92457652247086, -317.8885525936786, -522.221842017172, -210.5825450622014, -458.7582996272031, -289.3309043952778, -265.6209747256004, -875.7707211078443, -434.5082046602713, -478.4162096763683, -246.74285612918246, -638.6296677294139, -610.2620581496742, -237.72009484128978, -632.1638645053928, 387.55574381085427, -280.0818440163538, -610.0829031544397, -496.7932641108409, -346.6210057619862, -31.706529015637464, -571.4834904536136, -886.3393030240085, 170.89736835597756, -333.38690983425187, -790.9809951571427, -65.49432499444328, -572.8869043195417, -628.2804401453834, 222.101267384457, 381.63221038310354, -37.193808524640936, -636.1827159880723, -799.2974372215065, -784.0294600506329, -29.418238554420128, -499.3524058582564, -219.40039305197254, -542.6684818851738, -5.625356192583315, -832.4308690319536, 186.99696252660695, -25.509701947187303, 35.39927197693339, -496.84054933607325, -32.79195170795579, -221.06936739269383, -642.0152834644357, -469.97987251178324, -164.8930037469667, -755.553120486779, -608.5153680287525, -255.983144131099, 52.083181055592846, -813.7046333895744, -546.5744969081156, 14.220097833235142, -843.2281567666264, -375.6900983999038, -272.791122343372, -112.34577492087777, -830.6334145022092, -279.44645454578523, -812.4581668349537, -346.8950951645421, -547.6586699364781, -49.2910519433719, -631.4370529026263, -479.21653078953966, -759.4421062442931, -454.14919588601157, -190.32867918366344, -443.71073980050517, -248.64360559037007, -271.9967900995919, -105.4566172618689], "policy_predator_policy_reward": [501.82657151262435, 618.0635398914978, 682.7900590319158, 384.90301011508643, 847.068205057228, 554.2541685719191, 823.1563935195654, 327.52856780557164, 714.0374309128104, 616.4809871935219, 814.5133937543524, 667.5187854782902, 324.7552041929437, 735.6638875200497, 686.8507310899383, 364.3195827080508, 592.8334673605407, 620.618609249892, 325.13467027744196, 498.27875097565146, 651.6726839444823, 919.0818424389046, 758.7187269594118, 715.6786798503073, 734.2832839119874, 200.04246260357806, 559.5117761118765, 418.99525021246757, 669.1902337493171, 316.8259125820356, 557.8256305780997, 639.3667790852844, 408.7211445167969, 463.96129406004127, 358.4684181952702, 566.9623349819709, 652.4696498417139, 581.7893214189287, 241.5462016137254, 677.9854366349718, 704.8183107835215, 658.9397656855499, 857.0142012214611, 463.9616050560477, 668.5181510130732, 676.9167763780265, 538.8133762083639, 690.6285694258726, 384.1268676839044, 622.3779505847186, 374.19615655428487, 484.4316763333639, 724.4865440685295, 720.8606036058915, 504.34858714858024, 392.47611254370673, 536.2746546466683, 506.91953667155485, 502.6060139618643, 688.4437798908416, 195.93904757492936, 379.4543223764951, 423.5456322181538, 665.6408728266141, 735.7008028540581, 781.7870066343595, 16.25, 306.4251823711513, 680.758540560894, 539.3785761837518, 352.8837453602544, 794.0065361438853, 751.3932578849096, 548.9162105988313, 580.9323087667276, 412.38602438605585, 348.6524254454733, 606.3860056179966, 738.751364216175, 534.3174095649564, 522.6264683825442, 502.37023685575804, 490.019603873109, 615.1511767553309, 546.9993501141048, 493.7424785821754, 671.710507700891, 366.27925720670714, 230.45294501071106, 678.2048584858601, 676.7444686654363, 681.3331134185091, 492.2801289420833, 126.4102544827621, 881.1367697870845, 741.8116975135845, 477.426749522438, 845.3690043996123, 556.2520410822797, 644.4173238902754, 975.7927733347462, 606.7976480106305, 712.6185498869817, 793.6577375521815, 672.3602817090405, 396.5283401007531, 645.8161941992258, 660.2177761138632, 593.900966235423, 568.5135075297578, 747.9650780144343, 639.9942208495679, 553.8913990636188, 493.0938470773756, 616.376435691086, 608.5489182583168, 425.9873916513158, 350.11056110842236, 521.1672972746399, 369.94915477462695, 585.3212174177578, 760.9779052264091, 112.86604316587344, 42.855732709799845, 490.0107835852273, 91.91367280703724, 426.6095854523822, 316.5638020475414, 454.24963335608305, 473.4863816669225, 321.6887056975334, 875.8707211078444, 593.5063208529303, 385.58831974082335, 481.0980176681908, 528.189432589828, 591.7479925429926, 477.56276852773595, 607.1297203481353, 478.29586690361214, 300.51549624026427, 620.68290315444, 595.0790693315664, 308.9643380164041, 426.35328796102914, 563.6609402892745, 816.1566730006596, 445.1827705970485, 587.5869609819395, 756.5881769088876, 480.9236006226976, 267.2909295471549, 541.3760027196771, 464.9894031311192, 70.39473362341666, 27.90431145866343, 629.5547143116918, 800.7705147035595, 763.4452831825741, 551.052305923268, 503.763139382659, 516.1639382999793, 553.9440458709996, 383.28709293588565, 420.6207980118912, 587.2771055658047, 60.11610775947025, 54.46137848252865, 458.7690946140422, 391.1182745123347, 180.66974382705268, 623.0593677684382, 371.00967403708796, 603.6017669014984, 826.6529951605391, 657.1550231858672, 376.8491866294866, 13.427993234048339, 601.5675582782052, 762.2374775527402, 454.73368141943445, 681.4863684869113, 394.6900983999081, 289.6911223433744, 565.4953826643606, 806.9125989981476, 468.97943532150987, 812.3619220465282, 496.6096712805812, 547.6765509457547, 354.14325037920383, 596.3331668718084, 658.2954070906278, 724.9059765580788, 469.4974134075501, 210.24677121271554, 166.6903687178999, 476.14235072279223, 295.0290231466312, 228.47274927282606]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.947858004912176, "mean_inference_ms": 4.404691573626027, "mean_action_processing_ms": 1.647354280439025, "mean_env_wait_ms": 12.53925628876071, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046350955963134766, "StateBufferConnector_ms": 0.005254268646240234, "ViewRequirementAgentConnector_ms": 0.14628374576568604}, "num_episodes": 3, "episode_return_max": 908.5658341687821, "episode_return_min": -59.355539261638405, "episode_return_mean": 237.487572155646, "episodes_this_iter": 3}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 157.48889577712063, "num_env_steps_trained_throughput_per_sec": 157.48889577712063, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 1312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1312000, "timers": {"training_iteration_time_ms": 25812.558, "restore_workers_time_ms": 0.051, "training_step_time_ms": 25812.123, "sample_time_ms": 2417.691, "learn_time_ms": 23364.875, "learn_throughput": 171.197, "synch_weights_time_ms": 23.608}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "done": false, "training_iteration": 82, "trial_id": "0b608_00000", "date": "2024-08-22_14-20-32", "timestamp": 1724316632, "time_this_iter_s": 25.441873788833618, "time_total_s": 2124.5788476467133, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a38dee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2124.5788476467133, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 32.96111111111111, "ram_util_percent": 82.725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.259321744605977, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.003504265174664, "policy_loss": -0.008051793443817625, "vf_loss": 7.0108369857545885, "vf_explained_var": 0.12317329222563082, "kl": 0.007190763525832346, "entropy": 0.3230914849137503, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 77963.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 56.28459105567327, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.861399993190059, "policy_loss": -0.007841391479054455, "vf_loss": 6.867312662437479, "vf_explained_var": 0.558038640211499, "kl": 0.00964351280040487, "entropy": 0.5605052507743633, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 77963.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "env_runners": {"episode_reward_max": 908.5658341687821, "episode_reward_min": -59.355539261638405, "episode_reward_mean": 242.3215619734848, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -975.6556044289956, "predator_policy": 13.427993234048339}, "policy_reward_max": {"prey_policy": 387.55574381085427, "predator_policy": 975.7927733347462}, "policy_reward_mean": {"prey_policy": -395.49000448799023, "predator_policy": 516.6507854747329}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.743010095487524, 175.61089660576906, -25.485869173930343, 64.06047932150237, 37.09999999999999, 373.6642846593616, 261.6789432634274, 24.900000000000006, 250.78204820065565, 28.000000000000142, 0.7000000000000046, 598.0064012087877, 544.1969041835579, 455.9968385725917, 248.1468033896551, 472.1466334639948, 908.5658341687821, 357.09408255248553, 499.9438325127116, 422.66936888226843, 530.7721059598886, 396.6833501103423, 0.28044944472567324, 434.2320674246923, 133.39718112288242, 388.85399874947126, 17.070886094768547, 364.04120824798883, 95.179747914828, 31.43914128402276, 29.596990180730053, 516.6423499339288, 66.32262190592452, 361.1354748193234, 264.5492166891976, 369.8346721231744, 267.0870940849436, 6.157911493714837, 16.91252527779776, 865.227595050954, 12.26320845290659, 381.12120084559155, 342.2804659704815, 542.2222732620157, 108.64098758878792, 17.667595630429666, 85.77700944070408, 80.53802571551024, 205.5819011616503, 215.26683467917675, 606.6002057572456, 69.10000000000036, 44.11132727611512, 10.369000420553226, 179.64681100052314, 56.16773097192949, 66.17022625710982, 123.91492639942084, 221.32860807976363, 840.8174665572095, 31.03365222390934, 60.62913747514318, 386.82420878105495, 545.8975089296754, 219.80723289942912, 109.833300855867, 600.1862330898695, 442.7374469405456, -5.154924194328297, 501.0498905007937, 301.17427877241374, 388.93730072913155, 362.46399707234724, 124.467056271741, 320.25486808234746, -59.355539261638405, 339.73856467983524, 119.73952983087403, 186.37721678802262, 3.525905533251142, 307.2119909729557, 35.90000000000025, 429.4287922394224, 189.4367359872972, 149.73245712531167, 269.7483124050152, 144.54274661487418, 35.2663095505894, -49.52162595018278, 146.04836505799005, 702.3018772748302, 222.90695297947642, 330.6478877230726, 729.6506314863428, 324.3944388033403, 29.564410779054306, -17.002253791243383, 125.24179577706687, 93.77879647472116, -26.812175449274193], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-635.3010698023552, -918.7104464855441, -770.1838606754701, -528.6026495284738, -716.653228317292, -243.15838737220457, -493.1547141386317, -421.2918328642092, -667.1902337493167, -281.72591258203636, -298.54432450206605, -524.9838005019566, -432.5728506423836, -178.4306446710287, -340.9684181952704, -559.5623349819705, -688.5343167753274, -294.9426062846554, -217.64620161372676, -673.8854366349709, -704.1183107835213, -658.9397656855499, -931.9306980683697, 208.96129299964545, -159.43494564770393, -641.8030775598421, -65.76669252808388, -707.6784145335636, -119.96060217672508, -638.3974127022424, 32.9370553386422, -419.41825476230105, 279.5521288522981, -816.3334423579383, -613.5519977992356, 73.82138065943572, -732.1386545728542, 188.8882957673383, 40.0000000000003, -808.3804249704394, -297.07146261195595, 252.45019862041573, 28.235794092487033, -720.7389490269162, -735.3582869686545, -781.8490730750374, 222.37539108079812, -110.81850602725552, -510.9345838957821, -575.8053517259813, -216.13229772907988, -541.903985025584, -750.4514496253798, -532.7871327635928, -730.2148553003314, 100.9377303955404, -256.67267753064215, -603.1860056179968, -662.8100500028229, -578.8195824942842, -350.7498666072824, -644.6498484502902, 35.485149972818746, -624.0135806673269, -571.1388517021954, -403.28035508815765, -682.885203850724, 6.030913762449217, 8.755643053298552, -652.864229860671, -272.572322549207, -715.6705874115648, 188.84061534143126, -540.4439046813325, -874.951660676166, -741.8388951307883, -464.81422424463756, -841.0690043996119, -679.9189583748994, 344.4771884532982, -975.6556044289956, -594.6716084634729, -324.44940526165055, -800.7056813319167, -419.5625347977425, -307.04562104157105, -717.3865941179364, -46.425102933134724, -442.3990305999482, -611.3744555764406, -746.2650780144339, -624.0266252191383, -672.1712134909671, -289.03702320931865, -514.3313128245816, -630.0560154093112, -598.292883781619, 27.776832183535795, -216.29274501086985, -459.5568723592181, -622.41520636611, -117.2837105208175, -16.786545254058503, -69.83523062161593, -219.92457652247086, -317.8885525936786, -522.221842017172, -210.5825450622014, -458.7582996272031, -289.3309043952778, -265.6209747256004, -875.7707211078443, -434.5082046602713, -478.4162096763683, -246.74285612918246, -638.6296677294139, -610.2620581496742, -237.72009484128978, -632.1638645053928, 387.55574381085427, -280.0818440163538, -610.0829031544397, -496.7932641108409, -346.6210057619862, -31.706529015637464, -571.4834904536136, -886.3393030240085, 170.89736835597756, -333.38690983425187, -790.9809951571427, -65.49432499444328, -572.8869043195417, -628.2804401453834, 222.101267384457, 381.63221038310354, -37.193808524640936, -636.1827159880723, -799.2974372215065, -784.0294600506329, -29.418238554420128, -499.3524058582564, -219.40039305197254, -542.6684818851738, -5.625356192583315, -832.4308690319536, 186.99696252660695, -25.509701947187303, 35.39927197693339, -496.84054933607325, -32.79195170795579, -221.06936739269383, -642.0152834644357, -469.97987251178324, -164.8930037469667, -755.553120486779, -608.5153680287525, -255.983144131099, 52.083181055592846, -813.7046333895744, -546.5744969081156, 14.220097833235142, -843.2281567666264, -375.6900983999038, -272.791122343372, -112.34577492087777, -830.6334145022092, -279.44645454578523, -812.4581668349537, -346.8950951645421, -547.6586699364781, -49.2910519433719, -631.4370529026263, -479.21653078953966, -759.4421062442931, -454.14919588601157, -190.32867918366344, -443.71073980050517, -248.64360559037007, -271.9967900995919, -105.4566172618689, 302.07598953474087, -689.12161522158, -400.15736553143194, -80.49002953318119, -112.74869169852307, -779.5372600481094, -701.6803178265407, 280.16808257869235, -170.76033943333866, -43.27215612425678, -502.09592876217835, -515.0504154664231, -472.4703173583879, -413.76387660857984, -116.78266453184388, -348.54087263670027, -657.8367350013181, -535.0360643246925, -474.16850958229935, -244.2774474461081], "policy_predator_policy_reward": [651.6726839444823, 919.0818424389046, 758.7187269594118, 715.6786798503073, 734.2832839119874, 200.04246260357806, 559.5117761118765, 418.99525021246757, 669.1902337493171, 316.8259125820356, 557.8256305780997, 639.3667790852844, 408.7211445167969, 463.96129406004127, 358.4684181952702, 566.9623349819709, 652.4696498417139, 581.7893214189287, 241.5462016137254, 677.9854366349718, 704.8183107835215, 658.9397656855499, 857.0142012214611, 463.9616050560477, 668.5181510130732, 676.9167763780265, 538.8133762083639, 690.6285694258726, 384.1268676839044, 622.3779505847186, 374.19615655428487, 484.4316763333639, 724.4865440685295, 720.8606036058915, 504.34858714858024, 392.47611254370673, 536.2746546466683, 506.91953667155485, 502.6060139618643, 688.4437798908416, 195.93904757492936, 379.4543223764951, 423.5456322181538, 665.6408728266141, 735.7008028540581, 781.7870066343595, 16.25, 306.4251823711513, 680.758540560894, 539.3785761837518, 352.8837453602544, 794.0065361438853, 751.3932578849096, 548.9162105988313, 580.9323087667276, 412.38602438605585, 348.6524254454733, 606.3860056179966, 738.751364216175, 534.3174095649564, 522.6264683825442, 502.37023685575804, 490.019603873109, 615.1511767553309, 546.9993501141048, 493.7424785821754, 671.710507700891, 366.27925720670714, 230.45294501071106, 678.2048584858601, 676.7444686654363, 681.3331134185091, 492.2801289420833, 126.4102544827621, 881.1367697870845, 741.8116975135845, 477.426749522438, 845.3690043996123, 556.2520410822797, 644.4173238902754, 975.7927733347462, 606.7976480106305, 712.6185498869817, 793.6577375521815, 672.3602817090405, 396.5283401007531, 645.8161941992258, 660.2177761138632, 593.900966235423, 568.5135075297578, 747.9650780144343, 639.9942208495679, 553.8913990636188, 493.0938470773756, 616.376435691086, 608.5489182583168, 425.9873916513158, 350.11056110842236, 521.1672972746399, 369.94915477462695, 585.3212174177578, 760.9779052264091, 112.86604316587344, 42.855732709799845, 490.0107835852273, 91.91367280703724, 426.6095854523822, 316.5638020475414, 454.24963335608305, 473.4863816669225, 321.6887056975334, 875.8707211078444, 593.5063208529303, 385.58831974082335, 481.0980176681908, 528.189432589828, 591.7479925429926, 477.56276852773595, 607.1297203481353, 478.29586690361214, 300.51549624026427, 620.68290315444, 595.0790693315664, 308.9643380164041, 426.35328796102914, 563.6609402892745, 816.1566730006596, 445.1827705970485, 587.5869609819395, 756.5881769088876, 480.9236006226976, 267.2909295471549, 541.3760027196771, 464.9894031311192, 70.39473362341666, 27.90431145866343, 629.5547143116918, 800.7705147035595, 763.4452831825741, 551.052305923268, 503.763139382659, 516.1639382999793, 553.9440458709996, 383.28709293588565, 420.6207980118912, 587.2771055658047, 60.11610775947025, 54.46137848252865, 458.7690946140422, 391.1182745123347, 180.66974382705268, 623.0593677684382, 371.00967403708796, 603.6017669014984, 826.6529951605391, 657.1550231858672, 376.8491866294866, 13.427993234048339, 601.5675582782052, 762.2374775527402, 454.73368141943445, 681.4863684869113, 394.6900983999081, 289.6911223433744, 565.4953826643606, 806.9125989981476, 468.97943532150987, 812.3619220465282, 496.6096712805812, 547.6765509457547, 354.14325037920383, 596.3331668718084, 658.2954070906278, 724.9059765580788, 469.4974134075501, 210.24677121271554, 166.6903687178999, 476.14235072279223, 295.0290231466312, 228.47274927282606, 515.0264413056611, 574.3210616560082, 493.03683837406453, 210.51750967002474, 582.9968133511019, 639.9370261186042, 630.0609338710242, 521.1019328631676, 262.57481159675564, 275.8521227641793, 501.7054844576204, 545.0052705500359, 294.42468029711694, 574.8072598786104, 194.6939120900002, 395.87142085561504, 638.8626950988522, 647.7889007018787, 307.39668753331733, 384.2370940458157]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.947299929143533, "mean_inference_ms": 4.398555606782567, "mean_action_processing_ms": 1.6536463317329158, "mean_env_wait_ms": 12.537564562239911, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004277706146240234, "StateBufferConnector_ms": 0.005173802375793457, "ViewRequirementAgentConnector_ms": 0.14063966274261475}, "num_episodes": 10, "episode_return_max": 908.5658341687821, "episode_return_min": -59.355539261638405, "episode_return_mean": 242.3215619734848, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.93773757060166, "num_env_steps_trained_throughput_per_sec": 154.93773757060166, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 1328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1328000, "timers": {"training_iteration_time_ms": 25776.805, "restore_workers_time_ms": 0.053, "training_step_time_ms": 25776.405, "sample_time_ms": 2410.858, "learn_time_ms": 23337.47, "learn_throughput": 171.398, "synch_weights_time_ms": 22.295}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "done": false, "training_iteration": 83, "trial_id": "0b608_00000", "date": "2024-08-22_14-20-58", "timestamp": 1724316658, "time_this_iter_s": 25.865392923355103, "time_total_s": 2150.4442405700684, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30e3d8ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2150.4442405700684, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 31.90555555555555, "ram_util_percent": 82.20277777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.23258475248145, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.268920421600342, "policy_loss": -0.009903126012868982, "vf_loss": 7.278154368627639, "vf_explained_var": 0.11214403412329457, "kl": 0.00669148913806393, "entropy": 0.2887051884932493, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78908.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000576}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 34.95200483382694, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.880289471338665, "policy_loss": -0.010706351789838028, "vf_loss": 6.889141028267996, "vf_explained_var": 0.562557299111886, "kl": 0.00927395336206746, "entropy": 0.5521558135274857, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78908.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000576}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 908.5658341687821, "episode_reward_min": -59.355539261638405, "episode_reward_mean": 240.51406308039392, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -975.6556044289956, "predator_policy": 13.427993234048339}, "policy_reward_max": {"prey_policy": 387.55574381085427, "predator_policy": 975.7927733347462}, "policy_reward_mean": {"prey_policy": -386.1899387525742, "predator_policy": 506.4469702927716}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.000000000000142, 0.7000000000000046, 598.0064012087877, 544.1969041835579, 455.9968385725917, 248.1468033896551, 472.1466334639948, 908.5658341687821, 357.09408255248553, 499.9438325127116, 422.66936888226843, 530.7721059598886, 396.6833501103423, 0.28044944472567324, 434.2320674246923, 133.39718112288242, 388.85399874947126, 17.070886094768547, 364.04120824798883, 95.179747914828, 31.43914128402276, 29.596990180730053, 516.6423499339288, 66.32262190592452, 361.1354748193234, 264.5492166891976, 369.8346721231744, 267.0870940849436, 6.157911493714837, 16.91252527779776, 865.227595050954, 12.26320845290659, 381.12120084559155, 342.2804659704815, 542.2222732620157, 108.64098758878792, 17.667595630429666, 85.77700944070408, 80.53802571551024, 205.5819011616503, 215.26683467917675, 606.6002057572456, 69.10000000000036, 44.11132727611512, 10.369000420553226, 179.64681100052314, 56.16773097192949, 66.17022625710982, 123.91492639942084, 221.32860807976363, 840.8174665572095, 31.03365222390934, 60.62913747514318, 386.82420878105495, 545.8975089296754, 219.80723289942912, 109.833300855867, 600.1862330898695, 442.7374469405456, -5.154924194328297, 501.0498905007937, 301.17427877241374, 388.93730072913155, 362.46399707234724, 124.467056271741, 320.25486808234746, -59.355539261638405, 339.73856467983524, 119.73952983087403, 186.37721678802262, 3.525905533251142, 307.2119909729557, 35.90000000000025, 429.4287922394224, 189.4367359872972, 149.73245712531167, 269.7483124050152, 144.54274661487418, 35.2663095505894, -49.52162595018278, 146.04836505799005, 702.3018772748302, 222.90695297947642, 330.6478877230726, 729.6506314863428, 324.3944388033403, 29.564410779054306, -17.002253791243383, 125.24179577706687, 93.77879647472116, -26.812175449274193, 3.100000000000003, 45.306779851791596, 301.09534108739734, 20.600000000000037, 244.75641282281924, 177.02956788621864, 18.767301115207356, 179.64113361405754, 8.00736728569236], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-217.64620161372676, -673.8854366349709, -704.1183107835213, -658.9397656855499, -931.9306980683697, 208.96129299964545, -159.43494564770393, -641.8030775598421, -65.76669252808388, -707.6784145335636, -119.96060217672508, -638.3974127022424, 32.9370553386422, -419.41825476230105, 279.5521288522981, -816.3334423579383, -613.5519977992356, 73.82138065943572, -732.1386545728542, 188.8882957673383, 40.0000000000003, -808.3804249704394, -297.07146261195595, 252.45019862041573, 28.235794092487033, -720.7389490269162, -735.3582869686545, -781.8490730750374, 222.37539108079812, -110.81850602725552, -510.9345838957821, -575.8053517259813, -216.13229772907988, -541.903985025584, -750.4514496253798, -532.7871327635928, -730.2148553003314, 100.9377303955404, -256.67267753064215, -603.1860056179968, -662.8100500028229, -578.8195824942842, -350.7498666072824, -644.6498484502902, 35.485149972818746, -624.0135806673269, -571.1388517021954, -403.28035508815765, -682.885203850724, 6.030913762449217, 8.755643053298552, -652.864229860671, -272.572322549207, -715.6705874115648, 188.84061534143126, -540.4439046813325, -874.951660676166, -741.8388951307883, -464.81422424463756, -841.0690043996119, -679.9189583748994, 344.4771884532982, -975.6556044289956, -594.6716084634729, -324.44940526165055, -800.7056813319167, -419.5625347977425, -307.04562104157105, -717.3865941179364, -46.425102933134724, -442.3990305999482, -611.3744555764406, -746.2650780144339, -624.0266252191383, -672.1712134909671, -289.03702320931865, -514.3313128245816, -630.0560154093112, -598.292883781619, 27.776832183535795, -216.29274501086985, -459.5568723592181, -622.41520636611, -117.2837105208175, -16.786545254058503, -69.83523062161593, -219.92457652247086, -317.8885525936786, -522.221842017172, -210.5825450622014, -458.7582996272031, -289.3309043952778, -265.6209747256004, -875.7707211078443, -434.5082046602713, -478.4162096763683, -246.74285612918246, -638.6296677294139, -610.2620581496742, -237.72009484128978, -632.1638645053928, 387.55574381085427, -280.0818440163538, -610.0829031544397, -496.7932641108409, -346.6210057619862, -31.706529015637464, -571.4834904536136, -886.3393030240085, 170.89736835597756, -333.38690983425187, -790.9809951571427, -65.49432499444328, -572.8869043195417, -628.2804401453834, 222.101267384457, 381.63221038310354, -37.193808524640936, -636.1827159880723, -799.2974372215065, -784.0294600506329, -29.418238554420128, -499.3524058582564, -219.40039305197254, -542.6684818851738, -5.625356192583315, -832.4308690319536, 186.99696252660695, -25.509701947187303, 35.39927197693339, -496.84054933607325, -32.79195170795579, -221.06936739269383, -642.0152834644357, -469.97987251178324, -164.8930037469667, -755.553120486779, -608.5153680287525, -255.983144131099, 52.083181055592846, -813.7046333895744, -546.5744969081156, 14.220097833235142, -843.2281567666264, -375.6900983999038, -272.791122343372, -112.34577492087777, -830.6334145022092, -279.44645454578523, -812.4581668349537, -346.8950951645421, -547.6586699364781, -49.2910519433719, -631.4370529026263, -479.21653078953966, -759.4421062442931, -454.14919588601157, -190.32867918366344, -443.71073980050517, -248.64360559037007, -271.9967900995919, -105.4566172618689, 302.07598953474087, -689.12161522158, -400.15736553143194, -80.49002953318119, -112.74869169852307, -779.5372600481094, -701.6803178265407, 280.16808257869235, -170.76033943333866, -43.27215612425678, -502.09592876217835, -515.0504154664231, -472.4703173583879, -413.76387660857984, -116.78266453184388, -348.54087263670027, -657.8367350013181, -535.0360643246925, -474.16850958229935, -244.2774474461081, -570.2214013090723, -584.4443547672851, -667.1740283369365, -475.78798852744296, 45.22824936495151, -428.0712814807237, -279.6051032648212, -625.0329816444939, -144.32866625390275, -595.8085071178223, -405.33206524241547, -33.03778551573792, -359.603845860745, -187.16839526245283, -584.7148048349819, -295.8737649834099, -573.7872150784407, -369.73454487126446], "policy_predator_policy_reward": [241.5462016137254, 677.9854366349718, 704.8183107835215, 658.9397656855499, 857.0142012214611, 463.9616050560477, 668.5181510130732, 676.9167763780265, 538.8133762083639, 690.6285694258726, 384.1268676839044, 622.3779505847186, 374.19615655428487, 484.4316763333639, 724.4865440685295, 720.8606036058915, 504.34858714858024, 392.47611254370673, 536.2746546466683, 506.91953667155485, 502.6060139618643, 688.4437798908416, 195.93904757492936, 379.4543223764951, 423.5456322181538, 665.6408728266141, 735.7008028540581, 781.7870066343595, 16.25, 306.4251823711513, 680.758540560894, 539.3785761837518, 352.8837453602544, 794.0065361438853, 751.3932578849096, 548.9162105988313, 580.9323087667276, 412.38602438605585, 348.6524254454733, 606.3860056179966, 738.751364216175, 534.3174095649564, 522.6264683825442, 502.37023685575804, 490.019603873109, 615.1511767553309, 546.9993501141048, 493.7424785821754, 671.710507700891, 366.27925720670714, 230.45294501071106, 678.2048584858601, 676.7444686654363, 681.3331134185091, 492.2801289420833, 126.4102544827621, 881.1367697870845, 741.8116975135845, 477.426749522438, 845.3690043996123, 556.2520410822797, 644.4173238902754, 975.7927733347462, 606.7976480106305, 712.6185498869817, 793.6577375521815, 672.3602817090405, 396.5283401007531, 645.8161941992258, 660.2177761138632, 593.900966235423, 568.5135075297578, 747.9650780144343, 639.9942208495679, 553.8913990636188, 493.0938470773756, 616.376435691086, 608.5489182583168, 425.9873916513158, 350.11056110842236, 521.1672972746399, 369.94915477462695, 585.3212174177578, 760.9779052264091, 112.86604316587344, 42.855732709799845, 490.0107835852273, 91.91367280703724, 426.6095854523822, 316.5638020475414, 454.24963335608305, 473.4863816669225, 321.6887056975334, 875.8707211078444, 593.5063208529303, 385.58831974082335, 481.0980176681908, 528.189432589828, 591.7479925429926, 477.56276852773595, 607.1297203481353, 478.29586690361214, 300.51549624026427, 620.68290315444, 595.0790693315664, 308.9643380164041, 426.35328796102914, 563.6609402892745, 816.1566730006596, 445.1827705970485, 587.5869609819395, 756.5881769088876, 480.9236006226976, 267.2909295471549, 541.3760027196771, 464.9894031311192, 70.39473362341666, 27.90431145866343, 629.5547143116918, 800.7705147035595, 763.4452831825741, 551.052305923268, 503.763139382659, 516.1639382999793, 553.9440458709996, 383.28709293588565, 420.6207980118912, 587.2771055658047, 60.11610775947025, 54.46137848252865, 458.7690946140422, 391.1182745123347, 180.66974382705268, 623.0593677684382, 371.00967403708796, 603.6017669014984, 826.6529951605391, 657.1550231858672, 376.8491866294866, 13.427993234048339, 601.5675582782052, 762.2374775527402, 454.73368141943445, 681.4863684869113, 394.6900983999081, 289.6911223433744, 565.4953826643606, 806.9125989981476, 468.97943532150987, 812.3619220465282, 496.6096712805812, 547.6765509457547, 354.14325037920383, 596.3331668718084, 658.2954070906278, 724.9059765580788, 469.4974134075501, 210.24677121271554, 166.6903687178999, 476.14235072279223, 295.0290231466312, 228.47274927282606, 515.0264413056611, 574.3210616560082, 493.03683837406453, 210.51750967002474, 582.9968133511019, 639.9370261186042, 630.0609338710242, 521.1019328631676, 262.57481159675564, 275.8521227641793, 501.7054844576204, 545.0052705500359, 294.42468029711694, 574.8072598786104, 194.6939120900002, 395.87142085561504, 638.8626950988522, 647.7889007018787, 307.39668753331733, 384.2370940458157, 572.1214013090722, 585.6443547672853, 534.2756883056968, 653.993108410472, 452.76652544231774, 231.17184776085443, 296.9051032648247, 628.3329816444946, 416.60716843025494, 568.2864177642867, 419.21922743686866, 196.18019120750932, 300.86312782698303, 264.676414411425, 564.4062321256661, 495.8234713067836, 584.8596643743819, 366.6694628610163]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.943151791639903, "mean_inference_ms": 4.403392119210813, "mean_action_processing_ms": 1.6407266223918382, "mean_env_wait_ms": 12.55198315925824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012051224708557129, "StateBufferConnector_ms": 0.005255699157714844, "ViewRequirementAgentConnector_ms": 0.15024995803833008}, "num_episodes": 9, "episode_return_max": 908.5658341687821, "episode_return_min": -59.355539261638405, "episode_return_mean": 240.51406308039392, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.97462609894828, "num_env_steps_trained_throughput_per_sec": 155.97462609894828, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 25735.622, "restore_workers_time_ms": 0.051, "training_step_time_ms": 25735.236, "sample_time_ms": 2361.727, "learn_time_ms": 23345.767, "learn_throughput": 171.337, "synch_weights_time_ms": 22.187}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 84, "trial_id": "0b608_00000", "date": "2024-08-22_14-21-24", "timestamp": 1724316684, "time_this_iter_s": 25.687904119491577, "time_total_s": 2176.13214468956, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x312081940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2176.13214468956, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 33.18378378378378, "ram_util_percent": 82.39189189189189}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.64876751420359, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.49371205234023, "policy_loss": -0.012369634563389121, "vf_loss": 7.50533678468573, "vf_explained_var": 0.05067338678571913, "kl": 0.00744889257672839, "entropy": 0.2719392952780244, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 79853.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.60033401913113, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.79788785460134, "policy_loss": -0.009600936270826472, "vf_loss": 6.805919932309912, "vf_explained_var": 0.5682062118772476, "kl": 0.00784439275277749, "entropy": 0.5342221290661544, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 79853.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 865.227595050954, "episode_reward_min": -59.355539261638405, "episode_reward_mean": 227.51596603077033, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -975.6556044289956, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 387.55574381085427, "predator_policy": 975.7927733347462}, "policy_reward_mean": {"prey_policy": -382.080048826766, "predator_policy": 495.83803184215145}, "custom_metrics": {}, "hist_stats": {"episode_reward": [422.66936888226843, 530.7721059598886, 396.6833501103423, 0.28044944472567324, 434.2320674246923, 133.39718112288242, 388.85399874947126, 17.070886094768547, 364.04120824798883, 95.179747914828, 31.43914128402276, 29.596990180730053, 516.6423499339288, 66.32262190592452, 361.1354748193234, 264.5492166891976, 369.8346721231744, 267.0870940849436, 6.157911493714837, 16.91252527779776, 865.227595050954, 12.26320845290659, 381.12120084559155, 342.2804659704815, 542.2222732620157, 108.64098758878792, 17.667595630429666, 85.77700944070408, 80.53802571551024, 205.5819011616503, 215.26683467917675, 606.6002057572456, 69.10000000000036, 44.11132727611512, 10.369000420553226, 179.64681100052314, 56.16773097192949, 66.17022625710982, 123.91492639942084, 221.32860807976363, 840.8174665572095, 31.03365222390934, 60.62913747514318, 386.82420878105495, 545.8975089296754, 219.80723289942912, 109.833300855867, 600.1862330898695, 442.7374469405456, -5.154924194328297, 501.0498905007937, 301.17427877241374, 388.93730072913155, 362.46399707234724, 124.467056271741, 320.25486808234746, -59.355539261638405, 339.73856467983524, 119.73952983087403, 186.37721678802262, 3.525905533251142, 307.2119909729557, 35.90000000000025, 429.4287922394224, 189.4367359872972, 149.73245712531167, 269.7483124050152, 144.54274661487418, 35.2663095505894, -49.52162595018278, 146.04836505799005, 702.3018772748302, 222.90695297947642, 330.6478877230726, 729.6506314863428, 324.3944388033403, 29.564410779054306, -17.002253791243383, 125.24179577706687, 93.77879647472116, -26.812175449274193, 3.100000000000003, 45.306779851791596, 301.09534108739734, 20.600000000000037, 244.75641282281924, 177.02956788621864, 18.767301115207356, 179.64113361405754, 8.00736728569236, 61.88893735103264, 381.3390114321732, 827.0617751799766, 447.4787772902522, 488.45493121381423, 26.079748472723022, 390.3445593081325, 6.611434972923239, 37.20000000000027, 146.5284498691776], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [40.0000000000003, -808.3804249704394, -297.07146261195595, 252.45019862041573, 28.235794092487033, -720.7389490269162, -735.3582869686545, -781.8490730750374, 222.37539108079812, -110.81850602725552, -510.9345838957821, -575.8053517259813, -216.13229772907988, -541.903985025584, -750.4514496253798, -532.7871327635928, -730.2148553003314, 100.9377303955404, -256.67267753064215, -603.1860056179968, -662.8100500028229, -578.8195824942842, -350.7498666072824, -644.6498484502902, 35.485149972818746, -624.0135806673269, -571.1388517021954, -403.28035508815765, -682.885203850724, 6.030913762449217, 8.755643053298552, -652.864229860671, -272.572322549207, -715.6705874115648, 188.84061534143126, -540.4439046813325, -874.951660676166, -741.8388951307883, -464.81422424463756, -841.0690043996119, -679.9189583748994, 344.4771884532982, -975.6556044289956, -594.6716084634729, -324.44940526165055, -800.7056813319167, -419.5625347977425, -307.04562104157105, -717.3865941179364, -46.425102933134724, -442.3990305999482, -611.3744555764406, -746.2650780144339, -624.0266252191383, -672.1712134909671, -289.03702320931865, -514.3313128245816, -630.0560154093112, -598.292883781619, 27.776832183535795, -216.29274501086985, -459.5568723592181, -622.41520636611, -117.2837105208175, -16.786545254058503, -69.83523062161593, -219.92457652247086, -317.8885525936786, -522.221842017172, -210.5825450622014, -458.7582996272031, -289.3309043952778, -265.6209747256004, -875.7707211078443, -434.5082046602713, -478.4162096763683, -246.74285612918246, -638.6296677294139, -610.2620581496742, -237.72009484128978, -632.1638645053928, 387.55574381085427, -280.0818440163538, -610.0829031544397, -496.7932641108409, -346.6210057619862, -31.706529015637464, -571.4834904536136, -886.3393030240085, 170.89736835597756, -333.38690983425187, -790.9809951571427, -65.49432499444328, -572.8869043195417, -628.2804401453834, 222.101267384457, 381.63221038310354, -37.193808524640936, -636.1827159880723, -799.2974372215065, -784.0294600506329, -29.418238554420128, -499.3524058582564, -219.40039305197254, -542.6684818851738, -5.625356192583315, -832.4308690319536, 186.99696252660695, -25.509701947187303, 35.39927197693339, -496.84054933607325, -32.79195170795579, -221.06936739269383, -642.0152834644357, -469.97987251178324, -164.8930037469667, -755.553120486779, -608.5153680287525, -255.983144131099, 52.083181055592846, -813.7046333895744, -546.5744969081156, 14.220097833235142, -843.2281567666264, -375.6900983999038, -272.791122343372, -112.34577492087777, -830.6334145022092, -279.44645454578523, -812.4581668349537, -346.8950951645421, -547.6586699364781, -49.2910519433719, -631.4370529026263, -479.21653078953966, -759.4421062442931, -454.14919588601157, -190.32867918366344, -443.71073980050517, -248.64360559037007, -271.9967900995919, -105.4566172618689, 302.07598953474087, -689.12161522158, -400.15736553143194, -80.49002953318119, -112.74869169852307, -779.5372600481094, -701.6803178265407, 280.16808257869235, -170.76033943333866, -43.27215612425678, -502.09592876217835, -515.0504154664231, -472.4703173583879, -413.76387660857984, -116.78266453184388, -348.54087263670027, -657.8367350013181, -535.0360643246925, -474.16850958229935, -244.2774474461081, -570.2214013090723, -584.4443547672851, -667.1740283369365, -475.78798852744296, 45.22824936495151, -428.0712814807237, -279.6051032648212, -625.0329816444939, -144.32866625390275, -595.8085071178223, -405.33206524241547, -33.03778551573792, -359.603845860745, -187.16839526245283, -584.7148048349819, -295.8737649834099, -573.7872150784407, -369.73454487126446, -599.512617916398, -388.21099855550966, -377.16986212824355, 266.0200392956433, -709.6026430714359, 208.92610578451786, -419.41671225030376, -88.48933512137705, -623.2304611631224, 332.37312375929235, -562.0868233021012, -469.92678737503695, -585.8725876765936, 299.4787543291357, -639.999303158137, -840.4465641936523, -92.66964612022672, -566.2263310021182, -32.334454008492294, -606.4686647734474], "policy_predator_policy_reward": [502.6060139618643, 688.4437798908416, 195.93904757492936, 379.4543223764951, 423.5456322181538, 665.6408728266141, 735.7008028540581, 781.7870066343595, 16.25, 306.4251823711513, 680.758540560894, 539.3785761837518, 352.8837453602544, 794.0065361438853, 751.3932578849096, 548.9162105988313, 580.9323087667276, 412.38602438605585, 348.6524254454733, 606.3860056179966, 738.751364216175, 534.3174095649564, 522.6264683825442, 502.37023685575804, 490.019603873109, 615.1511767553309, 546.9993501141048, 493.7424785821754, 671.710507700891, 366.27925720670714, 230.45294501071106, 678.2048584858601, 676.7444686654363, 681.3331134185091, 492.2801289420833, 126.4102544827621, 881.1367697870845, 741.8116975135845, 477.426749522438, 845.3690043996123, 556.2520410822797, 644.4173238902754, 975.7927733347462, 606.7976480106305, 712.6185498869817, 793.6577375521815, 672.3602817090405, 396.5283401007531, 645.8161941992258, 660.2177761138632, 593.900966235423, 568.5135075297578, 747.9650780144343, 639.9942208495679, 553.8913990636188, 493.0938470773756, 616.376435691086, 608.5489182583168, 425.9873916513158, 350.11056110842236, 521.1672972746399, 369.94915477462695, 585.3212174177578, 760.9779052264091, 112.86604316587344, 42.855732709799845, 490.0107835852273, 91.91367280703724, 426.6095854523822, 316.5638020475414, 454.24963335608305, 473.4863816669225, 321.6887056975334, 875.8707211078444, 593.5063208529303, 385.58831974082335, 481.0980176681908, 528.189432589828, 591.7479925429926, 477.56276852773595, 607.1297203481353, 478.29586690361214, 300.51549624026427, 620.68290315444, 595.0790693315664, 308.9643380164041, 426.35328796102914, 563.6609402892745, 816.1566730006596, 445.1827705970485, 587.5869609819395, 756.5881769088876, 480.9236006226976, 267.2909295471549, 541.3760027196771, 464.9894031311192, 70.39473362341666, 27.90431145866343, 629.5547143116918, 800.7705147035595, 763.4452831825741, 551.052305923268, 503.763139382659, 516.1639382999793, 553.9440458709996, 383.28709293588565, 420.6207980118912, 587.2771055658047, 60.11610775947025, 54.46137848252865, 458.7690946140422, 391.1182745123347, 180.66974382705268, 623.0593677684382, 371.00967403708796, 603.6017669014984, 826.6529951605391, 657.1550231858672, 376.8491866294866, 13.427993234048339, 601.5675582782052, 762.2374775527402, 454.73368141943445, 681.4863684869113, 394.6900983999081, 289.6911223433744, 565.4953826643606, 806.9125989981476, 468.97943532150987, 812.3619220465282, 496.6096712805812, 547.6765509457547, 354.14325037920383, 596.3331668718084, 658.2954070906278, 724.9059765580788, 469.4974134075501, 210.24677121271554, 166.6903687178999, 476.14235072279223, 295.0290231466312, 228.47274927282606, 515.0264413056611, 574.3210616560082, 493.03683837406453, 210.51750967002474, 582.9968133511019, 639.9370261186042, 630.0609338710242, 521.1019328631676, 262.57481159675564, 275.8521227641793, 501.7054844576204, 545.0052705500359, 294.42468029711694, 574.8072598786104, 194.6939120900002, 395.87142085561504, 638.8626950988522, 647.7889007018787, 307.39668753331733, 384.2370940458157, 572.1214013090722, 585.6443547672853, 534.2756883056968, 653.993108410472, 452.76652544231774, 231.17184776085443, 296.9051032648247, 628.3329816444946, 416.60716843025494, 568.2864177642867, 419.21922743686866, 196.18019120750932, 300.86312782698303, 264.676414411425, 564.4062321256661, 495.8234713067836, 584.8596643743819, 366.6694628610163, 549.6697901816949, 499.94276364124636, 0.0, 492.4888342647739, 616.9628409540185, 710.7754715128796, 418.32017509219196, 537.0646495697401, 270.47566848470217, 508.836600132942, 413.12275358324814, 644.9706055666127, 132.98560374036873, 543.7527889152217, 642.40627817508, 844.6510241496327, 127.86964612022521, 568.2263310021182, 457.51211750262934, 327.8194511484902]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.939068889506031, "mean_inference_ms": 4.403873667711524, "mean_action_processing_ms": 1.6351343158016673, "mean_env_wait_ms": 12.560208206811476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015761733055114746, "StateBufferConnector_ms": 0.0053403377532958984, "ViewRequirementAgentConnector_ms": 0.17252027988433838}, "num_episodes": 10, "episode_return_max": 865.227595050954, "episode_return_min": -59.355539261638405, "episode_return_mean": 227.51596603077033, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.66354431223013, "num_env_steps_trained_throughput_per_sec": 155.66354431223013, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 25717.313, "restore_workers_time_ms": 0.051, "training_step_time_ms": 25716.933, "sample_time_ms": 2362.456, "learn_time_ms": 23327.133, "learn_throughput": 171.474, "synch_weights_time_ms": 22.202}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 85, "trial_id": "0b608_00000", "date": "2024-08-22_14-21-50", "timestamp": 1724316710, "time_this_iter_s": 25.762950897216797, "time_total_s": 2201.8950955867767, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x178007310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2201.8950955867767, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 31.955555555555552, "ram_util_percent": 82.99722222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.445249328916034, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.428497726702816, "policy_loss": -0.009234033700413804, "vf_loss": 7.436940517627373, "vf_explained_var": 0.16064640245740375, "kl": 0.007912117456918749, "entropy": 0.29459698332680595, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80798.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 37.361818250777226, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.024802831114915, "policy_loss": -0.010438383180924035, "vf_loss": 7.0337804325043205, "vf_explained_var": 0.519075086444774, "kl": 0.007303796238241293, "entropy": 0.5490163866489652, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80798.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "env_runners": {"episode_reward_max": 865.227595050954, "episode_reward_min": -59.355539261638405, "episode_reward_mean": 226.12940140261856, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -975.6556044289956, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 387.55574381085427, "predator_policy": 975.7927733347462}, "policy_reward_mean": {"prey_policy": -376.9296216000675, "predator_policy": 489.9943223013771}, "custom_metrics": {}, "hist_stats": {"episode_reward": [95.179747914828, 31.43914128402276, 29.596990180730053, 516.6423499339288, 66.32262190592452, 361.1354748193234, 264.5492166891976, 369.8346721231744, 267.0870940849436, 6.157911493714837, 16.91252527779776, 865.227595050954, 12.26320845290659, 381.12120084559155, 342.2804659704815, 542.2222732620157, 108.64098758878792, 17.667595630429666, 85.77700944070408, 80.53802571551024, 205.5819011616503, 215.26683467917675, 606.6002057572456, 69.10000000000036, 44.11132727611512, 10.369000420553226, 179.64681100052314, 56.16773097192949, 66.17022625710982, 123.91492639942084, 221.32860807976363, 840.8174665572095, 31.03365222390934, 60.62913747514318, 386.82420878105495, 545.8975089296754, 219.80723289942912, 109.833300855867, 600.1862330898695, 442.7374469405456, -5.154924194328297, 501.0498905007937, 301.17427877241374, 388.93730072913155, 362.46399707234724, 124.467056271741, 320.25486808234746, -59.355539261638405, 339.73856467983524, 119.73952983087403, 186.37721678802262, 3.525905533251142, 307.2119909729557, 35.90000000000025, 429.4287922394224, 189.4367359872972, 149.73245712531167, 269.7483124050152, 144.54274661487418, 35.2663095505894, -49.52162595018278, 146.04836505799005, 702.3018772748302, 222.90695297947642, 330.6478877230726, 729.6506314863428, 324.3944388033403, 29.564410779054306, -17.002253791243383, 125.24179577706687, 93.77879647472116, -26.812175449274193, 3.100000000000003, 45.306779851791596, 301.09534108739734, 20.600000000000037, 244.75641282281924, 177.02956788621864, 18.767301115207356, 179.64113361405754, 8.00736728569236, 61.88893735103264, 381.3390114321732, 827.0617751799766, 447.4787772902522, 488.45493121381423, 26.079748472723022, 390.3445593081325, 6.611434972923239, 37.20000000000027, 146.5284498691776, 61.239216637950776, 585.1552574140626, 225.10969979268154, 151.55226294462196, 287.7884081798312, 355.2638284852742, 289.2473499681597, 205.29999999999822, 388.688129799277], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-256.67267753064215, -603.1860056179968, -662.8100500028229, -578.8195824942842, -350.7498666072824, -644.6498484502902, 35.485149972818746, -624.0135806673269, -571.1388517021954, -403.28035508815765, -682.885203850724, 6.030913762449217, 8.755643053298552, -652.864229860671, -272.572322549207, -715.6705874115648, 188.84061534143126, -540.4439046813325, -874.951660676166, -741.8388951307883, -464.81422424463756, -841.0690043996119, -679.9189583748994, 344.4771884532982, -975.6556044289956, -594.6716084634729, -324.44940526165055, -800.7056813319167, -419.5625347977425, -307.04562104157105, -717.3865941179364, -46.425102933134724, -442.3990305999482, -611.3744555764406, -746.2650780144339, -624.0266252191383, -672.1712134909671, -289.03702320931865, -514.3313128245816, -630.0560154093112, -598.292883781619, 27.776832183535795, -216.29274501086985, -459.5568723592181, -622.41520636611, -117.2837105208175, -16.786545254058503, -69.83523062161593, -219.92457652247086, -317.8885525936786, -522.221842017172, -210.5825450622014, -458.7582996272031, -289.3309043952778, -265.6209747256004, -875.7707211078443, -434.5082046602713, -478.4162096763683, -246.74285612918246, -638.6296677294139, -610.2620581496742, -237.72009484128978, -632.1638645053928, 387.55574381085427, -280.0818440163538, -610.0829031544397, -496.7932641108409, -346.6210057619862, -31.706529015637464, -571.4834904536136, -886.3393030240085, 170.89736835597756, -333.38690983425187, -790.9809951571427, -65.49432499444328, -572.8869043195417, -628.2804401453834, 222.101267384457, 381.63221038310354, -37.193808524640936, -636.1827159880723, -799.2974372215065, -784.0294600506329, -29.418238554420128, -499.3524058582564, -219.40039305197254, -542.6684818851738, -5.625356192583315, -832.4308690319536, 186.99696252660695, -25.509701947187303, 35.39927197693339, -496.84054933607325, -32.79195170795579, -221.06936739269383, -642.0152834644357, -469.97987251178324, -164.8930037469667, -755.553120486779, -608.5153680287525, -255.983144131099, 52.083181055592846, -813.7046333895744, -546.5744969081156, 14.220097833235142, -843.2281567666264, -375.6900983999038, -272.791122343372, -112.34577492087777, -830.6334145022092, -279.44645454578523, -812.4581668349537, -346.8950951645421, -547.6586699364781, -49.2910519433719, -631.4370529026263, -479.21653078953966, -759.4421062442931, -454.14919588601157, -190.32867918366344, -443.71073980050517, -248.64360559037007, -271.9967900995919, -105.4566172618689, 302.07598953474087, -689.12161522158, -400.15736553143194, -80.49002953318119, -112.74869169852307, -779.5372600481094, -701.6803178265407, 280.16808257869235, -170.76033943333866, -43.27215612425678, -502.09592876217835, -515.0504154664231, -472.4703173583879, -413.76387660857984, -116.78266453184388, -348.54087263670027, -657.8367350013181, -535.0360643246925, -474.16850958229935, -244.2774474461081, -570.2214013090723, -584.4443547672851, -667.1740283369365, -475.78798852744296, 45.22824936495151, -428.0712814807237, -279.6051032648212, -625.0329816444939, -144.32866625390275, -595.8085071178223, -405.33206524241547, -33.03778551573792, -359.603845860745, -187.16839526245283, -584.7148048349819, -295.8737649834099, -573.7872150784407, -369.73454487126446, -599.512617916398, -388.21099855550966, -377.16986212824355, 266.0200392956433, -709.6026430714359, 208.92610578451786, -419.41671225030376, -88.48933512137705, -623.2304611631224, 332.37312375929235, -562.0868233021012, -469.92678737503695, -585.8725876765936, 299.4787543291357, -639.999303158137, -840.4465641936523, -92.66964612022672, -566.2263310021182, -32.334454008492294, -606.4686647734474, -705.0792063458517, -245.44419263036175, -586.1081138414415, 62.834749484927755, -471.2237873266476, -610.7876960489042, -585.7904082165716, -59.12587540220005, -653.3356669283751, -232.60942668662926, 163.56283491944794, -175.5406067341797, -85.02436888595369, -260.55870037796967, -10.36280632046527, -66.65337078646718, -234.83182009377896, -882.2833369956195], "policy_predator_policy_reward": [348.6524254454733, 606.3860056179966, 738.751364216175, 534.3174095649564, 522.6264683825442, 502.37023685575804, 490.019603873109, 615.1511767553309, 546.9993501141048, 493.7424785821754, 671.710507700891, 366.27925720670714, 230.45294501071106, 678.2048584858601, 676.7444686654363, 681.3331134185091, 492.2801289420833, 126.4102544827621, 881.1367697870845, 741.8116975135845, 477.426749522438, 845.3690043996123, 556.2520410822797, 644.4173238902754, 975.7927733347462, 606.7976480106305, 712.6185498869817, 793.6577375521815, 672.3602817090405, 396.5283401007531, 645.8161941992258, 660.2177761138632, 593.900966235423, 568.5135075297578, 747.9650780144343, 639.9942208495679, 553.8913990636188, 493.0938470773756, 616.376435691086, 608.5489182583168, 425.9873916513158, 350.11056110842236, 521.1672972746399, 369.94915477462695, 585.3212174177578, 760.9779052264091, 112.86604316587344, 42.855732709799845, 490.0107835852273, 91.91367280703724, 426.6095854523822, 316.5638020475414, 454.24963335608305, 473.4863816669225, 321.6887056975334, 875.8707211078444, 593.5063208529303, 385.58831974082335, 481.0980176681908, 528.189432589828, 591.7479925429926, 477.56276852773595, 607.1297203481353, 478.29586690361214, 300.51549624026427, 620.68290315444, 595.0790693315664, 308.9643380164041, 426.35328796102914, 563.6609402892745, 816.1566730006596, 445.1827705970485, 587.5869609819395, 756.5881769088876, 480.9236006226976, 267.2909295471549, 541.3760027196771, 464.9894031311192, 70.39473362341666, 27.90431145866343, 629.5547143116918, 800.7705147035595, 763.4452831825741, 551.052305923268, 503.763139382659, 516.1639382999793, 553.9440458709996, 383.28709293588565, 420.6207980118912, 587.2771055658047, 60.11610775947025, 54.46137848252865, 458.7690946140422, 391.1182745123347, 180.66974382705268, 623.0593677684382, 371.00967403708796, 603.6017669014984, 826.6529951605391, 657.1550231858672, 376.8491866294866, 13.427993234048339, 601.5675582782052, 762.2374775527402, 454.73368141943445, 681.4863684869113, 394.6900983999081, 289.6911223433744, 565.4953826643606, 806.9125989981476, 468.97943532150987, 812.3619220465282, 496.6096712805812, 547.6765509457547, 354.14325037920383, 596.3331668718084, 658.2954070906278, 724.9059765580788, 469.4974134075501, 210.24677121271554, 166.6903687178999, 476.14235072279223, 295.0290231466312, 228.47274927282606, 515.0264413056611, 574.3210616560082, 493.03683837406453, 210.51750967002474, 582.9968133511019, 639.9370261186042, 630.0609338710242, 521.1019328631676, 262.57481159675564, 275.8521227641793, 501.7054844576204, 545.0052705500359, 294.42468029711694, 574.8072598786104, 194.6939120900002, 395.87142085561504, 638.8626950988522, 647.7889007018787, 307.39668753331733, 384.2370940458157, 572.1214013090722, 585.6443547672853, 534.2756883056968, 653.993108410472, 452.76652544231774, 231.17184776085443, 296.9051032648247, 628.3329816444946, 416.60716843025494, 568.2864177642867, 419.21922743686866, 196.18019120750932, 300.86312782698303, 264.676414411425, 564.4062321256661, 495.8234713067836, 584.8596643743819, 366.6694628610163, 549.6697901816949, 499.94276364124636, 0.0, 492.4888342647739, 616.9628409540185, 710.7754715128796, 418.32017509219196, 537.0646495697401, 270.47566848470217, 508.836600132942, 413.12275358324814, 644.9706055666127, 132.98560374036873, 543.7527889152217, 642.40627817508, 844.6510241496327, 127.86964612022521, 568.2263310021182, 457.51211750262934, 327.8194511484902, 271.98198252699603, 739.7806330871692, 550.0923390811104, 558.336282689466, 634.853319238076, 672.2678639301644, 339.9691137515376, 456.4994328118564, 559.8126391413988, 613.9208626534344, 159.36915062644402, 207.87244967355767, 321.8171460785022, 313.0132731535814, 156.41026474717896, 125.90591235975283, 627.6177552317237, 878.1855316569514]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.933835640108349, "mean_inference_ms": 4.399658336298831, "mean_action_processing_ms": 1.636746224605721, "mean_env_wait_ms": 12.5615816086262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016293644905090332, "StateBufferConnector_ms": 0.004618287086486816, "ViewRequirementAgentConnector_ms": 0.17849481105804443}, "num_episodes": 9, "episode_return_max": 865.227595050954, "episode_return_min": -59.355539261638405, "episode_return_mean": 226.12940140261856, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.75596538193196, "num_env_steps_trained_throughput_per_sec": 154.75596538193196, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1376000, "timers": {"training_iteration_time_ms": 25708.945, "restore_workers_time_ms": 0.051, "training_step_time_ms": 25708.588, "sample_time_ms": 2359.433, "learn_time_ms": 23321.184, "learn_throughput": 171.518, "synch_weights_time_ms": 22.882}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "done": false, "training_iteration": 86, "trial_id": "0b608_00000", "date": "2024-08-22_14-22-16", "timestamp": 1724316736, "time_this_iter_s": 25.88493800163269, "time_total_s": 2227.7800335884094, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a370c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2227.7800335884094, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 33.756756756756765, "ram_util_percent": 82.97837837837838}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.946814542598826, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.149315695787863, "policy_loss": -0.011107400826932418, "vf_loss": 7.159630351091819, "vf_explained_var": 0.20652810675757272, "kl": 0.007927365725978262, "entropy": 0.30277437638668786, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 81743.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000576}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.88384407336119, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.911542129516602, "policy_loss": -0.009066206841635956, "vf_loss": 6.918840807960147, "vf_explained_var": 0.4309948175672501, "kl": 0.008837616924817363, "entropy": 0.5545371720084438, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 81743.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000576}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 840.8174665572095, "episode_reward_min": -59.355539261638405, "episode_reward_mean": 218.28202421477138, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -975.6556044289956, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 387.55574381085427, "predator_policy": 975.7927733347462}, "policy_reward_mean": {"prey_policy": -377.9185373820759, "predator_policy": 487.0595494894619}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.26320845290659, 381.12120084559155, 342.2804659704815, 542.2222732620157, 108.64098758878792, 17.667595630429666, 85.77700944070408, 80.53802571551024, 205.5819011616503, 215.26683467917675, 606.6002057572456, 69.10000000000036, 44.11132727611512, 10.369000420553226, 179.64681100052314, 56.16773097192949, 66.17022625710982, 123.91492639942084, 221.32860807976363, 840.8174665572095, 31.03365222390934, 60.62913747514318, 386.82420878105495, 545.8975089296754, 219.80723289942912, 109.833300855867, 600.1862330898695, 442.7374469405456, -5.154924194328297, 501.0498905007937, 301.17427877241374, 388.93730072913155, 362.46399707234724, 124.467056271741, 320.25486808234746, -59.355539261638405, 339.73856467983524, 119.73952983087403, 186.37721678802262, 3.525905533251142, 307.2119909729557, 35.90000000000025, 429.4287922394224, 189.4367359872972, 149.73245712531167, 269.7483124050152, 144.54274661487418, 35.2663095505894, -49.52162595018278, 146.04836505799005, 702.3018772748302, 222.90695297947642, 330.6478877230726, 729.6506314863428, 324.3944388033403, 29.564410779054306, -17.002253791243383, 125.24179577706687, 93.77879647472116, -26.812175449274193, 3.100000000000003, 45.306779851791596, 301.09534108739734, 20.600000000000037, 244.75641282281924, 177.02956788621864, 18.767301115207356, 179.64113361405754, 8.00736728569236, 61.88893735103264, 381.3390114321732, 827.0617751799766, 447.4787772902522, 488.45493121381423, 26.079748472723022, 390.3445593081325, 6.611434972923239, 37.20000000000027, 146.5284498691776, 61.239216637950776, 585.1552574140626, 225.10969979268154, 151.55226294462196, 287.7884081798312, 355.2638284852742, 289.2473499681597, 205.29999999999822, 388.688129799277, 7.499999999999993, 24.40000000000002, 320.98685204185375, 281.87856524401167, 287.82343591178216, 8.820547036067257, 29.539660830605975, 440.7765995784656, 40.48888749540824, 12.748223573427438, 192.32076544706507, 458.06408481512995], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-975.6556044289956, -594.6716084634729, -324.44940526165055, -800.7056813319167, -419.5625347977425, -307.04562104157105, -717.3865941179364, -46.425102933134724, -442.3990305999482, -611.3744555764406, -746.2650780144339, -624.0266252191383, -672.1712134909671, -289.03702320931865, -514.3313128245816, -630.0560154093112, -598.292883781619, 27.776832183535795, -216.29274501086985, -459.5568723592181, -622.41520636611, -117.2837105208175, -16.786545254058503, -69.83523062161593, -219.92457652247086, -317.8885525936786, -522.221842017172, -210.5825450622014, -458.7582996272031, -289.3309043952778, -265.6209747256004, -875.7707211078443, -434.5082046602713, -478.4162096763683, -246.74285612918246, -638.6296677294139, -610.2620581496742, -237.72009484128978, -632.1638645053928, 387.55574381085427, -280.0818440163538, -610.0829031544397, -496.7932641108409, -346.6210057619862, -31.706529015637464, -571.4834904536136, -886.3393030240085, 170.89736835597756, -333.38690983425187, -790.9809951571427, -65.49432499444328, -572.8869043195417, -628.2804401453834, 222.101267384457, 381.63221038310354, -37.193808524640936, -636.1827159880723, -799.2974372215065, -784.0294600506329, -29.418238554420128, -499.3524058582564, -219.40039305197254, -542.6684818851738, -5.625356192583315, -832.4308690319536, 186.99696252660695, -25.509701947187303, 35.39927197693339, -496.84054933607325, -32.79195170795579, -221.06936739269383, -642.0152834644357, -469.97987251178324, -164.8930037469667, -755.553120486779, -608.5153680287525, -255.983144131099, 52.083181055592846, -813.7046333895744, -546.5744969081156, 14.220097833235142, -843.2281567666264, -375.6900983999038, -272.791122343372, -112.34577492087777, -830.6334145022092, -279.44645454578523, -812.4581668349537, -346.8950951645421, -547.6586699364781, -49.2910519433719, -631.4370529026263, -479.21653078953966, -759.4421062442931, -454.14919588601157, -190.32867918366344, -443.71073980050517, -248.64360559037007, -271.9967900995919, -105.4566172618689, 302.07598953474087, -689.12161522158, -400.15736553143194, -80.49002953318119, -112.74869169852307, -779.5372600481094, -701.6803178265407, 280.16808257869235, -170.76033943333866, -43.27215612425678, -502.09592876217835, -515.0504154664231, -472.4703173583879, -413.76387660857984, -116.78266453184388, -348.54087263670027, -657.8367350013181, -535.0360643246925, -474.16850958229935, -244.2774474461081, -570.2214013090723, -584.4443547672851, -667.1740283369365, -475.78798852744296, 45.22824936495151, -428.0712814807237, -279.6051032648212, -625.0329816444939, -144.32866625390275, -595.8085071178223, -405.33206524241547, -33.03778551573792, -359.603845860745, -187.16839526245283, -584.7148048349819, -295.8737649834099, -573.7872150784407, -369.73454487126446, -599.512617916398, -388.21099855550966, -377.16986212824355, 266.0200392956433, -709.6026430714359, 208.92610578451786, -419.41671225030376, -88.48933512137705, -623.2304611631224, 332.37312375929235, -562.0868233021012, -469.92678737503695, -585.8725876765936, 299.4787543291357, -639.999303158137, -840.4465641936523, -92.66964612022672, -566.2263310021182, -32.334454008492294, -606.4686647734474, -705.0792063458517, -245.44419263036175, -586.1081138414415, 62.834749484927755, -471.2237873266476, -610.7876960489042, -585.7904082165716, -59.12587540220005, -653.3356669283751, -232.60942668662926, 163.56283491944794, -175.5406067341797, -85.02436888595369, -260.55870037796967, -10.36280632046527, -66.65337078646718, -234.83182009377896, -882.2833369956195, -605.8379170533456, -592.860083189226, -249.85996954761177, -714.2269014589314, -330.3507988055026, -50.864902783971786, -268.68154544557393, -774.5064668460985, -344.70868118471407, -448.8205876526608, -610.8520709786752, -535.3199841067321, -380.304715423721, -422.74236533685973, -104.42612658147291, -721.5502602000367, -479.86496184585593, -321.9960768892353, -458.4385079067294, -706.4897971545306, -269.9215536704036, -589.8908026592271, -725.5985006229329, -68.42987781494358], "policy_predator_policy_reward": [975.7927733347462, 606.7976480106305, 712.6185498869817, 793.6577375521815, 672.3602817090405, 396.5283401007531, 645.8161941992258, 660.2177761138632, 593.900966235423, 568.5135075297578, 747.9650780144343, 639.9942208495679, 553.8913990636188, 493.0938470773756, 616.376435691086, 608.5489182583168, 425.9873916513158, 350.11056110842236, 521.1672972746399, 369.94915477462695, 585.3212174177578, 760.9779052264091, 112.86604316587344, 42.855732709799845, 490.0107835852273, 91.91367280703724, 426.6095854523822, 316.5638020475414, 454.24963335608305, 473.4863816669225, 321.6887056975334, 875.8707211078444, 593.5063208529303, 385.58831974082335, 481.0980176681908, 528.189432589828, 591.7479925429926, 477.56276852773595, 607.1297203481353, 478.29586690361214, 300.51549624026427, 620.68290315444, 595.0790693315664, 308.9643380164041, 426.35328796102914, 563.6609402892745, 816.1566730006596, 445.1827705970485, 587.5869609819395, 756.5881769088876, 480.9236006226976, 267.2909295471549, 541.3760027196771, 464.9894031311192, 70.39473362341666, 27.90431145866343, 629.5547143116918, 800.7705147035595, 763.4452831825741, 551.052305923268, 503.763139382659, 516.1639382999793, 553.9440458709996, 383.28709293588565, 420.6207980118912, 587.2771055658047, 60.11610775947025, 54.46137848252865, 458.7690946140422, 391.1182745123347, 180.66974382705268, 623.0593677684382, 371.00967403708796, 603.6017669014984, 826.6529951605391, 657.1550231858672, 376.8491866294866, 13.427993234048339, 601.5675582782052, 762.2374775527402, 454.73368141943445, 681.4863684869113, 394.6900983999081, 289.6911223433744, 565.4953826643606, 806.9125989981476, 468.97943532150987, 812.3619220465282, 496.6096712805812, 547.6765509457547, 354.14325037920383, 596.3331668718084, 658.2954070906278, 724.9059765580788, 469.4974134075501, 210.24677121271554, 166.6903687178999, 476.14235072279223, 295.0290231466312, 228.47274927282606, 515.0264413056611, 574.3210616560082, 493.03683837406453, 210.51750967002474, 582.9968133511019, 639.9370261186042, 630.0609338710242, 521.1019328631676, 262.57481159675564, 275.8521227641793, 501.7054844576204, 545.0052705500359, 294.42468029711694, 574.8072598786104, 194.6939120900002, 395.87142085561504, 638.8626950988522, 647.7889007018787, 307.39668753331733, 384.2370940458157, 572.1214013090722, 585.6443547672853, 534.2756883056968, 653.993108410472, 452.76652544231774, 231.17184776085443, 296.9051032648247, 628.3329816444946, 416.60716843025494, 568.2864177642867, 419.21922743686866, 196.18019120750932, 300.86312782698303, 264.676414411425, 564.4062321256661, 495.8234713067836, 584.8596643743819, 366.6694628610163, 549.6697901816949, 499.94276364124636, 0.0, 492.4888342647739, 616.9628409540185, 710.7754715128796, 418.32017509219196, 537.0646495697401, 270.47566848470217, 508.836600132942, 413.12275358324814, 644.9706055666127, 132.98560374036873, 543.7527889152217, 642.40627817508, 844.6510241496327, 127.86964612022521, 568.2263310021182, 457.51211750262934, 327.8194511484902, 271.98198252699603, 739.7806330871692, 550.0923390811104, 558.336282689466, 634.853319238076, 672.2678639301644, 339.9691137515376, 456.4994328118564, 559.8126391413988, 613.9208626534344, 159.36915062644402, 207.87244967355767, 321.8171460785022, 313.0132731535814, 156.41026474717896, 125.90591235975283, 627.6177552317237, 878.1855316569514, 605.9379170533456, 600.2600831892277, 274.25996954761035, 714.2269014589314, 229.47378503429505, 472.72876859703814, 609.4843165085142, 715.5822610271696, 498.21718381438393, 583.135520934775, 698.700522402588, 456.2920797188867, 400.08646940164357, 432.50027218954847, 568.0368264302039, 698.7161599297696, 507.05920842941134, 335.2907178010936, 470.78673148015866, 706.8897971545307, 759.5492764443294, 292.58384533236637, 671.260452807874, 580.8320104451291]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.922212137176191, "mean_inference_ms": 4.3876644118544705, "mean_action_processing_ms": 1.6419686400945246, "mean_env_wait_ms": 12.562704988742729, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017051339149475098, "StateBufferConnector_ms": 0.0043708086013793945, "ViewRequirementAgentConnector_ms": 0.13993501663208008}, "num_episodes": 12, "episode_return_max": 840.8174665572095, "episode_return_min": -59.355539261638405, "episode_return_mean": 218.28202421477138, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.1992658012139, "num_env_steps_trained_throughput_per_sec": 156.1992658012139, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 25724.479, "restore_workers_time_ms": 0.026, "training_step_time_ms": 25724.059, "sample_time_ms": 2366.101, "learn_time_ms": 23330.238, "learn_throughput": 171.451, "synch_weights_time_ms": 23.01}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 87, "trial_id": "0b608_00000", "date": "2024-08-22_14-22-41", "timestamp": 1724316761, "time_this_iter_s": 25.658799171447754, "time_total_s": 2253.438832759857, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a38d310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2253.438832759857, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 32.70555555555555, "ram_util_percent": 83.01944444444443}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.48370880752644, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.283522970714266, "policy_loss": -0.010837294365323725, "vf_loss": 7.293393743101251, "vf_explained_var": 0.2067278781265178, "kl": 0.009664979979405722, "entropy": 0.2981273826783296, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82688.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000576}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 36.60900544060601, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.759128452482678, "policy_loss": -0.00809563101964101, "vf_loss": 6.7656951172641975, "vf_explained_var": 0.49605769720027054, "kl": 0.007644857803763693, "entropy": 0.5341300990531054, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82688.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000576}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "env_runners": {"episode_reward_max": 840.8174665572095, "episode_reward_min": -59.355539261638405, "episode_reward_mean": 229.15553739377495, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -900.8050467492574, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 387.55574381085427, "predator_policy": 878.1855316569514}, "policy_reward_mean": {"prey_policy": -369.5915820564506, "predator_policy": 484.16935075333845}, "custom_metrics": {}, "hist_stats": {"episode_reward": [606.6002057572456, 69.10000000000036, 44.11132727611512, 10.369000420553226, 179.64681100052314, 56.16773097192949, 66.17022625710982, 123.91492639942084, 221.32860807976363, 840.8174665572095, 31.03365222390934, 60.62913747514318, 386.82420878105495, 545.8975089296754, 219.80723289942912, 109.833300855867, 600.1862330898695, 442.7374469405456, -5.154924194328297, 501.0498905007937, 301.17427877241374, 388.93730072913155, 362.46399707234724, 124.467056271741, 320.25486808234746, -59.355539261638405, 339.73856467983524, 119.73952983087403, 186.37721678802262, 3.525905533251142, 307.2119909729557, 35.90000000000025, 429.4287922394224, 189.4367359872972, 149.73245712531167, 269.7483124050152, 144.54274661487418, 35.2663095505894, -49.52162595018278, 146.04836505799005, 702.3018772748302, 222.90695297947642, 330.6478877230726, 729.6506314863428, 324.3944388033403, 29.564410779054306, -17.002253791243383, 125.24179577706687, 93.77879647472116, -26.812175449274193, 3.100000000000003, 45.306779851791596, 301.09534108739734, 20.600000000000037, 244.75641282281924, 177.02956788621864, 18.767301115207356, 179.64113361405754, 8.00736728569236, 61.88893735103264, 381.3390114321732, 827.0617751799766, 447.4787772902522, 488.45493121381423, 26.079748472723022, 390.3445593081325, 6.611434972923239, 37.20000000000027, 146.5284498691776, 61.239216637950776, 585.1552574140626, 225.10969979268154, 151.55226294462196, 287.7884081798312, 355.2638284852742, 289.2473499681597, 205.29999999999822, 388.688129799277, 7.499999999999993, 24.40000000000002, 320.98685204185375, 281.87856524401167, 287.82343591178216, 8.820547036067257, 29.539660830605975, 440.7765995784656, 40.48888749540824, 12.748223573427438, 192.32076544706507, 458.06408481512995, 493.71777612981623, 72.46836911158509, 464.7976322322825, 197.20155729939694, 420.9334288900704, 30.30514987191758, 346.1065719925435, 526.4511637730735, 361.0942466332896, 165.63492471364094], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-622.41520636611, -117.2837105208175, -16.786545254058503, -69.83523062161593, -219.92457652247086, -317.8885525936786, -522.221842017172, -210.5825450622014, -458.7582996272031, -289.3309043952778, -265.6209747256004, -875.7707211078443, -434.5082046602713, -478.4162096763683, -246.74285612918246, -638.6296677294139, -610.2620581496742, -237.72009484128978, -632.1638645053928, 387.55574381085427, -280.0818440163538, -610.0829031544397, -496.7932641108409, -346.6210057619862, -31.706529015637464, -571.4834904536136, -886.3393030240085, 170.89736835597756, -333.38690983425187, -790.9809951571427, -65.49432499444328, -572.8869043195417, -628.2804401453834, 222.101267384457, 381.63221038310354, -37.193808524640936, -636.1827159880723, -799.2974372215065, -784.0294600506329, -29.418238554420128, -499.3524058582564, -219.40039305197254, -542.6684818851738, -5.625356192583315, -832.4308690319536, 186.99696252660695, -25.509701947187303, 35.39927197693339, -496.84054933607325, -32.79195170795579, -221.06936739269383, -642.0152834644357, -469.97987251178324, -164.8930037469667, -755.553120486779, -608.5153680287525, -255.983144131099, 52.083181055592846, -813.7046333895744, -546.5744969081156, 14.220097833235142, -843.2281567666264, -375.6900983999038, -272.791122343372, -112.34577492087777, -830.6334145022092, -279.44645454578523, -812.4581668349537, -346.8950951645421, -547.6586699364781, -49.2910519433719, -631.4370529026263, -479.21653078953966, -759.4421062442931, -454.14919588601157, -190.32867918366344, -443.71073980050517, -248.64360559037007, -271.9967900995919, -105.4566172618689, 302.07598953474087, -689.12161522158, -400.15736553143194, -80.49002953318119, -112.74869169852307, -779.5372600481094, -701.6803178265407, 280.16808257869235, -170.76033943333866, -43.27215612425678, -502.09592876217835, -515.0504154664231, -472.4703173583879, -413.76387660857984, -116.78266453184388, -348.54087263670027, -657.8367350013181, -535.0360643246925, -474.16850958229935, -244.2774474461081, -570.2214013090723, -584.4443547672851, -667.1740283369365, -475.78798852744296, 45.22824936495151, -428.0712814807237, -279.6051032648212, -625.0329816444939, -144.32866625390275, -595.8085071178223, -405.33206524241547, -33.03778551573792, -359.603845860745, -187.16839526245283, -584.7148048349819, -295.8737649834099, -573.7872150784407, -369.73454487126446, -599.512617916398, -388.21099855550966, -377.16986212824355, 266.0200392956433, -709.6026430714359, 208.92610578451786, -419.41671225030376, -88.48933512137705, -623.2304611631224, 332.37312375929235, -562.0868233021012, -469.92678737503695, -585.8725876765936, 299.4787543291357, -639.999303158137, -840.4465641936523, -92.66964612022672, -566.2263310021182, -32.334454008492294, -606.4686647734474, -705.0792063458517, -245.44419263036175, -586.1081138414415, 62.834749484927755, -471.2237873266476, -610.7876960489042, -585.7904082165716, -59.12587540220005, -653.3356669283751, -232.60942668662926, 163.56283491944794, -175.5406067341797, -85.02436888595369, -260.55870037796967, -10.36280632046527, -66.65337078646718, -234.83182009377896, -882.2833369956195, -605.8379170533456, -592.860083189226, -249.85996954761177, -714.2269014589314, -330.3507988055026, -50.864902783971786, -268.68154544557393, -774.5064668460985, -344.70868118471407, -448.8205876526608, -610.8520709786752, -535.3199841067321, -380.304715423721, -422.74236533685973, -104.42612658147291, -721.5502602000367, -479.86496184585593, -321.9960768892353, -458.4385079067294, -706.4897971545306, -269.9215536704036, -589.8908026592271, -725.5985006229329, -68.42987781494358, -564.8201918918706, -24.54334986442032, -604.6763687905802, -498.10601153617, -417.18370336347556, -485.7705175481807, -311.92248434116726, -483.74380705421294, -551.4581411911132, 39.095728462173184, -499.6372934721561, -717.664271666053, -500.5394571956742, 39.8175165639411, -828.7128789764593, 239.82188522406693, 12.923523001501481, -900.8050467492574, -557.6631045753849, -680.9495355991751], "policy_predator_policy_reward": [585.3212174177578, 760.9779052264091, 112.86604316587344, 42.855732709799845, 490.0107835852273, 91.91367280703724, 426.6095854523822, 316.5638020475414, 454.24963335608305, 473.4863816669225, 321.6887056975334, 875.8707211078444, 593.5063208529303, 385.58831974082335, 481.0980176681908, 528.189432589828, 591.7479925429926, 477.56276852773595, 607.1297203481353, 478.29586690361214, 300.51549624026427, 620.68290315444, 595.0790693315664, 308.9643380164041, 426.35328796102914, 563.6609402892745, 816.1566730006596, 445.1827705970485, 587.5869609819395, 756.5881769088876, 480.9236006226976, 267.2909295471549, 541.3760027196771, 464.9894031311192, 70.39473362341666, 27.90431145866343, 629.5547143116918, 800.7705147035595, 763.4452831825741, 551.052305923268, 503.763139382659, 516.1639382999793, 553.9440458709996, 383.28709293588565, 420.6207980118912, 587.2771055658047, 60.11610775947025, 54.46137848252865, 458.7690946140422, 391.1182745123347, 180.66974382705268, 623.0593677684382, 371.00967403708796, 603.6017669014984, 826.6529951605391, 657.1550231858672, 376.8491866294866, 13.427993234048339, 601.5675582782052, 762.2374775527402, 454.73368141943445, 681.4863684869113, 394.6900983999081, 289.6911223433744, 565.4953826643606, 806.9125989981476, 468.97943532150987, 812.3619220465282, 496.6096712805812, 547.6765509457547, 354.14325037920383, 596.3331668718084, 658.2954070906278, 724.9059765580788, 469.4974134075501, 210.24677121271554, 166.6903687178999, 476.14235072279223, 295.0290231466312, 228.47274927282606, 515.0264413056611, 574.3210616560082, 493.03683837406453, 210.51750967002474, 582.9968133511019, 639.9370261186042, 630.0609338710242, 521.1019328631676, 262.57481159675564, 275.8521227641793, 501.7054844576204, 545.0052705500359, 294.42468029711694, 574.8072598786104, 194.6939120900002, 395.87142085561504, 638.8626950988522, 647.7889007018787, 307.39668753331733, 384.2370940458157, 572.1214013090722, 585.6443547672853, 534.2756883056968, 653.993108410472, 452.76652544231774, 231.17184776085443, 296.9051032648247, 628.3329816444946, 416.60716843025494, 568.2864177642867, 419.21922743686866, 196.18019120750932, 300.86312782698303, 264.676414411425, 564.4062321256661, 495.8234713067836, 584.8596643743819, 366.6694628610163, 549.6697901816949, 499.94276364124636, 0.0, 492.4888342647739, 616.9628409540185, 710.7754715128796, 418.32017509219196, 537.0646495697401, 270.47566848470217, 508.836600132942, 413.12275358324814, 644.9706055666127, 132.98560374036873, 543.7527889152217, 642.40627817508, 844.6510241496327, 127.86964612022521, 568.2263310021182, 457.51211750262934, 327.8194511484902, 271.98198252699603, 739.7806330871692, 550.0923390811104, 558.336282689466, 634.853319238076, 672.2678639301644, 339.9691137515376, 456.4994328118564, 559.8126391413988, 613.9208626534344, 159.36915062644402, 207.87244967355767, 321.8171460785022, 313.0132731535814, 156.41026474717896, 125.90591235975283, 627.6177552317237, 878.1855316569514, 605.9379170533456, 600.2600831892277, 274.25996954761035, 714.2269014589314, 229.47378503429505, 472.72876859703814, 609.4843165085142, 715.5822610271696, 498.21718381438393, 583.135520934775, 698.700522402588, 456.2920797188867, 400.08646940164357, 432.50027218954847, 568.0368264302039, 698.7161599297696, 507.05920842941134, 335.2907178010936, 470.78673148015866, 706.8897971545307, 759.5492764443294, 292.58384533236637, 671.260452807874, 580.8320104451291, 588.9858390973953, 494.09547878871234, 549.0154356245229, 626.2353138138136, 707.1427845784867, 660.6090685654513, 494.4735081913896, 498.39434050338724, 454.96359948886106, 478.33224213014927, 529.4433727599559, 718.1633422501718, 197.3487142765423, 609.4797983477338, 747.5035162956929, 367.8386412297784, 415.99189783136643, 832.983872549679, 742.4802066109505, 661.767358277254]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.9256384625441125, "mean_inference_ms": 4.387847338013514, "mean_action_processing_ms": 1.6298777061326613, "mean_env_wait_ms": 12.570638467577526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017338871955871582, "StateBufferConnector_ms": 0.004616260528564453, "ViewRequirementAgentConnector_ms": 0.1537858247756958}, "num_episodes": 10, "episode_return_max": 840.8174665572095, "episode_return_min": -59.355539261638405, "episode_return_mean": 229.15553739377495, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.31585193854556, "num_env_steps_trained_throughput_per_sec": 153.31585193854556, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1408000, "timers": {"training_iteration_time_ms": 25749.096, "restore_workers_time_ms": 0.026, "training_step_time_ms": 25748.685, "sample_time_ms": 2399.267, "learn_time_ms": 23323.511, "learn_throughput": 171.501, "synch_weights_time_ms": 21.302}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "done": false, "training_iteration": 88, "trial_id": "0b608_00000", "date": "2024-08-22_14-23-08", "timestamp": 1724316788, "time_this_iter_s": 26.14115881919861, "time_total_s": 2279.579991579056, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x178007430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2279.579991579056, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 33.045945945945945, "ram_util_percent": 82.93513513513514}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.986197501389437, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 6.864832877608204, "policy_loss": -0.009379449533544993, "vf_loss": 6.873492127877695, "vf_explained_var": 0.21518861818565893, "kl": 0.007201848276915453, "entropy": 0.3000756638232993, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 83633.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000576}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 43.57549207172696, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.646631783278531, "policy_loss": -0.009321073016334109, "vf_loss": 6.6540959519684, "vf_explained_var": 0.520528110183736, "kl": 0.009284442453029215, "entropy": 0.5649735737729955, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 83633.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000576}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "env_runners": {"episode_reward_max": 833.4208174852164, "episode_reward_min": -59.355539261638405, "episode_reward_mean": 229.4942809901148, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -956.4146587615866, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 381.63221038310354, "predator_policy": 878.1855316569514}, "policy_reward_mean": {"prey_policy": -375.254208456207, "predator_policy": 490.0013489512648}, "custom_metrics": {}, "hist_stats": {"episode_reward": [545.8975089296754, 219.80723289942912, 109.833300855867, 600.1862330898695, 442.7374469405456, -5.154924194328297, 501.0498905007937, 301.17427877241374, 388.93730072913155, 362.46399707234724, 124.467056271741, 320.25486808234746, -59.355539261638405, 339.73856467983524, 119.73952983087403, 186.37721678802262, 3.525905533251142, 307.2119909729557, 35.90000000000025, 429.4287922394224, 189.4367359872972, 149.73245712531167, 269.7483124050152, 144.54274661487418, 35.2663095505894, -49.52162595018278, 146.04836505799005, 702.3018772748302, 222.90695297947642, 330.6478877230726, 729.6506314863428, 324.3944388033403, 29.564410779054306, -17.002253791243383, 125.24179577706687, 93.77879647472116, -26.812175449274193, 3.100000000000003, 45.306779851791596, 301.09534108739734, 20.600000000000037, 244.75641282281924, 177.02956788621864, 18.767301115207356, 179.64113361405754, 8.00736728569236, 61.88893735103264, 381.3390114321732, 827.0617751799766, 447.4787772902522, 488.45493121381423, 26.079748472723022, 390.3445593081325, 6.611434972923239, 37.20000000000027, 146.5284498691776, 61.239216637950776, 585.1552574140626, 225.10969979268154, 151.55226294462196, 287.7884081798312, 355.2638284852742, 289.2473499681597, 205.29999999999822, 388.688129799277, 7.499999999999993, 24.40000000000002, 320.98685204185375, 281.87856524401167, 287.82343591178216, 8.820547036067257, 29.539660830605975, 440.7765995784656, 40.48888749540824, 12.748223573427438, 192.32076544706507, 458.06408481512995, 493.71777612981623, 72.46836911158509, 464.7976322322825, 197.20155729939694, 420.9334288900704, 30.30514987191758, 346.1065719925435, 526.4511637730735, 361.0942466332896, 165.63492471364094, 250.70244477548346, 98.70895599288208, 303.5683243881713, 833.4208174852164, 32.8000000000002, 30.440084327183893, 33.23416682320429, 18.07834002268785, 120.74749934888787, 106.388053604135, 47.0, 398.0667131686579, 457.43226089744945], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-886.3393030240085, 170.89736835597756, -333.38690983425187, -790.9809951571427, -65.49432499444328, -572.8869043195417, -628.2804401453834, 222.101267384457, 381.63221038310354, -37.193808524640936, -636.1827159880723, -799.2974372215065, -784.0294600506329, -29.418238554420128, -499.3524058582564, -219.40039305197254, -542.6684818851738, -5.625356192583315, -832.4308690319536, 186.99696252660695, -25.509701947187303, 35.39927197693339, -496.84054933607325, -32.79195170795579, -221.06936739269383, -642.0152834644357, -469.97987251178324, -164.8930037469667, -755.553120486779, -608.5153680287525, -255.983144131099, 52.083181055592846, -813.7046333895744, -546.5744969081156, 14.220097833235142, -843.2281567666264, -375.6900983999038, -272.791122343372, -112.34577492087777, -830.6334145022092, -279.44645454578523, -812.4581668349537, -346.8950951645421, -547.6586699364781, -49.2910519433719, -631.4370529026263, -479.21653078953966, -759.4421062442931, -454.14919588601157, -190.32867918366344, -443.71073980050517, -248.64360559037007, -271.9967900995919, -105.4566172618689, 302.07598953474087, -689.12161522158, -400.15736553143194, -80.49002953318119, -112.74869169852307, -779.5372600481094, -701.6803178265407, 280.16808257869235, -170.76033943333866, -43.27215612425678, -502.09592876217835, -515.0504154664231, -472.4703173583879, -413.76387660857984, -116.78266453184388, -348.54087263670027, -657.8367350013181, -535.0360643246925, -474.16850958229935, -244.2774474461081, -570.2214013090723, -584.4443547672851, -667.1740283369365, -475.78798852744296, 45.22824936495151, -428.0712814807237, -279.6051032648212, -625.0329816444939, -144.32866625390275, -595.8085071178223, -405.33206524241547, -33.03778551573792, -359.603845860745, -187.16839526245283, -584.7148048349819, -295.8737649834099, -573.7872150784407, -369.73454487126446, -599.512617916398, -388.21099855550966, -377.16986212824355, 266.0200392956433, -709.6026430714359, 208.92610578451786, -419.41671225030376, -88.48933512137705, -623.2304611631224, 332.37312375929235, -562.0868233021012, -469.92678737503695, -585.8725876765936, 299.4787543291357, -639.999303158137, -840.4465641936523, -92.66964612022672, -566.2263310021182, -32.334454008492294, -606.4686647734474, -705.0792063458517, -245.44419263036175, -586.1081138414415, 62.834749484927755, -471.2237873266476, -610.7876960489042, -585.7904082165716, -59.12587540220005, -653.3356669283751, -232.60942668662926, 163.56283491944794, -175.5406067341797, -85.02436888595369, -260.55870037796967, -10.36280632046527, -66.65337078646718, -234.83182009377896, -882.2833369956195, -605.8379170533456, -592.860083189226, -249.85996954761177, -714.2269014589314, -330.3507988055026, -50.864902783971786, -268.68154544557393, -774.5064668460985, -344.70868118471407, -448.8205876526608, -610.8520709786752, -535.3199841067321, -380.304715423721, -422.74236533685973, -104.42612658147291, -721.5502602000367, -479.86496184585593, -321.9960768892353, -458.4385079067294, -706.4897971545306, -269.9215536704036, -589.8908026592271, -725.5985006229329, -68.42987781494358, -564.8201918918706, -24.54334986442032, -604.6763687905802, -498.10601153617, -417.18370336347556, -485.7705175481807, -311.92248434116726, -483.74380705421294, -551.4581411911132, 39.095728462173184, -499.6372934721561, -717.664271666053, -500.5394571956742, 39.8175165639411, -828.7128789764593, 239.82188522406693, 12.923523001501481, -900.8050467492574, -557.6631045753849, -680.9495355991751, -280.6212794198724, -671.4451835313533, -512.8398930131004, -23.755226223640168, 131.86636344782542, -802.5743194492269, 221.51339367011133, -744.5078091099042, -403.1024737336168, -274.004391139391, -193.86709186782798, -535.5768128833324, -326.9537634546257, -365.6351254609156, -439.2215135033711, -470.3704971241482, -490.2965725245209, -192.13017003787624, -387.4514035923632, -956.4146587615866, -569.3823401097079, -451.1677642022607, -552.4960934540403, -165.05010194849373, -38.37559180313976, -852.7403179285659], "policy_predator_policy_reward": [816.1566730006596, 445.1827705970485, 587.5869609819395, 756.5881769088876, 480.9236006226976, 267.2909295471549, 541.3760027196771, 464.9894031311192, 70.39473362341666, 27.90431145866343, 629.5547143116918, 800.7705147035595, 763.4452831825741, 551.052305923268, 503.763139382659, 516.1639382999793, 553.9440458709996, 383.28709293588565, 420.6207980118912, 587.2771055658047, 60.11610775947025, 54.46137848252865, 458.7690946140422, 391.1182745123347, 180.66974382705268, 623.0593677684382, 371.00967403708796, 603.6017669014984, 826.6529951605391, 657.1550231858672, 376.8491866294866, 13.427993234048339, 601.5675582782052, 762.2374775527402, 454.73368141943445, 681.4863684869113, 394.6900983999081, 289.6911223433744, 565.4953826643606, 806.9125989981476, 468.97943532150987, 812.3619220465282, 496.6096712805812, 547.6765509457547, 354.14325037920383, 596.3331668718084, 658.2954070906278, 724.9059765580788, 469.4974134075501, 210.24677121271554, 166.6903687178999, 476.14235072279223, 295.0290231466312, 228.47274927282606, 515.0264413056611, 574.3210616560082, 493.03683837406453, 210.51750967002474, 582.9968133511019, 639.9370261186042, 630.0609338710242, 521.1019328631676, 262.57481159675564, 275.8521227641793, 501.7054844576204, 545.0052705500359, 294.42468029711694, 574.8072598786104, 194.6939120900002, 395.87142085561504, 638.8626950988522, 647.7889007018787, 307.39668753331733, 384.2370940458157, 572.1214013090722, 585.6443547672853, 534.2756883056968, 653.993108410472, 452.76652544231774, 231.17184776085443, 296.9051032648247, 628.3329816444946, 416.60716843025494, 568.2864177642867, 419.21922743686866, 196.18019120750932, 300.86312782698303, 264.676414411425, 564.4062321256661, 495.8234713067836, 584.8596643743819, 366.6694628610163, 549.6697901816949, 499.94276364124636, 0.0, 492.4888342647739, 616.9628409540185, 710.7754715128796, 418.32017509219196, 537.0646495697401, 270.47566848470217, 508.836600132942, 413.12275358324814, 644.9706055666127, 132.98560374036873, 543.7527889152217, 642.40627817508, 844.6510241496327, 127.86964612022521, 568.2263310021182, 457.51211750262934, 327.8194511484902, 271.98198252699603, 739.7806330871692, 550.0923390811104, 558.336282689466, 634.853319238076, 672.2678639301644, 339.9691137515376, 456.4994328118564, 559.8126391413988, 613.9208626534344, 159.36915062644402, 207.87244967355767, 321.8171460785022, 313.0132731535814, 156.41026474717896, 125.90591235975283, 627.6177552317237, 878.1855316569514, 605.9379170533456, 600.2600831892277, 274.25996954761035, 714.2269014589314, 229.47378503429505, 472.72876859703814, 609.4843165085142, 715.5822610271696, 498.21718381438393, 583.135520934775, 698.700522402588, 456.2920797188867, 400.08646940164357, 432.50027218954847, 568.0368264302039, 698.7161599297696, 507.05920842941134, 335.2907178010936, 470.78673148015866, 706.8897971545307, 759.5492764443294, 292.58384533236637, 671.260452807874, 580.8320104451291, 588.9858390973953, 494.09547878871234, 549.0154356245229, 626.2353138138136, 707.1427845784867, 660.6090685654513, 494.4735081913896, 498.39434050338724, 454.96359948886106, 478.33224213014927, 529.4433727599559, 718.1633422501718, 197.3487142765423, 609.4797983477338, 747.5035162956929, 367.8386412297784, 415.99189783136643, 832.983872549679, 742.4802066109505, 661.767358277254, 524.3202846001127, 678.448623126598, 628.2851227931975, 7.018952436429344, 791.2822313872085, 182.99404900236422, 719.1746833989581, 637.2405495260526, 413.8024737336191, 296.10439113939594, 214.38022050461169, 545.5037685737321, 344.6164415798113, 381.20661415894136, 450.2153304586374, 477.4550201915727, 589.2824464081104, 213.891795503173, 873.0538307146054, 577.2002852434831, 571.8823401097079, 495.66776420226034, 535.9461049281999, 579.6668036429867, 632.5387647403801, 716.0094058887739]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.9210297637752305, "mean_inference_ms": 4.409549601123903, "mean_action_processing_ms": 1.6290777317819494, "mean_env_wait_ms": 12.59119512366265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018415331840515137, "StateBufferConnector_ms": 0.009408116340637207, "ViewRequirementAgentConnector_ms": 0.2357773780822754}, "num_episodes": 13, "episode_return_max": 833.4208174852164, "episode_return_min": -59.355539261638405, "episode_return_mean": 229.4942809901148, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 150.26030693440822, "num_env_steps_trained_throughput_per_sec": 150.26030693440822, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 1424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1424000, "timers": {"training_iteration_time_ms": 25809.47, "restore_workers_time_ms": 0.025, "training_step_time_ms": 25809.205, "sample_time_ms": 2506.292, "learn_time_ms": 23277.955, "learn_throughput": 171.836, "synch_weights_time_ms": 20.945}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "done": false, "training_iteration": 89, "trial_id": "0b608_00000", "date": "2024-08-22_14-23-34", "timestamp": 1724316814, "time_this_iter_s": 26.68238401412964, "time_total_s": 2306.2623755931854, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30e476310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2306.2623755931854, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 33.87105263157895, "ram_util_percent": 83.18157894736841}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.70208611160359, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.633091158084769, "policy_loss": -0.005891922674334002, "vf_loss": 7.638390349837207, "vf_explained_var": 0.03989888587325969, "kl": 0.005927093660153409, "entropy": 0.2671259107097747, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84578.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000576}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.132806237790952, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.416609601116685, "policy_loss": -0.00868461250362021, "vf_loss": 7.423392182809335, "vf_explained_var": 0.36127466007515235, "kl": 0.009510237934738004, "entropy": 0.5291283411639077, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84578.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000576}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 833.4208174852164, "episode_reward_min": -59.355539261638405, "episode_reward_mean": 217.48082114389763, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -956.4146587615866, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 332.37312375929235, "predator_policy": 878.1855316569514}, "policy_reward_mean": {"prey_policy": -388.4183706565798, "predator_policy": 497.1587812285291}, "custom_metrics": {}, "hist_stats": {"episode_reward": [320.25486808234746, -59.355539261638405, 339.73856467983524, 119.73952983087403, 186.37721678802262, 3.525905533251142, 307.2119909729557, 35.90000000000025, 429.4287922394224, 189.4367359872972, 149.73245712531167, 269.7483124050152, 144.54274661487418, 35.2663095505894, -49.52162595018278, 146.04836505799005, 702.3018772748302, 222.90695297947642, 330.6478877230726, 729.6506314863428, 324.3944388033403, 29.564410779054306, -17.002253791243383, 125.24179577706687, 93.77879647472116, -26.812175449274193, 3.100000000000003, 45.306779851791596, 301.09534108739734, 20.600000000000037, 244.75641282281924, 177.02956788621864, 18.767301115207356, 179.64113361405754, 8.00736728569236, 61.88893735103264, 381.3390114321732, 827.0617751799766, 447.4787772902522, 488.45493121381423, 26.079748472723022, 390.3445593081325, 6.611434972923239, 37.20000000000027, 146.5284498691776, 61.239216637950776, 585.1552574140626, 225.10969979268154, 151.55226294462196, 287.7884081798312, 355.2638284852742, 289.2473499681597, 205.29999999999822, 388.688129799277, 7.499999999999993, 24.40000000000002, 320.98685204185375, 281.87856524401167, 287.82343591178216, 8.820547036067257, 29.539660830605975, 440.7765995784656, 40.48888749540824, 12.748223573427438, 192.32076544706507, 458.06408481512995, 493.71777612981623, 72.46836911158509, 464.7976322322825, 197.20155729939694, 420.9334288900704, 30.30514987191758, 346.1065719925435, 526.4511637730735, 361.0942466332896, 165.63492471364094, 250.70244477548346, 98.70895599288208, 303.5683243881713, 833.4208174852164, 32.8000000000002, 30.440084327183893, 33.23416682320429, 18.07834002268785, 120.74749934888787, 106.388053604135, 47.0, 398.0667131686579, 457.43226089744945, 237.6522230529728, 89.66416877145984, 380.21609707477285, 116.60461759610301, 356.96176451635336, 12.070607115960263, 461.4601115284464, 0.9280325111852694, -37.15081477260557, 21.889802674234076, 749.756727176885], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-496.84054933607325, -32.79195170795579, -221.06936739269383, -642.0152834644357, -469.97987251178324, -164.8930037469667, -755.553120486779, -608.5153680287525, -255.983144131099, 52.083181055592846, -813.7046333895744, -546.5744969081156, 14.220097833235142, -843.2281567666264, -375.6900983999038, -272.791122343372, -112.34577492087777, -830.6334145022092, -279.44645454578523, -812.4581668349537, -346.8950951645421, -547.6586699364781, -49.2910519433719, -631.4370529026263, -479.21653078953966, -759.4421062442931, -454.14919588601157, -190.32867918366344, -443.71073980050517, -248.64360559037007, -271.9967900995919, -105.4566172618689, 302.07598953474087, -689.12161522158, -400.15736553143194, -80.49002953318119, -112.74869169852307, -779.5372600481094, -701.6803178265407, 280.16808257869235, -170.76033943333866, -43.27215612425678, -502.09592876217835, -515.0504154664231, -472.4703173583879, -413.76387660857984, -116.78266453184388, -348.54087263670027, -657.8367350013181, -535.0360643246925, -474.16850958229935, -244.2774474461081, -570.2214013090723, -584.4443547672851, -667.1740283369365, -475.78798852744296, 45.22824936495151, -428.0712814807237, -279.6051032648212, -625.0329816444939, -144.32866625390275, -595.8085071178223, -405.33206524241547, -33.03778551573792, -359.603845860745, -187.16839526245283, -584.7148048349819, -295.8737649834099, -573.7872150784407, -369.73454487126446, -599.512617916398, -388.21099855550966, -377.16986212824355, 266.0200392956433, -709.6026430714359, 208.92610578451786, -419.41671225030376, -88.48933512137705, -623.2304611631224, 332.37312375929235, -562.0868233021012, -469.92678737503695, -585.8725876765936, 299.4787543291357, -639.999303158137, -840.4465641936523, -92.66964612022672, -566.2263310021182, -32.334454008492294, -606.4686647734474, -705.0792063458517, -245.44419263036175, -586.1081138414415, 62.834749484927755, -471.2237873266476, -610.7876960489042, -585.7904082165716, -59.12587540220005, -653.3356669283751, -232.60942668662926, 163.56283491944794, -175.5406067341797, -85.02436888595369, -260.55870037796967, -10.36280632046527, -66.65337078646718, -234.83182009377896, -882.2833369956195, -605.8379170533456, -592.860083189226, -249.85996954761177, -714.2269014589314, -330.3507988055026, -50.864902783971786, -268.68154544557393, -774.5064668460985, -344.70868118471407, -448.8205876526608, -610.8520709786752, -535.3199841067321, -380.304715423721, -422.74236533685973, -104.42612658147291, -721.5502602000367, -479.86496184585593, -321.9960768892353, -458.4385079067294, -706.4897971545306, -269.9215536704036, -589.8908026592271, -725.5985006229329, -68.42987781494358, -564.8201918918706, -24.54334986442032, -604.6763687905802, -498.10601153617, -417.18370336347556, -485.7705175481807, -311.92248434116726, -483.74380705421294, -551.4581411911132, 39.095728462173184, -499.6372934721561, -717.664271666053, -500.5394571956742, 39.8175165639411, -828.7128789764593, 239.82188522406693, 12.923523001501481, -900.8050467492574, -557.6631045753849, -680.9495355991751, -280.6212794198724, -671.4451835313533, -512.8398930131004, -23.755226223640168, 131.86636344782542, -802.5743194492269, 221.51339367011133, -744.5078091099042, -403.1024737336168, -274.004391139391, -193.86709186782798, -535.5768128833324, -326.9537634546257, -365.6351254609156, -439.2215135033711, -470.3704971241482, -490.2965725245209, -192.13017003787624, -387.4514035923632, -956.4146587615866, -569.3823401097079, -451.1677642022607, -552.4960934540403, -165.05010194849373, -38.37559180313976, -852.7403179285659, -42.218446190981744, -363.9694534035738, -877.8981279973016, -79.83010588013858, -638.0744318671817, -90.25122811506225, -470.69757493923606, -499.8580345579314, -321.64025822456426, -156.26975229740412, -364.00605874955943, -311.42276441639825, -793.0510492616099, -26.659481368807796, -782.358996174104, -620.2776218528737, -608.6688993029724, -515.5160759364155, -669.6772790282708, -668.1926396518012, 244.44665838230466, -668.1914843947711], "policy_predator_policy_reward": [458.7690946140422, 391.1182745123347, 180.66974382705268, 623.0593677684382, 371.00967403708796, 603.6017669014984, 826.6529951605391, 657.1550231858672, 376.8491866294866, 13.427993234048339, 601.5675582782052, 762.2374775527402, 454.73368141943445, 681.4863684869113, 394.6900983999081, 289.6911223433744, 565.4953826643606, 806.9125989981476, 468.97943532150987, 812.3619220465282, 496.6096712805812, 547.6765509457547, 354.14325037920383, 596.3331668718084, 658.2954070906278, 724.9059765580788, 469.4974134075501, 210.24677121271554, 166.6903687178999, 476.14235072279223, 295.0290231466312, 228.47274927282606, 515.0264413056611, 574.3210616560082, 493.03683837406453, 210.51750967002474, 582.9968133511019, 639.9370261186042, 630.0609338710242, 521.1019328631676, 262.57481159675564, 275.8521227641793, 501.7054844576204, 545.0052705500359, 294.42468029711694, 574.8072598786104, 194.6939120900002, 395.87142085561504, 638.8626950988522, 647.7889007018787, 307.39668753331733, 384.2370940458157, 572.1214013090722, 585.6443547672853, 534.2756883056968, 653.993108410472, 452.76652544231774, 231.17184776085443, 296.9051032648247, 628.3329816444946, 416.60716843025494, 568.2864177642867, 419.21922743686866, 196.18019120750932, 300.86312782698303, 264.676414411425, 564.4062321256661, 495.8234713067836, 584.8596643743819, 366.6694628610163, 549.6697901816949, 499.94276364124636, 0.0, 492.4888342647739, 616.9628409540185, 710.7754715128796, 418.32017509219196, 537.0646495697401, 270.47566848470217, 508.836600132942, 413.12275358324814, 644.9706055666127, 132.98560374036873, 543.7527889152217, 642.40627817508, 844.6510241496327, 127.86964612022521, 568.2263310021182, 457.51211750262934, 327.8194511484902, 271.98198252699603, 739.7806330871692, 550.0923390811104, 558.336282689466, 634.853319238076, 672.2678639301644, 339.9691137515376, 456.4994328118564, 559.8126391413988, 613.9208626534344, 159.36915062644402, 207.87244967355767, 321.8171460785022, 313.0132731535814, 156.41026474717896, 125.90591235975283, 627.6177552317237, 878.1855316569514, 605.9379170533456, 600.2600831892277, 274.25996954761035, 714.2269014589314, 229.47378503429505, 472.72876859703814, 609.4843165085142, 715.5822610271696, 498.21718381438393, 583.135520934775, 698.700522402588, 456.2920797188867, 400.08646940164357, 432.50027218954847, 568.0368264302039, 698.7161599297696, 507.05920842941134, 335.2907178010936, 470.78673148015866, 706.8897971545307, 759.5492764443294, 292.58384533236637, 671.260452807874, 580.8320104451291, 588.9858390973953, 494.09547878871234, 549.0154356245229, 626.2353138138136, 707.1427845784867, 660.6090685654513, 494.4735081913896, 498.39434050338724, 454.96359948886106, 478.33224213014927, 529.4433727599559, 718.1633422501718, 197.3487142765423, 609.4797983477338, 747.5035162956929, 367.8386412297784, 415.99189783136643, 832.983872549679, 742.4802066109505, 661.767358277254, 524.3202846001127, 678.448623126598, 628.2851227931975, 7.018952436429344, 791.2822313872085, 182.99404900236422, 719.1746833989581, 637.2405495260526, 413.8024737336191, 296.10439113939594, 214.38022050461169, 545.5037685737321, 344.6164415798113, 381.20661415894136, 450.2153304586374, 477.4550201915727, 589.2824464081104, 213.891795503173, 873.0538307146054, 577.2002852434831, 571.8823401097079, 495.66776420226034, 535.9461049281999, 579.6668036429867, 632.5387647403801, 716.0094058887739, 369.8528673866525, 273.9872552608758, 858.5803582623976, 188.81204438650056, 571.3067673959524, 537.234989661061, 511.6117641063313, 575.5484629869428, 440.37877823933604, 394.49299679898286, 397.03226219775166, 290.4671680841686, 735.2097289245221, 545.9609132343392, 782.358996174104, 621.205654364059, 449.59199106033606, 637.4421694064459, 714.5221508814922, 645.2375704728134, 554.2529986358857, 619.2485545534649]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.919407953236333, "mean_inference_ms": 4.401353733629457, "mean_action_processing_ms": 1.6420040677016072, "mean_env_wait_ms": 12.595699137886779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018010377883911133, "StateBufferConnector_ms": 0.00934755802154541, "ViewRequirementAgentConnector_ms": 0.23317480087280273}, "num_episodes": 11, "episode_return_max": 833.4208174852164, "episode_return_min": -59.355539261638405, "episode_return_mean": 217.48082114389763, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.17243526998294, "num_env_steps_trained_throughput_per_sec": 154.17243526998294, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 25830.594, "restore_workers_time_ms": 0.024, "training_step_time_ms": 25830.33, "sample_time_ms": 2532.15, "learn_time_ms": 23273.668, "learn_throughput": 171.868, "synch_weights_time_ms": 20.642}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 90, "trial_id": "0b608_00000", "date": "2024-08-22_14-24-00", "timestamp": 1724316840, "time_this_iter_s": 25.992985248565674, "time_total_s": 2332.255360841751, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a3c3ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2332.255360841751, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 33.349999999999994, "ram_util_percent": 83.03055555555557}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.274188191802413, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.261250363708173, "policy_loss": -0.010869967443227926, "vf_loss": 7.271498509563466, "vf_explained_var": 0.19976439211103653, "kl": 0.00621826762565111, "entropy": 0.2629246097077768, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85523.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.72393665162344, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.109082271939232, "policy_loss": -0.00881957364953542, "vf_loss": 7.116195518251449, "vf_explained_var": 0.3622559669787291, "kl": 0.008531588454430222, "entropy": 0.5363902405771629, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85523.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "env_runners": {"episode_reward_max": 833.4208174852164, "episode_reward_min": -49.52162595018278, "episode_reward_mean": 229.3338928181094, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -956.4146587615866, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 332.37312375929235, "predator_policy": 878.1855316569514}, "policy_reward_mean": {"prey_policy": -387.842306257614, "predator_policy": 502.5092526666692}, "custom_metrics": {}, "hist_stats": {"episode_reward": [429.4287922394224, 189.4367359872972, 149.73245712531167, 269.7483124050152, 144.54274661487418, 35.2663095505894, -49.52162595018278, 146.04836505799005, 702.3018772748302, 222.90695297947642, 330.6478877230726, 729.6506314863428, 324.3944388033403, 29.564410779054306, -17.002253791243383, 125.24179577706687, 93.77879647472116, -26.812175449274193, 3.100000000000003, 45.306779851791596, 301.09534108739734, 20.600000000000037, 244.75641282281924, 177.02956788621864, 18.767301115207356, 179.64113361405754, 8.00736728569236, 61.88893735103264, 381.3390114321732, 827.0617751799766, 447.4787772902522, 488.45493121381423, 26.079748472723022, 390.3445593081325, 6.611434972923239, 37.20000000000027, 146.5284498691776, 61.239216637950776, 585.1552574140626, 225.10969979268154, 151.55226294462196, 287.7884081798312, 355.2638284852742, 289.2473499681597, 205.29999999999822, 388.688129799277, 7.499999999999993, 24.40000000000002, 320.98685204185375, 281.87856524401167, 287.82343591178216, 8.820547036067257, 29.539660830605975, 440.7765995784656, 40.48888749540824, 12.748223573427438, 192.32076544706507, 458.06408481512995, 493.71777612981623, 72.46836911158509, 464.7976322322825, 197.20155729939694, 420.9334288900704, 30.30514987191758, 346.1065719925435, 526.4511637730735, 361.0942466332896, 165.63492471364094, 250.70244477548346, 98.70895599288208, 303.5683243881713, 833.4208174852164, 32.8000000000002, 30.440084327183893, 33.23416682320429, 18.07834002268785, 120.74749934888787, 106.388053604135, 47.0, 398.0667131686579, 457.43226089744945, 237.6522230529728, 89.66416877145984, 380.21609707477285, 116.60461759610301, 356.96176451635336, 12.070607115960263, 461.4601115284464, 0.9280325111852694, -37.15081477260557, 21.889802674234076, 749.756727176885, 649.876148415349, 777.7494449470844, -16.259357922290413, 210.01621247691804, 84.24948963797699, 260.09052746125076, 85.03866993651307, 387.93856909402973], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-112.34577492087777, -830.6334145022092, -279.44645454578523, -812.4581668349537, -346.8950951645421, -547.6586699364781, -49.2910519433719, -631.4370529026263, -479.21653078953966, -759.4421062442931, -454.14919588601157, -190.32867918366344, -443.71073980050517, -248.64360559037007, -271.9967900995919, -105.4566172618689, 302.07598953474087, -689.12161522158, -400.15736553143194, -80.49002953318119, -112.74869169852307, -779.5372600481094, -701.6803178265407, 280.16808257869235, -170.76033943333866, -43.27215612425678, -502.09592876217835, -515.0504154664231, -472.4703173583879, -413.76387660857984, -116.78266453184388, -348.54087263670027, -657.8367350013181, -535.0360643246925, -474.16850958229935, -244.2774474461081, -570.2214013090723, -584.4443547672851, -667.1740283369365, -475.78798852744296, 45.22824936495151, -428.0712814807237, -279.6051032648212, -625.0329816444939, -144.32866625390275, -595.8085071178223, -405.33206524241547, -33.03778551573792, -359.603845860745, -187.16839526245283, -584.7148048349819, -295.8737649834099, -573.7872150784407, -369.73454487126446, -599.512617916398, -388.21099855550966, -377.16986212824355, 266.0200392956433, -709.6026430714359, 208.92610578451786, -419.41671225030376, -88.48933512137705, -623.2304611631224, 332.37312375929235, -562.0868233021012, -469.92678737503695, -585.8725876765936, 299.4787543291357, -639.999303158137, -840.4465641936523, -92.66964612022672, -566.2263310021182, -32.334454008492294, -606.4686647734474, -705.0792063458517, -245.44419263036175, -586.1081138414415, 62.834749484927755, -471.2237873266476, -610.7876960489042, -585.7904082165716, -59.12587540220005, -653.3356669283751, -232.60942668662926, 163.56283491944794, -175.5406067341797, -85.02436888595369, -260.55870037796967, -10.36280632046527, -66.65337078646718, -234.83182009377896, -882.2833369956195, -605.8379170533456, -592.860083189226, -249.85996954761177, -714.2269014589314, -330.3507988055026, -50.864902783971786, -268.68154544557393, -774.5064668460985, -344.70868118471407, -448.8205876526608, -610.8520709786752, -535.3199841067321, -380.304715423721, -422.74236533685973, -104.42612658147291, -721.5502602000367, -479.86496184585593, -321.9960768892353, -458.4385079067294, -706.4897971545306, -269.9215536704036, -589.8908026592271, -725.5985006229329, -68.42987781494358, -564.8201918918706, -24.54334986442032, -604.6763687905802, -498.10601153617, -417.18370336347556, -485.7705175481807, -311.92248434116726, -483.74380705421294, -551.4581411911132, 39.095728462173184, -499.6372934721561, -717.664271666053, -500.5394571956742, 39.8175165639411, -828.7128789764593, 239.82188522406693, 12.923523001501481, -900.8050467492574, -557.6631045753849, -680.9495355991751, -280.6212794198724, -671.4451835313533, -512.8398930131004, -23.755226223640168, 131.86636344782542, -802.5743194492269, 221.51339367011133, -744.5078091099042, -403.1024737336168, -274.004391139391, -193.86709186782798, -535.5768128833324, -326.9537634546257, -365.6351254609156, -439.2215135033711, -470.3704971241482, -490.2965725245209, -192.13017003787624, -387.4514035923632, -956.4146587615866, -569.3823401097079, -451.1677642022607, -552.4960934540403, -165.05010194849373, -38.37559180313976, -852.7403179285659, -42.218446190981744, -363.9694534035738, -877.8981279973016, -79.83010588013858, -638.0744318671817, -90.25122811506225, -470.69757493923606, -499.8580345579314, -321.64025822456426, -156.26975229740412, -364.00605874955943, -311.42276441639825, -793.0510492616099, -26.659481368807796, -782.358996174104, -620.2776218528737, -608.6688993029724, -515.5160759364155, -669.6772790282708, -668.1926396518012, 244.44665838230466, -668.1914843947711, 45.34276721244022, -803.8815924601322, -705.7326971838017, 201.1262060449566, -196.84753806049127, -274.8067193203191, -782.7308375212922, -95.59886432759507, -289.62739555218053, -515.3593522570314, -462.3323293784305, -351.03750111288673, -730.5222921365448, -428.6815441107191, -339.6730615322919, -587.7512582358294], "policy_predator_policy_reward": [565.4953826643606, 806.9125989981476, 468.97943532150987, 812.3619220465282, 496.6096712805812, 547.6765509457547, 354.14325037920383, 596.3331668718084, 658.2954070906278, 724.9059765580788, 469.4974134075501, 210.24677121271554, 166.6903687178999, 476.14235072279223, 295.0290231466312, 228.47274927282606, 515.0264413056611, 574.3210616560082, 493.03683837406453, 210.51750967002474, 582.9968133511019, 639.9370261186042, 630.0609338710242, 521.1019328631676, 262.57481159675564, 275.8521227641793, 501.7054844576204, 545.0052705500359, 294.42468029711694, 574.8072598786104, 194.6939120900002, 395.87142085561504, 638.8626950988522, 647.7889007018787, 307.39668753331733, 384.2370940458157, 572.1214013090722, 585.6443547672853, 534.2756883056968, 653.993108410472, 452.76652544231774, 231.17184776085443, 296.9051032648247, 628.3329816444946, 416.60716843025494, 568.2864177642867, 419.21922743686866, 196.18019120750932, 300.86312782698303, 264.676414411425, 564.4062321256661, 495.8234713067836, 584.8596643743819, 366.6694628610163, 549.6697901816949, 499.94276364124636, 0.0, 492.4888342647739, 616.9628409540185, 710.7754715128796, 418.32017509219196, 537.0646495697401, 270.47566848470217, 508.836600132942, 413.12275358324814, 644.9706055666127, 132.98560374036873, 543.7527889152217, 642.40627817508, 844.6510241496327, 127.86964612022521, 568.2263310021182, 457.51211750262934, 327.8194511484902, 271.98198252699603, 739.7806330871692, 550.0923390811104, 558.336282689466, 634.853319238076, 672.2678639301644, 339.9691137515376, 456.4994328118564, 559.8126391413988, 613.9208626534344, 159.36915062644402, 207.87244967355767, 321.8171460785022, 313.0132731535814, 156.41026474717896, 125.90591235975283, 627.6177552317237, 878.1855316569514, 605.9379170533456, 600.2600831892277, 274.25996954761035, 714.2269014589314, 229.47378503429505, 472.72876859703814, 609.4843165085142, 715.5822610271696, 498.21718381438393, 583.135520934775, 698.700522402588, 456.2920797188867, 400.08646940164357, 432.50027218954847, 568.0368264302039, 698.7161599297696, 507.05920842941134, 335.2907178010936, 470.78673148015866, 706.8897971545307, 759.5492764443294, 292.58384533236637, 671.260452807874, 580.8320104451291, 588.9858390973953, 494.09547878871234, 549.0154356245229, 626.2353138138136, 707.1427845784867, 660.6090685654513, 494.4735081913896, 498.39434050338724, 454.96359948886106, 478.33224213014927, 529.4433727599559, 718.1633422501718, 197.3487142765423, 609.4797983477338, 747.5035162956929, 367.8386412297784, 415.99189783136643, 832.983872549679, 742.4802066109505, 661.767358277254, 524.3202846001127, 678.448623126598, 628.2851227931975, 7.018952436429344, 791.2822313872085, 182.99404900236422, 719.1746833989581, 637.2405495260526, 413.8024737336191, 296.10439113939594, 214.38022050461169, 545.5037685737321, 344.6164415798113, 381.20661415894136, 450.2153304586374, 477.4550201915727, 589.2824464081104, 213.891795503173, 873.0538307146054, 577.2002852434831, 571.8823401097079, 495.66776420226034, 535.9461049281999, 579.6668036429867, 632.5387647403801, 716.0094058887739, 369.8528673866525, 273.9872552608758, 858.5803582623976, 188.81204438650056, 571.3067673959524, 537.234989661061, 511.6117641063313, 575.5484629869428, 440.37877823933604, 394.49299679898286, 397.03226219775166, 290.4671680841686, 735.2097289245221, 545.9609132343392, 782.358996174104, 621.205654364059, 449.59199106033606, 637.4421694064459, 714.5221508814922, 645.2375704728134, 554.2529986358857, 619.2485545534649, 741.7635181708084, 666.6514554922345, 586.1996704878153, 696.1562655981141, 232.36908001159196, 223.02581944692642, 784.0317571205215, 304.3141572052837, 588.6385391980244, 300.59769824916714, 506.8252810845413, 566.6350768680325, 592.5669631342279, 651.6755430495542, 690.4035671319581, 624.9593217301962]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.933091512909118, "mean_inference_ms": 4.399509588294395, "mean_action_processing_ms": 1.6334139087313664, "mean_env_wait_ms": 12.610852723204227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018032193183898926, "StateBufferConnector_ms": 0.009389638900756836, "ViewRequirementAgentConnector_ms": 0.23661649227142334}, "num_episodes": 8, "episode_return_max": 833.4208174852164, "episode_return_min": -49.52162595018278, "episode_return_mean": 229.3338928181094, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 151.51284399122807, "num_env_steps_trained_throughput_per_sec": 151.51284399122807, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 1456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1456000, "timers": {"training_iteration_time_ms": 25906.853, "restore_workers_time_ms": 0.024, "training_step_time_ms": 25906.589, "sample_time_ms": 2569.813, "learn_time_ms": 23312.301, "learn_throughput": 171.583, "synch_weights_time_ms": 20.623}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "done": false, "training_iteration": 91, "trial_id": "0b608_00000", "date": "2024-08-22_14-24-27", "timestamp": 1724316867, "time_this_iter_s": 26.479854106903076, "time_total_s": 2358.735214948654, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a370670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2358.735214948654, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 34.268421052631574, "ram_util_percent": 82.91842105263159}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.736692468956033, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.428684514666361, "policy_loss": -0.01187251075885441, "vf_loss": 7.439866701257292, "vf_explained_var": 0.1556868389800743, "kl": 0.006903041445738858, "entropy": 0.27120128130471266, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 86468.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 44.314699499947686, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.011796052619894, "policy_loss": -0.009566953594096636, "vf_loss": 7.019817637388037, "vf_explained_var": 0.47984614157802846, "kl": 0.007726822660437652, "entropy": 0.5725733403490965, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 86468.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "env_runners": {"episode_reward_max": 833.4208174852164, "episode_reward_min": -45.733594767847094, "episode_reward_mean": 230.44953541680675, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -956.4146587615866, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 332.37312375929235, "predator_policy": 878.1855316569514}, "policy_reward_mean": {"prey_policy": -375.85796736444865, "predator_policy": 491.0827350728525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [146.04836505799005, 702.3018772748302, 222.90695297947642, 330.6478877230726, 729.6506314863428, 324.3944388033403, 29.564410779054306, -17.002253791243383, 125.24179577706687, 93.77879647472116, -26.812175449274193, 3.100000000000003, 45.306779851791596, 301.09534108739734, 20.600000000000037, 244.75641282281924, 177.02956788621864, 18.767301115207356, 179.64113361405754, 8.00736728569236, 61.88893735103264, 381.3390114321732, 827.0617751799766, 447.4787772902522, 488.45493121381423, 26.079748472723022, 390.3445593081325, 6.611434972923239, 37.20000000000027, 146.5284498691776, 61.239216637950776, 585.1552574140626, 225.10969979268154, 151.55226294462196, 287.7884081798312, 355.2638284852742, 289.2473499681597, 205.29999999999822, 388.688129799277, 7.499999999999993, 24.40000000000002, 320.98685204185375, 281.87856524401167, 287.82343591178216, 8.820547036067257, 29.539660830605975, 440.7765995784656, 40.48888749540824, 12.748223573427438, 192.32076544706507, 458.06408481512995, 493.71777612981623, 72.46836911158509, 464.7976322322825, 197.20155729939694, 420.9334288900704, 30.30514987191758, 346.1065719925435, 526.4511637730735, 361.0942466332896, 165.63492471364094, 250.70244477548346, 98.70895599288208, 303.5683243881713, 833.4208174852164, 32.8000000000002, 30.440084327183893, 33.23416682320429, 18.07834002268785, 120.74749934888787, 106.388053604135, 47.0, 398.0667131686579, 457.43226089744945, 237.6522230529728, 89.66416877145984, 380.21609707477285, 116.60461759610301, 356.96176451635336, 12.070607115960263, 461.4601115284464, 0.9280325111852694, -37.15081477260557, 21.889802674234076, 749.756727176885, 649.876148415349, 777.7494449470844, -16.259357922290413, 210.01621247691804, 84.24948963797699, 260.09052746125076, 85.03866993651307, 387.93856909402973, 126.56260551342484, -10.70827807964974, 153.423305376532, 313.6586510660095, -45.733594767847094, 663.8413801367099, 79.15391859687948], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-271.9967900995919, -105.4566172618689, 302.07598953474087, -689.12161522158, -400.15736553143194, -80.49002953318119, -112.74869169852307, -779.5372600481094, -701.6803178265407, 280.16808257869235, -170.76033943333866, -43.27215612425678, -502.09592876217835, -515.0504154664231, -472.4703173583879, -413.76387660857984, -116.78266453184388, -348.54087263670027, -657.8367350013181, -535.0360643246925, -474.16850958229935, -244.2774474461081, -570.2214013090723, -584.4443547672851, -667.1740283369365, -475.78798852744296, 45.22824936495151, -428.0712814807237, -279.6051032648212, -625.0329816444939, -144.32866625390275, -595.8085071178223, -405.33206524241547, -33.03778551573792, -359.603845860745, -187.16839526245283, -584.7148048349819, -295.8737649834099, -573.7872150784407, -369.73454487126446, -599.512617916398, -388.21099855550966, -377.16986212824355, 266.0200392956433, -709.6026430714359, 208.92610578451786, -419.41671225030376, -88.48933512137705, -623.2304611631224, 332.37312375929235, -562.0868233021012, -469.92678737503695, -585.8725876765936, 299.4787543291357, -639.999303158137, -840.4465641936523, -92.66964612022672, -566.2263310021182, -32.334454008492294, -606.4686647734474, -705.0792063458517, -245.44419263036175, -586.1081138414415, 62.834749484927755, -471.2237873266476, -610.7876960489042, -585.7904082165716, -59.12587540220005, -653.3356669283751, -232.60942668662926, 163.56283491944794, -175.5406067341797, -85.02436888595369, -260.55870037796967, -10.36280632046527, -66.65337078646718, -234.83182009377896, -882.2833369956195, -605.8379170533456, -592.860083189226, -249.85996954761177, -714.2269014589314, -330.3507988055026, -50.864902783971786, -268.68154544557393, -774.5064668460985, -344.70868118471407, -448.8205876526608, -610.8520709786752, -535.3199841067321, -380.304715423721, -422.74236533685973, -104.42612658147291, -721.5502602000367, -479.86496184585593, -321.9960768892353, -458.4385079067294, -706.4897971545306, -269.9215536704036, -589.8908026592271, -725.5985006229329, -68.42987781494358, -564.8201918918706, -24.54334986442032, -604.6763687905802, -498.10601153617, -417.18370336347556, -485.7705175481807, -311.92248434116726, -483.74380705421294, -551.4581411911132, 39.095728462173184, -499.6372934721561, -717.664271666053, -500.5394571956742, 39.8175165639411, -828.7128789764593, 239.82188522406693, 12.923523001501481, -900.8050467492574, -557.6631045753849, -680.9495355991751, -280.6212794198724, -671.4451835313533, -512.8398930131004, -23.755226223640168, 131.86636344782542, -802.5743194492269, 221.51339367011133, -744.5078091099042, -403.1024737336168, -274.004391139391, -193.86709186782798, -535.5768128833324, -326.9537634546257, -365.6351254609156, -439.2215135033711, -470.3704971241482, -490.2965725245209, -192.13017003787624, -387.4514035923632, -956.4146587615866, -569.3823401097079, -451.1677642022607, -552.4960934540403, -165.05010194849373, -38.37559180313976, -852.7403179285659, -42.218446190981744, -363.9694534035738, -877.8981279973016, -79.83010588013858, -638.0744318671817, -90.25122811506225, -470.69757493923606, -499.8580345579314, -321.64025822456426, -156.26975229740412, -364.00605874955943, -311.42276441639825, -793.0510492616099, -26.659481368807796, -782.358996174104, -620.2776218528737, -608.6688993029724, -515.5160759364155, -669.6772790282708, -668.1926396518012, 244.44665838230466, -668.1914843947711, 45.34276721244022, -803.8815924601322, -705.7326971838017, 201.1262060449566, -196.84753806049127, -274.8067193203191, -782.7308375212922, -95.59886432759507, -289.62739555218053, -515.3593522570314, -462.3323293784305, -351.03750111288673, -730.5222921365448, -428.6815441107191, -339.6730615322919, -587.7512582358294, -504.5501048916593, -50.76242073496329, -409.2264479231072, -165.14505347055623, -238.31408684142784, -394.49269431056354, -220.01413156484722, -564.9612512362398, -237.07008661510312, -371.968472682542, -243.8978728293359, 294.8019120885224, -25.546626006246584, -657.6414225940845], "policy_predator_policy_reward": [295.0290231466312, 228.47274927282606, 515.0264413056611, 574.3210616560082, 493.03683837406453, 210.51750967002474, 582.9968133511019, 639.9370261186042, 630.0609338710242, 521.1019328631676, 262.57481159675564, 275.8521227641793, 501.7054844576204, 545.0052705500359, 294.42468029711694, 574.8072598786104, 194.6939120900002, 395.87142085561504, 638.8626950988522, 647.7889007018787, 307.39668753331733, 384.2370940458157, 572.1214013090722, 585.6443547672853, 534.2756883056968, 653.993108410472, 452.76652544231774, 231.17184776085443, 296.9051032648247, 628.3329816444946, 416.60716843025494, 568.2864177642867, 419.21922743686866, 196.18019120750932, 300.86312782698303, 264.676414411425, 564.4062321256661, 495.8234713067836, 584.8596643743819, 366.6694628610163, 549.6697901816949, 499.94276364124636, 0.0, 492.4888342647739, 616.9628409540185, 710.7754715128796, 418.32017509219196, 537.0646495697401, 270.47566848470217, 508.836600132942, 413.12275358324814, 644.9706055666127, 132.98560374036873, 543.7527889152217, 642.40627817508, 844.6510241496327, 127.86964612022521, 568.2263310021182, 457.51211750262934, 327.8194511484902, 271.98198252699603, 739.7806330871692, 550.0923390811104, 558.336282689466, 634.853319238076, 672.2678639301644, 339.9691137515376, 456.4994328118564, 559.8126391413988, 613.9208626534344, 159.36915062644402, 207.87244967355767, 321.8171460785022, 313.0132731535814, 156.41026474717896, 125.90591235975283, 627.6177552317237, 878.1855316569514, 605.9379170533456, 600.2600831892277, 274.25996954761035, 714.2269014589314, 229.47378503429505, 472.72876859703814, 609.4843165085142, 715.5822610271696, 498.21718381438393, 583.135520934775, 698.700522402588, 456.2920797188867, 400.08646940164357, 432.50027218954847, 568.0368264302039, 698.7161599297696, 507.05920842941134, 335.2907178010936, 470.78673148015866, 706.8897971545307, 759.5492764443294, 292.58384533236637, 671.260452807874, 580.8320104451291, 588.9858390973953, 494.09547878871234, 549.0154356245229, 626.2353138138136, 707.1427845784867, 660.6090685654513, 494.4735081913896, 498.39434050338724, 454.96359948886106, 478.33224213014927, 529.4433727599559, 718.1633422501718, 197.3487142765423, 609.4797983477338, 747.5035162956929, 367.8386412297784, 415.99189783136643, 832.983872549679, 742.4802066109505, 661.767358277254, 524.3202846001127, 678.448623126598, 628.2851227931975, 7.018952436429344, 791.2822313872085, 182.99404900236422, 719.1746833989581, 637.2405495260526, 413.8024737336191, 296.10439113939594, 214.38022050461169, 545.5037685737321, 344.6164415798113, 381.20661415894136, 450.2153304586374, 477.4550201915727, 589.2824464081104, 213.891795503173, 873.0538307146054, 577.2002852434831, 571.8823401097079, 495.66776420226034, 535.9461049281999, 579.6668036429867, 632.5387647403801, 716.0094058887739, 369.8528673866525, 273.9872552608758, 858.5803582623976, 188.81204438650056, 571.3067673959524, 537.234989661061, 511.6117641063313, 575.5484629869428, 440.37877823933604, 394.49299679898286, 397.03226219775166, 290.4671680841686, 735.2097289245221, 545.9609132343392, 782.358996174104, 621.205654364059, 449.59199106033606, 637.4421694064459, 714.5221508814922, 645.2375704728134, 554.2529986358857, 619.2485545534649, 741.7635181708084, 666.6514554922345, 586.1996704878153, 696.1562655981141, 232.36908001159196, 223.02581944692642, 784.0317571205215, 304.3141572052837, 588.6385391980244, 300.59769824916714, 506.8252810845413, 566.6350768680325, 592.5669631342279, 651.6755430495542, 690.4035671319581, 624.9593217301962, 296.2709187327804, 385.60421240726794, 497.30473093949604, 66.3584923745163, 403.2286150848199, 383.0014714437053, 594.5541920053255, 504.07984186176964, 30.553246902149105, 532.7517176276501, 287.1809677381741, 325.75637313935033, 108.15515051714753, 654.1868166800641]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.9301864231822865, "mean_inference_ms": 4.3984968140817475, "mean_action_processing_ms": 1.640625350631124, "mean_env_wait_ms": 12.612450117684759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01799607276916504, "StateBufferConnector_ms": 0.009416341781616211, "ViewRequirementAgentConnector_ms": 0.2402571439743042}, "num_episodes": 7, "episode_return_max": 833.4208174852164, "episode_return_min": -45.733594767847094, "episode_return_mean": 230.44953541680675, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.6213241469954, "num_env_steps_trained_throughput_per_sec": 154.6213241469954, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1472000, "timers": {"training_iteration_time_ms": 25953.958, "restore_workers_time_ms": 0.025, "training_step_time_ms": 25953.708, "sample_time_ms": 2573.288, "learn_time_ms": 23356.416, "learn_throughput": 171.259, "synch_weights_time_ms": 20.216}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "done": false, "training_iteration": 92, "trial_id": "0b608_00000", "date": "2024-08-22_14-24-53", "timestamp": 1724316893, "time_this_iter_s": 25.92589497566223, "time_total_s": 2384.6611099243164, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30e4810d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2384.6611099243164, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 32.29166666666666, "ram_util_percent": 83.00555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.111057686931872, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.294831169976129, "policy_loss": -0.01205501319377353, "vf_loss": 7.3058762807694695, "vf_explained_var": 0.06591612497965495, "kl": 0.0100991584944524, "entropy": 0.3105269507125572, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87413.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.397532984567064, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.5237956001645045, "policy_loss": -0.008159227818546314, "vf_loss": 6.530585156798994, "vf_explained_var": 0.5558344603215576, "kl": 0.006848344123533005, "entropy": 0.58411303490558, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87413.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 833.4208174852164, "episode_reward_min": -165.20547486986484, "episode_reward_mean": 232.1629298386571, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -956.4146587615866, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 332.37312375929235, "predator_policy": 878.1855316569514}, "policy_reward_mean": {"prey_policy": -386.5183987581048, "predator_policy": 502.5998636774338}, "custom_metrics": {}, "hist_stats": {"episode_reward": [301.09534108739734, 20.600000000000037, 244.75641282281924, 177.02956788621864, 18.767301115207356, 179.64113361405754, 8.00736728569236, 61.88893735103264, 381.3390114321732, 827.0617751799766, 447.4787772902522, 488.45493121381423, 26.079748472723022, 390.3445593081325, 6.611434972923239, 37.20000000000027, 146.5284498691776, 61.239216637950776, 585.1552574140626, 225.10969979268154, 151.55226294462196, 287.7884081798312, 355.2638284852742, 289.2473499681597, 205.29999999999822, 388.688129799277, 7.499999999999993, 24.40000000000002, 320.98685204185375, 281.87856524401167, 287.82343591178216, 8.820547036067257, 29.539660830605975, 440.7765995784656, 40.48888749540824, 12.748223573427438, 192.32076544706507, 458.06408481512995, 493.71777612981623, 72.46836911158509, 464.7976322322825, 197.20155729939694, 420.9334288900704, 30.30514987191758, 346.1065719925435, 526.4511637730735, 361.0942466332896, 165.63492471364094, 250.70244477548346, 98.70895599288208, 303.5683243881713, 833.4208174852164, 32.8000000000002, 30.440084327183893, 33.23416682320429, 18.07834002268785, 120.74749934888787, 106.388053604135, 47.0, 398.0667131686579, 457.43226089744945, 237.6522230529728, 89.66416877145984, 380.21609707477285, 116.60461759610301, 356.96176451635336, 12.070607115960263, 461.4601115284464, 0.9280325111852694, -37.15081477260557, 21.889802674234076, 749.756727176885, 649.876148415349, 777.7494449470844, -16.259357922290413, 210.01621247691804, 84.24948963797699, 260.09052746125076, 85.03866993651307, 387.93856909402973, 126.56260551342484, -10.70827807964974, 153.423305376532, 313.6586510660095, -45.733594767847094, 663.8413801367099, 79.15391859687948, 315.81410565883954, 739.3769038000132, 379.10675518954463, 85.85146595519572, 30.116116523516894, 477.6063188288476, 46.0007983406082, -165.20547486986484, 493.8084080706753, 100.61537415269991, 262.29867864672354, 11.536144369551126, 103.54135448585725], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [45.22824936495151, -428.0712814807237, -279.6051032648212, -625.0329816444939, -144.32866625390275, -595.8085071178223, -405.33206524241547, -33.03778551573792, -359.603845860745, -187.16839526245283, -584.7148048349819, -295.8737649834099, -573.7872150784407, -369.73454487126446, -599.512617916398, -388.21099855550966, -377.16986212824355, 266.0200392956433, -709.6026430714359, 208.92610578451786, -419.41671225030376, -88.48933512137705, -623.2304611631224, 332.37312375929235, -562.0868233021012, -469.92678737503695, -585.8725876765936, 299.4787543291357, -639.999303158137, -840.4465641936523, -92.66964612022672, -566.2263310021182, -32.334454008492294, -606.4686647734474, -705.0792063458517, -245.44419263036175, -586.1081138414415, 62.834749484927755, -471.2237873266476, -610.7876960489042, -585.7904082165716, -59.12587540220005, -653.3356669283751, -232.60942668662926, 163.56283491944794, -175.5406067341797, -85.02436888595369, -260.55870037796967, -10.36280632046527, -66.65337078646718, -234.83182009377896, -882.2833369956195, -605.8379170533456, -592.860083189226, -249.85996954761177, -714.2269014589314, -330.3507988055026, -50.864902783971786, -268.68154544557393, -774.5064668460985, -344.70868118471407, -448.8205876526608, -610.8520709786752, -535.3199841067321, -380.304715423721, -422.74236533685973, -104.42612658147291, -721.5502602000367, -479.86496184585593, -321.9960768892353, -458.4385079067294, -706.4897971545306, -269.9215536704036, -589.8908026592271, -725.5985006229329, -68.42987781494358, -564.8201918918706, -24.54334986442032, -604.6763687905802, -498.10601153617, -417.18370336347556, -485.7705175481807, -311.92248434116726, -483.74380705421294, -551.4581411911132, 39.095728462173184, -499.6372934721561, -717.664271666053, -500.5394571956742, 39.8175165639411, -828.7128789764593, 239.82188522406693, 12.923523001501481, -900.8050467492574, -557.6631045753849, -680.9495355991751, -280.6212794198724, -671.4451835313533, -512.8398930131004, -23.755226223640168, 131.86636344782542, -802.5743194492269, 221.51339367011133, -744.5078091099042, -403.1024737336168, -274.004391139391, -193.86709186782798, -535.5768128833324, -326.9537634546257, -365.6351254609156, -439.2215135033711, -470.3704971241482, -490.2965725245209, -192.13017003787624, -387.4514035923632, -956.4146587615866, -569.3823401097079, -451.1677642022607, -552.4960934540403, -165.05010194849373, -38.37559180313976, -852.7403179285659, -42.218446190981744, -363.9694534035738, -877.8981279973016, -79.83010588013858, -638.0744318671817, -90.25122811506225, -470.69757493923606, -499.8580345579314, -321.64025822456426, -156.26975229740412, -364.00605874955943, -311.42276441639825, -793.0510492616099, -26.659481368807796, -782.358996174104, -620.2776218528737, -608.6688993029724, -515.5160759364155, -669.6772790282708, -668.1926396518012, 244.44665838230466, -668.1914843947711, 45.34276721244022, -803.8815924601322, -705.7326971838017, 201.1262060449566, -196.84753806049127, -274.8067193203191, -782.7308375212922, -95.59886432759507, -289.62739555218053, -515.3593522570314, -462.3323293784305, -351.03750111288673, -730.5222921365448, -428.6815441107191, -339.6730615322919, -587.7512582358294, -504.5501048916593, -50.76242073496329, -409.2264479231072, -165.14505347055623, -238.31408684142784, -394.49269431056354, -220.01413156484722, -564.9612512362398, -237.07008661510312, -371.968472682542, -243.8978728293359, 294.8019120885224, -25.546626006246584, -657.6414225940845, -724.6338671527241, 43.80087197295943, -755.7789245881688, 165.97948314807073, -179.14653316653497, -877.2839499808651, -670.8901146174504, -395.4268131635479, -513.1259561547903, -506.4975066599511, -204.81142555042936, -688.926250883422, -286.9479833621303, -422.55479956144467, -392.23665262814734, -539.3192534177028, -197.63751791415723, -483.7199672837636, -387.9827294074753, -602.9264046520467, -638.7970276594883, -365.96089792353195, -309.6567490220033, -356.9770818859506, -532.5396183757375, -658.71632416506], "policy_predator_policy_reward": [452.76652544231774, 231.17184776085443, 296.9051032648247, 628.3329816444946, 416.60716843025494, 568.2864177642867, 419.21922743686866, 196.18019120750932, 300.86312782698303, 264.676414411425, 564.4062321256661, 495.8234713067836, 584.8596643743819, 366.6694628610163, 549.6697901816949, 499.94276364124636, 0.0, 492.4888342647739, 616.9628409540185, 710.7754715128796, 418.32017509219196, 537.0646495697401, 270.47566848470217, 508.836600132942, 413.12275358324814, 644.9706055666127, 132.98560374036873, 543.7527889152217, 642.40627817508, 844.6510241496327, 127.86964612022521, 568.2263310021182, 457.51211750262934, 327.8194511484902, 271.98198252699603, 739.7806330871692, 550.0923390811104, 558.336282689466, 634.853319238076, 672.2678639301644, 339.9691137515376, 456.4994328118564, 559.8126391413988, 613.9208626534344, 159.36915062644402, 207.87244967355767, 321.8171460785022, 313.0132731535814, 156.41026474717896, 125.90591235975283, 627.6177552317237, 878.1855316569514, 605.9379170533456, 600.2600831892277, 274.25996954761035, 714.2269014589314, 229.47378503429505, 472.72876859703814, 609.4843165085142, 715.5822610271696, 498.21718381438393, 583.135520934775, 698.700522402588, 456.2920797188867, 400.08646940164357, 432.50027218954847, 568.0368264302039, 698.7161599297696, 507.05920842941134, 335.2907178010936, 470.78673148015866, 706.8897971545307, 759.5492764443294, 292.58384533236637, 671.260452807874, 580.8320104451291, 588.9858390973953, 494.09547878871234, 549.0154356245229, 626.2353138138136, 707.1427845784867, 660.6090685654513, 494.4735081913896, 498.39434050338724, 454.96359948886106, 478.33224213014927, 529.4433727599559, 718.1633422501718, 197.3487142765423, 609.4797983477338, 747.5035162956929, 367.8386412297784, 415.99189783136643, 832.983872549679, 742.4802066109505, 661.767358277254, 524.3202846001127, 678.448623126598, 628.2851227931975, 7.018952436429344, 791.2822313872085, 182.99404900236422, 719.1746833989581, 637.2405495260526, 413.8024737336191, 296.10439113939594, 214.38022050461169, 545.5037685737321, 344.6164415798113, 381.20661415894136, 450.2153304586374, 477.4550201915727, 589.2824464081104, 213.891795503173, 873.0538307146054, 577.2002852434831, 571.8823401097079, 495.66776420226034, 535.9461049281999, 579.6668036429867, 632.5387647403801, 716.0094058887739, 369.8528673866525, 273.9872552608758, 858.5803582623976, 188.81204438650056, 571.3067673959524, 537.234989661061, 511.6117641063313, 575.5484629869428, 440.37877823933604, 394.49299679898286, 397.03226219775166, 290.4671680841686, 735.2097289245221, 545.9609132343392, 782.358996174104, 621.205654364059, 449.59199106033606, 637.4421694064459, 714.5221508814922, 645.2375704728134, 554.2529986358857, 619.2485545534649, 741.7635181708084, 666.6514554922345, 586.1996704878153, 696.1562655981141, 232.36908001159196, 223.02581944692642, 784.0317571205215, 304.3141572052837, 588.6385391980244, 300.59769824916714, 506.8252810845413, 566.6350768680325, 592.5669631342279, 651.6755430495542, 690.4035671319581, 624.9593217301962, 296.2709187327804, 385.60421240726794, 497.30473093949604, 66.3584923745163, 403.2286150848199, 383.0014714437053, 594.5541920053255, 504.07984186176964, 30.553246902149105, 532.7517176276501, 287.1809677381741, 325.75637313935033, 108.15515051714753, 654.1868166800641, 719.9110782144845, 276.73602262411964, 731.8962625165728, 597.280082723539, 584.5987430524718, 850.9384952844704, 606.2864026642723, 545.8819910719227, 521.3420726783086, 528.3975066599505, 732.0660182084364, 639.2779770542622, 368.77354159123615, 386.7300396729447, 218.37299470771595, 547.9774364682703, 614.9832604479825, 560.1826328206166, 484.79810356017805, 606.7264046520464, 668.7463497502035, 598.3102544795397, 556.123003999955, 122.04697127755269, 627.8586901859871, 666.9386068406678]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.936441713432222, "mean_inference_ms": 4.400194446747605, "mean_action_processing_ms": 1.643400624904355, "mean_env_wait_ms": 12.631253867099783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018277287483215332, "StateBufferConnector_ms": 0.009599685668945312, "ViewRequirementAgentConnector_ms": 0.23772931098937988}, "num_episodes": 13, "episode_return_max": 833.4208174852164, "episode_return_min": -165.20547486986484, "episode_return_mean": 232.1629298386571, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.9684807625344, "num_env_steps_trained_throughput_per_sec": 153.9684807625344, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 25970.209, "restore_workers_time_ms": 0.023, "training_step_time_ms": 25969.938, "sample_time_ms": 2561.258, "learn_time_ms": 23383.495, "learn_throughput": 171.061, "synch_weights_time_ms": 21.357}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 93, "trial_id": "0b608_00000", "date": "2024-08-22_14-25-19", "timestamp": 1724316919, "time_this_iter_s": 26.0395770072937, "time_total_s": 2410.70068693161, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30e481b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2410.70068693161, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 33.535135135135135, "ram_util_percent": 82.91621621621621}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.494425761510456, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.478898213401673, "policy_loss": -0.008566572639361891, "vf_loss": 7.486730428221365, "vf_explained_var": -0.006325091949846378, "kl": 0.007343490393438116, "entropy": 0.24349649127513642, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 88358.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 37.59405706395548, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.9886952425437, "policy_loss": -0.006692923226014331, "vf_loss": 6.994143218085879, "vf_explained_var": 0.4928893658219191, "kl": 0.006224626361850708, "entropy": 0.5340635563961412, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 88358.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "env_runners": {"episode_reward_max": 833.4208174852164, "episode_reward_min": -165.20547486986484, "episode_reward_mean": 237.7720298751938, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -956.4146587615866, "predator_policy": 7.018952436429344}, "policy_reward_max": {"prey_policy": 332.37312375929235, "predator_policy": 892.6661183972611}, "policy_reward_mean": {"prey_policy": -396.8032184344697, "predator_policy": 515.689233372067}, "custom_metrics": {}, "hist_stats": {"episode_reward": [827.0617751799766, 447.4787772902522, 488.45493121381423, 26.079748472723022, 390.3445593081325, 6.611434972923239, 37.20000000000027, 146.5284498691776, 61.239216637950776, 585.1552574140626, 225.10969979268154, 151.55226294462196, 287.7884081798312, 355.2638284852742, 289.2473499681597, 205.29999999999822, 388.688129799277, 7.499999999999993, 24.40000000000002, 320.98685204185375, 281.87856524401167, 287.82343591178216, 8.820547036067257, 29.539660830605975, 440.7765995784656, 40.48888749540824, 12.748223573427438, 192.32076544706507, 458.06408481512995, 493.71777612981623, 72.46836911158509, 464.7976322322825, 197.20155729939694, 420.9334288900704, 30.30514987191758, 346.1065719925435, 526.4511637730735, 361.0942466332896, 165.63492471364094, 250.70244477548346, 98.70895599288208, 303.5683243881713, 833.4208174852164, 32.8000000000002, 30.440084327183893, 33.23416682320429, 18.07834002268785, 120.74749934888787, 106.388053604135, 47.0, 398.0667131686579, 457.43226089744945, 237.6522230529728, 89.66416877145984, 380.21609707477285, 116.60461759610301, 356.96176451635336, 12.070607115960263, 461.4601115284464, 0.9280325111852694, -37.15081477260557, 21.889802674234076, 749.756727176885, 649.876148415349, 777.7494449470844, -16.259357922290413, 210.01621247691804, 84.24948963797699, 260.09052746125076, 85.03866993651307, 387.93856909402973, 126.56260551342484, -10.70827807964974, 153.423305376532, 313.6586510660095, -45.733594767847094, 663.8413801367099, 79.15391859687948, 315.81410565883954, 739.3769038000132, 379.10675518954463, 85.85146595519572, 30.116116523516894, 477.6063188288476, 46.0007983406082, -165.20547486986484, 493.8084080706753, 100.61537415269991, 262.29867864672354, 11.536144369551126, 103.54135448585725, 468.46676473748016, 139.27930245235748, 14.153864705190191, 463.1960918433639, 345.4594769337172, 81.01006906426758, 255.40322365030843, 182.53290017144576, 4.533382690131508], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-709.6026430714359, 208.92610578451786, -419.41671225030376, -88.48933512137705, -623.2304611631224, 332.37312375929235, -562.0868233021012, -469.92678737503695, -585.8725876765936, 299.4787543291357, -639.999303158137, -840.4465641936523, -92.66964612022672, -566.2263310021182, -32.334454008492294, -606.4686647734474, -705.0792063458517, -245.44419263036175, -586.1081138414415, 62.834749484927755, -471.2237873266476, -610.7876960489042, -585.7904082165716, -59.12587540220005, -653.3356669283751, -232.60942668662926, 163.56283491944794, -175.5406067341797, -85.02436888595369, -260.55870037796967, -10.36280632046527, -66.65337078646718, -234.83182009377896, -882.2833369956195, -605.8379170533456, -592.860083189226, -249.85996954761177, -714.2269014589314, -330.3507988055026, -50.864902783971786, -268.68154544557393, -774.5064668460985, -344.70868118471407, -448.8205876526608, -610.8520709786752, -535.3199841067321, -380.304715423721, -422.74236533685973, -104.42612658147291, -721.5502602000367, -479.86496184585593, -321.9960768892353, -458.4385079067294, -706.4897971545306, -269.9215536704036, -589.8908026592271, -725.5985006229329, -68.42987781494358, -564.8201918918706, -24.54334986442032, -604.6763687905802, -498.10601153617, -417.18370336347556, -485.7705175481807, -311.92248434116726, -483.74380705421294, -551.4581411911132, 39.095728462173184, -499.6372934721561, -717.664271666053, -500.5394571956742, 39.8175165639411, -828.7128789764593, 239.82188522406693, 12.923523001501481, -900.8050467492574, -557.6631045753849, -680.9495355991751, -280.6212794198724, -671.4451835313533, -512.8398930131004, -23.755226223640168, 131.86636344782542, -802.5743194492269, 221.51339367011133, -744.5078091099042, -403.1024737336168, -274.004391139391, -193.86709186782798, -535.5768128833324, -326.9537634546257, -365.6351254609156, -439.2215135033711, -470.3704971241482, -490.2965725245209, -192.13017003787624, -387.4514035923632, -956.4146587615866, -569.3823401097079, -451.1677642022607, -552.4960934540403, -165.05010194849373, -38.37559180313976, -852.7403179285659, -42.218446190981744, -363.9694534035738, -877.8981279973016, -79.83010588013858, -638.0744318671817, -90.25122811506225, -470.69757493923606, -499.8580345579314, -321.64025822456426, -156.26975229740412, -364.00605874955943, -311.42276441639825, -793.0510492616099, -26.659481368807796, -782.358996174104, -620.2776218528737, -608.6688993029724, -515.5160759364155, -669.6772790282708, -668.1926396518012, 244.44665838230466, -668.1914843947711, 45.34276721244022, -803.8815924601322, -705.7326971838017, 201.1262060449566, -196.84753806049127, -274.8067193203191, -782.7308375212922, -95.59886432759507, -289.62739555218053, -515.3593522570314, -462.3323293784305, -351.03750111288673, -730.5222921365448, -428.6815441107191, -339.6730615322919, -587.7512582358294, -504.5501048916593, -50.76242073496329, -409.2264479231072, -165.14505347055623, -238.31408684142784, -394.49269431056354, -220.01413156484722, -564.9612512362398, -237.07008661510312, -371.968472682542, -243.8978728293359, 294.8019120885224, -25.546626006246584, -657.6414225940845, -724.6338671527241, 43.80087197295943, -755.7789245881688, 165.97948314807073, -179.14653316653497, -877.2839499808651, -670.8901146174504, -395.4268131635479, -513.1259561547903, -506.4975066599511, -204.81142555042936, -688.926250883422, -286.9479833621303, -422.55479956144467, -392.23665262814734, -539.3192534177028, -197.63751791415723, -483.7199672837636, -387.9827294074753, -602.9264046520467, -638.7970276594883, -365.96089792353195, -309.6567490220033, -356.9770818859506, -532.5396183757375, -658.71632416506, -16.78978158635239, -734.9616644784982, -548.0467129301743, -495.42602568415487, -662.2547152877517, -530.5040732131878, -760.432316420667, -88.81936153672333, -572.6837080286299, -175.80385519915453, -205.48361801074958, -316.8597899433533, -322.4946073453354, -189.2108405237855, -878.3016768144689, -194.51285412105514, -638.895833453983, -661.2266520457284], "policy_predator_policy_reward": [616.9628409540185, 710.7754715128796, 418.32017509219196, 537.0646495697401, 270.47566848470217, 508.836600132942, 413.12275358324814, 644.9706055666127, 132.98560374036873, 543.7527889152217, 642.40627817508, 844.6510241496327, 127.86964612022521, 568.2263310021182, 457.51211750262934, 327.8194511484902, 271.98198252699603, 739.7806330871692, 550.0923390811104, 558.336282689466, 634.853319238076, 672.2678639301644, 339.9691137515376, 456.4994328118564, 559.8126391413988, 613.9208626534344, 159.36915062644402, 207.87244967355767, 321.8171460785022, 313.0132731535814, 156.41026474717896, 125.90591235975283, 627.6177552317237, 878.1855316569514, 605.9379170533456, 600.2600831892277, 274.25996954761035, 714.2269014589314, 229.47378503429505, 472.72876859703814, 609.4843165085142, 715.5822610271696, 498.21718381438393, 583.135520934775, 698.700522402588, 456.2920797188867, 400.08646940164357, 432.50027218954847, 568.0368264302039, 698.7161599297696, 507.05920842941134, 335.2907178010936, 470.78673148015866, 706.8897971545307, 759.5492764443294, 292.58384533236637, 671.260452807874, 580.8320104451291, 588.9858390973953, 494.09547878871234, 549.0154356245229, 626.2353138138136, 707.1427845784867, 660.6090685654513, 494.4735081913896, 498.39434050338724, 454.96359948886106, 478.33224213014927, 529.4433727599559, 718.1633422501718, 197.3487142765423, 609.4797983477338, 747.5035162956929, 367.8386412297784, 415.99189783136643, 832.983872549679, 742.4802066109505, 661.767358277254, 524.3202846001127, 678.448623126598, 628.2851227931975, 7.018952436429344, 791.2822313872085, 182.99404900236422, 719.1746833989581, 637.2405495260526, 413.8024737336191, 296.10439113939594, 214.38022050461169, 545.5037685737321, 344.6164415798113, 381.20661415894136, 450.2153304586374, 477.4550201915727, 589.2824464081104, 213.891795503173, 873.0538307146054, 577.2002852434831, 571.8823401097079, 495.66776420226034, 535.9461049281999, 579.6668036429867, 632.5387647403801, 716.0094058887739, 369.8528673866525, 273.9872552608758, 858.5803582623976, 188.81204438650056, 571.3067673959524, 537.234989661061, 511.6117641063313, 575.5484629869428, 440.37877823933604, 394.49299679898286, 397.03226219775166, 290.4671680841686, 735.2097289245221, 545.9609132343392, 782.358996174104, 621.205654364059, 449.59199106033606, 637.4421694064459, 714.5221508814922, 645.2375704728134, 554.2529986358857, 619.2485545534649, 741.7635181708084, 666.6514554922345, 586.1996704878153, 696.1562655981141, 232.36908001159196, 223.02581944692642, 784.0317571205215, 304.3141572052837, 588.6385391980244, 300.59769824916714, 506.8252810845413, 566.6350768680325, 592.5669631342279, 651.6755430495542, 690.4035671319581, 624.9593217301962, 296.2709187327804, 385.60421240726794, 497.30473093949604, 66.3584923745163, 403.2286150848199, 383.0014714437053, 594.5541920053255, 504.07984186176964, 30.553246902149105, 532.7517176276501, 287.1809677381741, 325.75637313935033, 108.15515051714753, 654.1868166800641, 719.9110782144845, 276.73602262411964, 731.8962625165728, 597.280082723539, 584.5987430524718, 850.9384952844704, 606.2864026642723, 545.8819910719227, 521.3420726783086, 528.3975066599505, 732.0660182084364, 639.2779770542622, 368.77354159123615, 386.7300396729447, 218.37299470771595, 547.9774364682703, 614.9832604479825, 560.1826328206166, 484.79810356017805, 606.7264046520464, 668.7463497502035, 598.3102544795397, 556.123003999955, 122.04697127755269, 627.8586901859871, 666.9386068406678, 645.7083311760057, 574.5098796263225, 526.709166687285, 656.0428743794056, 665.6547152877517, 541.2579379183795, 576.9868130811885, 735.4609567195635, 548.8520514636615, 545.0949886978389, 11.582035499078014, 591.7714415192933, 293.06454088903394, 474.04413063039857, 362.681312709708, 892.6661183972611, 644.4498073687098, 660.2060608211335]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.933084607639894, "mean_inference_ms": 4.4000524107871675, "mean_action_processing_ms": 1.6513716740139142, "mean_env_wait_ms": 12.641041128145973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010444879531860352, "StateBufferConnector_ms": 0.009585738182067871, "ViewRequirementAgentConnector_ms": 0.23355209827423096}, "num_episodes": 9, "episode_return_max": 833.4208174852164, "episode_return_min": -165.20547486986484, "episode_return_mean": 237.7720298751938, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.18185313857484, "num_env_steps_trained_throughput_per_sec": 156.18185313857484, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1504000, "timers": {"training_iteration_time_ms": 25966.811, "restore_workers_time_ms": 0.028, "training_step_time_ms": 25966.483, "sample_time_ms": 2597.648, "learn_time_ms": 23344.12, "learn_throughput": 171.349, "synch_weights_time_ms": 21.108}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "done": false, "training_iteration": 94, "trial_id": "0b608_00000", "date": "2024-08-22_14-25-45", "timestamp": 1724316945, "time_this_iter_s": 25.66303014755249, "time_total_s": 2436.3637170791626, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30e474700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2436.3637170791626, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 31.850000000000005, "ram_util_percent": 83.06666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.334835407216712, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.27749300860854, "policy_loss": -0.00932256338388595, "vf_loss": 7.286202831369229, "vf_explained_var": -0.07373145042903839, "kl": 0.0061274519838175915, "entropy": 0.2648062766859771, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89303.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000576}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 39.166540165048424, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.95694168787154, "policy_loss": -0.009315442868937103, "vf_loss": 6.964472289817043, "vf_explained_var": 0.4670525428479311, "kl": 0.008924102462907, "entropy": 0.5481707054155844, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89303.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000576}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 833.4208174852164, "episode_reward_min": -165.20547486986484, "episode_reward_mean": 231.82181591410986, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -956.4146587615866, "predator_policy": 7.018952436429344}, "policy_reward_max": {"prey_policy": 397.3, "predator_policy": 892.6661183972611}, "policy_reward_mean": {"prey_policy": -389.31842996174527, "predator_policy": 505.2293379188006}, "custom_metrics": {}, "hist_stats": {"episode_reward": [146.5284498691776, 61.239216637950776, 585.1552574140626, 225.10969979268154, 151.55226294462196, 287.7884081798312, 355.2638284852742, 289.2473499681597, 205.29999999999822, 388.688129799277, 7.499999999999993, 24.40000000000002, 320.98685204185375, 281.87856524401167, 287.82343591178216, 8.820547036067257, 29.539660830605975, 440.7765995784656, 40.48888749540824, 12.748223573427438, 192.32076544706507, 458.06408481512995, 493.71777612981623, 72.46836911158509, 464.7976322322825, 197.20155729939694, 420.9334288900704, 30.30514987191758, 346.1065719925435, 526.4511637730735, 361.0942466332896, 165.63492471364094, 250.70244477548346, 98.70895599288208, 303.5683243881713, 833.4208174852164, 32.8000000000002, 30.440084327183893, 33.23416682320429, 18.07834002268785, 120.74749934888787, 106.388053604135, 47.0, 398.0667131686579, 457.43226089744945, 237.6522230529728, 89.66416877145984, 380.21609707477285, 116.60461759610301, 356.96176451635336, 12.070607115960263, 461.4601115284464, 0.9280325111852694, -37.15081477260557, 21.889802674234076, 749.756727176885, 649.876148415349, 777.7494449470844, -16.259357922290413, 210.01621247691804, 84.24948963797699, 260.09052746125076, 85.03866993651307, 387.93856909402973, 126.56260551342484, -10.70827807964974, 153.423305376532, 313.6586510660095, -45.733594767847094, 663.8413801367099, 79.15391859687948, 315.81410565883954, 739.3769038000132, 379.10675518954463, 85.85146595519572, 30.116116523516894, 477.6063188288476, 46.0007983406082, -165.20547486986484, 493.8084080706753, 100.61537415269991, 262.29867864672354, 11.536144369551126, 103.54135448585725, 468.46676473748016, 139.27930245235748, 14.153864705190191, 463.1960918433639, 345.4594769337172, 81.01006906426758, 255.40322365030843, 182.53290017144576, 4.533382690131508, 575.8050081755127, 43.91967058563589, 104.03611357092372, 278.79554041447824, 70.14550517885317, 325.34836133411886, 230.15963106990498], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-32.334454008492294, -606.4686647734474, -705.0792063458517, -245.44419263036175, -586.1081138414415, 62.834749484927755, -471.2237873266476, -610.7876960489042, -585.7904082165716, -59.12587540220005, -653.3356669283751, -232.60942668662926, 163.56283491944794, -175.5406067341797, -85.02436888595369, -260.55870037796967, -10.36280632046527, -66.65337078646718, -234.83182009377896, -882.2833369956195, -605.8379170533456, -592.860083189226, -249.85996954761177, -714.2269014589314, -330.3507988055026, -50.864902783971786, -268.68154544557393, -774.5064668460985, -344.70868118471407, -448.8205876526608, -610.8520709786752, -535.3199841067321, -380.304715423721, -422.74236533685973, -104.42612658147291, -721.5502602000367, -479.86496184585593, -321.9960768892353, -458.4385079067294, -706.4897971545306, -269.9215536704036, -589.8908026592271, -725.5985006229329, -68.42987781494358, -564.8201918918706, -24.54334986442032, -604.6763687905802, -498.10601153617, -417.18370336347556, -485.7705175481807, -311.92248434116726, -483.74380705421294, -551.4581411911132, 39.095728462173184, -499.6372934721561, -717.664271666053, -500.5394571956742, 39.8175165639411, -828.7128789764593, 239.82188522406693, 12.923523001501481, -900.8050467492574, -557.6631045753849, -680.9495355991751, -280.6212794198724, -671.4451835313533, -512.8398930131004, -23.755226223640168, 131.86636344782542, -802.5743194492269, 221.51339367011133, -744.5078091099042, -403.1024737336168, -274.004391139391, -193.86709186782798, -535.5768128833324, -326.9537634546257, -365.6351254609156, -439.2215135033711, -470.3704971241482, -490.2965725245209, -192.13017003787624, -387.4514035923632, -956.4146587615866, -569.3823401097079, -451.1677642022607, -552.4960934540403, -165.05010194849373, -38.37559180313976, -852.7403179285659, -42.218446190981744, -363.9694534035738, -877.8981279973016, -79.83010588013858, -638.0744318671817, -90.25122811506225, -470.69757493923606, -499.8580345579314, -321.64025822456426, -156.26975229740412, -364.00605874955943, -311.42276441639825, -793.0510492616099, -26.659481368807796, -782.358996174104, -620.2776218528737, -608.6688993029724, -515.5160759364155, -669.6772790282708, -668.1926396518012, 244.44665838230466, -668.1914843947711, 45.34276721244022, -803.8815924601322, -705.7326971838017, 201.1262060449566, -196.84753806049127, -274.8067193203191, -782.7308375212922, -95.59886432759507, -289.62739555218053, -515.3593522570314, -462.3323293784305, -351.03750111288673, -730.5222921365448, -428.6815441107191, -339.6730615322919, -587.7512582358294, -504.5501048916593, -50.76242073496329, -409.2264479231072, -165.14505347055623, -238.31408684142784, -394.49269431056354, -220.01413156484722, -564.9612512362398, -237.07008661510312, -371.968472682542, -243.8978728293359, 294.8019120885224, -25.546626006246584, -657.6414225940845, -724.6338671527241, 43.80087197295943, -755.7789245881688, 165.97948314807073, -179.14653316653497, -877.2839499808651, -670.8901146174504, -395.4268131635479, -513.1259561547903, -506.4975066599511, -204.81142555042936, -688.926250883422, -286.9479833621303, -422.55479956144467, -392.23665262814734, -539.3192534177028, -197.63751791415723, -483.7199672837636, -387.9827294074753, -602.9264046520467, -638.7970276594883, -365.96089792353195, -309.6567490220033, -356.9770818859506, -532.5396183757375, -658.71632416506, -16.78978158635239, -734.9616644784982, -548.0467129301743, -495.42602568415487, -662.2547152877517, -530.5040732131878, -760.432316420667, -88.81936153672333, -572.6837080286299, -175.80385519915453, -205.48361801074958, -316.8597899433533, -322.4946073453354, -189.2108405237855, -878.3016768144689, -194.51285412105514, -638.895833453983, -661.2266520457284, -495.4856801818682, 397.3, -111.7419448756262, -315.0848528171227, -638.8992466644323, -218.50336209098788, -47.973207649748076, -315.2100963121514, -395.896034182972, -48.53830921658518, -142.13758141267823, -108.44673618394481, -789.5443577523913, -30.070106675768272], "policy_predator_policy_reward": [457.51211750262934, 327.8194511484902, 271.98198252699603, 739.7806330871692, 550.0923390811104, 558.336282689466, 634.853319238076, 672.2678639301644, 339.9691137515376, 456.4994328118564, 559.8126391413988, 613.9208626534344, 159.36915062644402, 207.87244967355767, 321.8171460785022, 313.0132731535814, 156.41026474717896, 125.90591235975283, 627.6177552317237, 878.1855316569514, 605.9379170533456, 600.2600831892277, 274.25996954761035, 714.2269014589314, 229.47378503429505, 472.72876859703814, 609.4843165085142, 715.5822610271696, 498.21718381438393, 583.135520934775, 698.700522402588, 456.2920797188867, 400.08646940164357, 432.50027218954847, 568.0368264302039, 698.7161599297696, 507.05920842941134, 335.2907178010936, 470.78673148015866, 706.8897971545307, 759.5492764443294, 292.58384533236637, 671.260452807874, 580.8320104451291, 588.9858390973953, 494.09547878871234, 549.0154356245229, 626.2353138138136, 707.1427845784867, 660.6090685654513, 494.4735081913896, 498.39434050338724, 454.96359948886106, 478.33224213014927, 529.4433727599559, 718.1633422501718, 197.3487142765423, 609.4797983477338, 747.5035162956929, 367.8386412297784, 415.99189783136643, 832.983872549679, 742.4802066109505, 661.767358277254, 524.3202846001127, 678.448623126598, 628.2851227931975, 7.018952436429344, 791.2822313872085, 182.99404900236422, 719.1746833989581, 637.2405495260526, 413.8024737336191, 296.10439113939594, 214.38022050461169, 545.5037685737321, 344.6164415798113, 381.20661415894136, 450.2153304586374, 477.4550201915727, 589.2824464081104, 213.891795503173, 873.0538307146054, 577.2002852434831, 571.8823401097079, 495.66776420226034, 535.9461049281999, 579.6668036429867, 632.5387647403801, 716.0094058887739, 369.8528673866525, 273.9872552608758, 858.5803582623976, 188.81204438650056, 571.3067673959524, 537.234989661061, 511.6117641063313, 575.5484629869428, 440.37877823933604, 394.49299679898286, 397.03226219775166, 290.4671680841686, 735.2097289245221, 545.9609132343392, 782.358996174104, 621.205654364059, 449.59199106033606, 637.4421694064459, 714.5221508814922, 645.2375704728134, 554.2529986358857, 619.2485545534649, 741.7635181708084, 666.6514554922345, 586.1996704878153, 696.1562655981141, 232.36908001159196, 223.02581944692642, 784.0317571205215, 304.3141572052837, 588.6385391980244, 300.59769824916714, 506.8252810845413, 566.6350768680325, 592.5669631342279, 651.6755430495542, 690.4035671319581, 624.9593217301962, 296.2709187327804, 385.60421240726794, 497.30473093949604, 66.3584923745163, 403.2286150848199, 383.0014714437053, 594.5541920053255, 504.07984186176964, 30.553246902149105, 532.7517176276501, 287.1809677381741, 325.75637313935033, 108.15515051714753, 654.1868166800641, 719.9110782144845, 276.73602262411964, 731.8962625165728, 597.280082723539, 584.5987430524718, 850.9384952844704, 606.2864026642723, 545.8819910719227, 521.3420726783086, 528.3975066599505, 732.0660182084364, 639.2779770542622, 368.77354159123615, 386.7300396729447, 218.37299470771595, 547.9774364682703, 614.9832604479825, 560.1826328206166, 484.79810356017805, 606.7264046520464, 668.7463497502035, 598.3102544795397, 556.123003999955, 122.04697127755269, 627.8586901859871, 666.9386068406678, 645.7083311760057, 574.5098796263225, 526.709166687285, 656.0428743794056, 665.6547152877517, 541.2579379183795, 576.9868130811885, 735.4609567195635, 548.8520514636615, 545.0949886978389, 11.582035499078014, 591.7714415192933, 293.06454088903394, 474.04413063039857, 362.681312709708, 892.6661183972611, 644.4498073687098, 660.2060608211335, 372.2488169964173, 301.7418713609641, 167.17473613845436, 303.5717321399276, 634.1801225288294, 327.2585997975144, 329.88509620564236, 312.0937481707391, 441.3916379539065, 73.188210624504, 132.50811844649576, 443.4245604842451, 730.9856435706592, 318.78845192740215]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.939588323729172, "mean_inference_ms": 4.402443715811293, "mean_action_processing_ms": 1.6373273164734703, "mean_env_wait_ms": 12.647314353215757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006796360015869141, "StateBufferConnector_ms": 0.010176897048950195, "ViewRequirementAgentConnector_ms": 0.2172091007232666}, "num_episodes": 7, "episode_return_max": 833.4208174852164, "episode_return_min": -165.20547486986484, "episode_return_mean": 231.82181591410986, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 157.07847277124156, "num_env_steps_trained_throughput_per_sec": 157.07847277124156, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 25943.664, "restore_workers_time_ms": 0.028, "training_step_time_ms": 25943.336, "sample_time_ms": 2589.72, "learn_time_ms": 23329.213, "learn_throughput": 171.459, "synch_weights_time_ms": 20.796}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 95, "trial_id": "0b608_00000", "date": "2024-08-22_14-26-10", "timestamp": 1724316970, "time_this_iter_s": 25.506770849227905, "time_total_s": 2461.8704879283905, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a34e940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2461.8704879283905, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 32.66111111111111, "ram_util_percent": 83.01666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.055679387138003, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.207043148222423, "policy_loss": -0.011501293791034234, "vf_loss": 7.217726908285151, "vf_explained_var": 0.1623339883234135, "kl": 0.008175103744447586, "entropy": 0.28008082851215643, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 90248.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000041}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 35.160186371223006, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.02326052882684, "policy_loss": -0.00885481419455674, "vf_loss": 7.030470703770875, "vf_explained_var": 0.4516179356625471, "kl": 0.0082232114836751, "entropy": 0.5287002184719005, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 90248.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000041}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 930.1104736383732, "episode_reward_min": -165.20547486986484, "episode_reward_mean": 232.44139538693642, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -989.4450671957516, "predator_policy": 7.018952436429344}, "policy_reward_max": {"prey_policy": 397.3, "predator_policy": 892.6661183972611}, "policy_reward_mean": {"prey_policy": -395.16969656248926, "predator_policy": 511.3903942559578}, "custom_metrics": {}, "hist_stats": {"episode_reward": [320.98685204185375, 281.87856524401167, 287.82343591178216, 8.820547036067257, 29.539660830605975, 440.7765995784656, 40.48888749540824, 12.748223573427438, 192.32076544706507, 458.06408481512995, 493.71777612981623, 72.46836911158509, 464.7976322322825, 197.20155729939694, 420.9334288900704, 30.30514987191758, 346.1065719925435, 526.4511637730735, 361.0942466332896, 165.63492471364094, 250.70244477548346, 98.70895599288208, 303.5683243881713, 833.4208174852164, 32.8000000000002, 30.440084327183893, 33.23416682320429, 18.07834002268785, 120.74749934888787, 106.388053604135, 47.0, 398.0667131686579, 457.43226089744945, 237.6522230529728, 89.66416877145984, 380.21609707477285, 116.60461759610301, 356.96176451635336, 12.070607115960263, 461.4601115284464, 0.9280325111852694, -37.15081477260557, 21.889802674234076, 749.756727176885, 649.876148415349, 777.7494449470844, -16.259357922290413, 210.01621247691804, 84.24948963797699, 260.09052746125076, 85.03866993651307, 387.93856909402973, 126.56260551342484, -10.70827807964974, 153.423305376532, 313.6586510660095, -45.733594767847094, 663.8413801367099, 79.15391859687948, 315.81410565883954, 739.3769038000132, 379.10675518954463, 85.85146595519572, 30.116116523516894, 477.6063188288476, 46.0007983406082, -165.20547486986484, 493.8084080706753, 100.61537415269991, 262.29867864672354, 11.536144369551126, 103.54135448585725, 468.46676473748016, 139.27930245235748, 14.153864705190191, 463.1960918433639, 345.4594769337172, 81.01006906426758, 255.40322365030843, 182.53290017144576, 4.533382690131508, 575.8050081755127, 43.91967058563589, 104.03611357092372, 278.79554041447824, 70.14550517885317, 325.34836133411886, 230.15963106990498, 635.5432505397968, -67.03877636273326, 251.29016105693117, 322.6485255868725, 220.47926131451175, 45.300000000000374, 157.89260384303958, 23.33685228636531, 114.51476215286681, 930.1104736383732, 25.559752207740686, 130.09368410992695], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-330.3507988055026, -50.864902783971786, -268.68154544557393, -774.5064668460985, -344.70868118471407, -448.8205876526608, -610.8520709786752, -535.3199841067321, -380.304715423721, -422.74236533685973, -104.42612658147291, -721.5502602000367, -479.86496184585593, -321.9960768892353, -458.4385079067294, -706.4897971545306, -269.9215536704036, -589.8908026592271, -725.5985006229329, -68.42987781494358, -564.8201918918706, -24.54334986442032, -604.6763687905802, -498.10601153617, -417.18370336347556, -485.7705175481807, -311.92248434116726, -483.74380705421294, -551.4581411911132, 39.095728462173184, -499.6372934721561, -717.664271666053, -500.5394571956742, 39.8175165639411, -828.7128789764593, 239.82188522406693, 12.923523001501481, -900.8050467492574, -557.6631045753849, -680.9495355991751, -280.6212794198724, -671.4451835313533, -512.8398930131004, -23.755226223640168, 131.86636344782542, -802.5743194492269, 221.51339367011133, -744.5078091099042, -403.1024737336168, -274.004391139391, -193.86709186782798, -535.5768128833324, -326.9537634546257, -365.6351254609156, -439.2215135033711, -470.3704971241482, -490.2965725245209, -192.13017003787624, -387.4514035923632, -956.4146587615866, -569.3823401097079, -451.1677642022607, -552.4960934540403, -165.05010194849373, -38.37559180313976, -852.7403179285659, -42.218446190981744, -363.9694534035738, -877.8981279973016, -79.83010588013858, -638.0744318671817, -90.25122811506225, -470.69757493923606, -499.8580345579314, -321.64025822456426, -156.26975229740412, -364.00605874955943, -311.42276441639825, -793.0510492616099, -26.659481368807796, -782.358996174104, -620.2776218528737, -608.6688993029724, -515.5160759364155, -669.6772790282708, -668.1926396518012, 244.44665838230466, -668.1914843947711, 45.34276721244022, -803.8815924601322, -705.7326971838017, 201.1262060449566, -196.84753806049127, -274.8067193203191, -782.7308375212922, -95.59886432759507, -289.62739555218053, -515.3593522570314, -462.3323293784305, -351.03750111288673, -730.5222921365448, -428.6815441107191, -339.6730615322919, -587.7512582358294, -504.5501048916593, -50.76242073496329, -409.2264479231072, -165.14505347055623, -238.31408684142784, -394.49269431056354, -220.01413156484722, -564.9612512362398, -237.07008661510312, -371.968472682542, -243.8978728293359, 294.8019120885224, -25.546626006246584, -657.6414225940845, -724.6338671527241, 43.80087197295943, -755.7789245881688, 165.97948314807073, -179.14653316653497, -877.2839499808651, -670.8901146174504, -395.4268131635479, -513.1259561547903, -506.4975066599511, -204.81142555042936, -688.926250883422, -286.9479833621303, -422.55479956144467, -392.23665262814734, -539.3192534177028, -197.63751791415723, -483.7199672837636, -387.9827294074753, -602.9264046520467, -638.7970276594883, -365.96089792353195, -309.6567490220033, -356.9770818859506, -532.5396183757375, -658.71632416506, -16.78978158635239, -734.9616644784982, -548.0467129301743, -495.42602568415487, -662.2547152877517, -530.5040732131878, -760.432316420667, -88.81936153672333, -572.6837080286299, -175.80385519915453, -205.48361801074958, -316.8597899433533, -322.4946073453354, -189.2108405237855, -878.3016768144689, -194.51285412105514, -638.895833453983, -661.2266520457284, -495.4856801818682, 397.3, -111.7419448756262, -315.0848528171227, -638.8992466644323, -218.50336209098788, -47.973207649748076, -315.2100963121514, -395.896034182972, -48.53830921658518, -142.13758141267823, -108.44673618394481, -789.5443577523913, -30.070106675768272, -695.307331671721, 65.60218084697392, -732.2806969541953, -604.3589336690333, -206.60203515737706, -473.915653859802, -615.6360419806218, -228.06615329649964, -190.46697018458264, -517.176655381742, -164.95700727844098, -285.22838915291794, -427.7479511417344, -668.3481739165876, -537.6273688716283, -371.890291210742, -363.21975935741324, -278.7901771456344, 364.2463718875887, -633.8203289223239, -621.4683806921748, -350.80701281315015, -82.89128227737872, -989.4450671957516], "policy_predator_policy_reward": [229.47378503429505, 472.72876859703814, 609.4843165085142, 715.5822610271696, 498.21718381438393, 583.135520934775, 698.700522402588, 456.2920797188867, 400.08646940164357, 432.50027218954847, 568.0368264302039, 698.7161599297696, 507.05920842941134, 335.2907178010936, 470.78673148015866, 706.8897971545307, 759.5492764443294, 292.58384533236637, 671.260452807874, 580.8320104451291, 588.9858390973953, 494.09547878871234, 549.0154356245229, 626.2353138138136, 707.1427845784867, 660.6090685654513, 494.4735081913896, 498.39434050338724, 454.96359948886106, 478.33224213014927, 529.4433727599559, 718.1633422501718, 197.3487142765423, 609.4797983477338, 747.5035162956929, 367.8386412297784, 415.99189783136643, 832.983872549679, 742.4802066109505, 661.767358277254, 524.3202846001127, 678.448623126598, 628.2851227931975, 7.018952436429344, 791.2822313872085, 182.99404900236422, 719.1746833989581, 637.2405495260526, 413.8024737336191, 296.10439113939594, 214.38022050461169, 545.5037685737321, 344.6164415798113, 381.20661415894136, 450.2153304586374, 477.4550201915727, 589.2824464081104, 213.891795503173, 873.0538307146054, 577.2002852434831, 571.8823401097079, 495.66776420226034, 535.9461049281999, 579.6668036429867, 632.5387647403801, 716.0094058887739, 369.8528673866525, 273.9872552608758, 858.5803582623976, 188.81204438650056, 571.3067673959524, 537.234989661061, 511.6117641063313, 575.5484629869428, 440.37877823933604, 394.49299679898286, 397.03226219775166, 290.4671680841686, 735.2097289245221, 545.9609132343392, 782.358996174104, 621.205654364059, 449.59199106033606, 637.4421694064459, 714.5221508814922, 645.2375704728134, 554.2529986358857, 619.2485545534649, 741.7635181708084, 666.6514554922345, 586.1996704878153, 696.1562655981141, 232.36908001159196, 223.02581944692642, 784.0317571205215, 304.3141572052837, 588.6385391980244, 300.59769824916714, 506.8252810845413, 566.6350768680325, 592.5669631342279, 651.6755430495542, 690.4035671319581, 624.9593217301962, 296.2709187327804, 385.60421240726794, 497.30473093949604, 66.3584923745163, 403.2286150848199, 383.0014714437053, 594.5541920053255, 504.07984186176964, 30.553246902149105, 532.7517176276501, 287.1809677381741, 325.75637313935033, 108.15515051714753, 654.1868166800641, 719.9110782144845, 276.73602262411964, 731.8962625165728, 597.280082723539, 584.5987430524718, 850.9384952844704, 606.2864026642723, 545.8819910719227, 521.3420726783086, 528.3975066599505, 732.0660182084364, 639.2779770542622, 368.77354159123615, 386.7300396729447, 218.37299470771595, 547.9774364682703, 614.9832604479825, 560.1826328206166, 484.79810356017805, 606.7264046520464, 668.7463497502035, 598.3102544795397, 556.123003999955, 122.04697127755269, 627.8586901859871, 666.9386068406678, 645.7083311760057, 574.5098796263225, 526.709166687285, 656.0428743794056, 665.6547152877517, 541.2579379183795, 576.9868130811885, 735.4609567195635, 548.8520514636615, 545.0949886978389, 11.582035499078014, 591.7714415192933, 293.06454088903394, 474.04413063039857, 362.681312709708, 892.6661183972611, 644.4498073687098, 660.2060608211335, 372.2488169964173, 301.7418713609641, 167.17473613845436, 303.5717321399276, 634.1801225288294, 327.2585997975144, 329.88509620564236, 312.0937481707391, 441.3916379539065, 73.188210624504, 132.50811844649576, 443.4245604842451, 730.9856435706592, 318.78845192740215, 649.0857022101161, 616.162699154428, 558.5624452983694, 711.0384089621249, 400.79665368006505, 531.0111963940444, 581.8181558433077, 584.5325650206869, 429.46283550826047, 498.66005137257747, 190.35700727843957, 305.12838915292053, 599.5452031327225, 654.4435257686416, 562.4716568921881, 370.3828554765471, 317.6968660543477, 438.82783260156697, 589.4741312285717, 610.2102994445357, 482.3247910609322, 515.5103546521356, 695.6083912193099, 506.8216423637459]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.937180377639174, "mean_inference_ms": 4.399258989085304, "mean_action_processing_ms": 1.6492233271154744, "mean_env_wait_ms": 12.64523441185529, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006122231483459473, "StateBufferConnector_ms": 0.009925603866577148, "ViewRequirementAgentConnector_ms": 0.2087416648864746}, "num_episodes": 12, "episode_return_max": 930.1104736383732, "episode_return_min": -165.20547486986484, "episode_return_mean": 232.44139538693642, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 157.71773039201935, "num_env_steps_trained_throughput_per_sec": 157.71773039201935, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 25895.126, "restore_workers_time_ms": 0.028, "training_step_time_ms": 25894.755, "sample_time_ms": 2587.736, "learn_time_ms": 23283.45, "learn_throughput": 171.796, "synch_weights_time_ms": 20.152}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 96, "trial_id": "0b608_00000", "date": "2024-08-22_14-26-36", "timestamp": 1724316996, "time_this_iter_s": 25.418439149856567, "time_total_s": 2487.288927078247, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x178007310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2487.288927078247, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 31.977777777777778, "ram_util_percent": 82.95833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.35293937562004, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 6.773952355965105, "policy_loss": -0.009317065790670102, "vf_loss": 6.782305485357052, "vf_explained_var": -0.14744630345591792, "kl": 0.009639243612302438, "entropy": 0.3262249401164433, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91193.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000041}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.14451124201376, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.660494703968997, "policy_loss": -0.008522148883196886, "vf_loss": 6.6673783100471296, "vf_explained_var": 0.463982491644602, "kl": 0.00819280013865816, "entropy": 0.5685386900548581, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91193.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000041}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "env_runners": {"episode_reward_max": 930.1104736383732, "episode_reward_min": -165.20547486986484, "episode_reward_mean": 230.21798217212475, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -989.4450671957516, "predator_policy": 7.018952436429344}, "policy_reward_max": {"prey_policy": 397.3, "predator_policy": 892.6661183972611}, "policy_reward_mean": {"prey_policy": -393.82983776333435, "predator_policy": 508.93882884939694}, "custom_metrics": {}, "hist_stats": {"episode_reward": [464.7976322322825, 197.20155729939694, 420.9334288900704, 30.30514987191758, 346.1065719925435, 526.4511637730735, 361.0942466332896, 165.63492471364094, 250.70244477548346, 98.70895599288208, 303.5683243881713, 833.4208174852164, 32.8000000000002, 30.440084327183893, 33.23416682320429, 18.07834002268785, 120.74749934888787, 106.388053604135, 47.0, 398.0667131686579, 457.43226089744945, 237.6522230529728, 89.66416877145984, 380.21609707477285, 116.60461759610301, 356.96176451635336, 12.070607115960263, 461.4601115284464, 0.9280325111852694, -37.15081477260557, 21.889802674234076, 749.756727176885, 649.876148415349, 777.7494449470844, -16.259357922290413, 210.01621247691804, 84.24948963797699, 260.09052746125076, 85.03866993651307, 387.93856909402973, 126.56260551342484, -10.70827807964974, 153.423305376532, 313.6586510660095, -45.733594767847094, 663.8413801367099, 79.15391859687948, 315.81410565883954, 739.3769038000132, 379.10675518954463, 85.85146595519572, 30.116116523516894, 477.6063188288476, 46.0007983406082, -165.20547486986484, 493.8084080706753, 100.61537415269991, 262.29867864672354, 11.536144369551126, 103.54135448585725, 468.46676473748016, 139.27930245235748, 14.153864705190191, 463.1960918433639, 345.4594769337172, 81.01006906426758, 255.40322365030843, 182.53290017144576, 4.533382690131508, 575.8050081755127, 43.91967058563589, 104.03611357092372, 278.79554041447824, 70.14550517885317, 325.34836133411886, 230.15963106990498, 635.5432505397968, -67.03877636273326, 251.29016105693117, 322.6485255868725, 220.47926131451175, 45.300000000000374, 157.89260384303958, 23.33685228636531, 114.51476215286681, 930.1104736383732, 25.559752207740686, 130.09368410992695, -15.905138825097168, 9.299999999999983, 183.57914528695002, 517.4899966861823, 424.38628429558247, 18.599999999999994, 309.1521497780518, 509.2897758166356, 39.93085860600135, 146.42124586527396, 2.6000000000000014, 272.4481282244761], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-417.18370336347556, -485.7705175481807, -311.92248434116726, -483.74380705421294, -551.4581411911132, 39.095728462173184, -499.6372934721561, -717.664271666053, -500.5394571956742, 39.8175165639411, -828.7128789764593, 239.82188522406693, 12.923523001501481, -900.8050467492574, -557.6631045753849, -680.9495355991751, -280.6212794198724, -671.4451835313533, -512.8398930131004, -23.755226223640168, 131.86636344782542, -802.5743194492269, 221.51339367011133, -744.5078091099042, -403.1024737336168, -274.004391139391, -193.86709186782798, -535.5768128833324, -326.9537634546257, -365.6351254609156, -439.2215135033711, -470.3704971241482, -490.2965725245209, -192.13017003787624, -387.4514035923632, -956.4146587615866, -569.3823401097079, -451.1677642022607, -552.4960934540403, -165.05010194849373, -38.37559180313976, -852.7403179285659, -42.218446190981744, -363.9694534035738, -877.8981279973016, -79.83010588013858, -638.0744318671817, -90.25122811506225, -470.69757493923606, -499.8580345579314, -321.64025822456426, -156.26975229740412, -364.00605874955943, -311.42276441639825, -793.0510492616099, -26.659481368807796, -782.358996174104, -620.2776218528737, -608.6688993029724, -515.5160759364155, -669.6772790282708, -668.1926396518012, 244.44665838230466, -668.1914843947711, 45.34276721244022, -803.8815924601322, -705.7326971838017, 201.1262060449566, -196.84753806049127, -274.8067193203191, -782.7308375212922, -95.59886432759507, -289.62739555218053, -515.3593522570314, -462.3323293784305, -351.03750111288673, -730.5222921365448, -428.6815441107191, -339.6730615322919, -587.7512582358294, -504.5501048916593, -50.76242073496329, -409.2264479231072, -165.14505347055623, -238.31408684142784, -394.49269431056354, -220.01413156484722, -564.9612512362398, -237.07008661510312, -371.968472682542, -243.8978728293359, 294.8019120885224, -25.546626006246584, -657.6414225940845, -724.6338671527241, 43.80087197295943, -755.7789245881688, 165.97948314807073, -179.14653316653497, -877.2839499808651, -670.8901146174504, -395.4268131635479, -513.1259561547903, -506.4975066599511, -204.81142555042936, -688.926250883422, -286.9479833621303, -422.55479956144467, -392.23665262814734, -539.3192534177028, -197.63751791415723, -483.7199672837636, -387.9827294074753, -602.9264046520467, -638.7970276594883, -365.96089792353195, -309.6567490220033, -356.9770818859506, -532.5396183757375, -658.71632416506, -16.78978158635239, -734.9616644784982, -548.0467129301743, -495.42602568415487, -662.2547152877517, -530.5040732131878, -760.432316420667, -88.81936153672333, -572.6837080286299, -175.80385519915453, -205.48361801074958, -316.8597899433533, -322.4946073453354, -189.2108405237855, -878.3016768144689, -194.51285412105514, -638.895833453983, -661.2266520457284, -495.4856801818682, 397.3, -111.7419448756262, -315.0848528171227, -638.8992466644323, -218.50336209098788, -47.973207649748076, -315.2100963121514, -395.896034182972, -48.53830921658518, -142.13758141267823, -108.44673618394481, -789.5443577523913, -30.070106675768272, -695.307331671721, 65.60218084697392, -732.2806969541953, -604.3589336690333, -206.60203515737706, -473.915653859802, -615.6360419806218, -228.06615329649964, -190.46697018458264, -517.176655381742, -164.95700727844098, -285.22838915291794, -427.7479511417344, -668.3481739165876, -537.6273688716283, -371.890291210742, -363.21975935741324, -278.7901771456344, 364.2463718875887, -633.8203289223239, -621.4683806921748, -350.80701281315015, -82.89128227737872, -989.4450671957516, -577.1470955586176, -397.31437834471353, -684.9429398994146, -433.91880835591604, -656.9344209295976, -308.43856950609774, -716.321387244432, 63.01646864503837, -46.20318767628487, -340.8481318187719, -413.52916073011903, -447.0896596235409, -879.6463735299743, 208.91066502409717, -710.2676516347312, -89.67035660568712, -263.01909961069475, -320.6698001468065, -472.5913437317141, -623.8084389196522, -576.1570240587178, -627.4879333225854, -569.1448358434208, -154.70928273957892], "policy_predator_policy_reward": [707.1427845784867, 660.6090685654513, 494.4735081913896, 498.39434050338724, 454.96359948886106, 478.33224213014927, 529.4433727599559, 718.1633422501718, 197.3487142765423, 609.4797983477338, 747.5035162956929, 367.8386412297784, 415.99189783136643, 832.983872549679, 742.4802066109505, 661.767358277254, 524.3202846001127, 678.448623126598, 628.2851227931975, 7.018952436429344, 791.2822313872085, 182.99404900236422, 719.1746833989581, 637.2405495260526, 413.8024737336191, 296.10439113939594, 214.38022050461169, 545.5037685737321, 344.6164415798113, 381.20661415894136, 450.2153304586374, 477.4550201915727, 589.2824464081104, 213.891795503173, 873.0538307146054, 577.2002852434831, 571.8823401097079, 495.66776420226034, 535.9461049281999, 579.6668036429867, 632.5387647403801, 716.0094058887739, 369.8528673866525, 273.9872552608758, 858.5803582623976, 188.81204438650056, 571.3067673959524, 537.234989661061, 511.6117641063313, 575.5484629869428, 440.37877823933604, 394.49299679898286, 397.03226219775166, 290.4671680841686, 735.2097289245221, 545.9609132343392, 782.358996174104, 621.205654364059, 449.59199106033606, 637.4421694064459, 714.5221508814922, 645.2375704728134, 554.2529986358857, 619.2485545534649, 741.7635181708084, 666.6514554922345, 586.1996704878153, 696.1562655981141, 232.36908001159196, 223.02581944692642, 784.0317571205215, 304.3141572052837, 588.6385391980244, 300.59769824916714, 506.8252810845413, 566.6350768680325, 592.5669631342279, 651.6755430495542, 690.4035671319581, 624.9593217301962, 296.2709187327804, 385.60421240726794, 497.30473093949604, 66.3584923745163, 403.2286150848199, 383.0014714437053, 594.5541920053255, 504.07984186176964, 30.553246902149105, 532.7517176276501, 287.1809677381741, 325.75637313935033, 108.15515051714753, 654.1868166800641, 719.9110782144845, 276.73602262411964, 731.8962625165728, 597.280082723539, 584.5987430524718, 850.9384952844704, 606.2864026642723, 545.8819910719227, 521.3420726783086, 528.3975066599505, 732.0660182084364, 639.2779770542622, 368.77354159123615, 386.7300396729447, 218.37299470771595, 547.9774364682703, 614.9832604479825, 560.1826328206166, 484.79810356017805, 606.7264046520464, 668.7463497502035, 598.3102544795397, 556.123003999955, 122.04697127755269, 627.8586901859871, 666.9386068406678, 645.7083311760057, 574.5098796263225, 526.709166687285, 656.0428743794056, 665.6547152877517, 541.2579379183795, 576.9868130811885, 735.4609567195635, 548.8520514636615, 545.0949886978389, 11.582035499078014, 591.7714415192933, 293.06454088903394, 474.04413063039857, 362.681312709708, 892.6661183972611, 644.4498073687098, 660.2060608211335, 372.2488169964173, 301.7418713609641, 167.17473613845436, 303.5717321399276, 634.1801225288294, 327.2585997975144, 329.88509620564236, 312.0937481707391, 441.3916379539065, 73.188210624504, 132.50811844649576, 443.4245604842451, 730.9856435706592, 318.78845192740215, 649.0857022101161, 616.162699154428, 558.5624452983694, 711.0384089621249, 400.79665368006505, 531.0111963940444, 581.8181558433077, 584.5325650206869, 429.46283550826047, 498.66005137257747, 190.35700727843957, 305.12838915292053, 599.5452031327225, 654.4435257686416, 562.4716568921881, 370.3828554765471, 317.6968660543477, 438.82783260156697, 589.4741312285717, 610.2102994445357, 482.3247910609322, 515.5103546521356, 695.6083912193099, 506.8216423637459, 607.7426988806106, 350.81363619762305, 684.9429398994146, 443.21880835591804, 682.6319666311359, 466.3201690915087, 523.1536120906316, 647.6413031949443, 614.5643525014881, 196.87325128914787, 424.3291607301201, 454.8896596235426, 831.5676683218848, 148.3201899620436, 586.8059073878825, 722.421876669167, 231.95416370884175, 391.66559465466133, 690.3708823615359, 552.4501461551056, 578.7570240587182, 627.4879333225854, 448.22134134367155, 548.0809054638036]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.949519946528738, "mean_inference_ms": 4.413550073554536, "mean_action_processing_ms": 1.6413664232443608, "mean_env_wait_ms": 12.674095727055505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005578041076660156, "StateBufferConnector_ms": 0.00991809368133545, "ViewRequirementAgentConnector_ms": 0.20707440376281738}, "num_episodes": 12, "episode_return_max": 930.1104736383732, "episode_return_min": -165.20547486986484, "episode_return_mean": 230.21798217212475, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.93139854053175, "num_env_steps_trained_throughput_per_sec": 155.93139854053175, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 1552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1552000, "timers": {"training_iteration_time_ms": 25899.521, "restore_workers_time_ms": 0.027, "training_step_time_ms": 25899.284, "sample_time_ms": 2582.724, "learn_time_ms": 23294.558, "learn_throughput": 171.714, "synch_weights_time_ms": 19.22}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "done": false, "training_iteration": 97, "trial_id": "0b608_00000", "date": "2024-08-22_14-27-01", "timestamp": 1724317021, "time_this_iter_s": 25.699259042739868, "time_total_s": 2512.988186120987, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30e491700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2512.988186120987, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 31.96486486486487, "ram_util_percent": 83.02972972972974}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.728897687114735, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.090113707951137, "policy_loss": -0.007459929690908187, "vf_loss": 7.096855254400344, "vf_explained_var": 0.02646049387240536, "kl": 0.007183645443162984, "entropy": 0.29739750940648335, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 92138.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 33.157525343617436, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.006799094891422, "policy_loss": -0.009094694753980668, "vf_loss": 7.0142235165550595, "vf_explained_var": 0.3426011185797434, "kl": 0.008351303148699344, "entropy": 0.5732436345052467, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 92138.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "env_runners": {"episode_reward_max": 930.1104736383732, "episode_reward_min": -165.20547486986484, "episode_reward_mean": 231.648553138423, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -989.4450671957516, "predator_policy": 7.018952436429344}, "policy_reward_max": {"prey_policy": 397.3, "predator_policy": 892.6661183972611}, "policy_reward_mean": {"prey_policy": -379.37291745553665, "predator_policy": 495.1971940247484}, "custom_metrics": {}, "hist_stats": {"episode_reward": [98.70895599288208, 303.5683243881713, 833.4208174852164, 32.8000000000002, 30.440084327183893, 33.23416682320429, 18.07834002268785, 120.74749934888787, 106.388053604135, 47.0, 398.0667131686579, 457.43226089744945, 237.6522230529728, 89.66416877145984, 380.21609707477285, 116.60461759610301, 356.96176451635336, 12.070607115960263, 461.4601115284464, 0.9280325111852694, -37.15081477260557, 21.889802674234076, 749.756727176885, 649.876148415349, 777.7494449470844, -16.259357922290413, 210.01621247691804, 84.24948963797699, 260.09052746125076, 85.03866993651307, 387.93856909402973, 126.56260551342484, -10.70827807964974, 153.423305376532, 313.6586510660095, -45.733594767847094, 663.8413801367099, 79.15391859687948, 315.81410565883954, 739.3769038000132, 379.10675518954463, 85.85146595519572, 30.116116523516894, 477.6063188288476, 46.0007983406082, -165.20547486986484, 493.8084080706753, 100.61537415269991, 262.29867864672354, 11.536144369551126, 103.54135448585725, 468.46676473748016, 139.27930245235748, 14.153864705190191, 463.1960918433639, 345.4594769337172, 81.01006906426758, 255.40322365030843, 182.53290017144576, 4.533382690131508, 575.8050081755127, 43.91967058563589, 104.03611357092372, 278.79554041447824, 70.14550517885317, 325.34836133411886, 230.15963106990498, 635.5432505397968, -67.03877636273326, 251.29016105693117, 322.6485255868725, 220.47926131451175, 45.300000000000374, 157.89260384303958, 23.33685228636531, 114.51476215286681, 930.1104736383732, 25.559752207740686, 130.09368410992695, -15.905138825097168, 9.299999999999983, 183.57914528695002, 517.4899966861823, 424.38628429558247, 18.599999999999994, 309.1521497780518, 509.2897758166356, 39.93085860600135, 146.42124586527396, 2.6000000000000014, 272.4481282244761, 210.75507568295959, 444.003923665882, 8.881019741338745, 705.2142688711242, 63.837751255607586, 545.0821401113436, 421.87342145237955, 463.6321778396573, 43.00443819123467], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-512.8398930131004, -23.755226223640168, 131.86636344782542, -802.5743194492269, 221.51339367011133, -744.5078091099042, -403.1024737336168, -274.004391139391, -193.86709186782798, -535.5768128833324, -326.9537634546257, -365.6351254609156, -439.2215135033711, -470.3704971241482, -490.2965725245209, -192.13017003787624, -387.4514035923632, -956.4146587615866, -569.3823401097079, -451.1677642022607, -552.4960934540403, -165.05010194849373, -38.37559180313976, -852.7403179285659, -42.218446190981744, -363.9694534035738, -877.8981279973016, -79.83010588013858, -638.0744318671817, -90.25122811506225, -470.69757493923606, -499.8580345579314, -321.64025822456426, -156.26975229740412, -364.00605874955943, -311.42276441639825, -793.0510492616099, -26.659481368807796, -782.358996174104, -620.2776218528737, -608.6688993029724, -515.5160759364155, -669.6772790282708, -668.1926396518012, 244.44665838230466, -668.1914843947711, 45.34276721244022, -803.8815924601322, -705.7326971838017, 201.1262060449566, -196.84753806049127, -274.8067193203191, -782.7308375212922, -95.59886432759507, -289.62739555218053, -515.3593522570314, -462.3323293784305, -351.03750111288673, -730.5222921365448, -428.6815441107191, -339.6730615322919, -587.7512582358294, -504.5501048916593, -50.76242073496329, -409.2264479231072, -165.14505347055623, -238.31408684142784, -394.49269431056354, -220.01413156484722, -564.9612512362398, -237.07008661510312, -371.968472682542, -243.8978728293359, 294.8019120885224, -25.546626006246584, -657.6414225940845, -724.6338671527241, 43.80087197295943, -755.7789245881688, 165.97948314807073, -179.14653316653497, -877.2839499808651, -670.8901146174504, -395.4268131635479, -513.1259561547903, -506.4975066599511, -204.81142555042936, -688.926250883422, -286.9479833621303, -422.55479956144467, -392.23665262814734, -539.3192534177028, -197.63751791415723, -483.7199672837636, -387.9827294074753, -602.9264046520467, -638.7970276594883, -365.96089792353195, -309.6567490220033, -356.9770818859506, -532.5396183757375, -658.71632416506, -16.78978158635239, -734.9616644784982, -548.0467129301743, -495.42602568415487, -662.2547152877517, -530.5040732131878, -760.432316420667, -88.81936153672333, -572.6837080286299, -175.80385519915453, -205.48361801074958, -316.8597899433533, -322.4946073453354, -189.2108405237855, -878.3016768144689, -194.51285412105514, -638.895833453983, -661.2266520457284, -495.4856801818682, 397.3, -111.7419448756262, -315.0848528171227, -638.8992466644323, -218.50336209098788, -47.973207649748076, -315.2100963121514, -395.896034182972, -48.53830921658518, -142.13758141267823, -108.44673618394481, -789.5443577523913, -30.070106675768272, -695.307331671721, 65.60218084697392, -732.2806969541953, -604.3589336690333, -206.60203515737706, -473.915653859802, -615.6360419806218, -228.06615329649964, -190.46697018458264, -517.176655381742, -164.95700727844098, -285.22838915291794, -427.7479511417344, -668.3481739165876, -537.6273688716283, -371.890291210742, -363.21975935741324, -278.7901771456344, 364.2463718875887, -633.8203289223239, -621.4683806921748, -350.80701281315015, -82.89128227737872, -989.4450671957516, -577.1470955586176, -397.31437834471353, -684.9429398994146, -433.91880835591604, -656.9344209295976, -308.43856950609774, -716.321387244432, 63.01646864503837, -46.20318767628487, -340.8481318187719, -413.52916073011903, -447.0896596235409, -879.6463735299743, 208.91066502409717, -710.2676516347312, -89.67035660568712, -263.01909961069475, -320.6698001468065, -472.5913437317141, -623.8084389196522, -576.1570240587178, -627.4879333225854, -569.1448358434208, -154.70928273957892, -505.37667543765104, 15.52808646266343, -534.9385802171724, -103.20723522048058, -460.9455586473397, -654.1120990743458, -566.1825475408299, 388.8196734084136, -39.96655263423012, -22.82013715829256, 152.97663750810824, -722.6682013728997, -556.9987918319206, -123.99742048579114, -500.49022878753175, 197.7246962330453, -481.3654218106616, -147.05363326539126], "policy_predator_policy_reward": [628.2851227931975, 7.018952436429344, 791.2822313872085, 182.99404900236422, 719.1746833989581, 637.2405495260526, 413.8024737336191, 296.10439113939594, 214.38022050461169, 545.5037685737321, 344.6164415798113, 381.20661415894136, 450.2153304586374, 477.4550201915727, 589.2824464081104, 213.891795503173, 873.0538307146054, 577.2002852434831, 571.8823401097079, 495.66776420226034, 535.9461049281999, 579.6668036429867, 632.5387647403801, 716.0094058887739, 369.8528673866525, 273.9872552608758, 858.5803582623976, 188.81204438650056, 571.3067673959524, 537.234989661061, 511.6117641063313, 575.5484629869428, 440.37877823933604, 394.49299679898286, 397.03226219775166, 290.4671680841686, 735.2097289245221, 545.9609132343392, 782.358996174104, 621.205654364059, 449.59199106033606, 637.4421694064459, 714.5221508814922, 645.2375704728134, 554.2529986358857, 619.2485545534649, 741.7635181708084, 666.6514554922345, 586.1996704878153, 696.1562655981141, 232.36908001159196, 223.02581944692642, 784.0317571205215, 304.3141572052837, 588.6385391980244, 300.59769824916714, 506.8252810845413, 566.6350768680325, 592.5669631342279, 651.6755430495542, 690.4035671319581, 624.9593217301962, 296.2709187327804, 385.60421240726794, 497.30473093949604, 66.3584923745163, 403.2286150848199, 383.0014714437053, 594.5541920053255, 504.07984186176964, 30.553246902149105, 532.7517176276501, 287.1809677381741, 325.75637313935033, 108.15515051714753, 654.1868166800641, 719.9110782144845, 276.73602262411964, 731.8962625165728, 597.280082723539, 584.5987430524718, 850.9384952844704, 606.2864026642723, 545.8819910719227, 521.3420726783086, 528.3975066599505, 732.0660182084364, 639.2779770542622, 368.77354159123615, 386.7300396729447, 218.37299470771595, 547.9774364682703, 614.9832604479825, 560.1826328206166, 484.79810356017805, 606.7264046520464, 668.7463497502035, 598.3102544795397, 556.123003999955, 122.04697127755269, 627.8586901859871, 666.9386068406678, 645.7083311760057, 574.5098796263225, 526.709166687285, 656.0428743794056, 665.6547152877517, 541.2579379183795, 576.9868130811885, 735.4609567195635, 548.8520514636615, 545.0949886978389, 11.582035499078014, 591.7714415192933, 293.06454088903394, 474.04413063039857, 362.681312709708, 892.6661183972611, 644.4498073687098, 660.2060608211335, 372.2488169964173, 301.7418713609641, 167.17473613845436, 303.5717321399276, 634.1801225288294, 327.2585997975144, 329.88509620564236, 312.0937481707391, 441.3916379539065, 73.188210624504, 132.50811844649576, 443.4245604842451, 730.9856435706592, 318.78845192740215, 649.0857022101161, 616.162699154428, 558.5624452983694, 711.0384089621249, 400.79665368006505, 531.0111963940444, 581.8181558433077, 584.5325650206869, 429.46283550826047, 498.66005137257747, 190.35700727843957, 305.12838915292053, 599.5452031327225, 654.4435257686416, 562.4716568921881, 370.3828554765471, 317.6968660543477, 438.82783260156697, 589.4741312285717, 610.2102994445357, 482.3247910609322, 515.5103546521356, 695.6083912193099, 506.8216423637459, 607.7426988806106, 350.81363619762305, 684.9429398994146, 443.21880835591804, 682.6319666311359, 466.3201690915087, 523.1536120906316, 647.6413031949443, 614.5643525014881, 196.87325128914787, 424.3291607301201, 454.8896596235426, 831.5676683218848, 148.3201899620436, 586.8059073878825, 722.421876669167, 231.95416370884175, 391.66559465466133, 690.3708823615359, 552.4501461551056, 578.7570240587182, 627.4879333225854, 448.22134134367155, 548.0809054638036, 496.3488480015808, 204.25481665636826, 696.6387187915933, 385.5110203119403, 605.8842836268026, 518.0543938362218, 519.9916452830524, 362.58549772048946, 108.83734818008453, 17.787092868046404, 452.79298147574343, 661.9807225003875, 446.1403062857408, 656.7293274843521, 323.23798804417845, 443.15972234996417, 492.31843544084484, 179.1050578264423]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.9480419475547714, "mean_inference_ms": 4.419922064715565, "mean_action_processing_ms": 1.6448881827230313, "mean_env_wait_ms": 12.687765667876384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005257964134216309, "StateBufferConnector_ms": 0.009005308151245117, "ViewRequirementAgentConnector_ms": 0.1964426040649414}, "num_episodes": 9, "episode_return_max": 930.1104736383732, "episode_return_min": -165.20547486986484, "episode_return_mean": 231.648553138423, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.307918353317, "num_env_steps_trained_throughput_per_sec": 155.307918353317, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 1568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1568000, "timers": {"training_iteration_time_ms": 25866.055, "restore_workers_time_ms": 0.025, "training_step_time_ms": 25865.813, "sample_time_ms": 2532.122, "learn_time_ms": 23308.825, "learn_throughput": 171.609, "synch_weights_time_ms": 21.968}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "done": false, "training_iteration": 98, "trial_id": "0b608_00000", "date": "2024-08-22_14-27-27", "timestamp": 1724317047, "time_this_iter_s": 25.804288864135742, "time_total_s": 2538.7924749851227, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a38d1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2538.7924749851227, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 33.202777777777776, "ram_util_percent": 82.85833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.097069269513327, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.187644348447285, "policy_loss": -0.012431662398139162, "vf_loss": 7.1991181106163715, "vf_explained_var": -0.06926199424834478, "kl": 0.009578989835322968, "entropy": 0.3305009076677302, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93083.0, "diff_num_grad_updates_vs_sampler_policy": 493.2624999999971}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.179689082140644, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.018108215533867, "policy_loss": -0.00782148339268234, "vf_loss": 7.024446608528258, "vf_explained_var": 0.30608416751579004, "kl": 0.007415467244449746, "entropy": 0.5638004731879663, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93083.0, "diff_num_grad_updates_vs_sampler_policy": 493.2624999999971}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 930.1104736383732, "episode_reward_min": -165.20547486986484, "episode_reward_mean": 235.42399921891933, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -989.4450671957516, "predator_policy": 11.582035499078014}, "policy_reward_max": {"prey_policy": 397.3, "predator_policy": 892.6661183972611}, "policy_reward_mean": {"prey_policy": -371.94036347072955, "predator_policy": 489.6523630801894}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89.66416877145984, 380.21609707477285, 116.60461759610301, 356.96176451635336, 12.070607115960263, 461.4601115284464, 0.9280325111852694, -37.15081477260557, 21.889802674234076, 749.756727176885, 649.876148415349, 777.7494449470844, -16.259357922290413, 210.01621247691804, 84.24948963797699, 260.09052746125076, 85.03866993651307, 387.93856909402973, 126.56260551342484, -10.70827807964974, 153.423305376532, 313.6586510660095, -45.733594767847094, 663.8413801367099, 79.15391859687948, 315.81410565883954, 739.3769038000132, 379.10675518954463, 85.85146595519572, 30.116116523516894, 477.6063188288476, 46.0007983406082, -165.20547486986484, 493.8084080706753, 100.61537415269991, 262.29867864672354, 11.536144369551126, 103.54135448585725, 468.46676473748016, 139.27930245235748, 14.153864705190191, 463.1960918433639, 345.4594769337172, 81.01006906426758, 255.40322365030843, 182.53290017144576, 4.533382690131508, 575.8050081755127, 43.91967058563589, 104.03611357092372, 278.79554041447824, 70.14550517885317, 325.34836133411886, 230.15963106990498, 635.5432505397968, -67.03877636273326, 251.29016105693117, 322.6485255868725, 220.47926131451175, 45.300000000000374, 157.89260384303958, 23.33685228636531, 114.51476215286681, 930.1104736383732, 25.559752207740686, 130.09368410992695, -15.905138825097168, 9.299999999999983, 183.57914528695002, 517.4899966861823, 424.38628429558247, 18.599999999999994, 309.1521497780518, 509.2897758166356, 39.93085860600135, 146.42124586527396, 2.6000000000000014, 272.4481282244761, 210.75507568295959, 444.003923665882, 8.881019741338745, 705.2142688711242, 63.837751255607586, 545.0821401113436, 421.87342145237955, 463.6321778396573, 43.00443819123467, 56.02420882693065, 7.204846279865812, 187.46434214969224, 277.5353376397014, 481.7003889259115, 127.18423012242879, 117.96228152404596, 84.78175575075726, 556.1808663097238, 386.092346134961, 166.0032820050022, 25.43681461686843, 621.5113468751906], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-877.8981279973016, -79.83010588013858, -638.0744318671817, -90.25122811506225, -470.69757493923606, -499.8580345579314, -321.64025822456426, -156.26975229740412, -364.00605874955943, -311.42276441639825, -793.0510492616099, -26.659481368807796, -782.358996174104, -620.2776218528737, -608.6688993029724, -515.5160759364155, -669.6772790282708, -668.1926396518012, 244.44665838230466, -668.1914843947711, 45.34276721244022, -803.8815924601322, -705.7326971838017, 201.1262060449566, -196.84753806049127, -274.8067193203191, -782.7308375212922, -95.59886432759507, -289.62739555218053, -515.3593522570314, -462.3323293784305, -351.03750111288673, -730.5222921365448, -428.6815441107191, -339.6730615322919, -587.7512582358294, -504.5501048916593, -50.76242073496329, -409.2264479231072, -165.14505347055623, -238.31408684142784, -394.49269431056354, -220.01413156484722, -564.9612512362398, -237.07008661510312, -371.968472682542, -243.8978728293359, 294.8019120885224, -25.546626006246584, -657.6414225940845, -724.6338671527241, 43.80087197295943, -755.7789245881688, 165.97948314807073, -179.14653316653497, -877.2839499808651, -670.8901146174504, -395.4268131635479, -513.1259561547903, -506.4975066599511, -204.81142555042936, -688.926250883422, -286.9479833621303, -422.55479956144467, -392.23665262814734, -539.3192534177028, -197.63751791415723, -483.7199672837636, -387.9827294074753, -602.9264046520467, -638.7970276594883, -365.96089792353195, -309.6567490220033, -356.9770818859506, -532.5396183757375, -658.71632416506, -16.78978158635239, -734.9616644784982, -548.0467129301743, -495.42602568415487, -662.2547152877517, -530.5040732131878, -760.432316420667, -88.81936153672333, -572.6837080286299, -175.80385519915453, -205.48361801074958, -316.8597899433533, -322.4946073453354, -189.2108405237855, -878.3016768144689, -194.51285412105514, -638.895833453983, -661.2266520457284, -495.4856801818682, 397.3, -111.7419448756262, -315.0848528171227, -638.8992466644323, -218.50336209098788, -47.973207649748076, -315.2100963121514, -395.896034182972, -48.53830921658518, -142.13758141267823, -108.44673618394481, -789.5443577523913, -30.070106675768272, -695.307331671721, 65.60218084697392, -732.2806969541953, -604.3589336690333, -206.60203515737706, -473.915653859802, -615.6360419806218, -228.06615329649964, -190.46697018458264, -517.176655381742, -164.95700727844098, -285.22838915291794, -427.7479511417344, -668.3481739165876, -537.6273688716283, -371.890291210742, -363.21975935741324, -278.7901771456344, 364.2463718875887, -633.8203289223239, -621.4683806921748, -350.80701281315015, -82.89128227737872, -989.4450671957516, -577.1470955586176, -397.31437834471353, -684.9429398994146, -433.91880835591604, -656.9344209295976, -308.43856950609774, -716.321387244432, 63.01646864503837, -46.20318767628487, -340.8481318187719, -413.52916073011903, -447.0896596235409, -879.6463735299743, 208.91066502409717, -710.2676516347312, -89.67035660568712, -263.01909961069475, -320.6698001468065, -472.5913437317141, -623.8084389196522, -576.1570240587178, -627.4879333225854, -569.1448358434208, -154.70928273957892, -505.37667543765104, 15.52808646266343, -534.9385802171724, -103.20723522048058, -460.9455586473397, -654.1120990743458, -566.1825475408299, 388.8196734084136, -39.96655263423012, -22.82013715829256, 152.97663750810824, -722.6682013728997, -556.9987918319206, -123.99742048579114, -500.49022878753175, 197.7246962330453, -481.3654218106616, -147.05363326539126, -437.76865304750237, -372.32025660351064, -533.4786765200497, -501.6602913678146, -568.736681391312, -356.27662053668706, -460.90682345955577, -112.0248061341199, 88.00133164235298, -649.3039231489965, -293.9169800916693, -477.702218514234, -410.3508936070363, -471.6645779045227, -453.4681161479342, -297.9597485187858, 371.3837869190407, -646.2262024705838, -703.9639221566556, -151.405583381662, -3.6356206336702903, -226.60682902631444, -105.1275741986791, -191.07064796741764, -517.7944746891434, 169.77372611561077], "policy_predator_policy_reward": [858.5803582623976, 188.81204438650056, 571.3067673959524, 537.234989661061, 511.6117641063313, 575.5484629869428, 440.37877823933604, 394.49299679898286, 397.03226219775166, 290.4671680841686, 735.2097289245221, 545.9609132343392, 782.358996174104, 621.205654364059, 449.59199106033606, 637.4421694064459, 714.5221508814922, 645.2375704728134, 554.2529986358857, 619.2485545534649, 741.7635181708084, 666.6514554922345, 586.1996704878153, 696.1562655981141, 232.36908001159196, 223.02581944692642, 784.0317571205215, 304.3141572052837, 588.6385391980244, 300.59769824916714, 506.8252810845413, 566.6350768680325, 592.5669631342279, 651.6755430495542, 690.4035671319581, 624.9593217301962, 296.2709187327804, 385.60421240726794, 497.30473093949604, 66.3584923745163, 403.2286150848199, 383.0014714437053, 594.5541920053255, 504.07984186176964, 30.553246902149105, 532.7517176276501, 287.1809677381741, 325.75637313935033, 108.15515051714753, 654.1868166800641, 719.9110782144845, 276.73602262411964, 731.8962625165728, 597.280082723539, 584.5987430524718, 850.9384952844704, 606.2864026642723, 545.8819910719227, 521.3420726783086, 528.3975066599505, 732.0660182084364, 639.2779770542622, 368.77354159123615, 386.7300396729447, 218.37299470771595, 547.9774364682703, 614.9832604479825, 560.1826328206166, 484.79810356017805, 606.7264046520464, 668.7463497502035, 598.3102544795397, 556.123003999955, 122.04697127755269, 627.8586901859871, 666.9386068406678, 645.7083311760057, 574.5098796263225, 526.709166687285, 656.0428743794056, 665.6547152877517, 541.2579379183795, 576.9868130811885, 735.4609567195635, 548.8520514636615, 545.0949886978389, 11.582035499078014, 591.7714415192933, 293.06454088903394, 474.04413063039857, 362.681312709708, 892.6661183972611, 644.4498073687098, 660.2060608211335, 372.2488169964173, 301.7418713609641, 167.17473613845436, 303.5717321399276, 634.1801225288294, 327.2585997975144, 329.88509620564236, 312.0937481707391, 441.3916379539065, 73.188210624504, 132.50811844649576, 443.4245604842451, 730.9856435706592, 318.78845192740215, 649.0857022101161, 616.162699154428, 558.5624452983694, 711.0384089621249, 400.79665368006505, 531.0111963940444, 581.8181558433077, 584.5325650206869, 429.46283550826047, 498.66005137257747, 190.35700727843957, 305.12838915292053, 599.5452031327225, 654.4435257686416, 562.4716568921881, 370.3828554765471, 317.6968660543477, 438.82783260156697, 589.4741312285717, 610.2102994445357, 482.3247910609322, 515.5103546521356, 695.6083912193099, 506.8216423637459, 607.7426988806106, 350.81363619762305, 684.9429398994146, 443.21880835591804, 682.6319666311359, 466.3201690915087, 523.1536120906316, 647.6413031949443, 614.5643525014881, 196.87325128914787, 424.3291607301201, 454.8896596235426, 831.5676683218848, 148.3201899620436, 586.8059073878825, 722.421876669167, 231.95416370884175, 391.66559465466133, 690.3708823615359, 552.4501461551056, 578.7570240587182, 627.4879333225854, 448.22134134367155, 548.0809054638036, 496.3488480015808, 204.25481665636826, 696.6387187915933, 385.5110203119403, 605.8842836268026, 518.0543938362218, 519.9916452830524, 362.58549772048946, 108.83734818008453, 17.787092868046404, 452.79298147574343, 661.9807225003875, 446.1403062857408, 656.7293274843521, 323.23798804417845, 443.15972234996417, 492.31843544084484, 179.1050578264423, 412.8942574986349, 453.218860979309, 534.77867652005, 507.5651376476809, 515.4543103799863, 597.0233336977043, 567.7485469029568, 282.71842033042316, 506.24051309363557, 536.7624673389199, 235.24232376853453, 663.5611049597999, 415.35733346801396, 584.6204195675899, 457.5374594902998, 378.6721609271802, 617.482579297961, 213.54070256330465, 541.837254289656, 699.6245973836252, 162.6170366467268, 233.62869501826168, 79.51463954714508, 242.12039723581734, 454.1024178701317, 515.4296775785897]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.948924512606091, "mean_inference_ms": 4.405567800686084, "mean_action_processing_ms": 1.652871500717902, "mean_env_wait_ms": 12.688137643097367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004572153091430664, "StateBufferConnector_ms": 0.005044460296630859, "ViewRequirementAgentConnector_ms": 0.12981069087982178}, "num_episodes": 13, "episode_return_max": 930.1104736383732, "episode_return_min": -165.20547486986484, "episode_return_mean": 235.42399921891933, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.89642417109806, "num_env_steps_trained_throughput_per_sec": 154.89642417109806, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 25786.382, "restore_workers_time_ms": 0.027, "training_step_time_ms": 25786.156, "sample_time_ms": 2411.33, "learn_time_ms": 23351.291, "learn_throughput": 171.297, "synch_weights_time_ms": 21.081}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 99, "trial_id": "0b608_00000", "date": "2024-08-22_14-27-53", "timestamp": 1724317073, "time_this_iter_s": 25.87632393836975, "time_total_s": 2564.6687989234924, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30e4741f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2564.6687989234924, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 32.675675675675684, "ram_util_percent": 83.0891891891892}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.810931699742717, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.04558997532678, "policy_loss": -0.008626659687056585, "vf_loss": 7.053512392094526, "vf_explained_var": 0.12987904946009318, "kl": 0.007042333601589595, "entropy": 0.2722452781503163, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 94028.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 34.33387846189832, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.100638500597111, "policy_loss": -0.007998831850038003, "vf_loss": 7.10735845515337, "vf_explained_var": 0.4835566000332908, "kl": 0.006394367639428724, "entropy": 0.5266360229916043, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 94028.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 930.1104736383732, "episode_reward_min": -165.20547486986484, "episode_reward_mean": 236.62618024052688, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -989.4450671957516, "predator_policy": 11.582035499078014}, "policy_reward_max": {"prey_policy": 397.3, "predator_policy": 892.6661183972611}, "policy_reward_mean": {"prey_policy": -363.8699444635861, "predator_policy": 482.18303458384975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [749.756727176885, 649.876148415349, 777.7494449470844, -16.259357922290413, 210.01621247691804, 84.24948963797699, 260.09052746125076, 85.03866993651307, 387.93856909402973, 126.56260551342484, -10.70827807964974, 153.423305376532, 313.6586510660095, -45.733594767847094, 663.8413801367099, 79.15391859687948, 315.81410565883954, 739.3769038000132, 379.10675518954463, 85.85146595519572, 30.116116523516894, 477.6063188288476, 46.0007983406082, -165.20547486986484, 493.8084080706753, 100.61537415269991, 262.29867864672354, 11.536144369551126, 103.54135448585725, 468.46676473748016, 139.27930245235748, 14.153864705190191, 463.1960918433639, 345.4594769337172, 81.01006906426758, 255.40322365030843, 182.53290017144576, 4.533382690131508, 575.8050081755127, 43.91967058563589, 104.03611357092372, 278.79554041447824, 70.14550517885317, 325.34836133411886, 230.15963106990498, 635.5432505397968, -67.03877636273326, 251.29016105693117, 322.6485255868725, 220.47926131451175, 45.300000000000374, 157.89260384303958, 23.33685228636531, 114.51476215286681, 930.1104736383732, 25.559752207740686, 130.09368410992695, -15.905138825097168, 9.299999999999983, 183.57914528695002, 517.4899966861823, 424.38628429558247, 18.599999999999994, 309.1521497780518, 509.2897758166356, 39.93085860600135, 146.42124586527396, 2.6000000000000014, 272.4481282244761, 210.75507568295959, 444.003923665882, 8.881019741338745, 705.2142688711242, 63.837751255607586, 545.0821401113436, 421.87342145237955, 463.6321778396573, 43.00443819123467, 56.02420882693065, 7.204846279865812, 187.46434214969224, 277.5353376397014, 481.7003889259115, 127.18423012242879, 117.96228152404596, 84.78175575075726, 556.1808663097238, 386.092346134961, 166.0032820050022, 25.43681461686843, 621.5113468751906, -1.9984014443252818e-15, 103.060430064228, 548.4594197445089, 241.10467626805007, 89.49336629364456, 136.41972046548773, 228.77645227289906, 129.7682677951224, 45.78015627272094], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [244.44665838230466, -668.1914843947711, 45.34276721244022, -803.8815924601322, -705.7326971838017, 201.1262060449566, -196.84753806049127, -274.8067193203191, -782.7308375212922, -95.59886432759507, -289.62739555218053, -515.3593522570314, -462.3323293784305, -351.03750111288673, -730.5222921365448, -428.6815441107191, -339.6730615322919, -587.7512582358294, -504.5501048916593, -50.76242073496329, -409.2264479231072, -165.14505347055623, -238.31408684142784, -394.49269431056354, -220.01413156484722, -564.9612512362398, -237.07008661510312, -371.968472682542, -243.8978728293359, 294.8019120885224, -25.546626006246584, -657.6414225940845, -724.6338671527241, 43.80087197295943, -755.7789245881688, 165.97948314807073, -179.14653316653497, -877.2839499808651, -670.8901146174504, -395.4268131635479, -513.1259561547903, -506.4975066599511, -204.81142555042936, -688.926250883422, -286.9479833621303, -422.55479956144467, -392.23665262814734, -539.3192534177028, -197.63751791415723, -483.7199672837636, -387.9827294074753, -602.9264046520467, -638.7970276594883, -365.96089792353195, -309.6567490220033, -356.9770818859506, -532.5396183757375, -658.71632416506, -16.78978158635239, -734.9616644784982, -548.0467129301743, -495.42602568415487, -662.2547152877517, -530.5040732131878, -760.432316420667, -88.81936153672333, -572.6837080286299, -175.80385519915453, -205.48361801074958, -316.8597899433533, -322.4946073453354, -189.2108405237855, -878.3016768144689, -194.51285412105514, -638.895833453983, -661.2266520457284, -495.4856801818682, 397.3, -111.7419448756262, -315.0848528171227, -638.8992466644323, -218.50336209098788, -47.973207649748076, -315.2100963121514, -395.896034182972, -48.53830921658518, -142.13758141267823, -108.44673618394481, -789.5443577523913, -30.070106675768272, -695.307331671721, 65.60218084697392, -732.2806969541953, -604.3589336690333, -206.60203515737706, -473.915653859802, -615.6360419806218, -228.06615329649964, -190.46697018458264, -517.176655381742, -164.95700727844098, -285.22838915291794, -427.7479511417344, -668.3481739165876, -537.6273688716283, -371.890291210742, -363.21975935741324, -278.7901771456344, 364.2463718875887, -633.8203289223239, -621.4683806921748, -350.80701281315015, -82.89128227737872, -989.4450671957516, -577.1470955586176, -397.31437834471353, -684.9429398994146, -433.91880835591604, -656.9344209295976, -308.43856950609774, -716.321387244432, 63.01646864503837, -46.20318767628487, -340.8481318187719, -413.52916073011903, -447.0896596235409, -879.6463735299743, 208.91066502409717, -710.2676516347312, -89.67035660568712, -263.01909961069475, -320.6698001468065, -472.5913437317141, -623.8084389196522, -576.1570240587178, -627.4879333225854, -569.1448358434208, -154.70928273957892, -505.37667543765104, 15.52808646266343, -534.9385802171724, -103.20723522048058, -460.9455586473397, -654.1120990743458, -566.1825475408299, 388.8196734084136, -39.96655263423012, -22.82013715829256, 152.97663750810824, -722.6682013728997, -556.9987918319206, -123.99742048579114, -500.49022878753175, 197.7246962330453, -481.3654218106616, -147.05363326539126, -437.76865304750237, -372.32025660351064, -533.4786765200497, -501.6602913678146, -568.736681391312, -356.27662053668706, -460.90682345955577, -112.0248061341199, 88.00133164235298, -649.3039231489965, -293.9169800916693, -477.702218514234, -410.3508936070363, -471.6645779045227, -453.4681161479342, -297.9597485187858, 371.3837869190407, -646.2262024705838, -703.9639221566556, -151.405583381662, -3.6356206336702903, -226.60682902631444, -105.1275741986791, -191.07064796741764, -517.7944746891434, 169.77372611561077, -583.2160389352878, -628.4226700412376, -626.7080272678069, -562.3634854893843, 76.89581414758045, -520.2962618810549, -330.8288191913725, -351.57406079625247, -521.61089491405, -243.7458046423294, -269.36959981521403, -330.9904971791188, -590.6447372157402, -250.17724167375547, -239.31320860770117, -308.4603855359002, -248.34173550832278, -351.09892364599267], "policy_predator_policy_reward": [554.2529986358857, 619.2485545534649, 741.7635181708084, 666.6514554922345, 586.1996704878153, 696.1562655981141, 232.36908001159196, 223.02581944692642, 784.0317571205215, 304.3141572052837, 588.6385391980244, 300.59769824916714, 506.8252810845413, 566.6350768680325, 592.5669631342279, 651.6755430495542, 690.4035671319581, 624.9593217301962, 296.2709187327804, 385.60421240726794, 497.30473093949604, 66.3584923745163, 403.2286150848199, 383.0014714437053, 594.5541920053255, 504.07984186176964, 30.553246902149105, 532.7517176276501, 287.1809677381741, 325.75637313935033, 108.15515051714753, 654.1868166800641, 719.9110782144845, 276.73602262411964, 731.8962625165728, 597.280082723539, 584.5987430524718, 850.9384952844704, 606.2864026642723, 545.8819910719227, 521.3420726783086, 528.3975066599505, 732.0660182084364, 639.2779770542622, 368.77354159123615, 386.7300396729447, 218.37299470771595, 547.9774364682703, 614.9832604479825, 560.1826328206166, 484.79810356017805, 606.7264046520464, 668.7463497502035, 598.3102544795397, 556.123003999955, 122.04697127755269, 627.8586901859871, 666.9386068406678, 645.7083311760057, 574.5098796263225, 526.709166687285, 656.0428743794056, 665.6547152877517, 541.2579379183795, 576.9868130811885, 735.4609567195635, 548.8520514636615, 545.0949886978389, 11.582035499078014, 591.7714415192933, 293.06454088903394, 474.04413063039857, 362.681312709708, 892.6661183972611, 644.4498073687098, 660.2060608211335, 372.2488169964173, 301.7418713609641, 167.17473613845436, 303.5717321399276, 634.1801225288294, 327.2585997975144, 329.88509620564236, 312.0937481707391, 441.3916379539065, 73.188210624504, 132.50811844649576, 443.4245604842451, 730.9856435706592, 318.78845192740215, 649.0857022101161, 616.162699154428, 558.5624452983694, 711.0384089621249, 400.79665368006505, 531.0111963940444, 581.8181558433077, 584.5325650206869, 429.46283550826047, 498.66005137257747, 190.35700727843957, 305.12838915292053, 599.5452031327225, 654.4435257686416, 562.4716568921881, 370.3828554765471, 317.6968660543477, 438.82783260156697, 589.4741312285717, 610.2102994445357, 482.3247910609322, 515.5103546521356, 695.6083912193099, 506.8216423637459, 607.7426988806106, 350.81363619762305, 684.9429398994146, 443.21880835591804, 682.6319666311359, 466.3201690915087, 523.1536120906316, 647.6413031949443, 614.5643525014881, 196.87325128914787, 424.3291607301201, 454.8896596235426, 831.5676683218848, 148.3201899620436, 586.8059073878825, 722.421876669167, 231.95416370884175, 391.66559465466133, 690.3708823615359, 552.4501461551056, 578.7570240587182, 627.4879333225854, 448.22134134367155, 548.0809054638036, 496.3488480015808, 204.25481665636826, 696.6387187915933, 385.5110203119403, 605.8842836268026, 518.0543938362218, 519.9916452830524, 362.58549772048946, 108.83734818008453, 17.787092868046404, 452.79298147574343, 661.9807225003875, 446.1403062857408, 656.7293274843521, 323.23798804417845, 443.15972234996417, 492.31843544084484, 179.1050578264423, 412.8942574986349, 453.218860979309, 534.77867652005, 507.5651376476809, 515.4543103799863, 597.0233336977043, 567.7485469029568, 282.71842033042316, 506.24051309363557, 536.7624673389199, 235.24232376853453, 663.5611049597999, 415.35733346801396, 584.6204195675899, 457.5374594902998, 378.6721609271802, 617.482579297961, 213.54070256330465, 541.837254289656, 699.6245973836252, 162.6170366467268, 233.62869501826168, 79.51463954714508, 242.12039723581734, 454.1024178701317, 515.4296775785897, 583.2160389352878, 628.4226700412376, 616.9848861335034, 675.1470566879196, 559.664076045523, 432.19579143245994, 518.4906334920837, 405.01692276359523, 575.2852187164016, 279.5648471336204, 385.44353713000913, 351.33628032981755, 547.3867558344217, 522.2116753279784, 599.6137268669518, 77.92813507176835, 318.4001810852595, 326.8206343417737]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.954371480846042, "mean_inference_ms": 4.414580221387782, "mean_action_processing_ms": 1.6340141197903784, "mean_env_wait_ms": 12.69869803929163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004554271697998047, "StateBufferConnector_ms": 0.005121588706970215, "ViewRequirementAgentConnector_ms": 0.14476561546325684}, "num_episodes": 9, "episode_return_max": 930.1104736383732, "episode_return_min": -165.20547486986484, "episode_return_mean": 236.62618024052688, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 157.40409842270776, "num_env_steps_trained_throughput_per_sec": 157.40409842270776, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 25733.113, "restore_workers_time_ms": 0.025, "training_step_time_ms": 25732.852, "sample_time_ms": 2387.639, "learn_time_ms": 23320.776, "learn_throughput": 171.521, "synch_weights_time_ms": 21.961}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": true, "training_iteration": 100, "trial_id": "0b608_00000", "date": "2024-08-22_14-28-19", "timestamp": 1724317099, "time_this_iter_s": 25.481299877166748, "time_total_s": 2590.150098800659, "pid": 32714, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30e491160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2590.150098800659, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 32.222222222222214, "ram_util_percent": 83.16944444444444}}
