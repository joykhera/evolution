{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7939148229018897, "cur_kl_coeff": 0.2, "cur_lr": 0.00010783655643585859, "total_loss": 3.1139605373333974, "policy_loss": -0.019110394498499432, "vf_loss": 3.1309862224919023, "vf_explained_var": 0.3121109361608064, "kl": 0.010423533620130895, "entropy": 1.601463878382543, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 1178.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8992838855445258, "cur_kl_coeff": 0.2, "cur_lr": 0.00010783655643585859, "total_loss": 2.4418362295551663, "policy_loss": -0.01136596405872731, "vf_loss": 2.451855452855428, "vf_explained_var": 0.2768968658842099, "kl": 0.006733684626955642, "entropy": 1.6047982617801415, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 1178.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 58.85910787272269, "num_env_steps_trained_throughput_per_sec": 58.85910787272269, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 67958.913, "restore_workers_time_ms": 0.024, "training_step_time_ms": 67958.838, "sample_time_ms": 9062.336, "learn_time_ms": 58870.357, "learn_throughput": 67.946, "synch_weights_time_ms": 12.404}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 1, "trial_id": "e08ae66a", "date": "2024-08-24_03-20-10", "timestamp": 1724449810, "time_this_iter_s": 67.99687314033508, "time_total_s": 67.99687314033508, "pid": 92815, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.827838516649127, "lr": 0.00010783655643585861, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3601790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 67.99687314033508, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 36.89072164948454, "ram_util_percent": 83.37628865979381}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.069777505463602, "cur_kl_coeff": 0.2, "cur_lr": 0.00010783655643585859, "total_loss": 2.6140252057154467, "policy_loss": -0.03066616523714297, "vf_loss": 2.6414277817286758, "vf_explained_var": 0.55416015890247, "kl": 0.016317957512848473, "entropy": 1.5749747620013617, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 3533.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.24653538300986, "cur_kl_coeff": 0.2, "cur_lr": 0.00010783655643585859, "total_loss": 2.0000602424018195, "policy_loss": -0.01749007640853366, "vf_loss": 2.0157991644176962, "vf_explained_var": 0.44297888815529535, "kl": 0.008755780045623296, "entropy": 1.5919314467982881, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 3533.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 64.15540108006753, "num_env_steps_trained_throughput_per_sec": 64.15540108006753, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 65153.768, "restore_workers_time_ms": 0.024, "training_step_time_ms": 65153.639, "sample_time_ms": 6568.631, "learn_time_ms": 58556.546, "learn_throughput": 68.31, "synch_weights_time_ms": 16.506}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 2, "trial_id": "e08ae66a", "date": "2024-08-24_03-21-15", "timestamp": 1724449875, "time_this_iter_s": 62.41143584251404, "time_total_s": 130.40830898284912, "pid": 92815, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.827838516649127, "lr": 0.00010783655643585861, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b359a280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 130.40830898284912, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 34.16847826086956, "ram_util_percent": 83.22173913043478}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.766069724504102, "cur_kl_coeff": 0.2, "cur_lr": 0.00010783655643585859, "total_loss": 2.248218909798154, "policy_loss": -0.036546940214619544, "vf_loss": 2.281055789540528, "vf_explained_var": 0.5745949817817428, "kl": 0.01855034660765478, "entropy": 1.5444873563802926, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 5888.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.946514906220122, "cur_kl_coeff": 0.2, "cur_lr": 0.00010783655643585859, "total_loss": 1.549322266614108, "policy_loss": -0.022651872860817455, "vf_loss": 1.5697904627034618, "vf_explained_var": 0.43530878585361876, "kl": 0.010918384740295209, "entropy": 1.5767949989646863, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 5888.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 64.93284589649745, "num_env_steps_trained_throughput_per_sec": 64.93284589649745, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 63969.884, "restore_workers_time_ms": 0.023, "training_step_time_ms": 63969.779, "sample_time_ms": 5682.354, "learn_time_ms": 58261.352, "learn_throughput": 68.656, "synch_weights_time_ms": 15.785}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 3, "trial_id": "e08ae66a", "date": "2024-08-24_03-22-17", "timestamp": 1724449937, "time_this_iter_s": 61.63438391685486, "time_total_s": 192.04269289970398, "pid": 92815, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.827838516649127, "lr": 0.00010783655643585861, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b36019d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 192.04269289970398, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 30.818390804597705, "ram_util_percent": 83.34482758620688}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.2008609219974264, "cur_kl_coeff": 0.2, "cur_lr": 0.00010783655643585859, "total_loss": 2.0179207292205463, "policy_loss": -0.028256099041246843, "vf_loss": 2.042960261792387, "vf_explained_var": 0.5944980635258296, "kl": 0.01608282747231582, "entropy": 1.5205134708157517, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 8243.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2175682663664444, "cur_kl_coeff": 0.2, "cur_lr": 0.00010783655643585859, "total_loss": 1.3702701464327025, "policy_loss": -0.022132656898452344, "vf_loss": 1.3899158339338444, "vf_explained_var": 0.4644731096148238, "kl": 0.012434835786557501, "entropy": 1.558294096873824, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 8243.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 65.71053050588651, "num_env_steps_trained_throughput_per_sec": 65.71053050588651, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 63195.676, "restore_workers_time_ms": 0.023, "training_step_time_ms": 63195.583, "sample_time_ms": 5068.034, "learn_time_ms": 58101.626, "learn_throughput": 68.845, "synch_weights_time_ms": 15.662}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 4, "trial_id": "e08ae66a", "date": "2024-08-24_03-23-18", "timestamp": 1724449998, "time_this_iter_s": 60.911486864089966, "time_total_s": 252.95417976379395, "pid": 92815, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.827838516649127, "lr": 0.00010783655643585861, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3648040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 252.95417976379395, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 29.741860465116282, "ram_util_percent": 83.26046511627906}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.64215674947022, "cur_kl_coeff": 0.2, "cur_lr": 0.00010783655643585859, "total_loss": 2.373337035953619, "policy_loss": -0.027227701411351182, "vf_loss": 2.3974123084114867, "vf_explained_var": 0.5192525560688821, "kl": 0.015762166296193206, "entropy": 1.4785984747981822, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 10598.0, "diff_num_grad_updates_vs_sampler_policy": 1202.9050000000007}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.773199592021367, "cur_kl_coeff": 0.2, "cur_lr": 0.00010783655643585859, "total_loss": 1.4626002114036787, "policy_loss": -0.021378679453116504, "vf_loss": 1.4812603938098672, "vf_explained_var": 0.48301363644326567, "kl": 0.01359248664773874, "entropy": 1.5272852128731471, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 10598.0, "diff_num_grad_updates_vs_sampler_policy": 1202.9050000000007}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 65.78574839847859, "num_env_steps_trained_throughput_per_sec": 65.78574839847859, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 62717.231, "restore_workers_time_ms": 0.022, "training_step_time_ms": 62717.147, "sample_time_ms": 4653.643, "learn_time_ms": 58038.978, "learn_throughput": 68.919, "synch_weights_time_ms": 15.291}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "training_iteration": 5, "trial_id": "e08ae66a", "date": "2024-08-24_03-24-19", "timestamp": 1724450059, "time_this_iter_s": 60.8425509929657, "time_total_s": 313.79673075675964, "pid": 92815, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.827838516649127, "lr": 0.00010783655643585861, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b35b8d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 313.79673075675964, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 29.633720930232563, "ram_util_percent": 83.23023255813952}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.726296039397043, "cur_kl_coeff": 0.2, "cur_lr": 0.00010783655643585859, "total_loss": 2.3381469806035358, "policy_loss": -0.024866436197147596, "vf_loss": 2.359508510810301, "vf_explained_var": 0.4602449923310816, "kl": 0.017524515021979936, "entropy": 1.4426588061508858, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 12953.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.048620034352483, "cur_kl_coeff": 0.2, "cur_lr": 0.00010783655643585859, "total_loss": 1.4202831106833844, "policy_loss": -0.020196151293244712, "vf_loss": 1.437799338803423, "vf_explained_var": 0.44142842890097583, "kl": 0.013399619650839177, "entropy": 1.4989926330602852, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 12953.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 64.19640312379342, "num_env_steps_trained_throughput_per_sec": 64.19640312379342, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 62649.158, "restore_workers_time_ms": 0.021, "training_step_time_ms": 62649.079, "sample_time_ms": 4571.542, "learn_time_ms": 58053.662, "learn_throughput": 68.902, "synch_weights_time_ms": 15.152}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 6, "trial_id": "e08ae66a", "date": "2024-08-24_03-25-21", "timestamp": 1724450121, "time_this_iter_s": 62.3581268787384, "time_total_s": 376.15485763549805, "pid": 92815, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.827838516649127, "lr": 0.00010783655643585861, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3590310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 376.15485763549805, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 31.655681818181815, "ram_util_percent": 83.20681818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.09215592118079, "cur_kl_coeff": 0.2, "cur_lr": 0.00010783655643585859, "total_loss": 1.7610696017489058, "policy_loss": -0.021263077495433786, "vf_loss": 1.7796321394084111, "vf_explained_var": 0.5334651675447031, "kl": 0.013502684122667254, "entropy": 1.4457242145153621, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 15308.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4032701522934463, "cur_kl_coeff": 0.2, "cur_lr": 0.00010783655643585859, "total_loss": 1.0793691342550225, "policy_loss": -0.01685261224295683, "vf_loss": 1.093848390386869, "vf_explained_var": 0.42219378935556756, "kl": 0.011866781206983448, "entropy": 1.4940657159072326, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 15308.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 65.51314384603, "num_env_steps_trained_throughput_per_sec": 65.51314384603, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 62421.629, "restore_workers_time_ms": 0.02, "training_step_time_ms": 62421.555, "sample_time_ms": 4367.098, "learn_time_ms": 58030.016, "learn_throughput": 68.93, "synch_weights_time_ms": 15.277}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "training_iteration": 7, "trial_id": "e08ae66a", "date": "2024-08-24_03-26-22", "timestamp": 1724450182, "time_this_iter_s": 61.099689245224, "time_total_s": 437.25454688072205, "pid": 92815, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.827838516649127, "lr": 0.00010783655643585861, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b36a9e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 437.25454688072205, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 29.946511627906972, "ram_util_percent": 83.22790697674417}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.513859831400991, "cur_kl_coeff": 0.2, "cur_lr": 0.00010783655643585859, "total_loss": 1.4265425765716853, "policy_loss": -0.019519742303814605, "vf_loss": 1.4435033003742275, "vf_explained_var": 0.5290293649756478, "kl": 0.012795081678896572, "entropy": 1.4373797756851099, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 17663.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3923974154101817, "cur_kl_coeff": 0.2, "cur_lr": 0.00010783655643585859, "total_loss": 0.9458232223354833, "policy_loss": -0.01777784138959447, "vf_loss": 0.9607581824380628, "vf_explained_var": 0.41404203783934285, "kl": 0.014214412994572058, "entropy": 1.4698774669833496, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 17663.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 1065.8908199152174, "episode_reward_min": 319.53367672487605, "episode_reward_mean": 637.2691743334998, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 8800, "policy_reward_min": {"prey_policy": -275.8956132715817, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 336.6400217323808, "predator_policy": 363.1287890903541}, "policy_reward_mean": {"prey_policy": 27.847998978613226, "predator_policy": 99.60583588808451}, "custom_metrics": {}, "hist_stats": {"episode_reward": [770.0144842364979, 645.6363944281577, 620.2780306054652, 490.16834390729275, 557.9018135409993, 547.078244058917, 768.867164410851, 327.4790617847468, 844.3188657176728, 319.53367672487605, 432.23206054148096, 551.0220901683053, 546.1593828974031, 964.2281725056342, 657.4965819733766, 551.8903466238372, 768.4711690232002, 875.3568526070096, 494.9181724860946, 678.0613760281038, 542.9187311518575, 1065.8908199152174], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [112.30639833896575, -14.191364408550895, 143.99949874305818, 172.15034310606217, -7.812405796524992, 62.94293899062135, -12.152543390812722, 30.202070057215153, 161.37448990001153, -35.18293908491421, -11.607934221775956, 8.15372831912569, 106.2598955925827, -150.43057676130837, 34.25750427067828, 31.064985517361144, 1.9870136771939275, 17.438979380343508, 143.67285358692453, 26.941803552695973, 36.40235111284873, -88.49497966793204, 129.1815426503058, -13.134160731706464, 70.70254637079233, 25.81519226742165, 99.45839857858041, 94.01968296446721, 103.28059869051631, 40.0000000000003, -114.13819025913291, 63.380103180850845, -97.38555849485655, 134.21530927912607, 29.15543190932826, -47.42413501219181, -20.84440562247185, -38.10691323740362, 40.0000000000003, -112.55385037339568, 182.68230640597707, -51.20962646551564, 180.31213622890283, -64.34101019869054, 42.635178902292004, -210.0560039275653, 32.068493152104786, -40.69490545377595, 40.0000000000003, -16.33730719531467, 23.65232133268001, -143.2343160037686, 43.568760451826, -72.46108727061787, 20.617559691665633, -4.5512835819146655, 23.952199093147424, -63.87273891018751, -221.50077768481185, 173.52898621199728, -124.58878094124898, -39.21527840507009, 23.82925977877398, 130.66001849638351, 8.992530533394445, 186.96649132607305, 115.18153500957617, 70.92083047613687, 161.27001506807125, -20.617034084829424, -8.579618940776568, 89.55331641774616, -50.28277771233635, 77.09808763291272, -69.24314070796949, -108.07927289388843, 57.35787077373529, 33.91327414858131, -191.95661487128902, -135.73141290249572, 27.609015157852475, -96.78817696038573, -20.224721982427763, 91.37655349798015, 52.32421046694509, 138.55451083760897, 85.26569807110116, 255.55453409147603, 20.94188105196652, 21.67962138383941, 20.784856181468577, -275.8956132715817, 11.531451747117691, 17.270277618591237, 32.13542534393935, 336.17464427926325, 45.40000000000038, 49.000000000000426, 131.3633849689509, 47.20000000000043, -179.86026991163575, 252.2004498962782, 140.25002792968098, -123.21878051139004, -89.31383310245899, 124.64850955183672, 175.96779716082767, 336.6400217323808, 194.7977512186446, 2.798775245572021], "policy_predator_policy_reward": [65.41321271375149, 40.04554698928277, 116.08211742290453, 87.7395796508728, 54.28155747666749, 58.965706538401605, 34.98369820565018, 78.72681102239234, 187.71805448921623, 78.05810770035887, 153.64383201832072, 146.1730855177134, 55.155547446816, 106.79665744265246, 171.87629098064463, 43.24322242666677, 24.159607649635607, 89.87085547509881, 48.33816708535444, 63.45085555600393, 1.6348017060784839, 140.31308082471082, 70.105116003369, 72.10280554231576, 139.08870973020373, 0.850240373148967, 62.574813958480775, 48.69223213953975, 59.60136844190301, 12.785716644841369, 363.1287890903541, 188.39854896763558, 58.233494232440044, 88.270361543681, 55.608874961407295, 49.015868576188716, 104.81398921171076, 71.8887049198741, 210.45534002374566, 70.234463298683, 142.14411500824014, 196.63841198938206, 27.364627604241058, 94.3247631927269, 93.76796305010666, 68.10855623971132, 92.73476834125367, 215.53075603884918, 85.00925252477118, 53.17006700484292, 93.80050947707143, 213.36114801242445, 156.91819487478855, 64.98038741411577, 31.02858256128179, 99.84710510079253, 162.64348379857788, 235.55227452962643, 86.07042297601382, 59.35241863504699, 174.61370252857728, 259.0405115009663, 107.80239034899353, 0.0, 5.025029056619729, 0.0, 198.22709107178426, 13.445294145295781, 26.377605244943723, 212.45634424857596, 120.19514846254553, 13.68461149059681, 241.61522381480788, 16.10491488176061, 227.35081663407797, 26.373339527331012, 198.54170062432775, 243.93898083689504, 113.60136774663465, 313.931113633994, 59.884565409719926, 280.5574144916582, 7.277178303977733, 186.4325174150363, 180.02261322282897, 152.8263125477997, 29.446822759968214, 80.16895603450892, 25.331399349313756, 65.58711647941885, 220.92314911322563, 67.86191870279795, 191.14815507999285, 34.467338750618126, 174.69121321991724, 0.0, 26.714220587309768, 8.372662155631499, 33.83646403693388, 0.0, 56.816676777675, 27.576897432722504, 1.8357579614351818, 181.78349741237216, 274.8483072671647, 55.26217089983188, 40.516822761892996, 56.82960434393229, 13.681599312558117, 64.74776768774639]}, "sampler_perf": {"mean_raw_obs_processing_ms": 11.707176104778876, "mean_inference_ms": 7.961772509190397, "mean_action_processing_ms": 6.806900972055259, "mean_env_wait_ms": 11.681946428642567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00692660158330744, "StateBufferConnector_ms": 0.007334622469815341, "ViewRequirementAgentConnector_ms": 0.1826454292644154}, "num_episodes": 22, "episode_return_max": 1065.8908199152174, "episode_return_min": 319.53367672487605, "episode_return_mean": 637.2691743334998, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 65.89103401801852, "num_env_steps_trained_throughput_per_sec": 65.89103401801852, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 62207.212, "restore_workers_time_ms": 0.02, "training_step_time_ms": 62207.141, "sample_time_ms": 4189.144, "learn_time_ms": 57994.339, "learn_throughput": 68.972, "synch_weights_time_ms": 15.028}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 8, "trial_id": "e08ae66a", "date": "2024-08-24_03-27-23", "timestamp": 1724450243, "time_this_iter_s": 60.74657320976257, "time_total_s": 498.0011200904846, "pid": 92815, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.827838516649127, "lr": 0.00010783655643585861, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3590160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 498.0011200904846, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 29.082558139534893, "ram_util_percent": 83.10465116279069}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.319768696327372, "cur_kl_coeff": 0.2, "cur_lr": 0.00010783655643585859, "total_loss": 1.4440127607490354, "policy_loss": -0.01717918880299651, "vf_loss": 1.4590085931897416, "vf_explained_var": 0.5240254881022589, "kl": 0.010916766743304211, "entropy": 1.4139836661122154, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 20018.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7633120098691077, "cur_kl_coeff": 0.2, "cur_lr": 0.00010783655643585859, "total_loss": 0.9296411763204384, "policy_loss": -0.012821584831598964, "vf_loss": 0.940141643485699, "vf_explained_var": 0.3802897386743258, "kl": 0.011605597492861077, "entropy": 1.4591049185730596, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 20018.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "env_runners": {"episode_reward_max": 1065.8908199152174, "episode_reward_min": 319.53367672487605, "episode_reward_mean": 652.8436258298794, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 22800, "policy_reward_min": {"prey_policy": -294.16276249746227, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 336.6400217323808, "predator_policy": 363.1287890903541}, "policy_reward_mean": {"prey_policy": 30.268136181841303, "predator_policy": 100.30058898413216}, "custom_metrics": {}, "hist_stats": {"episode_reward": [770.0144842364979, 645.6363944281577, 620.2780306054652, 490.16834390729275, 557.9018135409993, 547.078244058917, 768.867164410851, 327.4790617847468, 844.3188657176728, 319.53367672487605, 432.23206054148096, 551.0220901683053, 546.1593828974031, 964.2281725056342, 657.4965819733766, 551.8903466238372, 768.4711690232002, 875.3568526070096, 494.9181724860946, 678.0613760281038, 542.9187311518575, 1065.8908199152174, 834.2814703108523, 871.7256987604247, 936.4160121093241, 782.5732493665778, 706.2362266502072, 750.4253918425126, 578.3456042044046, 614.558385093752, 586.0746900360248, 568.2885100112403, 720.1096027793561, 734.1552054886334, 908.8057781396265, 798.2607037106677, 601.4753797760361, 434.51222193588376, 424.8804063051123, 607.5277477053512, 559.5795116133406, 455.3778011028265, 394.7556322451011, 506.4017231249702, 388.83250762306614, 736.2887875720974, 776.1518933310541, 854.0765028299581, 631.1187602711668, 898.3059163454302, 586.5760400877859, 480.35099768773057, 639.6327304055973, 474.6097613211855, 1032.6698838703023, 652.1455323411785, 666.6385709673591], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [112.30639833896575, -14.191364408550895, 143.99949874305818, 172.15034310606217, -7.812405796524992, 62.94293899062135, -12.152543390812722, 30.202070057215153, 161.37448990001153, -35.18293908491421, -11.607934221775956, 8.15372831912569, 106.2598955925827, -150.43057676130837, 34.25750427067828, 31.064985517361144, 1.9870136771939275, 17.438979380343508, 143.67285358692453, 26.941803552695973, 36.40235111284873, -88.49497966793204, 129.1815426503058, -13.134160731706464, 70.70254637079233, 25.81519226742165, 99.45839857858041, 94.01968296446721, 103.28059869051631, 40.0000000000003, -114.13819025913291, 63.380103180850845, -97.38555849485655, 134.21530927912607, 29.15543190932826, -47.42413501219181, -20.84440562247185, -38.10691323740362, 40.0000000000003, -112.55385037339568, 182.68230640597707, -51.20962646551564, 180.31213622890283, -64.34101019869054, 42.635178902292004, -210.0560039275653, 32.068493152104786, -40.69490545377595, 40.0000000000003, -16.33730719531467, 23.65232133268001, -143.2343160037686, 43.568760451826, -72.46108727061787, 20.617559691665633, -4.5512835819146655, 23.952199093147424, -63.87273891018751, -221.50077768481185, 173.52898621199728, -124.58878094124898, -39.21527840507009, 23.82925977877398, 130.66001849638351, 8.992530533394445, 186.96649132607305, 115.18153500957617, 70.92083047613687, 161.27001506807125, -20.617034084829424, -8.579618940776568, 89.55331641774616, -50.28277771233635, 77.09808763291272, -69.24314070796949, -108.07927289388843, 57.35787077373529, 33.91327414858131, -191.95661487128902, -135.73141290249572, 27.609015157852475, -96.78817696038573, -20.224721982427763, 91.37655349798015, 52.32421046694509, 138.55451083760897, 85.26569807110116, 255.55453409147603, 20.94188105196652, 21.67962138383941, 20.784856181468577, -275.8956132715817, 11.531451747117691, 17.270277618591237, 32.13542534393935, 336.17464427926325, 45.40000000000038, 49.000000000000426, 131.3633849689509, 47.20000000000043, -179.86026991163575, 252.2004498962782, 140.25002792968098, -123.21878051139004, -89.31383310245899, 124.64850955183672, 175.96779716082767, 336.6400217323808, 194.7977512186446, 2.798775245572021, 31.694961092023462, 90.08320525385194, 0.5012205010331601, 132.4534984704866, 72.45345449448742, 4.616989319591519, 39.051621749364045, 280.8915029246811, 135.54954182820757, 127.23727499388606, 115.13991773423878, 162.22521953351693, 62.547125507620464, 23.703114679231046, 169.7812815209439, 270.460972803281, -12.219209927493736, 26.06947123137131, 84.78025517265334, -67.30642766070456, 304.8142508035059, -21.11581910325839, -24.941855403615126, -80.50417920072961, -103.57255727814965, 88.46323310797112, 37.227985866552324, 51.70000000000049, 174.7492683013983, 169.2943857800439, 15.298847262805934, 56.36284232947536, 19.563851300462993, -294.16276249746227, -213.92249932295854, 40.0000000000003, 183.34921936048994, 7.820182887380209, 264.0832626189645, 5.034986653074336, 82.99371726439355, 43.4254991850494, 65.21219768313433, -160.00887964178946, 30.62622030967701, 70.3750594745139, 100.62286573751243, 37.4792011008603, -194.25262359101694, 26.93479596675836, 78.04337222695011, -18.078926205380682, 21.733227059006794, 22.70427305149534, -85.61715226895312, -100.05019470776641, -194.9290014411111, 176.30355341048022, 129.05509141193406, 152.65516219841692, 58.438520873536866, 104.45496484576823, 197.67338325802774, 50.64214126841187, -93.09748279836967, 150.70052508817133, -93.56376952969694, 2.5770326474935588, 27.54736338037423, 142.67959075853022, 34.714745359034396, -86.75438016784749, 26.952699936127548, 141.71448055212605, 54.94151779878079, 69.96935659336762, -102.58015506634541, -139.86439824006843, -2.3671993210580538, -24.816271535423944, 38.270406070033566, -29.902603068640055, 16.404805702752423, -167.99309115454398, 63.68328724408307, 14.472892442716793, 32.811320484859436, 46.01322130631415, 55.99641675260785, 4.191493042074025, 89.38319055030564, 32.40405163442952, 0.20472909036848108, 11.295613162703841, 42.604345444705814, 14.679106799378738, -26.92601354037324, -60.20085310867111, -21.885165639175373, 124.09444252644442, 51.58749627751477, -105.72058040689816, 40.0000000000003, -21.236239748984843, -53.72710369207756, -175.8683949001186, -42.54525249347583, 134.69843922482218, 20.547054696379902, 67.35718509949349, -43.907645928787666, 123.43493596645945, -31.059536645685053, 25.17490388380981, 23.64173410702681, 188.95586239414877, 44.50719494380841, 1.1223357596674643, 75.89300267400648, -15.206328120217396, 46.54444673723163, 18.54309869763798, 81.43443656797001, 105.82925143042637, 39.760400943787616, 229.67940988106434, -203.09038415455356, 185.12453417417493, -188.38289287288683, 136.17147647862313, -104.78806724344895, -30.25316965417954, -43.86386891567966, 226.17718087102043, 80.48780724167477, 89.06469752525034, 2.625166502744139, 24.759232171295146, -19.455737769040276, 117.98586842893916, 60.157077950904906, 36.04715428454278, 33.31248280767403, -97.19885749795284, 24.777315413713957, -65.01144132401953, -149.6710296300455, 9.614775448178543, 73.69486127326113, 37.74736518623172, 89.11832761775428, -14.117979145067201, -17.571219200954836, -72.5089310159317, 21.626345937775532, -6.63943174543752, 43.643360748520315, 27.32712479349812, -182.0546449225004, 76.46413197596853, -81.32191886152442, 125.70022453883125, 170.05539046569177, 128.37980161323273, 285.60754772308417, 79.66255149070984, -34.582855165025585, 60.0309902429408, -52.79366348550648, -28.087579379747545, 31.77018325601447, 91.4473646899682, 222.67709374210705, -25.163861917344583, 44.949561779123286], "policy_predator_policy_reward": [65.41321271375149, 40.04554698928277, 116.08211742290453, 87.7395796508728, 54.28155747666749, 58.965706538401605, 34.98369820565018, 78.72681102239234, 187.71805448921623, 78.05810770035887, 153.64383201832072, 146.1730855177134, 55.155547446816, 106.79665744265246, 171.87629098064463, 43.24322242666677, 24.159607649635607, 89.87085547509881, 48.33816708535444, 63.45085555600393, 1.6348017060784839, 140.31308082471082, 70.105116003369, 72.10280554231576, 139.08870973020373, 0.850240373148967, 62.574813958480775, 48.69223213953975, 59.60136844190301, 12.785716644841369, 363.1287890903541, 188.39854896763558, 58.233494232440044, 88.270361543681, 55.608874961407295, 49.015868576188716, 104.81398921171076, 71.8887049198741, 210.45534002374566, 70.234463298683, 142.14411500824014, 196.63841198938206, 27.364627604241058, 94.3247631927269, 93.76796305010666, 68.10855623971132, 92.73476834125367, 215.53075603884918, 85.00925252477118, 53.17006700484292, 93.80050947707143, 213.36114801242445, 156.91819487478855, 64.98038741411577, 31.02858256128179, 99.84710510079253, 162.64348379857788, 235.55227452962643, 86.07042297601382, 59.35241863504699, 174.61370252857728, 259.0405115009663, 107.80239034899353, 0.0, 5.025029056619729, 0.0, 198.22709107178426, 13.445294145295781, 26.377605244943723, 212.45634424857596, 120.19514846254553, 13.68461149059681, 241.61522381480788, 16.10491488176061, 227.35081663407797, 26.373339527331012, 198.54170062432775, 243.93898083689504, 113.60136774663465, 313.931113633994, 59.884565409719926, 280.5574144916582, 7.277178303977733, 186.4325174150363, 180.02261322282897, 152.8263125477997, 29.446822759968214, 80.16895603450892, 25.331399349313756, 65.58711647941885, 220.92314911322563, 67.86191870279795, 191.14815507999285, 34.467338750618126, 174.69121321991724, 0.0, 26.714220587309768, 8.372662155631499, 33.83646403693388, 0.0, 56.816676777675, 27.576897432722504, 1.8357579614351818, 181.78349741237216, 274.8483072671647, 55.26217089983188, 40.516822761892996, 56.82960434393229, 13.681599312558117, 64.74776768774639, 239.92353729889638, 106.80488208009729, 30.356332891807433, 86.42206211332079, 43.58831611483603, 23.968283148522264, 173.95789846790862, 34.28928454904763, 50.445021438798165, 1.7182803404032012, 87.6288392988667, 4.006279563642017, 153.96973183114835, 82.47947260133614, 74.93502983876454, 127.32561144298103, 26.70975470402275, 28.85813003772905, 82.18137625476791, 215.71331530795402, 68.86904470594112, 195.06630718116483, 95.84405565419242, 237.92691892079367, 33.85006037034261, 16.73891535053083, 139.02935655826101, 7.360230021664218, 65.86201685607469, 0.0, 112.43306576253701, 327.1559133530026, 44.91919278650681, 159.5288389016613, 351.1683143283587, 27.32050125723867, 3.7135446030727772, 14.525649243518622, 44.28827645102132, 24.422762018970907, 99.94529380170326, 40.41599677780096, 222.1430863932853, 3.2379568529477667, 158.08360140981696, 64.82290876641494, 107.4424950928571, 24.41017612565391, 100.73330856946667, 229.72032276820468, 117.07454896547797, 263.2813068601923, 40.83991312128083, 120.15906020792102, 159.96997976135881, 221.81855875477314, 29.40908458373469, 137.06596353978492, 100.08722263151063, 82.73976510685806, 58.07047707130354, 152.73050946662875, 96.08728971192325, 113.52440185984233, 170.28157258253836, 21.24678441554952, 153.19108354759763, 84.4184677589778, 169.14798681285328, 140.31563883080312, 31.021113627041917, 63.75962616705279, 196.28804441632408, 44.04193589259301, 94.79559619479647, 65.28291631661902, 276.00195664007725, 0.0, 47.86851967461434, 245.01749687408997, 20.851304574632685, 15.37306573863303, 231.7202741967607, 63.233845263838916, 173.23911173754786, 2.0103495525522153, 97.64252842523177, 130.31226426972222, 155.49781916604846, 68.57944226321449, 149.3541863136223, 55.40012607815472, 71.47165793463552, 61.54854798252849, 45.91306342186897, 99.91663942905289, 40.400181038610796, 61.13013732190518, 155.94863424276878, 68.2206920328788, 48.43816361367874, 126.41495032920223, 26.200947108950455, 151.19843895722045, 131.5995598064818, 78.14220967943359, 87.8883370067319, 96.99341740061799, 37.0036157292265, 202.1851116818425, 43.3902612663139, 2.1481388505967747, 26.231402601741795, 72.17426138599247, 147.60405213557962, 86.79712265341341, 104.06041317671718, 112.55521383728187, 90.54659882040563, 47.05737143284607, 103.44719615420765, 186.45399523523741, 162.47511579471652, 11.80699200826864, 19.856959761554208, 194.34143284863026, 48.542845913879304, 240.71274993483254, 67.08173916621668, 143.8955914599637, 43.77915443692833, 61.893820402203666, 15.677968088755899, 204.7901333622648, 177.21780168161558, 102.80453387864216, 100.96856095418018, 58.50810793887233, 289.12491588752465, 131.92057082701288, 110.78412081045124, 51.97432042772843, 176.23048066998157, 121.5560273895129, 68.93591783121933, 98.51017466984676, 128.46752724418917, 168.29000620707504, 48.02729125766392, 130.68146735534347, 131.18913182304306, 192.3817217991505, 48.19535314525754, 181.180313862048, 80.13966558251079, 95.16507748253842, 269.7825368105921, 93.09292089179381, 39.79872998961887, 18.02995529657734, 109.8498907739323, 137.32401271498432, 113.7283256935689, 4.769748136085514, 38.576861072410296, 132.95229740863724, 155.56506844077106, 46.95132522634683, 186.1394111109409, 106.30798645110386, 84.44784036552419, 85.49437753832613, 23.330025898298754, 104.6797014411127, 3.006284174218549]}, "sampler_perf": {"mean_raw_obs_processing_ms": 11.60644812719301, "mean_inference_ms": 7.877430276926727, "mean_action_processing_ms": 6.350459949224763, "mean_env_wait_ms": 11.636399007911358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024681969692832546, "StateBufferConnector_ms": 0.01228315788402892, "ViewRequirementAgentConnector_ms": 0.21460077218842089}, "num_episodes": 35, "episode_return_max": 1065.8908199152174, "episode_return_min": 319.53367672487605, "episode_return_mean": 652.8436258298794, "episodes_this_iter": 35}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 65.83020934878877, "num_env_steps_trained_throughput_per_sec": 65.83020934878877, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 62046.676, "restore_workers_time_ms": 0.02, "training_step_time_ms": 62046.607, "sample_time_ms": 4059.796, "learn_time_ms": 57963.635, "learn_throughput": 69.009, "synch_weights_time_ms": 14.894}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "training_iteration": 9, "trial_id": "e08ae66a", "date": "2024-08-24_03-28-24", "timestamp": 1724450304, "time_this_iter_s": 60.8123140335083, "time_total_s": 558.8134341239929, "pid": 92815, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.827838516649127, "lr": 0.00010783655643585861, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b367a160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 558.8134341239929, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 28.87906976744186, "ram_util_percent": 83.12325581395346}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.412586760824653, "cur_kl_coeff": 0.2, "cur_lr": 0.00010783655643585859, "total_loss": 1.394459063320909, "policy_loss": -0.01687692903049464, "vf_loss": 1.4090709883695955, "vf_explained_var": 0.5115790327896231, "kl": 0.011325006670814854, "entropy": 1.3968793145157476, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 22373.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.794259387368609, "cur_kl_coeff": 0.2, "cur_lr": 0.00010783655643585859, "total_loss": 0.8063695056043613, "policy_loss": -0.01625919971721852, "vf_loss": 0.8199401187415841, "vf_explained_var": 0.42052734472695935, "kl": 0.013442930483284966, "entropy": 1.4367853154042725, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 22373.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 1204.2346331710303, "episode_reward_min": 235.0414969238198, "episode_reward_mean": 655.1680448683711, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 35600, "policy_reward_min": {"prey_policy": -294.16276249746227, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 336.6400217323808, "predator_policy": 363.1287890903541}, "policy_reward_mean": {"prey_policy": 33.74647564383864, "predator_policy": 97.28713332983313}, "custom_metrics": {}, "hist_stats": {"episode_reward": [770.0144842364979, 645.6363944281577, 620.2780306054652, 490.16834390729275, 557.9018135409993, 547.078244058917, 768.867164410851, 327.4790617847468, 844.3188657176728, 319.53367672487605, 432.23206054148096, 551.0220901683053, 546.1593828974031, 964.2281725056342, 657.4965819733766, 551.8903466238372, 768.4711690232002, 875.3568526070096, 494.9181724860946, 678.0613760281038, 542.9187311518575, 1065.8908199152174, 834.2814703108523, 871.7256987604247, 936.4160121093241, 782.5732493665778, 706.2362266502072, 750.4253918425126, 578.3456042044046, 614.558385093752, 586.0746900360248, 568.2885100112403, 720.1096027793561, 734.1552054886334, 908.8057781396265, 798.2607037106677, 601.4753797760361, 434.51222193588376, 424.8804063051123, 607.5277477053512, 559.5795116133406, 455.3778011028265, 394.7556322451011, 506.4017231249702, 388.83250762306614, 736.2887875720974, 776.1518933310541, 854.0765028299581, 631.1187602711668, 898.3059163454302, 586.5760400877859, 480.35099768773057, 639.6327304055973, 474.6097613211855, 1032.6698838703023, 652.1455323411785, 666.6385709673591, 754.2081283741028, 657.2916820432641, 548.9375656012777, 951.512600193352, 245.68595024415362, 622.191399649016, 807.7077830517559, 952.3955995658673, 830.1625409022957, 869.7823874884693, 389.84291401995466, 698.0045714132792, 527.3948150327337, 524.3774201626159, 235.0414969238198, 446.98974183072255, 571.8266619057644, 1204.2346331710303, 828.0417740605267, 721.4331206731172, 795.984515560974, 351.1801428124116, 739.8679929031425, 596.5428837097494, 379.6047679404076, 508.81077498189353, 851.8776169865595, 505.4356471979785, 934.6634408516355, 628.0408941652968, 506.94923852150026, 911.848619043221], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [112.30639833896575, -14.191364408550895, 143.99949874305818, 172.15034310606217, -7.812405796524992, 62.94293899062135, -12.152543390812722, 30.202070057215153, 161.37448990001153, -35.18293908491421, -11.607934221775956, 8.15372831912569, 106.2598955925827, -150.43057676130837, 34.25750427067828, 31.064985517361144, 1.9870136771939275, 17.438979380343508, 143.67285358692453, 26.941803552695973, 36.40235111284873, -88.49497966793204, 129.1815426503058, -13.134160731706464, 70.70254637079233, 25.81519226742165, 99.45839857858041, 94.01968296446721, 103.28059869051631, 40.0000000000003, -114.13819025913291, 63.380103180850845, -97.38555849485655, 134.21530927912607, 29.15543190932826, -47.42413501219181, -20.84440562247185, -38.10691323740362, 40.0000000000003, -112.55385037339568, 182.68230640597707, -51.20962646551564, 180.31213622890283, -64.34101019869054, 42.635178902292004, -210.0560039275653, 32.068493152104786, -40.69490545377595, 40.0000000000003, -16.33730719531467, 23.65232133268001, -143.2343160037686, 43.568760451826, -72.46108727061787, 20.617559691665633, -4.5512835819146655, 23.952199093147424, -63.87273891018751, -221.50077768481185, 173.52898621199728, -124.58878094124898, -39.21527840507009, 23.82925977877398, 130.66001849638351, 8.992530533394445, 186.96649132607305, 115.18153500957617, 70.92083047613687, 161.27001506807125, -20.617034084829424, -8.579618940776568, 89.55331641774616, -50.28277771233635, 77.09808763291272, -69.24314070796949, -108.07927289388843, 57.35787077373529, 33.91327414858131, -191.95661487128902, -135.73141290249572, 27.609015157852475, -96.78817696038573, -20.224721982427763, 91.37655349798015, 52.32421046694509, 138.55451083760897, 85.26569807110116, 255.55453409147603, 20.94188105196652, 21.67962138383941, 20.784856181468577, -275.8956132715817, 11.531451747117691, 17.270277618591237, 32.13542534393935, 336.17464427926325, 45.40000000000038, 49.000000000000426, 131.3633849689509, 47.20000000000043, -179.86026991163575, 252.2004498962782, 140.25002792968098, -123.21878051139004, -89.31383310245899, 124.64850955183672, 175.96779716082767, 336.6400217323808, 194.7977512186446, 2.798775245572021, 31.694961092023462, 90.08320525385194, 0.5012205010331601, 132.4534984704866, 72.45345449448742, 4.616989319591519, 39.051621749364045, 280.8915029246811, 135.54954182820757, 127.23727499388606, 115.13991773423878, 162.22521953351693, 62.547125507620464, 23.703114679231046, 169.7812815209439, 270.460972803281, -12.219209927493736, 26.06947123137131, 84.78025517265334, -67.30642766070456, 304.8142508035059, -21.11581910325839, -24.941855403615126, -80.50417920072961, -103.57255727814965, 88.46323310797112, 37.227985866552324, 51.70000000000049, 174.7492683013983, 169.2943857800439, 15.298847262805934, 56.36284232947536, 19.563851300462993, -294.16276249746227, -213.92249932295854, 40.0000000000003, 183.34921936048994, 7.820182887380209, 264.0832626189645, 5.034986653074336, 82.99371726439355, 43.4254991850494, 65.21219768313433, -160.00887964178946, 30.62622030967701, 70.3750594745139, 100.62286573751243, 37.4792011008603, -194.25262359101694, 26.93479596675836, 78.04337222695011, -18.078926205380682, 21.733227059006794, 22.70427305149534, -85.61715226895312, -100.05019470776641, -194.9290014411111, 176.30355341048022, 129.05509141193406, 152.65516219841692, 58.438520873536866, 104.45496484576823, 197.67338325802774, 50.64214126841187, -93.09748279836967, 150.70052508817133, -93.56376952969694, 2.5770326474935588, 27.54736338037423, 142.67959075853022, 34.714745359034396, -86.75438016784749, 26.952699936127548, 141.71448055212605, 54.94151779878079, 69.96935659336762, -102.58015506634541, -139.86439824006843, -2.3671993210580538, -24.816271535423944, 38.270406070033566, -29.902603068640055, 16.404805702752423, -167.99309115454398, 63.68328724408307, 14.472892442716793, 32.811320484859436, 46.01322130631415, 55.99641675260785, 4.191493042074025, 89.38319055030564, 32.40405163442952, 0.20472909036848108, 11.295613162703841, 42.604345444705814, 14.679106799378738, -26.92601354037324, -60.20085310867111, -21.885165639175373, 124.09444252644442, 51.58749627751477, -105.72058040689816, 40.0000000000003, -21.236239748984843, -53.72710369207756, -175.8683949001186, -42.54525249347583, 134.69843922482218, 20.547054696379902, 67.35718509949349, -43.907645928787666, 123.43493596645945, -31.059536645685053, 25.17490388380981, 23.64173410702681, 188.95586239414877, 44.50719494380841, 1.1223357596674643, 75.89300267400648, -15.206328120217396, 46.54444673723163, 18.54309869763798, 81.43443656797001, 105.82925143042637, 39.760400943787616, 229.67940988106434, -203.09038415455356, 185.12453417417493, -188.38289287288683, 136.17147647862313, -104.78806724344895, -30.25316965417954, -43.86386891567966, 226.17718087102043, 80.48780724167477, 89.06469752525034, 2.625166502744139, 24.759232171295146, -19.455737769040276, 117.98586842893916, 60.157077950904906, 36.04715428454278, 33.31248280767403, -97.19885749795284, 24.777315413713957, -65.01144132401953, -149.6710296300455, 9.614775448178543, 73.69486127326113, 37.74736518623172, 89.11832761775428, -14.117979145067201, -17.571219200954836, -72.5089310159317, 21.626345937775532, -6.63943174543752, 43.643360748520315, 27.32712479349812, -182.0546449225004, 76.46413197596853, -81.32191886152442, 125.70022453883125, 170.05539046569177, 128.37980161323273, 285.60754772308417, 79.66255149070984, -34.582855165025585, 60.0309902429408, -52.79366348550648, -28.087579379747545, 31.77018325601447, 91.4473646899682, 222.67709374210705, -25.163861917344583, 44.949561779123286, -24.080434121144613, 183.8875552274613, 21.155923244242963, -7.5146852962401045, 223.62359304091322, 13.30771029300656, -76.65200983635475, 143.40088033281853, 118.57418123995444, 53.33604369710507, 34.82852371936468, 40.0000000000003, -231.2039399122921, 278.5064064360447, -68.59895547070381, 89.84928862524588, -133.99023008963275, 189.60805747986595, 252.76887503943857, 51.22741663000775, 78.47732666365867, 40.0000000000003, 26.431101989308544, -128.91284885258116, -163.93493999038213, 31.769139586309656, 29.87305047242148, 82.29933441059377, 266.22823468897286, -11.019199521680106, 198.5486742332356, 247.8361718285295, 38.934178064938976, 111.09999999999832, -74.68704271013439, 195.92927448279488, 11.388085386882766, 241.48705906203563, -15.479554564102656, 164.2005232933823, 60.604635696587664, 14.798077281296584, 243.82518028382856, 33.42077309908328, 170.4856896169112, 199.90986410788975, 44.89722001892039, 134.6494165889531, 2.6683179053765826, 183.4812619705069, 45.63429201054712, -102.86282279108218, -144.261109235425, -50.86349376805704, -62.88233443073076, 11.11893867265475, 26.114934089198723, 81.58814572527119, -24.24326394197859, 4.056017445134319, -70.16876144182973, 81.2755708640377, 40.0000000000003, -129.17369090960514, 37.83374158050355, -40.92599657288453, 19.04436157731585, 120.35349920791133, -46.85409059861234, 8.462936178099866, 55.27149104342048, -123.0045178587493, -219.96408957583867, 22.697620377140964, -78.28955554420857, 102.67835230414572, -93.64170033267365, -170.8985189676661, 32.415726186804505, -85.56446145805381, 48.54632557739705, -19.756929101276427, 20.482232507704104, -117.1286868481004, 44.186105452016314, 273.46359818951856, 131.76320161543063, 268.2040942805968, 108.69774767021882, 96.02692117440742, -29.5158318679594, 241.6495411446104, 300.13538295872365, -19.584730788501773, 58.02211440702254, 26.07703698475144, 91.37639676692672, 116.47687613074558, 51.60464658355614, 162.58590273879975, 205.4352418916006, -30.230843862605226, -86.91185998985348, 148.04586463841318, 206.14262190319394, -70.00737632600017, -124.64183484654538, 50.55759672236405, -199.97498536016892, -101.33764618585954, 75.21892406130446, -130.40001403020386, 169.61424916953166, 132.16213788430417, -51.10366477642217, 116.83956373415747, -52.8045594125111, 70.99103914803304, -131.7991098879863, 37.51070134716157, -53.248935035240486, 36.24227924402416, -193.22537261143233, -128.386248906549, 101.45710718206377, 44.183767520220506, -52.31578860949552, 43.17471292614348, -53.863742262557295, -33.505805728618526, 132.01088794125818, 200.83806891834186, 40.0000000000003, 132.2116763344054, 36.63745732459566, -122.41326186346049, 22.541606912431217, -50.94222808574193, 53.75634255276498, 38.031641948585865, 146.39838186232473, 156.56959403480866, -66.23596633038528, 106.30560488455929, 161.3433522090086, 8.917612886123752, -67.82244143454128, 5.105406456850976, 30.862425299173108, -99.94484904704274, -28.501433899777457, -5.840076658955528, 12.819812246966185, 34.74740300313354, 218.984829398125, 68.33862800417783, 149.79104384068933, 215.2555191293806, 22.37592458206176, 185.2994969090776], "policy_predator_policy_reward": [65.41321271375149, 40.04554698928277, 116.08211742290453, 87.7395796508728, 54.28155747666749, 58.965706538401605, 34.98369820565018, 78.72681102239234, 187.71805448921623, 78.05810770035887, 153.64383201832072, 146.1730855177134, 55.155547446816, 106.79665744265246, 171.87629098064463, 43.24322242666677, 24.159607649635607, 89.87085547509881, 48.33816708535444, 63.45085555600393, 1.6348017060784839, 140.31308082471082, 70.105116003369, 72.10280554231576, 139.08870973020373, 0.850240373148967, 62.574813958480775, 48.69223213953975, 59.60136844190301, 12.785716644841369, 363.1287890903541, 188.39854896763558, 58.233494232440044, 88.270361543681, 55.608874961407295, 49.015868576188716, 104.81398921171076, 71.8887049198741, 210.45534002374566, 70.234463298683, 142.14411500824014, 196.63841198938206, 27.364627604241058, 94.3247631927269, 93.76796305010666, 68.10855623971132, 92.73476834125367, 215.53075603884918, 85.00925252477118, 53.17006700484292, 93.80050947707143, 213.36114801242445, 156.91819487478855, 64.98038741411577, 31.02858256128179, 99.84710510079253, 162.64348379857788, 235.55227452962643, 86.07042297601382, 59.35241863504699, 174.61370252857728, 259.0405115009663, 107.80239034899353, 0.0, 5.025029056619729, 0.0, 198.22709107178426, 13.445294145295781, 26.377605244943723, 212.45634424857596, 120.19514846254553, 13.68461149059681, 241.61522381480788, 16.10491488176061, 227.35081663407797, 26.373339527331012, 198.54170062432775, 243.93898083689504, 113.60136774663465, 313.931113633994, 59.884565409719926, 280.5574144916582, 7.277178303977733, 186.4325174150363, 180.02261322282897, 152.8263125477997, 29.446822759968214, 80.16895603450892, 25.331399349313756, 65.58711647941885, 220.92314911322563, 67.86191870279795, 191.14815507999285, 34.467338750618126, 174.69121321991724, 0.0, 26.714220587309768, 8.372662155631499, 33.83646403693388, 0.0, 56.816676777675, 27.576897432722504, 1.8357579614351818, 181.78349741237216, 274.8483072671647, 55.26217089983188, 40.516822761892996, 56.82960434393229, 13.681599312558117, 64.74776768774639, 239.92353729889638, 106.80488208009729, 30.356332891807433, 86.42206211332079, 43.58831611483603, 23.968283148522264, 173.95789846790862, 34.28928454904763, 50.445021438798165, 1.7182803404032012, 87.6288392988667, 4.006279563642017, 153.96973183114835, 82.47947260133614, 74.93502983876454, 127.32561144298103, 26.70975470402275, 28.85813003772905, 82.18137625476791, 215.71331530795402, 68.86904470594112, 195.06630718116483, 95.84405565419242, 237.92691892079367, 33.85006037034261, 16.73891535053083, 139.02935655826101, 7.360230021664218, 65.86201685607469, 0.0, 112.43306576253701, 327.1559133530026, 44.91919278650681, 159.5288389016613, 351.1683143283587, 27.32050125723867, 3.7135446030727772, 14.525649243518622, 44.28827645102132, 24.422762018970907, 99.94529380170326, 40.41599677780096, 222.1430863932853, 3.2379568529477667, 158.08360140981696, 64.82290876641494, 107.4424950928571, 24.41017612565391, 100.73330856946667, 229.72032276820468, 117.07454896547797, 263.2813068601923, 40.83991312128083, 120.15906020792102, 159.96997976135881, 221.81855875477314, 29.40908458373469, 137.06596353978492, 100.08722263151063, 82.73976510685806, 58.07047707130354, 152.73050946662875, 96.08728971192325, 113.52440185984233, 170.28157258253836, 21.24678441554952, 153.19108354759763, 84.4184677589778, 169.14798681285328, 140.31563883080312, 31.021113627041917, 63.75962616705279, 196.28804441632408, 44.04193589259301, 94.79559619479647, 65.28291631661902, 276.00195664007725, 0.0, 47.86851967461434, 245.01749687408997, 20.851304574632685, 15.37306573863303, 231.7202741967607, 63.233845263838916, 173.23911173754786, 2.0103495525522153, 97.64252842523177, 130.31226426972222, 155.49781916604846, 68.57944226321449, 149.3541863136223, 55.40012607815472, 71.47165793463552, 61.54854798252849, 45.91306342186897, 99.91663942905289, 40.400181038610796, 61.13013732190518, 155.94863424276878, 68.2206920328788, 48.43816361367874, 126.41495032920223, 26.200947108950455, 151.19843895722045, 131.5995598064818, 78.14220967943359, 87.8883370067319, 96.99341740061799, 37.0036157292265, 202.1851116818425, 43.3902612663139, 2.1481388505967747, 26.231402601741795, 72.17426138599247, 147.60405213557962, 86.79712265341341, 104.06041317671718, 112.55521383728187, 90.54659882040563, 47.05737143284607, 103.44719615420765, 186.45399523523741, 162.47511579471652, 11.80699200826864, 19.856959761554208, 194.34143284863026, 48.542845913879304, 240.71274993483254, 67.08173916621668, 143.8955914599637, 43.77915443692833, 61.893820402203666, 15.677968088755899, 204.7901333622648, 177.21780168161558, 102.80453387864216, 100.96856095418018, 58.50810793887233, 289.12491588752465, 131.92057082701288, 110.78412081045124, 51.97432042772843, 176.23048066998157, 121.5560273895129, 68.93591783121933, 98.51017466984676, 128.46752724418917, 168.29000620707504, 48.02729125766392, 130.68146735534347, 131.18913182304306, 192.3817217991505, 48.19535314525754, 181.180313862048, 80.13966558251079, 95.16507748253842, 269.7825368105921, 93.09292089179381, 39.79872998961887, 18.02995529657734, 109.8498907739323, 137.32401271498432, 113.7283256935689, 4.769748136085514, 38.576861072410296, 132.95229740863724, 155.56506844077106, 46.95132522634683, 186.1394111109409, 106.30798645110386, 84.44784036552419, 85.49437753832613, 23.330025898298754, 104.6797014411127, 3.006284174218549, 19.497170180928837, 17.37481149210957, 98.77833616585981, 176.9701501746243, 44.51570826533753, 5.472669599558877, 145.17646184403412, 80.80316167563412, 164.4657861564654, 9.406797041021992, 25.10147335085969, 81.22483258108964, 173.35558059855606, 94.51008857481871, 121.21355572352124, 171.5209230369442, 101.01066245165607, 38.5287945746093, 108.1429517607265, 82.84586068447999, 18.678737104923243, 166.93029793072114, 0.0, 22.067562853751355, 185.9487125447559, 154.54328058889374, 38.437275510065525, 23.566269534098325, 0.0, 6.494014379329991, 18.09303993353499, 164.8770672007151, 0.0, 61.20076283425353, 41.8049316666644, 71.30928810648952, 132.74121445592516, 77.371786402067, 62.55993725987225, 10.887985680512429, 15.992259707617825, 75.4200201501784, 136.89329606541347, 59.74127192017386, 18.98133708118949, 83.21669860159764, 34.93924269284463, 86.91491943989773, 27.618934414143443, 71.48651174832942, 39.39769738391985, 282.33156724352756, 149.96265146640144, 56.324713174704115, 177.06175296614543, 149.58098001196828, 75.69207936556595, 194.93955355904063, 78.19568618259922, 100.96150030381143, 194.02368361867642, 37.759202391694856, 10.164940139144534, 100.78970476082426, 224.89042402927157, 105.47515681906792, 155.16037459038148, 13.177037022863404, 149.45309904688088, 41.031042891577, 42.49131432480251, 135.2261558194316, 286.79863842623627, 26.14991517751511, 87.66452473406795, 119.54859504933701, 80.47894506461736, 69.78449433791371, 144.69240718988698, 247.4959024563925, 136.46268400501378, 34.807343008996874, 167.93353911822987, 103.06123992013234, 153.2328082656397, 26.695898404564787, 85.4762589472214, 120.63194854780127, 38.190600105976515, 55.08436423530953, 168.69007634354045, 17.736659431328423, 60.44797286795109, 1.7110247777577667, 28.749564786040608, 18.483751972195385, 101.45510524736764, 138.3687202549282, 0.0, 15.004683993830525, 26.010317813344184, 55.51814749475017, 171.8664686310841, 61.15204175180902, 38.95651528921255, 181.7813654362799, 17.211327498844756, 139.96900699880996, 348.5188349911228, 109.10385388355866, 237.760634455546, 70.62096308114661, 130.33506183020967, 9.426556449222653, 96.23314477848442, 248.51034034457078, 204.43468084329263, 47.11270971832341, 3.9131244544017667, 51.83439342028794, 303.062723422233, 41.6289361548668, 4.642892817934653, 161.31725399210015, 106.11413168039894, 64.2840238477804, 161.62058707976934, 139.07252056912833, 29.548655921902245, 166.61184371760638, 85.63317389900149, 111.89765772925962, 14.222038044956928, 94.46081000173906, 3.9658467929887222, 141.79924581646378, 70.48535138704044, 156.7469189334959, 142.35416555428247, 53.07586404210426, 2.6663525275794777, 121.79498092052158, 66.96318115973567, 98.99571977585872, 139.86223980760806, 145.07225525852658, 214.07424733874143, 159.70997918915873, 84.03376068959614, 148.03249752869485, 21.383881583169725, 34.01565879563212, 24.774541578265243, 63.368430144292766, 131.1961923306383, 53.5824068653732, 37.17728821468751, 16.03512077910148, 93.68809743058677, 70.30509328807115]}, "sampler_perf": {"mean_raw_obs_processing_ms": 11.537401691610313, "mean_inference_ms": 7.851866277486682, "mean_action_processing_ms": 6.503086492795352, "mean_env_wait_ms": 11.653373458730451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019004237785767972, "StateBufferConnector_ms": 0.012807899646544725, "ViewRequirementAgentConnector_ms": 0.23217750399300222}, "num_episodes": 32, "episode_return_max": 1204.2346331710303, "episode_return_min": 235.0414969238198, "episode_return_mean": 655.1680448683711, "episodes_this_iter": 32}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 64.76851435703787, "num_env_steps_trained_throughput_per_sec": 64.76851435703787, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 62017.849, "restore_workers_time_ms": 0.02, "training_step_time_ms": 62017.782, "sample_time_ms": 4064.617, "learn_time_ms": 57930.488, "learn_throughput": 69.048, "synch_weights_time_ms": 14.628}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": true, "training_iteration": 10, "trial_id": "e08ae66a", "date": "2024-08-24_03-29-26", "timestamp": 1724450366, "time_this_iter_s": 61.80964398384094, "time_total_s": 620.6230781078339, "pid": 92815, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.827838516649127, "lr": 0.00010783655643585861, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b359a0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 620.6230781078339, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 29.467816091954028, "ram_util_percent": 82.98390804597702}}
