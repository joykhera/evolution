{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49533723265628654, "cur_kl_coeff": 0.2, "cur_lr": 1.6571706137650873e-05, "total_loss": 3.817716490893354, "policy_loss": -0.0005432372230585594, "vf_loss": 3.8175586470120018, "vf_explained_var": 0.007087902557065279, "kl": 0.0035054210941218265, "entropy": 1.6084918855861494, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 1178.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2050127542322608, "cur_kl_coeff": 0.2, "cur_lr": 1.6571706137650873e-05, "total_loss": 5.271705845612123, "policy_loss": -0.0035235111193332004, "vf_loss": 5.274494112626256, "vf_explained_var": 0.028159927106966638, "kl": 0.0036762701424586167, "entropy": 1.6066773782110517, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 1178.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 57.91547081262686, "num_env_steps_trained_throughput_per_sec": 57.91547081262686, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 69066.182, "restore_workers_time_ms": 0.016, "training_step_time_ms": 69066.131, "sample_time_ms": 10002.685, "learn_time_ms": 59037.885, "learn_throughput": 67.753, "synch_weights_time_ms": 14.057}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 1, "trial_id": "06beb368", "date": "2024-08-24_02-26-34", "timestamp": 1724446594, "time_this_iter_s": 69.12373805046082, "time_total_s": 69.12373805046082, "pid": 55087, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9502100839948125, "lr": 1.6571706137650876e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3072040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 69.12373805046082, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 35.87070707070707, "ram_util_percent": 83.48585858585857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7880502886453252, "cur_kl_coeff": 0.1, "cur_lr": 1.6571706137650873e-05, "total_loss": 3.5524135832573958, "policy_loss": -0.002598155945571112, "vf_loss": 3.5548369737693966, "vf_explained_var": 0.03770379612653372, "kl": 0.0017476957203373471, "entropy": 1.6079875617017159, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 3533.0, "diff_num_grad_updates_vs_sampler_policy": 1203.4937499999999}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5034086686916919, "cur_kl_coeff": 0.1, "cur_lr": 1.6571706137650873e-05, "total_loss": 4.94809482062192, "policy_loss": -0.003729807220462654, "vf_loss": 4.951652246422575, "vf_explained_var": 0.046525945000334655, "kl": 0.0017237933774996795, "entropy": 1.606302785012879, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 3533.0, "diff_num_grad_updates_vs_sampler_policy": 1203.4937499999999}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 63.51951325408238, "num_env_steps_trained_throughput_per_sec": 63.51951325408238, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 66019.482, "restore_workers_time_ms": 0.015, "training_step_time_ms": 66019.433, "sample_time_ms": 7241.698, "learn_time_ms": 58756.424, "learn_throughput": 68.078, "synch_weights_time_ms": 13.44}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 2, "trial_id": "06beb368", "date": "2024-08-24_02-27-40", "timestamp": 1724446660, "time_this_iter_s": 63.00414514541626, "time_total_s": 132.12788319587708, "pid": 55087, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9502100839948125, "lr": 1.6571706137650876e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2f44700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 132.12788319587708, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 30.92173913043479, "ram_util_percent": 83.1717391304348}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1878622473804814, "cur_kl_coeff": 0.05, "cur_lr": 1.6571706137650873e-05, "total_loss": 3.456149074378287, "policy_loss": -0.0032173929751836824, "vf_loss": 3.4592061092899105, "vf_explained_var": 0.10350290491322803, "kl": 0.0032071774178496, "entropy": 1.605461631560275, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 5888.0, "diff_num_grad_updates_vs_sampler_policy": 1229.39875}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.166233125803577, "cur_kl_coeff": 0.05, "cur_lr": 1.6571706137650873e-05, "total_loss": 5.213508804993518, "policy_loss": -0.00444861888873634, "vf_loss": 5.217760270416357, "vf_explained_var": 0.1255315826450437, "kl": 0.003943124817841985, "entropy": 1.6025590315492797, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 5888.0, "diff_num_grad_updates_vs_sampler_policy": 1229.39875}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 63.660016887957475, "num_env_steps_trained_throughput_per_sec": 63.660016887957475, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 64957.589, "restore_workers_time_ms": 0.015, "training_step_time_ms": 64957.538, "sample_time_ms": 5927.393, "learn_time_ms": 59007.751, "learn_throughput": 67.788, "synch_weights_time_ms": 14.459}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 3, "trial_id": "06beb368", "date": "2024-08-24_02-28-43", "timestamp": 1724446723, "time_this_iter_s": 62.864928007125854, "time_total_s": 194.99281120300293, "pid": 55087, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9502100839948125, "lr": 1.6571706137650876e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3f81820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 194.99281120300293, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 36.004494382022465, "ram_util_percent": 83.08089887640448}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.869500770513166, "cur_kl_coeff": 0.025, "cur_lr": 1.6571706137650873e-05, "total_loss": 3.334741742342647, "policy_loss": -0.0023753618419115013, "vf_loss": 3.337038495940514, "vf_explained_var": 0.1533353529664868, "kl": 0.0031440034244731544, "entropy": 1.6050929044209215, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 8243.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.459954683365589, "cur_kl_coeff": 0.025, "cur_lr": 1.6571706137650873e-05, "total_loss": 5.283991259981872, "policy_loss": -0.006915741624615121, "vf_loss": 5.29079596312942, "vf_explained_var": 0.1876352611873813, "kl": 0.004441698366551681, "entropy": 1.595789979369777, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 8243.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 65.96644704320582, "num_env_steps_trained_throughput_per_sec": 65.96644704320582, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 63877.417, "restore_workers_time_ms": 0.015, "training_step_time_ms": 63877.364, "sample_time_ms": 5204.807, "learn_time_ms": 58651.362, "learn_throughput": 68.2, "synch_weights_time_ms": 14.234}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 4, "trial_id": "06beb368", "date": "2024-08-24_02-29-44", "timestamp": 1724446784, "time_this_iter_s": 60.680081844329834, "time_total_s": 255.67289304733276, "pid": 55087, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9502100839948125, "lr": 1.6571706137650876e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3f5b5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 255.67289304733276, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 28.395348837209298, "ram_util_percent": 82.90813953488373}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8957502640989428, "cur_kl_coeff": 0.0125, "cur_lr": 1.6571706137650873e-05, "total_loss": 3.5392560034547387, "policy_loss": -0.0034720426059531686, "vf_loss": 3.542675816734379, "vf_explained_var": 0.2057458796318929, "kl": 0.004178808704552472, "entropy": 1.5998338409290191, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 10598.0, "diff_num_grad_updates_vs_sampler_policy": 1229.39875}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9040826102477477, "cur_kl_coeff": 0.0125, "cur_lr": 1.6571706137650873e-05, "total_loss": 5.086904852253617, "policy_loss": -0.008236949779824877, "vf_loss": 5.0950819427546925, "vf_explained_var": 0.20593376792413667, "kl": 0.004789055822982656, "entropy": 1.5874590200983036, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 10598.0, "diff_num_grad_updates_vs_sampler_policy": 1229.39875}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 65.92762684288323, "num_env_steps_trained_throughput_per_sec": 65.92762684288323, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 63236.454, "restore_workers_time_ms": 0.015, "training_step_time_ms": 63236.401, "sample_time_ms": 4748.699, "learn_time_ms": 58467.101, "learn_throughput": 68.415, "synch_weights_time_ms": 13.81}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "training_iteration": 5, "trial_id": "06beb368", "date": "2024-08-24_02-30-44", "timestamp": 1724446844, "time_this_iter_s": 60.72195076942444, "time_total_s": 316.3948438167572, "pid": 55087, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9502100839948125, "lr": 1.6571706137650876e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2f44430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 316.3948438167572, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 28.50941176470588, "ram_util_percent": 83.1905882352941}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.463190008677748, "cur_kl_coeff": 0.00625, "cur_lr": 1.6571706137650873e-05, "total_loss": 3.448466041892957, "policy_loss": -0.006092500341502502, "vf_loss": 3.4545219914422165, "vf_explained_var": 0.2687673952928774, "kl": 0.0058474627196405185, "entropy": 1.5912115982383679, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 12953.0, "diff_num_grad_updates_vs_sampler_policy": 1202.9050000000007}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.186367480997827, "cur_kl_coeff": 0.00625, "cur_lr": 1.6571706137650873e-05, "total_loss": 5.105294810131097, "policy_loss": -0.008558168793749658, "vf_loss": 5.113801802090525, "vf_explained_var": 0.2342043117859308, "kl": 0.008187364156144392, "entropy": 1.564346743490539, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 12953.0, "diff_num_grad_updates_vs_sampler_policy": 1202.9050000000007}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 63.17823634370032, "num_env_steps_trained_throughput_per_sec": 63.17823634370032, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 63249.205, "restore_workers_time_ms": 0.015, "training_step_time_ms": 63249.151, "sample_time_ms": 4639.641, "learn_time_ms": 58589.022, "learn_throughput": 68.272, "synch_weights_time_ms": 13.821}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 6, "trial_id": "06beb368", "date": "2024-08-24_02-31-48", "timestamp": 1724446908, "time_this_iter_s": 63.33722805976868, "time_total_s": 379.7320718765259, "pid": 55087, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9502100839948125, "lr": 1.6571706137650876e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3f5b820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 379.7320718765259, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 33.42333333333333, "ram_util_percent": 83.22666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.174440589680034, "cur_kl_coeff": 0.00625, "cur_lr": 1.6571706137650873e-05, "total_loss": 3.6548631655435906, "policy_loss": -0.0077479865833041265, "vf_loss": 3.6625617951091436, "vf_explained_var": 0.31269601383533197, "kl": 0.007897157852306583, "entropy": 1.5781737244559448, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 15308.0, "diff_num_grad_updates_vs_sampler_policy": 1203.4937499999996}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.58619600843219, "cur_kl_coeff": 0.00625, "cur_lr": 1.6571706137650873e-05, "total_loss": 5.462743871632148, "policy_loss": -0.01130942801654244, "vf_loss": 5.473982369368243, "vf_explained_var": 0.2517008226135481, "kl": 0.011351481025382054, "entropy": 1.5581209049609563, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 15308.0, "diff_num_grad_updates_vs_sampler_policy": 1203.4937499999996}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "env_runners": {"episode_reward_max": 1243.154412757868, "episode_reward_min": 1243.154412757868, "episode_reward_mean": 1243.154412757868, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 400, "policy_reward_min": {"prey_policy": -88.58242015267409, "predator_policy": 4.405651009890592}, "policy_reward_max": {"prey_policy": 342.39999999999986, "predator_policy": 192.6285883013717}, "policy_reward_mean": {"prey_policy": 182.89884117900812, "predator_policy": 65.7320413725648}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1243.154412757868], "episode_lengths": [400], "policy_prey_policy_reward": [342.39999999999986, -88.58242015267409, 223.1746746224407, 236.15022464527294, 201.35172678000117], "policy_predator_policy_reward": [42.218380577634676, 49.858368668863385, 4.405651009890592, 39.54921830506361, 192.6285883013717]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.277467990743704, "mean_inference_ms": 8.404823171681372, "mean_action_processing_ms": 6.502449430268387, "mean_env_wait_ms": 10.437225802191373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005924701690673828, "StateBufferConnector_ms": 0.0059604644775390625, "ViewRequirementAgentConnector_ms": 0.1581430435180664}, "num_episodes": 1, "episode_return_max": 1243.154412757868, "episode_return_min": 1243.154412757868, "episode_return_mean": 1243.154412757868, "episodes_this_iter": 1}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 64.48551186754142, "num_env_steps_trained_throughput_per_sec": 64.48551186754142, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 63074.955, "restore_workers_time_ms": 0.015, "training_step_time_ms": 63074.902, "sample_time_ms": 4416.882, "learn_time_ms": 58637.752, "learn_throughput": 68.215, "synch_weights_time_ms": 13.771}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "training_iteration": 7, "trial_id": "06beb368", "date": "2024-08-24_02-32-50", "timestamp": 1724446970, "time_this_iter_s": 62.07622027397156, "time_total_s": 441.80829215049744, "pid": 55087, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9502100839948125, "lr": 1.6571706137650876e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3072dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 441.80829215049744, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 30.468965517241383, "ram_util_percent": 82.4103448275862}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.524377572688327, "cur_kl_coeff": 0.00625, "cur_lr": 1.6571706137650873e-05, "total_loss": 3.6850577193460645, "policy_loss": -0.008067810503991356, "vf_loss": 3.6930847981932815, "vf_explained_var": 0.34908222714300624, "kl": 0.006517862858282374, "entropy": 1.5712592251488104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 17663.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.992271058372125, "cur_kl_coeff": 0.00625, "cur_lr": 1.6571706137650873e-05, "total_loss": 5.317129505363999, "policy_loss": -0.010306889003225763, "vf_loss": 5.327358871508556, "vf_explained_var": 0.34980082203121954, "kl": 0.01240302714185034, "entropy": 1.5304104800436906, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 17663.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 1243.154412757868, "episode_reward_min": 286.81872951404534, "episode_reward_mean": 715.3773654226367, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 10800, "policy_reward_min": {"prey_policy": -430.22864924110587, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 342.39999999999986, "predator_policy": 565.381544920772}, "policy_reward_mean": {"prey_policy": -4.8854585303921265, "predator_policy": 147.96093161491845}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1243.154412757868, 737.4437031228454, 587.1549762436837, 652.3528539766405, 681.8625381887565, 286.81872951404534, 782.9474252603408, 821.5704619433566, 769.7351064455289, 803.6023419200612, 512.401691947903, 578.5631381719747, 713.2636029237935, 1006.3072426169163, 580.5176837751517, 1153.1120606873378, 919.2236463429653, 493.84452524264736, 506.07806868721013, 603.0842963864994, 1099.1316863708626, 314.44678261918955, 832.0913305574322, 484.10072112421415, 424.2173983055618, 934.6747972602716, 793.4876440181341], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [342.39999999999986, -88.58242015267409, 223.1746746224407, 236.15022464527294, 201.35172678000117, -41.74385532553166, 77.58671379786944, -40.67803043823067, 35.42316794473711, -31.552359820700993, 59.41525635959274, 27.442571680764267, -200.00217509576163, 88.63429723648743, 52.79892176736651, -24.726742245926307, -71.36891505191394, 228.97765775675924, -3.6396207607024857, -34.41298762695767, -22.039074035144203, -214.93891120740324, -309.02542354472286, -103.00233952707966, -68.77962316839405, -135.91565874173725, -65.9624218032378, 29.660949393354556, -277.2598652768891, -25.15516311094558, -25.1128938433247, 40.0000000000003, 28.270674747080093, 224.78665465778548, -85.29153118004052, -29.261793773050158, 105.11134975861196, -49.28965264284265, 187.7348493606679, -173.65439662132906, -289.70299737890406, 8.39040903016192, -318.64386815123174, 79.62642484076416, 38.1921427900812, 287.86676773212207, -32.237321125735164, 90.67369944129814, 259.1037299716479, -128.12591691158113, 98.61922317682925, 60.46667556278179, -184.27971545630018, -231.79405558778615, -124.77966305085977, -320.2924810628292, -38.327472098711866, -207.78699274248348, 126.67773731822176, -50.98838832279297, 14.513590458912898, -51.946468235282104, -222.93397748537868, 200.25097531006395, 52.75127028758163, 129.96661776179565, 171.1998570217233, 27.89303940248951, 254.91849845958546, -430.22864924110587, -28.976611748160533, -18.392751432458585, -13.390374951439433, -139.700299748392, 148.91682271336262, -164.42376248472402, 211.54943318190297, 151.02467664918282, 153.20362226190446, 336.99999999999994, 6.969922705373863, 45.8057781329065, 5.57418740131641, 198.44116365524977, 141.29626411680968, 256.3755567651423, 10.398782992096733, -243.34943079834656, -369.4652148263878, 12.315752755057957, 119.11804405505445, -69.41838726714067, -85.91274081693284, -35.94620768162878, -162.28397757973667, 128.46083235433616, 60.72786077334774, -76.83146111463276, 20.674968751589024, -31.2686054177408, 77.48742671491995, -143.19252873042987, 328.47898158724877, -15.621248972874753, 188.2078041214591, -99.11006367438829, -25.199450496496528, -108.45816687526347, -23.07758289453438, 105.88162199510603, -151.8784630707976, -130.2903664593952, 7.994331632665784, 246.8881284586812, -117.07309579988214, 49.50789522677806, -32.09590703056901, -23.996890937695873, -174.51351505843138, 14.156584016632529, -19.71189425809336, -103.10252216838205, -240.2901594570748, -199.34225781550234, -235.38503465505033, -218.7340130108897, 97.05449082039077, -22.279441977725014, -96.93352299954635, 163.65446866966036, -27.823379137498073, 97.7763169979541, 33.0929732310296, 121.77876536893422, 111.55244440988142], "policy_predator_policy_reward": [42.218380577634676, 49.858368668863385, 4.405651009890592, 39.54921830506361, 192.6285883013717, 237.65309849180355, 163.1645271576392, 258.11689927994973, 70.94095274132589, 8.532589293979342, 206.82845900421475, 0.0, 166.38470966285823, 135.71328480312667, 49.93965082502891, 20.23511532854537, 174.98871307966786, 122.9732791800607, 98.1423083394736, 141.18404597763237, 377.8412385553202, 277.7119012856862, 361.3909131218403, 382.7038567086495, 0.0, 210.69763496432594, 15.075612039323298, 70.80401425143114, 317.2992884294181, 147.5743393690011, 8.912969924323775, 339.0790404807655, 94.87701532101303, 94.54385185218403, 62.8816433005429, 231.43177942748412, 164.0713799580137, 31.571884706527257, 214.52223100276126, 139.3328307664966, 262.56790669538395, 363.58284863203653, 245.70373605625258, 317.300739399652, 62.71776453133264, 91.35071347926399, 32.059963723443666, 29.643912015572635, 19.774528030407275, 153.49226556360966, 212.67878767439728, 65.80407948632153, 293.00631695858846, 248.2335490954173, 74.44649408850809, 328.3257229571866, 417.0672817705075, 100.20885654101784, 175.0211798444793, 48.65769396736681, 161.5425833079981, 90.091394348538, 157.86563761086884, 279.74094206472614, 31.387655255758272, 295.48497750663057, 219.25450518925356, 91.98095657361064, 28.75516633901441, 217.08227360391874, 164.9646948934952, 0.0, 200.19987852102142, 244.2480152367895, 22.648310290933324, 246.97803037167716, 113.63212599597769, 0.0, 0.0, 104.14793471141641, 44.76642626966994, 133.05790206795754, 54.17881661396047, 15.369599948448183, 273.7635854312681, 0.0, 13.479580692281152, 179.1657946429513, 471.0753863714589, 163.84831664838475, 56.0481020919389, 15.738617500598483, 114.02357378896697, 445.4258901667273, 109.28515442936659, 146.4796828999282, 54.46485082350388, 134.67053002056468, 66.39240415313688, 99.31323314245114, 292.2664489577552, 0.0, 0.0, 257.02062019625254, 114.48418249652808, 39.75128639433618, 137.2270503771172, 25.666895647604118, 58.64592125421853, 203.11927089148693, 565.381544920772, 261.1305484219228, 0.9488623650259026, 57.79715007322368, 91.19269001520703, 210.925202727456, 103.32769053332434, 226.19704178161763, 108.91400864934894, 1.678611215750487, 224.4151993185194, 32.41791712274495, 333.9561914486416, 411.23814251796756, 220.02181625179026, 6.29398590217026, 354.69754836449175, 374.94459494779426, 181.40543104406748, 94.57125549985746, 9.589828361624622, 82.04019881360331, 176.2191757931708, 95.26093625135874, 94.00038392806697]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.267107269118188, "mean_inference_ms": 8.321116455155087, "mean_action_processing_ms": 4.941392980708555, "mean_env_wait_ms": 11.68012125229162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005605044188322844, "StateBufferConnector_ms": 0.008670930509214048, "ViewRequirementAgentConnector_ms": 0.23187752123232241}, "num_episodes": 26, "episode_return_max": 1243.154412757868, "episode_return_min": 286.81872951404534, "episode_return_mean": 715.3773654226367, "episodes_this_iter": 26}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 64.99694076274379, "num_env_steps_trained_throughput_per_sec": 64.99694076274379, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 62883.257, "restore_workers_time_ms": 0.015, "training_step_time_ms": 62883.204, "sample_time_ms": 4259.907, "learn_time_ms": 58603.377, "learn_throughput": 68.255, "synch_weights_time_ms": 13.776}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 8, "trial_id": "06beb368", "date": "2024-08-24_02-33-51", "timestamp": 1724447031, "time_this_iter_s": 61.58487415313721, "time_total_s": 503.39316630363464, "pid": 55087, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9502100839948125, "lr": 1.6571706137650876e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2f445e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 503.39316630363464, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 30.79540229885058, "ram_util_percent": 82.15172413793105}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.578672723026033, "cur_kl_coeff": 0.00625, "cur_lr": 1.6571706137650873e-05, "total_loss": 3.234926676041508, "policy_loss": -0.008627413537040858, "vf_loss": 3.2435081677831663, "vf_explained_var": 0.3345968745316669, "kl": 0.00734696562828065, "entropy": 1.5637966240540684, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 20018.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.182865460005029, "cur_kl_coeff": 0.00625, "cur_lr": 1.6571706137650873e-05, "total_loss": 4.873271702100264, "policy_loss": -0.009047450171289233, "vf_loss": 4.882263575997322, "vf_explained_var": 0.3555711955274999, "kl": 0.008890887059077557, "entropy": 1.5247295550226911, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 20018.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "env_runners": {"episode_reward_max": 1243.154412757868, "episode_reward_min": 286.81872951404534, "episode_reward_mean": 723.1279824525332, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 21200, "policy_reward_min": {"prey_policy": -430.22864924110587, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 342.39999999999986, "predator_policy": 565.381544920772}, "policy_reward_mean": {"prey_policy": -3.6223570463688737, "predator_policy": 148.24795353687455}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1243.154412757868, 737.4437031228454, 587.1549762436837, 652.3528539766405, 681.8625381887565, 286.81872951404534, 782.9474252603408, 821.5704619433566, 769.7351064455289, 803.6023419200612, 512.401691947903, 578.5631381719747, 713.2636029237935, 1006.3072426169163, 580.5176837751517, 1153.1120606873378, 919.2236463429653, 493.84452524264736, 506.07806868721013, 603.0842963864994, 1099.1316863708626, 314.44678261918955, 832.0913305574322, 484.10072112421415, 424.2173983055618, 934.6747972602716, 793.4876440181341, 586.613478646524, 949.7691013834097, 1185.8656206154437, 648.8125265147582, 904.1006974359686, 462.8464158189842, 619.5750139837445, 624.2161089161579, 521.1766687321249, 434.83651604625305, 899.0923109182713, 704.1561694919978, 746.4656582756345, 612.8542366357725, 709.6590706207876, 897.8576780543538, 576.7320444682139, 367.86349399309097, 603.5268908635816, 1137.496963158202, 915.869999181292, 522.9335878435471, 697.1031339129927, 840.004778059082, 949.0588139375503, 892.1072260653409], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [342.39999999999986, -88.58242015267409, 223.1746746224407, 236.15022464527294, 201.35172678000117, -41.74385532553166, 77.58671379786944, -40.67803043823067, 35.42316794473711, -31.552359820700993, 59.41525635959274, 27.442571680764267, -200.00217509576163, 88.63429723648743, 52.79892176736651, -24.726742245926307, -71.36891505191394, 228.97765775675924, -3.6396207607024857, -34.41298762695767, -22.039074035144203, -214.93891120740324, -309.02542354472286, -103.00233952707966, -68.77962316839405, -135.91565874173725, -65.9624218032378, 29.660949393354556, -277.2598652768891, -25.15516311094558, -25.1128938433247, 40.0000000000003, 28.270674747080093, 224.78665465778548, -85.29153118004052, -29.261793773050158, 105.11134975861196, -49.28965264284265, 187.7348493606679, -173.65439662132906, -289.70299737890406, 8.39040903016192, -318.64386815123174, 79.62642484076416, 38.1921427900812, 287.86676773212207, -32.237321125735164, 90.67369944129814, 259.1037299716479, -128.12591691158113, 98.61922317682925, 60.46667556278179, -184.27971545630018, -231.79405558778615, -124.77966305085977, -320.2924810628292, -38.327472098711866, -207.78699274248348, 126.67773731822176, -50.98838832279297, 14.513590458912898, -51.946468235282104, -222.93397748537868, 200.25097531006395, 52.75127028758163, 129.96661776179565, 171.1998570217233, 27.89303940248951, 254.91849845958546, -430.22864924110587, -28.976611748160533, -18.392751432458585, -13.390374951439433, -139.700299748392, 148.91682271336262, -164.42376248472402, 211.54943318190297, 151.02467664918282, 153.20362226190446, 336.99999999999994, 6.969922705373863, 45.8057781329065, 5.57418740131641, 198.44116365524977, 141.29626411680968, 256.3755567651423, 10.398782992096733, -243.34943079834656, -369.4652148263878, 12.315752755057957, 119.11804405505445, -69.41838726714067, -85.91274081693284, -35.94620768162878, -162.28397757973667, 128.46083235433616, 60.72786077334774, -76.83146111463276, 20.674968751589024, -31.2686054177408, 77.48742671491995, -143.19252873042987, 328.47898158724877, -15.621248972874753, 188.2078041214591, -99.11006367438829, -25.199450496496528, -108.45816687526347, -23.07758289453438, 105.88162199510603, -151.8784630707976, -130.2903664593952, 7.994331632665784, 246.8881284586812, -117.07309579988214, 49.50789522677806, -32.09590703056901, -23.996890937695873, -174.51351505843138, 14.156584016632529, -19.71189425809336, -103.10252216838205, -240.2901594570748, -199.34225781550234, -235.38503465505033, -218.7340130108897, 97.05449082039077, -22.279441977725014, -96.93352299954635, 163.65446866966036, -27.823379137498073, 97.7763169979541, 33.0929732310296, 121.77876536893422, 111.55244440988142, -63.65613473247555, 205.79536180297637, 19.259133299312026, -158.98746750407327, 47.22192461739362, 99.79018263132093, 97.95639586263891, 89.25914231468948, -62.039872809387916, 21.775808663797385, -162.20908421124986, 30.822445862303688, 120.51193474270346, 80.61756637171325, 334.30353031302616, 74.39899079096588, -81.55300860513066, 146.91824033837037, -335.2226385454351, -74.45482753407026, 236.5778429574253, -92.81278154178777, 271.87746253170644, -11.725926107695095, 79.48906528431934, 31.437319850495843, -42.40634636086273, -229.30741220724198, 18.62194894735493, -107.27933031277915, 51.38889605964588, -27.484992821076442, 118.89273105419004, 110.16772084651387, -20.53997610714471, 147.3009299013861, -163.99389108730495, 17.691171101099382, -108.3407583762351, 195.1630410858734, -0.5561498371610123, 30.29381615831993, -212.22649242891174, 12.6405366994235, -85.75619357565813, -119.94697418250196, -28.19912582453989, -157.02610816125136, 22.97774459392565, 1.5733020158342463, 293.02864637922437, 181.18680472623979, -266.5571058946396, -234.30867172324727, 88.24804672961886, 7.017406856258205, -132.35620454922446, 227.90658743386248, -128.1215260995968, -328.43900051839984, -155.20106838838677, -13.64725837541716, 199.55859683821313, -28.88418922514137, 110.95220217316208, -38.227365945228186, 127.95027254746697, -151.91440572147266, 18.403129002107242, -180.83464115471736, 138.197795167018, -110.51260297539821, -351.1639010536759, 40.0000000000003, -7.0185970863683025, -236.18762367436142, 52.49585251650992, -12.05072322603827, 92.48213436937851, 86.2577279045111, -52.39071753070598, 77.09618309587582, 142.1668967530668, 7.241160173195143, -6.422066400262395, 4.236152481578257, -42.23221733885376, -329.040293988464, -137.28282595102473, 136.01463748328717, 61.28459549145423, 55.591346077691256, -93.21891280275334, -28.576719747884162, -30.539647516252458, 158.27039656162728, 258.3503071655163, 42.57862986889798, 86.71925703133506, -31.01168251099722, 179.54289676411804, 154.1140456157782, 211.535809922172, -179.69134268215885, -114.9625931638889, 181.56405933015543, -282.88745159787356, -128.79662285283163, -189.1665060412969, -168.13580460024153, -178.18441058418694, 160.6000000000002, -243.73275341722825, -210.0752634206224, 136.39771185749174, 22.24363379379445, -130.85117905738323, 54.06222341594544, -151.17386605349554, 202.36972002477336, -14.15885680241312, -91.19506253093465, 88.90426607265168, 23.7051027549113, 71.10418637205942, 247.73750748398015, 229.17154002635087, 149.78520555907667, -68.31398073225624, -197.99342039459677], "policy_predator_policy_reward": [42.218380577634676, 49.858368668863385, 4.405651009890592, 39.54921830506361, 192.6285883013717, 237.65309849180355, 163.1645271576392, 258.11689927994973, 70.94095274132589, 8.532589293979342, 206.82845900421475, 0.0, 166.38470966285823, 135.71328480312667, 49.93965082502891, 20.23511532854537, 174.98871307966786, 122.9732791800607, 98.1423083394736, 141.18404597763237, 377.8412385553202, 277.7119012856862, 361.3909131218403, 382.7038567086495, 0.0, 210.69763496432594, 15.075612039323298, 70.80401425143114, 317.2992884294181, 147.5743393690011, 8.912969924323775, 339.0790404807655, 94.87701532101303, 94.54385185218403, 62.8816433005429, 231.43177942748412, 164.0713799580137, 31.571884706527257, 214.52223100276126, 139.3328307664966, 262.56790669538395, 363.58284863203653, 245.70373605625258, 317.300739399652, 62.71776453133264, 91.35071347926399, 32.059963723443666, 29.643912015572635, 19.774528030407275, 153.49226556360966, 212.67878767439728, 65.80407948632153, 293.00631695858846, 248.2335490954173, 74.44649408850809, 328.3257229571866, 417.0672817705075, 100.20885654101784, 175.0211798444793, 48.65769396736681, 161.5425833079981, 90.091394348538, 157.86563761086884, 279.74094206472614, 31.387655255758272, 295.48497750663057, 219.25450518925356, 91.98095657361064, 28.75516633901441, 217.08227360391874, 164.9646948934952, 0.0, 200.19987852102142, 244.2480152367895, 22.648310290933324, 246.97803037167716, 113.63212599597769, 0.0, 0.0, 104.14793471141641, 44.76642626966994, 133.05790206795754, 54.17881661396047, 15.369599948448183, 273.7635854312681, 0.0, 13.479580692281152, 179.1657946429513, 471.0753863714589, 163.84831664838475, 56.0481020919389, 15.738617500598483, 114.02357378896697, 445.4258901667273, 109.28515442936659, 146.4796828999282, 54.46485082350388, 134.67053002056468, 66.39240415313688, 99.31323314245114, 292.2664489577552, 0.0, 0.0, 257.02062019625254, 114.48418249652808, 39.75128639433618, 137.2270503771172, 25.666895647604118, 58.64592125421853, 203.11927089148693, 565.381544920772, 261.1305484219228, 0.9488623650259026, 57.79715007322368, 91.19269001520703, 210.925202727456, 103.32769053332434, 226.19704178161763, 108.91400864934894, 1.678611215750487, 224.4151993185194, 32.41791712274495, 333.9561914486416, 411.23814251796756, 220.02181625179026, 6.29398590217026, 354.69754836449175, 374.94459494779426, 181.40543104406748, 94.57125549985746, 9.589828361624622, 82.04019881360331, 176.2191757931708, 95.26093625135874, 94.00038392806697, 238.60791925938133, 49.2481254283175, 50.04283245517292, 38.42140821286661, 160.66037580764916, 278.141424939047, 21.594925275662376, 179.58503696001281, 175.11682276518437, 48.58923478043769, 129.14875561188776, 199.56853948082235, 88.7586997671647, 58.72476999627628, 305.6184626807916, 102.71057053881506, 245.2508611026401, 18.638615678451057, 434.17251971853693, 117.95320303161057, 199.40432607043445, 12.005007933231884, 98.08167689243184, 110.17839250417677, 1.0256309117157039, 139.13640006074166, 199.64086926171686, 104.4814040495695, 244.5581867648341, 103.96337576515023, 161.6936497809011, 0.0, 26.635136031956687, 138.2239387723962, 60.597910366346916, 297.781027535276, 0.0, 0.0, 0.0, 238.6145887560594, 160.8741094016575, 107.59894781919091, 230.4215831428186, 158.43188657515526, 119.4546247772883, 83.68728772785742, 93.6674098492881, 73.22804553010737, 317.83496072141804, 147.03997377611296, 66.33340247476097, 418.8255140300006, 0.0, 263.4443471318919, 88.89132706441548, 384.9130006647417, 100.81915673603464, 148.78732363671432, 260.1046410786785, 163.52478425292406, 41.060001147934436, 164.21279005538798, 129.0538011369343, 68.95357570528016, 230.40720720766677, 171.29033930232953, 172.2625627337506, 261.22942678004745, 2.050395480745534, 230.64452361073756, 257.9738496310214, 134.22905139838227, 176.88254337574878, 285.94020333231555, 145.13072883173555, 91.56344089193705, 64.85873203571258, 223.9939526365162, 281.0558811338613, 253.3883034663255, 112.51921883512549, 147.90370872305104, 6.8964113526786495, 79.89063495679132, 61.83061450939289, 365.91256571544903, 102.11300522790171, 203.08529104018032, 6.39386871588364, 58.663310607155346, 88.61204215061474, 0.75765192923331, 268.35760244428457, 227.01109983000535, 54.24783300718487, 30.542551014424678, 295.2240214163951, 1.0381593898839114, 102.425051549514, 193.36027167159892, 164.3093500917919, 62.79970218990693, 118.34282281561967, 184.0175582921376, 135.8617493358007, 166.43600418379734, 123.21570212237252, 181.68736418646986, 279.2724825882252, 359.74436052476904, 110.82221490216887, 64.0753047499785, 472.7438403131854, 222.03919582890114, 162.41729368330002, 211.15069258173872, 36.857732944635615, 225.7305268670857, 233.47794591055376, 136.13734763143086, 389.4577729002104, 209.16916865434166, 80.73172861040993, 93.32172282287449, 98.01878508343752, 121.85402058924132, 85.25623590940863, 19.389291638268354, 115.6510321314428, 189.56979385441014]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.022546244584182, "mean_inference_ms": 8.255508727032074, "mean_action_processing_ms": 4.872322736630307, "mean_env_wait_ms": 11.677140986091665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015390818973757187, "StateBufferConnector_ms": 0.010120418836485665, "ViewRequirementAgentConnector_ms": 0.24388668672093805}, "num_episodes": 26, "episode_return_max": 1243.154412757868, "episode_return_min": 286.81872951404534, "episode_return_mean": 723.1279824525332, "episodes_this_iter": 26}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 65.46662532401895, "num_env_steps_trained_throughput_per_sec": 65.46662532401895, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 62685.1, "restore_workers_time_ms": 0.015, "training_step_time_ms": 62685.042, "sample_time_ms": 4104.733, "learn_time_ms": 58560.511, "learn_throughput": 68.305, "synch_weights_time_ms": 13.808}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "training_iteration": 9, "trial_id": "06beb368", "date": "2024-08-24_02-34-53", "timestamp": 1724447093, "time_this_iter_s": 61.14414715766907, "time_total_s": 564.5373134613037, "pid": 55087, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9502100839948125, "lr": 1.6571706137650876e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3533d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 564.5373134613037, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 27.40919540229885, "ram_util_percent": 80.86551724137931}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.659741514554196, "cur_kl_coeff": 0.00625, "cur_lr": 1.6571706137650873e-05, "total_loss": 2.754045746533987, "policy_loss": -0.009458501561546814, "vf_loss": 2.763448159760477, "vf_explained_var": 0.35184705495328156, "kl": 0.008974023203062974, "entropy": 1.5500720160781958, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 22373.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.429930158278998, "cur_kl_coeff": 0.00625, "cur_lr": 1.6571706137650873e-05, "total_loss": 4.3872481205407725, "policy_loss": -0.00860451729721024, "vf_loss": 4.395809776362847, "vf_explained_var": 0.40938949347048553, "kl": 0.006857672599075074, "entropy": 1.5077068129415978, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 22373.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 1243.154412757868, "episode_reward_min": 286.81872951404534, "episode_reward_mean": 751.5866119350724, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 36000, "policy_reward_min": {"prey_policy": -430.22864924110587, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 342.39999999999986, "predator_policy": 565.381544920772}, "policy_reward_mean": {"prey_policy": 0.4297044552848805, "predator_policy": 149.8876179317286}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1243.154412757868, 737.4437031228454, 587.1549762436837, 652.3528539766405, 681.8625381887565, 286.81872951404534, 782.9474252603408, 821.5704619433566, 769.7351064455289, 803.6023419200612, 512.401691947903, 578.5631381719747, 713.2636029237935, 1006.3072426169163, 580.5176837751517, 1153.1120606873378, 919.2236463429653, 493.84452524264736, 506.07806868721013, 603.0842963864994, 1099.1316863708626, 314.44678261918955, 832.0913305574322, 484.10072112421415, 424.2173983055618, 934.6747972602716, 793.4876440181341, 586.613478646524, 949.7691013834097, 1185.8656206154437, 648.8125265147582, 904.1006974359686, 462.8464158189842, 619.5750139837445, 624.2161089161579, 521.1766687321249, 434.83651604625305, 899.0923109182713, 704.1561694919978, 746.4656582756345, 612.8542366357725, 709.6590706207876, 897.8576780543538, 576.7320444682139, 367.86349399309097, 603.5268908635816, 1137.496963158202, 915.869999181292, 522.9335878435471, 697.1031339129927, 840.004778059082, 949.0588139375503, 892.1072260653409, 700.1768150568615, 673.8772441062026, 617.1574155534475, 582.2746184382742, 659.4550802192173, 1142.4909554255173, 960.9786332272009, 758.3291713237145, 1147.538656766894, 803.7586936114525, 709.5916827541207, 1044.9942577739907, 799.9526772053676, 838.8560390814645, 604.0451384362511, 946.9730367559338, 717.4839575418194, 873.5435614506611, 525.0167369204484, 891.9276142712536, 627.662839877478, 886.9778167778916, 1145.6430874507305, 797.7812875664082, 708.6466438802339, 602.8364218285774, 638.8440326052003, 779.0312558287912, 767.6108153924514, 748.6560178435087, 557.2405422088633, 850.0116813754574, 731.3226082606698, 655.8779866203365, 856.9951653293974, 1012.3596705657958, 951.092144840349], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [342.39999999999986, -88.58242015267409, 223.1746746224407, 236.15022464527294, 201.35172678000117, -41.74385532553166, 77.58671379786944, -40.67803043823067, 35.42316794473711, -31.552359820700993, 59.41525635959274, 27.442571680764267, -200.00217509576163, 88.63429723648743, 52.79892176736651, -24.726742245926307, -71.36891505191394, 228.97765775675924, -3.6396207607024857, -34.41298762695767, -22.039074035144203, -214.93891120740324, -309.02542354472286, -103.00233952707966, -68.77962316839405, -135.91565874173725, -65.9624218032378, 29.660949393354556, -277.2598652768891, -25.15516311094558, -25.1128938433247, 40.0000000000003, 28.270674747080093, 224.78665465778548, -85.29153118004052, -29.261793773050158, 105.11134975861196, -49.28965264284265, 187.7348493606679, -173.65439662132906, -289.70299737890406, 8.39040903016192, -318.64386815123174, 79.62642484076416, 38.1921427900812, 287.86676773212207, -32.237321125735164, 90.67369944129814, 259.1037299716479, -128.12591691158113, 98.61922317682925, 60.46667556278179, -184.27971545630018, -231.79405558778615, -124.77966305085977, -320.2924810628292, -38.327472098711866, -207.78699274248348, 126.67773731822176, -50.98838832279297, 14.513590458912898, -51.946468235282104, -222.93397748537868, 200.25097531006395, 52.75127028758163, 129.96661776179565, 171.1998570217233, 27.89303940248951, 254.91849845958546, -430.22864924110587, -28.976611748160533, -18.392751432458585, -13.390374951439433, -139.700299748392, 148.91682271336262, -164.42376248472402, 211.54943318190297, 151.02467664918282, 153.20362226190446, 336.99999999999994, 6.969922705373863, 45.8057781329065, 5.57418740131641, 198.44116365524977, 141.29626411680968, 256.3755567651423, 10.398782992096733, -243.34943079834656, -369.4652148263878, 12.315752755057957, 119.11804405505445, -69.41838726714067, -85.91274081693284, -35.94620768162878, -162.28397757973667, 128.46083235433616, 60.72786077334774, -76.83146111463276, 20.674968751589024, -31.2686054177408, 77.48742671491995, -143.19252873042987, 328.47898158724877, -15.621248972874753, 188.2078041214591, -99.11006367438829, -25.199450496496528, -108.45816687526347, -23.07758289453438, 105.88162199510603, -151.8784630707976, -130.2903664593952, 7.994331632665784, 246.8881284586812, -117.07309579988214, 49.50789522677806, -32.09590703056901, -23.996890937695873, -174.51351505843138, 14.156584016632529, -19.71189425809336, -103.10252216838205, -240.2901594570748, -199.34225781550234, -235.38503465505033, -218.7340130108897, 97.05449082039077, -22.279441977725014, -96.93352299954635, 163.65446866966036, -27.823379137498073, 97.7763169979541, 33.0929732310296, 121.77876536893422, 111.55244440988142, -63.65613473247555, 205.79536180297637, 19.259133299312026, -158.98746750407327, 47.22192461739362, 99.79018263132093, 97.95639586263891, 89.25914231468948, -62.039872809387916, 21.775808663797385, -162.20908421124986, 30.822445862303688, 120.51193474270346, 80.61756637171325, 334.30353031302616, 74.39899079096588, -81.55300860513066, 146.91824033837037, -335.2226385454351, -74.45482753407026, 236.5778429574253, -92.81278154178777, 271.87746253170644, -11.725926107695095, 79.48906528431934, 31.437319850495843, -42.40634636086273, -229.30741220724198, 18.62194894735493, -107.27933031277915, 51.38889605964588, -27.484992821076442, 118.89273105419004, 110.16772084651387, -20.53997610714471, 147.3009299013861, -163.99389108730495, 17.691171101099382, -108.3407583762351, 195.1630410858734, -0.5561498371610123, 30.29381615831993, -212.22649242891174, 12.6405366994235, -85.75619357565813, -119.94697418250196, -28.19912582453989, -157.02610816125136, 22.97774459392565, 1.5733020158342463, 293.02864637922437, 181.18680472623979, -266.5571058946396, -234.30867172324727, 88.24804672961886, 7.017406856258205, -132.35620454922446, 227.90658743386248, -128.1215260995968, -328.43900051839984, -155.20106838838677, -13.64725837541716, 199.55859683821313, -28.88418922514137, 110.95220217316208, -38.227365945228186, 127.95027254746697, -151.91440572147266, 18.403129002107242, -180.83464115471736, 138.197795167018, -110.51260297539821, -351.1639010536759, 40.0000000000003, -7.0185970863683025, -236.18762367436142, 52.49585251650992, -12.05072322603827, 92.48213436937851, 86.2577279045111, -52.39071753070598, 77.09618309587582, 142.1668967530668, 7.241160173195143, -6.422066400262395, 4.236152481578257, -42.23221733885376, -329.040293988464, -137.28282595102473, 136.01463748328717, 61.28459549145423, 55.591346077691256, -93.21891280275334, -28.576719747884162, -30.539647516252458, 158.27039656162728, 258.3503071655163, 42.57862986889798, 86.71925703133506, -31.01168251099722, 179.54289676411804, 154.1140456157782, 211.535809922172, -179.69134268215885, -114.9625931638889, 181.56405933015543, -282.88745159787356, -128.79662285283163, -189.1665060412969, -168.13580460024153, -178.18441058418694, 160.6000000000002, -243.73275341722825, -210.0752634206224, 136.39771185749174, 22.24363379379445, -130.85117905738323, 54.06222341594544, -151.17386605349554, 202.36972002477336, -14.15885680241312, -91.19506253093465, 88.90426607265168, 23.7051027549113, 71.10418637205942, 247.73750748398015, 229.17154002635087, 149.78520555907667, -68.31398073225624, -197.99342039459677, 51.262110541663134, -14.846979136037092, -71.64515660053286, 95.97527450113893, 10.359141146718684, -187.97138554027055, -329.6852806489489, 40.0000000000003, 23.283965853208034, 61.73608009505675, 68.44564932063327, -24.070130869136978, -90.97573944771004, -192.5772336257784, -45.52145378538445, -52.63636647198936, -25.925300750689093, 69.03094624859351, -334.60668665268287, 34.276802825035155, 88.56699324535288, -97.63044433004875, -79.6408564873527, -63.20270140286554, 87.57604937804804, 70.78531159904247, 169.93674391567143, 208.57564449377833, 99.80847576348272, -70.07860358151832, 166.27575776086863, -337.1391843939496, 113.18120263455432, 73.12474452006333, -18.113636795159405, -115.56727731274498, 79.10836674899501, -64.92793622478008, 61.95619806172681, 35.30389301237359, 30.43315107410947, -123.11420105402445, 205.9683479098463, 196.8259364708191, 206.36319607149176, -116.00964544878147, 67.63105061817265, 126.7316620583652, 61.75146654008234, 128.57970354463563, 24.75775935438715, -99.90040936873149, -231.8030055286926, -160.9460664860326, 65.29026464876658, 16.50998998230693, 194.37244037834165, -28.653450117776046, 107.42700526684052, 239.43901059217205, 144.30132772835012, 22.92465563779337, -82.99503797765692, 125.50000000000016, -51.78127736779779, 143.82969130110376, -220.61486632514388, 162.75225633640457, 90.78966856397211, 10.34697130907248, 46.30000000000029, -43.05677932865866, -80.16703658010326, -301.8746515592016, 7.9312990039149485, -67.50280957440886, 153.09031405064587, 89.09653631422101, 77.28687058771186, 94.78802615871992, 185.3607753181207, -128.44924826244986, -250.09954737437184, -14.093220154776532, 130.29746116673414, -88.87969545840103, 72.5190941586955, 267.34800045894224, -67.73679271789776, -221.70076486621906, 28.45580582064585, -181.03500900692507, -62.32594555405515, -78.75977055221725, 50.197406628606245, 262.9184313253187, 141.7628756834293, 167.8000000000001, -235.1493686041198, -101.84133007922952, 169.19541585398994, -142.5683224983943, -67.80515178407171, 124.41476927556826, -24.26323586190033, 90.23562721146673, 38.458751147107, 14.862344142751475, -3.761424676912569, 183.1045098708163, 188.2900502509226, 14.971746949409876, 189.05770465093468, -132.9736488350792, 320.66822995867176, 29.822893802891812, 81.04528780309084, 217.03569574176322, -128.34969960316184, 38.56480011935141, -239.18286241228594, 21.642199888999144, -128.14403640883887, 162.23423655309338, -66.20972338430535, -165.01414249405255, 44.434012784712124, -14.30603134383383, 20.748195422992637, -160.42507593202714, 212.33974929159842, -397.92512161043993, -39.79285152495843, -235.3507819947393, -241.69476801894484, 67.15411615801163, -129.49310407306575, 101.62678034496577, -17.926622342747123, 91.52529137319152, 129.9904858235675, -43.392684620114366, 96.03946093023379, 108.76171730911507, -39.637602458665654, -182.65263369751324, 40.0000000000003, 175.37525181519845, 83.57283300352456, 132.86655216878833, 76.9630402422317, -66.09558008174727, -407.082759334652, 39.557758660556786, -97.76670761574826, -207.96025709616046, 107.85595282463562, -364.12080404480844, -123.81621119033275, 135.7315861611191, 90.30922891403522, -43.674460895916624, 72.00245687989387, -29.877139769882604, 153.33557045092635, 4.9159067843859106, -164.75274876558046, -278.73417561508757, -47.924088225469745, -17.93023155534346, -13.762848723226607, 126.66024430113009, 128.09510385356052, 97.87771547688764, 80.4810196755322, -12.854180134983773, 138.7668414643705, 119.30485923831601, -99.05976041599212, 187.8910513971227, 35.882667592070156, 88.4402851687474, 62.25098585341282, 166.34426252711017, 27.872333770665335], "policy_predator_policy_reward": [42.218380577634676, 49.858368668863385, 4.405651009890592, 39.54921830506361, 192.6285883013717, 237.65309849180355, 163.1645271576392, 258.11689927994973, 70.94095274132589, 8.532589293979342, 206.82845900421475, 0.0, 166.38470966285823, 135.71328480312667, 49.93965082502891, 20.23511532854537, 174.98871307966786, 122.9732791800607, 98.1423083394736, 141.18404597763237, 377.8412385553202, 277.7119012856862, 361.3909131218403, 382.7038567086495, 0.0, 210.69763496432594, 15.075612039323298, 70.80401425143114, 317.2992884294181, 147.5743393690011, 8.912969924323775, 339.0790404807655, 94.87701532101303, 94.54385185218403, 62.8816433005429, 231.43177942748412, 164.0713799580137, 31.571884706527257, 214.52223100276126, 139.3328307664966, 262.56790669538395, 363.58284863203653, 245.70373605625258, 317.300739399652, 62.71776453133264, 91.35071347926399, 32.059963723443666, 29.643912015572635, 19.774528030407275, 153.49226556360966, 212.67878767439728, 65.80407948632153, 293.00631695858846, 248.2335490954173, 74.44649408850809, 328.3257229571866, 417.0672817705075, 100.20885654101784, 175.0211798444793, 48.65769396736681, 161.5425833079981, 90.091394348538, 157.86563761086884, 279.74094206472614, 31.387655255758272, 295.48497750663057, 219.25450518925356, 91.98095657361064, 28.75516633901441, 217.08227360391874, 164.9646948934952, 0.0, 200.19987852102142, 244.2480152367895, 22.648310290933324, 246.97803037167716, 113.63212599597769, 0.0, 0.0, 104.14793471141641, 44.76642626966994, 133.05790206795754, 54.17881661396047, 15.369599948448183, 273.7635854312681, 0.0, 13.479580692281152, 179.1657946429513, 471.0753863714589, 163.84831664838475, 56.0481020919389, 15.738617500598483, 114.02357378896697, 445.4258901667273, 109.28515442936659, 146.4796828999282, 54.46485082350388, 134.67053002056468, 66.39240415313688, 99.31323314245114, 292.2664489577552, 0.0, 0.0, 257.02062019625254, 114.48418249652808, 39.75128639433618, 137.2270503771172, 25.666895647604118, 58.64592125421853, 203.11927089148693, 565.381544920772, 261.1305484219228, 0.9488623650259026, 57.79715007322368, 91.19269001520703, 210.925202727456, 103.32769053332434, 226.19704178161763, 108.91400864934894, 1.678611215750487, 224.4151993185194, 32.41791712274495, 333.9561914486416, 411.23814251796756, 220.02181625179026, 6.29398590217026, 354.69754836449175, 374.94459494779426, 181.40543104406748, 94.57125549985746, 9.589828361624622, 82.04019881360331, 176.2191757931708, 95.26093625135874, 94.00038392806697, 238.60791925938133, 49.2481254283175, 50.04283245517292, 38.42140821286661, 160.66037580764916, 278.141424939047, 21.594925275662376, 179.58503696001281, 175.11682276518437, 48.58923478043769, 129.14875561188776, 199.56853948082235, 88.7586997671647, 58.72476999627628, 305.6184626807916, 102.71057053881506, 245.2508611026401, 18.638615678451057, 434.17251971853693, 117.95320303161057, 199.40432607043445, 12.005007933231884, 98.08167689243184, 110.17839250417677, 1.0256309117157039, 139.13640006074166, 199.64086926171686, 104.4814040495695, 244.5581867648341, 103.96337576515023, 161.6936497809011, 0.0, 26.635136031956687, 138.2239387723962, 60.597910366346916, 297.781027535276, 0.0, 0.0, 0.0, 238.6145887560594, 160.8741094016575, 107.59894781919091, 230.4215831428186, 158.43188657515526, 119.4546247772883, 83.68728772785742, 93.6674098492881, 73.22804553010737, 317.83496072141804, 147.03997377611296, 66.33340247476097, 418.8255140300006, 0.0, 263.4443471318919, 88.89132706441548, 384.9130006647417, 100.81915673603464, 148.78732363671432, 260.1046410786785, 163.52478425292406, 41.060001147934436, 164.21279005538798, 129.0538011369343, 68.95357570528016, 230.40720720766677, 171.29033930232953, 172.2625627337506, 261.22942678004745, 2.050395480745534, 230.64452361073756, 257.9738496310214, 134.22905139838227, 176.88254337574878, 285.94020333231555, 145.13072883173555, 91.56344089193705, 64.85873203571258, 223.9939526365162, 281.0558811338613, 253.3883034663255, 112.51921883512549, 147.90370872305104, 6.8964113526786495, 79.89063495679132, 61.83061450939289, 365.91256571544903, 102.11300522790171, 203.08529104018032, 6.39386871588364, 58.663310607155346, 88.61204215061474, 0.75765192923331, 268.35760244428457, 227.01109983000535, 54.24783300718487, 30.542551014424678, 295.2240214163951, 1.0381593898839114, 102.425051549514, 193.36027167159892, 164.3093500917919, 62.79970218990693, 118.34282281561967, 184.0175582921376, 135.8617493358007, 166.43600418379734, 123.21570212237252, 181.68736418646986, 279.2724825882252, 359.74436052476904, 110.82221490216887, 64.0753047499785, 472.7438403131854, 222.03919582890114, 162.41729368330002, 211.15069258173872, 36.857732944635615, 225.7305268670857, 233.47794591055376, 136.13734763143086, 389.4577729002104, 209.16916865434166, 80.73172861040993, 93.32172282287449, 98.01878508343752, 121.85402058924132, 85.25623590940863, 19.389291638268354, 115.6510321314428, 189.56979385441014, 92.46921561103107, 0.0, 164.18203224551124, 137.2576588635411, 235.1635178838243, 6.966940633228698, 424.20590708333833, 126.523919542481, 239.76446059009808, 269.0526364980093, 152.03586538758134, 182.19250786559525, 255.8533424244593, 311.77460828318266, 0.0, 132.70783798044684, 334.9822148238116, 195.5715982486473, 86.18576356899975, 142.68780861809242, 166.89718498442676, 95.42266875820197, 254.60275734420375, 65.83058126514605, 141.0328474640819, 1.0045452112201225, 288.14842790405544, 72.25514735802655, 262.2955946383076, 39.759668123448925, 21.910271162318676, 156.10912136990808, 254.6540606809594, 344.1223545955575, 186.85394169207527, 128.16236340567502, 159.38589301424463, 153.9999670621146, 152.9601375005584, 167.94756605554971, 23.56098964203098, 220.24854157994773, 0.0, 160.5518750430028, 226.7008200296773, 90.92714200741088, 130.86382077589144, 148.22499818382695, 165.05849533184784, 0.0, 213.03271873004485, 126.43627584019781, 211.5015637997054, 270.10957879113704, 291.1130029733321, 0.0, 345.97022106806077, 1.4475244731938657, 3.4401133198312017, 165.04140281101596, 267.10050628122974, 61.63754609369231, 77.10634125561565, 231.17566957921647, 4.982945974919769, 210.4076105180531, 143.06252143294594, 8.897548807719105, 179.9404672206832, 109.4441699166495, 339.51143635417606, 130.1284402462859, 288.0591640706904, 103.24108190363043, 113.97218432551234, 229.36648022198946, 116.17524023476413, 36.541205728680644, 82.91939908250346, 135.21177395110473, 101.68082153492335, 165.26149890289972, 230.58485396677298, 172.2200660148545, 124.72049642910653, 127.70013311892761, 163.92121838857153, 125.4869680893021, 279.08935809934485, 215.79604217939016, 18.04697248014327, 413.6417603985376, 71.12521287416509, 104.35310856647527, 161.31719526507007, 139.8247949010175, 160.52339292703033, 99.71527727766427, 120.33122628807821, 136.0423145520601, 2.7063190393399865, 88.49111558452121, 93.15119523467, 265.9417210040865, 118.39901402966143, 134.5719147039369, 100.64139710510823, 188.401587151364, 84.00593806538278, 56.45717205686485, 194.9657430319802, 226.14930011515378, 4.850632682545216, 136.03500337213436, 3.62832527405141, 156.67372390556466, 188.56405148961508, 36.83981930636334, 177.5847150009234, 0.0, 17.214056579265485, 193.47401461337628, 411.47976658464927, 125.70856555418736, 210.43042631208618, 296.51742752141604, 19.98932316032851, 2.611707571007339, 221.63689842937683, 336.6441067086559, 441.03487263737446, 403.7119863036254, 297.22417265660084, 169.78382562694352, 29.512949238137548, 198.04376265053523, 84.375953569106, 234.48179751820848, 73.43045592860362, 75.81282470197529, 105.65711167481169, 151.86700208868774, 1.6591269304814156, 74.667161266359, 181.99903644797587, 3.811564753307412, 45.51857543895747, 255.95423840386937, 133.60453386139045, 60.60510209597868, 193.6155378560773, 405.08258373926634, 90.28497142203459, 322.681697320842, 0.0, 126.66249251160743, 393.7549823289859, 104.91887585875513, 344.97946065728325, 332.0056033643674, 173.9815771844307, 151.59190320268928, 6.072815942248274, 35.42882857371347, 122.15182777851923, 96.88196046401795, 365.0968421310097, 404.0955633448042, 93.83221753044748, 200.39674052715014, 0.0, 242.60592327026836, 106.98362530630405, 0.0, 88.05438216893353, 208.49296836455923, 109.75307183126222, 64.61803994365228, 91.8383722494005, 203.60840662808508, 109.08709588927753, 49.523138901428, 41.225255225329285, 213.41136447399163, 157.05475543831707]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.803885115644196, "mean_inference_ms": 8.188085893627928, "mean_action_processing_ms": 4.814821629131799, "mean_env_wait_ms": 11.686034942564074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011809799406263564, "StateBufferConnector_ms": 0.020997259351942275, "ViewRequirementAgentConnector_ms": 0.23536708619859484}, "num_episodes": 37, "episode_return_max": 1243.154412757868, "episode_return_min": 286.81872951404534, "episode_return_mean": 751.5866119350724, "episodes_this_iter": 37}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 64.81015061689723, "num_env_steps_trained_throughput_per_sec": 64.81015061689723, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 62588.464, "restore_workers_time_ms": 0.014, "training_step_time_ms": 62588.407, "sample_time_ms": 4026.736, "learn_time_ms": 58542.018, "learn_throughput": 68.327, "synch_weights_time_ms": 13.779}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": true, "training_iteration": 10, "trial_id": "06beb368", "date": "2024-08-24_02-35-54", "timestamp": 1724447154, "time_this_iter_s": 61.77391600608826, "time_total_s": 626.311229467392, "pid": 55087, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.9502100839948125, "lr": 1.6571706137650876e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3f54670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 626.311229467392, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 29.55287356321839, "ram_util_percent": 82.7494252873563}}
