{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.836368833023525, "cur_kl_coeff": 0.2, "cur_lr": 9.822722087892735e-05, "total_loss": 3.8536952327517695, "policy_loss": -0.017604990659732443, "vf_loss": 3.869328229037566, "vf_explained_var": 0.18697284966264308, "kl": 0.009859933858863898, "entropy": 1.6017657026869982, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 1178.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.034273049292291, "cur_kl_coeff": 0.2, "cur_lr": 9.822722087892735e-05, "total_loss": 2.921246685343943, "policy_loss": -0.010077891228997372, "vf_loss": 2.9301211795989115, "vf_explained_var": 0.19830448791985805, "kl": 0.0060170029379988995, "entropy": 1.605430852885965, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 1178.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 56.67238325125064, "num_env_steps_trained_throughput_per_sec": 56.67238325125064, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 70581.125, "restore_workers_time_ms": 0.02, "training_step_time_ms": 70581.069, "sample_time_ms": 6361.938, "learn_time_ms": 64196.413, "learn_throughput": 62.309, "synch_weights_time_ms": 14.088}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 1, "trial_id": "a234f531", "date": "2024-08-24_02-40-07", "timestamp": 1724447407, "time_this_iter_s": 70.6251950263977, "time_total_s": 70.6251950263977, "pid": 64632, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.8724387481904051, "lr": 9.822722087892736e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2f44160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 70.6251950263977, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 36.905, "ram_util_percent": 83.454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.0624229536947425, "cur_kl_coeff": 0.2, "cur_lr": 9.822722087892735e-05, "total_loss": 2.859417743439887, "policy_loss": -0.02696610783244584, "vf_loss": 2.8834427378486422, "vf_explained_var": 0.5167080773416345, "kl": 0.014705590034920066, "entropy": 1.5737363958055046, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 3533.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4349107744840555, "cur_kl_coeff": 0.2, "cur_lr": 9.822722087892735e-05, "total_loss": 2.0811920008588496, "policy_loss": -0.01592275765299354, "vf_loss": 2.09566885000075, "vf_explained_var": 0.40561071705160123, "kl": 0.007229571578077055, "entropy": 1.5958280645358334, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 3533.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 57.81942197582099, "num_env_steps_trained_throughput_per_sec": 57.81942197582099, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 69881.02, "restore_workers_time_ms": 0.02, "training_step_time_ms": 69880.965, "sample_time_ms": 5855.835, "learn_time_ms": 63999.034, "learn_throughput": 62.501, "synch_weights_time_ms": 15.437}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 2, "trial_id": "a234f531", "date": "2024-08-24_02-41-19", "timestamp": 1724447479, "time_this_iter_s": 69.21237301826477, "time_total_s": 139.83756804466248, "pid": 64632, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.8724387481904051, "lr": 9.822722087892736e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2f440d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 139.83756804466248, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 33.620588235294115, "ram_util_percent": 83.32941176470585}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.584292750601556, "cur_kl_coeff": 0.2, "cur_lr": 9.822722087892735e-05, "total_loss": 2.547366229794334, "policy_loss": -0.026672651532013168, "vf_loss": 2.5711206066127543, "vf_explained_var": 0.5285645527191729, "kl": 0.014591343390346049, "entropy": 1.5462195972475024, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 5888.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.173997336917116, "cur_kl_coeff": 0.2, "cur_lr": 9.822722087892735e-05, "total_loss": 1.646043931526743, "policy_loss": -0.01723649002307128, "vf_loss": 1.6615713845013054, "vf_explained_var": 0.37903650973759384, "kl": 0.008545186222756317, "entropy": 1.5840252644443715, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 5888.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 60.98969429575608, "num_env_steps_trained_throughput_per_sec": 60.98969429575608, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 68448.966, "restore_workers_time_ms": 0.019, "training_step_time_ms": 68448.913, "sample_time_ms": 4961.14, "learn_time_ms": 63458.945, "learn_throughput": 63.033, "synch_weights_time_ms": 15.36}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 3, "trial_id": "a234f531", "date": "2024-08-24_02-42-25", "timestamp": 1724447545, "time_this_iter_s": 65.62052798271179, "time_total_s": 205.45809602737427, "pid": 64632, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.8724387481904051, "lr": 9.822722087892736e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2f44160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 205.45809602737427, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 29.4695652173913, "ram_util_percent": 83.19565217391305}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.648381313093149, "cur_kl_coeff": 0.2, "cur_lr": 9.822722087892735e-05, "total_loss": 2.466868832536564, "policy_loss": -0.026871509722685104, "vf_loss": 2.49084732714732, "vf_explained_var": 0.5809713965515169, "kl": 0.014465037224549334, "entropy": 1.519399143429572, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 8243.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.196623342482654, "cur_kl_coeff": 0.2, "cur_lr": 9.822722087892735e-05, "total_loss": 1.495844405016322, "policy_loss": -0.020171333282529486, "vf_loss": 1.5135322999296168, "vf_explained_var": 0.3983343651087168, "kl": 0.012417185163489225, "entropy": 1.5643780106951477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 8243.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 60.87715215987138, "num_env_steps_trained_throughput_per_sec": 60.87715215987138, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 67763.25, "restore_workers_time_ms": 0.018, "training_step_time_ms": 67763.199, "sample_time_ms": 4500.336, "learn_time_ms": 63236.1, "learn_throughput": 63.255, "synch_weights_time_ms": 15.345}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 4, "trial_id": "a234f531", "date": "2024-08-24_02-43-31", "timestamp": 1724447611, "time_this_iter_s": 65.76790189743042, "time_total_s": 271.2259979248047, "pid": 64632, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.8724387481904051, "lr": 9.822722087892736e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3579550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 271.2259979248047, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 29.504301075268817, "ram_util_percent": 83.18494623655914}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.812887033687276, "cur_kl_coeff": 0.2, "cur_lr": 9.822722087892735e-05, "total_loss": 2.779377876320209, "policy_loss": -0.021890588060432686, "vf_loss": 2.7984846358086655, "vf_explained_var": 0.4942804675446448, "kl": 0.013919148454541487, "entropy": 1.4868615907215514, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 10598.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.2802884012777085, "cur_kl_coeff": 0.2, "cur_lr": 9.822722087892735e-05, "total_loss": 1.5972419033890823, "policy_loss": -0.01701864800732306, "vf_loss": 1.6118734622963422, "vf_explained_var": 0.4857030879919696, "kl": 0.011935451292905427, "entropy": 1.5442129743073902, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 10598.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 61.100308316045506, "num_env_steps_trained_throughput_per_sec": 61.100308316045506, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 67303.825, "restore_workers_time_ms": 0.017, "training_step_time_ms": 67303.774, "sample_time_ms": 4198.575, "learn_time_ms": 63080.254, "learn_throughput": 63.411, "synch_weights_time_ms": 15.183}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "training_iteration": 5, "trial_id": "a234f531", "date": "2024-08-24_02-44-36", "timestamp": 1724447676, "time_this_iter_s": 65.50167775154114, "time_total_s": 336.7276756763458, "pid": 64632, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.8724387481904051, "lr": 9.822722087892736e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3f5b670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 336.7276756763458, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 28.90869565217391, "ram_util_percent": 83.10000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.41281166547423, "cur_kl_coeff": 0.2, "cur_lr": 9.822722087892735e-05, "total_loss": 2.9190270442618433, "policy_loss": -0.02256302867824263, "vf_loss": 2.938415391834931, "vf_explained_var": 0.47267686490546873, "kl": 0.015873441648928573, "entropy": 1.4540196678441042, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 12953.0, "diff_num_grad_updates_vs_sampler_policy": 1229.39875}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.505289200562074, "cur_kl_coeff": 0.2, "cur_lr": 9.822722087892735e-05, "total_loss": 1.6992362179067737, "policy_loss": -0.019828647304911587, "vf_loss": 1.7164312782814042, "vf_explained_var": 0.4060037513953612, "kl": 0.013167944609142064, "entropy": 1.5101006397522685, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 12953.0, "diff_num_grad_updates_vs_sampler_policy": 1229.39875}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 60.36526643479439, "num_env_steps_trained_throughput_per_sec": 60.36526643479439, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 67130.401, "restore_workers_time_ms": 0.017, "training_step_time_ms": 67130.35, "sample_time_ms": 4116.672, "learn_time_ms": 62990.077, "learn_throughput": 63.502, "synch_weights_time_ms": 14.94}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 6, "trial_id": "a234f531", "date": "2024-08-24_02-45-43", "timestamp": 1724447743, "time_this_iter_s": 66.27233719825745, "time_total_s": 403.00001287460327, "pid": 64632, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.8724387481904051, "lr": 9.822722087892736e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b355f550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 403.00001287460327, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 29.225531914893615, "ram_util_percent": 82.9712765957447}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.9705691921736275, "cur_kl_coeff": 0.2, "cur_lr": 9.822722087892735e-05, "total_loss": 2.9368814997359194, "policy_loss": -0.021920493242356554, "vf_loss": 2.955739985099517, "vf_explained_var": 0.43587329952073955, "kl": 0.015310032321871782, "entropy": 1.4185288430272647, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 15308.0, "diff_num_grad_updates_vs_sampler_policy": 1202.9050000000007}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.513501063982646, "cur_kl_coeff": 0.2, "cur_lr": 9.822722087892735e-05, "total_loss": 1.7653777405967632, "policy_loss": -0.01925854595296971, "vf_loss": 1.7818795821975497, "vf_explained_var": 0.41902664087380576, "kl": 0.013783521663532009, "entropy": 1.4870360828508997, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 15308.0, "diff_num_grad_updates_vs_sampler_policy": 1202.9050000000007}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 60.616746444508856, "num_env_steps_trained_throughput_per_sec": 60.616746444508856, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 66967.254, "restore_workers_time_ms": 0.018, "training_step_time_ms": 66967.202, "sample_time_ms": 3967.137, "learn_time_ms": 62975.256, "learn_throughput": 63.517, "synch_weights_time_ms": 16.723}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "training_iteration": 7, "trial_id": "a234f531", "date": "2024-08-24_02-46-49", "timestamp": 1724447809, "time_this_iter_s": 66.03107190132141, "time_total_s": 469.0310847759247, "pid": 64632, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.8724387481904051, "lr": 9.822722087892736e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b355f040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 469.0310847759247, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 31.422580645161293, "ram_util_percent": 83.05376344086021}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.499346270530847, "cur_kl_coeff": 0.2, "cur_lr": 9.822722087892735e-05, "total_loss": 2.481560782135925, "policy_loss": -0.019949016527860026, "vf_loss": 2.4987861047631363, "vf_explained_var": 0.4075473055464953, "kl": 0.013618509677849758, "entropy": 1.4189690069028527, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 17663.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.570629851377694, "cur_kl_coeff": 0.2, "cur_lr": 9.822722087892735e-05, "total_loss": 1.4116926501004812, "policy_loss": -0.01613359879771536, "vf_loss": 1.4253234333040354, "vf_explained_var": 0.43424111437645685, "kl": 0.012514087938231014, "entropy": 1.4808826615096657, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 17663.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 1042.9510222743138, "episode_reward_min": 425.82615416253356, "episode_reward_mean": 749.8876975324291, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 9200, "policy_reward_min": {"prey_policy": -211.1032821708757, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 339.2528224134104, "predator_policy": 300.68224384342034}, "policy_reward_mean": {"prey_policy": 52.35172043465396, "predator_policy": 97.62581907182992}, "custom_metrics": {}, "hist_stats": {"episode_reward": [892.065032476574, 529.858129000873, 441.7025779760922, 503.80056836753636, 425.82615416253356, 932.8335107720374, 560.8433858604956, 703.4894411453087, 726.941872118978, 904.7161433300315, 492.6542954748636, 827.3932733296688, 895.691347553589, 762.5310402201425, 793.8767512459074, 1042.9510222743138, 674.3045665078464, 882.4323465047984, 867.386034903578, 733.9993294058161, 877.613807277604, 987.3661485866086, 787.1402647506729], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [270.9318487938195, 68.25466647210885, 186.89649355555704, 150.9247974117988, -29.407349746477863, 25.128325253366835, 136.9292421654679, -56.685554837412234, 8.308025130964571, 12.058528507294971, 2.9977144873408714, -63.730370826608315, 9.575325611584175, 211.54732890267843, -211.1032821708757, -13.564598003672545, 46.640262348109204, -10.24980172120915, 38.748083932674376, 13.267751368590568, 68.66471602697645, 40.0000000000003, -161.99966737428142, 31.641297574670453, 11.690033061848982, 180.02031295124254, 6.947811887802079, 238.61608689112933, 9.03832402524659, -93.78146585070073, -70.37132769274369, 128.11029943345233, -17.935945091978844, -35.07163332792239, 40.64169695364912, 27.394766695491583, -20.41370904852374, 2.12989663384498, 33.346784414089115, -6.528409432522835, 1.1628036998865874, 14.961776004211991, 8.570424470886538, 104.39712568793996, 170.5126784131028, 222.9637825059058, 232.38607900552694, -34.26944531462119, -90.89215444203778, 88.0531125430542, 85.73135359705478, -88.71623609106611, 63.20620283291959, 70.77705563777702, -95.06575129871086, 37.4734590781125, 79.66613176818109, 65.90971539139922, 7.479825020817139, -80.84389974140343, -5.963197900540536, 261.2887250617023, -23.299769061214494, 30.171653968883465, 207.30415875076997, 155.1821406292786, 72.78798907063307, -46.64139379461707, -13.070515059877483, 195.32926268658946, -31.448159800615933, -92.72638986178723, 339.2528224134104, -17.02485581164371, -30.848792224063125, 149.4734477303304, 182.41195966570515, 217.53571226697815, 207.08623782669238, 20.092145775063276, 15.667943085554633, 8.506883445202105, 69.4395752464458, -4.34990826592872, 76.01800638573651, 16.111152201493567, 63.08234343392209, 36.35223303968198, 236.79285659433518, -31.668217204800094, 39.47271267391598, 3.464332622653346, 112.08049971090354, 164.33886854052824, 46.73398056814487, -43.579128690167856, 40.0000000000003, 128.71805342521625, 126.40421300924068, -54.33804056894968, 66.8084474023366, 226.0871401705671, 150.71489503322283, 69.9166261013631, 88.3333556395045, -105.5684205229357, -83.28646446458625, 217.91426207799609, 172.21934236206607, 210.3750690601493, 238.4599709995147, -100.26414978224913, -82.48955862522227, 114.62269972805497, -62.60825091418904], "policy_predator_policy_reward": [1.9240503153770154, 84.1353127063613, 154.08004354263224, 2.7805711646704565, 1.5445982607204702, 243.1672776329114, 20.652877892091922, 13.970620211119366, 46.38380903907478, 79.94497800598441, 264.08650733594186, 57.9099404644923, 1.8763699158330696, 3.5247656750507717, 165.01827858064223, 66.86041273043332, 64.77616701550724, 129.01911957052855, 106.59613286509173, 61.70703826147723, 92.78796711190566, 76.2087124207499, 123.55514803575254, 104.15502582038557, 39.12292148451542, 7.257399236427456, 299.91905731162745, 30.93487194194818, 184.99380087812207, 68.88731149918108, 173.03966609379736, 170.9879989841097, 40.39537629597457, 25.899621772146606, 105.147632439998, 67.42410721633652, 172.85615448615943, 106.0449722218552, 90.68598951052448, 230.54888844804964, 158.5431138608436, 211.2797632976928, 14.744466802543094, 42.76971988185622, 0.0, 42.91472773982261, 124.76877091603843, 196.00627692967942, 34.25448474206381, 88.53050870459208, 18.083730617789506, 179.6311248169133, 141.5289214826959, 12.767480546779312, 104.71041333270333, 114.00749763956594, 42.07545971849155, 300.68224384342034, 163.84338600727946, 97.09945460379056, 155.91353610645135, 115.47753648123923, 36.69805831210909, 6.720802083183431, 111.37984375099057, 14.115188739041027, 111.46724778335053, 81.63934397514402, 110.88038239597643, 80.84139379461746, 176.55775179600045, 180.95902599714972, 31.870961562664085, 94.2594295252192, 143.02495764955705, 0.0, 19.316667626475954, 36.77259730972565, 146.06543396378333, 64.19682010955871, 67.81884075853809, 198.46231089686316, 78.84807851254958, 48.43099595839048, 115.46184048448302, 34.539850758201055, 36.04971658404988, 174.94231385521348, 87.76143043116221, 228.46866681153054, 167.75179521333916, 132.20793357206642, 72.33384456136174, 16.357462817226853, 112.64460462343116, 149.62502325068982, 184.76885362750883, 129.9762237510734, 17.337578584922767, 55.086553016272426, 37.64774746778425, 49.72317086029161, 103.47046254828182, 82.7638823677261, 2.148079686510829, 42.30372087410566, 123.08216012955458, 91.19274215834767, 148.13435811632493, 170.99937879558203, 187.1357383770029, 86.10113664374119, 181.14667145954553, 124.75141037379979, 100.28459649066137]}, "sampler_perf": {"mean_raw_obs_processing_ms": 11.885548952867122, "mean_inference_ms": 8.101370347069597, "mean_action_processing_ms": 5.4789908666233025, "mean_env_wait_ms": 12.563678174373205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069514564845872965, "StateBufferConnector_ms": 0.010898838872494905, "ViewRequirementAgentConnector_ms": 0.24005692938099737}, "num_episodes": 23, "episode_return_max": 1042.9510222743138, "episode_return_min": 425.82615416253356, "episode_return_mean": 749.8876975324291, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 59.521683565588255, "num_env_steps_trained_throughput_per_sec": 59.521683565588255, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 66996.648, "restore_workers_time_ms": 0.018, "training_step_time_ms": 66996.596, "sample_time_ms": 3980.249, "learn_time_ms": 62990.643, "learn_throughput": 63.501, "synch_weights_time_ms": 16.831}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 8, "trial_id": "a234f531", "date": "2024-08-24_02-47-56", "timestamp": 1724447876, "time_this_iter_s": 67.24788093566895, "time_total_s": 536.2789657115936, "pid": 64632, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.8724387481904051, "lr": 9.822722087892736e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2f449d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 536.2789657115936, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 31.40210526315789, "ram_util_percent": 83.01684210526314}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.892870688134698, "cur_kl_coeff": 0.2, "cur_lr": 9.822722087892735e-05, "total_loss": 2.0077738378204866, "policy_loss": -0.015027451722075938, "vf_loss": 2.02066650831016, "vf_explained_var": 0.44825055859903873, "kl": 0.010673922949792884, "entropy": 1.4209435111651247, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 20018.0, "diff_num_grad_updates_vs_sampler_policy": 1202.9049999999986}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.777191461246231, "cur_kl_coeff": 0.2, "cur_lr": 9.822722087892735e-05, "total_loss": 1.2132291273200082, "policy_loss": -0.01670966956036802, "vf_loss": 1.2272901838245918, "vf_explained_var": 0.3749885580848483, "kl": 0.013243060832301395, "entropy": 1.4663255696590285, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 20018.0, "diff_num_grad_updates_vs_sampler_policy": 1202.9049999999986}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "env_runners": {"episode_reward_max": 1142.6209627455214, "episode_reward_min": 423.6134265292791, "episode_reward_mean": 716.7106800037981, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 24800, "policy_reward_min": {"prey_policy": -275.3517594664089, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 350.4918142076751, "predator_policy": 341.4949415447288}, "policy_reward_mean": {"prey_policy": 49.48685244133154, "predator_policy": 93.85528355942586}, "custom_metrics": {}, "hist_stats": {"episode_reward": [892.065032476574, 529.858129000873, 441.7025779760922, 503.80056836753636, 425.82615416253356, 932.8335107720374, 560.8433858604956, 703.4894411453087, 726.941872118978, 904.7161433300315, 492.6542954748636, 827.3932733296688, 895.691347553589, 762.5310402201425, 793.8767512459074, 1042.9510222743138, 674.3045665078464, 882.4323465047984, 867.386034903578, 733.9993294058161, 877.613807277604, 987.3661485866086, 787.1402647506729, 430.6320460161812, 520.6038526412565, 909.9854556731055, 815.8079459563371, 730.1072465195755, 933.2926112731665, 543.2859758185936, 744.8297201823743, 575.9192165775348, 690.0634077668522, 647.4614661339323, 1142.6209627455214, 503.9464865886257, 605.998219043494, 669.931660334027, 611.6029721226378, 676.427263016038, 656.664044389602, 640.8793997216271, 543.6021420944359, 730.0996962156753, 656.3250199787644, 653.476407393501, 930.7789195574891, 437.0457753648961, 849.9925509744726, 733.5804104143114, 767.3891214630452, 745.0537659941846, 627.4493810435179, 930.6668828658009, 833.2715634847661, 677.4662019287841, 686.2328819881209, 699.5833446419969, 712.1863842630707, 621.6885173749841, 423.6134265292791, 879.0827708980264], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [270.9318487938195, 68.25466647210885, 186.89649355555704, 150.9247974117988, -29.407349746477863, 25.128325253366835, 136.9292421654679, -56.685554837412234, 8.308025130964571, 12.058528507294971, 2.9977144873408714, -63.730370826608315, 9.575325611584175, 211.54732890267843, -211.1032821708757, -13.564598003672545, 46.640262348109204, -10.24980172120915, 38.748083932674376, 13.267751368590568, 68.66471602697645, 40.0000000000003, -161.99966737428142, 31.641297574670453, 11.690033061848982, 180.02031295124254, 6.947811887802079, 238.61608689112933, 9.03832402524659, -93.78146585070073, -70.37132769274369, 128.11029943345233, -17.935945091978844, -35.07163332792239, 40.64169695364912, 27.394766695491583, -20.41370904852374, 2.12989663384498, 33.346784414089115, -6.528409432522835, 1.1628036998865874, 14.961776004211991, 8.570424470886538, 104.39712568793996, 170.5126784131028, 222.9637825059058, 232.38607900552694, -34.26944531462119, -90.89215444203778, 88.0531125430542, 85.73135359705478, -88.71623609106611, 63.20620283291959, 70.77705563777702, -95.06575129871086, 37.4734590781125, 79.66613176818109, 65.90971539139922, 7.479825020817139, -80.84389974140343, -5.963197900540536, 261.2887250617023, -23.299769061214494, 30.171653968883465, 207.30415875076997, 155.1821406292786, 72.78798907063307, -46.64139379461707, -13.070515059877483, 195.32926268658946, -31.448159800615933, -92.72638986178723, 339.2528224134104, -17.02485581164371, -30.848792224063125, 149.4734477303304, 182.41195966570515, 217.53571226697815, 207.08623782669238, 20.092145775063276, 15.667943085554633, 8.506883445202105, 69.4395752464458, -4.34990826592872, 76.01800638573651, 16.111152201493567, 63.08234343392209, 36.35223303968198, 236.79285659433518, -31.668217204800094, 39.47271267391598, 3.464332622653346, 112.08049971090354, 164.33886854052824, 46.73398056814487, -43.579128690167856, 40.0000000000003, 128.71805342521625, 126.40421300924068, -54.33804056894968, 66.8084474023366, 226.0871401705671, 150.71489503322283, 69.9166261013631, 88.3333556395045, -105.5684205229357, -83.28646446458625, 217.91426207799609, 172.21934236206607, 210.3750690601493, 238.4599709995147, -100.26414978224913, -82.48955862522227, 114.62269972805497, -62.60825091418904, -140.54433387126224, -85.34240653293476, 15.43047904371042, 43.40861407742847, 29.45780975114701, -21.437345777269115, 6.792068129073677, 40.0000000000003, 90.41064761494742, 9.922957543921624, 224.64733290134205, 94.66341810191193, 57.4375725329723, -22.75010230193505, 200.61675252196216, 21.59509476687646, -44.69684826360597, -40.59255566292997, -62.667172065687524, 271.68707926215484, 17.202357334916353, -17.062095633004326, 94.92534675643643, 78.2175278757511, -38.04124839983593, 222.3501087661151, 57.39564891880324, 86.55742151799367, 78.38798943551626, 13.252309769316552, 19.63913310233597, 18.04214527879693, 184.25167527575869, 31.78400032811274, 17.096415074533265, 75.9209553635154, 68.77854448572789, 6.796949828920907, 121.89211254948265, 152.42718865507038, 74.23464269988727, 61.053663086557144, -78.05304588950976, -46.920977921676446, -58.40713919769064, 36.03340146997409, 35.368652926418854, 143.418524859511, 123.04714653013181, 35.20409233615629, 15.943778385104805, -8.072055204173973, -74.8760177754948, 91.57498601452507, 130.90000000000015, 61.11590858028932, 123.16284309742461, 319.3951026243269, 350.4918142076751, 21.78555004360497, -18.260250047424027, -94.39802623782462, -23.878829035406817, 61.67420973345417, -14.641574824131016, 97.16310853175062, -59.033154377070446, 116.91604665882656, 39.099158729658086, 113.63335704274864, -27.129706048403698, 125.40155370879201, 23.3451264563418, 81.03731001575457, -78.14336225852291, 43.95213344838912, -275.3517594664089, -134.05284738931607, 11.300071540673006, 111.53142938883055, 227.1620379453015, 39.66416839949006, 52.88028355716132, 24.666345960012624, -148.96737593375008, 30.99311290664446, -127.61318134625988, 262.2864181932472, -23.31896320349568, 241.19309356612717, 257.56795951053874, 53.071843001938916, -79.08644707023642, -41.38495626856578, -93.8234352599539, 40.0000000000003, -26.059907070781506, -7.263945218686118, 209.09905912506716, -106.49262642521639, 245.47333038042555, 19.678754717665193, -139.03429998885105, 60.197336465182424, 214.16905650652566, 140.9513960542132, 40.0000000000003, -16.517329938999204, 20.91478115818012, 84.35105413789198, -44.35960570784405, -20.99841218968623, 117.05749684025942, 88.38659424791146, 40.0000000000003, 231.67447459761402, 94.71400778157565, -14.199790928949064, 36.21122864880548, 175.90643346045803, -10.516428709700014, -74.98147589985366, 17.95096537906832, -21.07140620090936, -136.8727301580509, 151.59468854295233, 101.57290934171728, -131.77619227760817, 159.59874165818863, -28.44565498185517, 32.97164138847207, 205.88771964149615, 108.0041936719849, 109.22366246908358, -66.69919745598702, 18.964424048888603, 70.21446001577108, 53.56614981253527, -256.0146535634541, 167.1369242625421, 183.61044828113162, 12.409728574186829, 62.04422600304321, 80.98942018335859, 93.30030053223791, 26.995612840142826, 72.76043597233607, 228.33499210627375, 85.16835985828688, -101.33602843225711, 129.8417286959274, -33.75673896262358, 40.0000000000003, 199.78708964053908, 229.98848618824684, 58.70742100881207, -28.016790112286017, 289.03814410291676, -48.30602916882165, 87.44319433190797, -27.932498321922328, -43.5503750987588, 37.831713488682254, 78.36741531528372, 28.000122097364155, 77.46922909179855, -73.90526281601852, -72.26020866754811, 119.17182423993094, 74.80106934460878, 177.17859262330097, 18.351664842048393, 9.414544143414162, -134.34026295485185, 217.2629389056501, 142.43259405378635, 20.48034501844571, 76.73391015327906, -22.960698876729207, -127.26456251211718, 18.596792514110188, 183.99058606327324, 11.098707773479015, 179.26120842328822, 63.152727798935885, 63.80493066459821, -13.28697611780198, 48.77724857533582, 17.965587009817792, 27.42151964541809, 18.49757783401584, 87.77868671478696, -21.4857113440158, 122.24846663369192, 204.49181282954552], "policy_predator_policy_reward": [1.9240503153770154, 84.1353127063613, 154.08004354263224, 2.7805711646704565, 1.5445982607204702, 243.1672776329114, 20.652877892091922, 13.970620211119366, 46.38380903907478, 79.94497800598441, 264.08650733594186, 57.9099404644923, 1.8763699158330696, 3.5247656750507717, 165.01827858064223, 66.86041273043332, 64.77616701550724, 129.01911957052855, 106.59613286509173, 61.70703826147723, 92.78796711190566, 76.2087124207499, 123.55514803575254, 104.15502582038557, 39.12292148451542, 7.257399236427456, 299.91905731162745, 30.93487194194818, 184.99380087812207, 68.88731149918108, 173.03966609379736, 170.9879989841097, 40.39537629597457, 25.899621772146606, 105.147632439998, 67.42410721633652, 172.85615448615943, 106.0449722218552, 90.68598951052448, 230.54888844804964, 158.5431138608436, 211.2797632976928, 14.744466802543094, 42.76971988185622, 0.0, 42.91472773982261, 124.76877091603843, 196.00627692967942, 34.25448474206381, 88.53050870459208, 18.083730617789506, 179.6311248169133, 141.5289214826959, 12.767480546779312, 104.71041333270333, 114.00749763956594, 42.07545971849155, 300.68224384342034, 163.84338600727946, 97.09945460379056, 155.91353610645135, 115.47753648123923, 36.69805831210909, 6.720802083183431, 111.37984375099057, 14.115188739041027, 111.46724778335053, 81.63934397514402, 110.88038239597643, 80.84139379461746, 176.55775179600045, 180.95902599714972, 31.870961562664085, 94.2594295252192, 143.02495764955705, 0.0, 19.316667626475954, 36.77259730972565, 146.06543396378333, 64.19682010955871, 67.81884075853809, 198.46231089686316, 78.84807851254958, 48.43099595839048, 115.46184048448302, 34.539850758201055, 36.04971658404988, 174.94231385521348, 87.76143043116221, 228.46866681153054, 167.75179521333916, 132.20793357206642, 72.33384456136174, 16.357462817226853, 112.64460462343116, 149.62502325068982, 184.76885362750883, 129.9762237510734, 17.337578584922767, 55.086553016272426, 37.64774746778425, 49.72317086029161, 103.47046254828182, 82.7638823677261, 2.148079686510829, 42.30372087410566, 123.08216012955458, 91.19274215834767, 148.13435811632493, 170.99937879558203, 187.1357383770029, 86.10113664374119, 181.14667145954553, 124.75141037379979, 100.28459649066137, 90.25481570463548, 102.74819788910622, 165.7606012495004, 107.04746723176162, 102.41080147307838, 159.3789014691493, 162.51885995338543, 0.0, 46.762040561828115, 26.25572314620339, 26.634426157046992, 176.13005858402508, 57.48744359924425, 29.17629174460127, 65.94226183192981, 33.7035244336356, 177.60549802242497, 199.17229268747855, 134.63997449407472, 125.36105828190674, 160.15566709229955, 46.47366490706829, 86.63855315714804, 141.289406202455, 160.30806722632778, 113.66198139509812, 131.49291024240847, 33.23936971722043, 96.84738103634109, 100.10749047434359, 171.54919747842092, 4.499837132821931, 61.4184166157568, 24.85054066302707, 10.15461486901158, 174.85137048326285, 13.594665895883999, 77.03362941781145, 10.204351259973684, 43.32995224270896, 19.222093754153665, 196.6492046478994, 122.40513524253957, 22.166391019178846, 263.5692491361827, 39.5410528922744, 53.494275757871044, 179.85657871359, 39.025828485511326, 5.073853795408609, 135.68673538182205, 9.540837547295666, 102.40030325313163, 116.53191571303215, 127.83098281868082, 72.12640820423498, 70.65552010165075, 52.92594775266931, 59.238088092566045, 11.723780041081117, 78.26230135684021, 101.05535139222002, 87.01455124872365, 199.1700089245759, 127.94874407758527, 0.0, 63.817581370864694, 165.45807181237905, 61.236365953148265, 7.707683321165686, 98.72958641932419, 81.54837560962315, 88.86305143760141, 64.44056294164906, 211.839162051859, 341.4949415447288, 112.52654520462004, 265.47865991224614, 37.440123398768804, 97.28367454009374, 275.5349986547846, 62.1765496225051, 123.3127856507225, 14.450651286054123, 5.546817873745356, 87.96260089168216, 38.42259874883592, 47.49277488719062, 42.15402679267931, 57.091562952940954, 50.0193411206095, 158.0984091746038, 146.83200871460213, 98.84716775189861, 90.73750904617951, 111.93159469403557, 26.19073847923871, 79.27804109795112, 141.56078818228985, 75.35839923052293, 21.940357277346553, 8.491178551115405, 43.57537802223461, 212.84265064211218, 42.765953641908624, 46.42182041704609, 76.93742616783314, 82.04282178334522, 154.94765269718636, 26.275397502047824, 80.55404184079208, 0.8480161983080927, 62.74844745275538, 106.0439945103166, 223.1958342006764, 69.15496733681363, 13.560974454355748, 214.23569304934225, 106.72172482943569, 2.79920632803452, 77.73867121923014, 87.99220714392119, 212.78766751870083, 85.49122629650844, 198.527078775971, 38.264878449452766, 154.33456590587866, 115.44532117778257, 80.30138191286653, 209.1019112450836, 43.48442653010379, 0.0, 171.51174807779796, 47.66285589248302, 81.53336019885846, 188.59709503551224, 143.11576194391893, 108.42136198667048, 92.55042982114888, 180.83716809949806, 10.239409221912732, 130.2848558230079, 97.90122402907632, 10.329397670129898, 63.944755676077676, 52.98766212832736, 109.20086629791716, 145.08086510984322, 0.0, 8.256615162632938, 71.12216385373152, 86.81451967377157, 129.89346786760984, 6.756040078362286, 70.2201258302224, 165.9262426634048, 72.98493623909019, 95.12709015195989, 34.49484688966328, 105.87250737810876, 102.87396861053872, 67.07334857099526, 162.3877800608563, 272.4147272057342, 0.0, 155.5919967732817, 35.49880042706979, 97.93159367281658, 78.4339307661957, 193.4999091559715, 115.28065032631336, 17.815080652948733, 58.56347092753279, 113.30163561541478, 106.75502956020819, 107.26734082438045, 103.53776798525742, 139.46334467320892, 73.98510457191841, 198.5112383716314, 65.29750333465373, 47.901363688399385, 20.327035798674515, 27.58178455429697, 4.48080742585864, 62.798616644622946, 94.41456311530456, 44.775310252372364, 44.804808696650426, 32.1378180429575, 74.46444255587646, 129.4969856693457, 80.92020060013087, 135.34279280252733, 47.327516602116155]}, "sampler_perf": {"mean_raw_obs_processing_ms": 11.719957869199833, "mean_inference_ms": 7.998129551143193, "mean_action_processing_ms": 5.392083051043445, "mean_env_wait_ms": 12.554345660766053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007884540865498205, "StateBufferConnector_ms": 0.008371568495227445, "ViewRequirementAgentConnector_ms": 0.23887157440185547}, "num_episodes": 39, "episode_return_max": 1142.6209627455214, "episode_return_min": 423.6134265292791, "episode_return_mean": 716.7106800037981, "episodes_this_iter": 39}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 60.61728762479916, "num_env_steps_trained_throughput_per_sec": 60.61728762479916, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 66884.552, "restore_workers_time_ms": 0.018, "training_step_time_ms": 66884.5, "sample_time_ms": 3876.454, "learn_time_ms": 62983.225, "learn_throughput": 63.509, "synch_weights_time_ms": 16.446}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "training_iteration": 9, "trial_id": "a234f531", "date": "2024-08-24_02-49-02", "timestamp": 1724447942, "time_this_iter_s": 66.04395413398743, "time_total_s": 602.322919845581, "pid": 64632, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.8724387481904051, "lr": 9.822722087892736e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b35e0b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 602.322919845581, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 28.661290322580644, "ram_util_percent": 83.12365591397848}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.846765341019681, "cur_kl_coeff": 0.2, "cur_lr": 9.822722087892735e-05, "total_loss": 1.9367216439257255, "policy_loss": -0.014503045599104841, "vf_loss": 1.9490891694516386, "vf_explained_var": 0.4821791185694895, "kl": 0.01067760001211536, "entropy": 1.4113248315839504, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 22373.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5344049507898383, "cur_kl_coeff": 0.2, "cur_lr": 9.822722087892735e-05, "total_loss": 1.1297396257677907, "policy_loss": -0.01414958608560185, "vf_loss": 1.1414456565162432, "vf_explained_var": 0.3597346989971817, "kl": 0.012217767846487827, "entropy": 1.445557825580524, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 22373.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 1142.6209627455214, "episode_reward_min": 238.24025463898568, "episode_reward_mean": 711.7874626381429, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 36000, "policy_reward_min": {"prey_policy": -275.3517594664089, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 350.4918142076751, "predator_policy": 341.4949415447288}, "policy_reward_mean": {"prey_policy": 49.95675286420778, "predator_policy": 92.40073966341856}, "custom_metrics": {}, "hist_stats": {"episode_reward": [892.065032476574, 529.858129000873, 441.7025779760922, 503.80056836753636, 425.82615416253356, 932.8335107720374, 560.8433858604956, 703.4894411453087, 726.941872118978, 904.7161433300315, 492.6542954748636, 827.3932733296688, 895.691347553589, 762.5310402201425, 793.8767512459074, 1042.9510222743138, 674.3045665078464, 882.4323465047984, 867.386034903578, 733.9993294058161, 877.613807277604, 987.3661485866086, 787.1402647506729, 430.6320460161812, 520.6038526412565, 909.9854556731055, 815.8079459563371, 730.1072465195755, 933.2926112731665, 543.2859758185936, 744.8297201823743, 575.9192165775348, 690.0634077668522, 647.4614661339323, 1142.6209627455214, 503.9464865886257, 605.998219043494, 669.931660334027, 611.6029721226378, 676.427263016038, 656.664044389602, 640.8793997216271, 543.6021420944359, 730.0996962156753, 656.3250199787644, 653.476407393501, 930.7789195574891, 437.0457753648961, 849.9925509744726, 733.5804104143114, 767.3891214630452, 745.0537659941846, 627.4493810435179, 930.6668828658009, 833.2715634847661, 677.4662019287841, 686.2328819881209, 699.5833446419969, 712.1863842630707, 621.6885173749841, 423.6134265292791, 879.0827708980264, 815.2635995420745, 654.9076498147983, 463.60545979520435, 574.603807546781, 838.9708407750525, 814.0126501944918, 741.9751790359159, 842.6044651321138, 692.9218530526906, 636.4127480505693, 508.0502768693828, 586.6267260268672, 1115.155259413952, 337.31465367201093, 620.5056573611156, 238.24025463898568, 594.6772914943773, 783.1757767334052, 954.5613690981797, 815.9195433275711, 559.7285722444329, 945.2859062520771, 733.6161459561397, 629.699872071462, 636.8757339202798, 883.9551202841268, 811.3742428007187, 794.7688220926087], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [270.9318487938195, 68.25466647210885, 186.89649355555704, 150.9247974117988, -29.407349746477863, 25.128325253366835, 136.9292421654679, -56.685554837412234, 8.308025130964571, 12.058528507294971, 2.9977144873408714, -63.730370826608315, 9.575325611584175, 211.54732890267843, -211.1032821708757, -13.564598003672545, 46.640262348109204, -10.24980172120915, 38.748083932674376, 13.267751368590568, 68.66471602697645, 40.0000000000003, -161.99966737428142, 31.641297574670453, 11.690033061848982, 180.02031295124254, 6.947811887802079, 238.61608689112933, 9.03832402524659, -93.78146585070073, -70.37132769274369, 128.11029943345233, -17.935945091978844, -35.07163332792239, 40.64169695364912, 27.394766695491583, -20.41370904852374, 2.12989663384498, 33.346784414089115, -6.528409432522835, 1.1628036998865874, 14.961776004211991, 8.570424470886538, 104.39712568793996, 170.5126784131028, 222.9637825059058, 232.38607900552694, -34.26944531462119, -90.89215444203778, 88.0531125430542, 85.73135359705478, -88.71623609106611, 63.20620283291959, 70.77705563777702, -95.06575129871086, 37.4734590781125, 79.66613176818109, 65.90971539139922, 7.479825020817139, -80.84389974140343, -5.963197900540536, 261.2887250617023, -23.299769061214494, 30.171653968883465, 207.30415875076997, 155.1821406292786, 72.78798907063307, -46.64139379461707, -13.070515059877483, 195.32926268658946, -31.448159800615933, -92.72638986178723, 339.2528224134104, -17.02485581164371, -30.848792224063125, 149.4734477303304, 182.41195966570515, 217.53571226697815, 207.08623782669238, 20.092145775063276, 15.667943085554633, 8.506883445202105, 69.4395752464458, -4.34990826592872, 76.01800638573651, 16.111152201493567, 63.08234343392209, 36.35223303968198, 236.79285659433518, -31.668217204800094, 39.47271267391598, 3.464332622653346, 112.08049971090354, 164.33886854052824, 46.73398056814487, -43.579128690167856, 40.0000000000003, 128.71805342521625, 126.40421300924068, -54.33804056894968, 66.8084474023366, 226.0871401705671, 150.71489503322283, 69.9166261013631, 88.3333556395045, -105.5684205229357, -83.28646446458625, 217.91426207799609, 172.21934236206607, 210.3750690601493, 238.4599709995147, -100.26414978224913, -82.48955862522227, 114.62269972805497, -62.60825091418904, -140.54433387126224, -85.34240653293476, 15.43047904371042, 43.40861407742847, 29.45780975114701, -21.437345777269115, 6.792068129073677, 40.0000000000003, 90.41064761494742, 9.922957543921624, 224.64733290134205, 94.66341810191193, 57.4375725329723, -22.75010230193505, 200.61675252196216, 21.59509476687646, -44.69684826360597, -40.59255566292997, -62.667172065687524, 271.68707926215484, 17.202357334916353, -17.062095633004326, 94.92534675643643, 78.2175278757511, -38.04124839983593, 222.3501087661151, 57.39564891880324, 86.55742151799367, 78.38798943551626, 13.252309769316552, 19.63913310233597, 18.04214527879693, 184.25167527575869, 31.78400032811274, 17.096415074533265, 75.9209553635154, 68.77854448572789, 6.796949828920907, 121.89211254948265, 152.42718865507038, 74.23464269988727, 61.053663086557144, -78.05304588950976, -46.920977921676446, -58.40713919769064, 36.03340146997409, 35.368652926418854, 143.418524859511, 123.04714653013181, 35.20409233615629, 15.943778385104805, -8.072055204173973, -74.8760177754948, 91.57498601452507, 130.90000000000015, 61.11590858028932, 123.16284309742461, 319.3951026243269, 350.4918142076751, 21.78555004360497, -18.260250047424027, -94.39802623782462, -23.878829035406817, 61.67420973345417, -14.641574824131016, 97.16310853175062, -59.033154377070446, 116.91604665882656, 39.099158729658086, 113.63335704274864, -27.129706048403698, 125.40155370879201, 23.3451264563418, 81.03731001575457, -78.14336225852291, 43.95213344838912, -275.3517594664089, -134.05284738931607, 11.300071540673006, 111.53142938883055, 227.1620379453015, 39.66416839949006, 52.88028355716132, 24.666345960012624, -148.96737593375008, 30.99311290664446, -127.61318134625988, 262.2864181932472, -23.31896320349568, 241.19309356612717, 257.56795951053874, 53.071843001938916, -79.08644707023642, -41.38495626856578, -93.8234352599539, 40.0000000000003, -26.059907070781506, -7.263945218686118, 209.09905912506716, -106.49262642521639, 245.47333038042555, 19.678754717665193, -139.03429998885105, 60.197336465182424, 214.16905650652566, 140.9513960542132, 40.0000000000003, -16.517329938999204, 20.91478115818012, 84.35105413789198, -44.35960570784405, -20.99841218968623, 117.05749684025942, 88.38659424791146, 40.0000000000003, 231.67447459761402, 94.71400778157565, -14.199790928949064, 36.21122864880548, 175.90643346045803, -10.516428709700014, -74.98147589985366, 17.95096537906832, -21.07140620090936, -136.8727301580509, 151.59468854295233, 101.57290934171728, -131.77619227760817, 159.59874165818863, -28.44565498185517, 32.97164138847207, 205.88771964149615, 108.0041936719849, 109.22366246908358, -66.69919745598702, 18.964424048888603, 70.21446001577108, 53.56614981253527, -256.0146535634541, 167.1369242625421, 183.61044828113162, 12.409728574186829, 62.04422600304321, 80.98942018335859, 93.30030053223791, 26.995612840142826, 72.76043597233607, 228.33499210627375, 85.16835985828688, -101.33602843225711, 129.8417286959274, -33.75673896262358, 40.0000000000003, 199.78708964053908, 229.98848618824684, 58.70742100881207, -28.016790112286017, 289.03814410291676, -48.30602916882165, 87.44319433190797, -27.932498321922328, -43.5503750987588, 37.831713488682254, 78.36741531528372, 28.000122097364155, 77.46922909179855, -73.90526281601852, -72.26020866754811, 119.17182423993094, 74.80106934460878, 177.17859262330097, 18.351664842048393, 9.414544143414162, -134.34026295485185, 217.2629389056501, 142.43259405378635, 20.48034501844571, 76.73391015327906, -22.960698876729207, -127.26456251211718, 18.596792514110188, 183.99058606327324, 11.098707773479015, 179.26120842328822, 63.152727798935885, 63.80493066459821, -13.28697611780198, 48.77724857533582, 17.965587009817792, 27.42151964541809, 18.49757783401584, 87.77868671478696, -21.4857113440158, 122.24846663369192, 204.49181282954552, 112.67572141007147, 247.22170853079302, -257.2543360272085, 166.60599662948258, 36.86673173848093, -41.17139283744112, -107.79974946395556, 44.21078885072639, 122.38073921716112, -64.27733670060546, -87.30497462106973, -34.54202194570656, -79.03685371671436, 87.29200785697222, -20.822053667221617, 6.188676777386238, -35.61445125637884, 14.120025739296604, 26.6699304319007, 15.898545796322754, 156.65268542860406, 119.91375489048787, 70.05408215021203, 66.51286408321657, 6.1274737861365, -79.3782760101984, 187.65137337272952, 67.90000000000022, 77.9481568959199, 109.24099601263921, 92.59020823498885, 53.959112816765256, 160.77907285834272, 71.48042455080072, -6.22254837664833, 208.64253116128182, 94.48582026728734, -108.27991627448567, 181.40824714157262, 113.37545418512295, -25.40047125784762, 89.80237619648548, 10.951382631507968, -58.31785011387028, 18.298033021931193, -1.0394093187474875, 121.97532673984132, 40.0000000000003, -37.277226586894656, 151.9591215156559, -77.29505879358507, 119.31598179193325, 44.18884711829846, 45.77847365519402, -2.5114228914138716, 75.33665583077446, -43.592169708832884, 31.89771531810278, -27.377770338833585, 89.716335051719, 116.18202855071263, 270.8325464261578, -2.976814082735125, 160.9554333820121, 175.91023413668518, -177.6724520346546, 32.50100417329293, -31.59735115002175, 11.98628466937857, 15.921997482078439, 97.58478375055786, -103.64954669738366, 134.58073150064106, 62.33266922391483, 38.79752054192207, -4.503342014839417, -6.666600034917419, 6.581356084162495, -103.393847199225, -137.1604766172496, 40.0000000000003, 4.960662068683943, 57.17626536723905, 68.35002559172624, 17.55112409417881, 5.501982830741394, 162.88791818460024, 86.0450947885778, 94.04615412914131, -120.53007939991167, 29.872946590294493, 147.85895332368906, 208.13043652023916, 71.65044816812102, 93.92096875631084, 64.28625491429806, 94.24618986158573, 107.3607337353222, -0.09016120301246316, 19.205691069119222, 45.4000000000004, 12.847372531190047, 7.044062388686484, 172.0333040112746, -122.93790285756731, 120.06965483759092, 267.89490433705174, 147.80238259845328, 158.61910570502474, 42.26180778925502, 23.708992509405352, 253.56424791224939, 118.81089030085751, 86.19651517005491, -53.72194291560674, 203.71226438176316, 51.34892597966402, -40.93324308186727, -19.987542359697056, -10.676852428061412, -44.02610983445322, -120.80822634670044, 117.81374263955995, 53.78128603877547, 16.54715220856086, 47.67104020258068, 177.25189308337997, 184.84998766490384, 14.285210510041573, 63.37710635584504, 264.7339343977188, 200.31364229735925, -19.732164476171558, 47.48840256087829, 26.748466015109898, 157.21713041533715, -10.669462121945026, 222.69330577341128, -56.919400517744855, 161.4047891446356], "policy_predator_policy_reward": [1.9240503153770154, 84.1353127063613, 154.08004354263224, 2.7805711646704565, 1.5445982607204702, 243.1672776329114, 20.652877892091922, 13.970620211119366, 46.38380903907478, 79.94497800598441, 264.08650733594186, 57.9099404644923, 1.8763699158330696, 3.5247656750507717, 165.01827858064223, 66.86041273043332, 64.77616701550724, 129.01911957052855, 106.59613286509173, 61.70703826147723, 92.78796711190566, 76.2087124207499, 123.55514803575254, 104.15502582038557, 39.12292148451542, 7.257399236427456, 299.91905731162745, 30.93487194194818, 184.99380087812207, 68.88731149918108, 173.03966609379736, 170.9879989841097, 40.39537629597457, 25.899621772146606, 105.147632439998, 67.42410721633652, 172.85615448615943, 106.0449722218552, 90.68598951052448, 230.54888844804964, 158.5431138608436, 211.2797632976928, 14.744466802543094, 42.76971988185622, 0.0, 42.91472773982261, 124.76877091603843, 196.00627692967942, 34.25448474206381, 88.53050870459208, 18.083730617789506, 179.6311248169133, 141.5289214826959, 12.767480546779312, 104.71041333270333, 114.00749763956594, 42.07545971849155, 300.68224384342034, 163.84338600727946, 97.09945460379056, 155.91353610645135, 115.47753648123923, 36.69805831210909, 6.720802083183431, 111.37984375099057, 14.115188739041027, 111.46724778335053, 81.63934397514402, 110.88038239597643, 80.84139379461746, 176.55775179600045, 180.95902599714972, 31.870961562664085, 94.2594295252192, 143.02495764955705, 0.0, 19.316667626475954, 36.77259730972565, 146.06543396378333, 64.19682010955871, 67.81884075853809, 198.46231089686316, 78.84807851254958, 48.43099595839048, 115.46184048448302, 34.539850758201055, 36.04971658404988, 174.94231385521348, 87.76143043116221, 228.46866681153054, 167.75179521333916, 132.20793357206642, 72.33384456136174, 16.357462817226853, 112.64460462343116, 149.62502325068982, 184.76885362750883, 129.9762237510734, 17.337578584922767, 55.086553016272426, 37.64774746778425, 49.72317086029161, 103.47046254828182, 82.7638823677261, 2.148079686510829, 42.30372087410566, 123.08216012955458, 91.19274215834767, 148.13435811632493, 170.99937879558203, 187.1357383770029, 86.10113664374119, 181.14667145954553, 124.75141037379979, 100.28459649066137, 90.25481570463548, 102.74819788910622, 165.7606012495004, 107.04746723176162, 102.41080147307838, 159.3789014691493, 162.51885995338543, 0.0, 46.762040561828115, 26.25572314620339, 26.634426157046992, 176.13005858402508, 57.48744359924425, 29.17629174460127, 65.94226183192981, 33.7035244336356, 177.60549802242497, 199.17229268747855, 134.63997449407472, 125.36105828190674, 160.15566709229955, 46.47366490706829, 86.63855315714804, 141.289406202455, 160.30806722632778, 113.66198139509812, 131.49291024240847, 33.23936971722043, 96.84738103634109, 100.10749047434359, 171.54919747842092, 4.499837132821931, 61.4184166157568, 24.85054066302707, 10.15461486901158, 174.85137048326285, 13.594665895883999, 77.03362941781145, 10.204351259973684, 43.32995224270896, 19.222093754153665, 196.6492046478994, 122.40513524253957, 22.166391019178846, 263.5692491361827, 39.5410528922744, 53.494275757871044, 179.85657871359, 39.025828485511326, 5.073853795408609, 135.68673538182205, 9.540837547295666, 102.40030325313163, 116.53191571303215, 127.83098281868082, 72.12640820423498, 70.65552010165075, 52.92594775266931, 59.238088092566045, 11.723780041081117, 78.26230135684021, 101.05535139222002, 87.01455124872365, 199.1700089245759, 127.94874407758527, 0.0, 63.817581370864694, 165.45807181237905, 61.236365953148265, 7.707683321165686, 98.72958641932419, 81.54837560962315, 88.86305143760141, 64.44056294164906, 211.839162051859, 341.4949415447288, 112.52654520462004, 265.47865991224614, 37.440123398768804, 97.28367454009374, 275.5349986547846, 62.1765496225051, 123.3127856507225, 14.450651286054123, 5.546817873745356, 87.96260089168216, 38.42259874883592, 47.49277488719062, 42.15402679267931, 57.091562952940954, 50.0193411206095, 158.0984091746038, 146.83200871460213, 98.84716775189861, 90.73750904617951, 111.93159469403557, 26.19073847923871, 79.27804109795112, 141.56078818228985, 75.35839923052293, 21.940357277346553, 8.491178551115405, 43.57537802223461, 212.84265064211218, 42.765953641908624, 46.42182041704609, 76.93742616783314, 82.04282178334522, 154.94765269718636, 26.275397502047824, 80.55404184079208, 0.8480161983080927, 62.74844745275538, 106.0439945103166, 223.1958342006764, 69.15496733681363, 13.560974454355748, 214.23569304934225, 106.72172482943569, 2.79920632803452, 77.73867121923014, 87.99220714392119, 212.78766751870083, 85.49122629650844, 198.527078775971, 38.264878449452766, 154.33456590587866, 115.44532117778257, 80.30138191286653, 209.1019112450836, 43.48442653010379, 0.0, 171.51174807779796, 47.66285589248302, 81.53336019885846, 188.59709503551224, 143.11576194391893, 108.42136198667048, 92.55042982114888, 180.83716809949806, 10.239409221912732, 130.2848558230079, 97.90122402907632, 10.329397670129898, 63.944755676077676, 52.98766212832736, 109.20086629791716, 145.08086510984322, 0.0, 8.256615162632938, 71.12216385373152, 86.81451967377157, 129.89346786760984, 6.756040078362286, 70.2201258302224, 165.9262426634048, 72.98493623909019, 95.12709015195989, 34.49484688966328, 105.87250737810876, 102.87396861053872, 67.07334857099526, 162.3877800608563, 272.4147272057342, 0.0, 155.5919967732817, 35.49880042706979, 97.93159367281658, 78.4339307661957, 193.4999091559715, 115.28065032631336, 17.815080652948733, 58.56347092753279, 113.30163561541478, 106.75502956020819, 107.26734082438045, 103.53776798525742, 139.46334467320892, 73.98510457191841, 198.5112383716314, 65.29750333465373, 47.901363688399385, 20.327035798674515, 27.58178455429697, 4.48080742585864, 62.798616644622946, 94.41456311530456, 44.775310252372364, 44.804808696650426, 32.1378180429575, 74.46444255587646, 129.4969856693457, 80.92020060013087, 135.34279280252733, 47.327516602116155, 8.692623101257931, 118.11569173897597, 219.03857664647302, 103.53367122954843, 59.767214544187965, 188.50453973997656, 110.01369114464627, 43.7499345933084, 70.34227836517111, 288.9541569057981, 168.93730216329607, 174.7784897096234, 118.74854881760245, 115.64919728228823, 19.90581791611831, 54.6041727782197, 46.05843663813655, 256.606219258473, 55.908169009200556, 134.1640823742075, 34.58312517678042, 140.33261421531932, 95.81129810990144, 106.8916879598247, 42.091254974557806, 69.96964116638306, 75.31724712817639, 131.36008746204325, 67.14648870944573, 106.85693545733336, 93.32142478374531, 93.64896885699864, 65.23365624107723, 42.24608287053692, 74.93877619929636, 37.176853772375395, 84.01813478124848, 156.6502269535975, 12.676594680866042, 62.45051846323114, 102.97108916666045, 108.31229504160807, 177.8333285447818, 27.96182630796192, 240.50984351346307, 43.357472990724645, 89.64126531105026, 90.49803946207734, 77.86027053880565, 59.43788739804585, 63.08453242862588, 69.64137837453602, 188.56642197908639, 29.093378338840367, 28.18774486784984, 114.13925103373761, 219.04355784540368, 102.22391616406048, 19.779331522536562, 5.459903308183889, 72.30617251302209, 186.87647227914027, 16.37383195169867, 12.902114018190161, 105.79324023908599, 26.63528487963452, 174.71377698294887, 184.84063538469445, 0.0, 99.98547328465395, 19.2140830696341, 60.07252309195224, 55.05323669736824, 139.43752112876723, 117.08213505372231, 71.1229993568877, 66.55213964203128, 234.75051686662187, 67.69688550799815, 43.26062304751959, 56.86579741911195, 47.289035467999874, 33.194095811252964, 111.90478082630369, 157.38550484786978, 140.93164062809288, 212.6769799667306, 149.07213302148898, 15.128616995768128, 37.415335588155315, 103.76563433420212, 33.743080692609816, 98.587599624048, 6.960448170423874, 160.07085291823321, 66.16436035642826, 67.68501974036086, 90.44725242205365, 138.35529258130578, 168.25890985009838, 105.61112125056144, 31.51260177914025, 49.62593583647248, 75.04533582453321, 183.54674148013038, 67.7260655884215, 6.599563203210614, 7.5961886177683136, 30.921793352680048, 95.7944402226126, 12.009456045343143, 89.92294294341536, 126.8108484636732, 65.51866043273091, 10.795535093994824, 20.420492635737197, 149.69871839981258, 2.8433158842549, 83.06278240560061, 190.21101025424036, 56.55526456192414, 137.8421447172633, 206.22000102324606, 176.43225825846758, 36.51822065362385, 0.0, 139.48510402317757, 75.99609573258172, 17.7415192136904, 163.2971634979135, 22.2559712906332, 22.1845825844147, 47.118696542242965, 123.33427751286679, 76.92843407565763, 29.8168806043005, 88.32063458598726, 87.50143689682353, 17.12902850882796, 98.27447880295989]}, "sampler_perf": {"mean_raw_obs_processing_ms": 11.681220832481497, "mean_inference_ms": 7.998301656161747, "mean_action_processing_ms": 5.478400445643596, "mean_env_wait_ms": 12.570801966688483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007826089859008789, "StateBufferConnector_ms": 0.008360147476196289, "ViewRequirementAgentConnector_ms": 0.26172955830891925}, "num_episodes": 28, "episode_return_max": 1142.6209627455214, "episode_return_min": 238.24025463898568, "episode_return_mean": 711.7874626381429, "episodes_this_iter": 28}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 60.95253618413967, "num_env_steps_trained_throughput_per_sec": 60.95253618413967, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 66758.581, "restore_workers_time_ms": 0.018, "training_step_time_ms": 66758.53, "sample_time_ms": 3894.155, "learn_time_ms": 62840.2, "learn_throughput": 63.654, "synch_weights_time_ms": 16.279}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": true, "training_iteration": 10, "trial_id": "a234f531", "date": "2024-08-24_02-50-08", "timestamp": 1724448008, "time_this_iter_s": 65.66395974159241, "time_total_s": 667.9868795871735, "pid": 64632, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.8724387481904051, "lr": 9.822722087892736e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b355f040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 667.9868795871735, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 28.03978494623656, "ram_util_percent": 82.5258064516129}}
