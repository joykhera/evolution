{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.732326853743531, "cur_kl_coeff": 0.2, "cur_lr": 8.992829286398065e-05, "total_loss": 2.9208017363416667, "policy_loss": -0.014961615354495, "vf_loss": 2.9340741628294538, "vf_explained_var": 0.24513284775355312, "kl": 0.008445948852234047, "entropy": 1.603008799188456, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 1178.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.683485155247326, "cur_kl_coeff": 0.2, "cur_lr": 8.992829286398065e-05, "total_loss": 2.1623584900185815, "policy_loss": -0.008201694542704242, "vf_loss": 2.1694219891179647, "vf_explained_var": 0.2975186074868382, "kl": 0.005690996510208032, "entropy": 1.606221996042126, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 1178.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 61.679819147995794, "num_env_steps_trained_throughput_per_sec": 61.679819147995794, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 64851.046, "restore_workers_time_ms": 0.021, "training_step_time_ms": 64850.98, "sample_time_ms": 6140.26, "learn_time_ms": 58689.202, "learn_throughput": 68.156, "synch_weights_time_ms": 11.545}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 1, "trial_id": "cdf48921", "date": "2024-08-24_00-44-08", "timestamp": 1724440448, "time_this_iter_s": 64.89493107795715, "time_total_s": 64.89493107795715, "pid": 83485, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.8055362763609899, "lr": 8.992829286398068e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x173847820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 64.89493107795715, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 41.32795698924732, "ram_util_percent": 83.3741935483871}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.815614627779416, "cur_kl_coeff": 0.2, "cur_lr": 8.992829286398065e-05, "total_loss": 2.1583172864721587, "policy_loss": -0.03165873662012999, "vf_loss": 2.1867978689776866, "vf_explained_var": 0.5307421454451899, "kl": 0.015890774392792777, "entropy": 1.5759930815666345, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 3533.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.586116367515232, "cur_kl_coeff": 0.2, "cur_lr": 8.992829286398065e-05, "total_loss": 1.5548079169733002, "policy_loss": -0.013172842378010322, "vf_loss": 1.5667243513838247, "vf_explained_var": 0.43086663469387465, "kl": 0.006282030601072226, "entropy": 1.5986778470867504, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 3533.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 63.080204595905805, "num_env_steps_trained_throughput_per_sec": 63.080204595905805, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 64131.196, "restore_workers_time_ms": 0.018, "training_step_time_ms": 64131.136, "sample_time_ms": 5286.574, "learn_time_ms": 58820.708, "learn_throughput": 68.003, "synch_weights_time_ms": 13.438}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 2, "trial_id": "cdf48921", "date": "2024-08-24_00-45-14", "timestamp": 1724440514, "time_this_iter_s": 63.45187497138977, "time_total_s": 128.34680604934692, "pid": 83485, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.8055362763609899, "lr": 8.992829286398068e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b32c3700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 128.34680604934692, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 41.598924731182805, "ram_util_percent": 83.24301075268818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.743870093108742, "cur_kl_coeff": 0.2, "cur_lr": 8.992829286398065e-05, "total_loss": 1.986973023414612, "policy_loss": -0.03571156247592118, "vf_loss": 2.0189053170493705, "vf_explained_var": 0.5746807813897508, "kl": 0.018896333542167982, "entropy": 1.5435318861797358, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 5888.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.562488006963345, "cur_kl_coeff": 0.2, "cur_lr": 8.992829286398065e-05, "total_loss": 1.2122898949432779, "policy_loss": -0.021699273711042737, "vf_loss": 1.2320635028705476, "vf_explained_var": 0.47615859427522955, "kl": 0.00962833195952936, "entropy": 1.5851161118525607, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 5888.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 64.82029231292076, "num_env_steps_trained_throughput_per_sec": 64.82029231292076, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 63323.824, "restore_workers_time_ms": 0.016, "training_step_time_ms": 63323.77, "sample_time_ms": 4700.301, "learn_time_ms": 58600.298, "learn_throughput": 68.259, "synch_weights_time_ms": 14.306}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 3, "trial_id": "cdf48921", "date": "2024-08-24_00-46-16", "timestamp": 1724440576, "time_this_iter_s": 61.74929594993591, "time_total_s": 190.09610199928284, "pid": 83485, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.8055362763609899, "lr": 8.992829286398068e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2f3e940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 190.09610199928284, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 38.95057471264367, "ram_util_percent": 83.28620689655173}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.192942615223538, "cur_kl_coeff": 0.2, "cur_lr": 8.992829286398065e-05, "total_loss": 1.920137350802209, "policy_loss": -0.03355250494265949, "vf_loss": 1.9499955004187906, "vf_explained_var": 0.5911028625858817, "kl": 0.01847179722804141, "entropy": 1.513598822990547, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 8243.0, "diff_num_grad_updates_vs_sampler_policy": 1202.9049999999995}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7238254073319164, "cur_kl_coeff": 0.2, "cur_lr": 8.992829286398065e-05, "total_loss": 1.0896694757123409, "policy_loss": -0.02034537656748798, "vf_loss": 1.107896243551481, "vf_explained_var": 0.49430957708642237, "kl": 0.01059302862628804, "entropy": 1.5687575256242368, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 8243.0, "diff_num_grad_updates_vs_sampler_policy": 1202.9049999999995}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 65.48740425308145, "num_env_steps_trained_throughput_per_sec": 65.48740425308145, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 62762.983, "restore_workers_time_ms": 0.015, "training_step_time_ms": 62762.93, "sample_time_ms": 4256.929, "learn_time_ms": 58484.038, "learn_throughput": 68.395, "synch_weights_time_ms": 14.093}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 4, "trial_id": "cdf48921", "date": "2024-08-24_00-47-17", "timestamp": 1724440637, "time_this_iter_s": 61.11939978599548, "time_total_s": 251.21550178527832, "pid": 83485, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.8055362763609899, "lr": 8.992829286398068e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3025f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 251.21550178527832, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 38.42790697674419, "ram_util_percent": 83.25348837209303}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.877238568783818, "cur_kl_coeff": 0.2, "cur_lr": 8.992829286398065e-05, "total_loss": 2.0376764060079164, "policy_loss": -0.028423675748118202, "vf_loss": 2.062716119456443, "vf_explained_var": 0.5734554545641452, "kl": 0.01691979527505087, "entropy": 1.4726330493918902, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 10598.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9751215611293818, "cur_kl_coeff": 0.2, "cur_lr": 8.992829286398065e-05, "total_loss": 1.0598664955728372, "policy_loss": -0.02171244270953245, "vf_loss": 1.0791420918741044, "vf_explained_var": 0.5165460301559189, "kl": 0.01218422425835692, "entropy": 1.5403467155059685, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 10598.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 65.0070677081876, "num_env_steps_trained_throughput_per_sec": 65.0070677081876, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 62516.742, "restore_workers_time_ms": 0.015, "training_step_time_ms": 62516.691, "sample_time_ms": 4032.9, "learn_time_ms": 58462.485, "learn_throughput": 68.42, "synch_weights_time_ms": 14.214}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "training_iteration": 5, "trial_id": "cdf48921", "date": "2024-08-24_00-48-19", "timestamp": 1724440699, "time_this_iter_s": 61.59347987174988, "time_total_s": 312.8089816570282, "pid": 83485, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.8055362763609899, "lr": 8.992829286398068e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2ee0430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 312.8089816570282, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 38.48045977011495, "ram_util_percent": 83.23563218390805}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.493359430631001, "cur_kl_coeff": 0.2, "cur_lr": 8.992829286398065e-05, "total_loss": 1.9596838308494309, "policy_loss": -0.026575864948166213, "vf_loss": 1.9828259195744864, "vf_explained_var": 0.5731437402419477, "kl": 0.017168875512886483, "entropy": 1.4436898243655065, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 12953.0, "diff_num_grad_updates_vs_sampler_policy": 1255.3037499999991}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.342802021230102, "cur_kl_coeff": 0.2, "cur_lr": 8.992829286398065e-05, "total_loss": 1.0330189229070255, "policy_loss": -0.017475001321761472, "vf_loss": 1.0480984642500584, "vf_explained_var": 0.4957109724640087, "kl": 0.011977305164908686, "entropy": 1.5209792953641046, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 12953.0, "diff_num_grad_updates_vs_sampler_policy": 1255.3037499999991}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 64.3909644056037, "num_env_steps_trained_throughput_per_sec": 64.3909644056037, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 62450.706, "restore_workers_time_ms": 0.014, "training_step_time_ms": 62450.656, "sample_time_ms": 4016.516, "learn_time_ms": 58413.324, "learn_throughput": 68.478, "synch_weights_time_ms": 14.244}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 6, "trial_id": "cdf48921", "date": "2024-08-24_00-49-21", "timestamp": 1724440761, "time_this_iter_s": 62.17428994178772, "time_total_s": 374.9832715988159, "pid": 83485, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.8055362763609899, "lr": 8.992829286398068e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2fd7a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 374.9832715988159, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 37.289655172413795, "ram_util_percent": 82.70919540229886}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.856491319996536, "cur_kl_coeff": 0.2, "cur_lr": 8.992829286398065e-05, "total_loss": 1.9635703879331423, "policy_loss": -0.02297091977176456, "vf_loss": 1.9834107201190512, "vf_explained_var": 0.54614579500413, "kl": 0.015652928365327244, "entropy": 1.4043378611785338, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 15308.0, "diff_num_grad_updates_vs_sampler_policy": 1202.9050000000007}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.640303797428269, "cur_kl_coeff": 0.2, "cur_lr": 8.992829286398065e-05, "total_loss": 1.1279757558666723, "policy_loss": -0.021662884680139032, "vf_loss": 1.146641803787519, "vf_explained_var": 0.46573873588740194, "kl": 0.014984183163123083, "entropy": 1.4855182672508709, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 15308.0, "diff_num_grad_updates_vs_sampler_policy": 1202.9050000000007}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 66.20893206781886, "num_env_steps_trained_throughput_per_sec": 66.20893206781886, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 62159.867, "restore_workers_time_ms": 0.014, "training_step_time_ms": 62159.816, "sample_time_ms": 3845.435, "learn_time_ms": 58293.792, "learn_throughput": 68.618, "synch_weights_time_ms": 14.338}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "training_iteration": 7, "trial_id": "cdf48921", "date": "2024-08-24_00-50-22", "timestamp": 1724440822, "time_this_iter_s": 60.4567608833313, "time_total_s": 435.4400324821472, "pid": 83485, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.8055362763609899, "lr": 8.992829286398068e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2fd73a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 435.4400324821472, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 35.5593023255814, "ram_util_percent": 82.87209302325581}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.622972878022812, "cur_kl_coeff": 0.2, "cur_lr": 8.992829286398065e-05, "total_loss": 1.701316446736613, "policy_loss": -0.0216760598269396, "vf_loss": 1.7200364584629197, "vf_explained_var": 0.5148195653964001, "kl": 0.014780231631477611, "entropy": 1.3822784077589678, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 17663.0, "diff_num_grad_updates_vs_sampler_policy": 1254.7150000000001}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.223670612019339, "cur_kl_coeff": 0.2, "cur_lr": 8.992829286398065e-05, "total_loss": 0.9653903544834971, "policy_loss": -0.013612405825880872, "vf_loss": 0.9763401259282593, "vf_explained_var": 0.457147693963061, "kl": 0.013313169279897036, "entropy": 1.4741707118453493, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 17663.0, "diff_num_grad_updates_vs_sampler_policy": 1254.7150000000001}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 1224.6381887887783, "episode_reward_min": 301.3521024725593, "episode_reward_mean": 819.8912128927971, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 9200, "policy_reward_min": {"prey_policy": -219.90482325896454, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 316.28278904243984, "predator_policy": 396.39595512992065}, "policy_reward_mean": {"prey_policy": 69.06058870940667, "predator_policy": 94.9176538691513}, "custom_metrics": {}, "hist_stats": {"episode_reward": [834.5754755076587, 871.2064965390464, 492.96888930925445, 559.9020923814921, 744.1720459209216, 799.661709932248, 440.17504769283397, 1093.319538717055, 759.510761153469, 301.3521024725593, 802.4854554525476, 841.2888620246266, 859.9494366009293, 980.0094191859835, 1009.6109021492437, 868.6308365444768, 785.5111393611677, 780.1181683780399, 1110.4933296815755, 853.8991816746159, 1224.6381887887783, 671.7371668495382, 1172.281650216267], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [25.24571689696757, -183.8820192907295, 15.198737865559231, 174.26083075904955, 40.04060779571648, -28.69657998370437, 101.61733947580821, 111.85725568107136, 163.80125405522097, -32.306526012359484, -57.62563652210089, 50.51666232106114, -78.31574737463393, 50.80000000000048, 30.416492728717635, 67.3187209446461, 73.68745527203428, -95.56616794692555, 192.22231471709117, -41.17712713663011, 50.17538136959517, 152.37694982852412, 112.44109681135298, -68.9987191016399, -44.00098933170675, -194.479875985306, 181.14864399587617, 99.20210774749579, 216.318564995285, -133.0709572804843, 63.39043088104656, 40.0000000000003, 65.47594360586078, 42.68945493383493, 55.30000000000048, 152.04657587530068, 45.59884162220402, 305.92223680460916, -26.13682027163184, 107.25670037946155, 134.233565065663, -20.85275292492351, 58.24791468343218, 67.75935679992277, 65.12934987482866, -163.1569539241177, 20.13896441414883, -103.46524971758615, -27.962758942814503, -219.90482325896454, 31.84946553239057, 32.229706333522955, 172.27880828351607, -188.08910557634297, 197.68186826516342, -21.304169887994615, 122.54809533575386, 20.41283635786612, 219.1726424834489, 12.637878608687727, 184.5922650214826, 8.85363831416145, 207.47358835305317, 83.0594043718252, 209.93373636319723, 46.920201594474904, 70.10790723692052, 265.8299510683445, 23.535667477233787, -34.101379404241655, -57.518928886538774, 24.963205337607317, 137.29808167365195, 111.44745024974284, 228.63540434585138, 189.21233427625126, -3.3273279969736667, 170.35766887358423, 125.36140673948513, 13.957847727956272, 151.37608988332764, 22.109347641175702, 65.81102338947473, 20.727144468058995, 195.70668886545783, -34.00445540827759, 5.164194523870233, 214.822084881626, -86.4562270293109, 39.81244636789324, 182.37537576599144, 169.8104689488965, 82.00394018404705, 203.5391233279494, 284.3362667759627, 93.76100725751756, -0.1488605568037536, 256.775365762929, 141.40637680863728, 3.179900626018044, 154.53323707343915, 189.3937670765877, 219.23024801912536, -126.85250230906536, 316.28278904243984, 73.01851519194118, 164.5867562735881, -78.29501287715354, 1.2349804886985736, -150.60675022779208, 241.06225988280315, 280.9838421121814, 97.36382908427113, 225.72830573550533, 103.95022286254658], "policy_predator_policy_reward": [184.82024305259156, 52.810417619816164, 244.03478410958363, 251.54278537547341, 30.50337132361833, 108.29527021946521, 27.11768543319307, 203.70779146561756, 206.52122876216197, 9.291777442562045, 105.23372294312819, 121.49268929172092, 66.79814718094804, 134.79875808484655, 68.85380065556537, 47.93608776355836, 87.93166835033554, 63.38987104559399, 37.25465041349716, 126.90461895828567, 86.0463826737806, 27.016204099359772, 70.89644524918292, 34.812974860153524, 323.4063194623171, 16.95419087879154, 21.89107926423759, 188.6894575519593, 6.612543634467053, 396.39595512992065, 0.0, 164.4568724051972, 0.0, 8.862345866874973, 0.0, 216.5531621637654, 137.47910041590887, 44.16382222111729, 64.3716799674504, 46.06423953887522, 62.504737296512836, 104.1164446915781, 125.85524731077875, 38.23517150782083, 124.28172684784106, 270.43891720263196, 221.0249856719836, 108.9437670314749, 74.58612500134777, 120.70912899444582, 261.9714286775216, 1.04751028420521, 122.47673671963882, 0.0, 171.0390369329229, 94.4341528768776, 31.34604876275516, 202.09688500168812, 98.45962748762715, 61.48486499790968, 41.26545741563533, 36.70971951103919, 14.232885832929297, 20.566523079817348, 53.26221833777927, 273.7205380820017, 196.24178921283257, 18.16088628482091, 6.7158019595677, 112.87805567401948, 134.49727373033443, 177.58428022636693, 93.23430285241284, 146.4179442039907, 13.051888415819352, 47.38252289546028, 27.552484092070447, 231.8741093345151, 9.212742782704241, 57.04704781941286, 47.41223719635994, 30.955038536228532, 81.08846023587836, 17.279867594476624, 153.04524155071422, 289.55611676639074, 91.95581832882984, 36.163714300108545, 93.90020167241948, 129.20427397448026, 0.0, 44.68853098030884, 79.40657951964127, 64.33304417878475, 0.0, 1.9071802503183468, 147.63218104523156, 8.258630840134805, 127.94229814965486, 73.18510149096659, 23.21242998905787, 140.3126606184826, 96.56392556791245, 122.04157303348234, 89.92006067732466, 173.08295771836382, 93.66094488459325, 43.46410120423537, 57.30355218940814, 294.2871220036363, 78.66702657218184, 3.871347344295147, 0.0, 78.78207699450844, 61.87273962797625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 11.595300796360759, "mean_inference_ms": 7.948714035554601, "mean_action_processing_ms": 4.605604637073118, "mean_env_wait_ms": 12.202941234491307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01595331274944803, "StateBufferConnector_ms": 0.008457639942998472, "ViewRequirementAgentConnector_ms": 0.20491973213527515}, "num_episodes": 23, "episode_return_max": 1224.6381887887783, "episode_return_min": 301.3521024725593, "episode_return_mean": 819.8912128927971, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 65.44169417295926, "num_env_steps_trained_throughput_per_sec": 65.44169417295926, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 62030.274, "restore_workers_time_ms": 0.014, "training_step_time_ms": 62030.224, "sample_time_ms": 3748.401, "learn_time_ms": 58261.238, "learn_throughput": 68.656, "synch_weights_time_ms": 14.298}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 8, "trial_id": "cdf48921", "date": "2024-08-24_00-51-23", "timestamp": 1724440883, "time_this_iter_s": 61.18087410926819, "time_total_s": 496.6209065914154, "pid": 83485, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.8055362763609899, "lr": 8.992829286398068e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2f3e3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 496.6209065914154, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 36.65581395348837, "ram_util_percent": 83.17209302325581}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.554023902077078, "cur_kl_coeff": 0.2, "cur_lr": 8.992829286398065e-05, "total_loss": 1.324026359886627, "policy_loss": -0.016842485978337294, "vf_loss": 1.3385721726275805, "vf_explained_var": 0.5215206108781689, "kl": 0.01148337430840718, "entropy": 1.386564754326126, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 20018.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7013457956334337, "cur_kl_coeff": 0.2, "cur_lr": 8.992829286398065e-05, "total_loss": 0.8712049019564488, "policy_loss": -0.01497949707557125, "vf_loss": 0.8835854200927062, "vf_explained_var": 0.40406318849818723, "kl": 0.01299489879181842, "entropy": 1.4598724744375597, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 20018.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "env_runners": {"episode_reward_max": 1224.6381887887783, "episode_reward_min": 301.3521024725593, "episode_reward_mean": 745.8686449452041, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 24000, "policy_reward_min": {"prey_policy": -219.90482325896454, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 316.28278904243984, "predator_policy": 396.39595512992065}, "policy_reward_mean": {"prey_policy": 56.275284931151305, "predator_policy": 92.89844405788753}, "custom_metrics": {}, "hist_stats": {"episode_reward": [834.5754755076587, 871.2064965390464, 492.96888930925445, 559.9020923814921, 744.1720459209216, 799.661709932248, 440.17504769283397, 1093.319538717055, 759.510761153469, 301.3521024725593, 802.4854554525476, 841.2888620246266, 859.9494366009293, 980.0094191859835, 1009.6109021492437, 868.6308365444768, 785.5111393611677, 780.1181683780399, 1110.4933296815755, 853.8991816746159, 1224.6381887887783, 671.7371668495382, 1172.281650216267, 729.4201338560179, 749.0959851751842, 651.9180751385527, 984.8175148476199, 714.4559444431616, 546.8520050455093, 568.8473728052788, 592.5524672832256, 409.43875362948796, 890.664547953977, 489.6443648170173, 338.512620472764, 795.9339418502622, 1046.9529388731712, 499.96919062393835, 626.3030894029438, 871.8044703484659, 664.1524931943209, 686.0738275877474, 719.899727669255, 586.7295176662766, 736.8088937372871, 741.7396605652717, 830.2186818622057, 690.4425714318181, 728.6387744794183, 470.0051347948291, 909.3266495636876, 712.7701646265394, 879.4193453178412, 850.103850500533, 817.2757706357751, 441.8798319353093, 906.4217759066883, 892.4425227412953, 738.2056845831919, 384.88250481205904], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [25.24571689696757, -183.8820192907295, 15.198737865559231, 174.26083075904955, 40.04060779571648, -28.69657998370437, 101.61733947580821, 111.85725568107136, 163.80125405522097, -32.306526012359484, -57.62563652210089, 50.51666232106114, -78.31574737463393, 50.80000000000048, 30.416492728717635, 67.3187209446461, 73.68745527203428, -95.56616794692555, 192.22231471709117, -41.17712713663011, 50.17538136959517, 152.37694982852412, 112.44109681135298, -68.9987191016399, -44.00098933170675, -194.479875985306, 181.14864399587617, 99.20210774749579, 216.318564995285, -133.0709572804843, 63.39043088104656, 40.0000000000003, 65.47594360586078, 42.68945493383493, 55.30000000000048, 152.04657587530068, 45.59884162220402, 305.92223680460916, -26.13682027163184, 107.25670037946155, 134.233565065663, -20.85275292492351, 58.24791468343218, 67.75935679992277, 65.12934987482866, -163.1569539241177, 20.13896441414883, -103.46524971758615, -27.962758942814503, -219.90482325896454, 31.84946553239057, 32.229706333522955, 172.27880828351607, -188.08910557634297, 197.68186826516342, -21.304169887994615, 122.54809533575386, 20.41283635786612, 219.1726424834489, 12.637878608687727, 184.5922650214826, 8.85363831416145, 207.47358835305317, 83.0594043718252, 209.93373636319723, 46.920201594474904, 70.10790723692052, 265.8299510683445, 23.535667477233787, -34.101379404241655, -57.518928886538774, 24.963205337607317, 137.29808167365195, 111.44745024974284, 228.63540434585138, 189.21233427625126, -3.3273279969736667, 170.35766887358423, 125.36140673948513, 13.957847727956272, 151.37608988332764, 22.109347641175702, 65.81102338947473, 20.727144468058995, 195.70668886545783, -34.00445540827759, 5.164194523870233, 214.822084881626, -86.4562270293109, 39.81244636789324, 182.37537576599144, 169.8104689488965, 82.00394018404705, 203.5391233279494, 284.3362667759627, 93.76100725751756, -0.1488605568037536, 256.775365762929, 141.40637680863728, 3.179900626018044, 154.53323707343915, 189.3937670765877, 219.23024801912536, -126.85250230906536, 316.28278904243984, 73.01851519194118, 164.5867562735881, -78.29501287715354, 1.2349804886985736, -150.60675022779208, 241.06225988280315, 280.9838421121814, 97.36382908427113, 225.72830573550533, 103.95022286254658, 172.24040730455977, -17.256698942416172, 137.1905338621597, 0.942587505102854, 65.16121114425157, 84.37968925245966, 52.32993921350644, -52.692875019220715, 160.55259009845267, 42.46508447794332, 159.7637373077234, 137.75493850909925, 80.45172551554279, 13.08318001542563, 72.94340588114531, 189.77233545840522, 39.21324009223071, 104.37635776374267, 193.89460103942585, -2.485304210326415, 40.0000000000003, -50.240118917734335, 77.68973341539234, 93.79335413624665, 159.35121211149837, 167.76012234072837, 39.10906004425348, -19.90258067932445, 51.335766313906696, 37.51445796895292, 89.29037348030552, -87.98640354152286, -3.886296398341652, 181.4875727614338, -30.382807993013863, -10.922953572336988, -118.25221710402946, 57.765234092347875, 73.61830524698239, -56.661493809885116, -96.65661770538524, 0.4129228096838613, 10.258585001952259, 21.769652550029512, -52.65691950478099, 106.4146266802468, 153.02626342466107, 85.34708967499184, 83.68612644218571, 51.100243392601534, 11.14001727067841, 45.15457225777384, -4.896414083593569, -37.75291954729208, 126.5347054852624, 36.7897883447317, 40.0000000000003, 13.224200373017283, -5.424687814031145, -71.10853356312775, 49.00494087964071, -35.51874968144184, 36.942561935060965, 264.34943169059727, 194.98404155558495, 172.86407093045952, -8.999519539671809, 154.18112602383744, 100.84458841348066, 94.00052338124577, 20.457819916123512, -70.12071566824083, 39.71983263317017, 67.22485605092349, 120.93966207955323, 32.952929933538286, -16.44455659572978, 175.57120159862436, 40.0000000000003, 66.74786339706459, 119.73115439467259, 62.72819514450405, 240.97004234195774, 164.22484164190251, -100.11049678112161, 200.35849209466326, 43.475336391020576, 73.74648750874383, -177.89464146473668, 54.987955915913936, 39.24014463932149, 79.09431505827772, 33.21890190769456, -164.78030252310603, -148.0476752857532, 136.40828120595552, -78.983963975714, 133.83523412459664, 18.603974910188033, 158.12970924215875, 63.39796402808987, -76.23514113466531, 58.84801930008522, 34.241210134014224, -79.63024086168623, -68.27420907197703, 123.44770110456204, 84.79247588230012, 107.7148540643097, 37.56040454402226, 74.5942245031816, 40.0000000000003, 264.0593848790551, 126.1060900583022, -114.90273272809698, -61.41377173561066, 122.93463867652736, 169.39461432905102, 40.0000000000003, -81.53568246510996, -5.743767124131281, -47.65662639192903, 99.97038880395611, -46.56405863203758, 157.58969755641576, 88.12803184300341, 172.08039105635783, 40.0000000000003, 83.1163749575941, -0.808403313698028, 40.0000000000003, 58.70660668661148, -103.91283399245711, 124.6119571009477, 14.212827251094238, 21.843881937697986, 161.3144769910959, 29.86959259686367, 73.36866678318113, -45.4749958983421, 47.20844472207696, -17.663292744222826, 9.976041834865928, 70.28554848559037, 23.26178036545158, 159.27884750575126, -36.78290176314733, 128.85920957126268, -24.020328068499513, -144.66694865508643, 27.45453160320719, 187.71466844412018, 0.9819679351278077, 43.13849369401169, 50.76489902794959, 31.818938528787577, 90.08016710209036, 132.7754774817039, 225.53964667507896, 150.98841861540816, -53.90811004234005, 31.56719803556549, -84.43105801863436, 33.128178718909375, -12.801108411773146, 0.342170798914299, 229.47880214485696, 36.364955130225816, 163.57759328280912, 68.80797904686936, 111.84607923186735, 226.4190533852914, -29.68133905465217, 192.0861003591095, 40.0000000000003, -52.830053195243124, 77.84677512259748, 25.828568925991085, 135.43388200674997, -46.91205599522527, -6.384319525541487, -106.14038324263916, 15.149843670552677, -98.99316171963878, -121.48503805074402], "policy_predator_policy_reward": [184.82024305259156, 52.810417619816164, 244.03478410958363, 251.54278537547341, 30.50337132361833, 108.29527021946521, 27.11768543319307, 203.70779146561756, 206.52122876216197, 9.291777442562045, 105.23372294312819, 121.49268929172092, 66.79814718094804, 134.79875808484655, 68.85380065556537, 47.93608776355836, 87.93166835033554, 63.38987104559399, 37.25465041349716, 126.90461895828567, 86.0463826737806, 27.016204099359772, 70.89644524918292, 34.812974860153524, 323.4063194623171, 16.95419087879154, 21.89107926423759, 188.6894575519593, 6.612543634467053, 396.39595512992065, 0.0, 164.4568724051972, 0.0, 8.862345866874973, 0.0, 216.5531621637654, 137.47910041590887, 44.16382222111729, 64.3716799674504, 46.06423953887522, 62.504737296512836, 104.1164446915781, 125.85524731077875, 38.23517150782083, 124.28172684784106, 270.43891720263196, 221.0249856719836, 108.9437670314749, 74.58612500134777, 120.70912899444582, 261.9714286775216, 1.04751028420521, 122.47673671963882, 0.0, 171.0390369329229, 94.4341528768776, 31.34604876275516, 202.09688500168812, 98.45962748762715, 61.48486499790968, 41.26545741563533, 36.70971951103919, 14.232885832929297, 20.566523079817348, 53.26221833777927, 273.7205380820017, 196.24178921283257, 18.16088628482091, 6.7158019595677, 112.87805567401948, 134.49727373033443, 177.58428022636693, 93.23430285241284, 146.4179442039907, 13.051888415819352, 47.38252289546028, 27.552484092070447, 231.8741093345151, 9.212742782704241, 57.04704781941286, 47.41223719635994, 30.955038536228532, 81.08846023587836, 17.279867594476624, 153.04524155071422, 289.55611676639074, 91.95581832882984, 36.163714300108545, 93.90020167241948, 129.20427397448026, 0.0, 44.68853098030884, 79.40657951964127, 64.33304417878475, 0.0, 1.9071802503183468, 147.63218104523156, 8.258630840134805, 127.94229814965486, 73.18510149096659, 23.21242998905787, 140.3126606184826, 96.56392556791245, 122.04157303348234, 89.92006067732466, 173.08295771836382, 93.66094488459325, 43.46410120423537, 57.30355218940814, 294.2871220036363, 78.66702657218184, 3.871347344295147, 0.0, 78.78207699450844, 61.87273962797625, 67.2990588884575, 67.68791325106821, 34.223199336329266, 74.24637386095098, 127.68554764554106, 7.9236916308531935, 210.71235780971196, 25.673166197850147, 25.96725490659634, 191.78508660702607, 34.435827812184094, 3.277601981559795, 13.86494470751585, 75.21308035718624, 61.12963305115486, 113.13139081592655, 39.49331101756658, 52.3997514918638, 227.4894699755742, 27.532361403205478, 31.43932697085434, 121.8116447943948, 123.40472678424818, 71.59904805704483, 45.60701709120564, 95.03229053164044, 0.0, 20.937918544782292, 155.06496998054732, 0.0, 159.58379615428734, 49.27702482754031, 40.641804048505996, 168.73241586352466, 2.0898936025439028, 49.98376322740522, 227.3984501670044, 49.25587562192885, 203.9368960091544, 116.43060740464115, 54.361820365740144, 93.65275699351552, 192.09533004362748, 50.614593349709615, 135.5866297253883, 67.2863441507267, 67.63933555234516, 177.16322507287506, 28.758364038761165, 70.24292952457455, 120.37742258881813, 93.97860343137661, 12.508003930821669, 21.99003694141282, 100.61033654174786, 76.8924505506028, 131.89637889446286, 68.74528917754874, 31.88816363241911, 15.6095708771296, 0.0, 54.34516859826117, 118.38529217014192, 18.027701113883776, 95.41355358852215, 368.3165365503419, 24.371136500808653, 33.505510172739726, 26.470848697235024, 81.39811774269285, 67.77373194109263, 28.711010641336696, 72.90159113347843, 28.36581218698333, 123.99558970950417, 39.13361568862773, 13.354866423183434, 180.5496224334706, 2.4900316972860828, 91.94751482685918, 9.517024217687847, 131.5268629086424, 121.33602207757785, 6.628179108973158, 115.25264529366048, 1.7838334980500443, 120.47135519162288, 142.16986320924033, 165.82282327955807, 39.23098757022713, 274.124017901488, 52.67655666014773, 162.8277770747107, 208.7967183514499, 148.9233738035045, 5.211256437135279, 66.03110254548008, 45.16710689844573, 136.02342242186532, 99.47360385912373, 105.69982957992563, 163.00953831190344, 63.01174713258398, 107.97604420399932, 146.41054697201776, 65.28699689384219, 138.84545696476897, 77.39111275046088, 20.49332957496094, 149.55077103002336, 123.57423031748257, 11.546063988119254, 44.89265357271897, 99.45646571079098, 72.41328026369482, 297.909608351737, 65.64380821580153, 49.1728547123797, 213.9972439994229, 14.115367777995113, 102.42922330052734, 130.04521750844023, 114.57698189429716, 3.269460740005191, 182.5260537762655, 78.29752591476901, 50.350726708992724, 131.87570958176167, 32.62027413184101, 52.97814359878046, 72.74559633399171, 128.9823338228049, 111.71409032887928, 0.990635649390902, 21.953921613558958, 84.70022138287312, 189.4686304243318, 79.3742560079901, 188.7287463161033, 126.1331730218815, 101.36089073798105, 195.62228258944674, 29.836010121677575, 46.57693959689757, 206.3055189167674, 154.1010008858955, 264.2449876325799, 57.83150806693388, 178.54701810936913, 142.0269520327737, 183.43034535322982, 139.7305429798839, 82.04033644787744, 60.073014883762525, 74.77505013135352, 72.36795240653457, 81.96185108007838, 30.633268591575526, 1.1100501545013584, 0.0, 65.14269291228105, 65.85839345816821, 0.0, 83.126307453217, 314.1973378298993, 116.61954376429193, 24.51019782033266, 141.4680174464523, 104.4501089142906, 20.80240755763827, 25.95435392516173, 83.98748761726648, 92.75549996808951, 92.106310261821, 56.96897704732518, 125.02704567565085, 35.26603474806521, 122.01863718011299, 66.73592727243731, 249.79092284204506, 82.08058098232608, 200.52620815811727, 125.34868678634568, 83.35438817646425, 211.4256995768067]}, "sampler_perf": {"mean_raw_obs_processing_ms": 11.448772321171193, "mean_inference_ms": 7.846405737623499, "mean_action_processing_ms": 4.5840270168188475, "mean_env_wait_ms": 12.234375985387794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03366688887278239, "StateBufferConnector_ms": 0.011362632115681967, "ViewRequirementAgentConnector_ms": 0.2429536978403727}, "num_episodes": 37, "episode_return_max": 1224.6381887887783, "episode_return_min": 301.3521024725593, "episode_return_mean": 745.8686449452041, "episodes_this_iter": 37}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 65.80175400657494, "num_env_steps_trained_throughput_per_sec": 65.80175400657494, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 61892.317, "restore_workers_time_ms": 0.014, "training_step_time_ms": 61892.267, "sample_time_ms": 3660.472, "learn_time_ms": 58211.346, "learn_throughput": 68.715, "synch_weights_time_ms": 14.321}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "training_iteration": 9, "trial_id": "cdf48921", "date": "2024-08-24_00-52-24", "timestamp": 1724440944, "time_this_iter_s": 60.83459997177124, "time_total_s": 557.4555065631866, "pid": 83485, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.8055362763609899, "lr": 8.992829286398068e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3025ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 557.4555065631866, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 35.62906976744186, "ram_util_percent": 83.19418604651165}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.429775935753136, "cur_kl_coeff": 0.2, "cur_lr": 8.992829286398065e-05, "total_loss": 1.268249201635393, "policy_loss": -0.01459858968138157, "vf_loss": 1.280693847561085, "vf_explained_var": 0.5238322928706045, "kl": 0.010769688467951906, "entropy": 1.3717571106179758, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 22373.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7077160386775962, "cur_kl_coeff": 0.2, "cur_lr": 8.992829286398065e-05, "total_loss": 0.7630380617332053, "policy_loss": -0.012506939755899005, "vf_loss": 0.7728166387529131, "vf_explained_var": 0.39304140049434266, "kl": 0.013641808201774417, "entropy": 1.4438679292196934, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.38853503184713, "num_grad_updates_lifetime": 22373.0, "diff_num_grad_updates_vs_sampler_policy": 1177.0}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 1311.7598993764245, "episode_reward_min": 301.3521024725593, "episode_reward_mean": 718.4985027866876, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 36000, "policy_reward_min": {"prey_policy": -219.90482325896454, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 320.05663971303846, "predator_policy": 396.39595512992065}, "policy_reward_mean": {"prey_policy": 52.97048756180663, "predator_policy": 90.72921299552875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [834.5754755076587, 871.2064965390464, 492.96888930925445, 559.9020923814921, 744.1720459209216, 799.661709932248, 440.17504769283397, 1093.319538717055, 759.510761153469, 301.3521024725593, 802.4854554525476, 841.2888620246266, 859.9494366009293, 980.0094191859835, 1009.6109021492437, 868.6308365444768, 785.5111393611677, 780.1181683780399, 1110.4933296815755, 853.8991816746159, 1224.6381887887783, 671.7371668495382, 1172.281650216267, 729.4201338560179, 749.0959851751842, 651.9180751385527, 984.8175148476199, 714.4559444431616, 546.8520050455093, 568.8473728052788, 592.5524672832256, 409.43875362948796, 890.664547953977, 489.6443648170173, 338.512620472764, 795.9339418502622, 1046.9529388731712, 499.96919062393835, 626.3030894029438, 871.8044703484659, 664.1524931943209, 686.0738275877474, 719.899727669255, 586.7295176662766, 736.8088937372871, 741.7396605652717, 830.2186818622057, 690.4425714318181, 728.6387744794183, 470.0051347948291, 909.3266495636876, 712.7701646265394, 879.4193453178412, 850.103850500533, 817.2757706357751, 441.8798319353093, 906.4217759066883, 892.4425227412953, 738.2056845831919, 384.88250481205904, 654.9085462488804, 534.9684863796987, 843.414152936761, 430.5565075724714, 605.7282618843931, 990.9071529828723, 800.3884847604774, 626.5308756663871, 568.5886247643433, 475.3651099520641, 1103.5827359305702, 899.7546362309081, 567.2498075225907, 494.63634842237616, 782.9695295183202, 976.7966431999498, 856.0538276859412, 566.4846877412813, 403.7986857601513, 1311.7598993764245, 547.4615171987087, 517.5283731681454, 491.8686795889061, 372.0324271541389, 501.61766786464625, 400.67639554490177, 523.9123226262242, 737.6086668865978, 814.4868312553239, 511.11066826518226], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [25.24571689696757, -183.8820192907295, 15.198737865559231, 174.26083075904955, 40.04060779571648, -28.69657998370437, 101.61733947580821, 111.85725568107136, 163.80125405522097, -32.306526012359484, -57.62563652210089, 50.51666232106114, -78.31574737463393, 50.80000000000048, 30.416492728717635, 67.3187209446461, 73.68745527203428, -95.56616794692555, 192.22231471709117, -41.17712713663011, 50.17538136959517, 152.37694982852412, 112.44109681135298, -68.9987191016399, -44.00098933170675, -194.479875985306, 181.14864399587617, 99.20210774749579, 216.318564995285, -133.0709572804843, 63.39043088104656, 40.0000000000003, 65.47594360586078, 42.68945493383493, 55.30000000000048, 152.04657587530068, 45.59884162220402, 305.92223680460916, -26.13682027163184, 107.25670037946155, 134.233565065663, -20.85275292492351, 58.24791468343218, 67.75935679992277, 65.12934987482866, -163.1569539241177, 20.13896441414883, -103.46524971758615, -27.962758942814503, -219.90482325896454, 31.84946553239057, 32.229706333522955, 172.27880828351607, -188.08910557634297, 197.68186826516342, -21.304169887994615, 122.54809533575386, 20.41283635786612, 219.1726424834489, 12.637878608687727, 184.5922650214826, 8.85363831416145, 207.47358835305317, 83.0594043718252, 209.93373636319723, 46.920201594474904, 70.10790723692052, 265.8299510683445, 23.535667477233787, -34.101379404241655, -57.518928886538774, 24.963205337607317, 137.29808167365195, 111.44745024974284, 228.63540434585138, 189.21233427625126, -3.3273279969736667, 170.35766887358423, 125.36140673948513, 13.957847727956272, 151.37608988332764, 22.109347641175702, 65.81102338947473, 20.727144468058995, 195.70668886545783, -34.00445540827759, 5.164194523870233, 214.822084881626, -86.4562270293109, 39.81244636789324, 182.37537576599144, 169.8104689488965, 82.00394018404705, 203.5391233279494, 284.3362667759627, 93.76100725751756, -0.1488605568037536, 256.775365762929, 141.40637680863728, 3.179900626018044, 154.53323707343915, 189.3937670765877, 219.23024801912536, -126.85250230906536, 316.28278904243984, 73.01851519194118, 164.5867562735881, -78.29501287715354, 1.2349804886985736, -150.60675022779208, 241.06225988280315, 280.9838421121814, 97.36382908427113, 225.72830573550533, 103.95022286254658, 172.24040730455977, -17.256698942416172, 137.1905338621597, 0.942587505102854, 65.16121114425157, 84.37968925245966, 52.32993921350644, -52.692875019220715, 160.55259009845267, 42.46508447794332, 159.7637373077234, 137.75493850909925, 80.45172551554279, 13.08318001542563, 72.94340588114531, 189.77233545840522, 39.21324009223071, 104.37635776374267, 193.89460103942585, -2.485304210326415, 40.0000000000003, -50.240118917734335, 77.68973341539234, 93.79335413624665, 159.35121211149837, 167.76012234072837, 39.10906004425348, -19.90258067932445, 51.335766313906696, 37.51445796895292, 89.29037348030552, -87.98640354152286, -3.886296398341652, 181.4875727614338, -30.382807993013863, -10.922953572336988, -118.25221710402946, 57.765234092347875, 73.61830524698239, -56.661493809885116, -96.65661770538524, 0.4129228096838613, 10.258585001952259, 21.769652550029512, -52.65691950478099, 106.4146266802468, 153.02626342466107, 85.34708967499184, 83.68612644218571, 51.100243392601534, 11.14001727067841, 45.15457225777384, -4.896414083593569, -37.75291954729208, 126.5347054852624, 36.7897883447317, 40.0000000000003, 13.224200373017283, -5.424687814031145, -71.10853356312775, 49.00494087964071, -35.51874968144184, 36.942561935060965, 264.34943169059727, 194.98404155558495, 172.86407093045952, -8.999519539671809, 154.18112602383744, 100.84458841348066, 94.00052338124577, 20.457819916123512, -70.12071566824083, 39.71983263317017, 67.22485605092349, 120.93966207955323, 32.952929933538286, -16.44455659572978, 175.57120159862436, 40.0000000000003, 66.74786339706459, 119.73115439467259, 62.72819514450405, 240.97004234195774, 164.22484164190251, -100.11049678112161, 200.35849209466326, 43.475336391020576, 73.74648750874383, -177.89464146473668, 54.987955915913936, 39.24014463932149, 79.09431505827772, 33.21890190769456, -164.78030252310603, -148.0476752857532, 136.40828120595552, -78.983963975714, 133.83523412459664, 18.603974910188033, 158.12970924215875, 63.39796402808987, -76.23514113466531, 58.84801930008522, 34.241210134014224, -79.63024086168623, -68.27420907197703, 123.44770110456204, 84.79247588230012, 107.7148540643097, 37.56040454402226, 74.5942245031816, 40.0000000000003, 264.0593848790551, 126.1060900583022, -114.90273272809698, -61.41377173561066, 122.93463867652736, 169.39461432905102, 40.0000000000003, -81.53568246510996, -5.743767124131281, -47.65662639192903, 99.97038880395611, -46.56405863203758, 157.58969755641576, 88.12803184300341, 172.08039105635783, 40.0000000000003, 83.1163749575941, -0.808403313698028, 40.0000000000003, 58.70660668661148, -103.91283399245711, 124.6119571009477, 14.212827251094238, 21.843881937697986, 161.3144769910959, 29.86959259686367, 73.36866678318113, -45.4749958983421, 47.20844472207696, -17.663292744222826, 9.976041834865928, 70.28554848559037, 23.26178036545158, 159.27884750575126, -36.78290176314733, 128.85920957126268, -24.020328068499513, -144.66694865508643, 27.45453160320719, 187.71466844412018, 0.9819679351278077, 43.13849369401169, 50.76489902794959, 31.818938528787577, 90.08016710209036, 132.7754774817039, 225.53964667507896, 150.98841861540816, -53.90811004234005, 31.56719803556549, -84.43105801863436, 33.128178718909375, -12.801108411773146, 0.342170798914299, 229.47880214485696, 36.364955130225816, 163.57759328280912, 68.80797904686936, 111.84607923186735, 226.4190533852914, -29.68133905465217, 192.0861003591095, 40.0000000000003, -52.830053195243124, 77.84677512259748, 25.828568925991085, 135.43388200674997, -46.91205599522527, -6.384319525541487, -106.14038324263916, 15.149843670552677, -98.99316171963878, -121.48503805074402, 90.8650752485987, 22.564779660954695, -19.436429020971055, 18.460486460287708, 92.38351874195499, 26.87061956453988, 6.7121104404097425, 110.36120765699204, -122.81893218189737, 108.4035084997564, 203.27176985132752, 188.4352967938936, -197.63083422659517, -47.47683835657204, 32.149661476094934, 140.96467864570081, 38.96127666775869, -192.726160188145, 5.315369867144296, -41.72623073161355, -24.08815531319287, -11.323557798153734, -127.79735402418211, 140.50823806594002, 12.08710941882767, 243.90816462778383, -80.410681116192, 167.98259039602186, 167.59404175903563, 130.3339329117265, 170.97166023728022, 10.870228677380965, 57.226123194584076, 190.66059262831408, 37.2030267638578, 8.0464344879159, -21.3788389954873, 1.3983852570598259, 147.31383010658686, 32.89442870519063, -64.41405146848604, 28.250596094740352, 53.47335521138487, 109.93609144276377, -10.528936904438021, 44.88358147139939, 35.363193115981524, 40.0000000000003, 31.95699373261229, -103.4451153488291, 229.17888525111573, 50.75983044876326, 274.8506447483051, 56.25703643448069, 170.12322494340316, 133.8542612397457, 138.9782654798623, 52.153816605826826, 79.75347879939554, -55.060319907048864, 42.6646274205467, -73.56835641336814, 111.21863530450814, -62.85941352348965, -48.786945029848106, 23.652323227022418, -17.018886001997146, 50.8916518449262, 40.0000000000003, -31.29152850334812, 44.30570258140246, -71.4910794597071, -81.13748590781952, 219.48609589914665, 106.85897597780883, -15.968790179756306, 288.62933311788146, 191.56356092123937, -54.11699817812735, 254.50439588469771, 69.89197525869986, 27.18891837195159, 172.51378476534586, 183.69835873260834, 95.51691934988898, -23.11524152518679, 49.76499448852255, 7.733726710295272, 64.086419615575, -34.37305332738158, 80.65118001694424, -42.54673472245076, -20.310039182570467, 2.684833755441951, -73.55074295655763, 260.8474227191122, 1.1426416130673533, 224.94465802213426, 269.4603625478819, 289.5223349013528, 88.27464345144749, 57.12107865826941, 36.21054790704558, 23.77216289749352, 3.172444799443967, -61.25384841841648, 35.75836055819552, -49.06048065591485, 38.34983465947434, 119.20354035359266, -29.958898919160248, -52.99024137394149, -6.383880121303091, 14.890273920203144, -40.1066875735402, 19.898225175344717, -20.395575956427365, 25.576676535827975, -37.70738446379979, 44.64025029121968, 40.0000000000003, 61.59875227255385, -15.773412665953009, 66.89512850433876, 36.10403617253331, 18.085863256988997, 40.0000000000003, 31.14380805342259, 36.53762777335571, 24.38671424548123, 8.299695103057283, -66.07158840208366, 36.679575467841964, 32.12464269617043, 162.82952072971838, 24.221909717100885, 320.05663971303846, -175.33660185677792, 32.298848835120396, 85.81356367549105, 9.255858637500072, 207.60963245257324, -52.953284879256195, -38.81621622659955, 212.5439955182296, 69.8414240943018, -22.886772289143273, -12.544760549136837, 33.23345357733089, 2.427323728045941], "policy_predator_policy_reward": [184.82024305259156, 52.810417619816164, 244.03478410958363, 251.54278537547341, 30.50337132361833, 108.29527021946521, 27.11768543319307, 203.70779146561756, 206.52122876216197, 9.291777442562045, 105.23372294312819, 121.49268929172092, 66.79814718094804, 134.79875808484655, 68.85380065556537, 47.93608776355836, 87.93166835033554, 63.38987104559399, 37.25465041349716, 126.90461895828567, 86.0463826737806, 27.016204099359772, 70.89644524918292, 34.812974860153524, 323.4063194623171, 16.95419087879154, 21.89107926423759, 188.6894575519593, 6.612543634467053, 396.39595512992065, 0.0, 164.4568724051972, 0.0, 8.862345866874973, 0.0, 216.5531621637654, 137.47910041590887, 44.16382222111729, 64.3716799674504, 46.06423953887522, 62.504737296512836, 104.1164446915781, 125.85524731077875, 38.23517150782083, 124.28172684784106, 270.43891720263196, 221.0249856719836, 108.9437670314749, 74.58612500134777, 120.70912899444582, 261.9714286775216, 1.04751028420521, 122.47673671963882, 0.0, 171.0390369329229, 94.4341528768776, 31.34604876275516, 202.09688500168812, 98.45962748762715, 61.48486499790968, 41.26545741563533, 36.70971951103919, 14.232885832929297, 20.566523079817348, 53.26221833777927, 273.7205380820017, 196.24178921283257, 18.16088628482091, 6.7158019595677, 112.87805567401948, 134.49727373033443, 177.58428022636693, 93.23430285241284, 146.4179442039907, 13.051888415819352, 47.38252289546028, 27.552484092070447, 231.8741093345151, 9.212742782704241, 57.04704781941286, 47.41223719635994, 30.955038536228532, 81.08846023587836, 17.279867594476624, 153.04524155071422, 289.55611676639074, 91.95581832882984, 36.163714300108545, 93.90020167241948, 129.20427397448026, 0.0, 44.68853098030884, 79.40657951964127, 64.33304417878475, 0.0, 1.9071802503183468, 147.63218104523156, 8.258630840134805, 127.94229814965486, 73.18510149096659, 23.21242998905787, 140.3126606184826, 96.56392556791245, 122.04157303348234, 89.92006067732466, 173.08295771836382, 93.66094488459325, 43.46410120423537, 57.30355218940814, 294.2871220036363, 78.66702657218184, 3.871347344295147, 0.0, 78.78207699450844, 61.87273962797625, 67.2990588884575, 67.68791325106821, 34.223199336329266, 74.24637386095098, 127.68554764554106, 7.9236916308531935, 210.71235780971196, 25.673166197850147, 25.96725490659634, 191.78508660702607, 34.435827812184094, 3.277601981559795, 13.86494470751585, 75.21308035718624, 61.12963305115486, 113.13139081592655, 39.49331101756658, 52.3997514918638, 227.4894699755742, 27.532361403205478, 31.43932697085434, 121.8116447943948, 123.40472678424818, 71.59904805704483, 45.60701709120564, 95.03229053164044, 0.0, 20.937918544782292, 155.06496998054732, 0.0, 159.58379615428734, 49.27702482754031, 40.641804048505996, 168.73241586352466, 2.0898936025439028, 49.98376322740522, 227.3984501670044, 49.25587562192885, 203.9368960091544, 116.43060740464115, 54.361820365740144, 93.65275699351552, 192.09533004362748, 50.614593349709615, 135.5866297253883, 67.2863441507267, 67.63933555234516, 177.16322507287506, 28.758364038761165, 70.24292952457455, 120.37742258881813, 93.97860343137661, 12.508003930821669, 21.99003694141282, 100.61033654174786, 76.8924505506028, 131.89637889446286, 68.74528917754874, 31.88816363241911, 15.6095708771296, 0.0, 54.34516859826117, 118.38529217014192, 18.027701113883776, 95.41355358852215, 368.3165365503419, 24.371136500808653, 33.505510172739726, 26.470848697235024, 81.39811774269285, 67.77373194109263, 28.711010641336696, 72.90159113347843, 28.36581218698333, 123.99558970950417, 39.13361568862773, 13.354866423183434, 180.5496224334706, 2.4900316972860828, 91.94751482685918, 9.517024217687847, 131.5268629086424, 121.33602207757785, 6.628179108973158, 115.25264529366048, 1.7838334980500443, 120.47135519162288, 142.16986320924033, 165.82282327955807, 39.23098757022713, 274.124017901488, 52.67655666014773, 162.8277770747107, 208.7967183514499, 148.9233738035045, 5.211256437135279, 66.03110254548008, 45.16710689844573, 136.02342242186532, 99.47360385912373, 105.69982957992563, 163.00953831190344, 63.01174713258398, 107.97604420399932, 146.41054697201776, 65.28699689384219, 138.84545696476897, 77.39111275046088, 20.49332957496094, 149.55077103002336, 123.57423031748257, 11.546063988119254, 44.89265357271897, 99.45646571079098, 72.41328026369482, 297.909608351737, 65.64380821580153, 49.1728547123797, 213.9972439994229, 14.115367777995113, 102.42922330052734, 130.04521750844023, 114.57698189429716, 3.269460740005191, 182.5260537762655, 78.29752591476901, 50.350726708992724, 131.87570958176167, 32.62027413184101, 52.97814359878046, 72.74559633399171, 128.9823338228049, 111.71409032887928, 0.990635649390902, 21.953921613558958, 84.70022138287312, 189.4686304243318, 79.3742560079901, 188.7287463161033, 126.1331730218815, 101.36089073798105, 195.62228258944674, 29.836010121677575, 46.57693959689757, 206.3055189167674, 154.1010008858955, 264.2449876325799, 57.83150806693388, 178.54701810936913, 142.0269520327737, 183.43034535322982, 139.7305429798839, 82.04033644787744, 60.073014883762525, 74.77505013135352, 72.36795240653457, 81.96185108007838, 30.633268591575526, 1.1100501545013584, 0.0, 65.14269291228105, 65.85839345816821, 0.0, 83.126307453217, 314.1973378298993, 116.61954376429193, 24.51019782033266, 141.4680174464523, 104.4501089142906, 20.80240755763827, 25.95435392516173, 83.98748761726648, 92.75549996808951, 92.106310261821, 56.96897704732518, 125.02704567565085, 35.26603474806521, 122.01863718011299, 66.73592727243731, 249.79092284204506, 82.08058098232608, 200.52620815811727, 125.34868678634568, 83.35438817646425, 211.4256995768067, 116.3520332972883, 62.413059304657764, 142.5940793794455, 22.230348152417537, 106.48159502423556, 84.49092000464474, 141.51051524782122, 115.89217950695492, 7.365640970168054, 56.18071667028731, 50.62402091806143, 217.03464759938603, 137.8819805524772, 109.8508021493669, 149.27364617930826, 84.98596019189881, 21.922960860420755, 3.596900010429394, 243.0917092570822, 126.17004299177434, 85.70469829476802, 94.09374601000786, 279.2657658520066, 77.66531399863027, 79.61245737973202, 84.27945041075436, 60.29648220084192, 52.150375121839495, 63.91111848354508, 100.8616781874977, 0.9437272429872791, 75.51998180848997, 6.785697850961709, 36.20890888785775, 213.99853746874894, 6.059437162016205, 33.22250813204111, 124.75624047757188, 224.53495925691965, 69.68349107655855, 123.33297173715744, 154.55161537946915, 56.27183874502489, 54.52478034450931, 63.19036418220442, 166.94326430907907, 17.300192497156623, 94.86389790377287, 107.2913588191061, 40.20774345177042, 61.23149458824989, 121.0597662698822, 5.593562208833506, 36.41576502318166, 98.11252601436527, 104.79721213230832, 55.12549492135812, 261.68100702155846, 74.59794161050576, 53.87347832738605, 21.268251036872098, 348.40555394945966, 57.633907980148926, 156.1465694067323, 15.126977391018137, 128.41507056371185, 56.11888600199765, 75.18337545618301, 3.546508839242509, 165.1389469946189, 86.00550753435935, 180.94839517783984, 44.1951862823153, 197.783880447164, 56.01435098580007, 27.20348225104204, 115.42353913312462, 39.09284764438562, 34.5195805705749, 95.94569203487319, 136.60173834379785, 62.45436731404296, 5.977467492539707, 60.91610616800892, 41.29419188904196, 130.52078599621922, 140.3708203113822, 0.0, 165.557587048487, 65.93864842335569, 103.54664794870146, 94.56166971332847, 82.31411377298272, 141.68232960111266, 34.76542781320858, 70.03069742004661, 5.56455121822584, 73.23191276771962, 86.6267115130904, 30.388606653819558, 124.91296049117048, 33.8509193000463, 79.97676631962499, 82.43813667696887, 17.73185669717554, 84.41643774398759, 71.4357935316942, 151.52851007328096, 97.06720583568678, 30.08301948654939, 124.68146171088296, 101.78496174479976, 124.65994939326293, 118.33286785521157, 136.95887295247948, 90.61485559169485, 82.46859500677239, 79.09609712134755, 46.26917946079892, 41.57150839134701, 42.175028356815965, 67.54678292715035, 110.36441815703456, 17.24111584034534, 75.46581829980849, 19.994972572844404, 55.37355897401189, 18.366161694597825, 102.62924904196788, 54.15843993222389, 107.30693814862677, 56.52783339511236, 53.981430409958136, 98.11797448090559, 34.116300596899464, 145.8407156412844, 0.8040358591821605, 5.518223780328837, 20.112930036153855, 278.27840148566224, 108.91920012109652, 61.27358434587924, 20.338144947017593, 260.5829262278515, 25.732990111015056, 11.425087539328825, 135.94717271000164, 82.65206179907787, 103.95233938772147, 107.0633382676375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 11.480632749959998, "mean_inference_ms": 7.81032229636225, "mean_action_processing_ms": 4.610934877732906, "mean_env_wait_ms": 12.230621069114022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0247547361585829, "StateBufferConnector_ms": 0.010210275650024414, "ViewRequirementAgentConnector_ms": 0.2529968155754937}, "num_episodes": 30, "episode_return_max": 1311.7598993764245, "episode_return_min": 301.3521024725593, "episode_return_mean": 718.4985027866876, "episodes_this_iter": 30}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 64.43128336369966, "num_env_steps_trained_throughput_per_sec": 64.43128336369966, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 61911.251, "restore_workers_time_ms": 0.014, "training_step_time_ms": 61911.201, "sample_time_ms": 3651.62, "learn_time_ms": 58238.935, "learn_throughput": 68.683, "synch_weights_time_ms": 14.353}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": true, "training_iteration": 10, "trial_id": "cdf48921", "date": "2024-08-24_00-53-26", "timestamp": 1724441006, "time_this_iter_s": 62.12783718109131, "time_total_s": 619.583343744278, "pid": 83485, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 5, "prey_speed": 1.5, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 5, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 30}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.8055362763609899, "lr": 8.992829286398068e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17345bc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 619.583343744278, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 38.66818181818182, "ram_util_percent": 83.19318181818183}}
