{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1884287971195089, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.303870932513444, "policy_loss": -0.00262694397951087, "vf_loss": 6.300491839111166, "vf_explained_var": 0.018636657005895382, "kl": 0.030030195921580627, "entropy": 1.5990151130963886, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1011109808607706, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.936117943380245, "policy_loss": -0.0022859903413398317, "vf_loss": 3.9348602395839793, "vf_explained_var": 0.006153863132315338, "kl": 0.017718466560518932, "entropy": 1.6048265822350032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 258.0, "episode_reward_min": 0.0, "episode_reward_mean": 113.22222222222223, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 3600, "policy_reward_min": {"prey_policy": -98.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 154.0, "predator_policy": 124.0}, "policy_reward_mean": {"prey_policy": 24.63888888888889, "predator_policy": 31.97222222222222}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.0, 187.0, 188.0, 169.0, 101.0, 152.0, 143.0, 15.0, 221.0, 132.0, 131.0, 57.0, 0.0, 19.0, 71.0, 127.0, 52.0, 258.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [15.0, 0.0, 73.0, 114.0, 105.0, 8.0, 35.0, 45.0, 21.0, 5.0, 45.0, 23.0, 10.0, 25.0, -68.0, -6.0, 53.0, 109.0, -90.0, 117.0, 131.0, -42.0, 55.0, -65.0, -1.0, 0.0, -38.0, -26.0, -98.0, 24.0, 127.0, 0.0, -41.0, -32.0, 154.0, 100.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 33.0, 42.0, 28.0, 61.0, 1.0, 74.0, 17.0, 67.0, 22.0, 86.0, 89.0, 0.0, 59.0, 0.0, 61.0, 44.0, 0.0, 42.0, 22.0, 45.0, 0.0, 1.0, 0.0, 83.0, 124.0, 21.0, 0.0, 0.0, 32.0, 93.0, 4.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8176883007001786, "mean_inference_ms": 2.0894223861819055, "mean_action_processing_ms": 0.36075366899279965, "mean_env_wait_ms": 0.27342721643272383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007053878572252061, "StateBufferConnector_ms": 0.004377630021837022, "ViewRequirementAgentConnector_ms": 0.11721584531995985}, "num_episodes": 18, "episode_return_max": 258.0, "episode_return_min": 0.0, "episode_return_mean": 113.22222222222223, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.68541475318295, "num_env_steps_trained_throughput_per_sec": 79.68541475318295, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 50197.401, "restore_workers_time_ms": 0.109, "training_step_time_ms": 50197.244, "sample_time_ms": 1723.719, "learn_time_ms": 48454.166, "learn_throughput": 82.552, "synch_weights_time_ms": 14.983}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "51025_00000", "date": "2024-08-12_20-24-53", "timestamp": 1723508693, "time_this_iter_s": 50.232917070388794, "time_total_s": 50.232917070388794, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32c96c5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 50.232917070388794, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 37.856944444444444, "ram_util_percent": 83.17916666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.051245663058821, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.815491112451705, "policy_loss": -0.010328778389363337, "vf_loss": 6.824237710710555, "vf_explained_var": 0.08270284665955438, "kl": 0.005273963090495936, "entropy": 1.5909608225973826, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.343928817718748, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.352728132596091, "policy_loss": -0.013679286735452633, "vf_loss": 4.364555114917654, "vf_explained_var": 0.007521228657828437, "kl": 0.009261454113140251, "entropy": 1.5904674472001494, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 258.0, "episode_reward_min": -12.0, "episode_reward_mean": 92.41666666666667, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 7200, "policy_reward_min": {"prey_policy": -135.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 156.0, "predator_policy": 158.0}, "policy_reward_mean": {"prey_policy": 10.375, "predator_policy": 35.833333333333336}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.0, 187.0, 188.0, 169.0, 101.0, 152.0, 143.0, 15.0, 221.0, 132.0, 131.0, 57.0, 0.0, 19.0, 71.0, 127.0, 52.0, 258.0, 202.0, 26.0, 5.0, 125.0, 158.0, 85.0, 57.0, 131.0, 49.0, 136.0, 0.0, 179.0, 19.0, 0.0, -12.0, -7.0, 18.0, 118.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [15.0, 0.0, 73.0, 114.0, 105.0, 8.0, 35.0, 45.0, 21.0, 5.0, 45.0, 23.0, 10.0, 25.0, -68.0, -6.0, 53.0, 109.0, -90.0, 117.0, 131.0, -42.0, 55.0, -65.0, -1.0, 0.0, -38.0, -26.0, -98.0, 24.0, 127.0, 0.0, -41.0, -32.0, 154.0, 100.0, 55.0, 103.0, -101.0, -15.0, -55.0, -2.0, 89.0, -17.0, 75.0, 26.0, -25.0, -79.0, -9.0, -75.0, -2.0, 71.0, 48.0, -28.0, 22.0, 35.0, -40.0, -10.0, 17.0, 156.0, -7.0, -42.0, 0.0, -56.0, -135.0, -35.0, -14.0, -50.0, 0.0, 16.0, -31.0, -25.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 33.0, 42.0, 28.0, 61.0, 1.0, 74.0, 17.0, 67.0, 22.0, 86.0, 89.0, 0.0, 59.0, 0.0, 61.0, 44.0, 0.0, 42.0, 22.0, 45.0, 0.0, 1.0, 0.0, 83.0, 124.0, 21.0, 0.0, 0.0, 32.0, 93.0, 4.0, 0.0, 0.0, 44.0, 131.0, 11.0, 0.0, 62.0, 16.0, 37.0, 25.0, 32.0, 103.0, 86.0, 75.0, 66.0, 32.0, 30.0, 28.0, 1.0, 0.0, 79.0, 0.0, 50.0, 1.0, 5.0, 41.0, 27.0, 56.0, 0.0, 158.0, 0.0, 57.0, 0.0, 0.0, 2.0, 104.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7594417242384233, "mean_inference_ms": 1.8894267213930125, "mean_action_processing_ms": 0.3300464993997179, "mean_env_wait_ms": 0.2492906704783062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006406174765692817, "StateBufferConnector_ms": 0.003591510984632704, "ViewRequirementAgentConnector_ms": 0.10114179717169867}, "num_episodes": 18, "episode_return_max": 258.0, "episode_return_min": -12.0, "episode_return_mean": 92.41666666666667, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.45117537614121, "num_env_steps_trained_throughput_per_sec": 79.45117537614121, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 50271.397, "restore_workers_time_ms": 0.063, "training_step_time_ms": 50271.289, "sample_time_ms": 1406.078, "learn_time_ms": 48845.74, "learn_throughput": 81.89, "synch_weights_time_ms": 14.336}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "51025_00000", "date": "2024-08-12_20-25-46", "timestamp": 1723508746, "time_this_iter_s": 50.38502812385559, "time_total_s": 100.61794519424438, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cb333a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 100.61794519424438, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 34.970666666666666, "ram_util_percent": 82.67733333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.256672414884996, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.5713808339739606, "policy_loss": -0.010793333699576873, "vf_loss": 7.580035644611985, "vf_explained_var": 0.11571373753446751, "kl": 0.00712837628298589, "entropy": 1.5834932170217, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0603719360929316, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.914179050228583, "policy_loss": -0.013841993188628405, "vf_loss": 4.9264645841386585, "vf_explained_var": 0.02249278987526263, "kl": 0.007782279737756331, "entropy": 1.5787760011102787, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 357.0, "episode_reward_min": -12.0, "episode_reward_mean": 117.74074074074075, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 10800, "policy_reward_min": {"prey_policy": -135.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 186.0, "predator_policy": 158.0}, "policy_reward_mean": {"prey_policy": 22.185185185185187, "predator_policy": 36.68518518518518}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.0, 187.0, 188.0, 169.0, 101.0, 152.0, 143.0, 15.0, 221.0, 132.0, 131.0, 57.0, 0.0, 19.0, 71.0, 127.0, 52.0, 258.0, 202.0, 26.0, 5.0, 125.0, 158.0, 85.0, 57.0, 131.0, 49.0, 136.0, 0.0, 179.0, 19.0, 0.0, -12.0, -7.0, 18.0, 118.0, 338.0, 99.0, 5.0, 52.0, 76.0, 149.0, 178.0, 120.0, 216.0, 216.0, 126.0, 139.0, 357.0, 324.0, 198.0, 191.0, 117.0, 130.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [15.0, 0.0, 73.0, 114.0, 105.0, 8.0, 35.0, 45.0, 21.0, 5.0, 45.0, 23.0, 10.0, 25.0, -68.0, -6.0, 53.0, 109.0, -90.0, 117.0, 131.0, -42.0, 55.0, -65.0, -1.0, 0.0, -38.0, -26.0, -98.0, 24.0, 127.0, 0.0, -41.0, -32.0, 154.0, 100.0, 55.0, 103.0, -101.0, -15.0, -55.0, -2.0, 89.0, -17.0, 75.0, 26.0, -25.0, -79.0, -9.0, -75.0, -2.0, 71.0, 48.0, -28.0, 22.0, 35.0, -40.0, -10.0, 17.0, 156.0, -7.0, -42.0, 0.0, -56.0, -135.0, -35.0, -14.0, -50.0, 0.0, 16.0, -31.0, -25.0, 109.0, 186.0, -1.0, 80.0, 0.0, 3.0, 0.0, -9.0, 52.0, -67.0, -120.0, 88.0, -74.0, 74.0, 2.0, 36.0, 48.0, 148.0, 15.0, 87.0, 126.0, -8.0, 0.0, 57.0, 185.0, 148.0, 172.0, 89.0, 83.0, 33.0, 109.0, 74.0, 29.0, 0.0, -34.0, -71.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 33.0, 42.0, 28.0, 61.0, 1.0, 74.0, 17.0, 67.0, 22.0, 86.0, 89.0, 0.0, 59.0, 0.0, 61.0, 44.0, 0.0, 42.0, 22.0, 45.0, 0.0, 1.0, 0.0, 83.0, 124.0, 21.0, 0.0, 0.0, 32.0, 93.0, 4.0, 0.0, 0.0, 44.0, 131.0, 11.0, 0.0, 62.0, 16.0, 37.0, 25.0, 32.0, 103.0, 86.0, 75.0, 66.0, 32.0, 30.0, 28.0, 1.0, 0.0, 79.0, 0.0, 50.0, 1.0, 5.0, 41.0, 27.0, 56.0, 0.0, 158.0, 0.0, 57.0, 0.0, 0.0, 2.0, 104.0, 70.0, 31.0, 12.0, 18.0, 2.0, 2.0, 0.0, 61.0, 0.0, 0.0, 91.0, 44.0, 137.0, 127.0, 51.0, 82.0, 0.0, 20.0, 0.0, 108.0, 6.0, 8.0, 0.0, 57.0, 25.0, 17.0, 7.0, 51.0, 12.0, 77.0, 5.0, 8.0, 0.0, 70.0, 18.0, 109.0, 126.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7280743472540705, "mean_inference_ms": 1.780802282763143, "mean_action_processing_ms": 0.31259238039186715, "mean_env_wait_ms": 0.23460437458743386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0063631269666883684, "StateBufferConnector_ms": 0.003337860107421875, "ViewRequirementAgentConnector_ms": 0.09676019350687663}, "num_episodes": 18, "episode_return_max": 357.0, "episode_return_min": -12.0, "episode_return_mean": 117.74074074074075, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 87.04393246359801, "num_env_steps_trained_throughput_per_sec": 87.04393246359801, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 48832.203, "restore_workers_time_ms": 0.047, "training_step_time_ms": 48832.115, "sample_time_ms": 1303.667, "learn_time_ms": 47507.086, "learn_throughput": 84.198, "synch_weights_time_ms": 16.336}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "51025_00000", "date": "2024-08-12_20-26-32", "timestamp": 1723508792, "time_this_iter_s": 45.99332928657532, "time_total_s": 146.6112744808197, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cb47550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 146.6112744808197, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 22.383333333333333, "ram_util_percent": 80.42272727272729}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6324518861909394, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.299567214269487, "policy_loss": -0.014880379066166897, "vf_loss": 8.311439484389371, "vf_explained_var": 0.10705503032951759, "kl": 0.010027016706307597, "entropy": 1.5689741801963282, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.106926481749015, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.948005895009117, "policy_loss": -0.014432493542572335, "vf_loss": 5.960193457931438, "vf_explained_var": 0.05476444499202506, "kl": 0.01122460765178543, "entropy": 1.5654787840035858, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 375.0, "episode_reward_min": -12.0, "episode_reward_mean": 134.68055555555554, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -135.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 158.0}, "policy_reward_mean": {"prey_policy": 28.40972222222222, "predator_policy": 38.93055555555556}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.0, 187.0, 188.0, 169.0, 101.0, 152.0, 143.0, 15.0, 221.0, 132.0, 131.0, 57.0, 0.0, 19.0, 71.0, 127.0, 52.0, 258.0, 202.0, 26.0, 5.0, 125.0, 158.0, 85.0, 57.0, 131.0, 49.0, 136.0, 0.0, 179.0, 19.0, 0.0, -12.0, -7.0, 18.0, 118.0, 338.0, 99.0, 5.0, 52.0, 76.0, 149.0, 178.0, 120.0, 216.0, 216.0, 126.0, 139.0, 357.0, 324.0, 198.0, 191.0, 117.0, 130.0, 97.0, 176.0, 178.0, 161.0, 161.0, 163.0, 171.0, 153.0, 61.0, 210.0, 171.0, 279.0, 271.0, 158.0, 375.0, 284.0, 114.0, 156.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [15.0, 0.0, 73.0, 114.0, 105.0, 8.0, 35.0, 45.0, 21.0, 5.0, 45.0, 23.0, 10.0, 25.0, -68.0, -6.0, 53.0, 109.0, -90.0, 117.0, 131.0, -42.0, 55.0, -65.0, -1.0, 0.0, -38.0, -26.0, -98.0, 24.0, 127.0, 0.0, -41.0, -32.0, 154.0, 100.0, 55.0, 103.0, -101.0, -15.0, -55.0, -2.0, 89.0, -17.0, 75.0, 26.0, -25.0, -79.0, -9.0, -75.0, -2.0, 71.0, 48.0, -28.0, 22.0, 35.0, -40.0, -10.0, 17.0, 156.0, -7.0, -42.0, 0.0, -56.0, -135.0, -35.0, -14.0, -50.0, 0.0, 16.0, -31.0, -25.0, 109.0, 186.0, -1.0, 80.0, 0.0, 3.0, 0.0, -9.0, 52.0, -67.0, -120.0, 88.0, -74.0, 74.0, 2.0, 36.0, 48.0, 148.0, 15.0, 87.0, 126.0, -8.0, 0.0, 57.0, 185.0, 148.0, 172.0, 89.0, 83.0, 33.0, 109.0, 74.0, 29.0, 0.0, -34.0, -71.0, -95.0, -33.0, 118.0, -16.0, -61.0, 178.0, -62.0, 63.0, 0.0, 112.0, 0.0, 155.0, 27.0, 76.0, -31.0, 137.0, 0.0, -33.0, -15.0, 111.0, -56.0, 88.0, 53.0, 157.0, 134.0, 29.0, -78.0, 35.0, 200.0, 173.0, 2.0, 180.0, 103.0, -60.0, 115.0, -11.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 33.0, 42.0, 28.0, 61.0, 1.0, 74.0, 17.0, 67.0, 22.0, 86.0, 89.0, 0.0, 59.0, 0.0, 61.0, 44.0, 0.0, 42.0, 22.0, 45.0, 0.0, 1.0, 0.0, 83.0, 124.0, 21.0, 0.0, 0.0, 32.0, 93.0, 4.0, 0.0, 0.0, 44.0, 131.0, 11.0, 0.0, 62.0, 16.0, 37.0, 25.0, 32.0, 103.0, 86.0, 75.0, 66.0, 32.0, 30.0, 28.0, 1.0, 0.0, 79.0, 0.0, 50.0, 1.0, 5.0, 41.0, 27.0, 56.0, 0.0, 158.0, 0.0, 57.0, 0.0, 0.0, 2.0, 104.0, 70.0, 31.0, 12.0, 18.0, 2.0, 2.0, 0.0, 61.0, 0.0, 0.0, 91.0, 44.0, 137.0, 127.0, 51.0, 82.0, 0.0, 20.0, 0.0, 108.0, 6.0, 8.0, 0.0, 57.0, 25.0, 17.0, 7.0, 51.0, 12.0, 77.0, 5.0, 8.0, 0.0, 70.0, 18.0, 109.0, 126.0, 86.0, 139.0, 24.0, 50.0, 0.0, 61.0, 62.0, 98.0, 7.0, 42.0, 0.0, 8.0, 0.0, 68.0, 0.0, 47.0, 31.0, 63.0, 28.0, 86.0, 102.0, 37.0, 69.0, 0.0, 0.0, 108.0, 111.0, 90.0, 2.0, 0.0, 0.0, 102.0, 0.0, 71.0, 52.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7050322603907173, "mean_inference_ms": 1.7081835678174908, "mean_action_processing_ms": 0.3003597412530996, "mean_env_wait_ms": 0.2250723872184901, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00616908073425293, "StateBufferConnector_ms": 0.003199279308319092, "ViewRequirementAgentConnector_ms": 0.09464638100730048}, "num_episodes": 18, "episode_return_max": 375.0, "episode_return_min": -12.0, "episode_return_mean": 134.68055555555554, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 87.07860953615955, "num_env_steps_trained_throughput_per_sec": 87.07860953615955, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 48108.03, "restore_workers_time_ms": 0.039, "training_step_time_ms": 48107.955, "sample_time_ms": 1245.358, "learn_time_ms": 46842.002, "learn_throughput": 85.393, "synch_weights_time_ms": 16.497}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "51025_00000", "date": "2024-08-12_20-27-18", "timestamp": 1723508838, "time_this_iter_s": 45.96436810493469, "time_total_s": 192.5756425857544, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cb47e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 192.5756425857544, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 22.884615384615383, "ram_util_percent": 80.36615384615384}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.026418501548666, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.265761733685852, "policy_loss": -0.012508590316902551, "vf_loss": 6.276128897338948, "vf_explained_var": 0.21341036255397494, "kl": 0.0071380980578059855, "entropy": 1.5651172055138483, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.320093266863041, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.932154975492487, "policy_loss": -0.019783512941714397, "vf_loss": 4.9489216991202545, "vf_explained_var": 0.0013163064838086487, "kl": 0.015084004586243635, "entropy": 1.5528563599107126, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 375.0, "episode_reward_min": -12.0, "episode_reward_mean": 146.5252525252525, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 19800, "policy_reward_min": {"prey_policy": -135.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 158.0}, "policy_reward_mean": {"prey_policy": 32.64646464646464, "predator_policy": 40.61616161616162}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.0, 187.0, 188.0, 169.0, 101.0, 152.0, 143.0, 15.0, 221.0, 132.0, 131.0, 57.0, 0.0, 19.0, 71.0, 127.0, 52.0, 258.0, 202.0, 26.0, 5.0, 125.0, 158.0, 85.0, 57.0, 131.0, 49.0, 136.0, 0.0, 179.0, 19.0, 0.0, -12.0, -7.0, 18.0, 118.0, 338.0, 99.0, 5.0, 52.0, 76.0, 149.0, 178.0, 120.0, 216.0, 216.0, 126.0, 139.0, 357.0, 324.0, 198.0, 191.0, 117.0, 130.0, 97.0, 176.0, 178.0, 161.0, 161.0, 163.0, 171.0, 153.0, 61.0, 210.0, 171.0, 279.0, 271.0, 158.0, 375.0, 284.0, 114.0, 156.0, 254.0, 211.0, 262.0, 318.0, 288.0, 164.0, 158.0, 138.0, 156.0, 247.0, 167.0, 279.0, 78.0, 0.0, 111.0, 369.0, 82.0, 222.0, 145.0, 169.0, 136.0, 301.0, 137.0, 0.0, 139.0, 106.0, 172.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [15.0, 0.0, 73.0, 114.0, 105.0, 8.0, 35.0, 45.0, 21.0, 5.0, 45.0, 23.0, 10.0, 25.0, -68.0, -6.0, 53.0, 109.0, -90.0, 117.0, 131.0, -42.0, 55.0, -65.0, -1.0, 0.0, -38.0, -26.0, -98.0, 24.0, 127.0, 0.0, -41.0, -32.0, 154.0, 100.0, 55.0, 103.0, -101.0, -15.0, -55.0, -2.0, 89.0, -17.0, 75.0, 26.0, -25.0, -79.0, -9.0, -75.0, -2.0, 71.0, 48.0, -28.0, 22.0, 35.0, -40.0, -10.0, 17.0, 156.0, -7.0, -42.0, 0.0, -56.0, -135.0, -35.0, -14.0, -50.0, 0.0, 16.0, -31.0, -25.0, 109.0, 186.0, -1.0, 80.0, 0.0, 3.0, 0.0, -9.0, 52.0, -67.0, -120.0, 88.0, -74.0, 74.0, 2.0, 36.0, 48.0, 148.0, 15.0, 87.0, 126.0, -8.0, 0.0, 57.0, 185.0, 148.0, 172.0, 89.0, 83.0, 33.0, 109.0, 74.0, 29.0, 0.0, -34.0, -71.0, -95.0, -33.0, 118.0, -16.0, -61.0, 178.0, -62.0, 63.0, 0.0, 112.0, 0.0, 155.0, 27.0, 76.0, -31.0, 137.0, 0.0, -33.0, -15.0, 111.0, -56.0, 88.0, 53.0, 157.0, 134.0, 29.0, -78.0, 35.0, 200.0, 173.0, 2.0, 180.0, 103.0, -60.0, 115.0, -11.0, 6.0, 20.0, 66.0, -118.0, 25.0, 128.0, 156.0, 101.0, 117.0, 116.0, 127.0, 5.0, -57.0, 54.0, 79.0, 0.0, 6.0, 28.0, 5.0, 97.0, 0.0, 166.0, 57.0, 86.0, -44.0, -44.0, 0.0, 0.0, 18.0, 0.0, 143.0, 198.0, -62.0, 0.0, 107.0, 51.0, 21.0, -14.0, -1.0, 162.0, 0.0, 132.0, 128.0, 62.0, 0.0, 12.0, -4.0, 0.0, 0.0, 31.0, 91.0, -23.0, 139.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 33.0, 42.0, 28.0, 61.0, 1.0, 74.0, 17.0, 67.0, 22.0, 86.0, 89.0, 0.0, 59.0, 0.0, 61.0, 44.0, 0.0, 42.0, 22.0, 45.0, 0.0, 1.0, 0.0, 83.0, 124.0, 21.0, 0.0, 0.0, 32.0, 93.0, 4.0, 0.0, 0.0, 44.0, 131.0, 11.0, 0.0, 62.0, 16.0, 37.0, 25.0, 32.0, 103.0, 86.0, 75.0, 66.0, 32.0, 30.0, 28.0, 1.0, 0.0, 79.0, 0.0, 50.0, 1.0, 5.0, 41.0, 27.0, 56.0, 0.0, 158.0, 0.0, 57.0, 0.0, 0.0, 2.0, 104.0, 70.0, 31.0, 12.0, 18.0, 2.0, 2.0, 0.0, 61.0, 0.0, 0.0, 91.0, 44.0, 137.0, 127.0, 51.0, 82.0, 0.0, 20.0, 0.0, 108.0, 6.0, 8.0, 0.0, 57.0, 25.0, 17.0, 7.0, 51.0, 12.0, 77.0, 5.0, 8.0, 0.0, 70.0, 18.0, 109.0, 126.0, 86.0, 139.0, 24.0, 50.0, 0.0, 61.0, 62.0, 98.0, 7.0, 42.0, 0.0, 8.0, 0.0, 68.0, 0.0, 47.0, 31.0, 63.0, 28.0, 86.0, 102.0, 37.0, 69.0, 0.0, 0.0, 108.0, 111.0, 90.0, 2.0, 0.0, 0.0, 102.0, 0.0, 71.0, 52.0, 0.0, 111.0, 117.0, 129.0, 134.0, 50.0, 59.0, 19.0, 42.0, 40.0, 15.0, 30.0, 2.0, 75.0, 86.0, 45.0, 14.0, 15.0, 107.0, 108.0, 37.0, 1.0, 0.0, 61.0, 75.0, 36.0, 130.0, 0.0, 0.0, 27.0, 66.0, 0.0, 28.0, 59.0, 85.0, 0.0, 64.0, 85.0, 53.0, 1.0, 7.0, 1.0, 3.0, 59.0, 52.0, 64.0, 61.0, 0.0, 4.0, 58.0, 50.0, 26.0, 12.0, 18.0, 15.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6827263523722068, "mean_inference_ms": 1.6361626922485195, "mean_action_processing_ms": 0.28797395718118024, "mean_env_wait_ms": 0.21594418834376816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006288711470786972, "StateBufferConnector_ms": 0.003136890103118588, "ViewRequirementAgentConnector_ms": 0.09309414661291873}, "num_episodes": 27, "episode_return_max": 375.0, "episode_return_min": -12.0, "episode_return_mean": 146.5252525252525, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.04306269979692, "num_env_steps_trained_throughput_per_sec": 88.04306269979692, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 47572.888, "restore_workers_time_ms": 0.034, "training_step_time_ms": 47572.818, "sample_time_ms": 1207.647, "learn_time_ms": 46344.363, "learn_throughput": 86.31, "synch_weights_time_ms": 15.927}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "51025_00000", "date": "2024-08-12_20-28-03", "timestamp": 1723508883, "time_this_iter_s": 45.46291518211365, "time_total_s": 238.03855776786804, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cb3ae50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 238.03855776786804, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 21.667692307692306, "ram_util_percent": 80.69384615384615}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1295180619709075, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.112664199758459, "policy_loss": -0.014235523189960058, "vf_loss": 7.124157845532452, "vf_explained_var": 0.02625116772121853, "kl": 0.009139570919066212, "entropy": 1.5500342265007987, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8971158039948297, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.459480783926747, "policy_loss": -0.01427077464783988, "vf_loss": 7.471237029221953, "vf_explained_var": 0.01817580852559004, "kl": 0.012572810263116118, "entropy": 1.5504310618001949, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 375.0, "episode_reward_min": -12.0, "episode_reward_mean": 155.57, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -135.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 158.0}, "policy_reward_mean": {"prey_policy": 32.55, "predator_policy": 45.235}, "custom_metrics": {}, "hist_stats": {"episode_reward": [258.0, 202.0, 26.0, 5.0, 125.0, 158.0, 85.0, 57.0, 131.0, 49.0, 136.0, 0.0, 179.0, 19.0, 0.0, -12.0, -7.0, 18.0, 118.0, 338.0, 99.0, 5.0, 52.0, 76.0, 149.0, 178.0, 120.0, 216.0, 216.0, 126.0, 139.0, 357.0, 324.0, 198.0, 191.0, 117.0, 130.0, 97.0, 176.0, 178.0, 161.0, 161.0, 163.0, 171.0, 153.0, 61.0, 210.0, 171.0, 279.0, 271.0, 158.0, 375.0, 284.0, 114.0, 156.0, 254.0, 211.0, 262.0, 318.0, 288.0, 164.0, 158.0, 138.0, 156.0, 247.0, 167.0, 279.0, 78.0, 0.0, 111.0, 369.0, 82.0, 222.0, 145.0, 169.0, 136.0, 301.0, 137.0, 0.0, 139.0, 106.0, 172.0, 96.0, 131.0, 110.0, 82.0, 162.0, 232.0, 243.0, 74.0, 188.0, 130.0, 244.0, 122.0, 103.0, 299.0, 83.0, 249.0, 92.0, 191.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [154.0, 100.0, 55.0, 103.0, -101.0, -15.0, -55.0, -2.0, 89.0, -17.0, 75.0, 26.0, -25.0, -79.0, -9.0, -75.0, -2.0, 71.0, 48.0, -28.0, 22.0, 35.0, -40.0, -10.0, 17.0, 156.0, -7.0, -42.0, 0.0, -56.0, -135.0, -35.0, -14.0, -50.0, 0.0, 16.0, -31.0, -25.0, 109.0, 186.0, -1.0, 80.0, 0.0, 3.0, 0.0, -9.0, 52.0, -67.0, -120.0, 88.0, -74.0, 74.0, 2.0, 36.0, 48.0, 148.0, 15.0, 87.0, 126.0, -8.0, 0.0, 57.0, 185.0, 148.0, 172.0, 89.0, 83.0, 33.0, 109.0, 74.0, 29.0, 0.0, -34.0, -71.0, -95.0, -33.0, 118.0, -16.0, -61.0, 178.0, -62.0, 63.0, 0.0, 112.0, 0.0, 155.0, 27.0, 76.0, -31.0, 137.0, 0.0, -33.0, -15.0, 111.0, -56.0, 88.0, 53.0, 157.0, 134.0, 29.0, -78.0, 35.0, 200.0, 173.0, 2.0, 180.0, 103.0, -60.0, 115.0, -11.0, 6.0, 20.0, 66.0, -118.0, 25.0, 128.0, 156.0, 101.0, 117.0, 116.0, 127.0, 5.0, -57.0, 54.0, 79.0, 0.0, 6.0, 28.0, 5.0, 97.0, 0.0, 166.0, 57.0, 86.0, -44.0, -44.0, 0.0, 0.0, 18.0, 0.0, 143.0, 198.0, -62.0, 0.0, 107.0, 51.0, 21.0, -14.0, -1.0, 162.0, 0.0, 132.0, 128.0, 62.0, 0.0, 12.0, -4.0, 0.0, 0.0, 31.0, 91.0, -23.0, 139.0, 0.0, 0.0, 56.0, 0.0, -34.0, -48.0, -20.0, 0.0, -50.0, 0.0, 70.0, 102.0, -3.0, 74.0, 39.0, -55.0, 0.0, 102.0, 26.0, -61.0, -29.0, 14.0, 108.0, 36.0, 0.0, 47.0, 0.0, 161.0, 75.0, -49.0, -1.0, 118.0, 36.0, -28.0, 20.0, -3.0, -24.0], "policy_predator_policy_reward": [4.0, 0.0, 0.0, 44.0, 131.0, 11.0, 0.0, 62.0, 16.0, 37.0, 25.0, 32.0, 103.0, 86.0, 75.0, 66.0, 32.0, 30.0, 28.0, 1.0, 0.0, 79.0, 0.0, 50.0, 1.0, 5.0, 41.0, 27.0, 56.0, 0.0, 158.0, 0.0, 57.0, 0.0, 0.0, 2.0, 104.0, 70.0, 31.0, 12.0, 18.0, 2.0, 2.0, 0.0, 61.0, 0.0, 0.0, 91.0, 44.0, 137.0, 127.0, 51.0, 82.0, 0.0, 20.0, 0.0, 108.0, 6.0, 8.0, 0.0, 57.0, 25.0, 17.0, 7.0, 51.0, 12.0, 77.0, 5.0, 8.0, 0.0, 70.0, 18.0, 109.0, 126.0, 86.0, 139.0, 24.0, 50.0, 0.0, 61.0, 62.0, 98.0, 7.0, 42.0, 0.0, 8.0, 0.0, 68.0, 0.0, 47.0, 31.0, 63.0, 28.0, 86.0, 102.0, 37.0, 69.0, 0.0, 0.0, 108.0, 111.0, 90.0, 2.0, 0.0, 0.0, 102.0, 0.0, 71.0, 52.0, 0.0, 111.0, 117.0, 129.0, 134.0, 50.0, 59.0, 19.0, 42.0, 40.0, 15.0, 30.0, 2.0, 75.0, 86.0, 45.0, 14.0, 15.0, 107.0, 108.0, 37.0, 1.0, 0.0, 61.0, 75.0, 36.0, 130.0, 0.0, 0.0, 27.0, 66.0, 0.0, 28.0, 59.0, 85.0, 0.0, 64.0, 85.0, 53.0, 1.0, 7.0, 1.0, 3.0, 59.0, 52.0, 64.0, 61.0, 0.0, 4.0, 58.0, 50.0, 26.0, 12.0, 18.0, 15.0, 35.0, 5.0, 61.0, 104.0, 54.0, 124.0, 18.0, 114.0, 47.0, 45.0, 74.0, 59.0, 78.0, 52.0, 125.0, 4.0, 29.0, 31.0, 95.0, 125.0, 29.0, 93.0, 17.0, 69.0, 0.0, 56.0, 36.0, 27.0, 110.0, 23.0, 51.0, 44.0, 58.0, 42.0, 107.0, 111.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6470269628893089, "mean_inference_ms": 1.5161686567746644, "mean_action_processing_ms": 0.2687164163773012, "mean_env_wait_ms": 0.20119921034181756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056029558181762695, "StateBufferConnector_ms": 0.0028589963912963867, "ViewRequirementAgentConnector_ms": 0.08782029151916504}, "num_episodes": 18, "episode_return_max": 375.0, "episode_return_min": -12.0, "episode_return_mean": 155.57, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 86.99554840223094, "num_env_steps_trained_throughput_per_sec": 86.99554840223094, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 47307.302, "restore_workers_time_ms": 0.031, "training_step_time_ms": 47307.235, "sample_time_ms": 1178.934, "learn_time_ms": 46106.872, "learn_throughput": 86.755, "synch_weights_time_ms": 16.1}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "51025_00000", "date": "2024-08-12_20-28-49", "timestamp": 1723508929, "time_this_iter_s": 46.008262157440186, "time_total_s": 284.0468199253082, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cb380d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 284.0468199253082, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 23.141538461538467, "ram_util_percent": 81.2046153846154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6029992786034075, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.504506836997138, "policy_loss": -0.013847477759712588, "vf_loss": 7.515777580069487, "vf_explained_var": -0.04289140956742423, "kl": 0.008589037377005419, "entropy": 1.5402615599531346, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9927300547165845, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.729995207054905, "policy_loss": -0.012738521346851947, "vf_loss": 8.740760428564888, "vf_explained_var": 0.015377660970839244, "kl": 0.00986657589767055, "entropy": 1.5308528089649462, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 375.0, "episode_reward_min": 0.0, "episode_reward_mean": 164.87, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -182.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 188.0}, "policy_reward_mean": {"prey_policy": 28.54, "predator_policy": 53.895}, "custom_metrics": {}, "hist_stats": {"episode_reward": [118.0, 338.0, 99.0, 5.0, 52.0, 76.0, 149.0, 178.0, 120.0, 216.0, 216.0, 126.0, 139.0, 357.0, 324.0, 198.0, 191.0, 117.0, 130.0, 97.0, 176.0, 178.0, 161.0, 161.0, 163.0, 171.0, 153.0, 61.0, 210.0, 171.0, 279.0, 271.0, 158.0, 375.0, 284.0, 114.0, 156.0, 254.0, 211.0, 262.0, 318.0, 288.0, 164.0, 158.0, 138.0, 156.0, 247.0, 167.0, 279.0, 78.0, 0.0, 111.0, 369.0, 82.0, 222.0, 145.0, 169.0, 136.0, 301.0, 137.0, 0.0, 139.0, 106.0, 172.0, 96.0, 131.0, 110.0, 82.0, 162.0, 232.0, 243.0, 74.0, 188.0, 130.0, 244.0, 122.0, 103.0, 299.0, 83.0, 249.0, 92.0, 191.0, 342.0, 124.0, 104.0, 18.0, 138.0, 232.0, 178.0, 116.0, 52.0, 164.0, 185.0, 136.0, 0.0, 67.0, 196.0, 57.0, 116.0, 134.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-31.0, -25.0, 109.0, 186.0, -1.0, 80.0, 0.0, 3.0, 0.0, -9.0, 52.0, -67.0, -120.0, 88.0, -74.0, 74.0, 2.0, 36.0, 48.0, 148.0, 15.0, 87.0, 126.0, -8.0, 0.0, 57.0, 185.0, 148.0, 172.0, 89.0, 83.0, 33.0, 109.0, 74.0, 29.0, 0.0, -34.0, -71.0, -95.0, -33.0, 118.0, -16.0, -61.0, 178.0, -62.0, 63.0, 0.0, 112.0, 0.0, 155.0, 27.0, 76.0, -31.0, 137.0, 0.0, -33.0, -15.0, 111.0, -56.0, 88.0, 53.0, 157.0, 134.0, 29.0, -78.0, 35.0, 200.0, 173.0, 2.0, 180.0, 103.0, -60.0, 115.0, -11.0, 6.0, 20.0, 66.0, -118.0, 25.0, 128.0, 156.0, 101.0, 117.0, 116.0, 127.0, 5.0, -57.0, 54.0, 79.0, 0.0, 6.0, 28.0, 5.0, 97.0, 0.0, 166.0, 57.0, 86.0, -44.0, -44.0, 0.0, 0.0, 18.0, 0.0, 143.0, 198.0, -62.0, 0.0, 107.0, 51.0, 21.0, -14.0, -1.0, 162.0, 0.0, 132.0, 128.0, 62.0, 0.0, 12.0, -4.0, 0.0, 0.0, 31.0, 91.0, -23.0, 139.0, 0.0, 0.0, 56.0, 0.0, -34.0, -48.0, -20.0, 0.0, -50.0, 0.0, 70.0, 102.0, -3.0, 74.0, 39.0, -55.0, 0.0, 102.0, 26.0, -61.0, -29.0, 14.0, 108.0, 36.0, 0.0, 47.0, 0.0, 161.0, 75.0, -49.0, -1.0, 118.0, 36.0, -28.0, 20.0, -3.0, -24.0, 165.0, 137.0, -1.0, 45.0, 0.0, 16.0, -93.0, -44.0, -154.0, -57.0, 82.0, -153.0, 2.0, 58.0, -2.0, -39.0, -89.0, -32.0, -182.0, 24.0, -75.0, 73.0, 111.0, -68.0, 0.0, 0.0, 0.0, -138.0, -54.0, 35.0, -83.0, 0.0, -101.0, 0.0, 11.0, -26.0], "policy_predator_policy_reward": [104.0, 70.0, 31.0, 12.0, 18.0, 2.0, 2.0, 0.0, 61.0, 0.0, 0.0, 91.0, 44.0, 137.0, 127.0, 51.0, 82.0, 0.0, 20.0, 0.0, 108.0, 6.0, 8.0, 0.0, 57.0, 25.0, 17.0, 7.0, 51.0, 12.0, 77.0, 5.0, 8.0, 0.0, 70.0, 18.0, 109.0, 126.0, 86.0, 139.0, 24.0, 50.0, 0.0, 61.0, 62.0, 98.0, 7.0, 42.0, 0.0, 8.0, 0.0, 68.0, 0.0, 47.0, 31.0, 63.0, 28.0, 86.0, 102.0, 37.0, 69.0, 0.0, 0.0, 108.0, 111.0, 90.0, 2.0, 0.0, 0.0, 102.0, 0.0, 71.0, 52.0, 0.0, 111.0, 117.0, 129.0, 134.0, 50.0, 59.0, 19.0, 42.0, 40.0, 15.0, 30.0, 2.0, 75.0, 86.0, 45.0, 14.0, 15.0, 107.0, 108.0, 37.0, 1.0, 0.0, 61.0, 75.0, 36.0, 130.0, 0.0, 0.0, 27.0, 66.0, 0.0, 28.0, 59.0, 85.0, 0.0, 64.0, 85.0, 53.0, 1.0, 7.0, 1.0, 3.0, 59.0, 52.0, 64.0, 61.0, 0.0, 4.0, 58.0, 50.0, 26.0, 12.0, 18.0, 15.0, 35.0, 5.0, 61.0, 104.0, 54.0, 124.0, 18.0, 114.0, 47.0, 45.0, 74.0, 59.0, 78.0, 52.0, 125.0, 4.0, 29.0, 31.0, 95.0, 125.0, 29.0, 93.0, 17.0, 69.0, 0.0, 56.0, 36.0, 27.0, 110.0, 23.0, 51.0, 44.0, 58.0, 42.0, 107.0, 111.0, 22.0, 18.0, 38.0, 42.0, 50.0, 38.0, 76.0, 79.0, 161.0, 188.0, 145.0, 158.0, 20.0, 98.0, 101.0, 56.0, 95.0, 78.0, 172.0, 150.0, 94.0, 93.0, 77.0, 16.0, 0.0, 0.0, 129.0, 76.0, 91.0, 124.0, 11.0, 129.0, 98.0, 119.0, 64.0, 85.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6307616886476964, "mean_inference_ms": 1.4629088428649129, "mean_action_processing_ms": 0.2590204674225153, "mean_env_wait_ms": 0.19402769117299187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056580305099487305, "StateBufferConnector_ms": 0.002897977828979492, "ViewRequirementAgentConnector_ms": 0.09513890743255615}, "num_episodes": 18, "episode_return_max": 375.0, "episode_return_min": 0.0, "episode_return_mean": 164.87, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 85.59788970984776, "num_env_steps_trained_throughput_per_sec": 85.59788970984776, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 47224.849, "restore_workers_time_ms": 0.028, "training_step_time_ms": 47224.785, "sample_time_ms": 1184.828, "learn_time_ms": 46018.58, "learn_throughput": 86.921, "synch_weights_time_ms": 15.851}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "51025_00000", "date": "2024-08-12_20-29-36", "timestamp": 1723508976, "time_this_iter_s": 46.76751899719238, "time_total_s": 330.8143389225006, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cb47790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 330.8143389225006, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 29.871641791044777, "ram_util_percent": 82.93582089552238}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.028880856213746, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.1151251285795185, "policy_loss": -0.015054381664512216, "vf_loss": 6.127894939442791, "vf_explained_var": -0.06964113797460283, "kl": 0.007615198602448684, "entropy": 1.5252118304292992, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.953778162456694, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.293529976991119, "policy_loss": -0.01657101529867206, "vf_loss": 7.307180459915646, "vf_explained_var": 0.02743676642261485, "kl": 0.014602767541868891, "entropy": 1.5134302839400275, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 375.0, "episode_reward_min": 0.0, "episode_reward_mean": 155.63, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -182.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 188.0}, "policy_reward_mean": {"prey_policy": 14.265, "predator_policy": 63.55}, "custom_metrics": {}, "hist_stats": {"episode_reward": [130.0, 97.0, 176.0, 178.0, 161.0, 161.0, 163.0, 171.0, 153.0, 61.0, 210.0, 171.0, 279.0, 271.0, 158.0, 375.0, 284.0, 114.0, 156.0, 254.0, 211.0, 262.0, 318.0, 288.0, 164.0, 158.0, 138.0, 156.0, 247.0, 167.0, 279.0, 78.0, 0.0, 111.0, 369.0, 82.0, 222.0, 145.0, 169.0, 136.0, 301.0, 137.0, 0.0, 139.0, 106.0, 172.0, 96.0, 131.0, 110.0, 82.0, 162.0, 232.0, 243.0, 74.0, 188.0, 130.0, 244.0, 122.0, 103.0, 299.0, 83.0, 249.0, 92.0, 191.0, 342.0, 124.0, 104.0, 18.0, 138.0, 232.0, 178.0, 116.0, 52.0, 164.0, 185.0, 136.0, 0.0, 67.0, 196.0, 57.0, 116.0, 134.0, 32.0, 72.0, 85.0, 91.0, 90.0, 119.0, 125.0, 181.0, 102.0, 135.0, 81.0, 53.0, 116.0, 117.0, 241.0, 114.0, 249.0, 92.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-34.0, -71.0, -95.0, -33.0, 118.0, -16.0, -61.0, 178.0, -62.0, 63.0, 0.0, 112.0, 0.0, 155.0, 27.0, 76.0, -31.0, 137.0, 0.0, -33.0, -15.0, 111.0, -56.0, 88.0, 53.0, 157.0, 134.0, 29.0, -78.0, 35.0, 200.0, 173.0, 2.0, 180.0, 103.0, -60.0, 115.0, -11.0, 6.0, 20.0, 66.0, -118.0, 25.0, 128.0, 156.0, 101.0, 117.0, 116.0, 127.0, 5.0, -57.0, 54.0, 79.0, 0.0, 6.0, 28.0, 5.0, 97.0, 0.0, 166.0, 57.0, 86.0, -44.0, -44.0, 0.0, 0.0, 18.0, 0.0, 143.0, 198.0, -62.0, 0.0, 107.0, 51.0, 21.0, -14.0, -1.0, 162.0, 0.0, 132.0, 128.0, 62.0, 0.0, 12.0, -4.0, 0.0, 0.0, 31.0, 91.0, -23.0, 139.0, 0.0, 0.0, 56.0, 0.0, -34.0, -48.0, -20.0, 0.0, -50.0, 0.0, 70.0, 102.0, -3.0, 74.0, 39.0, -55.0, 0.0, 102.0, 26.0, -61.0, -29.0, 14.0, 108.0, 36.0, 0.0, 47.0, 0.0, 161.0, 75.0, -49.0, -1.0, 118.0, 36.0, -28.0, 20.0, -3.0, -24.0, 165.0, 137.0, -1.0, 45.0, 0.0, 16.0, -93.0, -44.0, -154.0, -57.0, 82.0, -153.0, 2.0, 58.0, -2.0, -39.0, -89.0, -32.0, -182.0, 24.0, -75.0, 73.0, 111.0, -68.0, 0.0, 0.0, 0.0, -138.0, -54.0, 35.0, -83.0, 0.0, -101.0, 0.0, 11.0, -26.0, -148.0, -112.0, 0.0, -55.0, -139.0, -86.0, -23.0, 4.0, -125.0, -117.0, 8.0, -87.0, 0.0, 70.0, 71.0, -14.0, -1.0, -15.0, -45.0, 98.0, -12.0, -37.0, 0.0, -69.0, -4.0, -129.0, -69.0, 3.0, 93.0, -177.0, 0.0, 10.0, 46.0, -44.0, 0.0, -52.0], "policy_predator_policy_reward": [109.0, 126.0, 86.0, 139.0, 24.0, 50.0, 0.0, 61.0, 62.0, 98.0, 7.0, 42.0, 0.0, 8.0, 0.0, 68.0, 0.0, 47.0, 31.0, 63.0, 28.0, 86.0, 102.0, 37.0, 69.0, 0.0, 0.0, 108.0, 111.0, 90.0, 2.0, 0.0, 0.0, 102.0, 0.0, 71.0, 52.0, 0.0, 111.0, 117.0, 129.0, 134.0, 50.0, 59.0, 19.0, 42.0, 40.0, 15.0, 30.0, 2.0, 75.0, 86.0, 45.0, 14.0, 15.0, 107.0, 108.0, 37.0, 1.0, 0.0, 61.0, 75.0, 36.0, 130.0, 0.0, 0.0, 27.0, 66.0, 0.0, 28.0, 59.0, 85.0, 0.0, 64.0, 85.0, 53.0, 1.0, 7.0, 1.0, 3.0, 59.0, 52.0, 64.0, 61.0, 0.0, 4.0, 58.0, 50.0, 26.0, 12.0, 18.0, 15.0, 35.0, 5.0, 61.0, 104.0, 54.0, 124.0, 18.0, 114.0, 47.0, 45.0, 74.0, 59.0, 78.0, 52.0, 125.0, 4.0, 29.0, 31.0, 95.0, 125.0, 29.0, 93.0, 17.0, 69.0, 0.0, 56.0, 36.0, 27.0, 110.0, 23.0, 51.0, 44.0, 58.0, 42.0, 107.0, 111.0, 22.0, 18.0, 38.0, 42.0, 50.0, 38.0, 76.0, 79.0, 161.0, 188.0, 145.0, 158.0, 20.0, 98.0, 101.0, 56.0, 95.0, 78.0, 172.0, 150.0, 94.0, 93.0, 77.0, 16.0, 0.0, 0.0, 129.0, 76.0, 91.0, 124.0, 11.0, 129.0, 98.0, 119.0, 64.0, 85.0, 179.0, 113.0, 52.0, 75.0, 158.0, 152.0, 88.0, 22.0, 150.0, 182.0, 123.0, 75.0, 55.0, 0.0, 52.0, 72.0, 31.0, 87.0, 37.0, 45.0, 34.0, 96.0, 37.0, 85.0, 115.0, 134.0, 76.0, 107.0, 175.0, 150.0, 82.0, 22.0, 158.0, 89.0, 81.0, 63.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6206933324768799, "mean_inference_ms": 1.4343532717138678, "mean_action_processing_ms": 0.2534755193077667, "mean_env_wait_ms": 0.19072423215462206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005112648010253906, "StateBufferConnector_ms": 0.0029064416885375977, "ViewRequirementAgentConnector_ms": 0.09543871879577637}, "num_episodes": 18, "episode_return_max": 375.0, "episode_return_min": 0.0, "episode_return_mean": 155.63, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 87.74685014987013, "num_env_steps_trained_throughput_per_sec": 87.74685014987013, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 47019.955, "restore_workers_time_ms": 0.027, "training_step_time_ms": 47019.892, "sample_time_ms": 1179.485, "learn_time_ms": 45819.883, "learn_throughput": 87.298, "synch_weights_time_ms": 15.476}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "51025_00000", "date": "2024-08-12_20-30-22", "timestamp": 1723509022, "time_this_iter_s": 45.609139919281006, "time_total_s": 376.4234788417816, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1580269d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 376.4234788417816, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 22.5078125, "ram_util_percent": 83.02031250000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.216121572918362, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.759890876749836, "policy_loss": -0.016071758010774536, "vf_loss": 6.773179442794235, "vf_explained_var": 0.012790498941663711, "kl": 0.009277291595720839, "entropy": 1.4984101074713247, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.835213807083312, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.900959343128103, "policy_loss": -0.012813706460739017, "vf_loss": 6.9117856474780535, "vf_explained_var": 0.03197023600497574, "kl": 0.009936949636841514, "entropy": 1.507976586919613, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 369.0, "episode_reward_min": -31.0, "episode_reward_mean": 139.78, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -182.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.0, "predator_policy": 188.0}, "policy_reward_mean": {"prey_policy": 6.095, "predator_policy": 63.795}, "custom_metrics": {}, "hist_stats": {"episode_reward": [318.0, 288.0, 164.0, 158.0, 138.0, 156.0, 247.0, 167.0, 279.0, 78.0, 0.0, 111.0, 369.0, 82.0, 222.0, 145.0, 169.0, 136.0, 301.0, 137.0, 0.0, 139.0, 106.0, 172.0, 96.0, 131.0, 110.0, 82.0, 162.0, 232.0, 243.0, 74.0, 188.0, 130.0, 244.0, 122.0, 103.0, 299.0, 83.0, 249.0, 92.0, 191.0, 342.0, 124.0, 104.0, 18.0, 138.0, 232.0, 178.0, 116.0, 52.0, 164.0, 185.0, 136.0, 0.0, 67.0, 196.0, 57.0, 116.0, 134.0, 32.0, 72.0, 85.0, 91.0, 90.0, 119.0, 125.0, 181.0, 102.0, 135.0, 81.0, 53.0, 116.0, 117.0, 241.0, 114.0, 249.0, 92.0, 136.0, 240.0, 248.0, 172.0, 166.0, -31.0, 0.0, 7.0, 87.0, 236.0, 33.0, 147.0, 0.0, 103.0, 115.0, 136.0, 146.0, 152.0, 119.0, 188.0, 67.0, 144.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [156.0, 101.0, 117.0, 116.0, 127.0, 5.0, -57.0, 54.0, 79.0, 0.0, 6.0, 28.0, 5.0, 97.0, 0.0, 166.0, 57.0, 86.0, -44.0, -44.0, 0.0, 0.0, 18.0, 0.0, 143.0, 198.0, -62.0, 0.0, 107.0, 51.0, 21.0, -14.0, -1.0, 162.0, 0.0, 132.0, 128.0, 62.0, 0.0, 12.0, -4.0, 0.0, 0.0, 31.0, 91.0, -23.0, 139.0, 0.0, 0.0, 56.0, 0.0, -34.0, -48.0, -20.0, 0.0, -50.0, 0.0, 70.0, 102.0, -3.0, 74.0, 39.0, -55.0, 0.0, 102.0, 26.0, -61.0, -29.0, 14.0, 108.0, 36.0, 0.0, 47.0, 0.0, 161.0, 75.0, -49.0, -1.0, 118.0, 36.0, -28.0, 20.0, -3.0, -24.0, 165.0, 137.0, -1.0, 45.0, 0.0, 16.0, -93.0, -44.0, -154.0, -57.0, 82.0, -153.0, 2.0, 58.0, -2.0, -39.0, -89.0, -32.0, -182.0, 24.0, -75.0, 73.0, 111.0, -68.0, 0.0, 0.0, 0.0, -138.0, -54.0, 35.0, -83.0, 0.0, -101.0, 0.0, 11.0, -26.0, -148.0, -112.0, 0.0, -55.0, -139.0, -86.0, -23.0, 4.0, -125.0, -117.0, 8.0, -87.0, 0.0, 70.0, 71.0, -14.0, -1.0, -15.0, -45.0, 98.0, -12.0, -37.0, 0.0, -69.0, -4.0, -129.0, -69.0, 3.0, 93.0, -177.0, 0.0, 10.0, 46.0, -44.0, 0.0, -52.0, -89.0, 0.0, 52.0, 66.0, 49.0, -19.0, -47.0, 12.0, 138.0, 0.0, -168.0, -176.0, 0.0, 0.0, 0.0, -51.0, 0.0, -73.0, 91.0, 81.0, -11.0, -110.0, -39.0, 46.0, 0.0, 0.0, -10.0, 0.0, -7.0, 99.0, 108.0, 0.0, 0.0, 103.0, 128.0, 0.0, 7.0, -14.0, 87.0, 2.0, -92.0, -5.0, -19.0, -56.0], "policy_predator_policy_reward": [19.0, 42.0, 40.0, 15.0, 30.0, 2.0, 75.0, 86.0, 45.0, 14.0, 15.0, 107.0, 108.0, 37.0, 1.0, 0.0, 61.0, 75.0, 36.0, 130.0, 0.0, 0.0, 27.0, 66.0, 0.0, 28.0, 59.0, 85.0, 0.0, 64.0, 85.0, 53.0, 1.0, 7.0, 1.0, 3.0, 59.0, 52.0, 64.0, 61.0, 0.0, 4.0, 58.0, 50.0, 26.0, 12.0, 18.0, 15.0, 35.0, 5.0, 61.0, 104.0, 54.0, 124.0, 18.0, 114.0, 47.0, 45.0, 74.0, 59.0, 78.0, 52.0, 125.0, 4.0, 29.0, 31.0, 95.0, 125.0, 29.0, 93.0, 17.0, 69.0, 0.0, 56.0, 36.0, 27.0, 110.0, 23.0, 51.0, 44.0, 58.0, 42.0, 107.0, 111.0, 22.0, 18.0, 38.0, 42.0, 50.0, 38.0, 76.0, 79.0, 161.0, 188.0, 145.0, 158.0, 20.0, 98.0, 101.0, 56.0, 95.0, 78.0, 172.0, 150.0, 94.0, 93.0, 77.0, 16.0, 0.0, 0.0, 129.0, 76.0, 91.0, 124.0, 11.0, 129.0, 98.0, 119.0, 64.0, 85.0, 179.0, 113.0, 52.0, 75.0, 158.0, 152.0, 88.0, 22.0, 150.0, 182.0, 123.0, 75.0, 55.0, 0.0, 52.0, 72.0, 31.0, 87.0, 37.0, 45.0, 34.0, 96.0, 37.0, 85.0, 115.0, 134.0, 76.0, 107.0, 175.0, 150.0, 82.0, 22.0, 158.0, 89.0, 81.0, 63.0, 135.0, 90.0, 70.0, 52.0, 95.0, 123.0, 126.0, 81.0, 0.0, 28.0, 126.0, 187.0, 0.0, 0.0, 58.0, 0.0, 117.0, 43.0, 64.0, 0.0, 128.0, 26.0, 62.0, 78.0, 0.0, 0.0, 72.0, 41.0, 23.0, 0.0, 13.0, 15.0, 10.0, 33.0, 0.0, 24.0, 4.0, 122.0, 0.0, 99.0, 96.0, 68.0, 161.0, 58.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6181674832828125, "mean_inference_ms": 1.4178577512377046, "mean_action_processing_ms": 0.2501463157289862, "mean_env_wait_ms": 0.1885828101548703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004709362983703613, "StateBufferConnector_ms": 0.003242015838623047, "ViewRequirementAgentConnector_ms": 0.11777770519256592}, "num_episodes": 22, "episode_return_max": 369.0, "episode_return_min": -31.0, "episode_return_mean": 139.78, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 87.13138651350533, "num_env_steps_trained_throughput_per_sec": 87.13138651350533, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 46896.37, "restore_workers_time_ms": 0.025, "training_step_time_ms": 46896.309, "sample_time_ms": 1184.113, "learn_time_ms": 45691.999, "learn_throughput": 87.543, "synch_weights_time_ms": 15.145}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 9, "trial_id": "51025_00000", "date": "2024-08-12_20-31-08", "timestamp": 1723509068, "time_this_iter_s": 45.952422857284546, "time_total_s": 422.37590169906616, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cb4e430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 422.37590169906616, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 22.9530303030303, "ram_util_percent": 82.61818181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.428845244519925, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.859398885504909, "policy_loss": -0.01304346206474793, "vf_loss": 5.8701411643356245, "vf_explained_var": 0.05568401513907014, "kl": 0.007670625738075143, "entropy": 1.4923420638003677, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.173194119665358, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.3248148620444, "policy_loss": -0.01385151022483432, "vf_loss": 6.336352789086639, "vf_explained_var": 0.008523291286337312, "kl": 0.01156799000445253, "entropy": 1.4883286481811886, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 342.0, "episode_reward_min": -31.0, "episode_reward_mean": 135.92, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -182.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.0, "predator_policy": 188.0}, "policy_reward_mean": {"prey_policy": 0.7, "predator_policy": 67.26}, "custom_metrics": {}, "hist_stats": {"episode_reward": [172.0, 96.0, 131.0, 110.0, 82.0, 162.0, 232.0, 243.0, 74.0, 188.0, 130.0, 244.0, 122.0, 103.0, 299.0, 83.0, 249.0, 92.0, 191.0, 342.0, 124.0, 104.0, 18.0, 138.0, 232.0, 178.0, 116.0, 52.0, 164.0, 185.0, 136.0, 0.0, 67.0, 196.0, 57.0, 116.0, 134.0, 32.0, 72.0, 85.0, 91.0, 90.0, 119.0, 125.0, 181.0, 102.0, 135.0, 81.0, 53.0, 116.0, 117.0, 241.0, 114.0, 249.0, 92.0, 136.0, 240.0, 248.0, 172.0, 166.0, -31.0, 0.0, 7.0, 87.0, 236.0, 33.0, 147.0, 0.0, 103.0, 115.0, 136.0, 146.0, 152.0, 119.0, 188.0, 67.0, 144.0, 37.0, 192.0, 304.0, 267.0, 266.0, 82.0, 174.0, 94.0, 198.0, 247.0, 190.0, 236.0, 0.0, 44.0, 131.0, 126.0, 0.0, 129.0, 125.0, 217.0, 204.0, 0.0, 261.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [139.0, 0.0, 0.0, 56.0, 0.0, -34.0, -48.0, -20.0, 0.0, -50.0, 0.0, 70.0, 102.0, -3.0, 74.0, 39.0, -55.0, 0.0, 102.0, 26.0, -61.0, -29.0, 14.0, 108.0, 36.0, 0.0, 47.0, 0.0, 161.0, 75.0, -49.0, -1.0, 118.0, 36.0, -28.0, 20.0, -3.0, -24.0, 165.0, 137.0, -1.0, 45.0, 0.0, 16.0, -93.0, -44.0, -154.0, -57.0, 82.0, -153.0, 2.0, 58.0, -2.0, -39.0, -89.0, -32.0, -182.0, 24.0, -75.0, 73.0, 111.0, -68.0, 0.0, 0.0, 0.0, -138.0, -54.0, 35.0, -83.0, 0.0, -101.0, 0.0, 11.0, -26.0, -148.0, -112.0, 0.0, -55.0, -139.0, -86.0, -23.0, 4.0, -125.0, -117.0, 8.0, -87.0, 0.0, 70.0, 71.0, -14.0, -1.0, -15.0, -45.0, 98.0, -12.0, -37.0, 0.0, -69.0, -4.0, -129.0, -69.0, 3.0, 93.0, -177.0, 0.0, 10.0, 46.0, -44.0, 0.0, -52.0, -89.0, 0.0, 52.0, 66.0, 49.0, -19.0, -47.0, 12.0, 138.0, 0.0, -168.0, -176.0, 0.0, 0.0, 0.0, -51.0, 0.0, -73.0, 91.0, 81.0, -11.0, -110.0, -39.0, 46.0, 0.0, 0.0, -10.0, 0.0, -7.0, 99.0, 108.0, 0.0, 0.0, 103.0, 128.0, 0.0, 7.0, -14.0, 87.0, 2.0, -92.0, -5.0, -19.0, -56.0, 10.0, 0.0, -47.0, 32.0, 179.0, 55.0, 22.0, 113.0, 118.0, 4.0, -7.0, -41.0, 157.0, -1.0, -43.0, 0.0, 52.0, -142.0, -74.0, 137.0, 54.0, 12.0, 55.0, -10.0, 0.0, 0.0, 0.0, -153.0, -1.0, 51.0, -1.0, 65.0, 0.0, -18.0, -50.0, 90.0, 39.0, 0.0, 39.0, 15.0, 75.0, 71.0, 0.0, 0.0, 85.0, 86.0], "policy_predator_policy_reward": [18.0, 15.0, 35.0, 5.0, 61.0, 104.0, 54.0, 124.0, 18.0, 114.0, 47.0, 45.0, 74.0, 59.0, 78.0, 52.0, 125.0, 4.0, 29.0, 31.0, 95.0, 125.0, 29.0, 93.0, 17.0, 69.0, 0.0, 56.0, 36.0, 27.0, 110.0, 23.0, 51.0, 44.0, 58.0, 42.0, 107.0, 111.0, 22.0, 18.0, 38.0, 42.0, 50.0, 38.0, 76.0, 79.0, 161.0, 188.0, 145.0, 158.0, 20.0, 98.0, 101.0, 56.0, 95.0, 78.0, 172.0, 150.0, 94.0, 93.0, 77.0, 16.0, 0.0, 0.0, 129.0, 76.0, 91.0, 124.0, 11.0, 129.0, 98.0, 119.0, 64.0, 85.0, 179.0, 113.0, 52.0, 75.0, 158.0, 152.0, 88.0, 22.0, 150.0, 182.0, 123.0, 75.0, 55.0, 0.0, 52.0, 72.0, 31.0, 87.0, 37.0, 45.0, 34.0, 96.0, 37.0, 85.0, 115.0, 134.0, 76.0, 107.0, 175.0, 150.0, 82.0, 22.0, 158.0, 89.0, 81.0, 63.0, 135.0, 90.0, 70.0, 52.0, 95.0, 123.0, 126.0, 81.0, 0.0, 28.0, 126.0, 187.0, 0.0, 0.0, 58.0, 0.0, 117.0, 43.0, 64.0, 0.0, 128.0, 26.0, 62.0, 78.0, 0.0, 0.0, 72.0, 41.0, 23.0, 0.0, 13.0, 15.0, 10.0, 33.0, 0.0, 24.0, 4.0, 122.0, 0.0, 99.0, 96.0, 68.0, 161.0, 58.0, 7.0, 20.0, 105.0, 102.0, 33.0, 37.0, 63.0, 69.0, 68.0, 76.0, 42.0, 88.0, 15.0, 3.0, 57.0, 80.0, 151.0, 137.0, 98.0, 86.0, 58.0, 66.0, 89.0, 102.0, 0.0, 0.0, 156.0, 41.0, 67.0, 14.0, 1.0, 61.0, 18.0, 0.0, 32.0, 57.0, 53.0, 33.0, 76.0, 87.0, 58.0, 0.0, 0.0, 0.0, 19.0, 71.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.615038182202481, "mean_inference_ms": 1.4088791272051815, "mean_action_processing_ms": 0.248126427914696, "mean_env_wait_ms": 0.18727805940028205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004103541374206543, "StateBufferConnector_ms": 0.0039042234420776367, "ViewRequirementAgentConnector_ms": 0.12087810039520264}, "num_episodes": 23, "episode_return_max": 342.0, "episode_return_min": -31.0, "episode_return_mean": 135.92, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 87.03725286014495, "num_env_steps_trained_throughput_per_sec": 87.03725286014495, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 46802.467, "restore_workers_time_ms": 0.024, "training_step_time_ms": 46802.407, "sample_time_ms": 1170.41, "learn_time_ms": 45612.229, "learn_throughput": 87.696, "synch_weights_time_ms": 15.085}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 10, "trial_id": "51025_00000", "date": "2024-08-12_20-31-54", "timestamp": 1723509114, "time_this_iter_s": 46.02406978607178, "time_total_s": 468.39997148513794, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cb47790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 468.39997148513794, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 22.623076923076923, "ram_util_percent": 81.52769230769229}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1913244305779696, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.967759256766587, "policy_loss": -0.012143046636917879, "vf_loss": 5.977340475465885, "vf_explained_var": -0.06014735023811381, "kl": 0.008539445636392879, "entropy": 1.4939487690648074, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.829829797605989, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.081312183097557, "policy_loss": -0.013178339914206869, "vf_loss": 7.092130970324158, "vf_explained_var": 0.023386778560265033, "kl": 0.011797744714132702, "entropy": 1.4865922510308562, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 342.0, "episode_reward_min": -31.0, "episode_reward_mean": 124.55, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -182.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.0, "predator_policy": 189.0}, "policy_reward_mean": {"prey_policy": -10.01, "predator_policy": 72.285}, "custom_metrics": {}, "hist_stats": {"episode_reward": [191.0, 342.0, 124.0, 104.0, 18.0, 138.0, 232.0, 178.0, 116.0, 52.0, 164.0, 185.0, 136.0, 0.0, 67.0, 196.0, 57.0, 116.0, 134.0, 32.0, 72.0, 85.0, 91.0, 90.0, 119.0, 125.0, 181.0, 102.0, 135.0, 81.0, 53.0, 116.0, 117.0, 241.0, 114.0, 249.0, 92.0, 136.0, 240.0, 248.0, 172.0, 166.0, -31.0, 0.0, 7.0, 87.0, 236.0, 33.0, 147.0, 0.0, 103.0, 115.0, 136.0, 146.0, 152.0, 119.0, 188.0, 67.0, 144.0, 37.0, 192.0, 304.0, 267.0, 266.0, 82.0, 174.0, 94.0, 198.0, 247.0, 190.0, 236.0, 0.0, 44.0, 131.0, 126.0, 0.0, 129.0, 125.0, 217.0, 204.0, 0.0, 261.0, 18.0, 121.0, 0.0, 129.0, 18.0, 144.0, 41.0, 94.0, 40.0, 131.0, 234.0, 113.0, 67.0, 164.0, 157.0, 122.0, 12.0, 70.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-3.0, -24.0, 165.0, 137.0, -1.0, 45.0, 0.0, 16.0, -93.0, -44.0, -154.0, -57.0, 82.0, -153.0, 2.0, 58.0, -2.0, -39.0, -89.0, -32.0, -182.0, 24.0, -75.0, 73.0, 111.0, -68.0, 0.0, 0.0, 0.0, -138.0, -54.0, 35.0, -83.0, 0.0, -101.0, 0.0, 11.0, -26.0, -148.0, -112.0, 0.0, -55.0, -139.0, -86.0, -23.0, 4.0, -125.0, -117.0, 8.0, -87.0, 0.0, 70.0, 71.0, -14.0, -1.0, -15.0, -45.0, 98.0, -12.0, -37.0, 0.0, -69.0, -4.0, -129.0, -69.0, 3.0, 93.0, -177.0, 0.0, 10.0, 46.0, -44.0, 0.0, -52.0, -89.0, 0.0, 52.0, 66.0, 49.0, -19.0, -47.0, 12.0, 138.0, 0.0, -168.0, -176.0, 0.0, 0.0, 0.0, -51.0, 0.0, -73.0, 91.0, 81.0, -11.0, -110.0, -39.0, 46.0, 0.0, 0.0, -10.0, 0.0, -7.0, 99.0, 108.0, 0.0, 0.0, 103.0, 128.0, 0.0, 7.0, -14.0, 87.0, 2.0, -92.0, -5.0, -19.0, -56.0, 10.0, 0.0, -47.0, 32.0, 179.0, 55.0, 22.0, 113.0, 118.0, 4.0, -7.0, -41.0, 157.0, -1.0, -43.0, 0.0, 52.0, -142.0, -74.0, 137.0, 54.0, 12.0, 55.0, -10.0, 0.0, 0.0, 0.0, -153.0, -1.0, 51.0, -1.0, 65.0, 0.0, -18.0, -50.0, 90.0, 39.0, 0.0, 39.0, 15.0, 75.0, 71.0, 0.0, 0.0, 85.0, 86.0, -165.0, -120.0, 0.0, -20.0, 0.0, 0.0, -4.0, -157.0, -146.0, -123.0, 0.0, -86.0, -160.0, -117.0, -44.0, -32.0, -98.0, -14.0, 69.0, 0.0, 111.0, 68.0, 0.0, 46.0, -95.0, -63.0, 54.0, -134.0, 127.0, 0.0, -116.0, -9.0, 0.0, -23.0, -46.0, 0.0], "policy_predator_policy_reward": [107.0, 111.0, 22.0, 18.0, 38.0, 42.0, 50.0, 38.0, 76.0, 79.0, 161.0, 188.0, 145.0, 158.0, 20.0, 98.0, 101.0, 56.0, 95.0, 78.0, 172.0, 150.0, 94.0, 93.0, 77.0, 16.0, 0.0, 0.0, 129.0, 76.0, 91.0, 124.0, 11.0, 129.0, 98.0, 119.0, 64.0, 85.0, 179.0, 113.0, 52.0, 75.0, 158.0, 152.0, 88.0, 22.0, 150.0, 182.0, 123.0, 75.0, 55.0, 0.0, 52.0, 72.0, 31.0, 87.0, 37.0, 45.0, 34.0, 96.0, 37.0, 85.0, 115.0, 134.0, 76.0, 107.0, 175.0, 150.0, 82.0, 22.0, 158.0, 89.0, 81.0, 63.0, 135.0, 90.0, 70.0, 52.0, 95.0, 123.0, 126.0, 81.0, 0.0, 28.0, 126.0, 187.0, 0.0, 0.0, 58.0, 0.0, 117.0, 43.0, 64.0, 0.0, 128.0, 26.0, 62.0, 78.0, 0.0, 0.0, 72.0, 41.0, 23.0, 0.0, 13.0, 15.0, 10.0, 33.0, 0.0, 24.0, 4.0, 122.0, 0.0, 99.0, 96.0, 68.0, 161.0, 58.0, 7.0, 20.0, 105.0, 102.0, 33.0, 37.0, 63.0, 69.0, 68.0, 76.0, 42.0, 88.0, 15.0, 3.0, 57.0, 80.0, 151.0, 137.0, 98.0, 86.0, 58.0, 66.0, 89.0, 102.0, 0.0, 0.0, 156.0, 41.0, 67.0, 14.0, 1.0, 61.0, 18.0, 0.0, 32.0, 57.0, 53.0, 33.0, 76.0, 87.0, 58.0, 0.0, 0.0, 0.0, 19.0, 71.0, 114.0, 189.0, 54.0, 87.0, 0.0, 0.0, 126.0, 164.0, 101.0, 186.0, 113.0, 117.0, 141.0, 177.0, 109.0, 61.0, 84.0, 68.0, 35.0, 27.0, 18.0, 37.0, 62.0, 5.0, 116.0, 109.0, 149.0, 95.0, 0.0, 30.0, 140.0, 107.0, 0.0, 35.0, 23.0, 93.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.614596158411582, "mean_inference_ms": 1.4056181730920172, "mean_action_processing_ms": 0.24717497434374805, "mean_env_wait_ms": 0.18671394944671685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004159212112426758, "StateBufferConnector_ms": 0.003901362419128418, "ViewRequirementAgentConnector_ms": 0.12035298347473145}, "num_episodes": 18, "episode_return_max": 342.0, "episode_return_min": -31.0, "episode_return_mean": 124.55, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.42230844669777, "num_env_steps_trained_throughput_per_sec": 88.42230844669777, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 46306.473, "restore_workers_time_ms": 0.014, "training_step_time_ms": 46306.425, "sample_time_ms": 1105.524, "learn_time_ms": 45181.455, "learn_throughput": 88.532, "synch_weights_time_ms": 15.015}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 11, "trial_id": "51025_00000", "date": "2024-08-12_20-32-39", "timestamp": 1723509159, "time_this_iter_s": 45.26502299308777, "time_total_s": 513.6649944782257, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cb4adc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 513.6649944782257, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 21.7890625, "ram_util_percent": 81.7375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3384806296497427, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.613848940026823, "policy_loss": -0.01885364453675393, "vf_loss": 6.628982284081676, "vf_explained_var": 0.10319284765177934, "kl": 0.012400984237569293, "entropy": 1.4934649232834105, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.204097635973067, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.526220491701964, "policy_loss": -0.011713707380528961, "vf_loss": 5.53584721643458, "vf_explained_var": 0.01964361311266662, "kl": 0.010434948285177133, "entropy": 1.4771545154077035, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 316.0, "episode_reward_min": -31.0, "episode_reward_mean": 128.13, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -177.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.0, "predator_policy": 189.0}, "policy_reward_mean": {"prey_policy": -1.82, "predator_policy": 65.885}, "custom_metrics": {}, "hist_stats": {"episode_reward": [134.0, 32.0, 72.0, 85.0, 91.0, 90.0, 119.0, 125.0, 181.0, 102.0, 135.0, 81.0, 53.0, 116.0, 117.0, 241.0, 114.0, 249.0, 92.0, 136.0, 240.0, 248.0, 172.0, 166.0, -31.0, 0.0, 7.0, 87.0, 236.0, 33.0, 147.0, 0.0, 103.0, 115.0, 136.0, 146.0, 152.0, 119.0, 188.0, 67.0, 144.0, 37.0, 192.0, 304.0, 267.0, 266.0, 82.0, 174.0, 94.0, 198.0, 247.0, 190.0, 236.0, 0.0, 44.0, 131.0, 126.0, 0.0, 129.0, 125.0, 217.0, 204.0, 0.0, 261.0, 18.0, 121.0, 0.0, 129.0, 18.0, 144.0, 41.0, 94.0, 40.0, 131.0, 234.0, 113.0, 67.0, 164.0, 157.0, 122.0, 12.0, 70.0, 72.0, 264.0, 242.0, 315.0, 0.0, 153.0, 24.0, 63.0, 118.0, 289.0, 174.0, 316.0, 168.0, 278.0, 67.0, 0.0, 189.0, 42.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [11.0, -26.0, -148.0, -112.0, 0.0, -55.0, -139.0, -86.0, -23.0, 4.0, -125.0, -117.0, 8.0, -87.0, 0.0, 70.0, 71.0, -14.0, -1.0, -15.0, -45.0, 98.0, -12.0, -37.0, 0.0, -69.0, -4.0, -129.0, -69.0, 3.0, 93.0, -177.0, 0.0, 10.0, 46.0, -44.0, 0.0, -52.0, -89.0, 0.0, 52.0, 66.0, 49.0, -19.0, -47.0, 12.0, 138.0, 0.0, -168.0, -176.0, 0.0, 0.0, 0.0, -51.0, 0.0, -73.0, 91.0, 81.0, -11.0, -110.0, -39.0, 46.0, 0.0, 0.0, -10.0, 0.0, -7.0, 99.0, 108.0, 0.0, 0.0, 103.0, 128.0, 0.0, 7.0, -14.0, 87.0, 2.0, -92.0, -5.0, -19.0, -56.0, 10.0, 0.0, -47.0, 32.0, 179.0, 55.0, 22.0, 113.0, 118.0, 4.0, -7.0, -41.0, 157.0, -1.0, -43.0, 0.0, 52.0, -142.0, -74.0, 137.0, 54.0, 12.0, 55.0, -10.0, 0.0, 0.0, 0.0, -153.0, -1.0, 51.0, -1.0, 65.0, 0.0, -18.0, -50.0, 90.0, 39.0, 0.0, 39.0, 15.0, 75.0, 71.0, 0.0, 0.0, 85.0, 86.0, -165.0, -120.0, 0.0, -20.0, 0.0, 0.0, -4.0, -157.0, -146.0, -123.0, 0.0, -86.0, -160.0, -117.0, -44.0, -32.0, -98.0, -14.0, 69.0, 0.0, 111.0, 68.0, 0.0, 46.0, -95.0, -63.0, 54.0, -134.0, 127.0, 0.0, -116.0, -9.0, 0.0, -23.0, -46.0, 0.0, 38.0, -3.0, 161.0, -153.0, 83.0, 112.0, -112.0, 148.0, 0.0, 0.0, 9.0, -114.0, -41.0, 0.0, 27.0, 0.0, 0.0, -45.0, 149.0, 99.0, 0.0, 151.0, 93.0, 146.0, 149.0, 0.0, 101.0, 176.0, -157.0, 0.0, 0.0, -18.0, 179.0, -5.0, -131.0, -48.0], "policy_predator_policy_reward": [64.0, 85.0, 179.0, 113.0, 52.0, 75.0, 158.0, 152.0, 88.0, 22.0, 150.0, 182.0, 123.0, 75.0, 55.0, 0.0, 52.0, 72.0, 31.0, 87.0, 37.0, 45.0, 34.0, 96.0, 37.0, 85.0, 115.0, 134.0, 76.0, 107.0, 175.0, 150.0, 82.0, 22.0, 158.0, 89.0, 81.0, 63.0, 135.0, 90.0, 70.0, 52.0, 95.0, 123.0, 126.0, 81.0, 0.0, 28.0, 126.0, 187.0, 0.0, 0.0, 58.0, 0.0, 117.0, 43.0, 64.0, 0.0, 128.0, 26.0, 62.0, 78.0, 0.0, 0.0, 72.0, 41.0, 23.0, 0.0, 13.0, 15.0, 10.0, 33.0, 0.0, 24.0, 4.0, 122.0, 0.0, 99.0, 96.0, 68.0, 161.0, 58.0, 7.0, 20.0, 105.0, 102.0, 33.0, 37.0, 63.0, 69.0, 68.0, 76.0, 42.0, 88.0, 15.0, 3.0, 57.0, 80.0, 151.0, 137.0, 98.0, 86.0, 58.0, 66.0, 89.0, 102.0, 0.0, 0.0, 156.0, 41.0, 67.0, 14.0, 1.0, 61.0, 18.0, 0.0, 32.0, 57.0, 53.0, 33.0, 76.0, 87.0, 58.0, 0.0, 0.0, 0.0, 19.0, 71.0, 114.0, 189.0, 54.0, 87.0, 0.0, 0.0, 126.0, 164.0, 101.0, 186.0, 113.0, 117.0, 141.0, 177.0, 109.0, 61.0, 84.0, 68.0, 35.0, 27.0, 18.0, 37.0, 62.0, 5.0, 116.0, 109.0, 149.0, 95.0, 0.0, 30.0, 140.0, 107.0, 0.0, 35.0, 23.0, 93.0, 13.0, 24.0, 107.0, 149.0, 3.0, 44.0, 135.0, 144.0, 0.0, 0.0, 98.0, 160.0, 41.0, 24.0, 27.0, 9.0, 84.0, 79.0, 0.0, 41.0, 9.0, 14.0, 30.0, 47.0, 5.0, 14.0, 0.0, 1.0, 128.0, 96.0, 0.0, 18.0, 13.0, 2.0, 73.0, 148.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6131431309357291, "mean_inference_ms": 1.3992726158014654, "mean_action_processing_ms": 0.24597372331511655, "mean_env_wait_ms": 0.18546272457330326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036468505859375, "StateBufferConnector_ms": 0.003984332084655762, "ViewRequirementAgentConnector_ms": 0.11727702617645264}, "num_episodes": 18, "episode_return_max": 316.0, "episode_return_min": -31.0, "episode_return_mean": 128.13, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 87.70427738400636, "num_env_steps_trained_throughput_per_sec": 87.70427738400636, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 45832.715, "restore_workers_time_ms": 0.014, "training_step_time_ms": 45832.666, "sample_time_ms": 1102.064, "learn_time_ms": 44711.323, "learn_throughput": 89.463, "synch_weights_time_ms": 15.025}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 12, "trial_id": "51025_00000", "date": "2024-08-12_20-33-25", "timestamp": 1723509205, "time_this_iter_s": 45.66648983955383, "time_total_s": 559.3314843177795, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cb610d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 559.3314843177795, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 22.659374999999997, "ram_util_percent": 82.56718749999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6316150539766543, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.934842246423954, "policy_loss": -0.013282969510724777, "vf_loss": 6.945637745579715, "vf_explained_var": 0.2694944976814209, "kl": 0.008291567609521244, "entropy": 1.4833924762786381, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6633235114276723, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.872813223278712, "policy_loss": -0.009180005257407194, "vf_loss": 2.880884113198235, "vf_explained_var": 0.026159757722622502, "kl": 0.005545578071593567, "entropy": 1.4724800526780426, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 322.0, "episode_reward_min": -31.0, "episode_reward_mean": 138.27, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -176.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 189.0}, "policy_reward_mean": {"prey_policy": 11.36, "predator_policy": 57.775}, "custom_metrics": {}, "hist_stats": {"episode_reward": [92.0, 136.0, 240.0, 248.0, 172.0, 166.0, -31.0, 0.0, 7.0, 87.0, 236.0, 33.0, 147.0, 0.0, 103.0, 115.0, 136.0, 146.0, 152.0, 119.0, 188.0, 67.0, 144.0, 37.0, 192.0, 304.0, 267.0, 266.0, 82.0, 174.0, 94.0, 198.0, 247.0, 190.0, 236.0, 0.0, 44.0, 131.0, 126.0, 0.0, 129.0, 125.0, 217.0, 204.0, 0.0, 261.0, 18.0, 121.0, 0.0, 129.0, 18.0, 144.0, 41.0, 94.0, 40.0, 131.0, 234.0, 113.0, 67.0, 164.0, 157.0, 122.0, 12.0, 70.0, 72.0, 264.0, 242.0, 315.0, 0.0, 153.0, 24.0, 63.0, 118.0, 289.0, 174.0, 316.0, 168.0, 278.0, 67.0, 0.0, 189.0, 42.0, 202.0, 157.0, 155.0, 248.0, 164.0, 322.0, 159.0, 157.0, 138.0, 298.0, 193.0, 273.0, 0.0, 258.0, 0.0, 200.0, 227.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -52.0, -89.0, 0.0, 52.0, 66.0, 49.0, -19.0, -47.0, 12.0, 138.0, 0.0, -168.0, -176.0, 0.0, 0.0, 0.0, -51.0, 0.0, -73.0, 91.0, 81.0, -11.0, -110.0, -39.0, 46.0, 0.0, 0.0, -10.0, 0.0, -7.0, 99.0, 108.0, 0.0, 0.0, 103.0, 128.0, 0.0, 7.0, -14.0, 87.0, 2.0, -92.0, -5.0, -19.0, -56.0, 10.0, 0.0, -47.0, 32.0, 179.0, 55.0, 22.0, 113.0, 118.0, 4.0, -7.0, -41.0, 157.0, -1.0, -43.0, 0.0, 52.0, -142.0, -74.0, 137.0, 54.0, 12.0, 55.0, -10.0, 0.0, 0.0, 0.0, -153.0, -1.0, 51.0, -1.0, 65.0, 0.0, -18.0, -50.0, 90.0, 39.0, 0.0, 39.0, 15.0, 75.0, 71.0, 0.0, 0.0, 85.0, 86.0, -165.0, -120.0, 0.0, -20.0, 0.0, 0.0, -4.0, -157.0, -146.0, -123.0, 0.0, -86.0, -160.0, -117.0, -44.0, -32.0, -98.0, -14.0, 69.0, 0.0, 111.0, 68.0, 0.0, 46.0, -95.0, -63.0, 54.0, -134.0, 127.0, 0.0, -116.0, -9.0, 0.0, -23.0, -46.0, 0.0, 38.0, -3.0, 161.0, -153.0, 83.0, 112.0, -112.0, 148.0, 0.0, 0.0, 9.0, -114.0, -41.0, 0.0, 27.0, 0.0, 0.0, -45.0, 149.0, 99.0, 0.0, 151.0, 93.0, 146.0, 149.0, 0.0, 101.0, 176.0, -157.0, 0.0, 0.0, -18.0, 179.0, -5.0, -131.0, -48.0, 15.0, -49.0, -23.0, 124.0, 155.0, 0.0, 85.0, 148.0, 130.0, 0.0, 139.0, 159.0, 61.0, -56.0, 0.0, 157.0, -108.0, 0.0, 131.0, 159.0, 67.0, -61.0, 153.0, -25.0, 0.0, -61.0, 32.0, 111.0, 0.0, -8.0, 200.0, -15.0, 76.0, -166.0, -14.0, 0.0], "policy_predator_policy_reward": [81.0, 63.0, 135.0, 90.0, 70.0, 52.0, 95.0, 123.0, 126.0, 81.0, 0.0, 28.0, 126.0, 187.0, 0.0, 0.0, 58.0, 0.0, 117.0, 43.0, 64.0, 0.0, 128.0, 26.0, 62.0, 78.0, 0.0, 0.0, 72.0, 41.0, 23.0, 0.0, 13.0, 15.0, 10.0, 33.0, 0.0, 24.0, 4.0, 122.0, 0.0, 99.0, 96.0, 68.0, 161.0, 58.0, 7.0, 20.0, 105.0, 102.0, 33.0, 37.0, 63.0, 69.0, 68.0, 76.0, 42.0, 88.0, 15.0, 3.0, 57.0, 80.0, 151.0, 137.0, 98.0, 86.0, 58.0, 66.0, 89.0, 102.0, 0.0, 0.0, 156.0, 41.0, 67.0, 14.0, 1.0, 61.0, 18.0, 0.0, 32.0, 57.0, 53.0, 33.0, 76.0, 87.0, 58.0, 0.0, 0.0, 0.0, 19.0, 71.0, 114.0, 189.0, 54.0, 87.0, 0.0, 0.0, 126.0, 164.0, 101.0, 186.0, 113.0, 117.0, 141.0, 177.0, 109.0, 61.0, 84.0, 68.0, 35.0, 27.0, 18.0, 37.0, 62.0, 5.0, 116.0, 109.0, 149.0, 95.0, 0.0, 30.0, 140.0, 107.0, 0.0, 35.0, 23.0, 93.0, 13.0, 24.0, 107.0, 149.0, 3.0, 44.0, 135.0, 144.0, 0.0, 0.0, 98.0, 160.0, 41.0, 24.0, 27.0, 9.0, 84.0, 79.0, 0.0, 41.0, 9.0, 14.0, 30.0, 47.0, 5.0, 14.0, 0.0, 1.0, 128.0, 96.0, 0.0, 18.0, 13.0, 2.0, 73.0, 148.0, 117.0, 119.0, 17.0, 39.0, 0.0, 0.0, 0.0, 15.0, 3.0, 31.0, 23.0, 1.0, 38.0, 116.0, 0.0, 0.0, 139.0, 107.0, 0.0, 8.0, 109.0, 78.0, 111.0, 34.0, 61.0, 0.0, 67.0, 48.0, 8.0, 0.0, 0.0, 15.0, 157.0, 160.0, 14.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6117254669644729, "mean_inference_ms": 1.3915751392104525, "mean_action_processing_ms": 0.24470540728352144, "mean_env_wait_ms": 0.18411350730468484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036641359329223633, "StateBufferConnector_ms": 0.004387974739074707, "ViewRequirementAgentConnector_ms": 0.11739146709442139}, "num_episodes": 18, "episode_return_max": 322.0, "episode_return_min": -31.0, "episode_return_mean": 138.27, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.33561423234015, "num_env_steps_trained_throughput_per_sec": 88.33561423234015, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 45765.519, "restore_workers_time_ms": 0.014, "training_step_time_ms": 45765.471, "sample_time_ms": 1101.286, "learn_time_ms": 44645.259, "learn_throughput": 89.595, "synch_weights_time_ms": 14.843}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 13, "trial_id": "51025_00000", "date": "2024-08-12_20-34-10", "timestamp": 1723509250, "time_this_iter_s": 45.3214910030365, "time_total_s": 604.652975320816, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cb4a9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 604.652975320816, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 21.3046875, "ram_util_percent": 82.63125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.369089809643529, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.59224442174195, "policy_loss": -0.007408341264509887, "vf_loss": 7.597811870221738, "vf_explained_var": 0.36817503101611265, "kl": 0.006136295108985641, "entropy": 1.4691579857831278, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.406593351767808, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5470126400548945, "policy_loss": -0.014153688324975076, "vf_loss": 2.5588150985657223, "vf_explained_var": 0.04823538954295809, "kl": 0.011756154685763659, "entropy": 1.4765278188639848, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 378.0, "episode_reward_min": 0.0, "episode_reward_mean": 167.24, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -166.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 189.0}, "policy_reward_mean": {"prey_policy": 35.54, "predator_policy": 48.08}, "custom_metrics": {}, "hist_stats": {"episode_reward": [266.0, 82.0, 174.0, 94.0, 198.0, 247.0, 190.0, 236.0, 0.0, 44.0, 131.0, 126.0, 0.0, 129.0, 125.0, 217.0, 204.0, 0.0, 261.0, 18.0, 121.0, 0.0, 129.0, 18.0, 144.0, 41.0, 94.0, 40.0, 131.0, 234.0, 113.0, 67.0, 164.0, 157.0, 122.0, 12.0, 70.0, 72.0, 264.0, 242.0, 315.0, 0.0, 153.0, 24.0, 63.0, 118.0, 289.0, 174.0, 316.0, 168.0, 278.0, 67.0, 0.0, 189.0, 42.0, 202.0, 157.0, 155.0, 248.0, 164.0, 322.0, 159.0, 157.0, 138.0, 298.0, 193.0, 273.0, 0.0, 258.0, 0.0, 200.0, 227.0, 0.0, 0.0, 274.0, 316.0, 245.0, 179.0, 137.0, 333.0, 327.0, 378.0, 0.0, 171.0, 375.0, 334.0, 111.0, 105.0, 372.0, 188.0, 305.0, 192.0, 145.0, 355.0, 291.0, 155.0, 304.0, 337.0, 186.0, 285.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [118.0, 4.0, -7.0, -41.0, 157.0, -1.0, -43.0, 0.0, 52.0, -142.0, -74.0, 137.0, 54.0, 12.0, 55.0, -10.0, 0.0, 0.0, 0.0, -153.0, -1.0, 51.0, -1.0, 65.0, 0.0, -18.0, -50.0, 90.0, 39.0, 0.0, 39.0, 15.0, 75.0, 71.0, 0.0, 0.0, 85.0, 86.0, -165.0, -120.0, 0.0, -20.0, 0.0, 0.0, -4.0, -157.0, -146.0, -123.0, 0.0, -86.0, -160.0, -117.0, -44.0, -32.0, -98.0, -14.0, 69.0, 0.0, 111.0, 68.0, 0.0, 46.0, -95.0, -63.0, 54.0, -134.0, 127.0, 0.0, -116.0, -9.0, 0.0, -23.0, -46.0, 0.0, 38.0, -3.0, 161.0, -153.0, 83.0, 112.0, -112.0, 148.0, 0.0, 0.0, 9.0, -114.0, -41.0, 0.0, 27.0, 0.0, 0.0, -45.0, 149.0, 99.0, 0.0, 151.0, 93.0, 146.0, 149.0, 0.0, 101.0, 176.0, -157.0, 0.0, 0.0, -18.0, 179.0, -5.0, -131.0, -48.0, 15.0, -49.0, -23.0, 124.0, 155.0, 0.0, 85.0, 148.0, 130.0, 0.0, 139.0, 159.0, 61.0, -56.0, 0.0, 157.0, -108.0, 0.0, 131.0, 159.0, 67.0, -61.0, 153.0, -25.0, 0.0, -61.0, 32.0, 111.0, 0.0, -8.0, 200.0, -15.0, 76.0, -166.0, -14.0, 0.0, 0.0, 0.0, 142.0, 104.0, 141.0, 125.0, 134.0, -157.0, -59.0, 149.0, 127.0, 0.0, 169.0, 96.0, 157.0, 147.0, 181.0, 186.0, 0.0, 0.0, 154.0, 0.0, 186.0, 181.0, 175.0, 109.0, 55.0, -46.0, 105.0, -1.0, 193.0, 172.0, 119.0, 0.0, 67.0, 148.0, 192.0, 0.0, 120.0, 0.0, 170.0, 152.0, 142.0, 113.0, -46.0, 118.0, 150.0, 115.0, 187.0, 111.0, 177.0, -2.0, 185.0, 88.0], "policy_predator_policy_reward": [68.0, 76.0, 42.0, 88.0, 15.0, 3.0, 57.0, 80.0, 151.0, 137.0, 98.0, 86.0, 58.0, 66.0, 89.0, 102.0, 0.0, 0.0, 156.0, 41.0, 67.0, 14.0, 1.0, 61.0, 18.0, 0.0, 32.0, 57.0, 53.0, 33.0, 76.0, 87.0, 58.0, 0.0, 0.0, 0.0, 19.0, 71.0, 114.0, 189.0, 54.0, 87.0, 0.0, 0.0, 126.0, 164.0, 101.0, 186.0, 113.0, 117.0, 141.0, 177.0, 109.0, 61.0, 84.0, 68.0, 35.0, 27.0, 18.0, 37.0, 62.0, 5.0, 116.0, 109.0, 149.0, 95.0, 0.0, 30.0, 140.0, 107.0, 0.0, 35.0, 23.0, 93.0, 13.0, 24.0, 107.0, 149.0, 3.0, 44.0, 135.0, 144.0, 0.0, 0.0, 98.0, 160.0, 41.0, 24.0, 27.0, 9.0, 84.0, 79.0, 0.0, 41.0, 9.0, 14.0, 30.0, 47.0, 5.0, 14.0, 0.0, 1.0, 128.0, 96.0, 0.0, 18.0, 13.0, 2.0, 73.0, 148.0, 117.0, 119.0, 17.0, 39.0, 0.0, 0.0, 0.0, 15.0, 3.0, 31.0, 23.0, 1.0, 38.0, 116.0, 0.0, 0.0, 139.0, 107.0, 0.0, 8.0, 109.0, 78.0, 111.0, 34.0, 61.0, 0.0, 67.0, 48.0, 8.0, 0.0, 0.0, 15.0, 157.0, 160.0, 14.0, 0.0, 0.0, 0.0, 28.0, 0.0, 10.0, 40.0, 187.0, 81.0, 56.0, 33.0, 10.0, 0.0, 26.0, 42.0, 23.0, 0.0, 0.0, 11.0, 0.0, 0.0, 3.0, 14.0, 4.0, 4.0, 20.0, 30.0, 74.0, 28.0, 1.0, 0.0, 7.0, 0.0, 39.0, 30.0, 58.0, 32.0, 0.0, 0.0, 25.0, 0.0, 0.0, 33.0, 0.0, 36.0, 45.0, 38.0, 15.0, 24.0, 39.0, 0.0, 0.0, 11.0, 0.0, 12.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6074934317220353, "mean_inference_ms": 1.3782300825356026, "mean_action_processing_ms": 0.2425825690979903, "mean_env_wait_ms": 0.1819360377009955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003586292266845703, "StateBufferConnector_ms": 0.004117131233215332, "ViewRequirementAgentConnector_ms": 0.09826827049255371}, "num_episodes": 27, "episode_return_max": 378.0, "episode_return_min": 0.0, "episode_return_mean": 167.24, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 87.28116410525126, "num_env_steps_trained_throughput_per_sec": 87.28116410525126, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 45754.859, "restore_workers_time_ms": 0.014, "training_step_time_ms": 45754.809, "sample_time_ms": 1104.951, "learn_time_ms": 44630.968, "learn_throughput": 89.624, "synch_weights_time_ms": 14.499}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 14, "trial_id": "51025_00000", "date": "2024-08-12_20-34-56", "timestamp": 1723509296, "time_this_iter_s": 45.86609697341919, "time_total_s": 650.5190722942352, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1580263a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 650.5190722942352, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 23.229230769230767, "ram_util_percent": 82.92153846153846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.792737272555235, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.238732649788024, "policy_loss": -0.008473736591262635, "vf_loss": 7.2449622234970175, "vf_explained_var": 0.4569357851825694, "kl": 0.0074805153227952515, "entropy": 1.4559811387743269, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.981361797499278, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.370663682745878, "policy_loss": -0.012691327724507246, "vf_loss": 1.3817398666704774, "vf_explained_var": 0.07276605897479588, "kl": 0.008075699149971735, "entropy": 1.4548274107080288, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 385.0, "episode_reward_min": 0.0, "episode_reward_mean": 184.67, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -166.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 189.0}, "policy_reward_mean": {"prey_policy": 52.725, "predator_policy": 39.61}, "custom_metrics": {}, "hist_stats": {"episode_reward": [261.0, 18.0, 121.0, 0.0, 129.0, 18.0, 144.0, 41.0, 94.0, 40.0, 131.0, 234.0, 113.0, 67.0, 164.0, 157.0, 122.0, 12.0, 70.0, 72.0, 264.0, 242.0, 315.0, 0.0, 153.0, 24.0, 63.0, 118.0, 289.0, 174.0, 316.0, 168.0, 278.0, 67.0, 0.0, 189.0, 42.0, 202.0, 157.0, 155.0, 248.0, 164.0, 322.0, 159.0, 157.0, 138.0, 298.0, 193.0, 273.0, 0.0, 258.0, 0.0, 200.0, 227.0, 0.0, 0.0, 274.0, 316.0, 245.0, 179.0, 137.0, 333.0, 327.0, 378.0, 0.0, 171.0, 375.0, 334.0, 111.0, 105.0, 372.0, 188.0, 305.0, 192.0, 145.0, 355.0, 291.0, 155.0, 304.0, 337.0, 186.0, 285.0, 119.0, 0.0, 166.0, 329.0, 0.0, 385.0, 350.0, 292.0, 382.0, 286.0, 188.0, 330.0, 365.0, 126.0, 380.0, 157.0, 188.0, 163.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [85.0, 86.0, -165.0, -120.0, 0.0, -20.0, 0.0, 0.0, -4.0, -157.0, -146.0, -123.0, 0.0, -86.0, -160.0, -117.0, -44.0, -32.0, -98.0, -14.0, 69.0, 0.0, 111.0, 68.0, 0.0, 46.0, -95.0, -63.0, 54.0, -134.0, 127.0, 0.0, -116.0, -9.0, 0.0, -23.0, -46.0, 0.0, 38.0, -3.0, 161.0, -153.0, 83.0, 112.0, -112.0, 148.0, 0.0, 0.0, 9.0, -114.0, -41.0, 0.0, 27.0, 0.0, 0.0, -45.0, 149.0, 99.0, 0.0, 151.0, 93.0, 146.0, 149.0, 0.0, 101.0, 176.0, -157.0, 0.0, 0.0, -18.0, 179.0, -5.0, -131.0, -48.0, 15.0, -49.0, -23.0, 124.0, 155.0, 0.0, 85.0, 148.0, 130.0, 0.0, 139.0, 159.0, 61.0, -56.0, 0.0, 157.0, -108.0, 0.0, 131.0, 159.0, 67.0, -61.0, 153.0, -25.0, 0.0, -61.0, 32.0, 111.0, 0.0, -8.0, 200.0, -15.0, 76.0, -166.0, -14.0, 0.0, 0.0, 0.0, 142.0, 104.0, 141.0, 125.0, 134.0, -157.0, -59.0, 149.0, 127.0, 0.0, 169.0, 96.0, 157.0, 147.0, 181.0, 186.0, 0.0, 0.0, 154.0, 0.0, 186.0, 181.0, 175.0, 109.0, 55.0, -46.0, 105.0, -1.0, 193.0, 172.0, 119.0, 0.0, 67.0, 148.0, 192.0, 0.0, 120.0, 0.0, 170.0, 152.0, 142.0, 113.0, -46.0, 118.0, 150.0, 115.0, 187.0, 111.0, 177.0, -2.0, 185.0, 88.0, 119.0, -12.0, 0.0, 0.0, 134.0, -4.0, 163.0, 122.0, -1.0, -8.0, 177.0, 198.0, 164.0, 155.0, 174.0, 118.0, 196.0, 184.0, 125.0, 130.0, 184.0, 0.0, 115.0, 191.0, 187.0, 162.0, 0.0, 86.0, 200.0, 180.0, 0.0, 157.0, 23.0, 164.0, 147.0, 0.0], "policy_predator_policy_reward": [19.0, 71.0, 114.0, 189.0, 54.0, 87.0, 0.0, 0.0, 126.0, 164.0, 101.0, 186.0, 113.0, 117.0, 141.0, 177.0, 109.0, 61.0, 84.0, 68.0, 35.0, 27.0, 18.0, 37.0, 62.0, 5.0, 116.0, 109.0, 149.0, 95.0, 0.0, 30.0, 140.0, 107.0, 0.0, 35.0, 23.0, 93.0, 13.0, 24.0, 107.0, 149.0, 3.0, 44.0, 135.0, 144.0, 0.0, 0.0, 98.0, 160.0, 41.0, 24.0, 27.0, 9.0, 84.0, 79.0, 0.0, 41.0, 9.0, 14.0, 30.0, 47.0, 5.0, 14.0, 0.0, 1.0, 128.0, 96.0, 0.0, 18.0, 13.0, 2.0, 73.0, 148.0, 117.0, 119.0, 17.0, 39.0, 0.0, 0.0, 0.0, 15.0, 3.0, 31.0, 23.0, 1.0, 38.0, 116.0, 0.0, 0.0, 139.0, 107.0, 0.0, 8.0, 109.0, 78.0, 111.0, 34.0, 61.0, 0.0, 67.0, 48.0, 8.0, 0.0, 0.0, 15.0, 157.0, 160.0, 14.0, 0.0, 0.0, 0.0, 28.0, 0.0, 10.0, 40.0, 187.0, 81.0, 56.0, 33.0, 10.0, 0.0, 26.0, 42.0, 23.0, 0.0, 0.0, 11.0, 0.0, 0.0, 3.0, 14.0, 4.0, 4.0, 20.0, 30.0, 74.0, 28.0, 1.0, 0.0, 7.0, 0.0, 39.0, 30.0, 58.0, 32.0, 0.0, 0.0, 25.0, 0.0, 0.0, 33.0, 0.0, 36.0, 45.0, 38.0, 15.0, 24.0, 39.0, 0.0, 0.0, 11.0, 0.0, 12.0, 11.0, 1.0, 0.0, 0.0, 36.0, 0.0, 43.0, 1.0, 0.0, 9.0, 0.0, 10.0, 31.0, 0.0, 0.0, 0.0, 2.0, 0.0, 8.0, 23.0, 0.0, 4.0, 18.0, 6.0, 0.0, 16.0, 0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 8.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6043698506358396, "mean_inference_ms": 1.3694637767691575, "mean_action_processing_ms": 0.24144823672304327, "mean_env_wait_ms": 0.18096190805387544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033582448959350586, "StateBufferConnector_ms": 0.0034296512603759766, "ViewRequirementAgentConnector_ms": 0.09587132930755615}, "num_episodes": 18, "episode_return_max": 385.0, "episode_return_min": 0.0, "episode_return_mean": 184.67, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.92949958074286, "num_env_steps_trained_throughput_per_sec": 88.92949958074286, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 45709.573, "restore_workers_time_ms": 0.014, "training_step_time_ms": 45709.523, "sample_time_ms": 1104.28, "learn_time_ms": 44586.975, "learn_throughput": 89.712, "synch_weights_time_ms": 14.48}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 15, "trial_id": "51025_00000", "date": "2024-08-12_20-35-41", "timestamp": 1723509341, "time_this_iter_s": 45.0167818069458, "time_total_s": 695.535854101181, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cb61550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 695.535854101181, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 20.809375, "ram_util_percent": 82.71875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.114665359100967, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.966223169003845, "policy_loss": -0.009140257029572413, "vf_loss": 6.973062253629089, "vf_explained_var": 0.5214947087739511, "kl": 0.007670552060952942, "entropy": 1.4309335691588265, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.871907374593946, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3722160436488964, "policy_loss": -0.01288286531171589, "vf_loss": 2.382960804934224, "vf_explained_var": 0.054219803639820645, "kl": 0.01069054354436257, "entropy": 1.4516046384024242, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 391.0, "episode_reward_min": 0.0, "episode_reward_mean": 210.84, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -166.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 187.0}, "policy_reward_mean": {"prey_policy": 78.195, "predator_policy": 27.225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [70.0, 72.0, 264.0, 242.0, 315.0, 0.0, 153.0, 24.0, 63.0, 118.0, 289.0, 174.0, 316.0, 168.0, 278.0, 67.0, 0.0, 189.0, 42.0, 202.0, 157.0, 155.0, 248.0, 164.0, 322.0, 159.0, 157.0, 138.0, 298.0, 193.0, 273.0, 0.0, 258.0, 0.0, 200.0, 227.0, 0.0, 0.0, 274.0, 316.0, 245.0, 179.0, 137.0, 333.0, 327.0, 378.0, 0.0, 171.0, 375.0, 334.0, 111.0, 105.0, 372.0, 188.0, 305.0, 192.0, 145.0, 355.0, 291.0, 155.0, 304.0, 337.0, 186.0, 285.0, 119.0, 0.0, 166.0, 329.0, 0.0, 385.0, 350.0, 292.0, 382.0, 286.0, 188.0, 330.0, 365.0, 126.0, 380.0, 157.0, 188.0, 163.0, 301.0, 306.0, 321.0, 194.0, 303.0, 313.0, 341.0, 363.0, 299.0, 251.0, 391.0, 182.0, 174.0, 0.0, 179.0, 195.0, 197.0, 173.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-46.0, 0.0, 38.0, -3.0, 161.0, -153.0, 83.0, 112.0, -112.0, 148.0, 0.0, 0.0, 9.0, -114.0, -41.0, 0.0, 27.0, 0.0, 0.0, -45.0, 149.0, 99.0, 0.0, 151.0, 93.0, 146.0, 149.0, 0.0, 101.0, 176.0, -157.0, 0.0, 0.0, -18.0, 179.0, -5.0, -131.0, -48.0, 15.0, -49.0, -23.0, 124.0, 155.0, 0.0, 85.0, 148.0, 130.0, 0.0, 139.0, 159.0, 61.0, -56.0, 0.0, 157.0, -108.0, 0.0, 131.0, 159.0, 67.0, -61.0, 153.0, -25.0, 0.0, -61.0, 32.0, 111.0, 0.0, -8.0, 200.0, -15.0, 76.0, -166.0, -14.0, 0.0, 0.0, 0.0, 142.0, 104.0, 141.0, 125.0, 134.0, -157.0, -59.0, 149.0, 127.0, 0.0, 169.0, 96.0, 157.0, 147.0, 181.0, 186.0, 0.0, 0.0, 154.0, 0.0, 186.0, 181.0, 175.0, 109.0, 55.0, -46.0, 105.0, -1.0, 193.0, 172.0, 119.0, 0.0, 67.0, 148.0, 192.0, 0.0, 120.0, 0.0, 170.0, 152.0, 142.0, 113.0, -46.0, 118.0, 150.0, 115.0, 187.0, 111.0, 177.0, -2.0, 185.0, 88.0, 119.0, -12.0, 0.0, 0.0, 134.0, -4.0, 163.0, 122.0, -1.0, -8.0, 177.0, 198.0, 164.0, 155.0, 174.0, 118.0, 196.0, 184.0, 125.0, 130.0, 184.0, 0.0, 115.0, 191.0, 187.0, 162.0, 0.0, 86.0, 200.0, 180.0, 0.0, 157.0, 23.0, 164.0, 147.0, 0.0, 117.0, 135.0, 110.0, 141.0, 166.0, 111.0, -15.0, 186.0, 104.0, 186.0, 186.0, 119.0, 181.0, 112.0, 190.0, 146.0, 151.0, 127.0, 110.0, 31.0, 187.0, 198.0, 182.0, 0.0, 162.0, -2.0, 0.0, -10.0, 0.0, 179.0, 0.0, 195.0, 191.0, 1.0, -12.0, 149.0], "policy_predator_policy_reward": [23.0, 93.0, 13.0, 24.0, 107.0, 149.0, 3.0, 44.0, 135.0, 144.0, 0.0, 0.0, 98.0, 160.0, 41.0, 24.0, 27.0, 9.0, 84.0, 79.0, 0.0, 41.0, 9.0, 14.0, 30.0, 47.0, 5.0, 14.0, 0.0, 1.0, 128.0, 96.0, 0.0, 18.0, 13.0, 2.0, 73.0, 148.0, 117.0, 119.0, 17.0, 39.0, 0.0, 0.0, 0.0, 15.0, 3.0, 31.0, 23.0, 1.0, 38.0, 116.0, 0.0, 0.0, 139.0, 107.0, 0.0, 8.0, 109.0, 78.0, 111.0, 34.0, 61.0, 0.0, 67.0, 48.0, 8.0, 0.0, 0.0, 15.0, 157.0, 160.0, 14.0, 0.0, 0.0, 0.0, 28.0, 0.0, 10.0, 40.0, 187.0, 81.0, 56.0, 33.0, 10.0, 0.0, 26.0, 42.0, 23.0, 0.0, 0.0, 11.0, 0.0, 0.0, 3.0, 14.0, 4.0, 4.0, 20.0, 30.0, 74.0, 28.0, 1.0, 0.0, 7.0, 0.0, 39.0, 30.0, 58.0, 32.0, 0.0, 0.0, 25.0, 0.0, 0.0, 33.0, 0.0, 36.0, 45.0, 38.0, 15.0, 24.0, 39.0, 0.0, 0.0, 11.0, 0.0, 12.0, 11.0, 1.0, 0.0, 0.0, 36.0, 0.0, 43.0, 1.0, 0.0, 9.0, 0.0, 10.0, 31.0, 0.0, 0.0, 0.0, 2.0, 0.0, 8.0, 23.0, 0.0, 4.0, 18.0, 6.0, 0.0, 16.0, 0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 8.0, 8.0, 38.0, 11.0, 0.0, 55.0, 0.0, 44.0, 8.0, 15.0, 4.0, 9.0, 0.0, 8.0, 13.0, 35.0, 2.0, 25.0, 6.0, 15.0, 106.0, 4.0, 0.0, 6.0, 0.0, 0.0, 14.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 22.0, 14.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6020458516349922, "mean_inference_ms": 1.3625258869759742, "mean_action_processing_ms": 0.24041678394994914, "mean_env_wait_ms": 0.1799203421540333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032917261123657227, "StateBufferConnector_ms": 0.00343930721282959, "ViewRequirementAgentConnector_ms": 0.09582257270812988}, "num_episodes": 18, "episode_return_max": 391.0, "episode_return_min": 0.0, "episode_return_mean": 210.84, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.69695025037996, "num_env_steps_trained_throughput_per_sec": 88.69695025037996, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 45621.375, "restore_workers_time_ms": 0.014, "training_step_time_ms": 45621.325, "sample_time_ms": 1106.849, "learn_time_ms": 44497.263, "learn_throughput": 89.893, "synch_weights_time_ms": 13.991}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 16, "trial_id": "51025_00000", "date": "2024-08-12_20-36-26", "timestamp": 1723509386, "time_this_iter_s": 45.128077030181885, "time_total_s": 740.6639311313629, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cb33940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 740.6639311313629, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 21.8265625, "ram_util_percent": 82.64531249999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.952206375296154, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.819943559485138, "policy_loss": -0.01056837667390783, "vf_loss": 7.828393895033176, "vf_explained_var": 0.1597846136522041, "kl": 0.007060120656541927, "entropy": 1.4148412039670994, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.638475870770752, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.825293872091505, "policy_loss": -0.01841573776164777, "vf_loss": 4.840497022457224, "vf_explained_var": 0.08015304807001951, "kl": 0.016062905233731162, "entropy": 1.4362868686832448, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 391.0, "episode_reward_min": -14.0, "episode_reward_mean": 215.56, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -166.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 190.0}, "policy_reward_mean": {"prey_policy": 82.83, "predator_policy": 24.95}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.0, 202.0, 157.0, 155.0, 248.0, 164.0, 322.0, 159.0, 157.0, 138.0, 298.0, 193.0, 273.0, 0.0, 258.0, 0.0, 200.0, 227.0, 0.0, 0.0, 274.0, 316.0, 245.0, 179.0, 137.0, 333.0, 327.0, 378.0, 0.0, 171.0, 375.0, 334.0, 111.0, 105.0, 372.0, 188.0, 305.0, 192.0, 145.0, 355.0, 291.0, 155.0, 304.0, 337.0, 186.0, 285.0, 119.0, 0.0, 166.0, 329.0, 0.0, 385.0, 350.0, 292.0, 382.0, 286.0, 188.0, 330.0, 365.0, 126.0, 380.0, 157.0, 188.0, 163.0, 301.0, 306.0, 321.0, 194.0, 303.0, 313.0, 341.0, 363.0, 299.0, 251.0, 391.0, 182.0, 174.0, 0.0, 179.0, 195.0, 197.0, 173.0, 166.0, 190.0, -14.0, 149.0, 293.0, 350.0, 338.0, 7.0, 253.0, 180.0, 275.0, 139.0, 110.0, 288.0, 182.0, 56.0, 151.0, 161.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-131.0, -48.0, 15.0, -49.0, -23.0, 124.0, 155.0, 0.0, 85.0, 148.0, 130.0, 0.0, 139.0, 159.0, 61.0, -56.0, 0.0, 157.0, -108.0, 0.0, 131.0, 159.0, 67.0, -61.0, 153.0, -25.0, 0.0, -61.0, 32.0, 111.0, 0.0, -8.0, 200.0, -15.0, 76.0, -166.0, -14.0, 0.0, 0.0, 0.0, 142.0, 104.0, 141.0, 125.0, 134.0, -157.0, -59.0, 149.0, 127.0, 0.0, 169.0, 96.0, 157.0, 147.0, 181.0, 186.0, 0.0, 0.0, 154.0, 0.0, 186.0, 181.0, 175.0, 109.0, 55.0, -46.0, 105.0, -1.0, 193.0, 172.0, 119.0, 0.0, 67.0, 148.0, 192.0, 0.0, 120.0, 0.0, 170.0, 152.0, 142.0, 113.0, -46.0, 118.0, 150.0, 115.0, 187.0, 111.0, 177.0, -2.0, 185.0, 88.0, 119.0, -12.0, 0.0, 0.0, 134.0, -4.0, 163.0, 122.0, -1.0, -8.0, 177.0, 198.0, 164.0, 155.0, 174.0, 118.0, 196.0, 184.0, 125.0, 130.0, 184.0, 0.0, 115.0, 191.0, 187.0, 162.0, 0.0, 86.0, 200.0, 180.0, 0.0, 157.0, 23.0, 164.0, 147.0, 0.0, 117.0, 135.0, 110.0, 141.0, 166.0, 111.0, -15.0, 186.0, 104.0, 186.0, 186.0, 119.0, 181.0, 112.0, 190.0, 146.0, 151.0, 127.0, 110.0, 31.0, 187.0, 198.0, 182.0, 0.0, 162.0, -2.0, 0.0, -10.0, 0.0, 179.0, 0.0, 195.0, 191.0, 1.0, -12.0, 149.0, 154.0, 0.0, 52.0, 34.0, -14.0, -24.0, 3.0, 92.0, 128.0, 132.0, 162.0, 139.0, 166.0, 138.0, -148.0, -104.0, 105.0, 83.0, 163.0, 0.0, 90.0, 114.0, 15.0, 32.0, 47.0, 0.0, 114.0, 115.0, 167.0, 0.0, -88.0, 0.0, 146.0, 0.0, 33.0, 8.0], "policy_predator_policy_reward": [73.0, 148.0, 117.0, 119.0, 17.0, 39.0, 0.0, 0.0, 0.0, 15.0, 3.0, 31.0, 23.0, 1.0, 38.0, 116.0, 0.0, 0.0, 139.0, 107.0, 0.0, 8.0, 109.0, 78.0, 111.0, 34.0, 61.0, 0.0, 67.0, 48.0, 8.0, 0.0, 0.0, 15.0, 157.0, 160.0, 14.0, 0.0, 0.0, 0.0, 28.0, 0.0, 10.0, 40.0, 187.0, 81.0, 56.0, 33.0, 10.0, 0.0, 26.0, 42.0, 23.0, 0.0, 0.0, 11.0, 0.0, 0.0, 3.0, 14.0, 4.0, 4.0, 20.0, 30.0, 74.0, 28.0, 1.0, 0.0, 7.0, 0.0, 39.0, 30.0, 58.0, 32.0, 0.0, 0.0, 25.0, 0.0, 0.0, 33.0, 0.0, 36.0, 45.0, 38.0, 15.0, 24.0, 39.0, 0.0, 0.0, 11.0, 0.0, 12.0, 11.0, 1.0, 0.0, 0.0, 36.0, 0.0, 43.0, 1.0, 0.0, 9.0, 0.0, 10.0, 31.0, 0.0, 0.0, 0.0, 2.0, 0.0, 8.0, 23.0, 0.0, 4.0, 18.0, 6.0, 0.0, 16.0, 0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 8.0, 8.0, 38.0, 11.0, 0.0, 55.0, 0.0, 44.0, 8.0, 15.0, 4.0, 9.0, 0.0, 8.0, 13.0, 35.0, 2.0, 25.0, 6.0, 15.0, 106.0, 4.0, 0.0, 6.0, 0.0, 0.0, 14.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 22.0, 14.0, 12.0, 0.0, 0.0, 104.0, 0.0, 24.0, 54.0, 0.0, 0.0, 33.0, 30.0, 19.0, 11.0, 23.0, 69.0, 190.0, 8.0, 57.0, 17.0, 0.0, 17.0, 54.0, 1.0, 91.0, 46.0, 17.0, 12.0, 47.0, 15.0, 0.0, 5.0, 139.0, 0.0, 5.0, 116.0, 4.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5996528092206733, "mean_inference_ms": 1.356091606082574, "mean_action_processing_ms": 0.2394994677794471, "mean_env_wait_ms": 0.17907378401900065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032804012298583984, "StateBufferConnector_ms": 0.003406047821044922, "ViewRequirementAgentConnector_ms": 0.09180569648742676}, "num_episodes": 18, "episode_return_max": 391.0, "episode_return_min": -14.0, "episode_return_mean": 215.56, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.29586418486821, "num_env_steps_trained_throughput_per_sec": 88.29586418486821, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 45478.586, "restore_workers_time_ms": 0.014, "training_step_time_ms": 45478.537, "sample_time_ms": 1093.091, "learn_time_ms": 44368.371, "learn_throughput": 90.154, "synch_weights_time_ms": 14.004}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 17, "trial_id": "51025_00000", "date": "2024-08-12_20-37-12", "timestamp": 1723509432, "time_this_iter_s": 45.37092185020447, "time_total_s": 786.0348529815674, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cb63940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 786.0348529815674, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 21.7078125, "ram_util_percent": 82.7046875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.807009950043663, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.539609020979947, "policy_loss": -0.013091053021086192, "vf_loss": 8.549933040962017, "vf_explained_var": -0.34655782671832536, "kl": 0.009223493639784325, "entropy": 1.4033036517718482, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.8857029020470915, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.664186434771018, "policy_loss": -0.014383067588923036, "vf_loss": 8.676246153866803, "vf_explained_var": 0.0721820110366458, "kl": 0.011616844226706924, "entropy": 1.3926657302669747, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 391.0, "episode_reward_min": -14.0, "episode_reward_mean": 201.15, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -172.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 190.0}, "policy_reward_mean": {"prey_policy": 66.795, "predator_policy": 33.78}, "custom_metrics": {}, "hist_stats": {"episode_reward": [245.0, 179.0, 137.0, 333.0, 327.0, 378.0, 0.0, 171.0, 375.0, 334.0, 111.0, 105.0, 372.0, 188.0, 305.0, 192.0, 145.0, 355.0, 291.0, 155.0, 304.0, 337.0, 186.0, 285.0, 119.0, 0.0, 166.0, 329.0, 0.0, 385.0, 350.0, 292.0, 382.0, 286.0, 188.0, 330.0, 365.0, 126.0, 380.0, 157.0, 188.0, 163.0, 301.0, 306.0, 321.0, 194.0, 303.0, 313.0, 341.0, 363.0, 299.0, 251.0, 391.0, 182.0, 174.0, 0.0, 179.0, 195.0, 197.0, 173.0, 166.0, 190.0, -14.0, 149.0, 293.0, 350.0, 338.0, 7.0, 253.0, 180.0, 275.0, 139.0, 110.0, 288.0, 182.0, 56.0, 151.0, 161.0, 86.0, 119.0, 63.0, 180.0, 25.0, 156.0, 32.0, 1.0, 85.0, 279.0, 92.0, 122.0, 51.0, 11.0, 182.0, 131.0, 146.0, 61.0, 94.0, 31.0, 327.0, 68.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [134.0, -157.0, -59.0, 149.0, 127.0, 0.0, 169.0, 96.0, 157.0, 147.0, 181.0, 186.0, 0.0, 0.0, 154.0, 0.0, 186.0, 181.0, 175.0, 109.0, 55.0, -46.0, 105.0, -1.0, 193.0, 172.0, 119.0, 0.0, 67.0, 148.0, 192.0, 0.0, 120.0, 0.0, 170.0, 152.0, 142.0, 113.0, -46.0, 118.0, 150.0, 115.0, 187.0, 111.0, 177.0, -2.0, 185.0, 88.0, 119.0, -12.0, 0.0, 0.0, 134.0, -4.0, 163.0, 122.0, -1.0, -8.0, 177.0, 198.0, 164.0, 155.0, 174.0, 118.0, 196.0, 184.0, 125.0, 130.0, 184.0, 0.0, 115.0, 191.0, 187.0, 162.0, 0.0, 86.0, 200.0, 180.0, 0.0, 157.0, 23.0, 164.0, 147.0, 0.0, 117.0, 135.0, 110.0, 141.0, 166.0, 111.0, -15.0, 186.0, 104.0, 186.0, 186.0, 119.0, 181.0, 112.0, 190.0, 146.0, 151.0, 127.0, 110.0, 31.0, 187.0, 198.0, 182.0, 0.0, 162.0, -2.0, 0.0, -10.0, 0.0, 179.0, 0.0, 195.0, 191.0, 1.0, -12.0, 149.0, 154.0, 0.0, 52.0, 34.0, -14.0, -24.0, 3.0, 92.0, 128.0, 132.0, 162.0, 139.0, 166.0, 138.0, -148.0, -104.0, 105.0, 83.0, 163.0, 0.0, 90.0, 114.0, 15.0, 32.0, 47.0, 0.0, 114.0, 115.0, 167.0, 0.0, -88.0, 0.0, 146.0, 0.0, 33.0, 8.0, -42.0, -88.0, -71.0, -55.0, 21.0, -22.0, -20.0, 81.0, -172.0, -42.0, -157.0, 9.0, 0.0, -151.0, -66.0, -127.0, 0.0, -172.0, 127.0, 77.0, 0.0, -129.0, 44.0, 0.0, -30.0, 4.0, -107.0, -139.0, 37.0, 29.0, 36.0, 1.0, 0.0, 88.0, -107.0, -68.0, 0.0, -42.0, -98.0, -72.0, 123.0, 134.0, -132.0, -60.0], "policy_predator_policy_reward": [187.0, 81.0, 56.0, 33.0, 10.0, 0.0, 26.0, 42.0, 23.0, 0.0, 0.0, 11.0, 0.0, 0.0, 3.0, 14.0, 4.0, 4.0, 20.0, 30.0, 74.0, 28.0, 1.0, 0.0, 7.0, 0.0, 39.0, 30.0, 58.0, 32.0, 0.0, 0.0, 25.0, 0.0, 0.0, 33.0, 0.0, 36.0, 45.0, 38.0, 15.0, 24.0, 39.0, 0.0, 0.0, 11.0, 0.0, 12.0, 11.0, 1.0, 0.0, 0.0, 36.0, 0.0, 43.0, 1.0, 0.0, 9.0, 0.0, 10.0, 31.0, 0.0, 0.0, 0.0, 2.0, 0.0, 8.0, 23.0, 0.0, 4.0, 18.0, 6.0, 0.0, 16.0, 0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 8.0, 8.0, 38.0, 11.0, 0.0, 55.0, 0.0, 44.0, 8.0, 15.0, 4.0, 9.0, 0.0, 8.0, 13.0, 35.0, 2.0, 25.0, 6.0, 15.0, 106.0, 4.0, 0.0, 6.0, 0.0, 0.0, 14.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 22.0, 14.0, 12.0, 0.0, 0.0, 104.0, 0.0, 24.0, 54.0, 0.0, 0.0, 33.0, 30.0, 19.0, 11.0, 23.0, 69.0, 190.0, 8.0, 57.0, 17.0, 0.0, 17.0, 54.0, 1.0, 91.0, 46.0, 17.0, 12.0, 47.0, 15.0, 0.0, 5.0, 139.0, 0.0, 5.0, 116.0, 4.0, 85.0, 131.0, 97.0, 148.0, 20.0, 44.0, 2.0, 117.0, 186.0, 53.0, 146.0, 158.0, 26.0, 157.0, 80.0, 114.0, 162.0, 95.0, 75.0, 0.0, 131.0, 90.0, 78.0, 0.0, 57.0, 20.0, 152.0, 105.0, 110.0, 6.0, 44.0, 50.0, 10.0, 48.0, 139.0, 97.0, 65.0, 71.0, 41.0, 160.0, 39.0, 31.0, 114.0, 146.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5969684297446254, "mean_inference_ms": 1.3485114844597827, "mean_action_processing_ms": 0.2382864687137192, "mean_env_wait_ms": 0.17829261133343366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032958984375, "StateBufferConnector_ms": 0.003032088279724121, "ViewRequirementAgentConnector_ms": 0.09188449382781982}, "num_episodes": 22, "episode_return_max": 391.0, "episode_return_min": -14.0, "episode_return_mean": 201.15, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 87.69701793310622, "num_env_steps_trained_throughput_per_sec": 87.69701793310622, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 45481.176, "restore_workers_time_ms": 0.014, "training_step_time_ms": 45481.127, "sample_time_ms": 1086.306, "learn_time_ms": 44377.629, "learn_throughput": 90.136, "synch_weights_time_ms": 14.08}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 18, "trial_id": "51025_00000", "date": "2024-08-12_20-37-57", "timestamp": 1723509477, "time_this_iter_s": 45.66183400154114, "time_total_s": 831.6966869831085, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cb6cee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 831.6966869831085, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 22.455384615384613, "ram_util_percent": 82.9876923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.9715105758142215, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.430731163327657, "policy_loss": -0.011574404600455805, "vf_loss": 8.439788712900151, "vf_explained_var": -0.16586077976479102, "kl": 0.008389622294896912, "entropy": 1.3930515723253685, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.15962752299334, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.73048377339802, "policy_loss": -0.012034993436897085, "vf_loss": 8.740605632337944, "vf_explained_var": 0.03135133830327836, "kl": 0.009565639959919041, "entropy": 1.3838869142153907, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 391.0, "episode_reward_min": -41.0, "episode_reward_mean": 157.59, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -357.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 357.0}, "policy_reward_mean": {"prey_policy": 22.11, "predator_policy": 56.685}, "custom_metrics": {}, "hist_stats": {"episode_reward": [285.0, 119.0, 0.0, 166.0, 329.0, 0.0, 385.0, 350.0, 292.0, 382.0, 286.0, 188.0, 330.0, 365.0, 126.0, 380.0, 157.0, 188.0, 163.0, 301.0, 306.0, 321.0, 194.0, 303.0, 313.0, 341.0, 363.0, 299.0, 251.0, 391.0, 182.0, 174.0, 0.0, 179.0, 195.0, 197.0, 173.0, 166.0, 190.0, -14.0, 149.0, 293.0, 350.0, 338.0, 7.0, 253.0, 180.0, 275.0, 139.0, 110.0, 288.0, 182.0, 56.0, 151.0, 161.0, 86.0, 119.0, 63.0, 180.0, 25.0, 156.0, 32.0, 1.0, 85.0, 279.0, 92.0, 122.0, 51.0, 11.0, 182.0, 131.0, 146.0, 61.0, 94.0, 31.0, 327.0, 68.0, 242.0, -10.0, 2.0, -41.0, 1.0, 84.0, 47.0, -11.0, -26.0, 48.0, 87.0, 32.0, 92.0, 141.0, 76.0, -4.0, 35.0, 98.0, 90.0, 76.0, 4.0, 53.0, 53.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [185.0, 88.0, 119.0, -12.0, 0.0, 0.0, 134.0, -4.0, 163.0, 122.0, -1.0, -8.0, 177.0, 198.0, 164.0, 155.0, 174.0, 118.0, 196.0, 184.0, 125.0, 130.0, 184.0, 0.0, 115.0, 191.0, 187.0, 162.0, 0.0, 86.0, 200.0, 180.0, 0.0, 157.0, 23.0, 164.0, 147.0, 0.0, 117.0, 135.0, 110.0, 141.0, 166.0, 111.0, -15.0, 186.0, 104.0, 186.0, 186.0, 119.0, 181.0, 112.0, 190.0, 146.0, 151.0, 127.0, 110.0, 31.0, 187.0, 198.0, 182.0, 0.0, 162.0, -2.0, 0.0, -10.0, 0.0, 179.0, 0.0, 195.0, 191.0, 1.0, -12.0, 149.0, 154.0, 0.0, 52.0, 34.0, -14.0, -24.0, 3.0, 92.0, 128.0, 132.0, 162.0, 139.0, 166.0, 138.0, -148.0, -104.0, 105.0, 83.0, 163.0, 0.0, 90.0, 114.0, 15.0, 32.0, 47.0, 0.0, 114.0, 115.0, 167.0, 0.0, -88.0, 0.0, 146.0, 0.0, 33.0, 8.0, -42.0, -88.0, -71.0, -55.0, 21.0, -22.0, -20.0, 81.0, -172.0, -42.0, -157.0, 9.0, 0.0, -151.0, -66.0, -127.0, 0.0, -172.0, 127.0, 77.0, 0.0, -129.0, 44.0, 0.0, -30.0, 4.0, -107.0, -139.0, 37.0, 29.0, 36.0, 1.0, 0.0, 88.0, -107.0, -68.0, 0.0, -42.0, -98.0, -72.0, 123.0, 134.0, -132.0, -60.0, -34.0, 84.0, -58.0, -101.0, -118.0, -169.0, -182.0, -144.0, -187.0, -192.0, -167.0, -70.0, -125.0, -126.0, -129.0, -195.0, -160.0, -136.0, -22.0, 0.0, -95.0, 0.0, -113.0, -104.0, -10.0, -357.0, 4.0, -80.0, -34.0, -76.0, -141.0, -168.0, -123.0, -180.0, 67.0, -83.0, -88.0, 0.0, -90.0, -151.0, -86.0, -104.0, -132.0, -96.0, -20.0, 0.0], "policy_predator_policy_reward": [0.0, 12.0, 11.0, 1.0, 0.0, 0.0, 36.0, 0.0, 43.0, 1.0, 0.0, 9.0, 0.0, 10.0, 31.0, 0.0, 0.0, 0.0, 2.0, 0.0, 8.0, 23.0, 0.0, 4.0, 18.0, 6.0, 0.0, 16.0, 0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 8.0, 8.0, 38.0, 11.0, 0.0, 55.0, 0.0, 44.0, 8.0, 15.0, 4.0, 9.0, 0.0, 8.0, 13.0, 35.0, 2.0, 25.0, 6.0, 15.0, 106.0, 4.0, 0.0, 6.0, 0.0, 0.0, 14.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 22.0, 14.0, 12.0, 0.0, 0.0, 104.0, 0.0, 24.0, 54.0, 0.0, 0.0, 33.0, 30.0, 19.0, 11.0, 23.0, 69.0, 190.0, 8.0, 57.0, 17.0, 0.0, 17.0, 54.0, 1.0, 91.0, 46.0, 17.0, 12.0, 47.0, 15.0, 0.0, 5.0, 139.0, 0.0, 5.0, 116.0, 4.0, 85.0, 131.0, 97.0, 148.0, 20.0, 44.0, 2.0, 117.0, 186.0, 53.0, 146.0, 158.0, 26.0, 157.0, 80.0, 114.0, 162.0, 95.0, 75.0, 0.0, 131.0, 90.0, 78.0, 0.0, 57.0, 20.0, 152.0, 105.0, 110.0, 6.0, 44.0, 50.0, 10.0, 48.0, 139.0, 97.0, 65.0, 71.0, 41.0, 160.0, 39.0, 31.0, 114.0, 146.0, 127.0, 65.0, 149.0, 0.0, 121.0, 168.0, 96.0, 189.0, 194.0, 186.0, 185.0, 136.0, 145.0, 153.0, 136.0, 177.0, 173.0, 97.0, 21.0, 49.0, 138.0, 44.0, 123.0, 126.0, 357.0, 102.0, 100.0, 117.0, 16.0, 170.0, 114.0, 191.0, 186.0, 152.0, 114.0, 0.0, 94.0, 84.0, 151.0, 166.0, 83.0, 111.0, 119.0, 162.0, 62.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5942686309535063, "mean_inference_ms": 1.3421860934282412, "mean_action_processing_ms": 0.23746102530657084, "mean_env_wait_ms": 0.17773631975565646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003586411476135254, "StateBufferConnector_ms": 0.0031452178955078125, "ViewRequirementAgentConnector_ms": 0.09270215034484863}, "num_episodes": 23, "episode_return_max": 391.0, "episode_return_min": -41.0, "episode_return_mean": 157.59, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.96703543594602, "num_env_steps_trained_throughput_per_sec": 88.96703543594602, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 45386.455, "restore_workers_time_ms": 0.014, "training_step_time_ms": 45386.406, "sample_time_ms": 1064.119, "learn_time_ms": 44304.78, "learn_throughput": 90.284, "synch_weights_time_ms": 14.307}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 19, "trial_id": "51025_00000", "date": "2024-08-12_20-38-42", "timestamp": 1723509522, "time_this_iter_s": 44.9957058429718, "time_total_s": 876.6923928260803, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cb63700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 876.6923928260803, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 21.217460317460315, "ram_util_percent": 82.13809523809525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.972015737288843, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.333231586880155, "policy_loss": -0.01428827757838739, "vf_loss": 8.344772529349756, "vf_explained_var": 0.0466933789391997, "kl": 0.009157792111333484, "entropy": 1.3116424949711594, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.1304343870707925, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.055949856995275, "policy_loss": -0.012964342072576521, "vf_loss": 9.066797450232128, "vf_explained_var": 0.09528926730786681, "kl": 0.010583678498965332, "entropy": 1.3354247001113084, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 391.0, "episode_reward_min": -41.0, "episode_reward_mean": 141.17, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -357.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.0, "predator_policy": 357.0}, "policy_reward_mean": {"prey_policy": -8.295, "predator_policy": 78.88}, "custom_metrics": {}, "hist_stats": {"episode_reward": [163.0, 301.0, 306.0, 321.0, 194.0, 303.0, 313.0, 341.0, 363.0, 299.0, 251.0, 391.0, 182.0, 174.0, 0.0, 179.0, 195.0, 197.0, 173.0, 166.0, 190.0, -14.0, 149.0, 293.0, 350.0, 338.0, 7.0, 253.0, 180.0, 275.0, 139.0, 110.0, 288.0, 182.0, 56.0, 151.0, 161.0, 86.0, 119.0, 63.0, 180.0, 25.0, 156.0, 32.0, 1.0, 85.0, 279.0, 92.0, 122.0, 51.0, 11.0, 182.0, 131.0, 146.0, 61.0, 94.0, 31.0, 327.0, 68.0, 242.0, -10.0, 2.0, -41.0, 1.0, 84.0, 47.0, -11.0, -26.0, 48.0, 87.0, 32.0, 92.0, 141.0, 76.0, -4.0, 35.0, 98.0, 90.0, 76.0, 4.0, 53.0, 53.0, 101.0, 101.0, 247.0, 235.0, 112.0, -11.0, 105.0, 289.0, 262.0, 148.0, 327.0, 32.0, 179.0, 100.0, 270.0, 93.0, 31.0, 65.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [147.0, 0.0, 117.0, 135.0, 110.0, 141.0, 166.0, 111.0, -15.0, 186.0, 104.0, 186.0, 186.0, 119.0, 181.0, 112.0, 190.0, 146.0, 151.0, 127.0, 110.0, 31.0, 187.0, 198.0, 182.0, 0.0, 162.0, -2.0, 0.0, -10.0, 0.0, 179.0, 0.0, 195.0, 191.0, 1.0, -12.0, 149.0, 154.0, 0.0, 52.0, 34.0, -14.0, -24.0, 3.0, 92.0, 128.0, 132.0, 162.0, 139.0, 166.0, 138.0, -148.0, -104.0, 105.0, 83.0, 163.0, 0.0, 90.0, 114.0, 15.0, 32.0, 47.0, 0.0, 114.0, 115.0, 167.0, 0.0, -88.0, 0.0, 146.0, 0.0, 33.0, 8.0, -42.0, -88.0, -71.0, -55.0, 21.0, -22.0, -20.0, 81.0, -172.0, -42.0, -157.0, 9.0, 0.0, -151.0, -66.0, -127.0, 0.0, -172.0, 127.0, 77.0, 0.0, -129.0, 44.0, 0.0, -30.0, 4.0, -107.0, -139.0, 37.0, 29.0, 36.0, 1.0, 0.0, 88.0, -107.0, -68.0, 0.0, -42.0, -98.0, -72.0, 123.0, 134.0, -132.0, -60.0, -34.0, 84.0, -58.0, -101.0, -118.0, -169.0, -182.0, -144.0, -187.0, -192.0, -167.0, -70.0, -125.0, -126.0, -129.0, -195.0, -160.0, -136.0, -22.0, 0.0, -95.0, 0.0, -113.0, -104.0, -10.0, -357.0, 4.0, -80.0, -34.0, -76.0, -141.0, -168.0, -123.0, -180.0, 67.0, -83.0, -88.0, 0.0, -90.0, -151.0, -86.0, -104.0, -132.0, -96.0, -20.0, 0.0, 0.0, -76.0, -43.0, -61.0, -95.0, 82.0, 110.0, -78.0, -46.0, -72.0, -158.0, -37.0, 0.0, -159.0, -192.0, 100.0, -197.0, 95.0, 0.0, 14.0, -116.0, 147.0, -161.0, -172.0, -17.0, 20.0, -148.0, -68.0, 94.0, -116.0, -87.0, -93.0, -162.0, -196.0, -42.0, -95.0], "policy_predator_policy_reward": [8.0, 8.0, 38.0, 11.0, 0.0, 55.0, 0.0, 44.0, 8.0, 15.0, 4.0, 9.0, 0.0, 8.0, 13.0, 35.0, 2.0, 25.0, 6.0, 15.0, 106.0, 4.0, 0.0, 6.0, 0.0, 0.0, 14.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 22.0, 14.0, 12.0, 0.0, 0.0, 104.0, 0.0, 24.0, 54.0, 0.0, 0.0, 33.0, 30.0, 19.0, 11.0, 23.0, 69.0, 190.0, 8.0, 57.0, 17.0, 0.0, 17.0, 54.0, 1.0, 91.0, 46.0, 17.0, 12.0, 47.0, 15.0, 0.0, 5.0, 139.0, 0.0, 5.0, 116.0, 4.0, 85.0, 131.0, 97.0, 148.0, 20.0, 44.0, 2.0, 117.0, 186.0, 53.0, 146.0, 158.0, 26.0, 157.0, 80.0, 114.0, 162.0, 95.0, 75.0, 0.0, 131.0, 90.0, 78.0, 0.0, 57.0, 20.0, 152.0, 105.0, 110.0, 6.0, 44.0, 50.0, 10.0, 48.0, 139.0, 97.0, 65.0, 71.0, 41.0, 160.0, 39.0, 31.0, 114.0, 146.0, 127.0, 65.0, 149.0, 0.0, 121.0, 168.0, 96.0, 189.0, 194.0, 186.0, 185.0, 136.0, 145.0, 153.0, 136.0, 177.0, 173.0, 97.0, 21.0, 49.0, 138.0, 44.0, 123.0, 126.0, 357.0, 102.0, 100.0, 117.0, 16.0, 170.0, 114.0, 191.0, 186.0, 152.0, 114.0, 0.0, 94.0, 84.0, 151.0, 166.0, 83.0, 111.0, 119.0, 162.0, 62.0, 11.0, 85.0, 92.0, 69.0, 136.0, 173.0, 87.0, 72.0, 131.0, 120.0, 110.0, 184.0, 0.0, 111.0, 153.0, 192.0, 189.0, 168.0, 196.0, 73.0, 61.0, 159.0, 137.0, 188.0, 177.0, 96.0, 80.0, 149.0, 167.0, 150.0, 142.0, 136.0, 137.0, 194.0, 195.0, 77.0, 125.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.592429498658896, "mean_inference_ms": 1.3368833858069735, "mean_action_processing_ms": 0.23664915340517442, "mean_env_wait_ms": 0.17719826304950126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035785436630249023, "StateBufferConnector_ms": 0.003147721290588379, "ViewRequirementAgentConnector_ms": 0.09116709232330322}, "num_episodes": 18, "episode_return_max": 391.0, "episode_return_min": -41.0, "episode_return_mean": 141.17, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.31746162764402, "num_env_steps_trained_throughput_per_sec": 88.31746162764402, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 45319.838, "restore_workers_time_ms": 0.014, "training_step_time_ms": 45319.788, "sample_time_ms": 1062.962, "learn_time_ms": 44239.137, "learn_throughput": 90.418, "synch_weights_time_ms": 14.23}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 20, "trial_id": "51025_00000", "date": "2024-08-12_20-39-28", "timestamp": 1723509568, "time_this_iter_s": 45.34090185165405, "time_total_s": 922.0332946777344, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cb47940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 922.0332946777344, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 22.0890625, "ram_util_percent": 82.5828125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.116129840587182, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.160147248121797, "policy_loss": -0.014839618841417764, "vf_loss": 8.172050346899285, "vf_explained_var": 0.14723658454481256, "kl": 0.009788409606934325, "entropy": 1.247526402322073, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.544586147706976, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.26201189510406, "policy_loss": -0.012841782644735995, "vf_loss": 8.27284688899126, "vf_explained_var": 0.06416775108014465, "kl": 0.010034133930204366, "entropy": 1.3463537764927698, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 350.0, "episode_reward_min": -41.0, "episode_reward_mean": 130.76, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -357.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 167.0, "predator_policy": 357.0}, "policy_reward_mean": {"prey_policy": -27.125, "predator_policy": 92.505}, "custom_metrics": {}, "hist_stats": {"episode_reward": [173.0, 166.0, 190.0, -14.0, 149.0, 293.0, 350.0, 338.0, 7.0, 253.0, 180.0, 275.0, 139.0, 110.0, 288.0, 182.0, 56.0, 151.0, 161.0, 86.0, 119.0, 63.0, 180.0, 25.0, 156.0, 32.0, 1.0, 85.0, 279.0, 92.0, 122.0, 51.0, 11.0, 182.0, 131.0, 146.0, 61.0, 94.0, 31.0, 327.0, 68.0, 242.0, -10.0, 2.0, -41.0, 1.0, 84.0, 47.0, -11.0, -26.0, 48.0, 87.0, 32.0, 92.0, 141.0, 76.0, -4.0, 35.0, 98.0, 90.0, 76.0, 4.0, 53.0, 53.0, 101.0, 101.0, 247.0, 235.0, 112.0, -11.0, 105.0, 289.0, 262.0, 148.0, 327.0, 32.0, 179.0, 100.0, 270.0, 93.0, 31.0, 65.0, 191.0, 142.0, 158.0, 264.0, 183.0, 155.0, 252.0, 168.0, 82.0, 151.0, 206.0, 160.0, 140.0, 203.0, 166.0, 334.0, 245.0, 232.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-12.0, 149.0, 154.0, 0.0, 52.0, 34.0, -14.0, -24.0, 3.0, 92.0, 128.0, 132.0, 162.0, 139.0, 166.0, 138.0, -148.0, -104.0, 105.0, 83.0, 163.0, 0.0, 90.0, 114.0, 15.0, 32.0, 47.0, 0.0, 114.0, 115.0, 167.0, 0.0, -88.0, 0.0, 146.0, 0.0, 33.0, 8.0, -42.0, -88.0, -71.0, -55.0, 21.0, -22.0, -20.0, 81.0, -172.0, -42.0, -157.0, 9.0, 0.0, -151.0, -66.0, -127.0, 0.0, -172.0, 127.0, 77.0, 0.0, -129.0, 44.0, 0.0, -30.0, 4.0, -107.0, -139.0, 37.0, 29.0, 36.0, 1.0, 0.0, 88.0, -107.0, -68.0, 0.0, -42.0, -98.0, -72.0, 123.0, 134.0, -132.0, -60.0, -34.0, 84.0, -58.0, -101.0, -118.0, -169.0, -182.0, -144.0, -187.0, -192.0, -167.0, -70.0, -125.0, -126.0, -129.0, -195.0, -160.0, -136.0, -22.0, 0.0, -95.0, 0.0, -113.0, -104.0, -10.0, -357.0, 4.0, -80.0, -34.0, -76.0, -141.0, -168.0, -123.0, -180.0, 67.0, -83.0, -88.0, 0.0, -90.0, -151.0, -86.0, -104.0, -132.0, -96.0, -20.0, 0.0, 0.0, -76.0, -43.0, -61.0, -95.0, 82.0, 110.0, -78.0, -46.0, -72.0, -158.0, -37.0, 0.0, -159.0, -192.0, 100.0, -197.0, 95.0, 0.0, 14.0, -116.0, 147.0, -161.0, -172.0, -17.0, 20.0, -148.0, -68.0, 94.0, -116.0, -87.0, -93.0, -162.0, -196.0, -42.0, -95.0, 88.0, -107.0, -37.0, -118.0, -72.0, -100.0, 140.0, 49.0, 2.0, 72.0, -46.0, -31.0, -24.0, 114.0, 0.0, 40.0, 0.0, -110.0, 88.0, -63.0, 70.0, -152.0, 86.0, 0.0, 37.0, 0.0, 65.0, -88.0, 102.0, 0.0, -118.0, 166.0, -51.0, 110.0, 122.0, 24.0], "policy_predator_policy_reward": [22.0, 14.0, 12.0, 0.0, 0.0, 104.0, 0.0, 24.0, 54.0, 0.0, 0.0, 33.0, 30.0, 19.0, 11.0, 23.0, 69.0, 190.0, 8.0, 57.0, 17.0, 0.0, 17.0, 54.0, 1.0, 91.0, 46.0, 17.0, 12.0, 47.0, 15.0, 0.0, 5.0, 139.0, 0.0, 5.0, 116.0, 4.0, 85.0, 131.0, 97.0, 148.0, 20.0, 44.0, 2.0, 117.0, 186.0, 53.0, 146.0, 158.0, 26.0, 157.0, 80.0, 114.0, 162.0, 95.0, 75.0, 0.0, 131.0, 90.0, 78.0, 0.0, 57.0, 20.0, 152.0, 105.0, 110.0, 6.0, 44.0, 50.0, 10.0, 48.0, 139.0, 97.0, 65.0, 71.0, 41.0, 160.0, 39.0, 31.0, 114.0, 146.0, 127.0, 65.0, 149.0, 0.0, 121.0, 168.0, 96.0, 189.0, 194.0, 186.0, 185.0, 136.0, 145.0, 153.0, 136.0, 177.0, 173.0, 97.0, 21.0, 49.0, 138.0, 44.0, 123.0, 126.0, 357.0, 102.0, 100.0, 117.0, 16.0, 170.0, 114.0, 191.0, 186.0, 152.0, 114.0, 0.0, 94.0, 84.0, 151.0, 166.0, 83.0, 111.0, 119.0, 162.0, 62.0, 11.0, 85.0, 92.0, 69.0, 136.0, 173.0, 87.0, 72.0, 131.0, 120.0, 110.0, 184.0, 0.0, 111.0, 153.0, 192.0, 189.0, 168.0, 196.0, 73.0, 61.0, 159.0, 137.0, 188.0, 177.0, 96.0, 80.0, 149.0, 167.0, 150.0, 142.0, 136.0, 137.0, 194.0, 195.0, 77.0, 125.0, 98.0, 112.0, 133.0, 164.0, 182.0, 148.0, 63.0, 12.0, 53.0, 56.0, 113.0, 119.0, 38.0, 124.0, 67.0, 61.0, 94.0, 98.0, 63.0, 63.0, 131.0, 157.0, 35.0, 39.0, 27.0, 76.0, 92.0, 134.0, 33.0, 31.0, 125.0, 161.0, 82.0, 104.0, 0.0, 86.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5904272977407948, "mean_inference_ms": 1.3317923191807681, "mean_action_processing_ms": 0.23586257898283003, "mean_env_wait_ms": 0.1767925095658964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003636002540588379, "StateBufferConnector_ms": 0.0031887292861938477, "ViewRequirementAgentConnector_ms": 0.09249258041381836}, "num_episodes": 18, "episode_return_max": 350.0, "episode_return_min": -41.0, "episode_return_mean": 130.76, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 87.97979388629639, "num_env_steps_trained_throughput_per_sec": 87.97979388629639, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 45342.591, "restore_workers_time_ms": 0.014, "training_step_time_ms": 45342.54, "sample_time_ms": 1061.029, "learn_time_ms": 44263.569, "learn_throughput": 90.368, "synch_weights_time_ms": 14.373}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 21, "trial_id": "51025_00000", "date": "2024-08-12_20-40-13", "timestamp": 1723509613, "time_this_iter_s": 45.500787019729614, "time_total_s": 967.534081697464, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cb7c3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 967.534081697464, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 22.847692307692306, "ram_util_percent": 82.58307692307693}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.449169436144451, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.198249910748194, "policy_loss": -0.017121820369114478, "vf_loss": 8.212298984628505, "vf_explained_var": 0.2512751211249639, "kl": 0.010242547774845102, "entropy": 1.1893828070352948, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.751962328335596, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.968173952960464, "policy_loss": -0.014962802893265332, "vf_loss": 6.980953655041084, "vf_explained_var": 0.08212217947162648, "kl": 0.010915465569611007, "entropy": 1.3170393203301405, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 334.0, "episode_reward_min": -41.0, "episode_reward_mean": 138.84, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -357.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 184.0, "predator_policy": 357.0}, "policy_reward_mean": {"prey_policy": -28.425, "predator_policy": 97.845}, "custom_metrics": {}, "hist_stats": {"episode_reward": [161.0, 86.0, 119.0, 63.0, 180.0, 25.0, 156.0, 32.0, 1.0, 85.0, 279.0, 92.0, 122.0, 51.0, 11.0, 182.0, 131.0, 146.0, 61.0, 94.0, 31.0, 327.0, 68.0, 242.0, -10.0, 2.0, -41.0, 1.0, 84.0, 47.0, -11.0, -26.0, 48.0, 87.0, 32.0, 92.0, 141.0, 76.0, -4.0, 35.0, 98.0, 90.0, 76.0, 4.0, 53.0, 53.0, 101.0, 101.0, 247.0, 235.0, 112.0, -11.0, 105.0, 289.0, 262.0, 148.0, 327.0, 32.0, 179.0, 100.0, 270.0, 93.0, 31.0, 65.0, 191.0, 142.0, 158.0, 264.0, 183.0, 155.0, 252.0, 168.0, 82.0, 151.0, 206.0, 160.0, 140.0, 203.0, 166.0, 334.0, 245.0, 232.0, 240.0, 177.0, 263.0, 278.0, 142.0, 332.0, 242.0, 241.0, 146.0, 195.0, 188.0, 135.0, 199.0, 289.0, 195.0, 232.0, 300.0, 300.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [33.0, 8.0, -42.0, -88.0, -71.0, -55.0, 21.0, -22.0, -20.0, 81.0, -172.0, -42.0, -157.0, 9.0, 0.0, -151.0, -66.0, -127.0, 0.0, -172.0, 127.0, 77.0, 0.0, -129.0, 44.0, 0.0, -30.0, 4.0, -107.0, -139.0, 37.0, 29.0, 36.0, 1.0, 0.0, 88.0, -107.0, -68.0, 0.0, -42.0, -98.0, -72.0, 123.0, 134.0, -132.0, -60.0, -34.0, 84.0, -58.0, -101.0, -118.0, -169.0, -182.0, -144.0, -187.0, -192.0, -167.0, -70.0, -125.0, -126.0, -129.0, -195.0, -160.0, -136.0, -22.0, 0.0, -95.0, 0.0, -113.0, -104.0, -10.0, -357.0, 4.0, -80.0, -34.0, -76.0, -141.0, -168.0, -123.0, -180.0, 67.0, -83.0, -88.0, 0.0, -90.0, -151.0, -86.0, -104.0, -132.0, -96.0, -20.0, 0.0, 0.0, -76.0, -43.0, -61.0, -95.0, 82.0, 110.0, -78.0, -46.0, -72.0, -158.0, -37.0, 0.0, -159.0, -192.0, 100.0, -197.0, 95.0, 0.0, 14.0, -116.0, 147.0, -161.0, -172.0, -17.0, 20.0, -148.0, -68.0, 94.0, -116.0, -87.0, -93.0, -162.0, -196.0, -42.0, -95.0, 88.0, -107.0, -37.0, -118.0, -72.0, -100.0, 140.0, 49.0, 2.0, 72.0, -46.0, -31.0, -24.0, 114.0, 0.0, 40.0, 0.0, -110.0, 88.0, -63.0, 70.0, -152.0, 86.0, 0.0, 37.0, 0.0, 65.0, -88.0, 102.0, 0.0, -118.0, 166.0, -51.0, 110.0, 122.0, 24.0, -132.0, 78.0, 153.0, 0.0, -12.0, 74.0, 90.0, 84.0, -1.0, 0.0, 184.0, 96.0, 91.0, 84.0, 60.0, 77.0, 68.0, 0.0, -65.0, 51.0, 47.0, -54.0, 0.0, 31.0, 48.0, 48.0, 122.0, 98.0, 60.0, 42.0, -21.0, 134.0, 63.0, 77.0, 153.0, 62.0], "policy_predator_policy_reward": [116.0, 4.0, 85.0, 131.0, 97.0, 148.0, 20.0, 44.0, 2.0, 117.0, 186.0, 53.0, 146.0, 158.0, 26.0, 157.0, 80.0, 114.0, 162.0, 95.0, 75.0, 0.0, 131.0, 90.0, 78.0, 0.0, 57.0, 20.0, 152.0, 105.0, 110.0, 6.0, 44.0, 50.0, 10.0, 48.0, 139.0, 97.0, 65.0, 71.0, 41.0, 160.0, 39.0, 31.0, 114.0, 146.0, 127.0, 65.0, 149.0, 0.0, 121.0, 168.0, 96.0, 189.0, 194.0, 186.0, 185.0, 136.0, 145.0, 153.0, 136.0, 177.0, 173.0, 97.0, 21.0, 49.0, 138.0, 44.0, 123.0, 126.0, 357.0, 102.0, 100.0, 117.0, 16.0, 170.0, 114.0, 191.0, 186.0, 152.0, 114.0, 0.0, 94.0, 84.0, 151.0, 166.0, 83.0, 111.0, 119.0, 162.0, 62.0, 11.0, 85.0, 92.0, 69.0, 136.0, 173.0, 87.0, 72.0, 131.0, 120.0, 110.0, 184.0, 0.0, 111.0, 153.0, 192.0, 189.0, 168.0, 196.0, 73.0, 61.0, 159.0, 137.0, 188.0, 177.0, 96.0, 80.0, 149.0, 167.0, 150.0, 142.0, 136.0, 137.0, 194.0, 195.0, 77.0, 125.0, 98.0, 112.0, 133.0, 164.0, 182.0, 148.0, 63.0, 12.0, 53.0, 56.0, 113.0, 119.0, 38.0, 124.0, 67.0, 61.0, 94.0, 98.0, 63.0, 63.0, 131.0, 157.0, 35.0, 39.0, 27.0, 76.0, 92.0, 134.0, 33.0, 31.0, 125.0, 161.0, 82.0, 104.0, 0.0, 86.0, 156.0, 138.0, 5.0, 19.0, 89.0, 112.0, 62.0, 42.0, 59.0, 84.0, 0.0, 52.0, 41.0, 26.0, 48.0, 56.0, 36.0, 42.0, 95.0, 114.0, 68.0, 127.0, 40.0, 64.0, 20.0, 83.0, 9.0, 60.0, 0.0, 93.0, 71.0, 48.0, 93.0, 67.0, 6.0, 79.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.588389169403992, "mean_inference_ms": 1.326874672559499, "mean_action_processing_ms": 0.23507040328015705, "mean_env_wait_ms": 0.1762918925695397, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036367177963256836, "StateBufferConnector_ms": 0.0030879974365234375, "ViewRequirementAgentConnector_ms": 0.09301722049713135}, "num_episodes": 18, "episode_return_max": 334.0, "episode_return_min": -41.0, "episode_return_mean": 138.84, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 86.34777164396995, "num_env_steps_trained_throughput_per_sec": 86.34777164396995, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 45414.24, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45414.192, "sample_time_ms": 1059.362, "learn_time_ms": 44337.153, "learn_throughput": 90.218, "synch_weights_time_ms": 14.347}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 22, "trial_id": "51025_00000", "date": "2024-08-12_20-41-00", "timestamp": 1723509660, "time_this_iter_s": 46.35971713066101, "time_total_s": 1013.893798828125, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cb63700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1013.893798828125, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 24.57076923076923, "ram_util_percent": 82.52615384615385}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.038894919491319, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.903059745970227, "policy_loss": -0.010877320921743318, "vf_loss": 7.91147142667619, "vf_explained_var": 0.10709299438844913, "kl": 0.008218777045900549, "entropy": 1.1396925120126633, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.629369978803807, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.48647712248343, "policy_loss": -0.015809225892184902, "vf_loss": 6.499706862464784, "vf_explained_var": 0.07661303865215766, "kl": 0.01289739040509197, "entropy": 1.2964894398810372, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 334.0, "episode_reward_min": -26.0, "episode_reward_mean": 162.06, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -357.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.0, "predator_policy": 357.0}, "policy_reward_mean": {"prey_policy": -8.49, "predator_policy": 89.52}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.0, 84.0, 47.0, -11.0, -26.0, 48.0, 87.0, 32.0, 92.0, 141.0, 76.0, -4.0, 35.0, 98.0, 90.0, 76.0, 4.0, 53.0, 53.0, 101.0, 101.0, 247.0, 235.0, 112.0, -11.0, 105.0, 289.0, 262.0, 148.0, 327.0, 32.0, 179.0, 100.0, 270.0, 93.0, 31.0, 65.0, 191.0, 142.0, 158.0, 264.0, 183.0, 155.0, 252.0, 168.0, 82.0, 151.0, 206.0, 160.0, 140.0, 203.0, 166.0, 334.0, 245.0, 232.0, 240.0, 177.0, 263.0, 278.0, 142.0, 332.0, 242.0, 241.0, 146.0, 195.0, 188.0, 135.0, 199.0, 289.0, 195.0, 232.0, 300.0, 300.0, 236.0, 131.0, 9.0, 301.0, 184.0, 150.0, 164.0, 140.0, 331.0, 252.0, 0.0, 276.0, 231.0, 236.0, 209.0, 147.0, 245.0, 181.0, 99.0, 222.0, 171.0, 298.0, 288.0, 111.0, 135.0, 171.0, 100.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-187.0, -192.0, -167.0, -70.0, -125.0, -126.0, -129.0, -195.0, -160.0, -136.0, -22.0, 0.0, -95.0, 0.0, -113.0, -104.0, -10.0, -357.0, 4.0, -80.0, -34.0, -76.0, -141.0, -168.0, -123.0, -180.0, 67.0, -83.0, -88.0, 0.0, -90.0, -151.0, -86.0, -104.0, -132.0, -96.0, -20.0, 0.0, 0.0, -76.0, -43.0, -61.0, -95.0, 82.0, 110.0, -78.0, -46.0, -72.0, -158.0, -37.0, 0.0, -159.0, -192.0, 100.0, -197.0, 95.0, 0.0, 14.0, -116.0, 147.0, -161.0, -172.0, -17.0, 20.0, -148.0, -68.0, 94.0, -116.0, -87.0, -93.0, -162.0, -196.0, -42.0, -95.0, 88.0, -107.0, -37.0, -118.0, -72.0, -100.0, 140.0, 49.0, 2.0, 72.0, -46.0, -31.0, -24.0, 114.0, 0.0, 40.0, 0.0, -110.0, 88.0, -63.0, 70.0, -152.0, 86.0, 0.0, 37.0, 0.0, 65.0, -88.0, 102.0, 0.0, -118.0, 166.0, -51.0, 110.0, 122.0, 24.0, -132.0, 78.0, 153.0, 0.0, -12.0, 74.0, 90.0, 84.0, -1.0, 0.0, 184.0, 96.0, 91.0, 84.0, 60.0, 77.0, 68.0, 0.0, -65.0, 51.0, 47.0, -54.0, 0.0, 31.0, 48.0, 48.0, 122.0, 98.0, 60.0, 42.0, -21.0, 134.0, 63.0, 77.0, 153.0, 62.0, 50.0, 60.0, -10.0, 30.0, -90.0, -98.0, 128.0, 50.0, 32.0, 39.0, 0.0, 92.0, 108.0, 0.0, -30.0, -1.0, 86.0, 174.0, 78.0, 70.0, 0.0, 0.0, 92.0, -35.0, 82.0, 132.0, 102.0, 36.0, 43.0, 24.0, 18.0, -106.0, 114.0, 74.0, 4.0, 71.0, 0.0, 79.0, 24.0, 198.0, -94.0, 47.0, -114.0, 172.0, 139.0, 115.0, 20.0, 0.0, 0.0, 74.0, -87.0, -16.0, 0.0, -28.0], "policy_predator_policy_reward": [194.0, 186.0, 185.0, 136.0, 145.0, 153.0, 136.0, 177.0, 173.0, 97.0, 21.0, 49.0, 138.0, 44.0, 123.0, 126.0, 357.0, 102.0, 100.0, 117.0, 16.0, 170.0, 114.0, 191.0, 186.0, 152.0, 114.0, 0.0, 94.0, 84.0, 151.0, 166.0, 83.0, 111.0, 119.0, 162.0, 62.0, 11.0, 85.0, 92.0, 69.0, 136.0, 173.0, 87.0, 72.0, 131.0, 120.0, 110.0, 184.0, 0.0, 111.0, 153.0, 192.0, 189.0, 168.0, 196.0, 73.0, 61.0, 159.0, 137.0, 188.0, 177.0, 96.0, 80.0, 149.0, 167.0, 150.0, 142.0, 136.0, 137.0, 194.0, 195.0, 77.0, 125.0, 98.0, 112.0, 133.0, 164.0, 182.0, 148.0, 63.0, 12.0, 53.0, 56.0, 113.0, 119.0, 38.0, 124.0, 67.0, 61.0, 94.0, 98.0, 63.0, 63.0, 131.0, 157.0, 35.0, 39.0, 27.0, 76.0, 92.0, 134.0, 33.0, 31.0, 125.0, 161.0, 82.0, 104.0, 0.0, 86.0, 156.0, 138.0, 5.0, 19.0, 89.0, 112.0, 62.0, 42.0, 59.0, 84.0, 0.0, 52.0, 41.0, 26.0, 48.0, 56.0, 36.0, 42.0, 95.0, 114.0, 68.0, 127.0, 40.0, 64.0, 20.0, 83.0, 9.0, 60.0, 0.0, 93.0, 71.0, 48.0, 93.0, 67.0, 6.0, 79.0, 100.0, 26.0, 106.0, 5.0, 70.0, 127.0, 64.0, 59.0, 59.0, 54.0, 28.0, 30.0, 35.0, 21.0, 96.0, 75.0, 36.0, 35.0, 31.0, 73.0, 0.0, 0.0, 126.0, 93.0, 15.0, 2.0, 24.0, 74.0, 70.0, 72.0, 119.0, 116.0, 52.0, 5.0, 81.0, 25.0, 8.0, 12.0, 0.0, 0.0, 123.0, 95.0, 122.0, 118.0, 33.0, 1.0, 6.0, 85.0, 22.0, 39.0, 144.0, 130.0, 75.0, 53.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5861918361387916, "mean_inference_ms": 1.3206674888259249, "mean_action_processing_ms": 0.2339783757069803, "mean_env_wait_ms": 0.17547622060156004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004534602165222168, "StateBufferConnector_ms": 0.0034846067428588867, "ViewRequirementAgentConnector_ms": 0.10432291030883789}, "num_episodes": 27, "episode_return_max": 334.0, "episode_return_min": -26.0, "episode_return_mean": 162.06, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 89.04682384970508, "num_env_steps_trained_throughput_per_sec": 89.04682384970508, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 45378.074, "restore_workers_time_ms": 0.014, "training_step_time_ms": 45378.026, "sample_time_ms": 1056.403, "learn_time_ms": 44304.433, "learn_throughput": 90.284, "synch_weights_time_ms": 13.996}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 23, "trial_id": "51025_00000", "date": "2024-08-12_20-41-45", "timestamp": 1723509705, "time_this_iter_s": 44.97105407714844, "time_total_s": 1058.8648529052734, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cb6c550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1058.8648529052734, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 21.1578125, "ram_util_percent": 80.7015625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.820995893932524, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.910652135415052, "policy_loss": -0.009893088801837866, "vf_loss": 7.918780826639246, "vf_explained_var": -0.13190105916961792, "kl": 0.00588127533285266, "entropy": 1.100631170234983, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.757171691031683, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.861165309330774, "policy_loss": -0.016150262830138363, "vf_loss": 6.874728742982976, "vf_explained_var": 0.11606243391516348, "kl": 0.012934251456978168, "entropy": 1.2755107781243702, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 334.0, "episode_reward_min": -125.0, "episode_reward_mean": 169.23, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -197.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.0, "predator_policy": 196.0}, "policy_reward_mean": {"prey_policy": 6.075, "predator_policy": 78.54}, "custom_metrics": {}, "hist_stats": {"episode_reward": [53.0, 101.0, 101.0, 247.0, 235.0, 112.0, -11.0, 105.0, 289.0, 262.0, 148.0, 327.0, 32.0, 179.0, 100.0, 270.0, 93.0, 31.0, 65.0, 191.0, 142.0, 158.0, 264.0, 183.0, 155.0, 252.0, 168.0, 82.0, 151.0, 206.0, 160.0, 140.0, 203.0, 166.0, 334.0, 245.0, 232.0, 240.0, 177.0, 263.0, 278.0, 142.0, 332.0, 242.0, 241.0, 146.0, 195.0, 188.0, 135.0, 199.0, 289.0, 195.0, 232.0, 300.0, 300.0, 236.0, 131.0, 9.0, 301.0, 184.0, 150.0, 164.0, 140.0, 331.0, 252.0, 0.0, 276.0, 231.0, 236.0, 209.0, 147.0, 245.0, 181.0, 99.0, 222.0, 171.0, 298.0, 288.0, 111.0, 135.0, 171.0, 100.0, 104.0, 254.0, 78.0, 88.0, -109.0, 8.0, 84.0, 194.0, -125.0, 90.0, 113.0, 92.0, 10.0, 180.0, 36.0, 260.0, 79.0, 204.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-20.0, 0.0, 0.0, -76.0, -43.0, -61.0, -95.0, 82.0, 110.0, -78.0, -46.0, -72.0, -158.0, -37.0, 0.0, -159.0, -192.0, 100.0, -197.0, 95.0, 0.0, 14.0, -116.0, 147.0, -161.0, -172.0, -17.0, 20.0, -148.0, -68.0, 94.0, -116.0, -87.0, -93.0, -162.0, -196.0, -42.0, -95.0, 88.0, -107.0, -37.0, -118.0, -72.0, -100.0, 140.0, 49.0, 2.0, 72.0, -46.0, -31.0, -24.0, 114.0, 0.0, 40.0, 0.0, -110.0, 88.0, -63.0, 70.0, -152.0, 86.0, 0.0, 37.0, 0.0, 65.0, -88.0, 102.0, 0.0, -118.0, 166.0, -51.0, 110.0, 122.0, 24.0, -132.0, 78.0, 153.0, 0.0, -12.0, 74.0, 90.0, 84.0, -1.0, 0.0, 184.0, 96.0, 91.0, 84.0, 60.0, 77.0, 68.0, 0.0, -65.0, 51.0, 47.0, -54.0, 0.0, 31.0, 48.0, 48.0, 122.0, 98.0, 60.0, 42.0, -21.0, 134.0, 63.0, 77.0, 153.0, 62.0, 50.0, 60.0, -10.0, 30.0, -90.0, -98.0, 128.0, 50.0, 32.0, 39.0, 0.0, 92.0, 108.0, 0.0, -30.0, -1.0, 86.0, 174.0, 78.0, 70.0, 0.0, 0.0, 92.0, -35.0, 82.0, 132.0, 102.0, 36.0, 43.0, 24.0, 18.0, -106.0, 114.0, 74.0, 4.0, 71.0, 0.0, 79.0, 24.0, 198.0, -94.0, 47.0, -114.0, 172.0, 139.0, 115.0, 20.0, 0.0, 0.0, 74.0, -87.0, -16.0, 0.0, -28.0, -102.0, -2.0, 100.0, 78.0, -60.0, 0.0, 0.0, -61.0, -130.0, -173.0, -130.0, -115.0, -33.0, 0.0, -46.0, 110.0, -192.0, -184.0, -130.0, 38.0, -90.0, -6.0, 14.0, -61.0, 9.0, 1.0, 0.0, 160.0, -40.0, -37.0, 117.0, 46.0, -29.0, 6.0, 62.0, 44.0], "policy_predator_policy_reward": [62.0, 11.0, 85.0, 92.0, 69.0, 136.0, 173.0, 87.0, 72.0, 131.0, 120.0, 110.0, 184.0, 0.0, 111.0, 153.0, 192.0, 189.0, 168.0, 196.0, 73.0, 61.0, 159.0, 137.0, 188.0, 177.0, 96.0, 80.0, 149.0, 167.0, 150.0, 142.0, 136.0, 137.0, 194.0, 195.0, 77.0, 125.0, 98.0, 112.0, 133.0, 164.0, 182.0, 148.0, 63.0, 12.0, 53.0, 56.0, 113.0, 119.0, 38.0, 124.0, 67.0, 61.0, 94.0, 98.0, 63.0, 63.0, 131.0, 157.0, 35.0, 39.0, 27.0, 76.0, 92.0, 134.0, 33.0, 31.0, 125.0, 161.0, 82.0, 104.0, 0.0, 86.0, 156.0, 138.0, 5.0, 19.0, 89.0, 112.0, 62.0, 42.0, 59.0, 84.0, 0.0, 52.0, 41.0, 26.0, 48.0, 56.0, 36.0, 42.0, 95.0, 114.0, 68.0, 127.0, 40.0, 64.0, 20.0, 83.0, 9.0, 60.0, 0.0, 93.0, 71.0, 48.0, 93.0, 67.0, 6.0, 79.0, 100.0, 26.0, 106.0, 5.0, 70.0, 127.0, 64.0, 59.0, 59.0, 54.0, 28.0, 30.0, 35.0, 21.0, 96.0, 75.0, 36.0, 35.0, 31.0, 73.0, 0.0, 0.0, 126.0, 93.0, 15.0, 2.0, 24.0, 74.0, 70.0, 72.0, 119.0, 116.0, 52.0, 5.0, 81.0, 25.0, 8.0, 12.0, 0.0, 0.0, 123.0, 95.0, 122.0, 118.0, 33.0, 1.0, 6.0, 85.0, 22.0, 39.0, 144.0, 130.0, 75.0, 53.0, 149.0, 59.0, 19.0, 57.0, 118.0, 20.0, 66.0, 83.0, 186.0, 8.0, 138.0, 115.0, 97.0, 20.0, 95.0, 35.0, 67.0, 184.0, 161.0, 21.0, 107.0, 102.0, 65.0, 74.0, 0.0, 0.0, 0.0, 20.0, 112.0, 1.0, 49.0, 48.0, 79.0, 23.0, 25.0, 73.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5856292441129637, "mean_inference_ms": 1.3172631636555046, "mean_action_processing_ms": 0.23348729623931733, "mean_env_wait_ms": 0.17511211151248574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008725523948669434, "StateBufferConnector_ms": 0.003432750701904297, "ViewRequirementAgentConnector_ms": 0.10366737842559814}, "num_episodes": 18, "episode_return_max": 334.0, "episode_return_min": -125.0, "episode_return_mean": 169.23, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.8591329117004, "num_env_steps_trained_throughput_per_sec": 88.8591329117004, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 45296.69, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45296.643, "sample_time_ms": 1060.691, "learn_time_ms": 44218.892, "learn_throughput": 90.459, "synch_weights_time_ms": 14.16}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 24, "trial_id": "51025_00000", "date": "2024-08-12_20-42-30", "timestamp": 1723509750, "time_this_iter_s": 45.052778005599976, "time_total_s": 1103.9176309108734, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cb38ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1103.9176309108734, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 20.879687500000003, "ram_util_percent": 81.196875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.578885292407697, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.530491602357733, "policy_loss": -0.009683805797618652, "vf_loss": 8.537871387522056, "vf_explained_var": -0.375118314841437, "kl": 0.00768008953234832, "entropy": 1.1167911998178592, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.23856243639396, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.11508293757363, "policy_loss": -0.016396102367373055, "vf_loss": 8.129014986785, "vf_explained_var": 0.14361453330706037, "kl": 0.012320277540221048, "entropy": 1.2269540255031888, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 334.0, "episode_reward_min": -125.0, "episode_reward_mean": 146.26, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -200.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.0, "predator_policy": 196.0}, "policy_reward_mean": {"prey_policy": -3.17, "predator_policy": 76.3}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0, 191.0, 142.0, 158.0, 264.0, 183.0, 155.0, 252.0, 168.0, 82.0, 151.0, 206.0, 160.0, 140.0, 203.0, 166.0, 334.0, 245.0, 232.0, 240.0, 177.0, 263.0, 278.0, 142.0, 332.0, 242.0, 241.0, 146.0, 195.0, 188.0, 135.0, 199.0, 289.0, 195.0, 232.0, 300.0, 300.0, 236.0, 131.0, 9.0, 301.0, 184.0, 150.0, 164.0, 140.0, 331.0, 252.0, 0.0, 276.0, 231.0, 236.0, 209.0, 147.0, 245.0, 181.0, 99.0, 222.0, 171.0, 298.0, 288.0, 111.0, 135.0, 171.0, 100.0, 104.0, 254.0, 78.0, 88.0, -109.0, 8.0, 84.0, 194.0, -125.0, 90.0, 113.0, 92.0, 10.0, 180.0, 36.0, 260.0, 79.0, 204.0, 54.0, 71.0, 63.0, -55.0, -50.0, 157.0, 22.0, -26.0, 70.0, 2.0, 95.0, 24.0, 83.0, -123.0, -78.0, 163.0, -96.0, 1.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-42.0, -95.0, 88.0, -107.0, -37.0, -118.0, -72.0, -100.0, 140.0, 49.0, 2.0, 72.0, -46.0, -31.0, -24.0, 114.0, 0.0, 40.0, 0.0, -110.0, 88.0, -63.0, 70.0, -152.0, 86.0, 0.0, 37.0, 0.0, 65.0, -88.0, 102.0, 0.0, -118.0, 166.0, -51.0, 110.0, 122.0, 24.0, -132.0, 78.0, 153.0, 0.0, -12.0, 74.0, 90.0, 84.0, -1.0, 0.0, 184.0, 96.0, 91.0, 84.0, 60.0, 77.0, 68.0, 0.0, -65.0, 51.0, 47.0, -54.0, 0.0, 31.0, 48.0, 48.0, 122.0, 98.0, 60.0, 42.0, -21.0, 134.0, 63.0, 77.0, 153.0, 62.0, 50.0, 60.0, -10.0, 30.0, -90.0, -98.0, 128.0, 50.0, 32.0, 39.0, 0.0, 92.0, 108.0, 0.0, -30.0, -1.0, 86.0, 174.0, 78.0, 70.0, 0.0, 0.0, 92.0, -35.0, 82.0, 132.0, 102.0, 36.0, 43.0, 24.0, 18.0, -106.0, 114.0, 74.0, 4.0, 71.0, 0.0, 79.0, 24.0, 198.0, -94.0, 47.0, -114.0, 172.0, 139.0, 115.0, 20.0, 0.0, 0.0, 74.0, -87.0, -16.0, 0.0, -28.0, -102.0, -2.0, 100.0, 78.0, -60.0, 0.0, 0.0, -61.0, -130.0, -173.0, -130.0, -115.0, -33.0, 0.0, -46.0, 110.0, -192.0, -184.0, -130.0, 38.0, -90.0, -6.0, 14.0, -61.0, 9.0, 1.0, 0.0, 160.0, -40.0, -37.0, 117.0, 46.0, -29.0, 6.0, 62.0, 44.0, -70.0, -90.0, -90.0, 0.0, -122.0, -134.0, -86.0, -200.0, -136.0, -143.0, -200.0, 0.0, -102.0, -108.0, -151.0, -108.0, -92.0, -16.0, -161.0, -130.0, -158.0, 0.0, -18.0, -80.0, -30.0, 66.0, -160.0, -193.0, -184.0, -154.0, -164.0, 0.0, -178.0, -150.0, -75.0, -140.0], "policy_predator_policy_reward": [77.0, 125.0, 98.0, 112.0, 133.0, 164.0, 182.0, 148.0, 63.0, 12.0, 53.0, 56.0, 113.0, 119.0, 38.0, 124.0, 67.0, 61.0, 94.0, 98.0, 63.0, 63.0, 131.0, 157.0, 35.0, 39.0, 27.0, 76.0, 92.0, 134.0, 33.0, 31.0, 125.0, 161.0, 82.0, 104.0, 0.0, 86.0, 156.0, 138.0, 5.0, 19.0, 89.0, 112.0, 62.0, 42.0, 59.0, 84.0, 0.0, 52.0, 41.0, 26.0, 48.0, 56.0, 36.0, 42.0, 95.0, 114.0, 68.0, 127.0, 40.0, 64.0, 20.0, 83.0, 9.0, 60.0, 0.0, 93.0, 71.0, 48.0, 93.0, 67.0, 6.0, 79.0, 100.0, 26.0, 106.0, 5.0, 70.0, 127.0, 64.0, 59.0, 59.0, 54.0, 28.0, 30.0, 35.0, 21.0, 96.0, 75.0, 36.0, 35.0, 31.0, 73.0, 0.0, 0.0, 126.0, 93.0, 15.0, 2.0, 24.0, 74.0, 70.0, 72.0, 119.0, 116.0, 52.0, 5.0, 81.0, 25.0, 8.0, 12.0, 0.0, 0.0, 123.0, 95.0, 122.0, 118.0, 33.0, 1.0, 6.0, 85.0, 22.0, 39.0, 144.0, 130.0, 75.0, 53.0, 149.0, 59.0, 19.0, 57.0, 118.0, 20.0, 66.0, 83.0, 186.0, 8.0, 138.0, 115.0, 97.0, 20.0, 95.0, 35.0, 67.0, 184.0, 161.0, 21.0, 107.0, 102.0, 65.0, 74.0, 0.0, 0.0, 0.0, 20.0, 112.0, 1.0, 49.0, 48.0, 79.0, 23.0, 25.0, 73.0, 151.0, 63.0, 44.0, 117.0, 158.0, 161.0, 181.0, 50.0, 68.0, 161.0, 191.0, 166.0, 154.0, 78.0, 176.0, 57.0, 39.0, 139.0, 142.0, 151.0, 178.0, 75.0, 36.0, 86.0, 47.0, 0.0, 196.0, 34.0, 192.0, 68.0, 146.0, 181.0, 184.0, 48.0, 79.0, 137.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5851436874998432, "mean_inference_ms": 1.314555236841603, "mean_action_processing_ms": 0.23302386262258082, "mean_env_wait_ms": 0.17480358286351055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009384393692016602, "StateBufferConnector_ms": 0.0034099817276000977, "ViewRequirementAgentConnector_ms": 0.10301196575164795}, "num_episodes": 18, "episode_return_max": 334.0, "episode_return_min": -125.0, "episode_return_mean": 146.26, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.23973220572223, "num_env_steps_trained_throughput_per_sec": 88.23973220572223, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 45331.851, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45331.802, "sample_time_ms": 1059.57, "learn_time_ms": 44254.147, "learn_throughput": 90.387, "synch_weights_time_ms": 14.352}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 25, "trial_id": "51025_00000", "date": "2024-08-12_20-43-15", "timestamp": 1723509795, "time_this_iter_s": 45.40922212600708, "time_total_s": 1149.3268530368805, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cb6c160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1149.3268530368805, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 21.275, "ram_util_percent": 81.178125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.3214314814597845, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.486320536477225, "policy_loss": -0.010881278697874338, "vf_loss": 8.495134900360512, "vf_explained_var": -0.3558445082139717, "kl": 0.006889659023039661, "entropy": 1.0875619430075247, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.924086061735002, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.528057624927904, "policy_loss": -0.010629831454790538, "vf_loss": 8.536864940451567, "vf_explained_var": 0.1008504678017248, "kl": 0.009112502371829605, "entropy": 1.2070145799369407, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 396.0, "episode_reward_min": -125.0, "episode_reward_mean": 121.6, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -200.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -20.545, "predator_policy": 81.345}, "custom_metrics": {}, "hist_stats": {"episode_reward": [232.0, 240.0, 177.0, 263.0, 278.0, 142.0, 332.0, 242.0, 241.0, 146.0, 195.0, 188.0, 135.0, 199.0, 289.0, 195.0, 232.0, 300.0, 300.0, 236.0, 131.0, 9.0, 301.0, 184.0, 150.0, 164.0, 140.0, 331.0, 252.0, 0.0, 276.0, 231.0, 236.0, 209.0, 147.0, 245.0, 181.0, 99.0, 222.0, 171.0, 298.0, 288.0, 111.0, 135.0, 171.0, 100.0, 104.0, 254.0, 78.0, 88.0, -109.0, 8.0, 84.0, 194.0, -125.0, 90.0, 113.0, 92.0, 10.0, 180.0, 36.0, 260.0, 79.0, 204.0, 54.0, 71.0, 63.0, -55.0, -50.0, 157.0, 22.0, -26.0, 70.0, 2.0, 95.0, 24.0, 83.0, -123.0, -78.0, 163.0, -96.0, 1.0, 96.0, -76.0, 137.0, -54.0, 9.0, 48.0, 27.0, 14.0, 1.0, -55.0, 25.0, 113.0, -7.0, 34.0, 31.0, 32.0, 396.0, 28.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [122.0, 24.0, -132.0, 78.0, 153.0, 0.0, -12.0, 74.0, 90.0, 84.0, -1.0, 0.0, 184.0, 96.0, 91.0, 84.0, 60.0, 77.0, 68.0, 0.0, -65.0, 51.0, 47.0, -54.0, 0.0, 31.0, 48.0, 48.0, 122.0, 98.0, 60.0, 42.0, -21.0, 134.0, 63.0, 77.0, 153.0, 62.0, 50.0, 60.0, -10.0, 30.0, -90.0, -98.0, 128.0, 50.0, 32.0, 39.0, 0.0, 92.0, 108.0, 0.0, -30.0, -1.0, 86.0, 174.0, 78.0, 70.0, 0.0, 0.0, 92.0, -35.0, 82.0, 132.0, 102.0, 36.0, 43.0, 24.0, 18.0, -106.0, 114.0, 74.0, 4.0, 71.0, 0.0, 79.0, 24.0, 198.0, -94.0, 47.0, -114.0, 172.0, 139.0, 115.0, 20.0, 0.0, 0.0, 74.0, -87.0, -16.0, 0.0, -28.0, -102.0, -2.0, 100.0, 78.0, -60.0, 0.0, 0.0, -61.0, -130.0, -173.0, -130.0, -115.0, -33.0, 0.0, -46.0, 110.0, -192.0, -184.0, -130.0, 38.0, -90.0, -6.0, 14.0, -61.0, 9.0, 1.0, 0.0, 160.0, -40.0, -37.0, 117.0, 46.0, -29.0, 6.0, 62.0, 44.0, -70.0, -90.0, -90.0, 0.0, -122.0, -134.0, -86.0, -200.0, -136.0, -143.0, -200.0, 0.0, -102.0, -108.0, -151.0, -108.0, -92.0, -16.0, -161.0, -130.0, -158.0, 0.0, -18.0, -80.0, -30.0, 66.0, -160.0, -193.0, -184.0, -154.0, -164.0, 0.0, -178.0, -150.0, -75.0, -140.0, -63.0, -74.0, -166.0, -178.0, 1.0, -140.0, -188.0, -200.0, -57.0, -170.0, -54.0, -130.0, -85.0, -50.0, -58.0, -58.0, -187.0, -180.0, -177.0, -164.0, -89.0, 0.0, -164.0, 0.0, -126.0, -112.0, -150.0, -198.0, -60.0, -110.0, -192.0, -61.0, 196.0, 200.0, -97.0, -159.0], "policy_predator_policy_reward": [0.0, 86.0, 156.0, 138.0, 5.0, 19.0, 89.0, 112.0, 62.0, 42.0, 59.0, 84.0, 0.0, 52.0, 41.0, 26.0, 48.0, 56.0, 36.0, 42.0, 95.0, 114.0, 68.0, 127.0, 40.0, 64.0, 20.0, 83.0, 9.0, 60.0, 0.0, 93.0, 71.0, 48.0, 93.0, 67.0, 6.0, 79.0, 100.0, 26.0, 106.0, 5.0, 70.0, 127.0, 64.0, 59.0, 59.0, 54.0, 28.0, 30.0, 35.0, 21.0, 96.0, 75.0, 36.0, 35.0, 31.0, 73.0, 0.0, 0.0, 126.0, 93.0, 15.0, 2.0, 24.0, 74.0, 70.0, 72.0, 119.0, 116.0, 52.0, 5.0, 81.0, 25.0, 8.0, 12.0, 0.0, 0.0, 123.0, 95.0, 122.0, 118.0, 33.0, 1.0, 6.0, 85.0, 22.0, 39.0, 144.0, 130.0, 75.0, 53.0, 149.0, 59.0, 19.0, 57.0, 118.0, 20.0, 66.0, 83.0, 186.0, 8.0, 138.0, 115.0, 97.0, 20.0, 95.0, 35.0, 67.0, 184.0, 161.0, 21.0, 107.0, 102.0, 65.0, 74.0, 0.0, 0.0, 0.0, 20.0, 112.0, 1.0, 49.0, 48.0, 79.0, 23.0, 25.0, 73.0, 151.0, 63.0, 44.0, 117.0, 158.0, 161.0, 181.0, 50.0, 68.0, 161.0, 191.0, 166.0, 154.0, 78.0, 176.0, 57.0, 39.0, 139.0, 142.0, 151.0, 178.0, 75.0, 36.0, 86.0, 47.0, 0.0, 196.0, 34.0, 192.0, 68.0, 146.0, 181.0, 184.0, 48.0, 79.0, 137.0, 80.0, 153.0, 176.0, 92.0, 167.0, 109.0, 200.0, 134.0, 162.0, 74.0, 70.0, 162.0, 137.0, 25.0, 130.0, 0.0, 175.0, 193.0, 108.0, 178.0, 96.0, 18.0, 117.0, 160.0, 141.0, 90.0, 191.0, 191.0, 88.0, 113.0, 192.0, 93.0, 0.0, 0.0, 104.0, 180.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.584868868092363, "mean_inference_ms": 1.312224919169563, "mean_action_processing_ms": 0.23262862833543402, "mean_env_wait_ms": 0.1744922200527811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009778380393981934, "StateBufferConnector_ms": 0.003362894058227539, "ViewRequirementAgentConnector_ms": 0.10328400135040283}, "num_episodes": 18, "episode_return_max": 396.0, "episode_return_min": -125.0, "episode_return_mean": 121.6, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.6822164617024, "num_env_steps_trained_throughput_per_sec": 88.6822164617024, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 45332.6, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45332.552, "sample_time_ms": 1057.226, "learn_time_ms": 44257.448, "learn_throughput": 90.38, "synch_weights_time_ms": 14.233}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 26, "trial_id": "51025_00000", "date": "2024-08-12_20-44-00", "timestamp": 1723509840, "time_this_iter_s": 45.116947889328, "time_total_s": 1194.4438009262085, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cb33e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1194.4438009262085, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 20.95625, "ram_util_percent": 81.64375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.765918956673334, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.059080470554413, "policy_loss": -0.013123739879731108, "vf_loss": 8.069569961103813, "vf_explained_var": -0.38767054326950556, "kl": 0.008780817113856042, "entropy": 1.1165777820758718, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.454719525039511, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.193182521396214, "policy_loss": -0.012241442929017087, "vf_loss": 9.203915754449431, "vf_explained_var": 0.005009080493260943, "kl": 0.007541003719757891, "entropy": 1.187384666399981, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 396.0, "episode_reward_min": -125.0, "episode_reward_mean": 91.8, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -200.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -50.555, "predator_policy": 96.455}, "custom_metrics": {}, "hist_stats": {"episode_reward": [301.0, 184.0, 150.0, 164.0, 140.0, 331.0, 252.0, 0.0, 276.0, 231.0, 236.0, 209.0, 147.0, 245.0, 181.0, 99.0, 222.0, 171.0, 298.0, 288.0, 111.0, 135.0, 171.0, 100.0, 104.0, 254.0, 78.0, 88.0, -109.0, 8.0, 84.0, 194.0, -125.0, 90.0, 113.0, 92.0, 10.0, 180.0, 36.0, 260.0, 79.0, 204.0, 54.0, 71.0, 63.0, -55.0, -50.0, 157.0, 22.0, -26.0, 70.0, 2.0, 95.0, 24.0, 83.0, -123.0, -78.0, 163.0, -96.0, 1.0, 96.0, -76.0, 137.0, -54.0, 9.0, 48.0, 27.0, 14.0, 1.0, -55.0, 25.0, 113.0, -7.0, 34.0, 31.0, 32.0, 396.0, 28.0, 32.0, 17.0, 111.0, 46.0, 44.0, 10.0, 134.0, 188.0, -7.0, 103.0, 139.0, 41.0, 56.0, 182.0, 19.0, 13.0, 0.0, 180.0, 158.0, 117.0, 108.0, 31.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [128.0, 50.0, 32.0, 39.0, 0.0, 92.0, 108.0, 0.0, -30.0, -1.0, 86.0, 174.0, 78.0, 70.0, 0.0, 0.0, 92.0, -35.0, 82.0, 132.0, 102.0, 36.0, 43.0, 24.0, 18.0, -106.0, 114.0, 74.0, 4.0, 71.0, 0.0, 79.0, 24.0, 198.0, -94.0, 47.0, -114.0, 172.0, 139.0, 115.0, 20.0, 0.0, 0.0, 74.0, -87.0, -16.0, 0.0, -28.0, -102.0, -2.0, 100.0, 78.0, -60.0, 0.0, 0.0, -61.0, -130.0, -173.0, -130.0, -115.0, -33.0, 0.0, -46.0, 110.0, -192.0, -184.0, -130.0, 38.0, -90.0, -6.0, 14.0, -61.0, 9.0, 1.0, 0.0, 160.0, -40.0, -37.0, 117.0, 46.0, -29.0, 6.0, 62.0, 44.0, -70.0, -90.0, -90.0, 0.0, -122.0, -134.0, -86.0, -200.0, -136.0, -143.0, -200.0, 0.0, -102.0, -108.0, -151.0, -108.0, -92.0, -16.0, -161.0, -130.0, -158.0, 0.0, -18.0, -80.0, -30.0, 66.0, -160.0, -193.0, -184.0, -154.0, -164.0, 0.0, -178.0, -150.0, -75.0, -140.0, -63.0, -74.0, -166.0, -178.0, 1.0, -140.0, -188.0, -200.0, -57.0, -170.0, -54.0, -130.0, -85.0, -50.0, -58.0, -58.0, -187.0, -180.0, -177.0, -164.0, -89.0, 0.0, -164.0, 0.0, -126.0, -112.0, -150.0, -198.0, -60.0, -110.0, -192.0, -61.0, 196.0, 200.0, -97.0, -159.0, -132.0, -155.0, -157.0, -194.0, -65.0, -200.0, -47.0, -198.0, -60.0, -10.0, -180.0, 0.0, -200.0, 0.0, 71.0, -52.0, -194.0, -188.0, -157.0, -66.0, -122.0, 0.0, -142.0, -151.0, -141.0, -100.0, -9.0, -66.0, -12.0, -135.0, -161.0, -150.0, 0.0, 0.0, 0.0, -166.0, -14.0, 0.0, 19.0, -27.0, -3.0, -136.0, -144.0, -180.0], "policy_predator_policy_reward": [64.0, 59.0, 59.0, 54.0, 28.0, 30.0, 35.0, 21.0, 96.0, 75.0, 36.0, 35.0, 31.0, 73.0, 0.0, 0.0, 126.0, 93.0, 15.0, 2.0, 24.0, 74.0, 70.0, 72.0, 119.0, 116.0, 52.0, 5.0, 81.0, 25.0, 8.0, 12.0, 0.0, 0.0, 123.0, 95.0, 122.0, 118.0, 33.0, 1.0, 6.0, 85.0, 22.0, 39.0, 144.0, 130.0, 75.0, 53.0, 149.0, 59.0, 19.0, 57.0, 118.0, 20.0, 66.0, 83.0, 186.0, 8.0, 138.0, 115.0, 97.0, 20.0, 95.0, 35.0, 67.0, 184.0, 161.0, 21.0, 107.0, 102.0, 65.0, 74.0, 0.0, 0.0, 0.0, 20.0, 112.0, 1.0, 49.0, 48.0, 79.0, 23.0, 25.0, 73.0, 151.0, 63.0, 44.0, 117.0, 158.0, 161.0, 181.0, 50.0, 68.0, 161.0, 191.0, 166.0, 154.0, 78.0, 176.0, 57.0, 39.0, 139.0, 142.0, 151.0, 178.0, 75.0, 36.0, 86.0, 47.0, 0.0, 196.0, 34.0, 192.0, 68.0, 146.0, 181.0, 184.0, 48.0, 79.0, 137.0, 80.0, 153.0, 176.0, 92.0, 167.0, 109.0, 200.0, 134.0, 162.0, 74.0, 70.0, 162.0, 137.0, 25.0, 130.0, 0.0, 175.0, 193.0, 108.0, 178.0, 96.0, 18.0, 117.0, 160.0, 141.0, 90.0, 191.0, 191.0, 88.0, 113.0, 192.0, 93.0, 0.0, 0.0, 104.0, 180.0, 169.0, 150.0, 197.0, 171.0, 200.0, 176.0, 92.0, 199.0, 63.0, 51.0, 0.0, 190.0, 145.0, 189.0, 83.0, 86.0, 198.0, 177.0, 148.0, 178.0, 100.0, 161.0, 163.0, 171.0, 156.0, 141.0, 124.0, 133.0, 3.0, 163.0, 176.0, 148.0, 0.0, 0.0, 178.0, 168.0, 86.0, 86.0, 77.0, 48.0, 111.0, 136.0, 155.0, 200.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5847255163478053, "mean_inference_ms": 1.3093243053736268, "mean_action_processing_ms": 0.232121409685764, "mean_env_wait_ms": 0.17414747589949445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010449409484863281, "StateBufferConnector_ms": 0.0033349990844726562, "ViewRequirementAgentConnector_ms": 0.10022056102752686}, "num_episodes": 22, "episode_return_max": 396.0, "episode_return_min": -125.0, "episode_return_mean": 91.8, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 86.66884724752155, "num_env_steps_trained_throughput_per_sec": 86.66884724752155, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 45417.645, "restore_workers_time_ms": 0.014, "training_step_time_ms": 45417.597, "sample_time_ms": 1052.683, "learn_time_ms": 44347.407, "learn_throughput": 90.197, "synch_weights_time_ms": 14.149}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 27, "trial_id": "51025_00000", "date": "2024-08-12_20-44-47", "timestamp": 1723509887, "time_this_iter_s": 46.205771923065186, "time_total_s": 1240.6495728492737, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cb61160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1240.6495728492737, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 28.22923076923077, "ram_util_percent": 81.21384615384615}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.701205437650126, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.79803458269311, "policy_loss": -0.009087092739101204, "vf_loss": 6.805365193331683, "vf_explained_var": -0.27895217004907197, "kl": 0.005854997492438497, "entropy": 1.1491111050837886, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.006776942714811, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.575544844481049, "policy_loss": -0.010994990909639648, "vf_loss": 7.584985805188538, "vf_explained_var": 0.18881461967236152, "kl": 0.007770142230349236, "entropy": 1.1468614247740891, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 396.0, "episode_reward_min": -125.0, "episode_reward_mean": 61.58, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -200.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -81.695, "predator_policy": 112.485}, "custom_metrics": {}, "hist_stats": {"episode_reward": [100.0, 104.0, 254.0, 78.0, 88.0, -109.0, 8.0, 84.0, 194.0, -125.0, 90.0, 113.0, 92.0, 10.0, 180.0, 36.0, 260.0, 79.0, 204.0, 54.0, 71.0, 63.0, -55.0, -50.0, 157.0, 22.0, -26.0, 70.0, 2.0, 95.0, 24.0, 83.0, -123.0, -78.0, 163.0, -96.0, 1.0, 96.0, -76.0, 137.0, -54.0, 9.0, 48.0, 27.0, 14.0, 1.0, -55.0, 25.0, 113.0, -7.0, 34.0, 31.0, 32.0, 396.0, 28.0, 32.0, 17.0, 111.0, 46.0, 44.0, 10.0, 134.0, 188.0, -7.0, 103.0, 139.0, 41.0, 56.0, 182.0, 19.0, 13.0, 0.0, 180.0, 158.0, 117.0, 108.0, 31.0, 0.0, 121.0, 133.0, 26.0, 12.0, -11.0, 87.0, 100.0, 162.0, 59.0, 73.0, -9.0, 158.0, 0.0, 101.0, -2.0, 0.0, 152.0, 34.0, 196.0, -9.0, 13.0, 124.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -28.0, -102.0, -2.0, 100.0, 78.0, -60.0, 0.0, 0.0, -61.0, -130.0, -173.0, -130.0, -115.0, -33.0, 0.0, -46.0, 110.0, -192.0, -184.0, -130.0, 38.0, -90.0, -6.0, 14.0, -61.0, 9.0, 1.0, 0.0, 160.0, -40.0, -37.0, 117.0, 46.0, -29.0, 6.0, 62.0, 44.0, -70.0, -90.0, -90.0, 0.0, -122.0, -134.0, -86.0, -200.0, -136.0, -143.0, -200.0, 0.0, -102.0, -108.0, -151.0, -108.0, -92.0, -16.0, -161.0, -130.0, -158.0, 0.0, -18.0, -80.0, -30.0, 66.0, -160.0, -193.0, -184.0, -154.0, -164.0, 0.0, -178.0, -150.0, -75.0, -140.0, -63.0, -74.0, -166.0, -178.0, 1.0, -140.0, -188.0, -200.0, -57.0, -170.0, -54.0, -130.0, -85.0, -50.0, -58.0, -58.0, -187.0, -180.0, -177.0, -164.0, -89.0, 0.0, -164.0, 0.0, -126.0, -112.0, -150.0, -198.0, -60.0, -110.0, -192.0, -61.0, 196.0, 200.0, -97.0, -159.0, -132.0, -155.0, -157.0, -194.0, -65.0, -200.0, -47.0, -198.0, -60.0, -10.0, -180.0, 0.0, -200.0, 0.0, 71.0, -52.0, -194.0, -188.0, -157.0, -66.0, -122.0, 0.0, -142.0, -151.0, -141.0, -100.0, -9.0, -66.0, -12.0, -135.0, -161.0, -150.0, 0.0, 0.0, 0.0, -166.0, -14.0, 0.0, 19.0, -27.0, -3.0, -136.0, -144.0, -180.0, 0.0, -6.0, 45.0, 0.0, -143.0, -44.0, -150.0, -190.0, -147.0, -191.0, -189.0, -171.0, -5.0, -42.0, -198.0, -28.0, -15.0, -172.0, -148.0, -114.0, -181.0, -30.0, -85.0, -198.0, 0.0, -106.0, 0.0, 0.0, -200.0, -52.0, -7.0, -8.0, 0.0, 0.0, -170.0, -29.0, -149.0, -170.0, -170.0, 46.0, -176.0, -157.0, -200.0, -170.0, 30.0, -104.0], "policy_predator_policy_reward": [75.0, 53.0, 149.0, 59.0, 19.0, 57.0, 118.0, 20.0, 66.0, 83.0, 186.0, 8.0, 138.0, 115.0, 97.0, 20.0, 95.0, 35.0, 67.0, 184.0, 161.0, 21.0, 107.0, 102.0, 65.0, 74.0, 0.0, 0.0, 0.0, 20.0, 112.0, 1.0, 49.0, 48.0, 79.0, 23.0, 25.0, 73.0, 151.0, 63.0, 44.0, 117.0, 158.0, 161.0, 181.0, 50.0, 68.0, 161.0, 191.0, 166.0, 154.0, 78.0, 176.0, 57.0, 39.0, 139.0, 142.0, 151.0, 178.0, 75.0, 36.0, 86.0, 47.0, 0.0, 196.0, 34.0, 192.0, 68.0, 146.0, 181.0, 184.0, 48.0, 79.0, 137.0, 80.0, 153.0, 176.0, 92.0, 167.0, 109.0, 200.0, 134.0, 162.0, 74.0, 70.0, 162.0, 137.0, 25.0, 130.0, 0.0, 175.0, 193.0, 108.0, 178.0, 96.0, 18.0, 117.0, 160.0, 141.0, 90.0, 191.0, 191.0, 88.0, 113.0, 192.0, 93.0, 0.0, 0.0, 104.0, 180.0, 169.0, 150.0, 197.0, 171.0, 200.0, 176.0, 92.0, 199.0, 63.0, 51.0, 0.0, 190.0, 145.0, 189.0, 83.0, 86.0, 198.0, 177.0, 148.0, 178.0, 100.0, 161.0, 163.0, 171.0, 156.0, 141.0, 124.0, 133.0, 3.0, 163.0, 176.0, 148.0, 0.0, 0.0, 178.0, 168.0, 86.0, 86.0, 77.0, 48.0, 111.0, 136.0, 155.0, 200.0, 0.0, 6.0, 34.0, 42.0, 160.0, 160.0, 184.0, 182.0, 167.0, 183.0, 172.0, 177.0, 13.0, 121.0, 182.0, 144.0, 183.0, 166.0, 171.0, 150.0, 154.0, 130.0, 74.0, 200.0, 115.0, 149.0, 0.0, 0.0, 200.0, 153.0, 13.0, 0.0, 0.0, 0.0, 184.0, 167.0, 179.0, 174.0, 137.0, 183.0, 172.0, 152.0, 187.0, 196.0, 48.0, 150.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5847794639740749, "mean_inference_ms": 1.320018385128969, "mean_action_processing_ms": 0.23192999412124277, "mean_env_wait_ms": 0.17391406034809645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012938737869262695, "StateBufferConnector_ms": 0.0029937028884887695, "ViewRequirementAgentConnector_ms": 0.09451603889465332}, "num_episodes": 23, "episode_return_max": 396.0, "episode_return_min": -125.0, "episode_return_mean": 61.58, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 87.65050804353503, "num_env_steps_trained_throughput_per_sec": 87.65050804353503, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 45420.065, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45420.017, "sample_time_ms": 1119.631, "learn_time_ms": 44282.783, "learn_throughput": 90.329, "synch_weights_time_ms": 14.127}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 28, "trial_id": "51025_00000", "date": "2024-08-12_20-45-32", "timestamp": 1723509932, "time_this_iter_s": 45.6833701133728, "time_total_s": 1286.3329429626465, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cb63ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1286.3329429626465, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 20.919999999999995, "ram_util_percent": 82.38769230769232}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.698159688238114, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.301746472101362, "policy_loss": -0.016665261209493985, "vf_loss": 8.314839095665665, "vf_explained_var": -0.0035327824019881155, "kl": 0.011908780023942975, "entropy": 1.1908651261102585, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.58925725991133, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.431376715816517, "policy_loss": -0.008918045969463136, "vf_loss": 8.439056304396775, "vf_explained_var": 0.17049199642327728, "kl": 0.006192199030485629, "entropy": 1.1167130388910809, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 396.0, "episode_reward_min": -123.0, "episode_reward_mean": 72.78, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -200.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -83.955, "predator_policy": 120.345}, "custom_metrics": {}, "hist_stats": {"episode_reward": [204.0, 54.0, 71.0, 63.0, -55.0, -50.0, 157.0, 22.0, -26.0, 70.0, 2.0, 95.0, 24.0, 83.0, -123.0, -78.0, 163.0, -96.0, 1.0, 96.0, -76.0, 137.0, -54.0, 9.0, 48.0, 27.0, 14.0, 1.0, -55.0, 25.0, 113.0, -7.0, 34.0, 31.0, 32.0, 396.0, 28.0, 32.0, 17.0, 111.0, 46.0, 44.0, 10.0, 134.0, 188.0, -7.0, 103.0, 139.0, 41.0, 56.0, 182.0, 19.0, 13.0, 0.0, 180.0, 158.0, 117.0, 108.0, 31.0, 0.0, 121.0, 133.0, 26.0, 12.0, -11.0, 87.0, 100.0, 162.0, 59.0, 73.0, -9.0, 158.0, 0.0, 101.0, -2.0, 0.0, 152.0, 34.0, 196.0, -9.0, 13.0, 124.0, 180.0, -2.0, 153.0, 311.0, 145.0, 125.0, 21.0, 146.0, 134.0, 172.0, 256.0, 286.0, 33.0, 2.0, -1.0, 352.0, 168.0, 175.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [62.0, 44.0, -70.0, -90.0, -90.0, 0.0, -122.0, -134.0, -86.0, -200.0, -136.0, -143.0, -200.0, 0.0, -102.0, -108.0, -151.0, -108.0, -92.0, -16.0, -161.0, -130.0, -158.0, 0.0, -18.0, -80.0, -30.0, 66.0, -160.0, -193.0, -184.0, -154.0, -164.0, 0.0, -178.0, -150.0, -75.0, -140.0, -63.0, -74.0, -166.0, -178.0, 1.0, -140.0, -188.0, -200.0, -57.0, -170.0, -54.0, -130.0, -85.0, -50.0, -58.0, -58.0, -187.0, -180.0, -177.0, -164.0, -89.0, 0.0, -164.0, 0.0, -126.0, -112.0, -150.0, -198.0, -60.0, -110.0, -192.0, -61.0, 196.0, 200.0, -97.0, -159.0, -132.0, -155.0, -157.0, -194.0, -65.0, -200.0, -47.0, -198.0, -60.0, -10.0, -180.0, 0.0, -200.0, 0.0, 71.0, -52.0, -194.0, -188.0, -157.0, -66.0, -122.0, 0.0, -142.0, -151.0, -141.0, -100.0, -9.0, -66.0, -12.0, -135.0, -161.0, -150.0, 0.0, 0.0, 0.0, -166.0, -14.0, 0.0, 19.0, -27.0, -3.0, -136.0, -144.0, -180.0, 0.0, -6.0, 45.0, 0.0, -143.0, -44.0, -150.0, -190.0, -147.0, -191.0, -189.0, -171.0, -5.0, -42.0, -198.0, -28.0, -15.0, -172.0, -148.0, -114.0, -181.0, -30.0, -85.0, -198.0, 0.0, -106.0, 0.0, 0.0, -200.0, -52.0, -7.0, -8.0, 0.0, 0.0, -170.0, -29.0, -149.0, -170.0, -170.0, 46.0, -176.0, -157.0, -200.0, -170.0, 30.0, -104.0, -200.0, 2.0, -133.0, -167.0, 2.0, 0.0, 179.0, 43.0, -106.0, -5.0, 0.0, -104.0, -19.0, 20.0, 11.0, -184.0, -154.0, 25.0, -159.0, -12.0, -47.0, 106.0, 104.0, 102.0, -160.0, -155.0, -192.0, -197.0, -40.0, -160.0, 166.0, -172.0, -54.0, 82.0, 156.0, 0.0], "policy_predator_policy_reward": [25.0, 73.0, 151.0, 63.0, 44.0, 117.0, 158.0, 161.0, 181.0, 50.0, 68.0, 161.0, 191.0, 166.0, 154.0, 78.0, 176.0, 57.0, 39.0, 139.0, 142.0, 151.0, 178.0, 75.0, 36.0, 86.0, 47.0, 0.0, 196.0, 34.0, 192.0, 68.0, 146.0, 181.0, 184.0, 48.0, 79.0, 137.0, 80.0, 153.0, 176.0, 92.0, 167.0, 109.0, 200.0, 134.0, 162.0, 74.0, 70.0, 162.0, 137.0, 25.0, 130.0, 0.0, 175.0, 193.0, 108.0, 178.0, 96.0, 18.0, 117.0, 160.0, 141.0, 90.0, 191.0, 191.0, 88.0, 113.0, 192.0, 93.0, 0.0, 0.0, 104.0, 180.0, 169.0, 150.0, 197.0, 171.0, 200.0, 176.0, 92.0, 199.0, 63.0, 51.0, 0.0, 190.0, 145.0, 189.0, 83.0, 86.0, 198.0, 177.0, 148.0, 178.0, 100.0, 161.0, 163.0, 171.0, 156.0, 141.0, 124.0, 133.0, 3.0, 163.0, 176.0, 148.0, 0.0, 0.0, 178.0, 168.0, 86.0, 86.0, 77.0, 48.0, 111.0, 136.0, 155.0, 200.0, 0.0, 6.0, 34.0, 42.0, 160.0, 160.0, 184.0, 182.0, 167.0, 183.0, 172.0, 177.0, 13.0, 121.0, 182.0, 144.0, 183.0, 166.0, 171.0, 150.0, 154.0, 130.0, 74.0, 200.0, 115.0, 149.0, 0.0, 0.0, 200.0, 153.0, 13.0, 0.0, 0.0, 0.0, 184.0, 167.0, 179.0, 174.0, 137.0, 183.0, 172.0, 152.0, 187.0, 196.0, 48.0, 150.0, 178.0, 200.0, 165.0, 133.0, 86.0, 65.0, 53.0, 36.0, 130.0, 126.0, 115.0, 114.0, 19.0, 1.0, 186.0, 133.0, 101.0, 162.0, 175.0, 168.0, 79.0, 118.0, 66.0, 14.0, 178.0, 170.0, 194.0, 197.0, 199.0, 0.0, 174.0, 184.0, 36.0, 104.0, 4.0, 15.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5837699425988387, "mean_inference_ms": 1.3274890827344226, "mean_action_processing_ms": 0.23161360473256118, "mean_env_wait_ms": 0.17363893366092178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008441925048828125, "StateBufferConnector_ms": 0.0029104948043823242, "ViewRequirementAgentConnector_ms": 0.09392106533050537}, "num_episodes": 18, "episode_return_max": 396.0, "episode_return_min": -123.0, "episode_return_mean": 72.78, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 87.59158141350724, "num_env_steps_trained_throughput_per_sec": 87.59158141350724, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 45490.667, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45490.619, "sample_time_ms": 1123.008, "learn_time_ms": 44350.591, "learn_throughput": 90.19, "synch_weights_time_ms": 13.965}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 29, "trial_id": "51025_00000", "date": "2024-08-12_20-46-18", "timestamp": 1723509978, "time_this_iter_s": 45.694440841674805, "time_total_s": 1332.0273838043213, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cb38310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1332.0273838043213, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 21.989062500000003, "ram_util_percent": 82.70625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.297541660101956, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.824243728950541, "policy_loss": -0.014865440085392307, "vf_loss": 7.835471302113205, "vf_explained_var": 0.1610606751429341, "kl": 0.012126143356107486, "entropy": 1.2454829374318401, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.148191713656068, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.124816253702477, "policy_loss": -0.01045095631704917, "vf_loss": 6.133925073865861, "vf_explained_var": 0.2538656223072577, "kl": 0.006710606083199896, "entropy": 1.0680209441159767, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 396.0, "episode_reward_min": -76.0, "episode_reward_mean": 106.67, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -200.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -62.18, "predator_policy": 115.515}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.0, 96.0, -76.0, 137.0, -54.0, 9.0, 48.0, 27.0, 14.0, 1.0, -55.0, 25.0, 113.0, -7.0, 34.0, 31.0, 32.0, 396.0, 28.0, 32.0, 17.0, 111.0, 46.0, 44.0, 10.0, 134.0, 188.0, -7.0, 103.0, 139.0, 41.0, 56.0, 182.0, 19.0, 13.0, 0.0, 180.0, 158.0, 117.0, 108.0, 31.0, 0.0, 121.0, 133.0, 26.0, 12.0, -11.0, 87.0, 100.0, 162.0, 59.0, 73.0, -9.0, 158.0, 0.0, 101.0, -2.0, 0.0, 152.0, 34.0, 196.0, -9.0, 13.0, 124.0, 180.0, -2.0, 153.0, 311.0, 145.0, 125.0, 21.0, 146.0, 134.0, 172.0, 256.0, 286.0, 33.0, 2.0, -1.0, 352.0, 168.0, 175.0, 333.0, 218.0, 230.0, 253.0, 175.0, 177.0, 356.0, 182.0, 163.0, 343.0, 158.0, 333.0, 220.0, 273.0, 50.0, 187.0, 171.0, 147.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-75.0, -140.0, -63.0, -74.0, -166.0, -178.0, 1.0, -140.0, -188.0, -200.0, -57.0, -170.0, -54.0, -130.0, -85.0, -50.0, -58.0, -58.0, -187.0, -180.0, -177.0, -164.0, -89.0, 0.0, -164.0, 0.0, -126.0, -112.0, -150.0, -198.0, -60.0, -110.0, -192.0, -61.0, 196.0, 200.0, -97.0, -159.0, -132.0, -155.0, -157.0, -194.0, -65.0, -200.0, -47.0, -198.0, -60.0, -10.0, -180.0, 0.0, -200.0, 0.0, 71.0, -52.0, -194.0, -188.0, -157.0, -66.0, -122.0, 0.0, -142.0, -151.0, -141.0, -100.0, -9.0, -66.0, -12.0, -135.0, -161.0, -150.0, 0.0, 0.0, 0.0, -166.0, -14.0, 0.0, 19.0, -27.0, -3.0, -136.0, -144.0, -180.0, 0.0, -6.0, 45.0, 0.0, -143.0, -44.0, -150.0, -190.0, -147.0, -191.0, -189.0, -171.0, -5.0, -42.0, -198.0, -28.0, -15.0, -172.0, -148.0, -114.0, -181.0, -30.0, -85.0, -198.0, 0.0, -106.0, 0.0, 0.0, -200.0, -52.0, -7.0, -8.0, 0.0, 0.0, -170.0, -29.0, -149.0, -170.0, -170.0, 46.0, -176.0, -157.0, -200.0, -170.0, 30.0, -104.0, -200.0, 2.0, -133.0, -167.0, 2.0, 0.0, 179.0, 43.0, -106.0, -5.0, 0.0, -104.0, -19.0, 20.0, 11.0, -184.0, -154.0, 25.0, -159.0, -12.0, -47.0, 106.0, 104.0, 102.0, -160.0, -155.0, -192.0, -197.0, -40.0, -160.0, 166.0, -172.0, -54.0, 82.0, 156.0, 0.0, -86.0, 156.0, -112.0, 112.0, 69.0, 52.0, 102.0, 37.0, 150.0, 0.0, -171.0, 48.0, 181.0, -200.0, 166.0, 0.0, -9.0, 10.0, 126.0, 120.0, 0.0, 84.0, 160.0, 137.0, -132.0, 11.0, -200.0, 101.0, 0.0, -145.0, 0.0, 179.0, 0.0, -168.0, -2.0, 143.0], "policy_predator_policy_reward": [79.0, 137.0, 80.0, 153.0, 176.0, 92.0, 167.0, 109.0, 200.0, 134.0, 162.0, 74.0, 70.0, 162.0, 137.0, 25.0, 130.0, 0.0, 175.0, 193.0, 108.0, 178.0, 96.0, 18.0, 117.0, 160.0, 141.0, 90.0, 191.0, 191.0, 88.0, 113.0, 192.0, 93.0, 0.0, 0.0, 104.0, 180.0, 169.0, 150.0, 197.0, 171.0, 200.0, 176.0, 92.0, 199.0, 63.0, 51.0, 0.0, 190.0, 145.0, 189.0, 83.0, 86.0, 198.0, 177.0, 148.0, 178.0, 100.0, 161.0, 163.0, 171.0, 156.0, 141.0, 124.0, 133.0, 3.0, 163.0, 176.0, 148.0, 0.0, 0.0, 178.0, 168.0, 86.0, 86.0, 77.0, 48.0, 111.0, 136.0, 155.0, 200.0, 0.0, 6.0, 34.0, 42.0, 160.0, 160.0, 184.0, 182.0, 167.0, 183.0, 172.0, 177.0, 13.0, 121.0, 182.0, 144.0, 183.0, 166.0, 171.0, 150.0, 154.0, 130.0, 74.0, 200.0, 115.0, 149.0, 0.0, 0.0, 200.0, 153.0, 13.0, 0.0, 0.0, 0.0, 184.0, 167.0, 179.0, 174.0, 137.0, 183.0, 172.0, 152.0, 187.0, 196.0, 48.0, 150.0, 178.0, 200.0, 165.0, 133.0, 86.0, 65.0, 53.0, 36.0, 130.0, 126.0, 115.0, 114.0, 19.0, 1.0, 186.0, 133.0, 101.0, 162.0, 175.0, 168.0, 79.0, 118.0, 66.0, 14.0, 178.0, 170.0, 194.0, 197.0, 199.0, 0.0, 174.0, 184.0, 36.0, 104.0, 4.0, 15.0, 142.0, 121.0, 106.0, 112.0, 41.0, 68.0, 80.0, 34.0, 0.0, 25.0, 129.0, 171.0, 200.0, 175.0, 0.0, 16.0, 41.0, 121.0, 47.0, 50.0, 51.0, 23.0, 30.0, 6.0, 157.0, 184.0, 200.0, 172.0, 152.0, 43.0, 7.0, 1.0, 166.0, 173.0, 2.0, 4.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.582812507213276, "mean_inference_ms": 1.3344935465269057, "mean_action_processing_ms": 0.23131994351359686, "mean_env_wait_ms": 0.17342781308414998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007771730422973633, "StateBufferConnector_ms": 0.0029524564743041992, "ViewRequirementAgentConnector_ms": 0.09509170055389404}, "num_episodes": 18, "episode_return_max": 396.0, "episode_return_min": -76.0, "episode_return_mean": 106.67, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.42351545287897, "num_env_steps_trained_throughput_per_sec": 88.42351545287897, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 45485.234, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45485.187, "sample_time_ms": 1122.273, "learn_time_ms": 44346.186, "learn_throughput": 90.199, "synch_weights_time_ms": 13.807}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 30, "trial_id": "51025_00000", "date": "2024-08-12_20-47-03", "timestamp": 1723510023, "time_this_iter_s": 45.276567220687866, "time_total_s": 1377.3039510250092, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158086a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1377.3039510250092, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 20.653125, "ram_util_percent": 82.709375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.732919484219223, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.705368874565004, "policy_loss": -0.015670110228121596, "vf_loss": 8.718005859284174, "vf_explained_var": 0.19070596083131416, "kl": 0.010110296886672534, "entropy": 1.2114791003484575, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.914083867350584, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.866467794287142, "policy_loss": -0.011412833341540246, "vf_loss": 5.876137247035112, "vf_explained_var": 0.212486199537913, "kl": 0.008717009481987763, "entropy": 1.11451672511126, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 378.0, "episode_reward_min": -11.0, "episode_reward_mean": 146.52, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -200.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -31.04, "predator_policy": 104.3}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.0, 32.0, 17.0, 111.0, 46.0, 44.0, 10.0, 134.0, 188.0, -7.0, 103.0, 139.0, 41.0, 56.0, 182.0, 19.0, 13.0, 0.0, 180.0, 158.0, 117.0, 108.0, 31.0, 0.0, 121.0, 133.0, 26.0, 12.0, -11.0, 87.0, 100.0, 162.0, 59.0, 73.0, -9.0, 158.0, 0.0, 101.0, -2.0, 0.0, 152.0, 34.0, 196.0, -9.0, 13.0, 124.0, 180.0, -2.0, 153.0, 311.0, 145.0, 125.0, 21.0, 146.0, 134.0, 172.0, 256.0, 286.0, 33.0, 2.0, -1.0, 352.0, 168.0, 175.0, 333.0, 218.0, 230.0, 253.0, 175.0, 177.0, 356.0, 182.0, 163.0, 343.0, 158.0, 333.0, 220.0, 273.0, 50.0, 187.0, 171.0, 147.0, 224.0, 339.0, -9.0, 137.0, 190.0, 247.0, 332.0, 378.0, 304.0, 335.0, 226.0, 308.0, 150.0, 341.0, 349.0, 258.0, 367.0, 281.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-97.0, -159.0, -132.0, -155.0, -157.0, -194.0, -65.0, -200.0, -47.0, -198.0, -60.0, -10.0, -180.0, 0.0, -200.0, 0.0, 71.0, -52.0, -194.0, -188.0, -157.0, -66.0, -122.0, 0.0, -142.0, -151.0, -141.0, -100.0, -9.0, -66.0, -12.0, -135.0, -161.0, -150.0, 0.0, 0.0, 0.0, -166.0, -14.0, 0.0, 19.0, -27.0, -3.0, -136.0, -144.0, -180.0, 0.0, -6.0, 45.0, 0.0, -143.0, -44.0, -150.0, -190.0, -147.0, -191.0, -189.0, -171.0, -5.0, -42.0, -198.0, -28.0, -15.0, -172.0, -148.0, -114.0, -181.0, -30.0, -85.0, -198.0, 0.0, -106.0, 0.0, 0.0, -200.0, -52.0, -7.0, -8.0, 0.0, 0.0, -170.0, -29.0, -149.0, -170.0, -170.0, 46.0, -176.0, -157.0, -200.0, -170.0, 30.0, -104.0, -200.0, 2.0, -133.0, -167.0, 2.0, 0.0, 179.0, 43.0, -106.0, -5.0, 0.0, -104.0, -19.0, 20.0, 11.0, -184.0, -154.0, 25.0, -159.0, -12.0, -47.0, 106.0, 104.0, 102.0, -160.0, -155.0, -192.0, -197.0, -40.0, -160.0, 166.0, -172.0, -54.0, 82.0, 156.0, 0.0, -86.0, 156.0, -112.0, 112.0, 69.0, 52.0, 102.0, 37.0, 150.0, 0.0, -171.0, 48.0, 181.0, -200.0, 166.0, 0.0, -9.0, 10.0, 126.0, 120.0, 0.0, 84.0, 160.0, 137.0, -132.0, 11.0, -200.0, 101.0, 0.0, -145.0, 0.0, 179.0, 0.0, -168.0, -2.0, 143.0, -188.0, 67.0, 163.0, 136.0, -167.0, -200.0, 0.0, -126.0, 189.0, 0.0, 67.0, -11.0, 62.0, 116.0, 188.0, 172.0, 88.0, 175.0, 160.0, 94.0, 200.0, 26.0, -115.0, 194.0, 134.0, 0.0, 120.0, 146.0, 164.0, 164.0, 121.0, 118.0, 176.0, 174.0, 127.0, 35.0], "policy_predator_policy_reward": [104.0, 180.0, 169.0, 150.0, 197.0, 171.0, 200.0, 176.0, 92.0, 199.0, 63.0, 51.0, 0.0, 190.0, 145.0, 189.0, 83.0, 86.0, 198.0, 177.0, 148.0, 178.0, 100.0, 161.0, 163.0, 171.0, 156.0, 141.0, 124.0, 133.0, 3.0, 163.0, 176.0, 148.0, 0.0, 0.0, 178.0, 168.0, 86.0, 86.0, 77.0, 48.0, 111.0, 136.0, 155.0, 200.0, 0.0, 6.0, 34.0, 42.0, 160.0, 160.0, 184.0, 182.0, 167.0, 183.0, 172.0, 177.0, 13.0, 121.0, 182.0, 144.0, 183.0, 166.0, 171.0, 150.0, 154.0, 130.0, 74.0, 200.0, 115.0, 149.0, 0.0, 0.0, 200.0, 153.0, 13.0, 0.0, 0.0, 0.0, 184.0, 167.0, 179.0, 174.0, 137.0, 183.0, 172.0, 152.0, 187.0, 196.0, 48.0, 150.0, 178.0, 200.0, 165.0, 133.0, 86.0, 65.0, 53.0, 36.0, 130.0, 126.0, 115.0, 114.0, 19.0, 1.0, 186.0, 133.0, 101.0, 162.0, 175.0, 168.0, 79.0, 118.0, 66.0, 14.0, 178.0, 170.0, 194.0, 197.0, 199.0, 0.0, 174.0, 184.0, 36.0, 104.0, 4.0, 15.0, 142.0, 121.0, 106.0, 112.0, 41.0, 68.0, 80.0, 34.0, 0.0, 25.0, 129.0, 171.0, 200.0, 175.0, 0.0, 16.0, 41.0, 121.0, 47.0, 50.0, 51.0, 23.0, 30.0, 6.0, 157.0, 184.0, 200.0, 172.0, 152.0, 43.0, 7.0, 1.0, 166.0, 173.0, 2.0, 4.0, 161.0, 184.0, 13.0, 27.0, 182.0, 176.0, 163.0, 100.0, 1.0, 0.0, 85.0, 106.0, 56.0, 98.0, 18.0, 0.0, 30.0, 11.0, 38.0, 43.0, 0.0, 0.0, 114.0, 115.0, 13.0, 3.0, 29.0, 46.0, 0.0, 21.0, 11.0, 8.0, 17.0, 0.0, 79.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5817701425455505, "mean_inference_ms": 1.3411222743522526, "mean_action_processing_ms": 0.23103107906438147, "mean_env_wait_ms": 0.1732416550611058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0073740482330322266, "StateBufferConnector_ms": 0.0029982328414916992, "ViewRequirementAgentConnector_ms": 0.09529244899749756}, "num_episodes": 18, "episode_return_max": 378.0, "episode_return_min": -11.0, "episode_return_mean": 146.52, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.67316651231029, "num_env_steps_trained_throughput_per_sec": 88.67316651231029, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 45449.683, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45449.637, "sample_time_ms": 1118.843, "learn_time_ms": 44314.268, "learn_throughput": 90.264, "synch_weights_time_ms": 13.605}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 31, "trial_id": "51025_00000", "date": "2024-08-12_20-47-49", "timestamp": 1723510069, "time_this_iter_s": 45.154008865356445, "time_total_s": 1422.4579598903656, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cb6c9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1422.4579598903656, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 20.315624999999997, "ram_util_percent": 83.0625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.37428349231286, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.94071839070194, "policy_loss": -0.011168367174705342, "vf_loss": 7.94923208302291, "vf_explained_var": 0.3372069695323863, "kl": 0.008848941855388046, "entropy": 1.2085242086617405, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.262433414736753, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7381690301592387, "policy_loss": -0.008288840937709051, "vf_loss": 3.7450455301022405, "vf_explained_var": 0.12321308545334629, "kl": 0.007061748011197278, "entropy": 1.1083962320650695, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 386.0, "episode_reward_min": -11.0, "episode_reward_mean": 202.47, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -200.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": 22.66, "predator_policy": 78.575}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.0, -11.0, 87.0, 100.0, 162.0, 59.0, 73.0, -9.0, 158.0, 0.0, 101.0, -2.0, 0.0, 152.0, 34.0, 196.0, -9.0, 13.0, 124.0, 180.0, -2.0, 153.0, 311.0, 145.0, 125.0, 21.0, 146.0, 134.0, 172.0, 256.0, 286.0, 33.0, 2.0, -1.0, 352.0, 168.0, 175.0, 333.0, 218.0, 230.0, 253.0, 175.0, 177.0, 356.0, 182.0, 163.0, 343.0, 158.0, 333.0, 220.0, 273.0, 50.0, 187.0, 171.0, 147.0, 224.0, 339.0, -9.0, 137.0, 190.0, 247.0, 332.0, 378.0, 304.0, 335.0, 226.0, 308.0, 150.0, 341.0, 349.0, 258.0, 367.0, 281.0, 185.0, 287.0, 235.0, 314.0, 178.0, 281.0, 318.0, 183.0, 177.0, 281.0, 269.0, 365.0, 326.0, 348.0, 355.0, 320.0, 386.0, 298.0, 380.0, 288.0, 247.0, 162.0, 160.0, 330.0, 382.0, 381.0, 189.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-147.0, -191.0, -189.0, -171.0, -5.0, -42.0, -198.0, -28.0, -15.0, -172.0, -148.0, -114.0, -181.0, -30.0, -85.0, -198.0, 0.0, -106.0, 0.0, 0.0, -200.0, -52.0, -7.0, -8.0, 0.0, 0.0, -170.0, -29.0, -149.0, -170.0, -170.0, 46.0, -176.0, -157.0, -200.0, -170.0, 30.0, -104.0, -200.0, 2.0, -133.0, -167.0, 2.0, 0.0, 179.0, 43.0, -106.0, -5.0, 0.0, -104.0, -19.0, 20.0, 11.0, -184.0, -154.0, 25.0, -159.0, -12.0, -47.0, 106.0, 104.0, 102.0, -160.0, -155.0, -192.0, -197.0, -40.0, -160.0, 166.0, -172.0, -54.0, 82.0, 156.0, 0.0, -86.0, 156.0, -112.0, 112.0, 69.0, 52.0, 102.0, 37.0, 150.0, 0.0, -171.0, 48.0, 181.0, -200.0, 166.0, 0.0, -9.0, 10.0, 126.0, 120.0, 0.0, 84.0, 160.0, 137.0, -132.0, 11.0, -200.0, 101.0, 0.0, -145.0, 0.0, 179.0, 0.0, -168.0, -2.0, 143.0, -188.0, 67.0, 163.0, 136.0, -167.0, -200.0, 0.0, -126.0, 189.0, 0.0, 67.0, -11.0, 62.0, 116.0, 188.0, 172.0, 88.0, 175.0, 160.0, 94.0, 200.0, 26.0, -115.0, 194.0, 134.0, 0.0, 120.0, 146.0, 164.0, 164.0, 121.0, 118.0, 176.0, 174.0, 127.0, 35.0, 170.0, 0.0, 110.0, 154.0, 10.0, 130.0, 100.0, 145.0, 0.0, 175.0, -45.0, 189.0, 70.0, 150.0, 173.0, 0.0, 166.0, 0.0, 107.0, 123.0, 69.0, 198.0, 152.0, 180.0, 111.0, 192.0, 153.0, 187.0, 116.0, 198.0, -125.0, 143.0, 175.0, 200.0, 10.0, 160.0, 184.0, -48.0, 125.0, 76.0, 35.0, 134.0, 0.0, 101.0, 0.0, 120.0, 93.0, 187.0, 200.0, 164.0, 200.0, 177.0, 0.0, 178.0], "policy_predator_policy_reward": [167.0, 183.0, 172.0, 177.0, 13.0, 121.0, 182.0, 144.0, 183.0, 166.0, 171.0, 150.0, 154.0, 130.0, 74.0, 200.0, 115.0, 149.0, 0.0, 0.0, 200.0, 153.0, 13.0, 0.0, 0.0, 0.0, 184.0, 167.0, 179.0, 174.0, 137.0, 183.0, 172.0, 152.0, 187.0, 196.0, 48.0, 150.0, 178.0, 200.0, 165.0, 133.0, 86.0, 65.0, 53.0, 36.0, 130.0, 126.0, 115.0, 114.0, 19.0, 1.0, 186.0, 133.0, 101.0, 162.0, 175.0, 168.0, 79.0, 118.0, 66.0, 14.0, 178.0, 170.0, 194.0, 197.0, 199.0, 0.0, 174.0, 184.0, 36.0, 104.0, 4.0, 15.0, 142.0, 121.0, 106.0, 112.0, 41.0, 68.0, 80.0, 34.0, 0.0, 25.0, 129.0, 171.0, 200.0, 175.0, 0.0, 16.0, 41.0, 121.0, 47.0, 50.0, 51.0, 23.0, 30.0, 6.0, 157.0, 184.0, 200.0, 172.0, 152.0, 43.0, 7.0, 1.0, 166.0, 173.0, 2.0, 4.0, 161.0, 184.0, 13.0, 27.0, 182.0, 176.0, 163.0, 100.0, 1.0, 0.0, 85.0, 106.0, 56.0, 98.0, 18.0, 0.0, 30.0, 11.0, 38.0, 43.0, 0.0, 0.0, 114.0, 115.0, 13.0, 3.0, 29.0, 46.0, 0.0, 21.0, 11.0, 8.0, 17.0, 0.0, 79.0, 40.0, 0.0, 15.0, 22.0, 1.0, 39.0, 56.0, 44.0, 25.0, 0.0, 3.0, 76.0, 61.0, 31.0, 67.0, 8.0, 2.0, 2.0, 9.0, 16.0, 35.0, 2.0, 0.0, 21.0, 12.0, 14.0, 9.0, 7.0, 1.0, 31.0, 10.0, 142.0, 160.0, 0.0, 11.0, 43.0, 85.0, 127.0, 117.0, 25.0, 62.0, 43.0, 35.0, 39.0, 22.0, 19.0, 21.0, 28.0, 22.0, 9.0, 9.0, 2.0, 2.0, 0.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5804352841461873, "mean_inference_ms": 1.3485942517705631, "mean_action_processing_ms": 0.23049596438225722, "mean_env_wait_ms": 0.17293211780570733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006646633148193359, "StateBufferConnector_ms": 0.003073453903198242, "ViewRequirementAgentConnector_ms": 0.09807097911834717}, "num_episodes": 27, "episode_return_max": 386.0, "episode_return_min": -11.0, "episode_return_mean": 202.47, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.85067122913077, "num_env_steps_trained_throughput_per_sec": 88.85067122913077, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 45319.189, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45319.143, "sample_time_ms": 1118.669, "learn_time_ms": 44183.547, "learn_throughput": 90.531, "synch_weights_time_ms": 13.677}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 32, "trial_id": "51025_00000", "date": "2024-08-12_20-48-34", "timestamp": 1723510114, "time_this_iter_s": 45.065223932266235, "time_total_s": 1467.5231838226318, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x15800ddc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1467.5231838226318, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 20.95, "ram_util_percent": 83.02656250000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.761672821751347, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.250376242178458, "policy_loss": -0.012437340989216138, "vf_loss": 8.260266340346563, "vf_explained_var": 0.36692380832616617, "kl": 0.008490784995729295, "entropy": 1.2003513847078595, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.531202308210748, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.179529842245516, "policy_loss": -0.009711787395460147, "vf_loss": 4.187782408951452, "vf_explained_var": 0.14833354155222575, "kl": 0.007296035268657679, "entropy": 1.1734737994178892, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 386.0, "episode_reward_min": -9.0, "episode_reward_mean": 239.83, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -200.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": 61.26, "predator_policy": 58.655}, "custom_metrics": {}, "hist_stats": {"episode_reward": [124.0, 180.0, -2.0, 153.0, 311.0, 145.0, 125.0, 21.0, 146.0, 134.0, 172.0, 256.0, 286.0, 33.0, 2.0, -1.0, 352.0, 168.0, 175.0, 333.0, 218.0, 230.0, 253.0, 175.0, 177.0, 356.0, 182.0, 163.0, 343.0, 158.0, 333.0, 220.0, 273.0, 50.0, 187.0, 171.0, 147.0, 224.0, 339.0, -9.0, 137.0, 190.0, 247.0, 332.0, 378.0, 304.0, 335.0, 226.0, 308.0, 150.0, 341.0, 349.0, 258.0, 367.0, 281.0, 185.0, 287.0, 235.0, 314.0, 178.0, 281.0, 318.0, 183.0, 177.0, 281.0, 269.0, 365.0, 326.0, 348.0, 355.0, 320.0, 386.0, 298.0, 380.0, 288.0, 247.0, 162.0, 160.0, 330.0, 382.0, 381.0, 189.0, 250.0, 263.0, 172.0, 197.0, 337.0, 181.0, 313.0, 180.0, 375.0, 313.0, 293.0, 199.0, 199.0, 363.0, 220.0, 339.0, 336.0, 322.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [30.0, -104.0, -200.0, 2.0, -133.0, -167.0, 2.0, 0.0, 179.0, 43.0, -106.0, -5.0, 0.0, -104.0, -19.0, 20.0, 11.0, -184.0, -154.0, 25.0, -159.0, -12.0, -47.0, 106.0, 104.0, 102.0, -160.0, -155.0, -192.0, -197.0, -40.0, -160.0, 166.0, -172.0, -54.0, 82.0, 156.0, 0.0, -86.0, 156.0, -112.0, 112.0, 69.0, 52.0, 102.0, 37.0, 150.0, 0.0, -171.0, 48.0, 181.0, -200.0, 166.0, 0.0, -9.0, 10.0, 126.0, 120.0, 0.0, 84.0, 160.0, 137.0, -132.0, 11.0, -200.0, 101.0, 0.0, -145.0, 0.0, 179.0, 0.0, -168.0, -2.0, 143.0, -188.0, 67.0, 163.0, 136.0, -167.0, -200.0, 0.0, -126.0, 189.0, 0.0, 67.0, -11.0, 62.0, 116.0, 188.0, 172.0, 88.0, 175.0, 160.0, 94.0, 200.0, 26.0, -115.0, 194.0, 134.0, 0.0, 120.0, 146.0, 164.0, 164.0, 121.0, 118.0, 176.0, 174.0, 127.0, 35.0, 170.0, 0.0, 110.0, 154.0, 10.0, 130.0, 100.0, 145.0, 0.0, 175.0, -45.0, 189.0, 70.0, 150.0, 173.0, 0.0, 166.0, 0.0, 107.0, 123.0, 69.0, 198.0, 152.0, 180.0, 111.0, 192.0, 153.0, 187.0, 116.0, 198.0, -125.0, 143.0, 175.0, 200.0, 10.0, 160.0, 184.0, -48.0, 125.0, 76.0, 35.0, 134.0, 0.0, 101.0, 0.0, 120.0, 93.0, 187.0, 200.0, 164.0, 200.0, 177.0, 0.0, 178.0, 76.0, 155.0, 176.0, -21.0, 128.0, 16.0, 195.0, 0.0, 151.0, 122.0, 0.0, 162.0, 194.0, 24.0, 0.0, 142.0, 176.0, 172.0, 130.0, 149.0, 109.0, 144.0, 190.0, -1.0, 122.0, 41.0, 156.0, 184.0, 195.0, -41.0, 128.0, 178.0, 125.0, 173.0, 158.0, 80.0], "policy_predator_policy_reward": [48.0, 150.0, 178.0, 200.0, 165.0, 133.0, 86.0, 65.0, 53.0, 36.0, 130.0, 126.0, 115.0, 114.0, 19.0, 1.0, 186.0, 133.0, 101.0, 162.0, 175.0, 168.0, 79.0, 118.0, 66.0, 14.0, 178.0, 170.0, 194.0, 197.0, 199.0, 0.0, 174.0, 184.0, 36.0, 104.0, 4.0, 15.0, 142.0, 121.0, 106.0, 112.0, 41.0, 68.0, 80.0, 34.0, 0.0, 25.0, 129.0, 171.0, 200.0, 175.0, 0.0, 16.0, 41.0, 121.0, 47.0, 50.0, 51.0, 23.0, 30.0, 6.0, 157.0, 184.0, 200.0, 172.0, 152.0, 43.0, 7.0, 1.0, 166.0, 173.0, 2.0, 4.0, 161.0, 184.0, 13.0, 27.0, 182.0, 176.0, 163.0, 100.0, 1.0, 0.0, 85.0, 106.0, 56.0, 98.0, 18.0, 0.0, 30.0, 11.0, 38.0, 43.0, 0.0, 0.0, 114.0, 115.0, 13.0, 3.0, 29.0, 46.0, 0.0, 21.0, 11.0, 8.0, 17.0, 0.0, 79.0, 40.0, 0.0, 15.0, 22.0, 1.0, 39.0, 56.0, 44.0, 25.0, 0.0, 3.0, 76.0, 61.0, 31.0, 67.0, 8.0, 2.0, 2.0, 9.0, 16.0, 35.0, 2.0, 0.0, 21.0, 12.0, 14.0, 9.0, 7.0, 1.0, 31.0, 10.0, 142.0, 160.0, 0.0, 11.0, 43.0, 85.0, 127.0, 117.0, 25.0, 62.0, 43.0, 35.0, 39.0, 22.0, 19.0, 21.0, 28.0, 22.0, 9.0, 9.0, 2.0, 2.0, 0.0, 11.0, 14.0, 5.0, 8.0, 100.0, 19.0, 9.0, 0.0, 2.0, 26.0, 38.0, 19.0, 0.0, 7.0, 88.0, 18.0, 20.0, 25.0, 2.0, 28.0, 6.0, 22.0, 18.0, 1.0, 9.0, 29.0, 7.0, 14.0, 9.0, 44.0, 22.0, 7.0, 26.0, 34.0, 4.0, 44.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5792392617237274, "mean_inference_ms": 1.345209206450373, "mean_action_processing_ms": 0.2302950882854822, "mean_env_wait_ms": 0.1727011176198156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035505294799804688, "StateBufferConnector_ms": 0.0030426979064941406, "ViewRequirementAgentConnector_ms": 0.09386694431304932}, "num_episodes": 18, "episode_return_max": 386.0, "episode_return_min": -9.0, "episode_return_mean": 239.83, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 89.20257297380482, "num_env_steps_trained_throughput_per_sec": 89.20257297380482, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 45311.346, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45311.3, "sample_time_ms": 1117.907, "learn_time_ms": 44176.669, "learn_throughput": 90.546, "synch_weights_time_ms": 13.552}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 33, "trial_id": "51025_00000", "date": "2024-08-12_20-49-19", "timestamp": 1723510159, "time_this_iter_s": 44.87217307090759, "time_total_s": 1512.3953568935394, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158086ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1512.3953568935394, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 20.334375, "ram_util_percent": 82.77499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.143522977513611, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.857693367408066, "policy_loss": -0.00906979643109023, "vf_loss": 8.864855562946785, "vf_explained_var": 0.4027761529677759, "kl": 0.006358676853173054, "entropy": 1.177350973199915, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.140969498952229, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.232795236350367, "policy_loss": -0.011327022356449296, "vf_loss": 4.242193559237889, "vf_explained_var": 0.09751237290246147, "kl": 0.009643539955629653, "entropy": 1.190155007788744, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 386.0, "episode_reward_min": -9.0, "episode_reward_mean": 265.04, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -200.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": 91.1, "predator_policy": 41.42}, "custom_metrics": {}, "hist_stats": {"episode_reward": [175.0, 333.0, 218.0, 230.0, 253.0, 175.0, 177.0, 356.0, 182.0, 163.0, 343.0, 158.0, 333.0, 220.0, 273.0, 50.0, 187.0, 171.0, 147.0, 224.0, 339.0, -9.0, 137.0, 190.0, 247.0, 332.0, 378.0, 304.0, 335.0, 226.0, 308.0, 150.0, 341.0, 349.0, 258.0, 367.0, 281.0, 185.0, 287.0, 235.0, 314.0, 178.0, 281.0, 318.0, 183.0, 177.0, 281.0, 269.0, 365.0, 326.0, 348.0, 355.0, 320.0, 386.0, 298.0, 380.0, 288.0, 247.0, 162.0, 160.0, 330.0, 382.0, 381.0, 189.0, 250.0, 263.0, 172.0, 197.0, 337.0, 181.0, 313.0, 180.0, 375.0, 313.0, 293.0, 199.0, 199.0, 363.0, 220.0, 339.0, 336.0, 322.0, 20.0, 293.0, 373.0, 172.0, 192.0, 249.0, 268.0, 310.0, 287.0, 381.0, 232.0, 365.0, 209.0, 366.0, 350.0, 371.0, 386.0, 302.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [156.0, 0.0, -86.0, 156.0, -112.0, 112.0, 69.0, 52.0, 102.0, 37.0, 150.0, 0.0, -171.0, 48.0, 181.0, -200.0, 166.0, 0.0, -9.0, 10.0, 126.0, 120.0, 0.0, 84.0, 160.0, 137.0, -132.0, 11.0, -200.0, 101.0, 0.0, -145.0, 0.0, 179.0, 0.0, -168.0, -2.0, 143.0, -188.0, 67.0, 163.0, 136.0, -167.0, -200.0, 0.0, -126.0, 189.0, 0.0, 67.0, -11.0, 62.0, 116.0, 188.0, 172.0, 88.0, 175.0, 160.0, 94.0, 200.0, 26.0, -115.0, 194.0, 134.0, 0.0, 120.0, 146.0, 164.0, 164.0, 121.0, 118.0, 176.0, 174.0, 127.0, 35.0, 170.0, 0.0, 110.0, 154.0, 10.0, 130.0, 100.0, 145.0, 0.0, 175.0, -45.0, 189.0, 70.0, 150.0, 173.0, 0.0, 166.0, 0.0, 107.0, 123.0, 69.0, 198.0, 152.0, 180.0, 111.0, 192.0, 153.0, 187.0, 116.0, 198.0, -125.0, 143.0, 175.0, 200.0, 10.0, 160.0, 184.0, -48.0, 125.0, 76.0, 35.0, 134.0, 0.0, 101.0, 0.0, 120.0, 93.0, 187.0, 200.0, 164.0, 200.0, 177.0, 0.0, 178.0, 76.0, 155.0, 176.0, -21.0, 128.0, 16.0, 195.0, 0.0, 151.0, 122.0, 0.0, 162.0, 194.0, 24.0, 0.0, 142.0, 176.0, 172.0, 130.0, 149.0, 109.0, 144.0, 190.0, -1.0, 122.0, 41.0, 156.0, 184.0, 195.0, -41.0, 128.0, 178.0, 125.0, 173.0, 158.0, 80.0, 20.0, -2.0, 41.0, 174.0, 188.0, 164.0, 0.0, 133.0, 176.0, 4.0, 7.0, 150.0, 84.0, 156.0, 101.0, 140.0, 144.0, 62.0, 185.0, 184.0, 192.0, -89.0, 154.0, 174.0, -37.0, 192.0, 184.0, 148.0, 178.0, 142.0, 190.0, 142.0, 176.0, 196.0, 178.0, 85.0], "policy_predator_policy_reward": [4.0, 15.0, 142.0, 121.0, 106.0, 112.0, 41.0, 68.0, 80.0, 34.0, 0.0, 25.0, 129.0, 171.0, 200.0, 175.0, 0.0, 16.0, 41.0, 121.0, 47.0, 50.0, 51.0, 23.0, 30.0, 6.0, 157.0, 184.0, 200.0, 172.0, 152.0, 43.0, 7.0, 1.0, 166.0, 173.0, 2.0, 4.0, 161.0, 184.0, 13.0, 27.0, 182.0, 176.0, 163.0, 100.0, 1.0, 0.0, 85.0, 106.0, 56.0, 98.0, 18.0, 0.0, 30.0, 11.0, 38.0, 43.0, 0.0, 0.0, 114.0, 115.0, 13.0, 3.0, 29.0, 46.0, 0.0, 21.0, 11.0, 8.0, 17.0, 0.0, 79.0, 40.0, 0.0, 15.0, 22.0, 1.0, 39.0, 56.0, 44.0, 25.0, 0.0, 3.0, 76.0, 61.0, 31.0, 67.0, 8.0, 2.0, 2.0, 9.0, 16.0, 35.0, 2.0, 0.0, 21.0, 12.0, 14.0, 9.0, 7.0, 1.0, 31.0, 10.0, 142.0, 160.0, 0.0, 11.0, 43.0, 85.0, 127.0, 117.0, 25.0, 62.0, 43.0, 35.0, 39.0, 22.0, 19.0, 21.0, 28.0, 22.0, 9.0, 9.0, 2.0, 2.0, 0.0, 11.0, 14.0, 5.0, 8.0, 100.0, 19.0, 9.0, 0.0, 2.0, 26.0, 38.0, 19.0, 0.0, 7.0, 88.0, 18.0, 20.0, 25.0, 2.0, 28.0, 6.0, 22.0, 18.0, 1.0, 9.0, 29.0, 7.0, 14.0, 9.0, 44.0, 22.0, 7.0, 26.0, 34.0, 4.0, 44.0, 40.0, 2.0, 0.0, 77.0, 1.0, 11.0, 10.0, 17.0, 22.0, 1.0, 11.0, 60.0, 32.0, 18.0, 10.0, 36.0, 33.0, 5.0, 76.0, 0.0, 12.0, 89.0, 40.0, 12.0, 25.0, 50.0, 4.0, 33.0, 1.0, 29.0, 1.0, 20.0, 19.0, 2.0, 12.0, 33.0, 6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5784218225914295, "mean_inference_ms": 1.3419071280184312, "mean_action_processing_ms": 0.2300035554562232, "mean_env_wait_ms": 0.17253469961847678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036329030990600586, "StateBufferConnector_ms": 0.003075122833251953, "ViewRequirementAgentConnector_ms": 0.09517395496368408}, "num_episodes": 18, "episode_return_max": 386.0, "episode_return_min": -9.0, "episode_return_mean": 265.04, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 89.00304294499357, "num_env_steps_trained_throughput_per_sec": 89.00304294499357, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 45304.068, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45304.022, "sample_time_ms": 1111.555, "learn_time_ms": 44175.916, "learn_throughput": 90.547, "synch_weights_time_ms": 13.389}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 34, "trial_id": "51025_00000", "date": "2024-08-12_20-50-04", "timestamp": 1723510204, "time_this_iter_s": 44.96949100494385, "time_total_s": 1557.3648478984833, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1580263a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1557.3648478984833, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 20.626984126984123, "ram_util_percent": 82.67777777777776}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.756522613416904, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.07381339325476, "policy_loss": -0.00938409752798853, "vf_loss": 8.081021851080436, "vf_explained_var": 0.4564731033390792, "kl": 0.007252092733700849, "entropy": 1.155300017387148, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.67808402808255, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.371426457576651, "policy_loss": -0.010601606348864537, "vf_loss": 2.3803825383463866, "vf_explained_var": 0.16113540180145747, "kl": 0.008227592044256457, "entropy": 1.1236176371574402, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 386.0, "episode_reward_min": -9.0, "episode_reward_mean": 276.98, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -200.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 184.0}, "policy_reward_mean": {"prey_policy": 108.87, "predator_policy": 29.62}, "custom_metrics": {}, "hist_stats": {"episode_reward": [147.0, 224.0, 339.0, -9.0, 137.0, 190.0, 247.0, 332.0, 378.0, 304.0, 335.0, 226.0, 308.0, 150.0, 341.0, 349.0, 258.0, 367.0, 281.0, 185.0, 287.0, 235.0, 314.0, 178.0, 281.0, 318.0, 183.0, 177.0, 281.0, 269.0, 365.0, 326.0, 348.0, 355.0, 320.0, 386.0, 298.0, 380.0, 288.0, 247.0, 162.0, 160.0, 330.0, 382.0, 381.0, 189.0, 250.0, 263.0, 172.0, 197.0, 337.0, 181.0, 313.0, 180.0, 375.0, 313.0, 293.0, 199.0, 199.0, 363.0, 220.0, 339.0, 336.0, 322.0, 20.0, 293.0, 373.0, 172.0, 192.0, 249.0, 268.0, 310.0, 287.0, 381.0, 232.0, 365.0, 209.0, 366.0, 350.0, 371.0, 386.0, 302.0, 191.0, 264.0, 313.0, 0.0, 356.0, 334.0, 198.0, 373.0, 383.0, 313.0, 306.0, 367.0, 331.0, 353.0, 237.0, 164.0, 355.0, 353.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.0, 143.0, -188.0, 67.0, 163.0, 136.0, -167.0, -200.0, 0.0, -126.0, 189.0, 0.0, 67.0, -11.0, 62.0, 116.0, 188.0, 172.0, 88.0, 175.0, 160.0, 94.0, 200.0, 26.0, -115.0, 194.0, 134.0, 0.0, 120.0, 146.0, 164.0, 164.0, 121.0, 118.0, 176.0, 174.0, 127.0, 35.0, 170.0, 0.0, 110.0, 154.0, 10.0, 130.0, 100.0, 145.0, 0.0, 175.0, -45.0, 189.0, 70.0, 150.0, 173.0, 0.0, 166.0, 0.0, 107.0, 123.0, 69.0, 198.0, 152.0, 180.0, 111.0, 192.0, 153.0, 187.0, 116.0, 198.0, -125.0, 143.0, 175.0, 200.0, 10.0, 160.0, 184.0, -48.0, 125.0, 76.0, 35.0, 134.0, 0.0, 101.0, 0.0, 120.0, 93.0, 187.0, 200.0, 164.0, 200.0, 177.0, 0.0, 178.0, 76.0, 155.0, 176.0, -21.0, 128.0, 16.0, 195.0, 0.0, 151.0, 122.0, 0.0, 162.0, 194.0, 24.0, 0.0, 142.0, 176.0, 172.0, 130.0, 149.0, 109.0, 144.0, 190.0, -1.0, 122.0, 41.0, 156.0, 184.0, 195.0, -41.0, 128.0, 178.0, 125.0, 173.0, 158.0, 80.0, 20.0, -2.0, 41.0, 174.0, 188.0, 164.0, 0.0, 133.0, 176.0, 4.0, 7.0, 150.0, 84.0, 156.0, 101.0, 140.0, 144.0, 62.0, 185.0, 184.0, 192.0, -89.0, 154.0, 174.0, -37.0, 192.0, 184.0, 148.0, 178.0, 142.0, 190.0, 142.0, 176.0, 196.0, 178.0, 85.0, -33.0, 130.0, 170.0, 81.0, 112.0, 147.0, 0.0, 0.0, 171.0, 152.0, 159.0, 138.0, 196.0, 0.0, 184.0, 189.0, 192.0, 174.0, 118.0, 138.0, 176.0, 30.0, 196.0, 166.0, 127.0, 178.0, 200.0, 106.0, 54.0, 74.0, 146.0, 0.0, 172.0, 135.0, 166.0, 144.0], "policy_predator_policy_reward": [2.0, 4.0, 161.0, 184.0, 13.0, 27.0, 182.0, 176.0, 163.0, 100.0, 1.0, 0.0, 85.0, 106.0, 56.0, 98.0, 18.0, 0.0, 30.0, 11.0, 38.0, 43.0, 0.0, 0.0, 114.0, 115.0, 13.0, 3.0, 29.0, 46.0, 0.0, 21.0, 11.0, 8.0, 17.0, 0.0, 79.0, 40.0, 0.0, 15.0, 22.0, 1.0, 39.0, 56.0, 44.0, 25.0, 0.0, 3.0, 76.0, 61.0, 31.0, 67.0, 8.0, 2.0, 2.0, 9.0, 16.0, 35.0, 2.0, 0.0, 21.0, 12.0, 14.0, 9.0, 7.0, 1.0, 31.0, 10.0, 142.0, 160.0, 0.0, 11.0, 43.0, 85.0, 127.0, 117.0, 25.0, 62.0, 43.0, 35.0, 39.0, 22.0, 19.0, 21.0, 28.0, 22.0, 9.0, 9.0, 2.0, 2.0, 0.0, 11.0, 14.0, 5.0, 8.0, 100.0, 19.0, 9.0, 0.0, 2.0, 26.0, 38.0, 19.0, 0.0, 7.0, 88.0, 18.0, 20.0, 25.0, 2.0, 28.0, 6.0, 22.0, 18.0, 1.0, 9.0, 29.0, 7.0, 14.0, 9.0, 44.0, 22.0, 7.0, 26.0, 34.0, 4.0, 44.0, 40.0, 2.0, 0.0, 77.0, 1.0, 11.0, 10.0, 17.0, 22.0, 1.0, 11.0, 60.0, 32.0, 18.0, 10.0, 36.0, 33.0, 5.0, 76.0, 0.0, 12.0, 89.0, 40.0, 12.0, 25.0, 50.0, 4.0, 33.0, 1.0, 29.0, 1.0, 20.0, 19.0, 2.0, 12.0, 33.0, 6.0, 39.0, 55.0, 9.0, 4.0, 41.0, 13.0, 0.0, 0.0, 2.0, 31.0, 20.0, 17.0, 1.0, 1.0, 0.0, 0.0, 10.0, 7.0, 22.0, 35.0, 59.0, 41.0, 2.0, 3.0, 5.0, 21.0, 47.0, 0.0, 65.0, 44.0, 0.0, 18.0, 17.0, 31.0, 12.0, 31.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5777288455984805, "mean_inference_ms": 1.3392128183352598, "mean_action_processing_ms": 0.22975961962495695, "mean_env_wait_ms": 0.17238500118168695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036531686782836914, "StateBufferConnector_ms": 0.0031685829162597656, "ViewRequirementAgentConnector_ms": 0.0956573486328125}, "num_episodes": 18, "episode_return_max": 386.0, "episode_return_min": -9.0, "episode_return_mean": 276.98, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 89.13252800294987, "num_env_steps_trained_throughput_per_sec": 89.13252800294987, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 45258.662, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45258.617, "sample_time_ms": 1114.066, "learn_time_ms": 44129.079, "learn_throughput": 90.643, "synch_weights_time_ms": 13.19}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 35, "trial_id": "51025_00000", "date": "2024-08-12_20-50-49", "timestamp": 1723510249, "time_this_iter_s": 44.9299418926239, "time_total_s": 1602.2947897911072, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cb6caf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1602.2947897911072, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 20.096874999999997, "ram_util_percent": 82.71875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.093581412708948, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.373860220934349, "policy_loss": -0.009387322153807396, "vf_loss": 8.38164629078416, "vf_explained_var": 0.31189744942402714, "kl": 0.005337556717342272, "entropy": 1.13853047329282, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.7845140448323, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8785471743376796, "policy_loss": -0.014205873611003712, "vf_loss": 2.8910900292573154, "vf_explained_var": 0.22899951562679635, "kl": 0.008315119903520898, "entropy": 1.1510324041048685, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 392.0, "episode_reward_min": 0.0, "episode_reward_mean": 280.01, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -125.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 160.0}, "policy_reward_mean": {"prey_policy": 116.29, "predator_policy": 23.715}, "custom_metrics": {}, "hist_stats": {"episode_reward": [314.0, 178.0, 281.0, 318.0, 183.0, 177.0, 281.0, 269.0, 365.0, 326.0, 348.0, 355.0, 320.0, 386.0, 298.0, 380.0, 288.0, 247.0, 162.0, 160.0, 330.0, 382.0, 381.0, 189.0, 250.0, 263.0, 172.0, 197.0, 337.0, 181.0, 313.0, 180.0, 375.0, 313.0, 293.0, 199.0, 199.0, 363.0, 220.0, 339.0, 336.0, 322.0, 20.0, 293.0, 373.0, 172.0, 192.0, 249.0, 268.0, 310.0, 287.0, 381.0, 232.0, 365.0, 209.0, 366.0, 350.0, 371.0, 386.0, 302.0, 191.0, 264.0, 313.0, 0.0, 356.0, 334.0, 198.0, 373.0, 383.0, 313.0, 306.0, 367.0, 331.0, 353.0, 237.0, 164.0, 355.0, 353.0, 233.0, 359.0, 389.0, 329.0, 199.0, 279.0, 348.0, 291.0, 276.0, 181.0, 298.0, 172.0, 182.0, 339.0, 349.0, 143.0, 308.0, 392.0, 156.0, 151.0, 369.0, 171.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [100.0, 145.0, 0.0, 175.0, -45.0, 189.0, 70.0, 150.0, 173.0, 0.0, 166.0, 0.0, 107.0, 123.0, 69.0, 198.0, 152.0, 180.0, 111.0, 192.0, 153.0, 187.0, 116.0, 198.0, -125.0, 143.0, 175.0, 200.0, 10.0, 160.0, 184.0, -48.0, 125.0, 76.0, 35.0, 134.0, 0.0, 101.0, 0.0, 120.0, 93.0, 187.0, 200.0, 164.0, 200.0, 177.0, 0.0, 178.0, 76.0, 155.0, 176.0, -21.0, 128.0, 16.0, 195.0, 0.0, 151.0, 122.0, 0.0, 162.0, 194.0, 24.0, 0.0, 142.0, 176.0, 172.0, 130.0, 149.0, 109.0, 144.0, 190.0, -1.0, 122.0, 41.0, 156.0, 184.0, 195.0, -41.0, 128.0, 178.0, 125.0, 173.0, 158.0, 80.0, 20.0, -2.0, 41.0, 174.0, 188.0, 164.0, 0.0, 133.0, 176.0, 4.0, 7.0, 150.0, 84.0, 156.0, 101.0, 140.0, 144.0, 62.0, 185.0, 184.0, 192.0, -89.0, 154.0, 174.0, -37.0, 192.0, 184.0, 148.0, 178.0, 142.0, 190.0, 142.0, 176.0, 196.0, 178.0, 85.0, -33.0, 130.0, 170.0, 81.0, 112.0, 147.0, 0.0, 0.0, 171.0, 152.0, 159.0, 138.0, 196.0, 0.0, 184.0, 189.0, 192.0, 174.0, 118.0, 138.0, 176.0, 30.0, 196.0, 166.0, 127.0, 178.0, 200.0, 106.0, 54.0, 74.0, 146.0, 0.0, 172.0, 135.0, 166.0, 144.0, 194.0, -30.0, 153.0, 198.0, 188.0, 184.0, 82.0, 146.0, 198.0, -25.0, 142.0, 82.0, 150.0, 168.0, 118.0, 122.0, 67.0, 172.0, 163.0, 0.0, 112.0, 113.0, 147.0, 0.0, 152.0, 0.0, 171.0, 114.0, 169.0, 130.0, 0.0, 136.0, 174.0, 98.0, 195.0, 195.0, 0.0, 130.0, 14.0, 29.0, 161.0, 183.0, 21.0, 52.0], "policy_predator_policy_reward": [44.0, 25.0, 0.0, 3.0, 76.0, 61.0, 31.0, 67.0, 8.0, 2.0, 2.0, 9.0, 16.0, 35.0, 2.0, 0.0, 21.0, 12.0, 14.0, 9.0, 7.0, 1.0, 31.0, 10.0, 142.0, 160.0, 0.0, 11.0, 43.0, 85.0, 127.0, 117.0, 25.0, 62.0, 43.0, 35.0, 39.0, 22.0, 19.0, 21.0, 28.0, 22.0, 9.0, 9.0, 2.0, 2.0, 0.0, 11.0, 14.0, 5.0, 8.0, 100.0, 19.0, 9.0, 0.0, 2.0, 26.0, 38.0, 19.0, 0.0, 7.0, 88.0, 18.0, 20.0, 25.0, 2.0, 28.0, 6.0, 22.0, 18.0, 1.0, 9.0, 29.0, 7.0, 14.0, 9.0, 44.0, 22.0, 7.0, 26.0, 34.0, 4.0, 44.0, 40.0, 2.0, 0.0, 77.0, 1.0, 11.0, 10.0, 17.0, 22.0, 1.0, 11.0, 60.0, 32.0, 18.0, 10.0, 36.0, 33.0, 5.0, 76.0, 0.0, 12.0, 89.0, 40.0, 12.0, 25.0, 50.0, 4.0, 33.0, 1.0, 29.0, 1.0, 20.0, 19.0, 2.0, 12.0, 33.0, 6.0, 39.0, 55.0, 9.0, 4.0, 41.0, 13.0, 0.0, 0.0, 2.0, 31.0, 20.0, 17.0, 1.0, 1.0, 0.0, 0.0, 10.0, 7.0, 22.0, 35.0, 59.0, 41.0, 2.0, 3.0, 5.0, 21.0, 47.0, 0.0, 65.0, 44.0, 0.0, 18.0, 17.0, 31.0, 12.0, 31.0, 2.0, 67.0, 3.0, 5.0, 4.0, 13.0, 30.0, 71.0, 1.0, 25.0, 33.0, 22.0, 29.0, 1.0, 3.0, 48.0, 24.0, 13.0, 6.0, 12.0, 49.0, 24.0, 22.0, 3.0, 15.0, 15.0, 10.0, 44.0, 35.0, 15.0, 2.0, 5.0, 2.0, 34.0, 1.0, 1.0, 1.0, 25.0, 75.0, 33.0, 25.0, 0.0, 0.0, 98.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5770846795470789, "mean_inference_ms": 1.3358302751980926, "mean_action_processing_ms": 0.22938288532110285, "mean_env_wait_ms": 0.17222065092087227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003569960594177246, "StateBufferConnector_ms": 0.0033686161041259766, "ViewRequirementAgentConnector_ms": 0.09468722343444824}, "num_episodes": 22, "episode_return_max": 392.0, "episode_return_min": 0.0, "episode_return_mean": 280.01, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 89.29165148177287, "num_env_steps_trained_throughput_per_sec": 89.29165148177287, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 45227.877, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45227.832, "sample_time_ms": 1114.577, "learn_time_ms": 44097.387, "learn_throughput": 90.708, "synch_weights_time_ms": 13.339}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 36, "trial_id": "51025_00000", "date": "2024-08-12_20-51-33", "timestamp": 1723510293, "time_this_iter_s": 44.82920789718628, "time_total_s": 1647.1239976882935, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x15805d820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1647.1239976882935, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 20.17936507936508, "ram_util_percent": 82.75396825396825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.419266558198071, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.43622301318658, "policy_loss": -0.010501554213272082, "vf_loss": 8.44469699430718, "vf_explained_var": 0.10588780947463222, "kl": 0.006758468020028946, "entropy": 1.149050384160703, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.419421020765153, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.3063574881780715, "policy_loss": -0.011381016703194411, "vf_loss": 4.316256943581596, "vf_explained_var": 0.22032068050096906, "kl": 0.007407795276793724, "entropy": 1.1110720409287347, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 392.0, "episode_reward_min": 0.0, "episode_reward_mean": 276.56, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -121.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 178.0}, "policy_reward_mean": {"prey_policy": 114.22, "predator_policy": 24.06}, "custom_metrics": {}, "hist_stats": {"episode_reward": [189.0, 250.0, 263.0, 172.0, 197.0, 337.0, 181.0, 313.0, 180.0, 375.0, 313.0, 293.0, 199.0, 199.0, 363.0, 220.0, 339.0, 336.0, 322.0, 20.0, 293.0, 373.0, 172.0, 192.0, 249.0, 268.0, 310.0, 287.0, 381.0, 232.0, 365.0, 209.0, 366.0, 350.0, 371.0, 386.0, 302.0, 191.0, 264.0, 313.0, 0.0, 356.0, 334.0, 198.0, 373.0, 383.0, 313.0, 306.0, 367.0, 331.0, 353.0, 237.0, 164.0, 355.0, 353.0, 233.0, 359.0, 389.0, 329.0, 199.0, 279.0, 348.0, 291.0, 276.0, 181.0, 298.0, 172.0, 182.0, 339.0, 349.0, 143.0, 308.0, 392.0, 156.0, 151.0, 369.0, 171.0, 238.0, 94.0, 144.0, 292.0, 236.0, 129.0, 375.0, 192.0, 353.0, 339.0, 363.0, 382.0, 346.0, 377.0, 293.0, 280.0, 252.0, 315.0, 282.0, 322.0, 351.0, 317.0, 112.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 178.0, 76.0, 155.0, 176.0, -21.0, 128.0, 16.0, 195.0, 0.0, 151.0, 122.0, 0.0, 162.0, 194.0, 24.0, 0.0, 142.0, 176.0, 172.0, 130.0, 149.0, 109.0, 144.0, 190.0, -1.0, 122.0, 41.0, 156.0, 184.0, 195.0, -41.0, 128.0, 178.0, 125.0, 173.0, 158.0, 80.0, 20.0, -2.0, 41.0, 174.0, 188.0, 164.0, 0.0, 133.0, 176.0, 4.0, 7.0, 150.0, 84.0, 156.0, 101.0, 140.0, 144.0, 62.0, 185.0, 184.0, 192.0, -89.0, 154.0, 174.0, -37.0, 192.0, 184.0, 148.0, 178.0, 142.0, 190.0, 142.0, 176.0, 196.0, 178.0, 85.0, -33.0, 130.0, 170.0, 81.0, 112.0, 147.0, 0.0, 0.0, 171.0, 152.0, 159.0, 138.0, 196.0, 0.0, 184.0, 189.0, 192.0, 174.0, 118.0, 138.0, 176.0, 30.0, 196.0, 166.0, 127.0, 178.0, 200.0, 106.0, 54.0, 74.0, 146.0, 0.0, 172.0, 135.0, 166.0, 144.0, 194.0, -30.0, 153.0, 198.0, 188.0, 184.0, 82.0, 146.0, 198.0, -25.0, 142.0, 82.0, 150.0, 168.0, 118.0, 122.0, 67.0, 172.0, 163.0, 0.0, 112.0, 113.0, 147.0, 0.0, 152.0, 0.0, 171.0, 114.0, 169.0, 130.0, 0.0, 136.0, 174.0, 98.0, 195.0, 195.0, 0.0, 130.0, 14.0, 29.0, 161.0, 183.0, 21.0, 52.0, -2.0, 130.0, -22.0, -114.0, 6.0, -25.0, 79.0, 106.0, 55.0, 92.0, 0.0, 102.0, 186.0, 160.0, 0.0, 189.0, 150.0, 162.0, 178.0, 150.0, 178.0, 168.0, 192.0, 172.0, 175.0, 134.0, 178.0, 182.0, 156.0, 109.0, 80.0, 114.0, 74.0, 26.0, 177.0, 128.0, 42.0, 142.0, 125.0, 192.0, 146.0, 192.0, 42.0, 154.0, -121.0, 67.0], "policy_predator_policy_reward": [0.0, 11.0, 14.0, 5.0, 8.0, 100.0, 19.0, 9.0, 0.0, 2.0, 26.0, 38.0, 19.0, 0.0, 7.0, 88.0, 18.0, 20.0, 25.0, 2.0, 28.0, 6.0, 22.0, 18.0, 1.0, 9.0, 29.0, 7.0, 14.0, 9.0, 44.0, 22.0, 7.0, 26.0, 34.0, 4.0, 44.0, 40.0, 2.0, 0.0, 77.0, 1.0, 11.0, 10.0, 17.0, 22.0, 1.0, 11.0, 60.0, 32.0, 18.0, 10.0, 36.0, 33.0, 5.0, 76.0, 0.0, 12.0, 89.0, 40.0, 12.0, 25.0, 50.0, 4.0, 33.0, 1.0, 29.0, 1.0, 20.0, 19.0, 2.0, 12.0, 33.0, 6.0, 39.0, 55.0, 9.0, 4.0, 41.0, 13.0, 0.0, 0.0, 2.0, 31.0, 20.0, 17.0, 1.0, 1.0, 0.0, 0.0, 10.0, 7.0, 22.0, 35.0, 59.0, 41.0, 2.0, 3.0, 5.0, 21.0, 47.0, 0.0, 65.0, 44.0, 0.0, 18.0, 17.0, 31.0, 12.0, 31.0, 2.0, 67.0, 3.0, 5.0, 4.0, 13.0, 30.0, 71.0, 1.0, 25.0, 33.0, 22.0, 29.0, 1.0, 3.0, 48.0, 24.0, 13.0, 6.0, 12.0, 49.0, 24.0, 22.0, 3.0, 15.0, 15.0, 10.0, 44.0, 35.0, 15.0, 2.0, 5.0, 2.0, 34.0, 1.0, 1.0, 1.0, 25.0, 75.0, 33.0, 25.0, 0.0, 0.0, 98.0, 2.0, 108.0, 52.0, 178.0, 84.0, 79.0, 50.0, 57.0, 42.0, 47.0, 7.0, 20.0, 18.0, 11.0, 0.0, 3.0, 20.0, 21.0, 11.0, 0.0, 16.0, 1.0, 5.0, 13.0, 11.0, 26.0, 17.0, 0.0, 10.0, 18.0, 18.0, 68.0, 72.0, 80.0, 1.0, 9.0, 62.0, 36.0, 2.0, 3.0, 7.0, 6.0, 59.0, 62.0, 161.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.576403755152026, "mean_inference_ms": 1.3336322078710823, "mean_action_processing_ms": 0.22920082872999392, "mean_env_wait_ms": 0.1722083474156012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003377199172973633, "StateBufferConnector_ms": 0.003303050994873047, "ViewRequirementAgentConnector_ms": 0.0928647518157959}, "num_episodes": 23, "episode_return_max": 392.0, "episode_return_min": 0.0, "episode_return_mean": 276.56, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.50403980633305, "num_env_steps_trained_throughput_per_sec": 88.50403980633305, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 45132.176, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45132.131, "sample_time_ms": 1115.736, "learn_time_ms": 43999.8, "learn_throughput": 90.91, "synch_weights_time_ms": 13.497}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 37, "trial_id": "51025_00000", "date": "2024-08-12_20-52-19", "timestamp": 1723510339, "time_this_iter_s": 45.226938009262085, "time_total_s": 1692.3509356975555, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cb633a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1692.3509356975555, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 20.909375, "ram_util_percent": 82.7265625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.420894828675285, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.240731117208169, "policy_loss": -0.00933540780208118, "vf_loss": 8.248066937229622, "vf_explained_var": 0.1358931939753275, "kl": 0.006665282145892969, "entropy": 1.1849753833952403, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.61138681078714, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.6081136519316015, "policy_loss": -0.017326002859968753, "vf_loss": 4.622820648692903, "vf_explained_var": 0.17524603176369238, "kl": 0.013095038501423968, "entropy": 1.126583101320519, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 392.0, "episode_reward_min": 0.0, "episode_reward_mean": 271.65, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -121.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 178.0}, "policy_reward_mean": {"prey_policy": 109.73, "predator_policy": 26.095}, "custom_metrics": {}, "hist_stats": {"episode_reward": [322.0, 20.0, 293.0, 373.0, 172.0, 192.0, 249.0, 268.0, 310.0, 287.0, 381.0, 232.0, 365.0, 209.0, 366.0, 350.0, 371.0, 386.0, 302.0, 191.0, 264.0, 313.0, 0.0, 356.0, 334.0, 198.0, 373.0, 383.0, 313.0, 306.0, 367.0, 331.0, 353.0, 237.0, 164.0, 355.0, 353.0, 233.0, 359.0, 389.0, 329.0, 199.0, 279.0, 348.0, 291.0, 276.0, 181.0, 298.0, 172.0, 182.0, 339.0, 349.0, 143.0, 308.0, 392.0, 156.0, 151.0, 369.0, 171.0, 238.0, 94.0, 144.0, 292.0, 236.0, 129.0, 375.0, 192.0, 353.0, 339.0, 363.0, 382.0, 346.0, 377.0, 293.0, 280.0, 252.0, 315.0, 282.0, 322.0, 351.0, 317.0, 112.0, 336.0, 321.0, 348.0, 68.0, 306.0, 103.0, 90.0, 234.0, 226.0, 142.0, 276.0, 164.0, 377.0, 343.0, 322.0, 136.0, 241.0, 195.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [158.0, 80.0, 20.0, -2.0, 41.0, 174.0, 188.0, 164.0, 0.0, 133.0, 176.0, 4.0, 7.0, 150.0, 84.0, 156.0, 101.0, 140.0, 144.0, 62.0, 185.0, 184.0, 192.0, -89.0, 154.0, 174.0, -37.0, 192.0, 184.0, 148.0, 178.0, 142.0, 190.0, 142.0, 176.0, 196.0, 178.0, 85.0, -33.0, 130.0, 170.0, 81.0, 112.0, 147.0, 0.0, 0.0, 171.0, 152.0, 159.0, 138.0, 196.0, 0.0, 184.0, 189.0, 192.0, 174.0, 118.0, 138.0, 176.0, 30.0, 196.0, 166.0, 127.0, 178.0, 200.0, 106.0, 54.0, 74.0, 146.0, 0.0, 172.0, 135.0, 166.0, 144.0, 194.0, -30.0, 153.0, 198.0, 188.0, 184.0, 82.0, 146.0, 198.0, -25.0, 142.0, 82.0, 150.0, 168.0, 118.0, 122.0, 67.0, 172.0, 163.0, 0.0, 112.0, 113.0, 147.0, 0.0, 152.0, 0.0, 171.0, 114.0, 169.0, 130.0, 0.0, 136.0, 174.0, 98.0, 195.0, 195.0, 0.0, 130.0, 14.0, 29.0, 161.0, 183.0, 21.0, 52.0, -2.0, 130.0, -22.0, -114.0, 6.0, -25.0, 79.0, 106.0, 55.0, 92.0, 0.0, 102.0, 186.0, 160.0, 0.0, 189.0, 150.0, 162.0, 178.0, 150.0, 178.0, 168.0, 192.0, 172.0, 175.0, 134.0, 178.0, 182.0, 156.0, 109.0, 80.0, 114.0, 74.0, 26.0, 177.0, 128.0, 42.0, 142.0, 125.0, 192.0, 146.0, 192.0, 42.0, 154.0, -121.0, 67.0, 122.0, 182.0, 114.0, 152.0, 165.0, 165.0, 5.0, -84.0, 110.0, 134.0, 0.0, 51.0, -64.0, -44.0, 52.0, 164.0, 39.0, 160.0, 39.0, -3.0, 93.0, 126.0, 86.0, 0.0, 150.0, 188.0, 181.0, 124.0, 139.0, 170.0, -1.0, 89.0, 67.0, 87.0, 47.0, 125.0], "policy_predator_policy_reward": [44.0, 40.0, 2.0, 0.0, 77.0, 1.0, 11.0, 10.0, 17.0, 22.0, 1.0, 11.0, 60.0, 32.0, 18.0, 10.0, 36.0, 33.0, 5.0, 76.0, 0.0, 12.0, 89.0, 40.0, 12.0, 25.0, 50.0, 4.0, 33.0, 1.0, 29.0, 1.0, 20.0, 19.0, 2.0, 12.0, 33.0, 6.0, 39.0, 55.0, 9.0, 4.0, 41.0, 13.0, 0.0, 0.0, 2.0, 31.0, 20.0, 17.0, 1.0, 1.0, 0.0, 0.0, 10.0, 7.0, 22.0, 35.0, 59.0, 41.0, 2.0, 3.0, 5.0, 21.0, 47.0, 0.0, 65.0, 44.0, 0.0, 18.0, 17.0, 31.0, 12.0, 31.0, 2.0, 67.0, 3.0, 5.0, 4.0, 13.0, 30.0, 71.0, 1.0, 25.0, 33.0, 22.0, 29.0, 1.0, 3.0, 48.0, 24.0, 13.0, 6.0, 12.0, 49.0, 24.0, 22.0, 3.0, 15.0, 15.0, 10.0, 44.0, 35.0, 15.0, 2.0, 5.0, 2.0, 34.0, 1.0, 1.0, 1.0, 25.0, 75.0, 33.0, 25.0, 0.0, 0.0, 98.0, 2.0, 108.0, 52.0, 178.0, 84.0, 79.0, 50.0, 57.0, 42.0, 47.0, 7.0, 20.0, 18.0, 11.0, 0.0, 3.0, 20.0, 21.0, 11.0, 0.0, 16.0, 1.0, 5.0, 13.0, 11.0, 26.0, 17.0, 0.0, 10.0, 18.0, 18.0, 68.0, 72.0, 80.0, 1.0, 9.0, 62.0, 36.0, 2.0, 3.0, 7.0, 6.0, 59.0, 62.0, 161.0, 5.0, 4.0, 28.0, 7.0, 48.0, 2.0, 16.0, 58.0, 89.0, 54.0, 8.0, 15.0, 37.0, 150.0, 48.0, 0.0, 18.0, 27.0, 0.0, 54.0, 52.0, 34.0, 23.0, 33.0, 45.0, 25.0, 14.0, 37.0, 1.0, 7.0, 6.0, 47.0, 1.0, 77.0, 10.0, 8.0, 15.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5758991468168984, "mean_inference_ms": 1.3314571998298532, "mean_action_processing_ms": 0.22898679869359193, "mean_env_wait_ms": 0.17216371002706615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003360748291015625, "StateBufferConnector_ms": 0.0045708417892456055, "ViewRequirementAgentConnector_ms": 0.09192121028900146}, "num_episodes": 18, "episode_return_max": 392.0, "episode_return_min": 0.0, "episode_return_mean": 271.65, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.73648692058636, "num_env_steps_trained_throughput_per_sec": 88.73648692058636, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 45076.326, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45076.28, "sample_time_ms": 1043.494, "learn_time_ms": 44015.179, "learn_throughput": 90.878, "synch_weights_time_ms": 14.155}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 38, "trial_id": "51025_00000", "date": "2024-08-12_20-53-04", "timestamp": 1723510384, "time_this_iter_s": 45.102165937423706, "time_total_s": 1737.4531016349792, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158086310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1737.4531016349792, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 21.35, "ram_util_percent": 83.2078125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.06303757309283, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.602489804212379, "policy_loss": -0.008728986717612734, "vf_loss": 8.609538308400957, "vf_explained_var": -0.027007600649324042, "kl": 0.00560159635154116, "entropy": 1.1579950991761747, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.655287251018343, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.738454481659743, "policy_loss": -0.01413951982182288, "vf_loss": 5.750930984184225, "vf_explained_var": 0.19597959575198945, "kl": 0.008315149578325255, "entropy": 1.010986299268783, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 392.0, "episode_reward_min": -20.0, "episode_reward_mean": 261.04, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -121.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 178.0}, "policy_reward_mean": {"prey_policy": 100.09, "predator_policy": 30.43}, "custom_metrics": {}, "hist_stats": {"episode_reward": [302.0, 191.0, 264.0, 313.0, 0.0, 356.0, 334.0, 198.0, 373.0, 383.0, 313.0, 306.0, 367.0, 331.0, 353.0, 237.0, 164.0, 355.0, 353.0, 233.0, 359.0, 389.0, 329.0, 199.0, 279.0, 348.0, 291.0, 276.0, 181.0, 298.0, 172.0, 182.0, 339.0, 349.0, 143.0, 308.0, 392.0, 156.0, 151.0, 369.0, 171.0, 238.0, 94.0, 144.0, 292.0, 236.0, 129.0, 375.0, 192.0, 353.0, 339.0, 363.0, 382.0, 346.0, 377.0, 293.0, 280.0, 252.0, 315.0, 282.0, 322.0, 351.0, 317.0, 112.0, 336.0, 321.0, 348.0, 68.0, 306.0, 103.0, 90.0, 234.0, 226.0, 142.0, 276.0, 164.0, 377.0, 343.0, 322.0, 136.0, 241.0, 195.0, 190.0, 206.0, 306.0, 339.0, 322.0, 186.0, 284.0, 189.0, 166.0, 229.0, -20.0, 116.0, 155.0, 303.0, 283.0, 171.0, 292.0, 368.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [178.0, 85.0, -33.0, 130.0, 170.0, 81.0, 112.0, 147.0, 0.0, 0.0, 171.0, 152.0, 159.0, 138.0, 196.0, 0.0, 184.0, 189.0, 192.0, 174.0, 118.0, 138.0, 176.0, 30.0, 196.0, 166.0, 127.0, 178.0, 200.0, 106.0, 54.0, 74.0, 146.0, 0.0, 172.0, 135.0, 166.0, 144.0, 194.0, -30.0, 153.0, 198.0, 188.0, 184.0, 82.0, 146.0, 198.0, -25.0, 142.0, 82.0, 150.0, 168.0, 118.0, 122.0, 67.0, 172.0, 163.0, 0.0, 112.0, 113.0, 147.0, 0.0, 152.0, 0.0, 171.0, 114.0, 169.0, 130.0, 0.0, 136.0, 174.0, 98.0, 195.0, 195.0, 0.0, 130.0, 14.0, 29.0, 161.0, 183.0, 21.0, 52.0, -2.0, 130.0, -22.0, -114.0, 6.0, -25.0, 79.0, 106.0, 55.0, 92.0, 0.0, 102.0, 186.0, 160.0, 0.0, 189.0, 150.0, 162.0, 178.0, 150.0, 178.0, 168.0, 192.0, 172.0, 175.0, 134.0, 178.0, 182.0, 156.0, 109.0, 80.0, 114.0, 74.0, 26.0, 177.0, 128.0, 42.0, 142.0, 125.0, 192.0, 146.0, 192.0, 42.0, 154.0, -121.0, 67.0, 122.0, 182.0, 114.0, 152.0, 165.0, 165.0, 5.0, -84.0, 110.0, 134.0, 0.0, 51.0, -64.0, -44.0, 52.0, 164.0, 39.0, 160.0, 39.0, -3.0, 93.0, 126.0, 86.0, 0.0, 150.0, 188.0, 181.0, 124.0, 139.0, 170.0, -1.0, 89.0, 67.0, 87.0, 47.0, 125.0, -23.0, 181.0, 80.0, 52.0, 138.0, 125.0, 154.0, 136.0, 126.0, 145.0, 92.0, 12.0, 45.0, 172.0, 1.0, 32.0, -13.0, 6.0, 87.0, 10.0, -110.0, -81.0, 0.0, -42.0, -35.0, -1.0, 146.0, 116.0, 102.0, 136.0, 50.0, -7.0, 122.0, 88.0, 133.0, 188.0], "policy_predator_policy_reward": [33.0, 6.0, 39.0, 55.0, 9.0, 4.0, 41.0, 13.0, 0.0, 0.0, 2.0, 31.0, 20.0, 17.0, 1.0, 1.0, 0.0, 0.0, 10.0, 7.0, 22.0, 35.0, 59.0, 41.0, 2.0, 3.0, 5.0, 21.0, 47.0, 0.0, 65.0, 44.0, 0.0, 18.0, 17.0, 31.0, 12.0, 31.0, 2.0, 67.0, 3.0, 5.0, 4.0, 13.0, 30.0, 71.0, 1.0, 25.0, 33.0, 22.0, 29.0, 1.0, 3.0, 48.0, 24.0, 13.0, 6.0, 12.0, 49.0, 24.0, 22.0, 3.0, 15.0, 15.0, 10.0, 44.0, 35.0, 15.0, 2.0, 5.0, 2.0, 34.0, 1.0, 1.0, 1.0, 25.0, 75.0, 33.0, 25.0, 0.0, 0.0, 98.0, 2.0, 108.0, 52.0, 178.0, 84.0, 79.0, 50.0, 57.0, 42.0, 47.0, 7.0, 20.0, 18.0, 11.0, 0.0, 3.0, 20.0, 21.0, 11.0, 0.0, 16.0, 1.0, 5.0, 13.0, 11.0, 26.0, 17.0, 0.0, 10.0, 18.0, 18.0, 68.0, 72.0, 80.0, 1.0, 9.0, 62.0, 36.0, 2.0, 3.0, 7.0, 6.0, 59.0, 62.0, 161.0, 5.0, 4.0, 28.0, 7.0, 48.0, 2.0, 16.0, 58.0, 89.0, 54.0, 8.0, 15.0, 37.0, 150.0, 48.0, 0.0, 18.0, 27.0, 0.0, 54.0, 52.0, 34.0, 23.0, 33.0, 45.0, 25.0, 14.0, 37.0, 1.0, 7.0, 6.0, 47.0, 1.0, 77.0, 10.0, 8.0, 15.0, 32.0, 0.0, 50.0, 24.0, 6.0, 37.0, 16.0, 33.0, 13.0, 38.0, 80.0, 2.0, 0.0, 67.0, 110.0, 46.0, 75.0, 98.0, 48.0, 84.0, 13.0, 158.0, 57.0, 101.0, 89.0, 102.0, 6.0, 35.0, 45.0, 0.0, 70.0, 58.0, 55.0, 27.0, 36.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5753255658854599, "mean_inference_ms": 1.3291347437561338, "mean_action_processing_ms": 0.2287478726707862, "mean_env_wait_ms": 0.17206516516481762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003276228904724121, "StateBufferConnector_ms": 0.0045500993728637695, "ViewRequirementAgentConnector_ms": 0.08890664577484131}, "num_episodes": 18, "episode_return_max": 392.0, "episode_return_min": -20.0, "episode_return_mean": 261.04, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 89.07828297509798, "num_env_steps_trained_throughput_per_sec": 89.07828297509798, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 45000.109, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45000.064, "sample_time_ms": 1046.118, "learn_time_ms": 43936.389, "learn_throughput": 91.041, "synch_weights_time_ms": 14.09}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 39, "trial_id": "51025_00000", "date": "2024-08-12_20-53-49", "timestamp": 1723510429, "time_this_iter_s": 44.9752402305603, "time_total_s": 1782.4283418655396, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158052d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1782.4283418655396, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 21.653125, "ram_util_percent": 82.64375000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.442753181823347, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.424369465358673, "policy_loss": -0.011514445827909248, "vf_loss": 9.43357127103856, "vf_explained_var": -0.1532179658375089, "kl": 0.007708941995238044, "entropy": 1.1671974335397992, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.105885992731366, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.312782320900569, "policy_loss": -0.013272718168184082, "vf_loss": 7.323678016914893, "vf_explained_var": 0.20618998972827166, "kl": 0.011885176230090427, "entropy": 1.0222685458798888, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 392.0, "episode_reward_min": -76.0, "episode_reward_mean": 226.51, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -168.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 180.0}, "policy_reward_mean": {"prey_policy": 71.595, "predator_policy": 41.66}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.0, 199.0, 279.0, 348.0, 291.0, 276.0, 181.0, 298.0, 172.0, 182.0, 339.0, 349.0, 143.0, 308.0, 392.0, 156.0, 151.0, 369.0, 171.0, 238.0, 94.0, 144.0, 292.0, 236.0, 129.0, 375.0, 192.0, 353.0, 339.0, 363.0, 382.0, 346.0, 377.0, 293.0, 280.0, 252.0, 315.0, 282.0, 322.0, 351.0, 317.0, 112.0, 336.0, 321.0, 348.0, 68.0, 306.0, 103.0, 90.0, 234.0, 226.0, 142.0, 276.0, 164.0, 377.0, 343.0, 322.0, 136.0, 241.0, 195.0, 190.0, 206.0, 306.0, 339.0, 322.0, 186.0, 284.0, 189.0, 166.0, 229.0, -20.0, 116.0, 155.0, 303.0, 283.0, 171.0, 292.0, 368.0, 228.0, 155.0, -76.0, 184.0, 319.0, 81.0, 145.0, 151.0, 37.0, 195.0, 127.0, 0.0, 250.0, 63.0, -9.0, 194.0, 392.0, 33.0, 83.0, 100.0, 145.0, 224.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [82.0, 146.0, 198.0, -25.0, 142.0, 82.0, 150.0, 168.0, 118.0, 122.0, 67.0, 172.0, 163.0, 0.0, 112.0, 113.0, 147.0, 0.0, 152.0, 0.0, 171.0, 114.0, 169.0, 130.0, 0.0, 136.0, 174.0, 98.0, 195.0, 195.0, 0.0, 130.0, 14.0, 29.0, 161.0, 183.0, 21.0, 52.0, -2.0, 130.0, -22.0, -114.0, 6.0, -25.0, 79.0, 106.0, 55.0, 92.0, 0.0, 102.0, 186.0, 160.0, 0.0, 189.0, 150.0, 162.0, 178.0, 150.0, 178.0, 168.0, 192.0, 172.0, 175.0, 134.0, 178.0, 182.0, 156.0, 109.0, 80.0, 114.0, 74.0, 26.0, 177.0, 128.0, 42.0, 142.0, 125.0, 192.0, 146.0, 192.0, 42.0, 154.0, -121.0, 67.0, 122.0, 182.0, 114.0, 152.0, 165.0, 165.0, 5.0, -84.0, 110.0, 134.0, 0.0, 51.0, -64.0, -44.0, 52.0, 164.0, 39.0, 160.0, 39.0, -3.0, 93.0, 126.0, 86.0, 0.0, 150.0, 188.0, 181.0, 124.0, 139.0, 170.0, -1.0, 89.0, 67.0, 87.0, 47.0, 125.0, -23.0, 181.0, 80.0, 52.0, 138.0, 125.0, 154.0, 136.0, 126.0, 145.0, 92.0, 12.0, 45.0, 172.0, 1.0, 32.0, -13.0, 6.0, 87.0, 10.0, -110.0, -81.0, 0.0, -42.0, -35.0, -1.0, 146.0, 116.0, 102.0, 136.0, 50.0, -7.0, 122.0, 88.0, 133.0, 188.0, 0.0, 76.0, 0.0, 36.0, -133.0, -109.0, 174.0, -30.0, 95.0, 166.0, -42.0, 12.0, 0.0, 99.0, 27.0, -32.0, -100.0, -28.0, 21.0, 31.0, -30.0, -74.0, -168.0, -148.0, 20.0, 163.0, -36.0, -61.0, -104.0, -96.0, 30.0, 60.0, 200.0, 186.0, -78.0, -105.0, -140.0, -82.0, -7.0, -5.0, 96.0, -13.0, -32.0, 100.0], "policy_predator_policy_reward": [30.0, 71.0, 1.0, 25.0, 33.0, 22.0, 29.0, 1.0, 3.0, 48.0, 24.0, 13.0, 6.0, 12.0, 49.0, 24.0, 22.0, 3.0, 15.0, 15.0, 10.0, 44.0, 35.0, 15.0, 2.0, 5.0, 2.0, 34.0, 1.0, 1.0, 1.0, 25.0, 75.0, 33.0, 25.0, 0.0, 0.0, 98.0, 2.0, 108.0, 52.0, 178.0, 84.0, 79.0, 50.0, 57.0, 42.0, 47.0, 7.0, 20.0, 18.0, 11.0, 0.0, 3.0, 20.0, 21.0, 11.0, 0.0, 16.0, 1.0, 5.0, 13.0, 11.0, 26.0, 17.0, 0.0, 10.0, 18.0, 18.0, 68.0, 72.0, 80.0, 1.0, 9.0, 62.0, 36.0, 2.0, 3.0, 7.0, 6.0, 59.0, 62.0, 161.0, 5.0, 4.0, 28.0, 7.0, 48.0, 2.0, 16.0, 58.0, 89.0, 54.0, 8.0, 15.0, 37.0, 150.0, 48.0, 0.0, 18.0, 27.0, 0.0, 54.0, 52.0, 34.0, 23.0, 33.0, 45.0, 25.0, 14.0, 37.0, 1.0, 7.0, 6.0, 47.0, 1.0, 77.0, 10.0, 8.0, 15.0, 32.0, 0.0, 50.0, 24.0, 6.0, 37.0, 16.0, 33.0, 13.0, 38.0, 80.0, 2.0, 0.0, 67.0, 110.0, 46.0, 75.0, 98.0, 48.0, 84.0, 13.0, 158.0, 57.0, 101.0, 89.0, 102.0, 6.0, 35.0, 45.0, 0.0, 70.0, 58.0, 55.0, 27.0, 36.0, 11.0, 109.0, 43.0, 108.0, 11.0, 166.0, 0.0, 25.0, 15.0, 36.0, 22.0, 111.0, 0.0, 0.0, 46.0, 49.0, 107.0, 145.0, 20.0, 81.0, 62.0, 91.0, 140.0, 157.0, 159.0, 13.0, 54.0, 154.0, 6.0, 180.0, 11.0, 0.0, 104.0, 6.0, 0.0, 88.0, 128.0, 172.0, 133.0, 72.0, 40.0, 62.0, 0.0, 54.0, 102.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.574689688919919, "mean_inference_ms": 1.3256944735988765, "mean_action_processing_ms": 0.2283681404110346, "mean_env_wait_ms": 0.17184794981951676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032722949981689453, "StateBufferConnector_ms": 0.004458427429199219, "ViewRequirementAgentConnector_ms": 0.08793485164642334}, "num_episodes": 22, "episode_return_max": 392.0, "episode_return_min": -76.0, "episode_return_mean": 226.51, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.13917322516747, "num_env_steps_trained_throughput_per_sec": 88.13917322516747, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 45014.703, "restore_workers_time_ms": 0.014, "training_step_time_ms": 45014.657, "sample_time_ms": 1049.853, "learn_time_ms": 43946.894, "learn_throughput": 91.019, "synch_weights_time_ms": 14.083}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 40, "trial_id": "51025_00000", "date": "2024-08-12_20-54-34", "timestamp": 1723510474, "time_this_iter_s": 45.4269061088562, "time_total_s": 1827.8552479743958, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158086670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1827.8552479743958, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 22.2125, "ram_util_percent": 82.57187499999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.024259968125631, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.515616909410587, "policy_loss": -0.011232942251596975, "vf_loss": 9.524647184402223, "vf_explained_var": -0.23110143447679188, "kl": 0.007342266890236474, "entropy": 1.105580270416522, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.595445220432584, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.535917832359434, "policy_loss": -0.01327552931289627, "vf_loss": 8.547383084877458, "vf_explained_var": 0.1347693282775778, "kl": 0.009051155663330843, "entropy": 1.0787601994143592, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 392.0, "episode_reward_min": -138.0, "episode_reward_mean": 187.64, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -192.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 191.0}, "policy_reward_mean": {"prey_policy": 35.725, "predator_policy": 58.095}, "custom_metrics": {}, "hist_stats": {"episode_reward": [236.0, 129.0, 375.0, 192.0, 353.0, 339.0, 363.0, 382.0, 346.0, 377.0, 293.0, 280.0, 252.0, 315.0, 282.0, 322.0, 351.0, 317.0, 112.0, 336.0, 321.0, 348.0, 68.0, 306.0, 103.0, 90.0, 234.0, 226.0, 142.0, 276.0, 164.0, 377.0, 343.0, 322.0, 136.0, 241.0, 195.0, 190.0, 206.0, 306.0, 339.0, 322.0, 186.0, 284.0, 189.0, 166.0, 229.0, -20.0, 116.0, 155.0, 303.0, 283.0, 171.0, 292.0, 368.0, 228.0, 155.0, -76.0, 184.0, 319.0, 81.0, 145.0, 151.0, 37.0, 195.0, 127.0, 0.0, 250.0, 63.0, -9.0, 194.0, 392.0, 33.0, 83.0, 100.0, 145.0, 224.0, 42.0, 254.0, 49.0, -37.0, 82.0, 123.0, 106.0, 163.0, 17.0, -1.0, 131.0, 122.0, 203.0, 116.0, -138.0, 95.0, 28.0, 20.0, -17.0, 119.0, -17.0, 118.0, 236.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [55.0, 92.0, 0.0, 102.0, 186.0, 160.0, 0.0, 189.0, 150.0, 162.0, 178.0, 150.0, 178.0, 168.0, 192.0, 172.0, 175.0, 134.0, 178.0, 182.0, 156.0, 109.0, 80.0, 114.0, 74.0, 26.0, 177.0, 128.0, 42.0, 142.0, 125.0, 192.0, 146.0, 192.0, 42.0, 154.0, -121.0, 67.0, 122.0, 182.0, 114.0, 152.0, 165.0, 165.0, 5.0, -84.0, 110.0, 134.0, 0.0, 51.0, -64.0, -44.0, 52.0, 164.0, 39.0, 160.0, 39.0, -3.0, 93.0, 126.0, 86.0, 0.0, 150.0, 188.0, 181.0, 124.0, 139.0, 170.0, -1.0, 89.0, 67.0, 87.0, 47.0, 125.0, -23.0, 181.0, 80.0, 52.0, 138.0, 125.0, 154.0, 136.0, 126.0, 145.0, 92.0, 12.0, 45.0, 172.0, 1.0, 32.0, -13.0, 6.0, 87.0, 10.0, -110.0, -81.0, 0.0, -42.0, -35.0, -1.0, 146.0, 116.0, 102.0, 136.0, 50.0, -7.0, 122.0, 88.0, 133.0, 188.0, 0.0, 76.0, 0.0, 36.0, -133.0, -109.0, 174.0, -30.0, 95.0, 166.0, -42.0, 12.0, 0.0, 99.0, 27.0, -32.0, -100.0, -28.0, 21.0, 31.0, -30.0, -74.0, -168.0, -148.0, 20.0, 163.0, -36.0, -61.0, -104.0, -96.0, 30.0, 60.0, 200.0, 186.0, -78.0, -105.0, -140.0, -82.0, -7.0, -5.0, 96.0, -13.0, -32.0, 100.0, -126.0, -106.0, 58.0, 110.0, -31.0, -143.0, -135.0, -144.0, -49.0, -65.0, 31.0, -58.0, -20.0, -82.0, 14.0, 54.0, -122.0, -123.0, -114.0, -154.0, -17.0, -132.0, -80.0, -52.0, 15.0, 73.0, -136.0, -11.0, -174.0, -170.0, -46.0, -64.0, -192.0, -39.0, -125.0, -63.0, -150.0, -158.0, 18.0, -29.0, -126.0, -142.0, -39.0, -40.0, 94.0, 55.0], "policy_predator_policy_reward": [42.0, 47.0, 7.0, 20.0, 18.0, 11.0, 0.0, 3.0, 20.0, 21.0, 11.0, 0.0, 16.0, 1.0, 5.0, 13.0, 11.0, 26.0, 17.0, 0.0, 10.0, 18.0, 18.0, 68.0, 72.0, 80.0, 1.0, 9.0, 62.0, 36.0, 2.0, 3.0, 7.0, 6.0, 59.0, 62.0, 161.0, 5.0, 4.0, 28.0, 7.0, 48.0, 2.0, 16.0, 58.0, 89.0, 54.0, 8.0, 15.0, 37.0, 150.0, 48.0, 0.0, 18.0, 27.0, 0.0, 54.0, 52.0, 34.0, 23.0, 33.0, 45.0, 25.0, 14.0, 37.0, 1.0, 7.0, 6.0, 47.0, 1.0, 77.0, 10.0, 8.0, 15.0, 32.0, 0.0, 50.0, 24.0, 6.0, 37.0, 16.0, 33.0, 13.0, 38.0, 80.0, 2.0, 0.0, 67.0, 110.0, 46.0, 75.0, 98.0, 48.0, 84.0, 13.0, 158.0, 57.0, 101.0, 89.0, 102.0, 6.0, 35.0, 45.0, 0.0, 70.0, 58.0, 55.0, 27.0, 36.0, 11.0, 109.0, 43.0, 108.0, 11.0, 166.0, 0.0, 25.0, 15.0, 36.0, 22.0, 111.0, 0.0, 0.0, 46.0, 49.0, 107.0, 145.0, 20.0, 81.0, 62.0, 91.0, 140.0, 157.0, 159.0, 13.0, 54.0, 154.0, 6.0, 180.0, 11.0, 0.0, 104.0, 6.0, 0.0, 88.0, 128.0, 172.0, 133.0, 72.0, 40.0, 62.0, 0.0, 54.0, 102.0, 130.0, 144.0, 65.0, 21.0, 168.0, 55.0, 178.0, 64.0, 120.0, 76.0, 118.0, 32.0, 131.0, 77.0, 0.0, 95.0, 135.0, 127.0, 129.0, 138.0, 140.0, 140.0, 152.0, 102.0, 93.0, 22.0, 119.0, 144.0, 30.0, 176.0, 92.0, 113.0, 191.0, 68.0, 79.0, 129.0, 115.0, 176.0, 110.0, 20.0, 125.0, 126.0, 120.0, 77.0, 23.0, 64.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5754784427222679, "mean_inference_ms": 1.3253076018883234, "mean_action_processing_ms": 0.22831787223858083, "mean_env_wait_ms": 0.1717991875456578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033925771713256836, "StateBufferConnector_ms": 0.0044209957122802734, "ViewRequirementAgentConnector_ms": 0.10279333591461182}, "num_episodes": 23, "episode_return_max": 392.0, "episode_return_min": -138.0, "episode_return_mean": 187.64, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.35824044768975, "num_env_steps_trained_throughput_per_sec": 88.35824044768975, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 45030.781, "restore_workers_time_ms": 0.014, "training_step_time_ms": 45030.734, "sample_time_ms": 1080.437, "learn_time_ms": 43932.738, "learn_throughput": 91.048, "synch_weights_time_ms": 13.857}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 41, "trial_id": "51025_00000", "date": "2024-08-12_20-55-20", "timestamp": 1723510520, "time_this_iter_s": 45.30712103843689, "time_total_s": 1873.1623690128326, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cb6cd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1873.1623690128326, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 20.635937499999997, "ram_util_percent": 82.7109375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.699332555639681, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.452374246385363, "policy_loss": -0.011223296301498537, "vf_loss": 9.461344722969821, "vf_explained_var": -0.5216779318436113, "kl": 0.00750936538942408, "entropy": 1.0736727877899452, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.117530733819994, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.520020945362313, "policy_loss": -0.014519455398694075, "vf_loss": 8.532576079343363, "vf_explained_var": 0.21035466695588734, "kl": 0.009821684352554887, "entropy": 1.0913004065947558, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 392.0, "episode_reward_min": -138.0, "episode_reward_mean": 143.43, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -192.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": -3.725, "predator_policy": 75.44}, "custom_metrics": {}, "hist_stats": {"episode_reward": [112.0, 336.0, 321.0, 348.0, 68.0, 306.0, 103.0, 90.0, 234.0, 226.0, 142.0, 276.0, 164.0, 377.0, 343.0, 322.0, 136.0, 241.0, 195.0, 190.0, 206.0, 306.0, 339.0, 322.0, 186.0, 284.0, 189.0, 166.0, 229.0, -20.0, 116.0, 155.0, 303.0, 283.0, 171.0, 292.0, 368.0, 228.0, 155.0, -76.0, 184.0, 319.0, 81.0, 145.0, 151.0, 37.0, 195.0, 127.0, 0.0, 250.0, 63.0, -9.0, 194.0, 392.0, 33.0, 83.0, 100.0, 145.0, 224.0, 42.0, 254.0, 49.0, -37.0, 82.0, 123.0, 106.0, 163.0, 17.0, -1.0, 131.0, 122.0, 203.0, 116.0, -138.0, 95.0, 28.0, 20.0, -17.0, 119.0, -17.0, 118.0, 236.0, -62.0, 71.0, 61.0, 22.0, 6.0, 69.0, 112.0, -22.0, 161.0, 67.0, 96.0, 58.0, 67.0, 61.0, -7.0, 193.0, 16.0, 114.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-121.0, 67.0, 122.0, 182.0, 114.0, 152.0, 165.0, 165.0, 5.0, -84.0, 110.0, 134.0, 0.0, 51.0, -64.0, -44.0, 52.0, 164.0, 39.0, 160.0, 39.0, -3.0, 93.0, 126.0, 86.0, 0.0, 150.0, 188.0, 181.0, 124.0, 139.0, 170.0, -1.0, 89.0, 67.0, 87.0, 47.0, 125.0, -23.0, 181.0, 80.0, 52.0, 138.0, 125.0, 154.0, 136.0, 126.0, 145.0, 92.0, 12.0, 45.0, 172.0, 1.0, 32.0, -13.0, 6.0, 87.0, 10.0, -110.0, -81.0, 0.0, -42.0, -35.0, -1.0, 146.0, 116.0, 102.0, 136.0, 50.0, -7.0, 122.0, 88.0, 133.0, 188.0, 0.0, 76.0, 0.0, 36.0, -133.0, -109.0, 174.0, -30.0, 95.0, 166.0, -42.0, 12.0, 0.0, 99.0, 27.0, -32.0, -100.0, -28.0, 21.0, 31.0, -30.0, -74.0, -168.0, -148.0, 20.0, 163.0, -36.0, -61.0, -104.0, -96.0, 30.0, 60.0, 200.0, 186.0, -78.0, -105.0, -140.0, -82.0, -7.0, -5.0, 96.0, -13.0, -32.0, 100.0, -126.0, -106.0, 58.0, 110.0, -31.0, -143.0, -135.0, -144.0, -49.0, -65.0, 31.0, -58.0, -20.0, -82.0, 14.0, 54.0, -122.0, -123.0, -114.0, -154.0, -17.0, -132.0, -80.0, -52.0, 15.0, 73.0, -136.0, -11.0, -174.0, -170.0, -46.0, -64.0, -192.0, -39.0, -125.0, -63.0, -150.0, -158.0, 18.0, -29.0, -126.0, -142.0, -39.0, -40.0, 94.0, 55.0, -189.0, -100.0, -44.0, -51.0, -150.0, -69.0, -165.0, -134.0, -158.0, -122.0, -35.0, -55.0, -134.0, -68.0, -121.0, -107.0, -14.0, -18.0, -2.0, -186.0, -16.0, 9.0, -35.0, -160.0, 38.0, -148.0, -23.0, -113.0, -148.0, -167.0, -122.0, 38.0, -149.0, -126.0, -94.0, -50.0], "policy_predator_policy_reward": [161.0, 5.0, 4.0, 28.0, 7.0, 48.0, 2.0, 16.0, 58.0, 89.0, 54.0, 8.0, 15.0, 37.0, 150.0, 48.0, 0.0, 18.0, 27.0, 0.0, 54.0, 52.0, 34.0, 23.0, 33.0, 45.0, 25.0, 14.0, 37.0, 1.0, 7.0, 6.0, 47.0, 1.0, 77.0, 10.0, 8.0, 15.0, 32.0, 0.0, 50.0, 24.0, 6.0, 37.0, 16.0, 33.0, 13.0, 38.0, 80.0, 2.0, 0.0, 67.0, 110.0, 46.0, 75.0, 98.0, 48.0, 84.0, 13.0, 158.0, 57.0, 101.0, 89.0, 102.0, 6.0, 35.0, 45.0, 0.0, 70.0, 58.0, 55.0, 27.0, 36.0, 11.0, 109.0, 43.0, 108.0, 11.0, 166.0, 0.0, 25.0, 15.0, 36.0, 22.0, 111.0, 0.0, 0.0, 46.0, 49.0, 107.0, 145.0, 20.0, 81.0, 62.0, 91.0, 140.0, 157.0, 159.0, 13.0, 54.0, 154.0, 6.0, 180.0, 11.0, 0.0, 104.0, 6.0, 0.0, 88.0, 128.0, 172.0, 133.0, 72.0, 40.0, 62.0, 0.0, 54.0, 102.0, 130.0, 144.0, 65.0, 21.0, 168.0, 55.0, 178.0, 64.0, 120.0, 76.0, 118.0, 32.0, 131.0, 77.0, 0.0, 95.0, 135.0, 127.0, 129.0, 138.0, 140.0, 140.0, 152.0, 102.0, 93.0, 22.0, 119.0, 144.0, 30.0, 176.0, 92.0, 113.0, 191.0, 68.0, 79.0, 129.0, 115.0, 176.0, 110.0, 20.0, 125.0, 126.0, 120.0, 77.0, 23.0, 64.0, 187.0, 40.0, 88.0, 78.0, 119.0, 161.0, 123.0, 198.0, 119.0, 167.0, 105.0, 54.0, 156.0, 158.0, 87.0, 119.0, 54.0, 139.0, 163.0, 92.0, 0.0, 103.0, 155.0, 98.0, 177.0, 0.0, 62.0, 135.0, 168.0, 140.0, 152.0, 125.0, 122.0, 169.0, 139.0, 119.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5758523035977268, "mean_inference_ms": 1.3245970652035755, "mean_action_processing_ms": 0.22839651490847754, "mean_env_wait_ms": 0.1717713071241802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033888816833496094, "StateBufferConnector_ms": 0.004420876502990723, "ViewRequirementAgentConnector_ms": 0.10226190090179443}, "num_episodes": 18, "episode_return_max": 392.0, "episode_return_min": -138.0, "episode_return_mean": 143.43, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.47438832062406, "num_env_steps_trained_throughput_per_sec": 88.47438832062406, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 45049.928, "restore_workers_time_ms": 0.014, "training_step_time_ms": 45049.88, "sample_time_ms": 1080.857, "learn_time_ms": 43951.929, "learn_throughput": 91.009, "synch_weights_time_ms": 13.692}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 42, "trial_id": "51025_00000", "date": "2024-08-12_20-56-05", "timestamp": 1723510565, "time_this_iter_s": 45.2698712348938, "time_total_s": 1918.4322402477264, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cb77790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1918.4322402477264, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 20.395312500000003, "ram_util_percent": 82.3375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.506761810010072, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.965174327073274, "policy_loss": -0.010574888340665629, "vf_loss": 8.973697435792792, "vf_explained_var": -0.4069149134020326, "kl": 0.006839255297051575, "entropy": 1.0090879526087846, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.799244906536487, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.629949328760622, "policy_loss": -0.012100321535641948, "vf_loss": 8.640219466648405, "vf_explained_var": 0.16018692728072878, "kl": 0.009150873144975025, "entropy": 1.0532681907926287, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 392.0, "episode_reward_min": -138.0, "episode_reward_mean": 114.35, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -196.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": -34.065, "predator_policy": 91.24}, "custom_metrics": {}, "hist_stats": {"episode_reward": [195.0, 190.0, 206.0, 306.0, 339.0, 322.0, 186.0, 284.0, 189.0, 166.0, 229.0, -20.0, 116.0, 155.0, 303.0, 283.0, 171.0, 292.0, 368.0, 228.0, 155.0, -76.0, 184.0, 319.0, 81.0, 145.0, 151.0, 37.0, 195.0, 127.0, 0.0, 250.0, 63.0, -9.0, 194.0, 392.0, 33.0, 83.0, 100.0, 145.0, 224.0, 42.0, 254.0, 49.0, -37.0, 82.0, 123.0, 106.0, 163.0, 17.0, -1.0, 131.0, 122.0, 203.0, 116.0, -138.0, 95.0, 28.0, 20.0, -17.0, 119.0, -17.0, 118.0, 236.0, -62.0, 71.0, 61.0, 22.0, 6.0, 69.0, 112.0, -22.0, 161.0, 67.0, 96.0, 58.0, 67.0, 61.0, -7.0, 193.0, 16.0, 114.0, 105.0, 41.0, 109.0, 101.0, 24.0, 11.0, -84.0, 111.0, 138.0, 0.0, 148.0, 98.0, 149.0, 51.0, 159.0, 26.0, 75.0, -25.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [47.0, 125.0, -23.0, 181.0, 80.0, 52.0, 138.0, 125.0, 154.0, 136.0, 126.0, 145.0, 92.0, 12.0, 45.0, 172.0, 1.0, 32.0, -13.0, 6.0, 87.0, 10.0, -110.0, -81.0, 0.0, -42.0, -35.0, -1.0, 146.0, 116.0, 102.0, 136.0, 50.0, -7.0, 122.0, 88.0, 133.0, 188.0, 0.0, 76.0, 0.0, 36.0, -133.0, -109.0, 174.0, -30.0, 95.0, 166.0, -42.0, 12.0, 0.0, 99.0, 27.0, -32.0, -100.0, -28.0, 21.0, 31.0, -30.0, -74.0, -168.0, -148.0, 20.0, 163.0, -36.0, -61.0, -104.0, -96.0, 30.0, 60.0, 200.0, 186.0, -78.0, -105.0, -140.0, -82.0, -7.0, -5.0, 96.0, -13.0, -32.0, 100.0, -126.0, -106.0, 58.0, 110.0, -31.0, -143.0, -135.0, -144.0, -49.0, -65.0, 31.0, -58.0, -20.0, -82.0, 14.0, 54.0, -122.0, -123.0, -114.0, -154.0, -17.0, -132.0, -80.0, -52.0, 15.0, 73.0, -136.0, -11.0, -174.0, -170.0, -46.0, -64.0, -192.0, -39.0, -125.0, -63.0, -150.0, -158.0, 18.0, -29.0, -126.0, -142.0, -39.0, -40.0, 94.0, 55.0, -189.0, -100.0, -44.0, -51.0, -150.0, -69.0, -165.0, -134.0, -158.0, -122.0, -35.0, -55.0, -134.0, -68.0, -121.0, -107.0, -14.0, -18.0, -2.0, -186.0, -16.0, 9.0, -35.0, -160.0, 38.0, -148.0, -23.0, -113.0, -148.0, -167.0, -122.0, 38.0, -149.0, -126.0, -94.0, -50.0, -101.0, -137.0, -143.0, -84.0, -72.0, -14.0, -143.0, 0.0, -113.0, -196.0, -128.0, -119.0, -192.0, -169.0, -162.0, -37.0, 26.0, -44.0, 0.0, 0.0, 4.0, -21.0, -135.0, -58.0, -78.0, 20.0, -134.0, -151.0, 43.0, -77.0, -115.0, -110.0, -78.0, -126.0, -158.0, -162.0], "policy_predator_policy_reward": [8.0, 15.0, 32.0, 0.0, 50.0, 24.0, 6.0, 37.0, 16.0, 33.0, 13.0, 38.0, 80.0, 2.0, 0.0, 67.0, 110.0, 46.0, 75.0, 98.0, 48.0, 84.0, 13.0, 158.0, 57.0, 101.0, 89.0, 102.0, 6.0, 35.0, 45.0, 0.0, 70.0, 58.0, 55.0, 27.0, 36.0, 11.0, 109.0, 43.0, 108.0, 11.0, 166.0, 0.0, 25.0, 15.0, 36.0, 22.0, 111.0, 0.0, 0.0, 46.0, 49.0, 107.0, 145.0, 20.0, 81.0, 62.0, 91.0, 140.0, 157.0, 159.0, 13.0, 54.0, 154.0, 6.0, 180.0, 11.0, 0.0, 104.0, 6.0, 0.0, 88.0, 128.0, 172.0, 133.0, 72.0, 40.0, 62.0, 0.0, 54.0, 102.0, 130.0, 144.0, 65.0, 21.0, 168.0, 55.0, 178.0, 64.0, 120.0, 76.0, 118.0, 32.0, 131.0, 77.0, 0.0, 95.0, 135.0, 127.0, 129.0, 138.0, 140.0, 140.0, 152.0, 102.0, 93.0, 22.0, 119.0, 144.0, 30.0, 176.0, 92.0, 113.0, 191.0, 68.0, 79.0, 129.0, 115.0, 176.0, 110.0, 20.0, 125.0, 126.0, 120.0, 77.0, 23.0, 64.0, 187.0, 40.0, 88.0, 78.0, 119.0, 161.0, 123.0, 198.0, 119.0, 167.0, 105.0, 54.0, 156.0, 158.0, 87.0, 119.0, 54.0, 139.0, 163.0, 92.0, 0.0, 103.0, 155.0, 98.0, 177.0, 0.0, 62.0, 135.0, 168.0, 140.0, 152.0, 125.0, 122.0, 169.0, 139.0, 119.0, 169.0, 174.0, 90.0, 178.0, 88.0, 107.0, 140.0, 104.0, 173.0, 160.0, 185.0, 73.0, 94.0, 183.0, 160.0, 150.0, 104.0, 52.0, 0.0, 0.0, 65.0, 100.0, 138.0, 153.0, 74.0, 133.0, 166.0, 170.0, 30.0, 163.0, 102.0, 149.0, 108.0, 171.0, 159.0, 136.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5763684668707912, "mean_inference_ms": 1.3240028583101497, "mean_action_processing_ms": 0.22840500200622074, "mean_env_wait_ms": 0.171740945224904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003411412239074707, "StateBufferConnector_ms": 0.003183722496032715, "ViewRequirementAgentConnector_ms": 0.10403263568878174}, "num_episodes": 18, "episode_return_max": 392.0, "episode_return_min": -138.0, "episode_return_mean": 114.35, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.63164283880417, "num_env_steps_trained_throughput_per_sec": 88.63164283880417, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 45078.813, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45078.765, "sample_time_ms": 1079.757, "learn_time_ms": 43981.911, "learn_throughput": 90.946, "synch_weights_time_ms": 13.461}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 43, "trial_id": "51025_00000", "date": "2024-08-12_20-56-50", "timestamp": 1723510610, "time_this_iter_s": 45.18652582168579, "time_total_s": 1963.6187660694122, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x15800ddc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1963.6187660694122, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 20.63125, "ram_util_percent": 82.68125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.9489727628294125, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.109694264931653, "policy_loss": -0.013371665921880218, "vf_loss": 9.120318345165757, "vf_explained_var": -0.5908084268292422, "kl": 0.009158665983901988, "entropy": 0.9264549478336617, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.784096891854807, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.123424799984726, "policy_loss": -0.013905951385657308, "vf_loss": 9.1354485259485, "vf_explained_var": 0.09795361889733209, "kl": 0.009411128009726145, "entropy": 1.0741130284846776, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 392.0, "episode_reward_min": -138.0, "episode_reward_mean": 94.34, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -196.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": -55.48, "predator_policy": 102.65}, "custom_metrics": {}, "hist_stats": {"episode_reward": [368.0, 228.0, 155.0, -76.0, 184.0, 319.0, 81.0, 145.0, 151.0, 37.0, 195.0, 127.0, 0.0, 250.0, 63.0, -9.0, 194.0, 392.0, 33.0, 83.0, 100.0, 145.0, 224.0, 42.0, 254.0, 49.0, -37.0, 82.0, 123.0, 106.0, 163.0, 17.0, -1.0, 131.0, 122.0, 203.0, 116.0, -138.0, 95.0, 28.0, 20.0, -17.0, 119.0, -17.0, 118.0, 236.0, -62.0, 71.0, 61.0, 22.0, 6.0, 69.0, 112.0, -22.0, 161.0, 67.0, 96.0, 58.0, 67.0, 61.0, -7.0, 193.0, 16.0, 114.0, 105.0, 41.0, 109.0, 101.0, 24.0, 11.0, -84.0, 111.0, 138.0, 0.0, 148.0, 98.0, 149.0, 51.0, 159.0, 26.0, 75.0, -25.0, 204.0, 98.0, 17.0, 201.0, 194.0, 91.0, 85.0, 72.0, 40.0, 17.0, 280.0, 67.0, 195.0, 29.0, 8.0, 109.0, 119.0, 85.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [133.0, 188.0, 0.0, 76.0, 0.0, 36.0, -133.0, -109.0, 174.0, -30.0, 95.0, 166.0, -42.0, 12.0, 0.0, 99.0, 27.0, -32.0, -100.0, -28.0, 21.0, 31.0, -30.0, -74.0, -168.0, -148.0, 20.0, 163.0, -36.0, -61.0, -104.0, -96.0, 30.0, 60.0, 200.0, 186.0, -78.0, -105.0, -140.0, -82.0, -7.0, -5.0, 96.0, -13.0, -32.0, 100.0, -126.0, -106.0, 58.0, 110.0, -31.0, -143.0, -135.0, -144.0, -49.0, -65.0, 31.0, -58.0, -20.0, -82.0, 14.0, 54.0, -122.0, -123.0, -114.0, -154.0, -17.0, -132.0, -80.0, -52.0, 15.0, 73.0, -136.0, -11.0, -174.0, -170.0, -46.0, -64.0, -192.0, -39.0, -125.0, -63.0, -150.0, -158.0, 18.0, -29.0, -126.0, -142.0, -39.0, -40.0, 94.0, 55.0, -189.0, -100.0, -44.0, -51.0, -150.0, -69.0, -165.0, -134.0, -158.0, -122.0, -35.0, -55.0, -134.0, -68.0, -121.0, -107.0, -14.0, -18.0, -2.0, -186.0, -16.0, 9.0, -35.0, -160.0, 38.0, -148.0, -23.0, -113.0, -148.0, -167.0, -122.0, 38.0, -149.0, -126.0, -94.0, -50.0, -101.0, -137.0, -143.0, -84.0, -72.0, -14.0, -143.0, 0.0, -113.0, -196.0, -128.0, -119.0, -192.0, -169.0, -162.0, -37.0, 26.0, -44.0, 0.0, 0.0, 4.0, -21.0, -135.0, -58.0, -78.0, 20.0, -134.0, -151.0, 43.0, -77.0, -115.0, -110.0, -78.0, -126.0, -158.0, -162.0, 57.0, 46.0, -132.0, -21.0, -167.0, -81.0, 74.0, 56.0, -86.0, 49.0, -138.0, 19.0, -71.0, -72.0, -62.0, -82.0, -72.0, -130.0, -145.0, -182.0, 72.0, 135.0, -104.0, -95.0, 26.0, -99.0, -155.0, -129.0, -65.0, -78.0, 0.0, -106.0, -154.0, -43.0, -68.0, -66.0], "policy_predator_policy_reward": [36.0, 11.0, 109.0, 43.0, 108.0, 11.0, 166.0, 0.0, 25.0, 15.0, 36.0, 22.0, 111.0, 0.0, 0.0, 46.0, 49.0, 107.0, 145.0, 20.0, 81.0, 62.0, 91.0, 140.0, 157.0, 159.0, 13.0, 54.0, 154.0, 6.0, 180.0, 11.0, 0.0, 104.0, 6.0, 0.0, 88.0, 128.0, 172.0, 133.0, 72.0, 40.0, 62.0, 0.0, 54.0, 102.0, 130.0, 144.0, 65.0, 21.0, 168.0, 55.0, 178.0, 64.0, 120.0, 76.0, 118.0, 32.0, 131.0, 77.0, 0.0, 95.0, 135.0, 127.0, 129.0, 138.0, 140.0, 140.0, 152.0, 102.0, 93.0, 22.0, 119.0, 144.0, 30.0, 176.0, 92.0, 113.0, 191.0, 68.0, 79.0, 129.0, 115.0, 176.0, 110.0, 20.0, 125.0, 126.0, 120.0, 77.0, 23.0, 64.0, 187.0, 40.0, 88.0, 78.0, 119.0, 161.0, 123.0, 198.0, 119.0, 167.0, 105.0, 54.0, 156.0, 158.0, 87.0, 119.0, 54.0, 139.0, 163.0, 92.0, 0.0, 103.0, 155.0, 98.0, 177.0, 0.0, 62.0, 135.0, 168.0, 140.0, 152.0, 125.0, 122.0, 169.0, 139.0, 119.0, 169.0, 174.0, 90.0, 178.0, 88.0, 107.0, 140.0, 104.0, 173.0, 160.0, 185.0, 73.0, 94.0, 183.0, 160.0, 150.0, 104.0, 52.0, 0.0, 0.0, 65.0, 100.0, 138.0, 153.0, 74.0, 133.0, 166.0, 170.0, 30.0, 163.0, 102.0, 149.0, 108.0, 171.0, 159.0, 136.0, 101.0, 0.0, 124.0, 127.0, 173.0, 92.0, 0.0, 71.0, 123.0, 108.0, 54.0, 156.0, 168.0, 60.0, 135.0, 81.0, 185.0, 57.0, 173.0, 171.0, 63.0, 10.0, 99.0, 167.0, 125.0, 143.0, 166.0, 147.0, 97.0, 54.0, 108.0, 107.0, 126.0, 190.0, 52.0, 167.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5769162835970509, "mean_inference_ms": 1.3233494252949074, "mean_action_processing_ms": 0.22841914371160474, "mean_env_wait_ms": 0.17169195462451525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033991336822509766, "StateBufferConnector_ms": 0.0031853914260864258, "ViewRequirementAgentConnector_ms": 0.10398411750793457}, "num_episodes": 18, "episode_return_max": 392.0, "episode_return_min": -138.0, "episode_return_mean": 94.34, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.97702552832392, "num_env_steps_trained_throughput_per_sec": 88.97702552832392, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 45080.127, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45080.077, "sample_time_ms": 1079.045, "learn_time_ms": 43983.475, "learn_throughput": 90.943, "synch_weights_time_ms": 13.558}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 44, "trial_id": "51025_00000", "date": "2024-08-12_20-57-35", "timestamp": 1723510655, "time_this_iter_s": 45.08849787712097, "time_total_s": 2008.7072639465332, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158052160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2008.7072639465332, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 21.0625, "ram_util_percent": 82.87187499999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.957742583089405, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.764402592623675, "policy_loss": -0.009277279501800578, "vf_loss": 8.771964031300216, "vf_explained_var": -0.6223769485004365, "kl": 0.005719468216412924, "entropy": 0.9190881029954032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.910735580277821, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.260668942284962, "policy_loss": -0.010109643367606969, "vf_loss": 9.26952187926681, "vf_explained_var": 0.06187071961069864, "kl": 0.006283621339275789, "entropy": 1.0797123807763296, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 280.0, "episode_reward_min": -138.0, "episode_reward_mean": 85.47, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -196.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 135.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": -71.8, "predator_policy": 114.535}, "custom_metrics": {}, "hist_stats": {"episode_reward": [224.0, 42.0, 254.0, 49.0, -37.0, 82.0, 123.0, 106.0, 163.0, 17.0, -1.0, 131.0, 122.0, 203.0, 116.0, -138.0, 95.0, 28.0, 20.0, -17.0, 119.0, -17.0, 118.0, 236.0, -62.0, 71.0, 61.0, 22.0, 6.0, 69.0, 112.0, -22.0, 161.0, 67.0, 96.0, 58.0, 67.0, 61.0, -7.0, 193.0, 16.0, 114.0, 105.0, 41.0, 109.0, 101.0, 24.0, 11.0, -84.0, 111.0, 138.0, 0.0, 148.0, 98.0, 149.0, 51.0, 159.0, 26.0, 75.0, -25.0, 204.0, 98.0, 17.0, 201.0, 194.0, 91.0, 85.0, 72.0, 40.0, 17.0, 280.0, 67.0, 195.0, 29.0, 8.0, 109.0, 119.0, 85.0, 200.0, 70.0, 108.0, 59.0, 11.0, 110.0, 211.0, 172.0, 64.0, 61.0, 58.0, 242.0, 133.0, 183.0, -2.0, 58.0, 123.0, 32.0, 122.0, 93.0, 122.0, 48.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-32.0, 100.0, -126.0, -106.0, 58.0, 110.0, -31.0, -143.0, -135.0, -144.0, -49.0, -65.0, 31.0, -58.0, -20.0, -82.0, 14.0, 54.0, -122.0, -123.0, -114.0, -154.0, -17.0, -132.0, -80.0, -52.0, 15.0, 73.0, -136.0, -11.0, -174.0, -170.0, -46.0, -64.0, -192.0, -39.0, -125.0, -63.0, -150.0, -158.0, 18.0, -29.0, -126.0, -142.0, -39.0, -40.0, 94.0, 55.0, -189.0, -100.0, -44.0, -51.0, -150.0, -69.0, -165.0, -134.0, -158.0, -122.0, -35.0, -55.0, -134.0, -68.0, -121.0, -107.0, -14.0, -18.0, -2.0, -186.0, -16.0, 9.0, -35.0, -160.0, 38.0, -148.0, -23.0, -113.0, -148.0, -167.0, -122.0, 38.0, -149.0, -126.0, -94.0, -50.0, -101.0, -137.0, -143.0, -84.0, -72.0, -14.0, -143.0, 0.0, -113.0, -196.0, -128.0, -119.0, -192.0, -169.0, -162.0, -37.0, 26.0, -44.0, 0.0, 0.0, 4.0, -21.0, -135.0, -58.0, -78.0, 20.0, -134.0, -151.0, 43.0, -77.0, -115.0, -110.0, -78.0, -126.0, -158.0, -162.0, 57.0, 46.0, -132.0, -21.0, -167.0, -81.0, 74.0, 56.0, -86.0, 49.0, -138.0, 19.0, -71.0, -72.0, -62.0, -82.0, -72.0, -130.0, -145.0, -182.0, 72.0, 135.0, -104.0, -95.0, 26.0, -99.0, -155.0, -129.0, -65.0, -78.0, 0.0, -106.0, -154.0, -43.0, -68.0, -66.0, 7.0, 39.0, -129.0, -54.0, -76.0, 0.0, -71.0, -148.0, -132.0, -127.0, -98.0, -70.0, -32.0, 90.0, -56.0, 2.0, -105.0, -62.0, -122.0, -141.0, -121.0, -183.0, 74.0, 77.0, -35.0, 30.0, -24.0, -20.0, -102.0, -150.0, -78.0, -140.0, -146.0, 0.0, -82.0, -173.0, 26.0, -146.0, -157.0, -27.0, -104.0, -71.0, -136.0, -99.0], "policy_predator_policy_reward": [54.0, 102.0, 130.0, 144.0, 65.0, 21.0, 168.0, 55.0, 178.0, 64.0, 120.0, 76.0, 118.0, 32.0, 131.0, 77.0, 0.0, 95.0, 135.0, 127.0, 129.0, 138.0, 140.0, 140.0, 152.0, 102.0, 93.0, 22.0, 119.0, 144.0, 30.0, 176.0, 92.0, 113.0, 191.0, 68.0, 79.0, 129.0, 115.0, 176.0, 110.0, 20.0, 125.0, 126.0, 120.0, 77.0, 23.0, 64.0, 187.0, 40.0, 88.0, 78.0, 119.0, 161.0, 123.0, 198.0, 119.0, 167.0, 105.0, 54.0, 156.0, 158.0, 87.0, 119.0, 54.0, 139.0, 163.0, 92.0, 0.0, 103.0, 155.0, 98.0, 177.0, 0.0, 62.0, 135.0, 168.0, 140.0, 152.0, 125.0, 122.0, 169.0, 139.0, 119.0, 169.0, 174.0, 90.0, 178.0, 88.0, 107.0, 140.0, 104.0, 173.0, 160.0, 185.0, 73.0, 94.0, 183.0, 160.0, 150.0, 104.0, 52.0, 0.0, 0.0, 65.0, 100.0, 138.0, 153.0, 74.0, 133.0, 166.0, 170.0, 30.0, 163.0, 102.0, 149.0, 108.0, 171.0, 159.0, 136.0, 101.0, 0.0, 124.0, 127.0, 173.0, 92.0, 0.0, 71.0, 123.0, 108.0, 54.0, 156.0, 168.0, 60.0, 135.0, 81.0, 185.0, 57.0, 173.0, 171.0, 63.0, 10.0, 99.0, 167.0, 125.0, 143.0, 166.0, 147.0, 97.0, 54.0, 108.0, 107.0, 126.0, 190.0, 52.0, 167.0, 94.0, 60.0, 87.0, 166.0, 66.0, 118.0, 121.0, 157.0, 138.0, 132.0, 110.0, 168.0, 110.0, 43.0, 94.0, 132.0, 134.0, 97.0, 160.0, 164.0, 171.0, 191.0, 24.0, 67.0, 87.0, 51.0, 83.0, 144.0, 153.0, 97.0, 122.0, 154.0, 104.0, 165.0, 149.0, 138.0, 148.0, 94.0, 153.0, 124.0, 149.0, 148.0, 132.0, 151.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5777255155997529, "mean_inference_ms": 1.3232458826108442, "mean_action_processing_ms": 0.22854062891763335, "mean_env_wait_ms": 0.1717261961344962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034558773040771484, "StateBufferConnector_ms": 0.0031790733337402344, "ViewRequirementAgentConnector_ms": 0.10458922386169434}, "num_episodes": 22, "episode_return_max": 280.0, "episode_return_min": -138.0, "episode_return_mean": 85.47, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 87.63473601899601, "num_env_steps_trained_throughput_per_sec": 87.63473601899601, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 45156.828, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45156.777, "sample_time_ms": 1085.611, "learn_time_ms": 44053.562, "learn_throughput": 90.799, "synch_weights_time_ms": 13.517}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 45, "trial_id": "51025_00000", "date": "2024-08-12_20-58-21", "timestamp": 1723510701, "time_this_iter_s": 45.676066160202026, "time_total_s": 2054.3833301067352, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158076c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2054.3833301067352, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 27.14, "ram_util_percent": 83.15076923076921}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.266019667960979, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.025832346507482, "policy_loss": -0.01164010265132501, "vf_loss": 9.035498695020323, "vf_explained_var": -0.6576233740836855, "kl": 0.006579130920149075, "entropy": 0.8505100841560062, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.587104901939473, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.104352915728533, "policy_loss": -0.012095745773517857, "vf_loss": 9.11467856048907, "vf_explained_var": 0.09270763614821055, "kl": 0.008850389492356002, "entropy": 1.1149351508529097, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 280.0, "episode_reward_min": -89.0, "episode_reward_mean": 86.64, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -196.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 135.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": -77.215, "predator_policy": 120.535}, "custom_metrics": {}, "hist_stats": {"episode_reward": [236.0, -62.0, 71.0, 61.0, 22.0, 6.0, 69.0, 112.0, -22.0, 161.0, 67.0, 96.0, 58.0, 67.0, 61.0, -7.0, 193.0, 16.0, 114.0, 105.0, 41.0, 109.0, 101.0, 24.0, 11.0, -84.0, 111.0, 138.0, 0.0, 148.0, 98.0, 149.0, 51.0, 159.0, 26.0, 75.0, -25.0, 204.0, 98.0, 17.0, 201.0, 194.0, 91.0, 85.0, 72.0, 40.0, 17.0, 280.0, 67.0, 195.0, 29.0, 8.0, 109.0, 119.0, 85.0, 200.0, 70.0, 108.0, 59.0, 11.0, 110.0, 211.0, 172.0, 64.0, 61.0, 58.0, 242.0, 133.0, 183.0, -2.0, 58.0, 123.0, 32.0, 122.0, 93.0, 122.0, 48.0, 85.0, -89.0, 121.0, 101.0, 172.0, 31.0, 57.0, 27.0, 89.0, -22.0, 70.0, 122.0, 147.0, 59.0, 113.0, 140.0, 94.0, 166.0, 107.0, 49.0, 102.0, 130.0, 48.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [94.0, 55.0, -189.0, -100.0, -44.0, -51.0, -150.0, -69.0, -165.0, -134.0, -158.0, -122.0, -35.0, -55.0, -134.0, -68.0, -121.0, -107.0, -14.0, -18.0, -2.0, -186.0, -16.0, 9.0, -35.0, -160.0, 38.0, -148.0, -23.0, -113.0, -148.0, -167.0, -122.0, 38.0, -149.0, -126.0, -94.0, -50.0, -101.0, -137.0, -143.0, -84.0, -72.0, -14.0, -143.0, 0.0, -113.0, -196.0, -128.0, -119.0, -192.0, -169.0, -162.0, -37.0, 26.0, -44.0, 0.0, 0.0, 4.0, -21.0, -135.0, -58.0, -78.0, 20.0, -134.0, -151.0, 43.0, -77.0, -115.0, -110.0, -78.0, -126.0, -158.0, -162.0, 57.0, 46.0, -132.0, -21.0, -167.0, -81.0, 74.0, 56.0, -86.0, 49.0, -138.0, 19.0, -71.0, -72.0, -62.0, -82.0, -72.0, -130.0, -145.0, -182.0, 72.0, 135.0, -104.0, -95.0, 26.0, -99.0, -155.0, -129.0, -65.0, -78.0, 0.0, -106.0, -154.0, -43.0, -68.0, -66.0, 7.0, 39.0, -129.0, -54.0, -76.0, 0.0, -71.0, -148.0, -132.0, -127.0, -98.0, -70.0, -32.0, 90.0, -56.0, 2.0, -105.0, -62.0, -122.0, -141.0, -121.0, -183.0, 74.0, 77.0, -35.0, 30.0, -24.0, -20.0, -102.0, -150.0, -78.0, -140.0, -146.0, 0.0, -82.0, -173.0, 26.0, -146.0, -157.0, -27.0, -104.0, -71.0, -136.0, -99.0, -161.0, -72.0, -148.0, -149.0, -70.0, -71.0, -1.0, 0.0, -98.0, -67.0, -102.0, -94.0, -95.0, -191.0, -192.0, -129.0, -160.0, 0.0, -151.0, -58.0, -72.0, -93.0, -186.0, -14.0, -102.0, -8.0, -92.0, -169.0, -138.0, -95.0, -130.0, -52.0, -13.0, -112.0, -116.0, -1.0, -104.0, -13.0, -108.0, -121.0, -66.0, -13.0, -30.0, -41.0, -85.0, -116.0], "policy_predator_policy_reward": [23.0, 64.0, 187.0, 40.0, 88.0, 78.0, 119.0, 161.0, 123.0, 198.0, 119.0, 167.0, 105.0, 54.0, 156.0, 158.0, 87.0, 119.0, 54.0, 139.0, 163.0, 92.0, 0.0, 103.0, 155.0, 98.0, 177.0, 0.0, 62.0, 135.0, 168.0, 140.0, 152.0, 125.0, 122.0, 169.0, 139.0, 119.0, 169.0, 174.0, 90.0, 178.0, 88.0, 107.0, 140.0, 104.0, 173.0, 160.0, 185.0, 73.0, 94.0, 183.0, 160.0, 150.0, 104.0, 52.0, 0.0, 0.0, 65.0, 100.0, 138.0, 153.0, 74.0, 133.0, 166.0, 170.0, 30.0, 163.0, 102.0, 149.0, 108.0, 171.0, 159.0, 136.0, 101.0, 0.0, 124.0, 127.0, 173.0, 92.0, 0.0, 71.0, 123.0, 108.0, 54.0, 156.0, 168.0, 60.0, 135.0, 81.0, 185.0, 57.0, 173.0, 171.0, 63.0, 10.0, 99.0, 167.0, 125.0, 143.0, 166.0, 147.0, 97.0, 54.0, 108.0, 107.0, 126.0, 190.0, 52.0, 167.0, 94.0, 60.0, 87.0, 166.0, 66.0, 118.0, 121.0, 157.0, 138.0, 132.0, 110.0, 168.0, 110.0, 43.0, 94.0, 132.0, 134.0, 97.0, 160.0, 164.0, 171.0, 191.0, 24.0, 67.0, 87.0, 51.0, 83.0, 144.0, 153.0, 97.0, 122.0, 154.0, 104.0, 165.0, 149.0, 138.0, 148.0, 94.0, 153.0, 124.0, 149.0, 148.0, 132.0, 151.0, 138.0, 180.0, 34.0, 174.0, 131.0, 131.0, 19.0, 83.0, 167.0, 170.0, 88.0, 139.0, 158.0, 185.0, 176.0, 172.0, 74.0, 175.0, 12.0, 175.0, 150.0, 85.0, 128.0, 194.0, 139.0, 118.0, 169.0, 151.0, 187.0, 159.0, 164.0, 158.0, 118.0, 101.0, 141.0, 142.0, 121.0, 103.0, 149.0, 129.0, 60.0, 121.0, 123.0, 78.0, 124.0, 125.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5774868026266444, "mean_inference_ms": 1.321353426386215, "mean_action_processing_ms": 0.2284839302317361, "mean_env_wait_ms": 0.17160010026564887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003735184669494629, "StateBufferConnector_ms": 0.0029276609420776367, "ViewRequirementAgentConnector_ms": 0.08706486225128174}, "num_episodes": 23, "episode_return_max": 280.0, "episode_return_min": -89.0, "episode_return_mean": 86.64, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 87.04780468257823, "num_env_steps_trained_throughput_per_sec": 87.04780468257823, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 45272.302, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45272.251, "sample_time_ms": 1089.495, "learn_time_ms": 44165.158, "learn_throughput": 90.569, "synch_weights_time_ms": 13.704}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 46, "trial_id": "51025_00000", "date": "2024-08-12_20-59-07", "timestamp": 1723510747, "time_this_iter_s": 45.99330925941467, "time_total_s": 2100.37663936615, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158052670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2100.37663936615, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 23.38307692307692, "ram_util_percent": 82.9246153846154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.9437915545292, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.365155030306054, "policy_loss": -0.011572821208438467, "vf_loss": 8.374587964002417, "vf_explained_var": -0.15926291989901709, "kl": 0.007133040887531121, "entropy": 0.8748014890012287, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.541813414185135, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.054831164728396, "policy_loss": -0.011842148236082817, "vf_loss": 9.065071246737526, "vf_explained_var": 0.037688619592202405, "kl": 0.008010238533208407, "entropy": 1.111433644521804, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 280.0, "episode_reward_min": -89.0, "episode_reward_mean": 94.95, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -196.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 135.0, "predator_policy": 194.0}, "policy_reward_mean": {"prey_policy": -74.105, "predator_policy": 121.58}, "custom_metrics": {}, "hist_stats": {"episode_reward": [114.0, 105.0, 41.0, 109.0, 101.0, 24.0, 11.0, -84.0, 111.0, 138.0, 0.0, 148.0, 98.0, 149.0, 51.0, 159.0, 26.0, 75.0, -25.0, 204.0, 98.0, 17.0, 201.0, 194.0, 91.0, 85.0, 72.0, 40.0, 17.0, 280.0, 67.0, 195.0, 29.0, 8.0, 109.0, 119.0, 85.0, 200.0, 70.0, 108.0, 59.0, 11.0, 110.0, 211.0, 172.0, 64.0, 61.0, 58.0, 242.0, 133.0, 183.0, -2.0, 58.0, 123.0, 32.0, 122.0, 93.0, 122.0, 48.0, 85.0, -89.0, 121.0, 101.0, 172.0, 31.0, 57.0, 27.0, 89.0, -22.0, 70.0, 122.0, 147.0, 59.0, 113.0, 140.0, 94.0, 166.0, 107.0, 49.0, 102.0, 130.0, 48.0, 19.0, 111.0, 127.0, 66.0, 45.0, 59.0, 133.0, 117.0, 145.0, 241.0, 156.0, -43.0, 234.0, 158.0, 137.0, 184.0, 138.0, 9.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-94.0, -50.0, -101.0, -137.0, -143.0, -84.0, -72.0, -14.0, -143.0, 0.0, -113.0, -196.0, -128.0, -119.0, -192.0, -169.0, -162.0, -37.0, 26.0, -44.0, 0.0, 0.0, 4.0, -21.0, -135.0, -58.0, -78.0, 20.0, -134.0, -151.0, 43.0, -77.0, -115.0, -110.0, -78.0, -126.0, -158.0, -162.0, 57.0, 46.0, -132.0, -21.0, -167.0, -81.0, 74.0, 56.0, -86.0, 49.0, -138.0, 19.0, -71.0, -72.0, -62.0, -82.0, -72.0, -130.0, -145.0, -182.0, 72.0, 135.0, -104.0, -95.0, 26.0, -99.0, -155.0, -129.0, -65.0, -78.0, 0.0, -106.0, -154.0, -43.0, -68.0, -66.0, 7.0, 39.0, -129.0, -54.0, -76.0, 0.0, -71.0, -148.0, -132.0, -127.0, -98.0, -70.0, -32.0, 90.0, -56.0, 2.0, -105.0, -62.0, -122.0, -141.0, -121.0, -183.0, 74.0, 77.0, -35.0, 30.0, -24.0, -20.0, -102.0, -150.0, -78.0, -140.0, -146.0, 0.0, -82.0, -173.0, 26.0, -146.0, -157.0, -27.0, -104.0, -71.0, -136.0, -99.0, -161.0, -72.0, -148.0, -149.0, -70.0, -71.0, -1.0, 0.0, -98.0, -67.0, -102.0, -94.0, -95.0, -191.0, -192.0, -129.0, -160.0, 0.0, -151.0, -58.0, -72.0, -93.0, -186.0, -14.0, -102.0, -8.0, -92.0, -169.0, -138.0, -95.0, -130.0, -52.0, -13.0, -112.0, -116.0, -1.0, -104.0, -13.0, -108.0, -121.0, -66.0, -13.0, -30.0, -41.0, -85.0, -116.0, -131.0, -159.0, -86.0, -118.0, -121.0, -2.0, -60.0, -119.0, -71.0, -77.0, -72.0, -98.0, -30.0, -78.0, -24.0, -112.0, -1.0, 64.0, -138.0, 84.0, 7.0, -19.0, -179.0, -181.0, -64.0, 57.0, -57.0, -45.0, 38.0, 0.0, -7.0, 0.0, -112.0, -44.0, -170.0, -148.0], "policy_predator_policy_reward": [139.0, 119.0, 169.0, 174.0, 90.0, 178.0, 88.0, 107.0, 140.0, 104.0, 173.0, 160.0, 185.0, 73.0, 94.0, 183.0, 160.0, 150.0, 104.0, 52.0, 0.0, 0.0, 65.0, 100.0, 138.0, 153.0, 74.0, 133.0, 166.0, 170.0, 30.0, 163.0, 102.0, 149.0, 108.0, 171.0, 159.0, 136.0, 101.0, 0.0, 124.0, 127.0, 173.0, 92.0, 0.0, 71.0, 123.0, 108.0, 54.0, 156.0, 168.0, 60.0, 135.0, 81.0, 185.0, 57.0, 173.0, 171.0, 63.0, 10.0, 99.0, 167.0, 125.0, 143.0, 166.0, 147.0, 97.0, 54.0, 108.0, 107.0, 126.0, 190.0, 52.0, 167.0, 94.0, 60.0, 87.0, 166.0, 66.0, 118.0, 121.0, 157.0, 138.0, 132.0, 110.0, 168.0, 110.0, 43.0, 94.0, 132.0, 134.0, 97.0, 160.0, 164.0, 171.0, 191.0, 24.0, 67.0, 87.0, 51.0, 83.0, 144.0, 153.0, 97.0, 122.0, 154.0, 104.0, 165.0, 149.0, 138.0, 148.0, 94.0, 153.0, 124.0, 149.0, 148.0, 132.0, 151.0, 138.0, 180.0, 34.0, 174.0, 131.0, 131.0, 19.0, 83.0, 167.0, 170.0, 88.0, 139.0, 158.0, 185.0, 176.0, 172.0, 74.0, 175.0, 12.0, 175.0, 150.0, 85.0, 128.0, 194.0, 139.0, 118.0, 169.0, 151.0, 187.0, 159.0, 164.0, 158.0, 118.0, 101.0, 141.0, 142.0, 121.0, 103.0, 149.0, 129.0, 60.0, 121.0, 123.0, 78.0, 124.0, 125.0, 163.0, 146.0, 151.0, 164.0, 126.0, 124.0, 103.0, 142.0, 96.0, 97.0, 121.0, 108.0, 116.0, 125.0, 133.0, 120.0, 60.0, 22.0, 155.0, 140.0, 104.0, 64.0, 149.0, 168.0, 120.0, 121.0, 137.0, 123.0, 36.0, 63.0, 92.0, 99.0, 149.0, 145.0, 145.0, 182.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5772271109794016, "mean_inference_ms": 1.319825849299025, "mean_action_processing_ms": 0.22843899820285354, "mean_env_wait_ms": 0.17152598086775175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004263401031494141, "StateBufferConnector_ms": 0.0029331445693969727, "ViewRequirementAgentConnector_ms": 0.0957801342010498}, "num_episodes": 18, "episode_return_max": 280.0, "episode_return_min": -89.0, "episode_return_mean": 94.95, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 86.68426900779622, "num_env_steps_trained_throughput_per_sec": 86.68426900779622, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 45367.181, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45367.131, "sample_time_ms": 1089.404, "learn_time_ms": 44260.668, "learn_throughput": 90.374, "synch_weights_time_ms": 13.474}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 47, "trial_id": "51025_00000", "date": "2024-08-12_20-59-53", "timestamp": 1723510793, "time_this_iter_s": 46.17714500427246, "time_total_s": 2146.5537843704224, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cb33e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2146.5537843704224, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 27.321538461538463, "ram_util_percent": 82.53538461538461}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.843819888054378, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.177368793285712, "policy_loss": -0.010082233799917122, "vf_loss": 8.185306742582371, "vf_explained_var": 0.1807138807874508, "kl": 0.007147620475086325, "entropy": 0.8517400402556021, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.843661778881437, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.185463765058568, "policy_loss": -0.007789962191292375, "vf_loss": 9.191955433699189, "vf_explained_var": 0.008070489937666231, "kl": 0.006491533061256203, "entropy": 1.0838133584254632, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 297.0, "episode_reward_min": -89.0, "episode_reward_mean": 99.62, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -193.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 192.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": -70.505, "predator_policy": 120.315}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25.0, 204.0, 98.0, 17.0, 201.0, 194.0, 91.0, 85.0, 72.0, 40.0, 17.0, 280.0, 67.0, 195.0, 29.0, 8.0, 109.0, 119.0, 85.0, 200.0, 70.0, 108.0, 59.0, 11.0, 110.0, 211.0, 172.0, 64.0, 61.0, 58.0, 242.0, 133.0, 183.0, -2.0, 58.0, 123.0, 32.0, 122.0, 93.0, 122.0, 48.0, 85.0, -89.0, 121.0, 101.0, 172.0, 31.0, 57.0, 27.0, 89.0, -22.0, 70.0, 122.0, 147.0, 59.0, 113.0, 140.0, 94.0, 166.0, 107.0, 49.0, 102.0, 130.0, 48.0, 19.0, 111.0, 127.0, 66.0, 45.0, 59.0, 133.0, 117.0, 145.0, 241.0, 156.0, -43.0, 234.0, 158.0, 137.0, 184.0, 138.0, 9.0, 65.0, 22.0, 35.0, 42.0, 89.0, 180.0, 214.0, 115.0, 93.0, 13.0, 104.0, 206.0, 32.0, 123.0, 57.0, 297.0, 30.0, 126.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-158.0, -162.0, 57.0, 46.0, -132.0, -21.0, -167.0, -81.0, 74.0, 56.0, -86.0, 49.0, -138.0, 19.0, -71.0, -72.0, -62.0, -82.0, -72.0, -130.0, -145.0, -182.0, 72.0, 135.0, -104.0, -95.0, 26.0, -99.0, -155.0, -129.0, -65.0, -78.0, 0.0, -106.0, -154.0, -43.0, -68.0, -66.0, 7.0, 39.0, -129.0, -54.0, -76.0, 0.0, -71.0, -148.0, -132.0, -127.0, -98.0, -70.0, -32.0, 90.0, -56.0, 2.0, -105.0, -62.0, -122.0, -141.0, -121.0, -183.0, 74.0, 77.0, -35.0, 30.0, -24.0, -20.0, -102.0, -150.0, -78.0, -140.0, -146.0, 0.0, -82.0, -173.0, 26.0, -146.0, -157.0, -27.0, -104.0, -71.0, -136.0, -99.0, -161.0, -72.0, -148.0, -149.0, -70.0, -71.0, -1.0, 0.0, -98.0, -67.0, -102.0, -94.0, -95.0, -191.0, -192.0, -129.0, -160.0, 0.0, -151.0, -58.0, -72.0, -93.0, -186.0, -14.0, -102.0, -8.0, -92.0, -169.0, -138.0, -95.0, -130.0, -52.0, -13.0, -112.0, -116.0, -1.0, -104.0, -13.0, -108.0, -121.0, -66.0, -13.0, -30.0, -41.0, -85.0, -116.0, -131.0, -159.0, -86.0, -118.0, -121.0, -2.0, -60.0, -119.0, -71.0, -77.0, -72.0, -98.0, -30.0, -78.0, -24.0, -112.0, -1.0, 64.0, -138.0, 84.0, 7.0, -19.0, -179.0, -181.0, -64.0, 57.0, -57.0, -45.0, 38.0, 0.0, -7.0, 0.0, -112.0, -44.0, -170.0, -148.0, -152.0, -75.0, -100.0, -98.0, -163.0, -124.0, -124.0, -134.0, -23.0, -118.0, 135.0, 0.0, 15.0, 59.0, -63.0, -56.0, -88.0, -118.0, 13.0, 0.0, 0.0, -117.0, -54.0, 43.0, -122.0, -59.0, 52.0, -177.0, -67.0, -55.0, -193.0, 192.0, -158.0, -101.0, -104.0, -134.0], "policy_predator_policy_reward": [159.0, 136.0, 101.0, 0.0, 124.0, 127.0, 173.0, 92.0, 0.0, 71.0, 123.0, 108.0, 54.0, 156.0, 168.0, 60.0, 135.0, 81.0, 185.0, 57.0, 173.0, 171.0, 63.0, 10.0, 99.0, 167.0, 125.0, 143.0, 166.0, 147.0, 97.0, 54.0, 108.0, 107.0, 126.0, 190.0, 52.0, 167.0, 94.0, 60.0, 87.0, 166.0, 66.0, 118.0, 121.0, 157.0, 138.0, 132.0, 110.0, 168.0, 110.0, 43.0, 94.0, 132.0, 134.0, 97.0, 160.0, 164.0, 171.0, 191.0, 24.0, 67.0, 87.0, 51.0, 83.0, 144.0, 153.0, 97.0, 122.0, 154.0, 104.0, 165.0, 149.0, 138.0, 148.0, 94.0, 153.0, 124.0, 149.0, 148.0, 132.0, 151.0, 138.0, 180.0, 34.0, 174.0, 131.0, 131.0, 19.0, 83.0, 167.0, 170.0, 88.0, 139.0, 158.0, 185.0, 176.0, 172.0, 74.0, 175.0, 12.0, 175.0, 150.0, 85.0, 128.0, 194.0, 139.0, 118.0, 169.0, 151.0, 187.0, 159.0, 164.0, 158.0, 118.0, 101.0, 141.0, 142.0, 121.0, 103.0, 149.0, 129.0, 60.0, 121.0, 123.0, 78.0, 124.0, 125.0, 163.0, 146.0, 151.0, 164.0, 126.0, 124.0, 103.0, 142.0, 96.0, 97.0, 121.0, 108.0, 116.0, 125.0, 133.0, 120.0, 60.0, 22.0, 155.0, 140.0, 104.0, 64.0, 149.0, 168.0, 120.0, 121.0, 137.0, 123.0, 36.0, 63.0, 92.0, 99.0, 149.0, 145.0, 145.0, 182.0, 131.0, 161.0, 121.0, 99.0, 169.0, 153.0, 135.0, 165.0, 135.0, 95.0, 24.0, 21.0, 92.0, 48.0, 124.0, 110.0, 163.0, 136.0, 0.0, 0.0, 94.0, 127.0, 140.0, 77.0, 169.0, 44.0, 180.0, 68.0, 126.0, 53.0, 169.0, 129.0, 116.0, 173.0, 166.0, 198.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5771033464096044, "mean_inference_ms": 1.3186278857829208, "mean_action_processing_ms": 0.22839348692641434, "mean_env_wait_ms": 0.17144168506453547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004851937294006348, "StateBufferConnector_ms": 0.0030007362365722656, "ViewRequirementAgentConnector_ms": 0.1006079912185669}, "num_episodes": 18, "episode_return_max": 297.0, "episode_return_min": -89.0, "episode_return_mean": 99.62, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.33292553745552, "num_env_steps_trained_throughput_per_sec": 88.33292553745552, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 45387.775, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45387.726, "sample_time_ms": 1096.045, "learn_time_ms": 44275.525, "learn_throughput": 90.343, "synch_weights_time_ms": 13.007}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 48, "trial_id": "51025_00000", "date": "2024-08-12_21-00-39", "timestamp": 1723510839, "time_this_iter_s": 45.31709098815918, "time_total_s": 2191.8708753585815, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cb03550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2191.8708753585815, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 20.6421875, "ram_util_percent": 82.7125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.20438647326969, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.394833327096606, "policy_loss": -0.012668940395846096, "vf_loss": 8.404866155745491, "vf_explained_var": 0.37172455588976544, "kl": 0.0087870620071953, "entropy": 0.951299895653649, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.00157537624319, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.623308397727039, "policy_loss": -0.00872570637652956, "vf_loss": 8.630842070604759, "vf_explained_var": 0.09396760000122918, "kl": 0.005960101329060031, "entropy": 1.0458346049306253, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 358.0, "episode_reward_min": -89.0, "episode_reward_mean": 115.06, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -193.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 192.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": -59.46, "predator_policy": 116.99}, "custom_metrics": {}, "hist_stats": {"episode_reward": [59.0, 11.0, 110.0, 211.0, 172.0, 64.0, 61.0, 58.0, 242.0, 133.0, 183.0, -2.0, 58.0, 123.0, 32.0, 122.0, 93.0, 122.0, 48.0, 85.0, -89.0, 121.0, 101.0, 172.0, 31.0, 57.0, 27.0, 89.0, -22.0, 70.0, 122.0, 147.0, 59.0, 113.0, 140.0, 94.0, 166.0, 107.0, 49.0, 102.0, 130.0, 48.0, 19.0, 111.0, 127.0, 66.0, 45.0, 59.0, 133.0, 117.0, 145.0, 241.0, 156.0, -43.0, 234.0, 158.0, 137.0, 184.0, 138.0, 9.0, 65.0, 22.0, 35.0, 42.0, 89.0, 180.0, 214.0, 115.0, 93.0, 13.0, 104.0, 206.0, 32.0, 123.0, 57.0, 297.0, 30.0, 126.0, 198.0, 155.0, 124.0, 150.0, 358.0, 210.0, 136.0, 170.0, 239.0, 257.0, 240.0, 123.0, -32.0, 214.0, 53.0, 225.0, 120.0, 259.0, 111.0, 244.0, 105.0, 149.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-71.0, -148.0, -132.0, -127.0, -98.0, -70.0, -32.0, 90.0, -56.0, 2.0, -105.0, -62.0, -122.0, -141.0, -121.0, -183.0, 74.0, 77.0, -35.0, 30.0, -24.0, -20.0, -102.0, -150.0, -78.0, -140.0, -146.0, 0.0, -82.0, -173.0, 26.0, -146.0, -157.0, -27.0, -104.0, -71.0, -136.0, -99.0, -161.0, -72.0, -148.0, -149.0, -70.0, -71.0, -1.0, 0.0, -98.0, -67.0, -102.0, -94.0, -95.0, -191.0, -192.0, -129.0, -160.0, 0.0, -151.0, -58.0, -72.0, -93.0, -186.0, -14.0, -102.0, -8.0, -92.0, -169.0, -138.0, -95.0, -130.0, -52.0, -13.0, -112.0, -116.0, -1.0, -104.0, -13.0, -108.0, -121.0, -66.0, -13.0, -30.0, -41.0, -85.0, -116.0, -131.0, -159.0, -86.0, -118.0, -121.0, -2.0, -60.0, -119.0, -71.0, -77.0, -72.0, -98.0, -30.0, -78.0, -24.0, -112.0, -1.0, 64.0, -138.0, 84.0, 7.0, -19.0, -179.0, -181.0, -64.0, 57.0, -57.0, -45.0, 38.0, 0.0, -7.0, 0.0, -112.0, -44.0, -170.0, -148.0, -152.0, -75.0, -100.0, -98.0, -163.0, -124.0, -124.0, -134.0, -23.0, -118.0, 135.0, 0.0, 15.0, 59.0, -63.0, -56.0, -88.0, -118.0, 13.0, 0.0, 0.0, -117.0, -54.0, 43.0, -122.0, -59.0, 52.0, -177.0, -67.0, -55.0, -193.0, 192.0, -158.0, -101.0, -104.0, -134.0, -129.0, 36.0, -154.0, 30.0, -157.0, -30.0, -40.0, -3.0, 140.0, 171.0, 45.0, -75.0, -36.0, -69.0, 0.0, 128.0, -74.0, 185.0, 0.0, -60.0, 34.0, 112.0, 0.0, -23.0, -100.0, -138.0, 38.0, 74.0, 0.0, -125.0, 82.0, 28.0, -71.0, -80.0, -39.0, 150.0, 18.0, -129.0, -41.0, 72.0, 0.0, -106.0, -23.0, -34.0], "policy_predator_policy_reward": [121.0, 157.0, 138.0, 132.0, 110.0, 168.0, 110.0, 43.0, 94.0, 132.0, 134.0, 97.0, 160.0, 164.0, 171.0, 191.0, 24.0, 67.0, 87.0, 51.0, 83.0, 144.0, 153.0, 97.0, 122.0, 154.0, 104.0, 165.0, 149.0, 138.0, 148.0, 94.0, 153.0, 124.0, 149.0, 148.0, 132.0, 151.0, 138.0, 180.0, 34.0, 174.0, 131.0, 131.0, 19.0, 83.0, 167.0, 170.0, 88.0, 139.0, 158.0, 185.0, 176.0, 172.0, 74.0, 175.0, 12.0, 175.0, 150.0, 85.0, 128.0, 194.0, 139.0, 118.0, 169.0, 151.0, 187.0, 159.0, 164.0, 158.0, 118.0, 101.0, 141.0, 142.0, 121.0, 103.0, 149.0, 129.0, 60.0, 121.0, 123.0, 78.0, 124.0, 125.0, 163.0, 146.0, 151.0, 164.0, 126.0, 124.0, 103.0, 142.0, 96.0, 97.0, 121.0, 108.0, 116.0, 125.0, 133.0, 120.0, 60.0, 22.0, 155.0, 140.0, 104.0, 64.0, 149.0, 168.0, 120.0, 121.0, 137.0, 123.0, 36.0, 63.0, 92.0, 99.0, 149.0, 145.0, 145.0, 182.0, 131.0, 161.0, 121.0, 99.0, 169.0, 153.0, 135.0, 165.0, 135.0, 95.0, 24.0, 21.0, 92.0, 48.0, 124.0, 110.0, 163.0, 136.0, 0.0, 0.0, 94.0, 127.0, 140.0, 77.0, 169.0, 44.0, 180.0, 68.0, 126.0, 53.0, 169.0, 129.0, 116.0, 173.0, 166.0, 198.0, 172.0, 119.0, 113.0, 166.0, 156.0, 155.0, 94.0, 99.0, 26.0, 21.0, 105.0, 135.0, 99.0, 142.0, 36.0, 6.0, 0.0, 128.0, 155.0, 162.0, 39.0, 55.0, 64.0, 82.0, 151.0, 55.0, 21.0, 81.0, 66.0, 112.0, 66.0, 49.0, 125.0, 146.0, 67.0, 81.0, 157.0, 65.0, 94.0, 119.0, 132.0, 79.0, 101.0, 105.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5771011930080547, "mean_inference_ms": 1.316485577775691, "mean_action_processing_ms": 0.22820419451536877, "mean_env_wait_ms": 0.1712878644717365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0055561065673828125, "StateBufferConnector_ms": 0.0029753446578979492, "ViewRequirementAgentConnector_ms": 0.10035502910614014}, "num_episodes": 22, "episode_return_max": 358.0, "episode_return_min": -89.0, "episode_return_mean": 115.06, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.93358475357985, "num_env_steps_trained_throughput_per_sec": 88.93358475357985, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 45395.082, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45395.032, "sample_time_ms": 1092.959, "learn_time_ms": 44285.4, "learn_throughput": 90.323, "synch_weights_time_ms": 13.419}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 49, "trial_id": "51025_00000", "date": "2024-08-12_21-01-24", "timestamp": 1723510884, "time_this_iter_s": 45.02690100669861, "time_total_s": 2236.89777636528, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158086d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2236.89777636528, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 19.334375, "ram_util_percent": 82.49531249999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.46106886378041, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.939224543142571, "policy_loss": -0.012804795671303673, "vf_loss": 7.9494237324548145, "vf_explained_var": 0.40315382297707614, "kl": 0.008685317017780445, "entropy": 1.0096964281702798, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.400344117860946, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.780665047711166, "policy_loss": -0.009251906981361567, "vf_loss": 8.78886346943164, "vf_explained_var": 0.13704790416217985, "kl": 0.0052674512718602585, "entropy": 1.0512315547024762, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 358.0, "episode_reward_min": -43.0, "episode_reward_mean": 134.81, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -196.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": -42.735, "predator_policy": 110.14}, "custom_metrics": {}, "hist_stats": {"episode_reward": [172.0, 31.0, 57.0, 27.0, 89.0, -22.0, 70.0, 122.0, 147.0, 59.0, 113.0, 140.0, 94.0, 166.0, 107.0, 49.0, 102.0, 130.0, 48.0, 19.0, 111.0, 127.0, 66.0, 45.0, 59.0, 133.0, 117.0, 145.0, 241.0, 156.0, -43.0, 234.0, 158.0, 137.0, 184.0, 138.0, 9.0, 65.0, 22.0, 35.0, 42.0, 89.0, 180.0, 214.0, 115.0, 93.0, 13.0, 104.0, 206.0, 32.0, 123.0, 57.0, 297.0, 30.0, 126.0, 198.0, 155.0, 124.0, 150.0, 358.0, 210.0, 136.0, 170.0, 239.0, 257.0, 240.0, 123.0, -32.0, 214.0, 53.0, 225.0, 120.0, 259.0, 111.0, 244.0, 105.0, 149.0, 168.0, 107.0, 213.0, 253.0, 78.0, 189.0, 250.0, 45.0, 127.0, 256.0, 238.0, 298.0, 149.0, 86.0, 203.0, 213.0, 34.0, -1.0, 229.0, 259.0, 293.0, 218.0, 188.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-98.0, -67.0, -102.0, -94.0, -95.0, -191.0, -192.0, -129.0, -160.0, 0.0, -151.0, -58.0, -72.0, -93.0, -186.0, -14.0, -102.0, -8.0, -92.0, -169.0, -138.0, -95.0, -130.0, -52.0, -13.0, -112.0, -116.0, -1.0, -104.0, -13.0, -108.0, -121.0, -66.0, -13.0, -30.0, -41.0, -85.0, -116.0, -131.0, -159.0, -86.0, -118.0, -121.0, -2.0, -60.0, -119.0, -71.0, -77.0, -72.0, -98.0, -30.0, -78.0, -24.0, -112.0, -1.0, 64.0, -138.0, 84.0, 7.0, -19.0, -179.0, -181.0, -64.0, 57.0, -57.0, -45.0, 38.0, 0.0, -7.0, 0.0, -112.0, -44.0, -170.0, -148.0, -152.0, -75.0, -100.0, -98.0, -163.0, -124.0, -124.0, -134.0, -23.0, -118.0, 135.0, 0.0, 15.0, 59.0, -63.0, -56.0, -88.0, -118.0, 13.0, 0.0, 0.0, -117.0, -54.0, 43.0, -122.0, -59.0, 52.0, -177.0, -67.0, -55.0, -193.0, 192.0, -158.0, -101.0, -104.0, -134.0, -129.0, 36.0, -154.0, 30.0, -157.0, -30.0, -40.0, -3.0, 140.0, 171.0, 45.0, -75.0, -36.0, -69.0, 0.0, 128.0, -74.0, 185.0, 0.0, -60.0, 34.0, 112.0, 0.0, -23.0, -100.0, -138.0, 38.0, 74.0, 0.0, -125.0, 82.0, 28.0, -71.0, -80.0, -39.0, 150.0, 18.0, -129.0, -41.0, 72.0, 0.0, -106.0, -23.0, -34.0, 134.0, 0.0, -81.0, -122.0, -28.0, 109.0, -70.0, 94.0, 0.0, -46.0, 31.0, 70.0, 55.0, 34.0, -126.0, -151.0, -22.0, -10.0, 51.0, 70.0, 77.0, 60.0, -20.0, 138.0, 14.0, -3.0, 0.0, -137.0, -84.0, 52.0, 66.0, -135.0, -96.0, -130.0, -196.0, -101.0, 105.0, -58.0, -34.0, 196.0, 116.0, -35.0, 35.0, 36.0, -112.0, 68.0], "policy_predator_policy_reward": [167.0, 170.0, 88.0, 139.0, 158.0, 185.0, 176.0, 172.0, 74.0, 175.0, 12.0, 175.0, 150.0, 85.0, 128.0, 194.0, 139.0, 118.0, 169.0, 151.0, 187.0, 159.0, 164.0, 158.0, 118.0, 101.0, 141.0, 142.0, 121.0, 103.0, 149.0, 129.0, 60.0, 121.0, 123.0, 78.0, 124.0, 125.0, 163.0, 146.0, 151.0, 164.0, 126.0, 124.0, 103.0, 142.0, 96.0, 97.0, 121.0, 108.0, 116.0, 125.0, 133.0, 120.0, 60.0, 22.0, 155.0, 140.0, 104.0, 64.0, 149.0, 168.0, 120.0, 121.0, 137.0, 123.0, 36.0, 63.0, 92.0, 99.0, 149.0, 145.0, 145.0, 182.0, 131.0, 161.0, 121.0, 99.0, 169.0, 153.0, 135.0, 165.0, 135.0, 95.0, 24.0, 21.0, 92.0, 48.0, 124.0, 110.0, 163.0, 136.0, 0.0, 0.0, 94.0, 127.0, 140.0, 77.0, 169.0, 44.0, 180.0, 68.0, 126.0, 53.0, 169.0, 129.0, 116.0, 173.0, 166.0, 198.0, 172.0, 119.0, 113.0, 166.0, 156.0, 155.0, 94.0, 99.0, 26.0, 21.0, 105.0, 135.0, 99.0, 142.0, 36.0, 6.0, 0.0, 128.0, 155.0, 162.0, 39.0, 55.0, 64.0, 82.0, 151.0, 55.0, 21.0, 81.0, 66.0, 112.0, 66.0, 49.0, 125.0, 146.0, 67.0, 81.0, 157.0, 65.0, 94.0, 119.0, 132.0, 79.0, 101.0, 105.0, 33.0, 1.0, 169.0, 141.0, 59.0, 73.0, 128.0, 101.0, 92.0, 32.0, 22.0, 66.0, 100.0, 61.0, 153.0, 169.0, 62.0, 97.0, 58.0, 77.0, 65.0, 36.0, 93.0, 87.0, 83.0, 55.0, 145.0, 78.0, 100.0, 135.0, 170.0, 112.0, 168.0, 92.0, 116.0, 180.0, 67.0, 115.0, 55.0, 42.0, 67.0, 145.0, 67.0, 80.0, 87.0, 145.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.577090729620907, "mean_inference_ms": 1.3152459416525002, "mean_action_processing_ms": 0.22803099299871107, "mean_env_wait_ms": 0.17108613681427431, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005949854850769043, "StateBufferConnector_ms": 0.0029745101928710938, "ViewRequirementAgentConnector_ms": 0.09942030906677246}, "num_episodes": 23, "episode_return_max": 358.0, "episode_return_min": -43.0, "episode_return_mean": 134.81, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.62490694953586, "num_env_steps_trained_throughput_per_sec": 88.62490694953586, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 45370.208, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45370.158, "sample_time_ms": 1097.982, "learn_time_ms": 44255.907, "learn_throughput": 90.383, "synch_weights_time_ms": 13.403}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 50, "trial_id": "51025_00000", "date": "2024-08-12_21-02-09", "timestamp": 1723510929, "time_this_iter_s": 45.179054737091064, "time_total_s": 2282.076831102371, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158076670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2282.076831102371, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 19.9203125, "ram_util_percent": 82.184375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.658791155222231, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.941326803126663, "policy_loss": -0.00827864136241337, "vf_loss": 6.947897255862201, "vf_explained_var": -0.09990738772210621, "kl": 0.005693873282282252, "entropy": 1.1394678120259885, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.81986106413382, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.324140226525605, "policy_loss": -0.014222558538636399, "vf_loss": 8.336507983939358, "vf_explained_var": 0.2821900397066086, "kl": 0.009274014906859758, "entropy": 0.9784753096797479, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 367.0, "episode_reward_min": -54.0, "episode_reward_mean": 138.42, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -200.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -28.565, "predator_policy": 97.775}, "custom_metrics": {}, "hist_stats": {"episode_reward": [48.0, 19.0, 111.0, 127.0, 66.0, 45.0, 59.0, 133.0, 117.0, 145.0, 241.0, 156.0, -43.0, 234.0, 158.0, 137.0, 184.0, 138.0, 9.0, 65.0, 22.0, 35.0, 42.0, 89.0, 180.0, 214.0, 115.0, 93.0, 13.0, 104.0, 206.0, 32.0, 123.0, 57.0, 297.0, 30.0, 126.0, 198.0, 155.0, 124.0, 150.0, 358.0, 210.0, 136.0, 170.0, 239.0, 257.0, 240.0, 123.0, -32.0, 214.0, 53.0, 225.0, 120.0, 259.0, 111.0, 244.0, 105.0, 149.0, 168.0, 107.0, 213.0, 253.0, 78.0, 189.0, 250.0, 45.0, 127.0, 256.0, 238.0, 298.0, 149.0, 86.0, 203.0, 213.0, 34.0, -1.0, 229.0, 259.0, 293.0, 218.0, 188.0, 367.0, 232.0, 61.0, 104.0, 352.0, 20.0, 97.0, 162.0, 65.0, -38.0, 57.0, 20.0, 0.0, 60.0, 335.0, 115.0, 59.0, -54.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-85.0, -116.0, -131.0, -159.0, -86.0, -118.0, -121.0, -2.0, -60.0, -119.0, -71.0, -77.0, -72.0, -98.0, -30.0, -78.0, -24.0, -112.0, -1.0, 64.0, -138.0, 84.0, 7.0, -19.0, -179.0, -181.0, -64.0, 57.0, -57.0, -45.0, 38.0, 0.0, -7.0, 0.0, -112.0, -44.0, -170.0, -148.0, -152.0, -75.0, -100.0, -98.0, -163.0, -124.0, -124.0, -134.0, -23.0, -118.0, 135.0, 0.0, 15.0, 59.0, -63.0, -56.0, -88.0, -118.0, 13.0, 0.0, 0.0, -117.0, -54.0, 43.0, -122.0, -59.0, 52.0, -177.0, -67.0, -55.0, -193.0, 192.0, -158.0, -101.0, -104.0, -134.0, -129.0, 36.0, -154.0, 30.0, -157.0, -30.0, -40.0, -3.0, 140.0, 171.0, 45.0, -75.0, -36.0, -69.0, 0.0, 128.0, -74.0, 185.0, 0.0, -60.0, 34.0, 112.0, 0.0, -23.0, -100.0, -138.0, 38.0, 74.0, 0.0, -125.0, 82.0, 28.0, -71.0, -80.0, -39.0, 150.0, 18.0, -129.0, -41.0, 72.0, 0.0, -106.0, -23.0, -34.0, 134.0, 0.0, -81.0, -122.0, -28.0, 109.0, -70.0, 94.0, 0.0, -46.0, 31.0, 70.0, 55.0, 34.0, -126.0, -151.0, -22.0, -10.0, 51.0, 70.0, 77.0, 60.0, -20.0, 138.0, 14.0, -3.0, 0.0, -137.0, -84.0, 52.0, 66.0, -135.0, -96.0, -130.0, -196.0, -101.0, 105.0, -58.0, -34.0, 196.0, 116.0, -35.0, 35.0, 36.0, -112.0, 68.0, 180.0, 82.0, 78.0, 94.0, 0.0, -94.0, -26.0, 65.0, 138.0, 160.0, -39.0, -120.0, 20.0, -136.0, 68.0, -13.0, 0.0, -84.0, -187.0, -80.0, -83.0, -20.0, -51.0, -42.0, 0.0, 0.0, -1.0, -112.0, 168.0, 143.0, -64.0, 32.0, -144.0, 0.0, -200.0, -124.0], "policy_predator_policy_reward": [124.0, 125.0, 163.0, 146.0, 151.0, 164.0, 126.0, 124.0, 103.0, 142.0, 96.0, 97.0, 121.0, 108.0, 116.0, 125.0, 133.0, 120.0, 60.0, 22.0, 155.0, 140.0, 104.0, 64.0, 149.0, 168.0, 120.0, 121.0, 137.0, 123.0, 36.0, 63.0, 92.0, 99.0, 149.0, 145.0, 145.0, 182.0, 131.0, 161.0, 121.0, 99.0, 169.0, 153.0, 135.0, 165.0, 135.0, 95.0, 24.0, 21.0, 92.0, 48.0, 124.0, 110.0, 163.0, 136.0, 0.0, 0.0, 94.0, 127.0, 140.0, 77.0, 169.0, 44.0, 180.0, 68.0, 126.0, 53.0, 169.0, 129.0, 116.0, 173.0, 166.0, 198.0, 172.0, 119.0, 113.0, 166.0, 156.0, 155.0, 94.0, 99.0, 26.0, 21.0, 105.0, 135.0, 99.0, 142.0, 36.0, 6.0, 0.0, 128.0, 155.0, 162.0, 39.0, 55.0, 64.0, 82.0, 151.0, 55.0, 21.0, 81.0, 66.0, 112.0, 66.0, 49.0, 125.0, 146.0, 67.0, 81.0, 157.0, 65.0, 94.0, 119.0, 132.0, 79.0, 101.0, 105.0, 33.0, 1.0, 169.0, 141.0, 59.0, 73.0, 128.0, 101.0, 92.0, 32.0, 22.0, 66.0, 100.0, 61.0, 153.0, 169.0, 62.0, 97.0, 58.0, 77.0, 65.0, 36.0, 93.0, 87.0, 83.0, 55.0, 145.0, 78.0, 100.0, 135.0, 170.0, 112.0, 168.0, 92.0, 116.0, 180.0, 67.0, 115.0, 55.0, 42.0, 67.0, 145.0, 67.0, 80.0, 87.0, 145.0, 66.0, 39.0, 57.0, 3.0, 128.0, 27.0, 16.0, 49.0, 41.0, 13.0, 56.0, 123.0, 45.0, 168.0, 43.0, 64.0, 124.0, 25.0, 38.0, 191.0, 104.0, 56.0, 4.0, 109.0, 0.0, 0.0, 37.0, 136.0, 16.0, 8.0, 29.0, 118.0, 88.0, 115.0, 200.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5767861642457902, "mean_inference_ms": 1.3141004530611036, "mean_action_processing_ms": 0.22805575394916397, "mean_env_wait_ms": 0.1710627327135625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005671143531799316, "StateBufferConnector_ms": 0.003031134605407715, "ViewRequirementAgentConnector_ms": 0.1017916202545166}, "num_episodes": 18, "episode_return_max": 367.0, "episode_return_min": -54.0, "episode_return_mean": 138.42, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 87.44182987224521, "num_env_steps_trained_throughput_per_sec": 87.44182987224521, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 45417.652, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45417.603, "sample_time_ms": 1083.885, "learn_time_ms": 44316.629, "learn_throughput": 90.26, "synch_weights_time_ms": 13.866}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 51, "trial_id": "51025_00000", "date": "2024-08-12_21-02-55", "timestamp": 1723510975, "time_this_iter_s": 45.789177894592285, "time_total_s": 2327.8660089969635, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1580de9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2327.8660089969635, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 22.27384615384615, "ram_util_percent": 82.83076923076925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.080628869710146, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.833947727415297, "policy_loss": -0.007011690659438649, "vf_loss": 6.839103952286735, "vf_explained_var": -0.3455325318391992, "kl": 0.006184916496131994, "entropy": 1.1516032405631251, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.226925057204312, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.495765771815385, "policy_loss": -0.013268619780699728, "vf_loss": 7.507299796866361, "vf_explained_var": 0.33310887772570213, "kl": 0.008672913530620496, "entropy": 0.9506880162254212, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 367.0, "episode_reward_min": -54.0, "episode_reward_mean": 130.61, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -200.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -22.74, "predator_policy": 88.045}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.0, 65.0, 22.0, 35.0, 42.0, 89.0, 180.0, 214.0, 115.0, 93.0, 13.0, 104.0, 206.0, 32.0, 123.0, 57.0, 297.0, 30.0, 126.0, 198.0, 155.0, 124.0, 150.0, 358.0, 210.0, 136.0, 170.0, 239.0, 257.0, 240.0, 123.0, -32.0, 214.0, 53.0, 225.0, 120.0, 259.0, 111.0, 244.0, 105.0, 149.0, 168.0, 107.0, 213.0, 253.0, 78.0, 189.0, 250.0, 45.0, 127.0, 256.0, 238.0, 298.0, 149.0, 86.0, 203.0, 213.0, 34.0, -1.0, 229.0, 259.0, 293.0, 218.0, 188.0, 367.0, 232.0, 61.0, 104.0, 352.0, 20.0, 97.0, 162.0, 65.0, -38.0, 57.0, 20.0, 0.0, 60.0, 335.0, 115.0, 59.0, -54.0, 16.0, 117.0, 105.0, 168.0, 115.0, 161.0, 204.0, 47.0, 0.0, 117.0, 62.0, 72.0, -33.0, 42.0, -17.0, 57.0, -41.0, 102.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-170.0, -148.0, -152.0, -75.0, -100.0, -98.0, -163.0, -124.0, -124.0, -134.0, -23.0, -118.0, 135.0, 0.0, 15.0, 59.0, -63.0, -56.0, -88.0, -118.0, 13.0, 0.0, 0.0, -117.0, -54.0, 43.0, -122.0, -59.0, 52.0, -177.0, -67.0, -55.0, -193.0, 192.0, -158.0, -101.0, -104.0, -134.0, -129.0, 36.0, -154.0, 30.0, -157.0, -30.0, -40.0, -3.0, 140.0, 171.0, 45.0, -75.0, -36.0, -69.0, 0.0, 128.0, -74.0, 185.0, 0.0, -60.0, 34.0, 112.0, 0.0, -23.0, -100.0, -138.0, 38.0, 74.0, 0.0, -125.0, 82.0, 28.0, -71.0, -80.0, -39.0, 150.0, 18.0, -129.0, -41.0, 72.0, 0.0, -106.0, -23.0, -34.0, 134.0, 0.0, -81.0, -122.0, -28.0, 109.0, -70.0, 94.0, 0.0, -46.0, 31.0, 70.0, 55.0, 34.0, -126.0, -151.0, -22.0, -10.0, 51.0, 70.0, 77.0, 60.0, -20.0, 138.0, 14.0, -3.0, 0.0, -137.0, -84.0, 52.0, 66.0, -135.0, -96.0, -130.0, -196.0, -101.0, 105.0, -58.0, -34.0, 196.0, 116.0, -35.0, 35.0, 36.0, -112.0, 68.0, 180.0, 82.0, 78.0, 94.0, 0.0, -94.0, -26.0, 65.0, 138.0, 160.0, -39.0, -120.0, 20.0, -136.0, 68.0, -13.0, 0.0, -84.0, -187.0, -80.0, -83.0, -20.0, -51.0, -42.0, 0.0, 0.0, -1.0, -112.0, 168.0, 143.0, -64.0, 32.0, -144.0, 0.0, -200.0, -124.0, 16.0, 0.0, 0.0, -200.0, -2.0, 21.0, 0.0, 122.0, 33.0, 0.0, -3.0, 126.0, 5.0, 73.0, -120.0, 0.0, 0.0, 0.0, 14.0, 0.0, -99.0, -28.0, 0.0, -29.0, -106.0, -88.0, 0.0, -78.0, -120.0, -74.0, -40.0, -84.0, -163.0, -116.0, -6.0, -45.0], "policy_predator_policy_reward": [145.0, 182.0, 131.0, 161.0, 121.0, 99.0, 169.0, 153.0, 135.0, 165.0, 135.0, 95.0, 24.0, 21.0, 92.0, 48.0, 124.0, 110.0, 163.0, 136.0, 0.0, 0.0, 94.0, 127.0, 140.0, 77.0, 169.0, 44.0, 180.0, 68.0, 126.0, 53.0, 169.0, 129.0, 116.0, 173.0, 166.0, 198.0, 172.0, 119.0, 113.0, 166.0, 156.0, 155.0, 94.0, 99.0, 26.0, 21.0, 105.0, 135.0, 99.0, 142.0, 36.0, 6.0, 0.0, 128.0, 155.0, 162.0, 39.0, 55.0, 64.0, 82.0, 151.0, 55.0, 21.0, 81.0, 66.0, 112.0, 66.0, 49.0, 125.0, 146.0, 67.0, 81.0, 157.0, 65.0, 94.0, 119.0, 132.0, 79.0, 101.0, 105.0, 33.0, 1.0, 169.0, 141.0, 59.0, 73.0, 128.0, 101.0, 92.0, 32.0, 22.0, 66.0, 100.0, 61.0, 153.0, 169.0, 62.0, 97.0, 58.0, 77.0, 65.0, 36.0, 93.0, 87.0, 83.0, 55.0, 145.0, 78.0, 100.0, 135.0, 170.0, 112.0, 168.0, 92.0, 116.0, 180.0, 67.0, 115.0, 55.0, 42.0, 67.0, 145.0, 67.0, 80.0, 87.0, 145.0, 66.0, 39.0, 57.0, 3.0, 128.0, 27.0, 16.0, 49.0, 41.0, 13.0, 56.0, 123.0, 45.0, 168.0, 43.0, 64.0, 124.0, 25.0, 38.0, 191.0, 104.0, 56.0, 4.0, 109.0, 0.0, 0.0, 37.0, 136.0, 16.0, 8.0, 29.0, 118.0, 88.0, 115.0, 200.0, 70.0, 0.0, 0.0, 194.0, 123.0, 3.0, 83.0, 13.0, 33.0, 63.0, 19.0, 38.0, 0.0, 39.0, 87.0, 158.0, 9.0, 0.0, 0.0, 31.0, 72.0, 153.0, 36.0, 37.0, 64.0, 15.0, 146.0, 31.0, 89.0, 5.0, 172.0, 59.0, 122.0, 173.0, 65.0, 32.0, 121.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.576934235896324, "mean_inference_ms": 1.3132175039702207, "mean_action_processing_ms": 0.22798688144702303, "mean_env_wait_ms": 0.17103093596601654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005577445030212402, "StateBufferConnector_ms": 0.003110051155090332, "ViewRequirementAgentConnector_ms": 0.10957419872283936}, "num_episodes": 18, "episode_return_max": 367.0, "episode_return_min": -54.0, "episode_return_mean": 130.61, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.47999309425103, "num_env_steps_trained_throughput_per_sec": 88.47999309425103, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 45417.366, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45417.318, "sample_time_ms": 1095.78, "learn_time_ms": 44303.971, "learn_throughput": 90.285, "synch_weights_time_ms": 14.158}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 52, "trial_id": "51025_00000", "date": "2024-08-12_21-03-40", "timestamp": 1723511020, "time_this_iter_s": 45.25643801689148, "time_total_s": 2373.122447013855, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158052040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2373.122447013855, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 20.7, "ram_util_percent": 83.0296875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.950948171703904, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.607373206073015, "policy_loss": -0.01086427957908541, "vf_loss": 7.615692383650119, "vf_explained_var": -0.4533106968516395, "kl": 0.008483668982626192, "entropy": 1.0905205835741032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.421405961526133, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.159531638231227, "policy_loss": -0.010829651318047018, "vf_loss": 8.169009613612342, "vf_explained_var": 0.3211067768631789, "kl": 0.0067583139665178225, "entropy": 0.9622035397739007, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "env_runners": {"episode_reward_max": 367.0, "episode_reward_min": -54.0, "episode_reward_mean": 125.7, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -200.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -24.905, "predator_policy": 87.755}, "custom_metrics": {}, "hist_stats": {"episode_reward": [126.0, 198.0, 155.0, 124.0, 150.0, 358.0, 210.0, 136.0, 170.0, 239.0, 257.0, 240.0, 123.0, -32.0, 214.0, 53.0, 225.0, 120.0, 259.0, 111.0, 244.0, 105.0, 149.0, 168.0, 107.0, 213.0, 253.0, 78.0, 189.0, 250.0, 45.0, 127.0, 256.0, 238.0, 298.0, 149.0, 86.0, 203.0, 213.0, 34.0, -1.0, 229.0, 259.0, 293.0, 218.0, 188.0, 367.0, 232.0, 61.0, 104.0, 352.0, 20.0, 97.0, 162.0, 65.0, -38.0, 57.0, 20.0, 0.0, 60.0, 335.0, 115.0, 59.0, -54.0, 16.0, 117.0, 105.0, 168.0, 115.0, 161.0, 204.0, 47.0, 0.0, 117.0, 62.0, 72.0, -33.0, 42.0, -17.0, 57.0, -41.0, 102.0, 118.0, 36.0, 19.0, 53.0, -45.0, 73.0, 68.0, 33.0, 52.0, 37.0, 13.0, 121.0, 44.0, 241.0, 81.0, 111.0, 130.0, 50.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-104.0, -134.0, -129.0, 36.0, -154.0, 30.0, -157.0, -30.0, -40.0, -3.0, 140.0, 171.0, 45.0, -75.0, -36.0, -69.0, 0.0, 128.0, -74.0, 185.0, 0.0, -60.0, 34.0, 112.0, 0.0, -23.0, -100.0, -138.0, 38.0, 74.0, 0.0, -125.0, 82.0, 28.0, -71.0, -80.0, -39.0, 150.0, 18.0, -129.0, -41.0, 72.0, 0.0, -106.0, -23.0, -34.0, 134.0, 0.0, -81.0, -122.0, -28.0, 109.0, -70.0, 94.0, 0.0, -46.0, 31.0, 70.0, 55.0, 34.0, -126.0, -151.0, -22.0, -10.0, 51.0, 70.0, 77.0, 60.0, -20.0, 138.0, 14.0, -3.0, 0.0, -137.0, -84.0, 52.0, 66.0, -135.0, -96.0, -130.0, -196.0, -101.0, 105.0, -58.0, -34.0, 196.0, 116.0, -35.0, 35.0, 36.0, -112.0, 68.0, 180.0, 82.0, 78.0, 94.0, 0.0, -94.0, -26.0, 65.0, 138.0, 160.0, -39.0, -120.0, 20.0, -136.0, 68.0, -13.0, 0.0, -84.0, -187.0, -80.0, -83.0, -20.0, -51.0, -42.0, 0.0, 0.0, -1.0, -112.0, 168.0, 143.0, -64.0, 32.0, -144.0, 0.0, -200.0, -124.0, 16.0, 0.0, 0.0, -200.0, -2.0, 21.0, 0.0, 122.0, 33.0, 0.0, -3.0, 126.0, 5.0, 73.0, -120.0, 0.0, 0.0, 0.0, 14.0, 0.0, -99.0, -28.0, 0.0, -29.0, -106.0, -88.0, 0.0, -78.0, -120.0, -74.0, -40.0, -84.0, -163.0, -116.0, -6.0, -45.0, -150.0, -2.0, -142.0, -191.0, -74.0, -75.0, 0.0, -136.0, -101.0, -100.0, -70.0, -182.0, -154.0, 11.0, -161.0, -138.0, -99.0, -65.0, -129.0, -142.0, -104.0, -123.0, 59.0, 0.0, -148.0, 0.0, 101.0, -147.0, 7.0, -95.0, 28.0, -140.0, 14.0, 18.0, -55.0, -96.0], "policy_predator_policy_reward": [166.0, 198.0, 172.0, 119.0, 113.0, 166.0, 156.0, 155.0, 94.0, 99.0, 26.0, 21.0, 105.0, 135.0, 99.0, 142.0, 36.0, 6.0, 0.0, 128.0, 155.0, 162.0, 39.0, 55.0, 64.0, 82.0, 151.0, 55.0, 21.0, 81.0, 66.0, 112.0, 66.0, 49.0, 125.0, 146.0, 67.0, 81.0, 157.0, 65.0, 94.0, 119.0, 132.0, 79.0, 101.0, 105.0, 33.0, 1.0, 169.0, 141.0, 59.0, 73.0, 128.0, 101.0, 92.0, 32.0, 22.0, 66.0, 100.0, 61.0, 153.0, 169.0, 62.0, 97.0, 58.0, 77.0, 65.0, 36.0, 93.0, 87.0, 83.0, 55.0, 145.0, 78.0, 100.0, 135.0, 170.0, 112.0, 168.0, 92.0, 116.0, 180.0, 67.0, 115.0, 55.0, 42.0, 67.0, 145.0, 67.0, 80.0, 87.0, 145.0, 66.0, 39.0, 57.0, 3.0, 128.0, 27.0, 16.0, 49.0, 41.0, 13.0, 56.0, 123.0, 45.0, 168.0, 43.0, 64.0, 124.0, 25.0, 38.0, 191.0, 104.0, 56.0, 4.0, 109.0, 0.0, 0.0, 37.0, 136.0, 16.0, 8.0, 29.0, 118.0, 88.0, 115.0, 200.0, 70.0, 0.0, 0.0, 194.0, 123.0, 3.0, 83.0, 13.0, 33.0, 63.0, 19.0, 38.0, 0.0, 39.0, 87.0, 158.0, 9.0, 0.0, 0.0, 31.0, 72.0, 153.0, 36.0, 37.0, 64.0, 15.0, 146.0, 31.0, 89.0, 5.0, 172.0, 59.0, 122.0, 173.0, 65.0, 32.0, 121.0, 144.0, 126.0, 191.0, 178.0, 109.0, 59.0, 77.0, 112.0, 9.0, 147.0, 128.0, 197.0, 55.0, 156.0, 176.0, 156.0, 126.0, 90.0, 138.0, 170.0, 76.0, 164.0, 62.0, 0.0, 108.0, 84.0, 134.0, 153.0, 144.0, 25.0, 188.0, 35.0, 96.0, 2.0, 68.0, 133.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5770122160484145, "mean_inference_ms": 1.3122070635679282, "mean_action_processing_ms": 0.2279277414999938, "mean_env_wait_ms": 0.17100652628522842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004982948303222656, "StateBufferConnector_ms": 0.0030394792556762695, "ViewRequirementAgentConnector_ms": 0.09602630138397217}, "num_episodes": 18, "episode_return_max": 367.0, "episode_return_min": -54.0, "episode_return_mean": 125.7, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.93699375128786, "num_env_steps_trained_throughput_per_sec": 88.93699375128786, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 45401.871, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45401.823, "sample_time_ms": 1099.25, "learn_time_ms": 44284.962, "learn_throughput": 90.324, "synch_weights_time_ms": 14.393}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "training_iteration": 53, "trial_id": "51025_00000", "date": "2024-08-12_21-04-25", "timestamp": 1723511065, "time_this_iter_s": 45.01779913902283, "time_total_s": 2418.140246152878, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cb384c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2418.140246152878, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 19.728571428571428, "ram_util_percent": 82.6825396825397}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.942366723345701, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.386885230377238, "policy_loss": -0.008929672856228772, "vf_loss": 5.393564076272268, "vf_explained_var": -0.96066538858666, "kl": 0.007502766815980221, "entropy": 1.1638542682405502, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.13564762526719, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.968650062752779, "policy_loss": -0.010896591666258044, "vf_loss": 7.977649276471012, "vf_explained_var": 0.24562767084944184, "kl": 0.009486846078558571, "entropy": 0.8743510677385582, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 367.0, "episode_reward_min": -54.0, "episode_reward_mean": 109.67, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -200.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -32.08, "predator_policy": 86.915}, "custom_metrics": {}, "hist_stats": {"episode_reward": [149.0, 168.0, 107.0, 213.0, 253.0, 78.0, 189.0, 250.0, 45.0, 127.0, 256.0, 238.0, 298.0, 149.0, 86.0, 203.0, 213.0, 34.0, -1.0, 229.0, 259.0, 293.0, 218.0, 188.0, 367.0, 232.0, 61.0, 104.0, 352.0, 20.0, 97.0, 162.0, 65.0, -38.0, 57.0, 20.0, 0.0, 60.0, 335.0, 115.0, 59.0, -54.0, 16.0, 117.0, 105.0, 168.0, 115.0, 161.0, 204.0, 47.0, 0.0, 117.0, 62.0, 72.0, -33.0, 42.0, -17.0, 57.0, -41.0, 102.0, 118.0, 36.0, 19.0, 53.0, -45.0, 73.0, 68.0, 33.0, 52.0, 37.0, 13.0, 121.0, 44.0, 241.0, 81.0, 111.0, 130.0, 50.0, 24.0, 118.0, 46.0, 57.0, 66.0, 126.0, 187.0, 4.0, 33.0, 90.0, 73.0, 0.0, -26.0, 136.0, 157.0, 254.0, 299.0, 125.0, 46.0, 137.0, 65.0, 165.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-23.0, -34.0, 134.0, 0.0, -81.0, -122.0, -28.0, 109.0, -70.0, 94.0, 0.0, -46.0, 31.0, 70.0, 55.0, 34.0, -126.0, -151.0, -22.0, -10.0, 51.0, 70.0, 77.0, 60.0, -20.0, 138.0, 14.0, -3.0, 0.0, -137.0, -84.0, 52.0, 66.0, -135.0, -96.0, -130.0, -196.0, -101.0, 105.0, -58.0, -34.0, 196.0, 116.0, -35.0, 35.0, 36.0, -112.0, 68.0, 180.0, 82.0, 78.0, 94.0, 0.0, -94.0, -26.0, 65.0, 138.0, 160.0, -39.0, -120.0, 20.0, -136.0, 68.0, -13.0, 0.0, -84.0, -187.0, -80.0, -83.0, -20.0, -51.0, -42.0, 0.0, 0.0, -1.0, -112.0, 168.0, 143.0, -64.0, 32.0, -144.0, 0.0, -200.0, -124.0, 16.0, 0.0, 0.0, -200.0, -2.0, 21.0, 0.0, 122.0, 33.0, 0.0, -3.0, 126.0, 5.0, 73.0, -120.0, 0.0, 0.0, 0.0, 14.0, 0.0, -99.0, -28.0, 0.0, -29.0, -106.0, -88.0, 0.0, -78.0, -120.0, -74.0, -40.0, -84.0, -163.0, -116.0, -6.0, -45.0, -150.0, -2.0, -142.0, -191.0, -74.0, -75.0, 0.0, -136.0, -101.0, -100.0, -70.0, -182.0, -154.0, 11.0, -161.0, -138.0, -99.0, -65.0, -129.0, -142.0, -104.0, -123.0, 59.0, 0.0, -148.0, 0.0, 101.0, -147.0, 7.0, -95.0, 28.0, -140.0, 14.0, 18.0, -55.0, -96.0, -172.0, -44.0, 0.0, -107.0, -93.0, -200.0, 0.0, 0.0, -200.0, 0.0, 0.0, 10.0, -4.0, 72.0, 0.0, -26.0, -172.0, -56.0, 15.0, -26.0, 0.0, -127.0, 0.0, 0.0, -90.0, -126.0, -121.0, 65.0, 54.0, 3.0, 70.0, -190.0, 139.0, -193.0, -48.0, -65.0, 0.0, 46.0, 21.0, -111.0, -167.0, -1.0, -7.0, -158.0], "policy_predator_policy_reward": [101.0, 105.0, 33.0, 1.0, 169.0, 141.0, 59.0, 73.0, 128.0, 101.0, 92.0, 32.0, 22.0, 66.0, 100.0, 61.0, 153.0, 169.0, 62.0, 97.0, 58.0, 77.0, 65.0, 36.0, 93.0, 87.0, 83.0, 55.0, 145.0, 78.0, 100.0, 135.0, 170.0, 112.0, 168.0, 92.0, 116.0, 180.0, 67.0, 115.0, 55.0, 42.0, 67.0, 145.0, 67.0, 80.0, 87.0, 145.0, 66.0, 39.0, 57.0, 3.0, 128.0, 27.0, 16.0, 49.0, 41.0, 13.0, 56.0, 123.0, 45.0, 168.0, 43.0, 64.0, 124.0, 25.0, 38.0, 191.0, 104.0, 56.0, 4.0, 109.0, 0.0, 0.0, 37.0, 136.0, 16.0, 8.0, 29.0, 118.0, 88.0, 115.0, 200.0, 70.0, 0.0, 0.0, 194.0, 123.0, 3.0, 83.0, 13.0, 33.0, 63.0, 19.0, 38.0, 0.0, 39.0, 87.0, 158.0, 9.0, 0.0, 0.0, 31.0, 72.0, 153.0, 36.0, 37.0, 64.0, 15.0, 146.0, 31.0, 89.0, 5.0, 172.0, 59.0, 122.0, 173.0, 65.0, 32.0, 121.0, 144.0, 126.0, 191.0, 178.0, 109.0, 59.0, 77.0, 112.0, 9.0, 147.0, 128.0, 197.0, 55.0, 156.0, 176.0, 156.0, 126.0, 90.0, 138.0, 170.0, 76.0, 164.0, 62.0, 0.0, 108.0, 84.0, 134.0, 153.0, 144.0, 25.0, 188.0, 35.0, 96.0, 2.0, 68.0, 133.0, 66.0, 174.0, 118.0, 107.0, 199.0, 140.0, 44.0, 13.0, 66.0, 200.0, 50.0, 66.0, 8.0, 111.0, 30.0, 0.0, 89.0, 172.0, 59.0, 42.0, 85.0, 115.0, 0.0, 0.0, 157.0, 33.0, 131.0, 61.0, 15.0, 85.0, 179.0, 195.0, 165.0, 188.0, 104.0, 134.0, 0.0, 0.0, 100.0, 127.0, 140.0, 93.0, 160.0, 170.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5769484964085099, "mean_inference_ms": 1.311274081150061, "mean_action_processing_ms": 0.22788247162065378, "mean_env_wait_ms": 0.17101313541326918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004267215728759766, "StateBufferConnector_ms": 0.0031867027282714844, "ViewRequirementAgentConnector_ms": 0.09678804874420166}, "num_episodes": 22, "episode_return_max": 367.0, "episode_return_min": -54.0, "episode_return_mean": 109.67, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.11504667503226, "num_env_steps_trained_throughput_per_sec": 88.11504667503226, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 45445.849, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45445.801, "sample_time_ms": 1096.613, "learn_time_ms": 44332.128, "learn_throughput": 90.228, "synch_weights_time_ms": 14.093}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 54, "trial_id": "51025_00000", "date": "2024-08-12_21-05-11", "timestamp": 1723511111, "time_this_iter_s": 45.447941064834595, "time_total_s": 2463.5881872177124, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1580143a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2463.5881872177124, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 20.74153846153846, "ram_util_percent": 82.34923076923079}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.928473791054317, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.324427605558324, "policy_loss": -0.011231521224829727, "vf_loss": 5.33322791018814, "vf_explained_var": -0.7250753286654357, "kl": 0.008104058953929365, "entropy": 1.1553067132278725, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.031802401466976, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.377692307870855, "policy_loss": -0.00695447257532684, "vf_loss": 6.38371672100491, "vf_explained_var": 0.3084162160833046, "kl": 0.004650276580385749, "entropy": 0.8857894947604528, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 367.0, "episode_reward_min": -54.0, "episode_reward_mean": 86.64, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -200.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 180.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -41.365, "predator_policy": 84.685}, "custom_metrics": {}, "hist_stats": {"episode_reward": [188.0, 367.0, 232.0, 61.0, 104.0, 352.0, 20.0, 97.0, 162.0, 65.0, -38.0, 57.0, 20.0, 0.0, 60.0, 335.0, 115.0, 59.0, -54.0, 16.0, 117.0, 105.0, 168.0, 115.0, 161.0, 204.0, 47.0, 0.0, 117.0, 62.0, 72.0, -33.0, 42.0, -17.0, 57.0, -41.0, 102.0, 118.0, 36.0, 19.0, 53.0, -45.0, 73.0, 68.0, 33.0, 52.0, 37.0, 13.0, 121.0, 44.0, 241.0, 81.0, 111.0, 130.0, 50.0, 24.0, 118.0, 46.0, 57.0, 66.0, 126.0, 187.0, 4.0, 33.0, 90.0, 73.0, 0.0, -26.0, 136.0, 157.0, 254.0, 299.0, 125.0, 46.0, 137.0, 65.0, 165.0, 26.0, 61.0, 87.0, 42.0, 69.0, 26.0, 169.0, 156.0, 0.0, 69.0, 0.0, 46.0, 100.0, -51.0, 98.0, 174.0, 2.0, 133.0, 179.0, 78.0, 118.0, 120.0, 49.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-112.0, 68.0, 180.0, 82.0, 78.0, 94.0, 0.0, -94.0, -26.0, 65.0, 138.0, 160.0, -39.0, -120.0, 20.0, -136.0, 68.0, -13.0, 0.0, -84.0, -187.0, -80.0, -83.0, -20.0, -51.0, -42.0, 0.0, 0.0, -1.0, -112.0, 168.0, 143.0, -64.0, 32.0, -144.0, 0.0, -200.0, -124.0, 16.0, 0.0, 0.0, -200.0, -2.0, 21.0, 0.0, 122.0, 33.0, 0.0, -3.0, 126.0, 5.0, 73.0, -120.0, 0.0, 0.0, 0.0, 14.0, 0.0, -99.0, -28.0, 0.0, -29.0, -106.0, -88.0, 0.0, -78.0, -120.0, -74.0, -40.0, -84.0, -163.0, -116.0, -6.0, -45.0, -150.0, -2.0, -142.0, -191.0, -74.0, -75.0, 0.0, -136.0, -101.0, -100.0, -70.0, -182.0, -154.0, 11.0, -161.0, -138.0, -99.0, -65.0, -129.0, -142.0, -104.0, -123.0, 59.0, 0.0, -148.0, 0.0, 101.0, -147.0, 7.0, -95.0, 28.0, -140.0, 14.0, 18.0, -55.0, -96.0, -172.0, -44.0, 0.0, -107.0, -93.0, -200.0, 0.0, 0.0, -200.0, 0.0, 0.0, 10.0, -4.0, 72.0, 0.0, -26.0, -172.0, -56.0, 15.0, -26.0, 0.0, -127.0, 0.0, 0.0, -90.0, -126.0, -121.0, 65.0, 54.0, 3.0, 70.0, -190.0, 139.0, -193.0, -48.0, -65.0, 0.0, 46.0, 21.0, -111.0, -167.0, -1.0, -7.0, -158.0, -174.0, -39.0, -43.0, -38.0, 0.0, 70.0, -48.0, -154.0, -91.0, -27.0, 2.0, 0.0, 0.0, -200.0, 73.0, -46.0, 0.0, 0.0, -47.0, -103.0, 0.0, 0.0, -49.0, -147.0, 0.0, -12.0, -148.0, -114.0, -135.0, -27.0, 16.0, -130.0, -8.0, -197.0, -44.0, 0.0, -66.0, 8.0, 0.0, 55.0, -190.0, 0.0, 0.0, 32.0, 0.0, -35.0], "policy_predator_policy_reward": [87.0, 145.0, 66.0, 39.0, 57.0, 3.0, 128.0, 27.0, 16.0, 49.0, 41.0, 13.0, 56.0, 123.0, 45.0, 168.0, 43.0, 64.0, 124.0, 25.0, 38.0, 191.0, 104.0, 56.0, 4.0, 109.0, 0.0, 0.0, 37.0, 136.0, 16.0, 8.0, 29.0, 118.0, 88.0, 115.0, 200.0, 70.0, 0.0, 0.0, 194.0, 123.0, 3.0, 83.0, 13.0, 33.0, 63.0, 19.0, 38.0, 0.0, 39.0, 87.0, 158.0, 9.0, 0.0, 0.0, 31.0, 72.0, 153.0, 36.0, 37.0, 64.0, 15.0, 146.0, 31.0, 89.0, 5.0, 172.0, 59.0, 122.0, 173.0, 65.0, 32.0, 121.0, 144.0, 126.0, 191.0, 178.0, 109.0, 59.0, 77.0, 112.0, 9.0, 147.0, 128.0, 197.0, 55.0, 156.0, 176.0, 156.0, 126.0, 90.0, 138.0, 170.0, 76.0, 164.0, 62.0, 0.0, 108.0, 84.0, 134.0, 153.0, 144.0, 25.0, 188.0, 35.0, 96.0, 2.0, 68.0, 133.0, 66.0, 174.0, 118.0, 107.0, 199.0, 140.0, 44.0, 13.0, 66.0, 200.0, 50.0, 66.0, 8.0, 111.0, 30.0, 0.0, 89.0, 172.0, 59.0, 42.0, 85.0, 115.0, 0.0, 0.0, 157.0, 33.0, 131.0, 61.0, 15.0, 85.0, 179.0, 195.0, 165.0, 188.0, 104.0, 134.0, 0.0, 0.0, 100.0, 127.0, 140.0, 93.0, 160.0, 170.0, 81.0, 158.0, 40.0, 102.0, 0.0, 17.0, 170.0, 74.0, 91.0, 96.0, 24.0, 0.0, 190.0, 179.0, 60.0, 69.0, 0.0, 0.0, 149.0, 70.0, 0.0, 0.0, 178.0, 64.0, 15.0, 97.0, 36.0, 175.0, 152.0, 108.0, 180.0, 108.0, 64.0, 143.0, 91.0, 86.0, 166.0, 71.0, 0.0, 23.0, 181.0, 127.0, 4.0, 84.0, 46.0, 38.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5768774108887224, "mean_inference_ms": 1.3102736063425338, "mean_action_processing_ms": 0.22784200372647695, "mean_env_wait_ms": 0.17099309747508176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037354230880737305, "StateBufferConnector_ms": 0.0032995939254760742, "ViewRequirementAgentConnector_ms": 0.09907376766204834}, "num_episodes": 23, "episode_return_max": 367.0, "episode_return_min": -54.0, "episode_return_mean": 86.64, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.63142230380154, "num_env_steps_trained_throughput_per_sec": 88.63142230380154, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 45394.52, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45394.474, "sample_time_ms": 1086.404, "learn_time_ms": 44290.66, "learn_throughput": 90.312, "synch_weights_time_ms": 14.255}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 55, "trial_id": "51025_00000", "date": "2024-08-12_21-05-56", "timestamp": 1723511156, "time_this_iter_s": 45.18201398849487, "time_total_s": 2508.7702012062073, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x15800ddc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2508.7702012062073, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 20.299999999999997, "ram_util_percent": 82.396875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.682852673593652, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.483829487820782, "policy_loss": -0.014381603408412682, "vf_loss": 5.495319498909844, "vf_explained_var": -0.8195760201524805, "kl": 0.009638620486071482, "entropy": 1.1362140062624815, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.026475650292856, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.2695054649675965, "policy_loss": -0.009792821890078287, "vf_loss": 7.278564943081488, "vf_explained_var": 0.2537215379180101, "kl": 0.0073334766209035285, "entropy": 0.9161914187764365, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 299.0, "episode_reward_min": -54.0, "episode_reward_mean": 81.11, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -200.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 139.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -45.75, "predator_policy": 86.305}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.0, 16.0, 117.0, 105.0, 168.0, 115.0, 161.0, 204.0, 47.0, 0.0, 117.0, 62.0, 72.0, -33.0, 42.0, -17.0, 57.0, -41.0, 102.0, 118.0, 36.0, 19.0, 53.0, -45.0, 73.0, 68.0, 33.0, 52.0, 37.0, 13.0, 121.0, 44.0, 241.0, 81.0, 111.0, 130.0, 50.0, 24.0, 118.0, 46.0, 57.0, 66.0, 126.0, 187.0, 4.0, 33.0, 90.0, 73.0, 0.0, -26.0, 136.0, 157.0, 254.0, 299.0, 125.0, 46.0, 137.0, 65.0, 165.0, 26.0, 61.0, 87.0, 42.0, 69.0, 26.0, 169.0, 156.0, 0.0, 69.0, 0.0, 46.0, 100.0, -51.0, 98.0, 174.0, 2.0, 133.0, 179.0, 78.0, 118.0, 120.0, 49.0, 37.0, 76.0, 67.0, 111.0, 107.0, 88.0, 230.0, 75.0, 91.0, 131.0, 22.0, 85.0, 67.0, 193.0, 161.0, 59.0, 28.0, 75.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-200.0, -124.0, 16.0, 0.0, 0.0, -200.0, -2.0, 21.0, 0.0, 122.0, 33.0, 0.0, -3.0, 126.0, 5.0, 73.0, -120.0, 0.0, 0.0, 0.0, 14.0, 0.0, -99.0, -28.0, 0.0, -29.0, -106.0, -88.0, 0.0, -78.0, -120.0, -74.0, -40.0, -84.0, -163.0, -116.0, -6.0, -45.0, -150.0, -2.0, -142.0, -191.0, -74.0, -75.0, 0.0, -136.0, -101.0, -100.0, -70.0, -182.0, -154.0, 11.0, -161.0, -138.0, -99.0, -65.0, -129.0, -142.0, -104.0, -123.0, 59.0, 0.0, -148.0, 0.0, 101.0, -147.0, 7.0, -95.0, 28.0, -140.0, 14.0, 18.0, -55.0, -96.0, -172.0, -44.0, 0.0, -107.0, -93.0, -200.0, 0.0, 0.0, -200.0, 0.0, 0.0, 10.0, -4.0, 72.0, 0.0, -26.0, -172.0, -56.0, 15.0, -26.0, 0.0, -127.0, 0.0, 0.0, -90.0, -126.0, -121.0, 65.0, 54.0, 3.0, 70.0, -190.0, 139.0, -193.0, -48.0, -65.0, 0.0, 46.0, 21.0, -111.0, -167.0, -1.0, -7.0, -158.0, -174.0, -39.0, -43.0, -38.0, 0.0, 70.0, -48.0, -154.0, -91.0, -27.0, 2.0, 0.0, 0.0, -200.0, 73.0, -46.0, 0.0, 0.0, -47.0, -103.0, 0.0, 0.0, -49.0, -147.0, 0.0, -12.0, -148.0, -114.0, -135.0, -27.0, 16.0, -130.0, -8.0, -197.0, -44.0, 0.0, -66.0, 8.0, 0.0, 55.0, -190.0, 0.0, 0.0, 32.0, 0.0, -35.0, -17.0, 0.0, -72.0, -133.0, 0.0, -126.0, 5.0, -84.0, -26.0, -50.0, 5.0, -5.0, -186.0, 101.0, -102.0, 33.0, -8.0, -61.0, -15.0, -17.0, -74.0, 1.0, 0.0, -98.0, 42.0, 0.0, -25.0, 7.0, 84.0, 0.0, -108.0, -2.0, -120.0, 0.0, 62.0, 0.0], "policy_predator_policy_reward": [200.0, 70.0, 0.0, 0.0, 194.0, 123.0, 3.0, 83.0, 13.0, 33.0, 63.0, 19.0, 38.0, 0.0, 39.0, 87.0, 158.0, 9.0, 0.0, 0.0, 31.0, 72.0, 153.0, 36.0, 37.0, 64.0, 15.0, 146.0, 31.0, 89.0, 5.0, 172.0, 59.0, 122.0, 173.0, 65.0, 32.0, 121.0, 144.0, 126.0, 191.0, 178.0, 109.0, 59.0, 77.0, 112.0, 9.0, 147.0, 128.0, 197.0, 55.0, 156.0, 176.0, 156.0, 126.0, 90.0, 138.0, 170.0, 76.0, 164.0, 62.0, 0.0, 108.0, 84.0, 134.0, 153.0, 144.0, 25.0, 188.0, 35.0, 96.0, 2.0, 68.0, 133.0, 66.0, 174.0, 118.0, 107.0, 199.0, 140.0, 44.0, 13.0, 66.0, 200.0, 50.0, 66.0, 8.0, 111.0, 30.0, 0.0, 89.0, 172.0, 59.0, 42.0, 85.0, 115.0, 0.0, 0.0, 157.0, 33.0, 131.0, 61.0, 15.0, 85.0, 179.0, 195.0, 165.0, 188.0, 104.0, 134.0, 0.0, 0.0, 100.0, 127.0, 140.0, 93.0, 160.0, 170.0, 81.0, 158.0, 40.0, 102.0, 0.0, 17.0, 170.0, 74.0, 91.0, 96.0, 24.0, 0.0, 190.0, 179.0, 60.0, 69.0, 0.0, 0.0, 149.0, 70.0, 0.0, 0.0, 178.0, 64.0, 15.0, 97.0, 36.0, 175.0, 152.0, 108.0, 180.0, 108.0, 64.0, 143.0, 91.0, 86.0, 166.0, 71.0, 0.0, 23.0, 181.0, 127.0, 4.0, 84.0, 46.0, 38.0, 52.0, 2.0, 184.0, 97.0, 61.0, 132.0, 52.0, 138.0, 68.0, 115.0, 65.0, 23.0, 180.0, 135.0, 139.0, 5.0, 92.0, 68.0, 106.0, 57.0, 18.0, 77.0, 137.0, 46.0, 25.0, 0.0, 132.0, 79.0, 27.0, 50.0, 40.0, 129.0, 109.0, 39.0, 11.0, 2.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5767605992749266, "mean_inference_ms": 1.3095195526337902, "mean_action_processing_ms": 0.2278142315017605, "mean_env_wait_ms": 0.1709651047910571, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038967132568359375, "StateBufferConnector_ms": 0.003283977508544922, "ViewRequirementAgentConnector_ms": 0.102181077003479}, "num_episodes": 18, "episode_return_max": 299.0, "episode_return_min": -54.0, "episode_return_mean": 81.11, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.70142349068847, "num_env_steps_trained_throughput_per_sec": 88.70142349068847, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 45308.855, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45308.807, "sample_time_ms": 1084.263, "learn_time_ms": 44207.046, "learn_throughput": 90.483, "synch_weights_time_ms": 14.298}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 56, "trial_id": "51025_00000", "date": "2024-08-12_21-06-41", "timestamp": 1723511201, "time_this_iter_s": 45.17776679992676, "time_total_s": 2553.947968006134, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158076dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2553.947968006134, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 20.8828125, "ram_util_percent": 82.72343749999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.705026979862698, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.216394479186446, "policy_loss": -0.014177240968420707, "vf_loss": 5.228414258124336, "vf_explained_var": -0.14565187926014894, "kl": 0.007191503204677103, "entropy": 1.144000230769001, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.09563796331012, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.474574302239393, "policy_loss": -0.009133688074403576, "vf_loss": 5.482881357808592, "vf_explained_var": 0.22897924916454093, "kl": 0.008266299488373556, "entropy": 0.8411302259990148, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 299.0, "episode_reward_min": -51.0, "episode_reward_mean": 93.81, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -200.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 139.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -39.755, "predator_policy": 86.66}, "custom_metrics": {}, "hist_stats": {"episode_reward": [102.0, 118.0, 36.0, 19.0, 53.0, -45.0, 73.0, 68.0, 33.0, 52.0, 37.0, 13.0, 121.0, 44.0, 241.0, 81.0, 111.0, 130.0, 50.0, 24.0, 118.0, 46.0, 57.0, 66.0, 126.0, 187.0, 4.0, 33.0, 90.0, 73.0, 0.0, -26.0, 136.0, 157.0, 254.0, 299.0, 125.0, 46.0, 137.0, 65.0, 165.0, 26.0, 61.0, 87.0, 42.0, 69.0, 26.0, 169.0, 156.0, 0.0, 69.0, 0.0, 46.0, 100.0, -51.0, 98.0, 174.0, 2.0, 133.0, 179.0, 78.0, 118.0, 120.0, 49.0, 37.0, 76.0, 67.0, 111.0, 107.0, 88.0, 230.0, 75.0, 91.0, 131.0, 22.0, 85.0, 67.0, 193.0, 161.0, 59.0, 28.0, 75.0, 84.0, 270.0, 0.0, 106.0, 199.0, 263.0, 254.0, 233.0, 39.0, 42.0, 207.0, 29.0, 182.0, 104.0, 59.0, 89.0, 206.0, 42.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.0, -45.0, -150.0, -2.0, -142.0, -191.0, -74.0, -75.0, 0.0, -136.0, -101.0, -100.0, -70.0, -182.0, -154.0, 11.0, -161.0, -138.0, -99.0, -65.0, -129.0, -142.0, -104.0, -123.0, 59.0, 0.0, -148.0, 0.0, 101.0, -147.0, 7.0, -95.0, 28.0, -140.0, 14.0, 18.0, -55.0, -96.0, -172.0, -44.0, 0.0, -107.0, -93.0, -200.0, 0.0, 0.0, -200.0, 0.0, 0.0, 10.0, -4.0, 72.0, 0.0, -26.0, -172.0, -56.0, 15.0, -26.0, 0.0, -127.0, 0.0, 0.0, -90.0, -126.0, -121.0, 65.0, 54.0, 3.0, 70.0, -190.0, 139.0, -193.0, -48.0, -65.0, 0.0, 46.0, 21.0, -111.0, -167.0, -1.0, -7.0, -158.0, -174.0, -39.0, -43.0, -38.0, 0.0, 70.0, -48.0, -154.0, -91.0, -27.0, 2.0, 0.0, 0.0, -200.0, 73.0, -46.0, 0.0, 0.0, -47.0, -103.0, 0.0, 0.0, -49.0, -147.0, 0.0, -12.0, -148.0, -114.0, -135.0, -27.0, 16.0, -130.0, -8.0, -197.0, -44.0, 0.0, -66.0, 8.0, 0.0, 55.0, -190.0, 0.0, 0.0, 32.0, 0.0, -35.0, -17.0, 0.0, -72.0, -133.0, 0.0, -126.0, 5.0, -84.0, -26.0, -50.0, 5.0, -5.0, -186.0, 101.0, -102.0, 33.0, -8.0, -61.0, -15.0, -17.0, -74.0, 1.0, 0.0, -98.0, 42.0, 0.0, -25.0, 7.0, 84.0, 0.0, -108.0, -2.0, -120.0, 0.0, 62.0, 0.0, -26.0, 4.0, 97.0, 103.0, 0.0, -59.0, 55.0, -144.0, 36.0, -44.0, 104.0, 92.0, -91.0, 77.0, -27.0, 137.0, 0.0, -130.0, -159.0, 0.0, -127.0, 64.0, 0.0, -17.0, 35.0, 29.0, -32.0, -20.0, 0.0, -12.0, 0.0, -75.0, 15.0, 113.0, 0.0, -63.0], "policy_predator_policy_reward": [32.0, 121.0, 144.0, 126.0, 191.0, 178.0, 109.0, 59.0, 77.0, 112.0, 9.0, 147.0, 128.0, 197.0, 55.0, 156.0, 176.0, 156.0, 126.0, 90.0, 138.0, 170.0, 76.0, 164.0, 62.0, 0.0, 108.0, 84.0, 134.0, 153.0, 144.0, 25.0, 188.0, 35.0, 96.0, 2.0, 68.0, 133.0, 66.0, 174.0, 118.0, 107.0, 199.0, 140.0, 44.0, 13.0, 66.0, 200.0, 50.0, 66.0, 8.0, 111.0, 30.0, 0.0, 89.0, 172.0, 59.0, 42.0, 85.0, 115.0, 0.0, 0.0, 157.0, 33.0, 131.0, 61.0, 15.0, 85.0, 179.0, 195.0, 165.0, 188.0, 104.0, 134.0, 0.0, 0.0, 100.0, 127.0, 140.0, 93.0, 160.0, 170.0, 81.0, 158.0, 40.0, 102.0, 0.0, 17.0, 170.0, 74.0, 91.0, 96.0, 24.0, 0.0, 190.0, 179.0, 60.0, 69.0, 0.0, 0.0, 149.0, 70.0, 0.0, 0.0, 178.0, 64.0, 15.0, 97.0, 36.0, 175.0, 152.0, 108.0, 180.0, 108.0, 64.0, 143.0, 91.0, 86.0, 166.0, 71.0, 0.0, 23.0, 181.0, 127.0, 4.0, 84.0, 46.0, 38.0, 52.0, 2.0, 184.0, 97.0, 61.0, 132.0, 52.0, 138.0, 68.0, 115.0, 65.0, 23.0, 180.0, 135.0, 139.0, 5.0, 92.0, 68.0, 106.0, 57.0, 18.0, 77.0, 137.0, 46.0, 25.0, 0.0, 132.0, 79.0, 27.0, 50.0, 40.0, 129.0, 109.0, 39.0, 11.0, 2.0, 65.0, 41.0, 59.0, 11.0, 0.0, 59.0, 129.0, 66.0, 111.0, 96.0, 18.0, 49.0, 137.0, 131.0, 86.0, 37.0, 96.0, 73.0, 58.0, 143.0, 104.0, 166.0, 46.0, 0.0, 63.0, 55.0, 102.0, 54.0, 23.0, 48.0, 35.0, 129.0, 34.0, 44.0, 70.0, 35.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5764237723498993, "mean_inference_ms": 1.308520750061673, "mean_action_processing_ms": 0.22774051600173306, "mean_env_wait_ms": 0.17087606991002655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003497600555419922, "StateBufferConnector_ms": 0.003228306770324707, "ViewRequirementAgentConnector_ms": 0.09616351127624512}, "num_episodes": 18, "episode_return_max": 299.0, "episode_return_min": -51.0, "episode_return_mean": 93.81, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 89.62944522026966, "num_env_steps_trained_throughput_per_sec": 89.62944522026966, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 45157.226, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45157.179, "sample_time_ms": 1083.87, "learn_time_ms": 44056.218, "learn_throughput": 90.793, "synch_weights_time_ms": 14.243}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 57, "trial_id": "51025_00000", "date": "2024-08-12_21-07-26", "timestamp": 1723511246, "time_this_iter_s": 44.670122146606445, "time_total_s": 2598.6180901527405, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158b10a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2598.6180901527405, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 19.888888888888886, "ram_util_percent": 82.51269841269838}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.1681475462736906, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.82423763199458, "policy_loss": -0.014028803113153175, "vf_loss": 5.835366715325249, "vf_explained_var": 0.12266965013332468, "kl": 0.009665727546241544, "entropy": 1.163010104244979, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.375624970027378, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.6642902394451164, "policy_loss": -0.006970138075175109, "vf_loss": 5.670227989570174, "vf_explained_var": 0.06955633642812255, "kl": 0.010323951970154541, "entropy": 0.8118659366690923, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 329.0, "episode_reward_min": -51.0, "episode_reward_mean": 103.45, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -353.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.0, "predator_policy": 353.0}, "policy_reward_mean": {"prey_policy": -23.32, "predator_policy": 75.045}, "custom_metrics": {}, "hist_stats": {"episode_reward": [57.0, 66.0, 126.0, 187.0, 4.0, 33.0, 90.0, 73.0, 0.0, -26.0, 136.0, 157.0, 254.0, 299.0, 125.0, 46.0, 137.0, 65.0, 165.0, 26.0, 61.0, 87.0, 42.0, 69.0, 26.0, 169.0, 156.0, 0.0, 69.0, 0.0, 46.0, 100.0, -51.0, 98.0, 174.0, 2.0, 133.0, 179.0, 78.0, 118.0, 120.0, 49.0, 37.0, 76.0, 67.0, 111.0, 107.0, 88.0, 230.0, 75.0, 91.0, 131.0, 22.0, 85.0, 67.0, 193.0, 161.0, 59.0, 28.0, 75.0, 84.0, 270.0, 0.0, 106.0, 199.0, 263.0, 254.0, 233.0, 39.0, 42.0, 207.0, 29.0, 182.0, 104.0, 59.0, 89.0, 206.0, 42.0, 188.0, 183.0, 19.0, 0.0, 70.0, 329.0, 0.0, 189.0, 139.0, 64.0, 194.0, 195.0, 152.0, 234.0, 98.0, -38.0, 103.0, 32.0, 124.0, 111.0, 87.0, 16.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -200.0, 0.0, 0.0, 10.0, -4.0, 72.0, 0.0, -26.0, -172.0, -56.0, 15.0, -26.0, 0.0, -127.0, 0.0, 0.0, -90.0, -126.0, -121.0, 65.0, 54.0, 3.0, 70.0, -190.0, 139.0, -193.0, -48.0, -65.0, 0.0, 46.0, 21.0, -111.0, -167.0, -1.0, -7.0, -158.0, -174.0, -39.0, -43.0, -38.0, 0.0, 70.0, -48.0, -154.0, -91.0, -27.0, 2.0, 0.0, 0.0, -200.0, 73.0, -46.0, 0.0, 0.0, -47.0, -103.0, 0.0, 0.0, -49.0, -147.0, 0.0, -12.0, -148.0, -114.0, -135.0, -27.0, 16.0, -130.0, -8.0, -197.0, -44.0, 0.0, -66.0, 8.0, 0.0, 55.0, -190.0, 0.0, 0.0, 32.0, 0.0, -35.0, -17.0, 0.0, -72.0, -133.0, 0.0, -126.0, 5.0, -84.0, -26.0, -50.0, 5.0, -5.0, -186.0, 101.0, -102.0, 33.0, -8.0, -61.0, -15.0, -17.0, -74.0, 1.0, 0.0, -98.0, 42.0, 0.0, -25.0, 7.0, 84.0, 0.0, -108.0, -2.0, -120.0, 0.0, 62.0, 0.0, -26.0, 4.0, 97.0, 103.0, 0.0, -59.0, 55.0, -144.0, 36.0, -44.0, 104.0, 92.0, -91.0, 77.0, -27.0, 137.0, 0.0, -130.0, -159.0, 0.0, -127.0, 64.0, 0.0, -17.0, 35.0, 29.0, -32.0, -20.0, 0.0, -12.0, 0.0, -75.0, 15.0, 113.0, 0.0, -63.0, 13.0, -60.0, -34.0, 38.0, -7.0, -93.0, 0.0, 0.0, 0.0, 26.0, 123.0, 123.0, 0.0, 0.0, -133.0, 44.0, 44.0, -16.0, -23.0, -2.0, -353.0, 194.0, 178.0, -39.0, 9.0, 37.0, 46.0, 147.0, 3.0, -129.0, -126.0, -153.0, 0.0, -5.0, -64.0, -56.0, 0.0, 18.0, 54.0, 0.0, 50.0, 0.0, 0.0, -15.0], "policy_predator_policy_reward": [44.0, 13.0, 66.0, 200.0, 50.0, 66.0, 8.0, 111.0, 30.0, 0.0, 89.0, 172.0, 59.0, 42.0, 85.0, 115.0, 0.0, 0.0, 157.0, 33.0, 131.0, 61.0, 15.0, 85.0, 179.0, 195.0, 165.0, 188.0, 104.0, 134.0, 0.0, 0.0, 100.0, 127.0, 140.0, 93.0, 160.0, 170.0, 81.0, 158.0, 40.0, 102.0, 0.0, 17.0, 170.0, 74.0, 91.0, 96.0, 24.0, 0.0, 190.0, 179.0, 60.0, 69.0, 0.0, 0.0, 149.0, 70.0, 0.0, 0.0, 178.0, 64.0, 15.0, 97.0, 36.0, 175.0, 152.0, 108.0, 180.0, 108.0, 64.0, 143.0, 91.0, 86.0, 166.0, 71.0, 0.0, 23.0, 181.0, 127.0, 4.0, 84.0, 46.0, 38.0, 52.0, 2.0, 184.0, 97.0, 61.0, 132.0, 52.0, 138.0, 68.0, 115.0, 65.0, 23.0, 180.0, 135.0, 139.0, 5.0, 92.0, 68.0, 106.0, 57.0, 18.0, 77.0, 137.0, 46.0, 25.0, 0.0, 132.0, 79.0, 27.0, 50.0, 40.0, 129.0, 109.0, 39.0, 11.0, 2.0, 65.0, 41.0, 59.0, 11.0, 0.0, 59.0, 129.0, 66.0, 111.0, 96.0, 18.0, 49.0, 137.0, 131.0, 86.0, 37.0, 96.0, 73.0, 58.0, 143.0, 104.0, 166.0, 46.0, 0.0, 63.0, 55.0, 102.0, 54.0, 23.0, 48.0, 35.0, 129.0, 34.0, 44.0, 70.0, 35.0, 138.0, 97.0, 68.0, 111.0, 63.0, 56.0, 0.0, 0.0, 27.0, 17.0, 43.0, 40.0, 0.0, 0.0, 152.0, 126.0, 77.0, 34.0, 64.0, 25.0, 0.0, 353.0, 56.0, 0.0, 61.0, 45.0, 6.0, 35.0, 121.0, 103.0, 182.0, 59.0, 67.0, 41.0, 65.0, 87.0, 30.0, 76.0, 8.0, 49.0, 0.0, 37.0, 14.0, 17.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5759959536454425, "mean_inference_ms": 1.3063832537891564, "mean_action_processing_ms": 0.2275174936237343, "mean_env_wait_ms": 0.17066776150984608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035349130630493164, "StateBufferConnector_ms": 0.0032455921173095703, "ViewRequirementAgentConnector_ms": 0.09651386737823486}, "num_episodes": 22, "episode_return_max": 329.0, "episode_return_min": -51.0, "episode_return_mean": 103.45, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 87.63284919536692, "num_env_steps_trained_throughput_per_sec": 87.63284919536692, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 45193.402, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45193.353, "sample_time_ms": 1077.358, "learn_time_ms": 44099.218, "learn_throughput": 90.705, "synch_weights_time_ms": 14.052}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 58, "trial_id": "51025_00000", "date": "2024-08-12_21-08-12", "timestamp": 1723511292, "time_this_iter_s": 45.68394899368286, "time_total_s": 2644.3020391464233, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x15800ddc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2644.3020391464233, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 20.75625, "ram_util_percent": 82.9890625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.43110355006324, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.210345989560324, "policy_loss": -0.013507476480056842, "vf_loss": 6.22134320849464, "vf_explained_var": 0.3475468242294574, "kl": 0.00836756415523223, "entropy": 1.1621872944175882, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.353229718611985, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.578273940464807, "policy_loss": -0.00849056638107098, "vf_loss": 5.585852949203007, "vf_explained_var": 0.1031435802500084, "kl": 0.009115642306594136, "entropy": 0.8642279106788534, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "env_runners": {"episode_reward_max": 354.0, "episode_reward_min": -51.0, "episode_reward_mean": 113.54, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -353.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.0, "predator_policy": 353.0}, "policy_reward_mean": {"prey_policy": -10.26, "predator_policy": 67.03}, "custom_metrics": {}, "hist_stats": {"episode_reward": [165.0, 26.0, 61.0, 87.0, 42.0, 69.0, 26.0, 169.0, 156.0, 0.0, 69.0, 0.0, 46.0, 100.0, -51.0, 98.0, 174.0, 2.0, 133.0, 179.0, 78.0, 118.0, 120.0, 49.0, 37.0, 76.0, 67.0, 111.0, 107.0, 88.0, 230.0, 75.0, 91.0, 131.0, 22.0, 85.0, 67.0, 193.0, 161.0, 59.0, 28.0, 75.0, 84.0, 270.0, 0.0, 106.0, 199.0, 263.0, 254.0, 233.0, 39.0, 42.0, 207.0, 29.0, 182.0, 104.0, 59.0, 89.0, 206.0, 42.0, 188.0, 183.0, 19.0, 0.0, 70.0, 329.0, 0.0, 189.0, 139.0, 64.0, 194.0, 195.0, 152.0, 234.0, 98.0, -38.0, 103.0, 32.0, 124.0, 111.0, 87.0, 16.0, 31.0, 183.0, 252.0, 354.0, 236.0, 244.0, 168.0, 65.0, 144.0, 353.0, 176.0, 72.0, 136.0, 230.0, 0.0, 76.0, 90.0, 28.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-7.0, -158.0, -174.0, -39.0, -43.0, -38.0, 0.0, 70.0, -48.0, -154.0, -91.0, -27.0, 2.0, 0.0, 0.0, -200.0, 73.0, -46.0, 0.0, 0.0, -47.0, -103.0, 0.0, 0.0, -49.0, -147.0, 0.0, -12.0, -148.0, -114.0, -135.0, -27.0, 16.0, -130.0, -8.0, -197.0, -44.0, 0.0, -66.0, 8.0, 0.0, 55.0, -190.0, 0.0, 0.0, 32.0, 0.0, -35.0, -17.0, 0.0, -72.0, -133.0, 0.0, -126.0, 5.0, -84.0, -26.0, -50.0, 5.0, -5.0, -186.0, 101.0, -102.0, 33.0, -8.0, -61.0, -15.0, -17.0, -74.0, 1.0, 0.0, -98.0, 42.0, 0.0, -25.0, 7.0, 84.0, 0.0, -108.0, -2.0, -120.0, 0.0, 62.0, 0.0, -26.0, 4.0, 97.0, 103.0, 0.0, -59.0, 55.0, -144.0, 36.0, -44.0, 104.0, 92.0, -91.0, 77.0, -27.0, 137.0, 0.0, -130.0, -159.0, 0.0, -127.0, 64.0, 0.0, -17.0, 35.0, 29.0, -32.0, -20.0, 0.0, -12.0, 0.0, -75.0, 15.0, 113.0, 0.0, -63.0, 13.0, -60.0, -34.0, 38.0, -7.0, -93.0, 0.0, 0.0, 0.0, 26.0, 123.0, 123.0, 0.0, 0.0, -133.0, 44.0, 44.0, -16.0, -23.0, -2.0, -353.0, 194.0, 178.0, -39.0, 9.0, 37.0, 46.0, 147.0, 3.0, -129.0, -126.0, -153.0, 0.0, -5.0, -64.0, -56.0, 0.0, 18.0, 54.0, 0.0, 50.0, 0.0, 0.0, -15.0, -30.0, 0.0, 174.0, -46.0, 7.0, 169.0, 179.0, 153.0, 186.0, -84.0, -58.0, 170.0, 60.0, -6.0, 0.0, -36.0, -3.0, 96.0, 150.0, 177.0, 58.0, 56.0, -71.0, 0.0, 10.0, -68.0, -10.0, 153.0, 0.0, 0.0, 34.0, -17.0, 0.0, 45.0, -6.0, -58.0], "policy_predator_policy_reward": [160.0, 170.0, 81.0, 158.0, 40.0, 102.0, 0.0, 17.0, 170.0, 74.0, 91.0, 96.0, 24.0, 0.0, 190.0, 179.0, 60.0, 69.0, 0.0, 0.0, 149.0, 70.0, 0.0, 0.0, 178.0, 64.0, 15.0, 97.0, 36.0, 175.0, 152.0, 108.0, 180.0, 108.0, 64.0, 143.0, 91.0, 86.0, 166.0, 71.0, 0.0, 23.0, 181.0, 127.0, 4.0, 84.0, 46.0, 38.0, 52.0, 2.0, 184.0, 97.0, 61.0, 132.0, 52.0, 138.0, 68.0, 115.0, 65.0, 23.0, 180.0, 135.0, 139.0, 5.0, 92.0, 68.0, 106.0, 57.0, 18.0, 77.0, 137.0, 46.0, 25.0, 0.0, 132.0, 79.0, 27.0, 50.0, 40.0, 129.0, 109.0, 39.0, 11.0, 2.0, 65.0, 41.0, 59.0, 11.0, 0.0, 59.0, 129.0, 66.0, 111.0, 96.0, 18.0, 49.0, 137.0, 131.0, 86.0, 37.0, 96.0, 73.0, 58.0, 143.0, 104.0, 166.0, 46.0, 0.0, 63.0, 55.0, 102.0, 54.0, 23.0, 48.0, 35.0, 129.0, 34.0, 44.0, 70.0, 35.0, 138.0, 97.0, 68.0, 111.0, 63.0, 56.0, 0.0, 0.0, 27.0, 17.0, 43.0, 40.0, 0.0, 0.0, 152.0, 126.0, 77.0, 34.0, 64.0, 25.0, 0.0, 353.0, 56.0, 0.0, 61.0, 45.0, 6.0, 35.0, 121.0, 103.0, 182.0, 59.0, 67.0, 41.0, 65.0, 87.0, 30.0, 76.0, 8.0, 49.0, 0.0, 37.0, 14.0, 17.0, 19.0, 42.0, 7.0, 48.0, 43.0, 33.0, 15.0, 7.0, 80.0, 54.0, 66.0, 66.0, 48.0, 66.0, 33.0, 68.0, 41.0, 10.0, 9.0, 17.0, 24.0, 38.0, 71.0, 72.0, 94.0, 100.0, 40.0, 47.0, 0.0, 0.0, 47.0, 12.0, 15.0, 30.0, 72.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5757119623313517, "mean_inference_ms": 1.3059256648618227, "mean_action_processing_ms": 0.2274973851434576, "mean_env_wait_ms": 0.1705741092274799, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003632664680480957, "StateBufferConnector_ms": 0.003104686737060547, "ViewRequirementAgentConnector_ms": 0.09770333766937256}, "num_episodes": 18, "episode_return_max": 354.0, "episode_return_min": -51.0, "episode_return_mean": 113.54, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.17455159952264, "num_env_steps_trained_throughput_per_sec": 88.17455159952264, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 45232.12, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45232.071, "sample_time_ms": 1081.384, "learn_time_ms": 44134.209, "learn_throughput": 90.633, "synch_weights_time_ms": 13.912}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "training_iteration": 59, "trial_id": "51025_00000", "date": "2024-08-12_21-08-57", "timestamp": 1723511337, "time_this_iter_s": 45.41334915161133, "time_total_s": 2689.7153882980347, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158b109d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2689.7153882980347, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 20.889230769230767, "ram_util_percent": 82.95384615384616}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.165668250076354, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.397926050771481, "policy_loss": -0.01126964244653998, "vf_loss": 6.406958377676666, "vf_explained_var": 0.4542072699183509, "kl": 0.007457698123988517, "entropy": 1.1823904344013758, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.463168890514073, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.010078799787652, "policy_loss": -0.008861716275063969, "vf_loss": 5.017989615283946, "vf_explained_var": 0.17250950604519516, "kl": 0.00950897600320342, "entropy": 0.8102571596859625, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 366.0, "episode_reward_min": -38.0, "episode_reward_mean": 135.53, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -353.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.0, "predator_policy": 353.0}, "policy_reward_mean": {"prey_policy": 12.195, "predator_policy": 55.57}, "custom_metrics": {}, "hist_stats": {"episode_reward": [49.0, 37.0, 76.0, 67.0, 111.0, 107.0, 88.0, 230.0, 75.0, 91.0, 131.0, 22.0, 85.0, 67.0, 193.0, 161.0, 59.0, 28.0, 75.0, 84.0, 270.0, 0.0, 106.0, 199.0, 263.0, 254.0, 233.0, 39.0, 42.0, 207.0, 29.0, 182.0, 104.0, 59.0, 89.0, 206.0, 42.0, 188.0, 183.0, 19.0, 0.0, 70.0, 329.0, 0.0, 189.0, 139.0, 64.0, 194.0, 195.0, 152.0, 234.0, 98.0, -38.0, 103.0, 32.0, 124.0, 111.0, 87.0, 16.0, 31.0, 183.0, 252.0, 354.0, 236.0, 244.0, 168.0, 65.0, 144.0, 353.0, 176.0, 72.0, 136.0, 230.0, 0.0, 76.0, 90.0, 28.0, 21.0, 173.0, 150.0, 146.0, 226.0, 0.0, 366.0, 338.0, 188.0, 231.0, 166.0, 98.0, 160.0, 339.0, 62.0, 190.0, 22.0, 130.0, 316.0, 276.0, 214.0, 56.0, 198.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -35.0, -17.0, 0.0, -72.0, -133.0, 0.0, -126.0, 5.0, -84.0, -26.0, -50.0, 5.0, -5.0, -186.0, 101.0, -102.0, 33.0, -8.0, -61.0, -15.0, -17.0, -74.0, 1.0, 0.0, -98.0, 42.0, 0.0, -25.0, 7.0, 84.0, 0.0, -108.0, -2.0, -120.0, 0.0, 62.0, 0.0, -26.0, 4.0, 97.0, 103.0, 0.0, -59.0, 55.0, -144.0, 36.0, -44.0, 104.0, 92.0, -91.0, 77.0, -27.0, 137.0, 0.0, -130.0, -159.0, 0.0, -127.0, 64.0, 0.0, -17.0, 35.0, 29.0, -32.0, -20.0, 0.0, -12.0, 0.0, -75.0, 15.0, 113.0, 0.0, -63.0, 13.0, -60.0, -34.0, 38.0, -7.0, -93.0, 0.0, 0.0, 0.0, 26.0, 123.0, 123.0, 0.0, 0.0, -133.0, 44.0, 44.0, -16.0, -23.0, -2.0, -353.0, 194.0, 178.0, -39.0, 9.0, 37.0, 46.0, 147.0, 3.0, -129.0, -126.0, -153.0, 0.0, -5.0, -64.0, -56.0, 0.0, 18.0, 54.0, 0.0, 50.0, 0.0, 0.0, -15.0, -30.0, 0.0, 174.0, -46.0, 7.0, 169.0, 179.0, 153.0, 186.0, -84.0, -58.0, 170.0, 60.0, -6.0, 0.0, -36.0, -3.0, 96.0, 150.0, 177.0, 58.0, 56.0, -71.0, 0.0, 10.0, -68.0, -10.0, 153.0, 0.0, 0.0, 34.0, -17.0, 0.0, 45.0, -6.0, -58.0, -9.0, -7.0, 0.0, 169.0, 0.0, 107.0, 142.0, 0.0, -32.0, 152.0, 0.0, 0.0, 186.0, 155.0, 105.0, 188.0, 0.0, 187.0, 181.0, -39.0, 0.0, 115.0, -23.0, 42.0, -129.0, 39.0, 167.0, 75.0, -4.0, -83.0, 142.0, -12.0, 0.0, -53.0, 0.0, 63.0, 118.0, 80.0, 28.0, 117.0, 136.0, -4.0, -148.0, -6.0, -9.0, 169.0], "policy_predator_policy_reward": [46.0, 38.0, 52.0, 2.0, 184.0, 97.0, 61.0, 132.0, 52.0, 138.0, 68.0, 115.0, 65.0, 23.0, 180.0, 135.0, 139.0, 5.0, 92.0, 68.0, 106.0, 57.0, 18.0, 77.0, 137.0, 46.0, 25.0, 0.0, 132.0, 79.0, 27.0, 50.0, 40.0, 129.0, 109.0, 39.0, 11.0, 2.0, 65.0, 41.0, 59.0, 11.0, 0.0, 59.0, 129.0, 66.0, 111.0, 96.0, 18.0, 49.0, 137.0, 131.0, 86.0, 37.0, 96.0, 73.0, 58.0, 143.0, 104.0, 166.0, 46.0, 0.0, 63.0, 55.0, 102.0, 54.0, 23.0, 48.0, 35.0, 129.0, 34.0, 44.0, 70.0, 35.0, 138.0, 97.0, 68.0, 111.0, 63.0, 56.0, 0.0, 0.0, 27.0, 17.0, 43.0, 40.0, 0.0, 0.0, 152.0, 126.0, 77.0, 34.0, 64.0, 25.0, 0.0, 353.0, 56.0, 0.0, 61.0, 45.0, 6.0, 35.0, 121.0, 103.0, 182.0, 59.0, 67.0, 41.0, 65.0, 87.0, 30.0, 76.0, 8.0, 49.0, 0.0, 37.0, 14.0, 17.0, 19.0, 42.0, 7.0, 48.0, 43.0, 33.0, 15.0, 7.0, 80.0, 54.0, 66.0, 66.0, 48.0, 66.0, 33.0, 68.0, 41.0, 10.0, 9.0, 17.0, 24.0, 38.0, 71.0, 72.0, 94.0, 100.0, 40.0, 47.0, 0.0, 0.0, 47.0, 12.0, 15.0, 30.0, 72.0, 20.0, 37.0, 0.0, 4.0, 0.0, 6.0, 37.0, 4.0, 0.0, 42.0, 64.0, 0.0, 0.0, 5.0, 20.0, 4.0, 41.0, 0.0, 1.0, 40.0, 49.0, 21.0, 30.0, 49.0, 30.0, 93.0, 157.0, 32.0, 65.0, 67.0, 82.0, 59.0, 1.0, 53.0, 22.0, 67.0, 0.0, 54.0, 64.0, 70.0, 61.0, 71.0, 11.0, 136.0, 74.0, 13.0, 25.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5755056323055873, "mean_inference_ms": 1.3045265714102834, "mean_action_processing_ms": 0.22736625027209567, "mean_env_wait_ms": 0.1704473848666132, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003930926322937012, "StateBufferConnector_ms": 0.003203153610229492, "ViewRequirementAgentConnector_ms": 0.10038578510284424}, "num_episodes": 23, "episode_return_max": 366.0, "episode_return_min": -38.0, "episode_return_mean": 135.53, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.64982178640369, "num_env_steps_trained_throughput_per_sec": 88.64982178640369, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 45230.851, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45230.803, "sample_time_ms": 1075.483, "learn_time_ms": 44138.539, "learn_throughput": 90.624, "synch_weights_time_ms": 14.21}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 60, "trial_id": "51025_00000", "date": "2024-08-12_21-09-42", "timestamp": 1723511382, "time_this_iter_s": 45.16602396965027, "time_total_s": 2734.881412267685, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158062700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2734.881412267685, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 20.4859375, "ram_util_percent": 82.9078125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.870668430240066, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.380442548933483, "policy_loss": -0.011963764438652014, "vf_loss": 7.389702814344376, "vf_explained_var": 0.5430075297595331, "kl": 0.009011657418858704, "entropy": 1.1530270196773387, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.53499322076323, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.380351175013043, "policy_loss": -0.009875556263363077, "vf_loss": 2.389464106193926, "vf_explained_var": 0.24960636550156529, "kl": 0.0076262332017437645, "entropy": 0.7326271490445213, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "env_runners": {"episode_reward_max": 387.0, "episode_reward_min": -38.0, "episode_reward_mean": 162.96, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -353.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 353.0}, "policy_reward_mean": {"prey_policy": 36.43, "predator_policy": 45.05}, "custom_metrics": {}, "hist_stats": {"episode_reward": [75.0, 84.0, 270.0, 0.0, 106.0, 199.0, 263.0, 254.0, 233.0, 39.0, 42.0, 207.0, 29.0, 182.0, 104.0, 59.0, 89.0, 206.0, 42.0, 188.0, 183.0, 19.0, 0.0, 70.0, 329.0, 0.0, 189.0, 139.0, 64.0, 194.0, 195.0, 152.0, 234.0, 98.0, -38.0, 103.0, 32.0, 124.0, 111.0, 87.0, 16.0, 31.0, 183.0, 252.0, 354.0, 236.0, 244.0, 168.0, 65.0, 144.0, 353.0, 176.0, 72.0, 136.0, 230.0, 0.0, 76.0, 90.0, 28.0, 21.0, 173.0, 150.0, 146.0, 226.0, 0.0, 366.0, 338.0, 188.0, 231.0, 166.0, 98.0, 160.0, 339.0, 62.0, 190.0, 22.0, 130.0, 316.0, 276.0, 214.0, 56.0, 198.0, 177.0, 2.0, 295.0, 286.0, 311.0, 197.0, 331.0, 178.0, 370.0, 15.0, 238.0, 166.0, 191.0, 302.0, 387.0, 258.0, 372.0, 344.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [62.0, 0.0, -26.0, 4.0, 97.0, 103.0, 0.0, -59.0, 55.0, -144.0, 36.0, -44.0, 104.0, 92.0, -91.0, 77.0, -27.0, 137.0, 0.0, -130.0, -159.0, 0.0, -127.0, 64.0, 0.0, -17.0, 35.0, 29.0, -32.0, -20.0, 0.0, -12.0, 0.0, -75.0, 15.0, 113.0, 0.0, -63.0, 13.0, -60.0, -34.0, 38.0, -7.0, -93.0, 0.0, 0.0, 0.0, 26.0, 123.0, 123.0, 0.0, 0.0, -133.0, 44.0, 44.0, -16.0, -23.0, -2.0, -353.0, 194.0, 178.0, -39.0, 9.0, 37.0, 46.0, 147.0, 3.0, -129.0, -126.0, -153.0, 0.0, -5.0, -64.0, -56.0, 0.0, 18.0, 54.0, 0.0, 50.0, 0.0, 0.0, -15.0, -30.0, 0.0, 174.0, -46.0, 7.0, 169.0, 179.0, 153.0, 186.0, -84.0, -58.0, 170.0, 60.0, -6.0, 0.0, -36.0, -3.0, 96.0, 150.0, 177.0, 58.0, 56.0, -71.0, 0.0, 10.0, -68.0, -10.0, 153.0, 0.0, 0.0, 34.0, -17.0, 0.0, 45.0, -6.0, -58.0, -9.0, -7.0, 0.0, 169.0, 0.0, 107.0, 142.0, 0.0, -32.0, 152.0, 0.0, 0.0, 186.0, 155.0, 105.0, 188.0, 0.0, 187.0, 181.0, -39.0, 0.0, 115.0, -23.0, 42.0, -129.0, 39.0, 167.0, 75.0, -4.0, -83.0, 142.0, -12.0, 0.0, -53.0, 0.0, 63.0, 118.0, 80.0, 28.0, 117.0, 136.0, -4.0, -148.0, -6.0, -9.0, 169.0, 177.0, -5.0, -4.0, -15.0, 69.0, 182.0, 85.0, 158.0, 146.0, 134.0, -4.0, 144.0, 145.0, 148.0, 0.0, 158.0, 139.0, 189.0, -15.0, 2.0, 189.0, -24.0, 110.0, 0.0, -46.0, 191.0, 85.0, 164.0, 188.0, 199.0, 4.0, 197.0, 176.0, 176.0, 159.0, 160.0], "policy_predator_policy_reward": [11.0, 2.0, 65.0, 41.0, 59.0, 11.0, 0.0, 59.0, 129.0, 66.0, 111.0, 96.0, 18.0, 49.0, 137.0, 131.0, 86.0, 37.0, 96.0, 73.0, 58.0, 143.0, 104.0, 166.0, 46.0, 0.0, 63.0, 55.0, 102.0, 54.0, 23.0, 48.0, 35.0, 129.0, 34.0, 44.0, 70.0, 35.0, 138.0, 97.0, 68.0, 111.0, 63.0, 56.0, 0.0, 0.0, 27.0, 17.0, 43.0, 40.0, 0.0, 0.0, 152.0, 126.0, 77.0, 34.0, 64.0, 25.0, 0.0, 353.0, 56.0, 0.0, 61.0, 45.0, 6.0, 35.0, 121.0, 103.0, 182.0, 59.0, 67.0, 41.0, 65.0, 87.0, 30.0, 76.0, 8.0, 49.0, 0.0, 37.0, 14.0, 17.0, 19.0, 42.0, 7.0, 48.0, 43.0, 33.0, 15.0, 7.0, 80.0, 54.0, 66.0, 66.0, 48.0, 66.0, 33.0, 68.0, 41.0, 10.0, 9.0, 17.0, 24.0, 38.0, 71.0, 72.0, 94.0, 100.0, 40.0, 47.0, 0.0, 0.0, 47.0, 12.0, 15.0, 30.0, 72.0, 20.0, 37.0, 0.0, 4.0, 0.0, 6.0, 37.0, 4.0, 0.0, 42.0, 64.0, 0.0, 0.0, 5.0, 20.0, 4.0, 41.0, 0.0, 1.0, 40.0, 49.0, 21.0, 30.0, 49.0, 30.0, 93.0, 157.0, 32.0, 65.0, 67.0, 82.0, 59.0, 1.0, 53.0, 22.0, 67.0, 0.0, 54.0, 64.0, 70.0, 61.0, 71.0, 11.0, 136.0, 74.0, 13.0, 25.0, 5.0, 0.0, 0.0, 21.0, 24.0, 20.0, 12.0, 31.0, 31.0, 0.0, 37.0, 20.0, 0.0, 38.0, 16.0, 4.0, 24.0, 18.0, 28.0, 0.0, 35.0, 38.0, 24.0, 32.0, 46.0, 0.0, 0.0, 53.0, 0.0, 0.0, 57.0, 0.0, 0.0, 20.0, 17.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5752921989073109, "mean_inference_ms": 1.3033246553041453, "mean_action_processing_ms": 0.22723446809548753, "mean_env_wait_ms": 0.1703078341982016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003836989402770996, "StateBufferConnector_ms": 0.0031855106353759766, "ViewRequirementAgentConnector_ms": 0.09818720817565918}, "num_episodes": 18, "episode_return_max": 387.0, "episode_return_min": -38.0, "episode_return_mean": 162.96, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 89.21659157518529, "num_env_steps_trained_throughput_per_sec": 89.21659157518529, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 45139.853, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45139.804, "sample_time_ms": 1058.985, "learn_time_ms": 44064.761, "learn_throughput": 90.775, "synch_weights_time_ms": 13.804}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "training_iteration": 61, "trial_id": "51025_00000", "date": "2024-08-12_21-10-27", "timestamp": 1723511427, "time_this_iter_s": 44.88453483581543, "time_total_s": 2779.7659471035004, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cb63ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2779.7659471035004, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 19.88888888888889, "ram_util_percent": 83.19206349206348}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.527519746873745, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.434932397156166, "policy_loss": -0.011810298213395217, "vf_loss": 7.443954860596429, "vf_explained_var": 0.5744638556525821, "kl": 0.009292781672083191, "entropy": 1.1451448540838938, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.52748876488398, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5682211541309559, "policy_loss": -0.0040523477305199895, "vf_loss": 1.5716756981201272, "vf_explained_var": 0.1461342313302257, "kl": 0.005977971795803364, "entropy": 0.7948762740092302, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 387.0, "episode_reward_min": -38.0, "episode_reward_mean": 189.93, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -353.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 353.0}, "policy_reward_mean": {"prey_policy": 57.425, "predator_policy": 37.54}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.0, 188.0, 183.0, 19.0, 0.0, 70.0, 329.0, 0.0, 189.0, 139.0, 64.0, 194.0, 195.0, 152.0, 234.0, 98.0, -38.0, 103.0, 32.0, 124.0, 111.0, 87.0, 16.0, 31.0, 183.0, 252.0, 354.0, 236.0, 244.0, 168.0, 65.0, 144.0, 353.0, 176.0, 72.0, 136.0, 230.0, 0.0, 76.0, 90.0, 28.0, 21.0, 173.0, 150.0, 146.0, 226.0, 0.0, 366.0, 338.0, 188.0, 231.0, 166.0, 98.0, 160.0, 339.0, 62.0, 190.0, 22.0, 130.0, 316.0, 276.0, 214.0, 56.0, 198.0, 177.0, 2.0, 295.0, 286.0, 311.0, 197.0, 331.0, 178.0, 370.0, 15.0, 238.0, 166.0, 191.0, 302.0, 387.0, 258.0, 372.0, 344.0, 351.0, 225.0, 163.0, 343.0, 328.0, 342.0, 322.0, 372.0, 197.0, 218.0, 289.0, 349.0, 350.0, 380.0, 170.0, 192.0, 300.0, 247.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -63.0, 13.0, -60.0, -34.0, 38.0, -7.0, -93.0, 0.0, 0.0, 0.0, 26.0, 123.0, 123.0, 0.0, 0.0, -133.0, 44.0, 44.0, -16.0, -23.0, -2.0, -353.0, 194.0, 178.0, -39.0, 9.0, 37.0, 46.0, 147.0, 3.0, -129.0, -126.0, -153.0, 0.0, -5.0, -64.0, -56.0, 0.0, 18.0, 54.0, 0.0, 50.0, 0.0, 0.0, -15.0, -30.0, 0.0, 174.0, -46.0, 7.0, 169.0, 179.0, 153.0, 186.0, -84.0, -58.0, 170.0, 60.0, -6.0, 0.0, -36.0, -3.0, 96.0, 150.0, 177.0, 58.0, 56.0, -71.0, 0.0, 10.0, -68.0, -10.0, 153.0, 0.0, 0.0, 34.0, -17.0, 0.0, 45.0, -6.0, -58.0, -9.0, -7.0, 0.0, 169.0, 0.0, 107.0, 142.0, 0.0, -32.0, 152.0, 0.0, 0.0, 186.0, 155.0, 105.0, 188.0, 0.0, 187.0, 181.0, -39.0, 0.0, 115.0, -23.0, 42.0, -129.0, 39.0, 167.0, 75.0, -4.0, -83.0, 142.0, -12.0, 0.0, -53.0, 0.0, 63.0, 118.0, 80.0, 28.0, 117.0, 136.0, -4.0, -148.0, -6.0, -9.0, 169.0, 177.0, -5.0, -4.0, -15.0, 69.0, 182.0, 85.0, 158.0, 146.0, 134.0, -4.0, 144.0, 145.0, 148.0, 0.0, 158.0, 139.0, 189.0, -15.0, 2.0, 189.0, -24.0, 110.0, 0.0, -46.0, 191.0, 85.0, 164.0, 188.0, 199.0, 4.0, 197.0, 176.0, 176.0, 159.0, 160.0, 186.0, 159.0, 192.0, -76.0, 0.0, 140.0, 162.0, 160.0, 139.0, 152.0, 152.0, 155.0, 123.0, 110.0, 178.0, 192.0, 138.0, -52.0, 194.0, -18.0, 124.0, 36.0, 146.0, 180.0, 175.0, 151.0, 181.0, 190.0, -4.0, 149.0, 192.0, -5.0, 107.0, 149.0, 140.0, -38.0], "policy_predator_policy_reward": [70.0, 35.0, 138.0, 97.0, 68.0, 111.0, 63.0, 56.0, 0.0, 0.0, 27.0, 17.0, 43.0, 40.0, 0.0, 0.0, 152.0, 126.0, 77.0, 34.0, 64.0, 25.0, 0.0, 353.0, 56.0, 0.0, 61.0, 45.0, 6.0, 35.0, 121.0, 103.0, 182.0, 59.0, 67.0, 41.0, 65.0, 87.0, 30.0, 76.0, 8.0, 49.0, 0.0, 37.0, 14.0, 17.0, 19.0, 42.0, 7.0, 48.0, 43.0, 33.0, 15.0, 7.0, 80.0, 54.0, 66.0, 66.0, 48.0, 66.0, 33.0, 68.0, 41.0, 10.0, 9.0, 17.0, 24.0, 38.0, 71.0, 72.0, 94.0, 100.0, 40.0, 47.0, 0.0, 0.0, 47.0, 12.0, 15.0, 30.0, 72.0, 20.0, 37.0, 0.0, 4.0, 0.0, 6.0, 37.0, 4.0, 0.0, 42.0, 64.0, 0.0, 0.0, 5.0, 20.0, 4.0, 41.0, 0.0, 1.0, 40.0, 49.0, 21.0, 30.0, 49.0, 30.0, 93.0, 157.0, 32.0, 65.0, 67.0, 82.0, 59.0, 1.0, 53.0, 22.0, 67.0, 0.0, 54.0, 64.0, 70.0, 61.0, 71.0, 11.0, 136.0, 74.0, 13.0, 25.0, 5.0, 0.0, 0.0, 21.0, 24.0, 20.0, 12.0, 31.0, 31.0, 0.0, 37.0, 20.0, 0.0, 38.0, 16.0, 4.0, 24.0, 18.0, 28.0, 0.0, 35.0, 38.0, 24.0, 32.0, 46.0, 0.0, 0.0, 53.0, 0.0, 0.0, 57.0, 0.0, 0.0, 20.0, 17.0, 8.0, 1.0, 5.0, 95.0, 14.0, 0.0, 23.0, 15.0, 6.0, 18.0, 19.0, 26.0, 9.0, 44.0, 45.0, 2.0, 0.0, 55.0, 56.0, 24.0, 18.0, 75.0, 54.0, 17.0, 6.0, 19.0, 5.0, 0.0, 9.0, 21.0, 4.0, 0.0, 5.0, 0.0, 44.0, 67.0, 78.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5751101237098806, "mean_inference_ms": 1.3021568209605894, "mean_action_processing_ms": 0.22711730280917572, "mean_env_wait_ms": 0.1701935879536077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040035247802734375, "StateBufferConnector_ms": 0.003180265426635742, "ViewRequirementAgentConnector_ms": 0.09700024127960205}, "num_episodes": 18, "episode_return_max": 387.0, "episode_return_min": -38.0, "episode_return_mean": 189.93, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.10588770294277, "num_env_steps_trained_throughput_per_sec": 88.10588770294277, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 45159.048, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45159.0, "sample_time_ms": 1045.584, "learn_time_ms": 44097.865, "learn_throughput": 90.707, "synch_weights_time_ms": 13.532}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 62, "trial_id": "51025_00000", "date": "2024-08-12_21-11-13", "timestamp": 1723511473, "time_this_iter_s": 45.446959257125854, "time_total_s": 2825.212906360626, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158076ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2825.212906360626, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 20.571875, "ram_util_percent": 82.946875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.767753159684479, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.122799694979632, "policy_loss": -0.011236650922715112, "vf_loss": 8.131021304609915, "vf_explained_var": 0.5700104134108024, "kl": 0.010050138723210056, "entropy": 1.1453810645789697, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.297018272914583, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.930729501966446, "policy_loss": -0.00530001824184582, "vf_loss": 1.9352267411650803, "vf_explained_var": 0.035010553100121716, "kl": 0.00802772444303002, "entropy": 0.718894450626676, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 387.0, "episode_reward_min": 0.0, "episode_reward_mean": 221.91, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -148.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 157.0}, "policy_reward_mean": {"prey_policy": 83.925, "predator_policy": 27.03}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.0, 31.0, 183.0, 252.0, 354.0, 236.0, 244.0, 168.0, 65.0, 144.0, 353.0, 176.0, 72.0, 136.0, 230.0, 0.0, 76.0, 90.0, 28.0, 21.0, 173.0, 150.0, 146.0, 226.0, 0.0, 366.0, 338.0, 188.0, 231.0, 166.0, 98.0, 160.0, 339.0, 62.0, 190.0, 22.0, 130.0, 316.0, 276.0, 214.0, 56.0, 198.0, 177.0, 2.0, 295.0, 286.0, 311.0, 197.0, 331.0, 178.0, 370.0, 15.0, 238.0, 166.0, 191.0, 302.0, 387.0, 258.0, 372.0, 344.0, 351.0, 225.0, 163.0, 343.0, 328.0, 342.0, 322.0, 372.0, 197.0, 218.0, 289.0, 349.0, 350.0, 380.0, 170.0, 192.0, 300.0, 247.0, 175.0, 243.0, 357.0, 343.0, 294.0, 380.0, 172.0, 354.0, 176.0, 15.0, 367.0, 386.0, 197.0, 164.0, 197.0, 373.0, 190.0, 190.0, 339.0, 172.0, 365.0, 264.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -15.0, -30.0, 0.0, 174.0, -46.0, 7.0, 169.0, 179.0, 153.0, 186.0, -84.0, -58.0, 170.0, 60.0, -6.0, 0.0, -36.0, -3.0, 96.0, 150.0, 177.0, 58.0, 56.0, -71.0, 0.0, 10.0, -68.0, -10.0, 153.0, 0.0, 0.0, 34.0, -17.0, 0.0, 45.0, -6.0, -58.0, -9.0, -7.0, 0.0, 169.0, 0.0, 107.0, 142.0, 0.0, -32.0, 152.0, 0.0, 0.0, 186.0, 155.0, 105.0, 188.0, 0.0, 187.0, 181.0, -39.0, 0.0, 115.0, -23.0, 42.0, -129.0, 39.0, 167.0, 75.0, -4.0, -83.0, 142.0, -12.0, 0.0, -53.0, 0.0, 63.0, 118.0, 80.0, 28.0, 117.0, 136.0, -4.0, -148.0, -6.0, -9.0, 169.0, 177.0, -5.0, -4.0, -15.0, 69.0, 182.0, 85.0, 158.0, 146.0, 134.0, -4.0, 144.0, 145.0, 148.0, 0.0, 158.0, 139.0, 189.0, -15.0, 2.0, 189.0, -24.0, 110.0, 0.0, -46.0, 191.0, 85.0, 164.0, 188.0, 199.0, 4.0, 197.0, 176.0, 176.0, 159.0, 160.0, 186.0, 159.0, 192.0, -76.0, 0.0, 140.0, 162.0, 160.0, 139.0, 152.0, 152.0, 155.0, 123.0, 110.0, 178.0, 192.0, 138.0, -52.0, 194.0, -18.0, 124.0, 36.0, 146.0, 180.0, 175.0, 151.0, 181.0, 190.0, -4.0, 149.0, 192.0, -5.0, 107.0, 149.0, 140.0, -38.0, -3.0, 175.0, -139.0, 187.0, 122.0, 200.0, 180.0, 129.0, 132.0, 119.0, 188.0, 185.0, 0.0, 148.0, 171.0, 160.0, 163.0, -2.0, -11.0, 0.0, 181.0, 161.0, 193.0, 183.0, -9.0, 195.0, 129.0, 0.0, 197.0, 0.0, 169.0, 189.0, 190.0, -7.0, 189.0, 0.0, 147.0, 132.0, 0.0, 150.0, 141.0, 200.0, 67.0, 190.0], "policy_predator_policy_reward": [14.0, 17.0, 19.0, 42.0, 7.0, 48.0, 43.0, 33.0, 15.0, 7.0, 80.0, 54.0, 66.0, 66.0, 48.0, 66.0, 33.0, 68.0, 41.0, 10.0, 9.0, 17.0, 24.0, 38.0, 71.0, 72.0, 94.0, 100.0, 40.0, 47.0, 0.0, 0.0, 47.0, 12.0, 15.0, 30.0, 72.0, 20.0, 37.0, 0.0, 4.0, 0.0, 6.0, 37.0, 4.0, 0.0, 42.0, 64.0, 0.0, 0.0, 5.0, 20.0, 4.0, 41.0, 0.0, 1.0, 40.0, 49.0, 21.0, 30.0, 49.0, 30.0, 93.0, 157.0, 32.0, 65.0, 67.0, 82.0, 59.0, 1.0, 53.0, 22.0, 67.0, 0.0, 54.0, 64.0, 70.0, 61.0, 71.0, 11.0, 136.0, 74.0, 13.0, 25.0, 5.0, 0.0, 0.0, 21.0, 24.0, 20.0, 12.0, 31.0, 31.0, 0.0, 37.0, 20.0, 0.0, 38.0, 16.0, 4.0, 24.0, 18.0, 28.0, 0.0, 35.0, 38.0, 24.0, 32.0, 46.0, 0.0, 0.0, 53.0, 0.0, 0.0, 57.0, 0.0, 0.0, 20.0, 17.0, 8.0, 1.0, 5.0, 95.0, 14.0, 0.0, 23.0, 15.0, 6.0, 18.0, 19.0, 26.0, 9.0, 44.0, 45.0, 2.0, 0.0, 55.0, 56.0, 24.0, 18.0, 75.0, 54.0, 17.0, 6.0, 19.0, 5.0, 0.0, 9.0, 21.0, 4.0, 0.0, 5.0, 0.0, 44.0, 67.0, 78.0, 3.0, 0.0, 139.0, 56.0, 23.0, 12.0, 0.0, 34.0, 32.0, 11.0, 5.0, 2.0, 24.0, 0.0, 15.0, 8.0, 13.0, 2.0, 13.0, 13.0, 16.0, 9.0, 3.0, 7.0, 2.0, 9.0, 6.0, 29.0, 0.0, 0.0, 15.0, 0.0, 7.0, 0.0, 0.0, 1.0, 22.0, 38.0, 14.0, 8.0, 4.0, 20.0, 5.0, 2.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5749592958959223, "mean_inference_ms": 1.3009042979666694, "mean_action_processing_ms": 0.22696755893532955, "mean_env_wait_ms": 0.17007515170593301, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004229187965393066, "StateBufferConnector_ms": 0.0032907724380493164, "ViewRequirementAgentConnector_ms": 0.103843092918396}, "num_episodes": 22, "episode_return_max": 387.0, "episode_return_min": 0.0, "episode_return_mean": 221.91, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.19722101951646, "num_env_steps_trained_throughput_per_sec": 88.19722101951646, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 45196.772, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45196.724, "sample_time_ms": 1044.061, "learn_time_ms": 44136.645, "learn_throughput": 90.628, "synch_weights_time_ms": 13.714}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 63, "trial_id": "51025_00000", "date": "2024-08-12_21-11-58", "timestamp": 1723511518, "time_this_iter_s": 45.39710474014282, "time_total_s": 2870.610011100769, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158062ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2870.610011100769, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 20.363076923076925, "ram_util_percent": 82.67538461538462}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.05438425641842, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.714376976376489, "policy_loss": -0.009528430229392908, "vf_loss": 8.72200597303885, "vf_explained_var": 0.38987707536687294, "kl": 0.0063314180112874615, "entropy": 1.1146026023481257, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.289242673046374, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.981608620554051, "policy_loss": -0.01019566976046436, "vf_loss": 1.9908577175052078, "vf_explained_var": 0.241701435128217, "kl": 0.00946576075080573, "entropy": 0.7639018634008983, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 396.0, "episode_reward_min": 0.0, "episode_reward_mean": 260.12, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -148.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 157.0}, "policy_reward_mean": {"prey_policy": 107.53, "predator_policy": 22.53}, "custom_metrics": {}, "hist_stats": {"episode_reward": [226.0, 0.0, 366.0, 338.0, 188.0, 231.0, 166.0, 98.0, 160.0, 339.0, 62.0, 190.0, 22.0, 130.0, 316.0, 276.0, 214.0, 56.0, 198.0, 177.0, 2.0, 295.0, 286.0, 311.0, 197.0, 331.0, 178.0, 370.0, 15.0, 238.0, 166.0, 191.0, 302.0, 387.0, 258.0, 372.0, 344.0, 351.0, 225.0, 163.0, 343.0, 328.0, 342.0, 322.0, 372.0, 197.0, 218.0, 289.0, 349.0, 350.0, 380.0, 170.0, 192.0, 300.0, 247.0, 175.0, 243.0, 357.0, 343.0, 294.0, 380.0, 172.0, 354.0, 176.0, 15.0, 367.0, 386.0, 197.0, 164.0, 197.0, 373.0, 190.0, 190.0, 339.0, 172.0, 365.0, 264.0, 292.0, 384.0, 370.0, 382.0, 191.0, 334.0, 386.0, 249.0, 342.0, 348.0, 384.0, 244.0, 355.0, 302.0, 347.0, 175.0, 396.0, 390.0, 177.0, 386.0, 104.0, 260.0, 367.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-32.0, 152.0, 0.0, 0.0, 186.0, 155.0, 105.0, 188.0, 0.0, 187.0, 181.0, -39.0, 0.0, 115.0, -23.0, 42.0, -129.0, 39.0, 167.0, 75.0, -4.0, -83.0, 142.0, -12.0, 0.0, -53.0, 0.0, 63.0, 118.0, 80.0, 28.0, 117.0, 136.0, -4.0, -148.0, -6.0, -9.0, 169.0, 177.0, -5.0, -4.0, -15.0, 69.0, 182.0, 85.0, 158.0, 146.0, 134.0, -4.0, 144.0, 145.0, 148.0, 0.0, 158.0, 139.0, 189.0, -15.0, 2.0, 189.0, -24.0, 110.0, 0.0, -46.0, 191.0, 85.0, 164.0, 188.0, 199.0, 4.0, 197.0, 176.0, 176.0, 159.0, 160.0, 186.0, 159.0, 192.0, -76.0, 0.0, 140.0, 162.0, 160.0, 139.0, 152.0, 152.0, 155.0, 123.0, 110.0, 178.0, 192.0, 138.0, -52.0, 194.0, -18.0, 124.0, 36.0, 146.0, 180.0, 175.0, 151.0, 181.0, 190.0, -4.0, 149.0, 192.0, -5.0, 107.0, 149.0, 140.0, -38.0, -3.0, 175.0, -139.0, 187.0, 122.0, 200.0, 180.0, 129.0, 132.0, 119.0, 188.0, 185.0, 0.0, 148.0, 171.0, 160.0, 163.0, -2.0, -11.0, 0.0, 181.0, 161.0, 193.0, 183.0, -9.0, 195.0, 129.0, 0.0, 197.0, 0.0, 169.0, 189.0, 190.0, -7.0, 189.0, 0.0, 147.0, 132.0, 0.0, 150.0, 141.0, 200.0, 67.0, 190.0, 159.0, 115.0, 190.0, 170.0, 191.0, 151.0, 172.0, 182.0, 184.0, -3.0, 93.0, 194.0, 156.0, 197.0, 86.0, 85.0, 131.0, 174.0, 163.0, 171.0, 200.0, 171.0, 145.0, 73.0, 154.0, 178.0, 200.0, 95.0, 174.0, 150.0, -3.0, 164.0, 198.0, 198.0, 190.0, 193.0, 0.0, 162.0, 192.0, 190.0, 50.0, -10.0, -75.0, 182.0, 181.0, 179.0], "policy_predator_policy_reward": [42.0, 64.0, 0.0, 0.0, 5.0, 20.0, 4.0, 41.0, 0.0, 1.0, 40.0, 49.0, 21.0, 30.0, 49.0, 30.0, 93.0, 157.0, 32.0, 65.0, 67.0, 82.0, 59.0, 1.0, 53.0, 22.0, 67.0, 0.0, 54.0, 64.0, 70.0, 61.0, 71.0, 11.0, 136.0, 74.0, 13.0, 25.0, 5.0, 0.0, 0.0, 21.0, 24.0, 20.0, 12.0, 31.0, 31.0, 0.0, 37.0, 20.0, 0.0, 38.0, 16.0, 4.0, 24.0, 18.0, 28.0, 0.0, 35.0, 38.0, 24.0, 32.0, 46.0, 0.0, 0.0, 53.0, 0.0, 0.0, 57.0, 0.0, 0.0, 20.0, 17.0, 8.0, 1.0, 5.0, 95.0, 14.0, 0.0, 23.0, 15.0, 6.0, 18.0, 19.0, 26.0, 9.0, 44.0, 45.0, 2.0, 0.0, 55.0, 56.0, 24.0, 18.0, 75.0, 54.0, 17.0, 6.0, 19.0, 5.0, 0.0, 9.0, 21.0, 4.0, 0.0, 5.0, 0.0, 44.0, 67.0, 78.0, 3.0, 0.0, 139.0, 56.0, 23.0, 12.0, 0.0, 34.0, 32.0, 11.0, 5.0, 2.0, 24.0, 0.0, 15.0, 8.0, 13.0, 2.0, 13.0, 13.0, 16.0, 9.0, 3.0, 7.0, 2.0, 9.0, 6.0, 29.0, 0.0, 0.0, 15.0, 0.0, 7.0, 0.0, 0.0, 1.0, 22.0, 38.0, 14.0, 8.0, 4.0, 20.0, 5.0, 2.0, 6.0, 12.0, 20.0, 4.0, 12.0, 16.0, 18.0, 10.0, 3.0, 7.0, 45.0, 2.0, 15.0, 18.0, 58.0, 20.0, 0.0, 37.0, 14.0, 0.0, 7.0, 6.0, 26.0, 0.0, 15.0, 8.0, 7.0, 0.0, 21.0, 2.0, 11.0, 3.0, 0.0, 0.0, 2.0, 5.0, 9.0, 6.0, 3.0, 1.0, 40.0, 24.0, 67.0, 86.0, 6.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5749559724415115, "mean_inference_ms": 1.2994792471835996, "mean_action_processing_ms": 0.22671307593656181, "mean_env_wait_ms": 0.16990224194593226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004113912582397461, "StateBufferConnector_ms": 0.003251314163208008, "ViewRequirementAgentConnector_ms": 0.10149788856506348}, "num_episodes": 23, "episode_return_max": 396.0, "episode_return_min": 0.0, "episode_return_mean": 260.12, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.22180872035455, "num_env_steps_trained_throughput_per_sec": 88.22180872035455, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 45191.279, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45191.232, "sample_time_ms": 1040.081, "learn_time_ms": 44134.675, "learn_throughput": 90.632, "synch_weights_time_ms": 13.881}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 64, "trial_id": "51025_00000", "date": "2024-08-12_21-12-43", "timestamp": 1723511563, "time_this_iter_s": 45.38497710227966, "time_total_s": 2915.9949882030487, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1580764c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2915.9949882030487, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 21.1796875, "ram_util_percent": 83.0546875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.863642686069326, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.11851368984848, "policy_loss": -0.011997518742644282, "vf_loss": 8.127875278614185, "vf_explained_var": 0.4898686237436123, "kl": 0.008786364242340979, "entropy": 1.1201435430970772, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.32368782594721, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.372004100822267, "policy_loss": -0.006667858347168596, "vf_loss": 2.378038982802598, "vf_explained_var": 0.1734857814021842, "kl": 0.006329788951607331, "entropy": 0.7152011955856646, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 396.0, "episode_reward_min": 2.0, "episode_reward_mean": 276.32, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -194.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 194.0}, "policy_reward_mean": {"prey_policy": 119.33, "predator_policy": 18.83}, "custom_metrics": {}, "hist_stats": {"episode_reward": [198.0, 177.0, 2.0, 295.0, 286.0, 311.0, 197.0, 331.0, 178.0, 370.0, 15.0, 238.0, 166.0, 191.0, 302.0, 387.0, 258.0, 372.0, 344.0, 351.0, 225.0, 163.0, 343.0, 328.0, 342.0, 322.0, 372.0, 197.0, 218.0, 289.0, 349.0, 350.0, 380.0, 170.0, 192.0, 300.0, 247.0, 175.0, 243.0, 357.0, 343.0, 294.0, 380.0, 172.0, 354.0, 176.0, 15.0, 367.0, 386.0, 197.0, 164.0, 197.0, 373.0, 190.0, 190.0, 339.0, 172.0, 365.0, 264.0, 292.0, 384.0, 370.0, 382.0, 191.0, 334.0, 386.0, 249.0, 342.0, 348.0, 384.0, 244.0, 355.0, 302.0, 347.0, 175.0, 396.0, 390.0, 177.0, 386.0, 104.0, 260.0, 367.0, 329.0, 267.0, 292.0, 313.0, 376.0, 161.0, 335.0, 325.0, 387.0, 154.0, 166.0, 281.0, 145.0, 325.0, 269.0, 195.0, 326.0, 352.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-9.0, 169.0, 177.0, -5.0, -4.0, -15.0, 69.0, 182.0, 85.0, 158.0, 146.0, 134.0, -4.0, 144.0, 145.0, 148.0, 0.0, 158.0, 139.0, 189.0, -15.0, 2.0, 189.0, -24.0, 110.0, 0.0, -46.0, 191.0, 85.0, 164.0, 188.0, 199.0, 4.0, 197.0, 176.0, 176.0, 159.0, 160.0, 186.0, 159.0, 192.0, -76.0, 0.0, 140.0, 162.0, 160.0, 139.0, 152.0, 152.0, 155.0, 123.0, 110.0, 178.0, 192.0, 138.0, -52.0, 194.0, -18.0, 124.0, 36.0, 146.0, 180.0, 175.0, 151.0, 181.0, 190.0, -4.0, 149.0, 192.0, -5.0, 107.0, 149.0, 140.0, -38.0, -3.0, 175.0, -139.0, 187.0, 122.0, 200.0, 180.0, 129.0, 132.0, 119.0, 188.0, 185.0, 0.0, 148.0, 171.0, 160.0, 163.0, -2.0, -11.0, 0.0, 181.0, 161.0, 193.0, 183.0, -9.0, 195.0, 129.0, 0.0, 197.0, 0.0, 169.0, 189.0, 190.0, -7.0, 189.0, 0.0, 147.0, 132.0, 0.0, 150.0, 141.0, 200.0, 67.0, 190.0, 159.0, 115.0, 190.0, 170.0, 191.0, 151.0, 172.0, 182.0, 184.0, -3.0, 93.0, 194.0, 156.0, 197.0, 86.0, 85.0, 131.0, 174.0, 163.0, 171.0, 200.0, 171.0, 145.0, 73.0, 154.0, 178.0, 200.0, 95.0, 174.0, 150.0, -3.0, 164.0, 198.0, 198.0, 190.0, 193.0, 0.0, 162.0, 192.0, 190.0, 50.0, -10.0, -75.0, 182.0, 181.0, 179.0, 146.0, 183.0, 125.0, 73.0, 106.0, 114.0, 153.0, 92.0, 187.0, 177.0, 0.0, 116.0, 138.0, 151.0, 168.0, 124.0, 199.0, 184.0, 112.0, 0.0, 0.0, 137.0, 120.0, 107.0, -16.0, 108.0, 135.0, 154.0, 97.0, 116.0, 194.0, -194.0, 137.0, 131.0, 163.0, 166.0], "policy_predator_policy_reward": [13.0, 25.0, 5.0, 0.0, 0.0, 21.0, 24.0, 20.0, 12.0, 31.0, 31.0, 0.0, 37.0, 20.0, 0.0, 38.0, 16.0, 4.0, 24.0, 18.0, 28.0, 0.0, 35.0, 38.0, 24.0, 32.0, 46.0, 0.0, 0.0, 53.0, 0.0, 0.0, 57.0, 0.0, 0.0, 20.0, 17.0, 8.0, 1.0, 5.0, 95.0, 14.0, 0.0, 23.0, 15.0, 6.0, 18.0, 19.0, 26.0, 9.0, 44.0, 45.0, 2.0, 0.0, 55.0, 56.0, 24.0, 18.0, 75.0, 54.0, 17.0, 6.0, 19.0, 5.0, 0.0, 9.0, 21.0, 4.0, 0.0, 5.0, 0.0, 44.0, 67.0, 78.0, 3.0, 0.0, 139.0, 56.0, 23.0, 12.0, 0.0, 34.0, 32.0, 11.0, 5.0, 2.0, 24.0, 0.0, 15.0, 8.0, 13.0, 2.0, 13.0, 13.0, 16.0, 9.0, 3.0, 7.0, 2.0, 9.0, 6.0, 29.0, 0.0, 0.0, 15.0, 0.0, 7.0, 0.0, 0.0, 1.0, 22.0, 38.0, 14.0, 8.0, 4.0, 20.0, 5.0, 2.0, 6.0, 12.0, 20.0, 4.0, 12.0, 16.0, 18.0, 10.0, 3.0, 7.0, 45.0, 2.0, 15.0, 18.0, 58.0, 20.0, 0.0, 37.0, 14.0, 0.0, 7.0, 6.0, 26.0, 0.0, 15.0, 8.0, 7.0, 0.0, 21.0, 2.0, 11.0, 3.0, 0.0, 0.0, 2.0, 5.0, 9.0, 6.0, 3.0, 1.0, 40.0, 24.0, 67.0, 86.0, 6.0, 1.0, 0.0, 0.0, 69.0, 0.0, 28.0, 44.0, 14.0, 54.0, 11.0, 1.0, 41.0, 4.0, 32.0, 14.0, 9.0, 24.0, 0.0, 4.0, 42.0, 0.0, 2.0, 27.0, 28.0, 26.0, 0.0, 53.0, 10.0, 26.0, 53.0, 3.0, 194.0, 1.0, 32.0, 26.0, 17.0, 6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5744305848314852, "mean_inference_ms": 1.2984657714845687, "mean_action_processing_ms": 0.226699460614142, "mean_env_wait_ms": 0.16986785750606287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037689208984375, "StateBufferConnector_ms": 0.0030649900436401367, "ViewRequirementAgentConnector_ms": 0.09853994846343994}, "num_episodes": 18, "episode_return_max": 396.0, "episode_return_min": 2.0, "episode_return_mean": 276.32, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.96861214835194, "num_env_steps_trained_throughput_per_sec": 88.96861214835194, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 45174.174, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45174.128, "sample_time_ms": 1043.698, "learn_time_ms": 44114.053, "learn_throughput": 90.674, "synch_weights_time_ms": 13.956}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 65, "trial_id": "51025_00000", "date": "2024-08-12_21-13-28", "timestamp": 1723511608, "time_this_iter_s": 44.9999783039093, "time_total_s": 2960.994966506958, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158b10550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2960.994966506958, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 19.874603174603177, "ram_util_percent": 82.68730158730156}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.827512995275871, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.290248515113952, "policy_loss": -0.011049157566583109, "vf_loss": 8.299417426851061, "vf_explained_var": 0.33225578214756396, "kl": 0.0062675402132261, "entropy": 1.1241288419753785, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.494080203929276, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5726020963103684, "policy_loss": -0.010079402856223246, "vf_loss": 3.5816752653273327, "vf_explained_var": 0.21741829968634105, "kl": 0.010062441086804746, "entropy": 0.787474848259063, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 396.0, "episode_reward_min": 15.0, "episode_reward_mean": 282.7, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -194.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 194.0}, "policy_reward_mean": {"prey_policy": 121.165, "predator_policy": 20.185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [344.0, 351.0, 225.0, 163.0, 343.0, 328.0, 342.0, 322.0, 372.0, 197.0, 218.0, 289.0, 349.0, 350.0, 380.0, 170.0, 192.0, 300.0, 247.0, 175.0, 243.0, 357.0, 343.0, 294.0, 380.0, 172.0, 354.0, 176.0, 15.0, 367.0, 386.0, 197.0, 164.0, 197.0, 373.0, 190.0, 190.0, 339.0, 172.0, 365.0, 264.0, 292.0, 384.0, 370.0, 382.0, 191.0, 334.0, 386.0, 249.0, 342.0, 348.0, 384.0, 244.0, 355.0, 302.0, 347.0, 175.0, 396.0, 390.0, 177.0, 386.0, 104.0, 260.0, 367.0, 329.0, 267.0, 292.0, 313.0, 376.0, 161.0, 335.0, 325.0, 387.0, 154.0, 166.0, 281.0, 145.0, 325.0, 269.0, 195.0, 326.0, 352.0, 176.0, 345.0, 352.0, 160.0, 185.0, 231.0, 338.0, 165.0, 350.0, 371.0, 378.0, 308.0, 336.0, 230.0, 256.0, 309.0, 289.0, 133.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [159.0, 160.0, 186.0, 159.0, 192.0, -76.0, 0.0, 140.0, 162.0, 160.0, 139.0, 152.0, 152.0, 155.0, 123.0, 110.0, 178.0, 192.0, 138.0, -52.0, 194.0, -18.0, 124.0, 36.0, 146.0, 180.0, 175.0, 151.0, 181.0, 190.0, -4.0, 149.0, 192.0, -5.0, 107.0, 149.0, 140.0, -38.0, -3.0, 175.0, -139.0, 187.0, 122.0, 200.0, 180.0, 129.0, 132.0, 119.0, 188.0, 185.0, 0.0, 148.0, 171.0, 160.0, 163.0, -2.0, -11.0, 0.0, 181.0, 161.0, 193.0, 183.0, -9.0, 195.0, 129.0, 0.0, 197.0, 0.0, 169.0, 189.0, 190.0, -7.0, 189.0, 0.0, 147.0, 132.0, 0.0, 150.0, 141.0, 200.0, 67.0, 190.0, 159.0, 115.0, 190.0, 170.0, 191.0, 151.0, 172.0, 182.0, 184.0, -3.0, 93.0, 194.0, 156.0, 197.0, 86.0, 85.0, 131.0, 174.0, 163.0, 171.0, 200.0, 171.0, 145.0, 73.0, 154.0, 178.0, 200.0, 95.0, 174.0, 150.0, -3.0, 164.0, 198.0, 198.0, 190.0, 193.0, 0.0, 162.0, 192.0, 190.0, 50.0, -10.0, -75.0, 182.0, 181.0, 179.0, 146.0, 183.0, 125.0, 73.0, 106.0, 114.0, 153.0, 92.0, 187.0, 177.0, 0.0, 116.0, 138.0, 151.0, 168.0, 124.0, 199.0, 184.0, 112.0, 0.0, 0.0, 137.0, 120.0, 107.0, -16.0, 108.0, 135.0, 154.0, 97.0, 116.0, 194.0, -194.0, 137.0, 131.0, 163.0, 166.0, -41.0, 174.0, 123.0, 178.0, 179.0, 169.0, 45.0, 14.0, -48.0, 179.0, 24.0, 113.0, 140.0, 166.0, 146.0, 0.0, 158.0, 172.0, 166.0, 190.0, 165.0, 193.0, 91.0, 163.0, 183.0, 152.0, 37.0, 23.0, 83.0, 115.0, 75.0, 159.0, 104.0, 132.0, 67.0, -20.0], "policy_predator_policy_reward": [17.0, 8.0, 1.0, 5.0, 95.0, 14.0, 0.0, 23.0, 15.0, 6.0, 18.0, 19.0, 26.0, 9.0, 44.0, 45.0, 2.0, 0.0, 55.0, 56.0, 24.0, 18.0, 75.0, 54.0, 17.0, 6.0, 19.0, 5.0, 0.0, 9.0, 21.0, 4.0, 0.0, 5.0, 0.0, 44.0, 67.0, 78.0, 3.0, 0.0, 139.0, 56.0, 23.0, 12.0, 0.0, 34.0, 32.0, 11.0, 5.0, 2.0, 24.0, 0.0, 15.0, 8.0, 13.0, 2.0, 13.0, 13.0, 16.0, 9.0, 3.0, 7.0, 2.0, 9.0, 6.0, 29.0, 0.0, 0.0, 15.0, 0.0, 7.0, 0.0, 0.0, 1.0, 22.0, 38.0, 14.0, 8.0, 4.0, 20.0, 5.0, 2.0, 6.0, 12.0, 20.0, 4.0, 12.0, 16.0, 18.0, 10.0, 3.0, 7.0, 45.0, 2.0, 15.0, 18.0, 58.0, 20.0, 0.0, 37.0, 14.0, 0.0, 7.0, 6.0, 26.0, 0.0, 15.0, 8.0, 7.0, 0.0, 21.0, 2.0, 11.0, 3.0, 0.0, 0.0, 2.0, 5.0, 9.0, 6.0, 3.0, 1.0, 40.0, 24.0, 67.0, 86.0, 6.0, 1.0, 0.0, 0.0, 69.0, 0.0, 28.0, 44.0, 14.0, 54.0, 11.0, 1.0, 41.0, 4.0, 32.0, 14.0, 9.0, 24.0, 0.0, 4.0, 42.0, 0.0, 2.0, 27.0, 28.0, 26.0, 0.0, 53.0, 10.0, 26.0, 53.0, 3.0, 194.0, 1.0, 32.0, 26.0, 17.0, 6.0, 41.0, 2.0, 13.0, 31.0, 4.0, 0.0, 15.0, 86.0, 48.0, 6.0, 52.0, 42.0, 0.0, 32.0, 17.0, 2.0, 2.0, 18.0, 15.0, 0.0, 11.0, 9.0, 54.0, 0.0, 1.0, 0.0, 105.0, 65.0, 57.0, 1.0, 23.0, 52.0, 29.0, 24.0, 20.0, 66.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5742150641917262, "mean_inference_ms": 1.2976126031993882, "mean_action_processing_ms": 0.226612857777528, "mean_env_wait_ms": 0.16984116842800362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003710031509399414, "StateBufferConnector_ms": 0.0030344724655151367, "ViewRequirementAgentConnector_ms": 0.0967719554901123}, "num_episodes": 18, "episode_return_max": 396.0, "episode_return_min": 15.0, "episode_return_mean": 282.7, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.47816348593338, "num_env_steps_trained_throughput_per_sec": 88.47816348593338, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 45185.553, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45185.505, "sample_time_ms": 1047.133, "learn_time_ms": 44120.753, "learn_throughput": 90.66, "synch_weights_time_ms": 14.924}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 66, "trial_id": "51025_00000", "date": "2024-08-12_21-14-14", "timestamp": 1723511654, "time_this_iter_s": 45.257038831710815, "time_total_s": 3006.252005338669, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158b5cb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3006.252005338669, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 21.353125000000002, "ram_util_percent": 82.80781250000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.192651854053377, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.787897305261521, "policy_loss": -0.012571832406699224, "vf_loss": 7.797988477838103, "vf_explained_var": 0.31551216093320694, "kl": 0.008268868251325294, "entropy": 1.1466025932125314, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.1108220382973, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.950634079257016, "policy_loss": -0.008062451633885897, "vf_loss": 4.957962590424472, "vf_explained_var": 0.27695881692820756, "kl": 0.007339457642635916, "entropy": 0.7941823854648247, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "env_runners": {"episode_reward_max": 396.0, "episode_reward_min": 1.0, "episode_reward_mean": 267.97, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -194.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 194.0}, "policy_reward_mean": {"prey_policy": 111.31, "predator_policy": 22.675}, "custom_metrics": {}, "hist_stats": {"episode_reward": [343.0, 294.0, 380.0, 172.0, 354.0, 176.0, 15.0, 367.0, 386.0, 197.0, 164.0, 197.0, 373.0, 190.0, 190.0, 339.0, 172.0, 365.0, 264.0, 292.0, 384.0, 370.0, 382.0, 191.0, 334.0, 386.0, 249.0, 342.0, 348.0, 384.0, 244.0, 355.0, 302.0, 347.0, 175.0, 396.0, 390.0, 177.0, 386.0, 104.0, 260.0, 367.0, 329.0, 267.0, 292.0, 313.0, 376.0, 161.0, 335.0, 325.0, 387.0, 154.0, 166.0, 281.0, 145.0, 325.0, 269.0, 195.0, 326.0, 352.0, 176.0, 345.0, 352.0, 160.0, 185.0, 231.0, 338.0, 165.0, 350.0, 371.0, 378.0, 308.0, 336.0, 230.0, 256.0, 309.0, 289.0, 133.0, 252.0, 353.0, 170.0, 186.0, 358.0, 395.0, 107.0, 198.0, 35.0, 295.0, 150.0, 295.0, 320.0, 56.0, 235.0, 222.0, 331.0, 59.0, 1.0, 279.0, 193.0, 294.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [180.0, 129.0, 132.0, 119.0, 188.0, 185.0, 0.0, 148.0, 171.0, 160.0, 163.0, -2.0, -11.0, 0.0, 181.0, 161.0, 193.0, 183.0, -9.0, 195.0, 129.0, 0.0, 197.0, 0.0, 169.0, 189.0, 190.0, -7.0, 189.0, 0.0, 147.0, 132.0, 0.0, 150.0, 141.0, 200.0, 67.0, 190.0, 159.0, 115.0, 190.0, 170.0, 191.0, 151.0, 172.0, 182.0, 184.0, -3.0, 93.0, 194.0, 156.0, 197.0, 86.0, 85.0, 131.0, 174.0, 163.0, 171.0, 200.0, 171.0, 145.0, 73.0, 154.0, 178.0, 200.0, 95.0, 174.0, 150.0, -3.0, 164.0, 198.0, 198.0, 190.0, 193.0, 0.0, 162.0, 192.0, 190.0, 50.0, -10.0, -75.0, 182.0, 181.0, 179.0, 146.0, 183.0, 125.0, 73.0, 106.0, 114.0, 153.0, 92.0, 187.0, 177.0, 0.0, 116.0, 138.0, 151.0, 168.0, 124.0, 199.0, 184.0, 112.0, 0.0, 0.0, 137.0, 120.0, 107.0, -16.0, 108.0, 135.0, 154.0, 97.0, 116.0, 194.0, -194.0, 137.0, 131.0, 163.0, 166.0, -41.0, 174.0, 123.0, 178.0, 179.0, 169.0, 45.0, 14.0, -48.0, 179.0, 24.0, 113.0, 140.0, 166.0, 146.0, 0.0, 158.0, 172.0, 166.0, 190.0, 165.0, 193.0, 91.0, 163.0, 183.0, 152.0, 37.0, 23.0, 83.0, 115.0, 75.0, 159.0, 104.0, 132.0, 67.0, -20.0, 109.0, 49.0, 178.0, 135.0, 144.0, 0.0, 174.0, 0.0, 129.0, 182.0, 197.0, 198.0, 0.0, -79.0, 0.0, 198.0, -50.0, -54.0, 119.0, 127.0, -25.0, 96.0, 192.0, 83.0, 126.0, 132.0, -97.0, -42.0, 65.0, 78.0, 78.0, 55.0, 158.0, 151.0, -78.0, 0.0, -108.0, -65.0, 68.0, 144.0, 0.0, 173.0, 66.0, 143.0], "policy_predator_policy_reward": [0.0, 34.0, 32.0, 11.0, 5.0, 2.0, 24.0, 0.0, 15.0, 8.0, 13.0, 2.0, 13.0, 13.0, 16.0, 9.0, 3.0, 7.0, 2.0, 9.0, 6.0, 29.0, 0.0, 0.0, 15.0, 0.0, 7.0, 0.0, 0.0, 1.0, 22.0, 38.0, 14.0, 8.0, 4.0, 20.0, 5.0, 2.0, 6.0, 12.0, 20.0, 4.0, 12.0, 16.0, 18.0, 10.0, 3.0, 7.0, 45.0, 2.0, 15.0, 18.0, 58.0, 20.0, 0.0, 37.0, 14.0, 0.0, 7.0, 6.0, 26.0, 0.0, 15.0, 8.0, 7.0, 0.0, 21.0, 2.0, 11.0, 3.0, 0.0, 0.0, 2.0, 5.0, 9.0, 6.0, 3.0, 1.0, 40.0, 24.0, 67.0, 86.0, 6.0, 1.0, 0.0, 0.0, 69.0, 0.0, 28.0, 44.0, 14.0, 54.0, 11.0, 1.0, 41.0, 4.0, 32.0, 14.0, 9.0, 24.0, 0.0, 4.0, 42.0, 0.0, 2.0, 27.0, 28.0, 26.0, 0.0, 53.0, 10.0, 26.0, 53.0, 3.0, 194.0, 1.0, 32.0, 26.0, 17.0, 6.0, 41.0, 2.0, 13.0, 31.0, 4.0, 0.0, 15.0, 86.0, 48.0, 6.0, 52.0, 42.0, 0.0, 32.0, 17.0, 2.0, 2.0, 18.0, 15.0, 0.0, 11.0, 9.0, 54.0, 0.0, 1.0, 0.0, 105.0, 65.0, 57.0, 1.0, 23.0, 52.0, 29.0, 24.0, 20.0, 66.0, 42.0, 52.0, 6.0, 34.0, 4.0, 22.0, 12.0, 0.0, 30.0, 17.0, 0.0, 0.0, 118.0, 68.0, 0.0, 0.0, 1.0, 138.0, 49.0, 0.0, 42.0, 37.0, 7.0, 13.0, 24.0, 38.0, 130.0, 65.0, 16.0, 76.0, 89.0, 0.0, 0.0, 22.0, 8.0, 129.0, 174.0, 0.0, 30.0, 37.0, 12.0, 8.0, 35.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.576097757082743, "mean_inference_ms": 1.3013309250277618, "mean_action_processing_ms": 0.2273032752511778, "mean_env_wait_ms": 0.17053630658889873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003835320472717285, "StateBufferConnector_ms": 0.003282904624938965, "ViewRequirementAgentConnector_ms": 0.11500442028045654}, "num_episodes": 22, "episode_return_max": 396.0, "episode_return_min": 1.0, "episode_return_mean": 267.97, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 84.83378836582955, "num_env_steps_trained_throughput_per_sec": 84.83378836582955, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 45437.837, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45437.789, "sample_time_ms": 1179.469, "learn_time_ms": 44240.312, "learn_throughput": 90.415, "synch_weights_time_ms": 15.256}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "training_iteration": 67, "trial_id": "51025_00000", "date": "2024-08-12_21-15-01", "timestamp": 1723511701, "time_this_iter_s": 47.20613884925842, "time_total_s": 3053.4581441879272, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158076f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3053.4581441879272, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 27.11343283582089, "ram_util_percent": 80.4179104477612}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.2568575923405, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.286743490784257, "policy_loss": -0.009820558552792858, "vf_loss": 8.294560402915591, "vf_explained_var": -0.3289210769865248, "kl": 0.006678829673639109, "entropy": 1.1596497326300887, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.229249566698831, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.093154267659263, "policy_loss": -0.010408530550979315, "vf_loss": 7.102671238732716, "vf_explained_var": 0.27448294292051323, "kl": 0.008915471585374141, "entropy": 0.765657146109475, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "env_runners": {"episode_reward_max": 396.0, "episode_reward_min": -92.0, "episode_reward_mean": 237.85, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -194.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 194.0}, "policy_reward_mean": {"prey_policy": 84.91, "predator_policy": 34.015}, "custom_metrics": {}, "hist_stats": {"episode_reward": [264.0, 292.0, 384.0, 370.0, 382.0, 191.0, 334.0, 386.0, 249.0, 342.0, 348.0, 384.0, 244.0, 355.0, 302.0, 347.0, 175.0, 396.0, 390.0, 177.0, 386.0, 104.0, 260.0, 367.0, 329.0, 267.0, 292.0, 313.0, 376.0, 161.0, 335.0, 325.0, 387.0, 154.0, 166.0, 281.0, 145.0, 325.0, 269.0, 195.0, 326.0, 352.0, 176.0, 345.0, 352.0, 160.0, 185.0, 231.0, 338.0, 165.0, 350.0, 371.0, 378.0, 308.0, 336.0, 230.0, 256.0, 309.0, 289.0, 133.0, 252.0, 353.0, 170.0, 186.0, 358.0, 395.0, 107.0, 198.0, 35.0, 295.0, 150.0, 295.0, 320.0, 56.0, 235.0, 222.0, 331.0, 59.0, 1.0, 279.0, 193.0, 294.0, 160.0, 15.0, 136.0, 38.0, 15.0, 36.0, 103.0, -47.0, 91.0, -19.0, 96.0, 155.0, 381.0, 106.0, 185.0, 213.0, 90.0, -92.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [67.0, 190.0, 159.0, 115.0, 190.0, 170.0, 191.0, 151.0, 172.0, 182.0, 184.0, -3.0, 93.0, 194.0, 156.0, 197.0, 86.0, 85.0, 131.0, 174.0, 163.0, 171.0, 200.0, 171.0, 145.0, 73.0, 154.0, 178.0, 200.0, 95.0, 174.0, 150.0, -3.0, 164.0, 198.0, 198.0, 190.0, 193.0, 0.0, 162.0, 192.0, 190.0, 50.0, -10.0, -75.0, 182.0, 181.0, 179.0, 146.0, 183.0, 125.0, 73.0, 106.0, 114.0, 153.0, 92.0, 187.0, 177.0, 0.0, 116.0, 138.0, 151.0, 168.0, 124.0, 199.0, 184.0, 112.0, 0.0, 0.0, 137.0, 120.0, 107.0, -16.0, 108.0, 135.0, 154.0, 97.0, 116.0, 194.0, -194.0, 137.0, 131.0, 163.0, 166.0, -41.0, 174.0, 123.0, 178.0, 179.0, 169.0, 45.0, 14.0, -48.0, 179.0, 24.0, 113.0, 140.0, 166.0, 146.0, 0.0, 158.0, 172.0, 166.0, 190.0, 165.0, 193.0, 91.0, 163.0, 183.0, 152.0, 37.0, 23.0, 83.0, 115.0, 75.0, 159.0, 104.0, 132.0, 67.0, -20.0, 109.0, 49.0, 178.0, 135.0, 144.0, 0.0, 174.0, 0.0, 129.0, 182.0, 197.0, 198.0, 0.0, -79.0, 0.0, 198.0, -50.0, -54.0, 119.0, 127.0, -25.0, 96.0, 192.0, 83.0, 126.0, 132.0, -97.0, -42.0, 65.0, 78.0, 78.0, 55.0, 158.0, 151.0, -78.0, 0.0, -108.0, -65.0, 68.0, 144.0, 0.0, 173.0, 66.0, 143.0, 50.0, 2.0, -66.0, -77.0, 75.0, -1.0, -49.0, -106.0, -104.0, -148.0, -63.0, -41.0, -34.0, 6.0, -163.0, -133.0, -83.0, 0.0, -77.0, -141.0, 0.0, -136.0, 32.0, 3.0, 180.0, 191.0, -19.0, 0.0, 13.0, 72.0, 60.0, 78.0, -39.0, 0.0, -143.0, -127.0], "policy_predator_policy_reward": [5.0, 2.0, 6.0, 12.0, 20.0, 4.0, 12.0, 16.0, 18.0, 10.0, 3.0, 7.0, 45.0, 2.0, 15.0, 18.0, 58.0, 20.0, 0.0, 37.0, 14.0, 0.0, 7.0, 6.0, 26.0, 0.0, 15.0, 8.0, 7.0, 0.0, 21.0, 2.0, 11.0, 3.0, 0.0, 0.0, 2.0, 5.0, 9.0, 6.0, 3.0, 1.0, 40.0, 24.0, 67.0, 86.0, 6.0, 1.0, 0.0, 0.0, 69.0, 0.0, 28.0, 44.0, 14.0, 54.0, 11.0, 1.0, 41.0, 4.0, 32.0, 14.0, 9.0, 24.0, 0.0, 4.0, 42.0, 0.0, 2.0, 27.0, 28.0, 26.0, 0.0, 53.0, 10.0, 26.0, 53.0, 3.0, 194.0, 1.0, 32.0, 26.0, 17.0, 6.0, 41.0, 2.0, 13.0, 31.0, 4.0, 0.0, 15.0, 86.0, 48.0, 6.0, 52.0, 42.0, 0.0, 32.0, 17.0, 2.0, 2.0, 18.0, 15.0, 0.0, 11.0, 9.0, 54.0, 0.0, 1.0, 0.0, 105.0, 65.0, 57.0, 1.0, 23.0, 52.0, 29.0, 24.0, 20.0, 66.0, 42.0, 52.0, 6.0, 34.0, 4.0, 22.0, 12.0, 0.0, 30.0, 17.0, 0.0, 0.0, 118.0, 68.0, 0.0, 0.0, 1.0, 138.0, 49.0, 0.0, 42.0, 37.0, 7.0, 13.0, 24.0, 38.0, 130.0, 65.0, 16.0, 76.0, 89.0, 0.0, 0.0, 22.0, 8.0, 129.0, 174.0, 0.0, 30.0, 37.0, 12.0, 8.0, 35.0, 50.0, 107.0, 1.0, 147.0, 11.0, 61.0, 1.0, 49.0, 144.0, 86.0, 181.0, 14.0, 126.0, 39.0, 92.0, 65.0, 184.0, 57.0, 117.0, 179.0, 20.0, 162.0, 70.0, 20.0, 100.0, 0.0, 10.0, 71.0, 54.0, 8.0, 92.0, 1.0, 74.0, 106.0, 23.0, 4.0, 174.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5774720586202678, "mean_inference_ms": 1.305598057669738, "mean_action_processing_ms": 0.22800599285456394, "mean_env_wait_ms": 0.17117592194161077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036687850952148438, "StateBufferConnector_ms": 0.003178715705871582, "ViewRequirementAgentConnector_ms": 0.10808384418487549}, "num_episodes": 18, "episode_return_max": 396.0, "episode_return_min": -92.0, "episode_return_mean": 237.85, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 89.02789922901728, "num_env_steps_trained_throughput_per_sec": 89.02789922901728, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 45366.312, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45366.266, "sample_time_ms": 1184.923, "learn_time_ms": 44163.401, "learn_throughput": 90.573, "synch_weights_time_ms": 15.231}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "training_iteration": 68, "trial_id": "51025_00000", "date": "2024-08-12_21-15-46", "timestamp": 1723511746, "time_this_iter_s": 44.93446135520935, "time_total_s": 3098.3926055431366, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158086c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3098.3926055431366, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 19.995312499999997, "ram_util_percent": 80.228125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.6719454873806585, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.043652766343778, "policy_loss": -0.013078169577148935, "vf_loss": 9.054632833773496, "vf_explained_var": -0.23660322853497096, "kl": 0.006993689240449107, "entropy": 1.1614333704665856, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.768620521555501, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.482327956497354, "policy_loss": -0.007235819991017697, "vf_loss": 7.488853883490991, "vf_explained_var": 0.27810908060855966, "kl": 0.007098854397969321, "entropy": 0.761831619594463, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 395.0, "episode_reward_min": -146.0, "episode_reward_mean": 178.92, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -194.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": 36.21, "predator_policy": 53.25}, "custom_metrics": {}, "hist_stats": {"episode_reward": [367.0, 329.0, 267.0, 292.0, 313.0, 376.0, 161.0, 335.0, 325.0, 387.0, 154.0, 166.0, 281.0, 145.0, 325.0, 269.0, 195.0, 326.0, 352.0, 176.0, 345.0, 352.0, 160.0, 185.0, 231.0, 338.0, 165.0, 350.0, 371.0, 378.0, 308.0, 336.0, 230.0, 256.0, 309.0, 289.0, 133.0, 252.0, 353.0, 170.0, 186.0, 358.0, 395.0, 107.0, 198.0, 35.0, 295.0, 150.0, 295.0, 320.0, 56.0, 235.0, 222.0, 331.0, 59.0, 1.0, 279.0, 193.0, 294.0, 160.0, 15.0, 136.0, 38.0, 15.0, 36.0, 103.0, -47.0, 91.0, -19.0, 96.0, 155.0, 381.0, 106.0, 185.0, 213.0, 90.0, -92.0, 132.0, -146.0, 166.0, -96.0, 163.0, -60.0, 159.0, 111.0, 13.0, 105.0, 78.0, 15.0, 1.0, 14.0, 45.0, 109.0, 44.0, 73.0, -34.0, 294.0, 76.0, 17.0, -110.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [181.0, 179.0, 146.0, 183.0, 125.0, 73.0, 106.0, 114.0, 153.0, 92.0, 187.0, 177.0, 0.0, 116.0, 138.0, 151.0, 168.0, 124.0, 199.0, 184.0, 112.0, 0.0, 0.0, 137.0, 120.0, 107.0, -16.0, 108.0, 135.0, 154.0, 97.0, 116.0, 194.0, -194.0, 137.0, 131.0, 163.0, 166.0, -41.0, 174.0, 123.0, 178.0, 179.0, 169.0, 45.0, 14.0, -48.0, 179.0, 24.0, 113.0, 140.0, 166.0, 146.0, 0.0, 158.0, 172.0, 166.0, 190.0, 165.0, 193.0, 91.0, 163.0, 183.0, 152.0, 37.0, 23.0, 83.0, 115.0, 75.0, 159.0, 104.0, 132.0, 67.0, -20.0, 109.0, 49.0, 178.0, 135.0, 144.0, 0.0, 174.0, 0.0, 129.0, 182.0, 197.0, 198.0, 0.0, -79.0, 0.0, 198.0, -50.0, -54.0, 119.0, 127.0, -25.0, 96.0, 192.0, 83.0, 126.0, 132.0, -97.0, -42.0, 65.0, 78.0, 78.0, 55.0, 158.0, 151.0, -78.0, 0.0, -108.0, -65.0, 68.0, 144.0, 0.0, 173.0, 66.0, 143.0, 50.0, 2.0, -66.0, -77.0, 75.0, -1.0, -49.0, -106.0, -104.0, -148.0, -63.0, -41.0, -34.0, 6.0, -163.0, -133.0, -83.0, 0.0, -77.0, -141.0, 0.0, -136.0, 32.0, 3.0, 180.0, 191.0, -19.0, 0.0, 13.0, 72.0, 60.0, 78.0, -39.0, 0.0, -143.0, -127.0, -132.0, 0.0, -151.0, -193.0, 49.0, 31.0, -168.0, -192.0, 87.0, -18.0, -145.0, -147.0, -71.0, 13.0, -58.0, -54.0, -90.0, 2.0, -42.0, 21.0, -147.0, -65.0, -81.0, -56.0, -164.0, -182.0, -112.0, -27.0, -94.0, -60.0, -101.0, -73.0, 0.0, -107.0, -28.0, -94.0, -128.0, -91.0, 109.0, 114.0, -13.0, -116.0, -135.0, -144.0, -122.0, -176.0], "policy_predator_policy_reward": [6.0, 1.0, 0.0, 0.0, 69.0, 0.0, 28.0, 44.0, 14.0, 54.0, 11.0, 1.0, 41.0, 4.0, 32.0, 14.0, 9.0, 24.0, 0.0, 4.0, 42.0, 0.0, 2.0, 27.0, 28.0, 26.0, 0.0, 53.0, 10.0, 26.0, 53.0, 3.0, 194.0, 1.0, 32.0, 26.0, 17.0, 6.0, 41.0, 2.0, 13.0, 31.0, 4.0, 0.0, 15.0, 86.0, 48.0, 6.0, 52.0, 42.0, 0.0, 32.0, 17.0, 2.0, 2.0, 18.0, 15.0, 0.0, 11.0, 9.0, 54.0, 0.0, 1.0, 0.0, 105.0, 65.0, 57.0, 1.0, 23.0, 52.0, 29.0, 24.0, 20.0, 66.0, 42.0, 52.0, 6.0, 34.0, 4.0, 22.0, 12.0, 0.0, 30.0, 17.0, 0.0, 0.0, 118.0, 68.0, 0.0, 0.0, 1.0, 138.0, 49.0, 0.0, 42.0, 37.0, 7.0, 13.0, 24.0, 38.0, 130.0, 65.0, 16.0, 76.0, 89.0, 0.0, 0.0, 22.0, 8.0, 129.0, 174.0, 0.0, 30.0, 37.0, 12.0, 8.0, 35.0, 50.0, 107.0, 1.0, 147.0, 11.0, 61.0, 1.0, 49.0, 144.0, 86.0, 181.0, 14.0, 126.0, 39.0, 92.0, 65.0, 184.0, 57.0, 117.0, 179.0, 20.0, 162.0, 70.0, 20.0, 100.0, 0.0, 10.0, 71.0, 54.0, 8.0, 92.0, 1.0, 74.0, 106.0, 23.0, 4.0, 174.0, 129.0, 135.0, 0.0, 198.0, 86.0, 0.0, 188.0, 76.0, 88.0, 6.0, 64.0, 168.0, 104.0, 113.0, 101.0, 122.0, 101.0, 0.0, 11.0, 115.0, 154.0, 136.0, 133.0, 19.0, 197.0, 150.0, 0.0, 153.0, 23.0, 176.0, 133.0, 150.0, 3.0, 148.0, 143.0, 52.0, 165.0, 20.0, 26.0, 45.0, 78.0, 127.0, 119.0, 177.0, 188.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5792544363314156, "mean_inference_ms": 1.3103548697566207, "mean_action_processing_ms": 0.22881238529943765, "mean_env_wait_ms": 0.17193607216982432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004372835159301758, "StateBufferConnector_ms": 0.0032868385314941406, "ViewRequirementAgentConnector_ms": 0.11144411563873291}, "num_episodes": 23, "episode_return_max": 395.0, "episode_return_min": -146.0, "episode_return_mean": 178.92, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.85852720854967, "num_env_steps_trained_throughput_per_sec": 88.85852720854967, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 45331.393, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45331.348, "sample_time_ms": 1184.166, "learn_time_ms": 44129.37, "learn_throughput": 90.643, "synch_weights_time_ms": 15.141}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 69, "trial_id": "51025_00000", "date": "2024-08-12_21-16-31", "timestamp": 1723511791, "time_this_iter_s": 45.02000880241394, "time_total_s": 3143.4126143455505, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158b5cf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3143.4126143455505, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 19.9984375, "ram_util_percent": 80.34062499999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.428985056296858, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.559859632310413, "policy_loss": -0.012927827025423683, "vf_loss": 8.569916553345937, "vf_explained_var": -0.6887517741117528, "kl": 0.009569675502518155, "entropy": 1.161963676144837, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.355220470478926, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.689791065296799, "policy_loss": -0.009747889668005641, "vf_loss": 8.698836079854814, "vf_explained_var": 0.18775154393186014, "kl": 0.007028936508003896, "entropy": 0.7435365536856273, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 395.0, "episode_reward_min": -146.0, "episode_reward_mean": 138.38, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -194.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": -1.72, "predator_policy": 70.91}, "custom_metrics": {}, "hist_stats": {"episode_reward": [352.0, 176.0, 345.0, 352.0, 160.0, 185.0, 231.0, 338.0, 165.0, 350.0, 371.0, 378.0, 308.0, 336.0, 230.0, 256.0, 309.0, 289.0, 133.0, 252.0, 353.0, 170.0, 186.0, 358.0, 395.0, 107.0, 198.0, 35.0, 295.0, 150.0, 295.0, 320.0, 56.0, 235.0, 222.0, 331.0, 59.0, 1.0, 279.0, 193.0, 294.0, 160.0, 15.0, 136.0, 38.0, 15.0, 36.0, 103.0, -47.0, 91.0, -19.0, 96.0, 155.0, 381.0, 106.0, 185.0, 213.0, 90.0, -92.0, 132.0, -146.0, 166.0, -96.0, 163.0, -60.0, 159.0, 111.0, 13.0, 105.0, 78.0, 15.0, 1.0, 14.0, 45.0, 109.0, 44.0, 73.0, -34.0, 294.0, 76.0, 17.0, -110.0, 150.0, 8.0, 95.0, -62.0, 155.0, 0.0, 92.0, 27.0, 72.0, 38.0, 82.0, 72.0, -32.0, 109.0, 37.0, 57.0, -10.0, 69.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [163.0, 166.0, -41.0, 174.0, 123.0, 178.0, 179.0, 169.0, 45.0, 14.0, -48.0, 179.0, 24.0, 113.0, 140.0, 166.0, 146.0, 0.0, 158.0, 172.0, 166.0, 190.0, 165.0, 193.0, 91.0, 163.0, 183.0, 152.0, 37.0, 23.0, 83.0, 115.0, 75.0, 159.0, 104.0, 132.0, 67.0, -20.0, 109.0, 49.0, 178.0, 135.0, 144.0, 0.0, 174.0, 0.0, 129.0, 182.0, 197.0, 198.0, 0.0, -79.0, 0.0, 198.0, -50.0, -54.0, 119.0, 127.0, -25.0, 96.0, 192.0, 83.0, 126.0, 132.0, -97.0, -42.0, 65.0, 78.0, 78.0, 55.0, 158.0, 151.0, -78.0, 0.0, -108.0, -65.0, 68.0, 144.0, 0.0, 173.0, 66.0, 143.0, 50.0, 2.0, -66.0, -77.0, 75.0, -1.0, -49.0, -106.0, -104.0, -148.0, -63.0, -41.0, -34.0, 6.0, -163.0, -133.0, -83.0, 0.0, -77.0, -141.0, 0.0, -136.0, 32.0, 3.0, 180.0, 191.0, -19.0, 0.0, 13.0, 72.0, 60.0, 78.0, -39.0, 0.0, -143.0, -127.0, -132.0, 0.0, -151.0, -193.0, 49.0, 31.0, -168.0, -192.0, 87.0, -18.0, -145.0, -147.0, -71.0, 13.0, -58.0, -54.0, -90.0, 2.0, -42.0, 21.0, -147.0, -65.0, -81.0, -56.0, -164.0, -182.0, -112.0, -27.0, -94.0, -60.0, -101.0, -73.0, 0.0, -107.0, -28.0, -94.0, -128.0, -91.0, 109.0, 114.0, -13.0, -116.0, -135.0, -144.0, -122.0, -176.0, 17.0, 12.0, -110.0, -167.0, -170.0, -69.0, -89.0, -166.0, -105.0, -2.0, -100.0, -194.0, -28.0, -25.0, -150.0, -108.0, -115.0, -112.0, -160.0, -162.0, -98.0, -136.0, -3.0, -136.0, -113.0, -148.0, -98.0, 14.0, -36.0, -64.0, 0.0, -85.0, -140.0, -168.0, -98.0, -140.0], "policy_predator_policy_reward": [17.0, 6.0, 41.0, 2.0, 13.0, 31.0, 4.0, 0.0, 15.0, 86.0, 48.0, 6.0, 52.0, 42.0, 0.0, 32.0, 17.0, 2.0, 2.0, 18.0, 15.0, 0.0, 11.0, 9.0, 54.0, 0.0, 1.0, 0.0, 105.0, 65.0, 57.0, 1.0, 23.0, 52.0, 29.0, 24.0, 20.0, 66.0, 42.0, 52.0, 6.0, 34.0, 4.0, 22.0, 12.0, 0.0, 30.0, 17.0, 0.0, 0.0, 118.0, 68.0, 0.0, 0.0, 1.0, 138.0, 49.0, 0.0, 42.0, 37.0, 7.0, 13.0, 24.0, 38.0, 130.0, 65.0, 16.0, 76.0, 89.0, 0.0, 0.0, 22.0, 8.0, 129.0, 174.0, 0.0, 30.0, 37.0, 12.0, 8.0, 35.0, 50.0, 107.0, 1.0, 147.0, 11.0, 61.0, 1.0, 49.0, 144.0, 86.0, 181.0, 14.0, 126.0, 39.0, 92.0, 65.0, 184.0, 57.0, 117.0, 179.0, 20.0, 162.0, 70.0, 20.0, 100.0, 0.0, 10.0, 71.0, 54.0, 8.0, 92.0, 1.0, 74.0, 106.0, 23.0, 4.0, 174.0, 129.0, 135.0, 0.0, 198.0, 86.0, 0.0, 188.0, 76.0, 88.0, 6.0, 64.0, 168.0, 104.0, 113.0, 101.0, 122.0, 101.0, 0.0, 11.0, 115.0, 154.0, 136.0, 133.0, 19.0, 197.0, 150.0, 0.0, 153.0, 23.0, 176.0, 133.0, 150.0, 3.0, 148.0, 143.0, 52.0, 165.0, 20.0, 26.0, 45.0, 78.0, 127.0, 119.0, 177.0, 188.0, 0.0, 121.0, 0.0, 104.0, 181.0, 164.0, 170.0, 14.0, 179.0, 119.0, 143.0, 180.0, 114.0, 113.0, 32.0, 115.0, 170.0, 161.0, 138.0, 190.0, 170.0, 148.0, 168.0, 93.0, 118.0, 46.0, 183.0, 67.0, 126.0, 137.0, 0.0, 51.0, 91.0, 186.0, 112.0, 157.0, 150.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5806574889520125, "mean_inference_ms": 1.314080933082713, "mean_action_processing_ms": 0.22946713716811007, "mean_env_wait_ms": 0.17253128006154303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005102396011352539, "StateBufferConnector_ms": 0.003538966178894043, "ViewRequirementAgentConnector_ms": 0.11130321025848389}, "num_episodes": 18, "episode_return_max": 395.0, "episode_return_min": -146.0, "episode_return_mean": 138.38, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 89.01834310848487, "num_env_steps_trained_throughput_per_sec": 89.01834310848487, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 45312.714, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45312.669, "sample_time_ms": 1186.892, "learn_time_ms": 44108.272, "learn_throughput": 90.686, "synch_weights_time_ms": 14.917}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 70, "trial_id": "51025_00000", "date": "2024-08-12_21-17-16", "timestamp": 1723511836, "time_this_iter_s": 44.96848773956299, "time_total_s": 3188.3811020851135, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158076ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3188.3811020851135, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 21.01269841269841, "ram_util_percent": 80.20476190476188}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.3799401790376695, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.045687960316895, "policy_loss": -0.014682219051583498, "vf_loss": 8.056814814370776, "vf_explained_var": -0.9402791759324453, "kl": 0.011851263923107033, "entropy": 1.1540152299971806, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.272381695994625, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.089473623951907, "policy_loss": -0.009246670919416285, "vf_loss": 9.098025568704756, "vf_explained_var": 0.0640101380133755, "kl": 0.006947257412429845, "entropy": 0.7375825571635413, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "env_runners": {"episode_reward_max": 395.0, "episode_reward_min": -146.0, "episode_reward_mean": 96.47, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -194.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -41.14, "predator_policy": 89.375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [133.0, 252.0, 353.0, 170.0, 186.0, 358.0, 395.0, 107.0, 198.0, 35.0, 295.0, 150.0, 295.0, 320.0, 56.0, 235.0, 222.0, 331.0, 59.0, 1.0, 279.0, 193.0, 294.0, 160.0, 15.0, 136.0, 38.0, 15.0, 36.0, 103.0, -47.0, 91.0, -19.0, 96.0, 155.0, 381.0, 106.0, 185.0, 213.0, 90.0, -92.0, 132.0, -146.0, 166.0, -96.0, 163.0, -60.0, 159.0, 111.0, 13.0, 105.0, 78.0, 15.0, 1.0, 14.0, 45.0, 109.0, 44.0, 73.0, -34.0, 294.0, 76.0, 17.0, -110.0, 150.0, 8.0, 95.0, -62.0, 155.0, 0.0, 92.0, 27.0, 72.0, 38.0, 82.0, 72.0, -32.0, 109.0, 37.0, 57.0, -10.0, 69.0, 115.0, 38.0, 67.0, 27.0, 107.0, 69.0, 115.0, -57.0, 100.0, 82.0, 131.0, -5.0, 69.0, 83.0, -60.0, 24.0, 40.0, -5.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [67.0, -20.0, 109.0, 49.0, 178.0, 135.0, 144.0, 0.0, 174.0, 0.0, 129.0, 182.0, 197.0, 198.0, 0.0, -79.0, 0.0, 198.0, -50.0, -54.0, 119.0, 127.0, -25.0, 96.0, 192.0, 83.0, 126.0, 132.0, -97.0, -42.0, 65.0, 78.0, 78.0, 55.0, 158.0, 151.0, -78.0, 0.0, -108.0, -65.0, 68.0, 144.0, 0.0, 173.0, 66.0, 143.0, 50.0, 2.0, -66.0, -77.0, 75.0, -1.0, -49.0, -106.0, -104.0, -148.0, -63.0, -41.0, -34.0, 6.0, -163.0, -133.0, -83.0, 0.0, -77.0, -141.0, 0.0, -136.0, 32.0, 3.0, 180.0, 191.0, -19.0, 0.0, 13.0, 72.0, 60.0, 78.0, -39.0, 0.0, -143.0, -127.0, -132.0, 0.0, -151.0, -193.0, 49.0, 31.0, -168.0, -192.0, 87.0, -18.0, -145.0, -147.0, -71.0, 13.0, -58.0, -54.0, -90.0, 2.0, -42.0, 21.0, -147.0, -65.0, -81.0, -56.0, -164.0, -182.0, -112.0, -27.0, -94.0, -60.0, -101.0, -73.0, 0.0, -107.0, -28.0, -94.0, -128.0, -91.0, 109.0, 114.0, -13.0, -116.0, -135.0, -144.0, -122.0, -176.0, 17.0, 12.0, -110.0, -167.0, -170.0, -69.0, -89.0, -166.0, -105.0, -2.0, -100.0, -194.0, -28.0, -25.0, -150.0, -108.0, -115.0, -112.0, -160.0, -162.0, -98.0, -136.0, -3.0, -136.0, -113.0, -148.0, -98.0, 14.0, -36.0, -64.0, 0.0, -85.0, -140.0, -168.0, -98.0, -140.0, -95.0, -4.0, -166.0, -177.0, -70.0, -58.0, -174.0, -126.0, -62.0, 0.0, -112.0, -125.0, -34.0, -14.0, -124.0, -135.0, -100.0, -80.0, -31.0, 0.0, 0.0, -109.0, -164.0, -119.0, -19.0, 0.0, -137.0, -153.0, -173.0, -189.0, -175.0, -152.0, -88.0, -126.0, -172.0, -170.0], "policy_predator_policy_reward": [20.0, 66.0, 42.0, 52.0, 6.0, 34.0, 4.0, 22.0, 12.0, 0.0, 30.0, 17.0, 0.0, 0.0, 118.0, 68.0, 0.0, 0.0, 1.0, 138.0, 49.0, 0.0, 42.0, 37.0, 7.0, 13.0, 24.0, 38.0, 130.0, 65.0, 16.0, 76.0, 89.0, 0.0, 0.0, 22.0, 8.0, 129.0, 174.0, 0.0, 30.0, 37.0, 12.0, 8.0, 35.0, 50.0, 107.0, 1.0, 147.0, 11.0, 61.0, 1.0, 49.0, 144.0, 86.0, 181.0, 14.0, 126.0, 39.0, 92.0, 65.0, 184.0, 57.0, 117.0, 179.0, 20.0, 162.0, 70.0, 20.0, 100.0, 0.0, 10.0, 71.0, 54.0, 8.0, 92.0, 1.0, 74.0, 106.0, 23.0, 4.0, 174.0, 129.0, 135.0, 0.0, 198.0, 86.0, 0.0, 188.0, 76.0, 88.0, 6.0, 64.0, 168.0, 104.0, 113.0, 101.0, 122.0, 101.0, 0.0, 11.0, 115.0, 154.0, 136.0, 133.0, 19.0, 197.0, 150.0, 0.0, 153.0, 23.0, 176.0, 133.0, 150.0, 3.0, 148.0, 143.0, 52.0, 165.0, 20.0, 26.0, 45.0, 78.0, 127.0, 119.0, 177.0, 188.0, 0.0, 121.0, 0.0, 104.0, 181.0, 164.0, 170.0, 14.0, 179.0, 119.0, 143.0, 180.0, 114.0, 113.0, 32.0, 115.0, 170.0, 161.0, 138.0, 190.0, 170.0, 148.0, 168.0, 93.0, 118.0, 46.0, 183.0, 67.0, 126.0, 137.0, 0.0, 51.0, 91.0, 186.0, 112.0, 157.0, 150.0, 121.0, 93.0, 186.0, 195.0, 132.0, 63.0, 185.0, 142.0, 125.0, 44.0, 151.0, 155.0, 35.0, 128.0, 23.0, 179.0, 124.0, 156.0, 0.0, 113.0, 116.0, 124.0, 102.0, 176.0, 55.0, 33.0, 187.0, 186.0, 102.0, 200.0, 192.0, 159.0, 88.0, 166.0, 190.0, 147.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5819827670213853, "mean_inference_ms": 1.3177768639337, "mean_action_processing_ms": 0.23011524333487088, "mean_env_wait_ms": 0.17309156583444504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005839943885803223, "StateBufferConnector_ms": 0.003598928451538086, "ViewRequirementAgentConnector_ms": 0.11401772499084473}, "num_episodes": 18, "episode_return_max": 395.0, "episode_return_min": -146.0, "episode_return_mean": 96.47, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.36840473217487, "num_env_steps_trained_throughput_per_sec": 88.36840473217487, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 1136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 45355.747, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45355.703, "sample_time_ms": 1189.691, "learn_time_ms": 44148.435, "learn_throughput": 90.603, "synch_weights_time_ms": 15.062}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "done": false, "training_iteration": 71, "trial_id": "51025_00000", "date": "2024-08-12_21-18-01", "timestamp": 1723511881, "time_this_iter_s": 45.29860019683838, "time_total_s": 3233.679702281952, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1580dee50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3233.679702281952, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 20.6859375, "ram_util_percent": 80.7421875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.720190734144241, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.024165642198431, "policy_loss": -0.013640194700503594, "vf_loss": 7.034955971581596, "vf_explained_var": -0.9643383149116759, "kl": 0.0094995284468337, "entropy": 1.1970113034601564, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.331426353555507, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.946395521819907, "policy_loss": -0.008079732769962262, "vf_loss": 8.953874927601486, "vf_explained_var": 0.16509936678977238, "kl": 0.006003586359742788, "entropy": 0.6767553694033749, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 381.0, "episode_reward_min": -146.0, "episode_reward_mean": 66.82, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -194.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 191.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -75.25, "predator_policy": 108.66}, "custom_metrics": {}, "hist_stats": {"episode_reward": [294.0, 160.0, 15.0, 136.0, 38.0, 15.0, 36.0, 103.0, -47.0, 91.0, -19.0, 96.0, 155.0, 381.0, 106.0, 185.0, 213.0, 90.0, -92.0, 132.0, -146.0, 166.0, -96.0, 163.0, -60.0, 159.0, 111.0, 13.0, 105.0, 78.0, 15.0, 1.0, 14.0, 45.0, 109.0, 44.0, 73.0, -34.0, 294.0, 76.0, 17.0, -110.0, 150.0, 8.0, 95.0, -62.0, 155.0, 0.0, 92.0, 27.0, 72.0, 38.0, 82.0, 72.0, -32.0, 109.0, 37.0, 57.0, -10.0, 69.0, 115.0, 38.0, 67.0, 27.0, 107.0, 69.0, 115.0, -57.0, 100.0, 82.0, 131.0, -5.0, 69.0, 83.0, -60.0, 24.0, 40.0, -5.0, 76.0, 164.0, -35.0, 53.0, 60.0, 52.0, -66.0, 92.0, 118.0, 110.0, 94.0, 32.0, 132.0, 158.0, 36.0, 126.0, 94.0, 80.0, 102.0, 22.0, 92.0, 66.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [66.0, 143.0, 50.0, 2.0, -66.0, -77.0, 75.0, -1.0, -49.0, -106.0, -104.0, -148.0, -63.0, -41.0, -34.0, 6.0, -163.0, -133.0, -83.0, 0.0, -77.0, -141.0, 0.0, -136.0, 32.0, 3.0, 180.0, 191.0, -19.0, 0.0, 13.0, 72.0, 60.0, 78.0, -39.0, 0.0, -143.0, -127.0, -132.0, 0.0, -151.0, -193.0, 49.0, 31.0, -168.0, -192.0, 87.0, -18.0, -145.0, -147.0, -71.0, 13.0, -58.0, -54.0, -90.0, 2.0, -42.0, 21.0, -147.0, -65.0, -81.0, -56.0, -164.0, -182.0, -112.0, -27.0, -94.0, -60.0, -101.0, -73.0, 0.0, -107.0, -28.0, -94.0, -128.0, -91.0, 109.0, 114.0, -13.0, -116.0, -135.0, -144.0, -122.0, -176.0, 17.0, 12.0, -110.0, -167.0, -170.0, -69.0, -89.0, -166.0, -105.0, -2.0, -100.0, -194.0, -28.0, -25.0, -150.0, -108.0, -115.0, -112.0, -160.0, -162.0, -98.0, -136.0, -3.0, -136.0, -113.0, -148.0, -98.0, 14.0, -36.0, -64.0, 0.0, -85.0, -140.0, -168.0, -98.0, -140.0, -95.0, -4.0, -166.0, -177.0, -70.0, -58.0, -174.0, -126.0, -62.0, 0.0, -112.0, -125.0, -34.0, -14.0, -124.0, -135.0, -100.0, -80.0, -31.0, 0.0, 0.0, -109.0, -164.0, -119.0, -19.0, 0.0, -137.0, -153.0, -173.0, -189.0, -175.0, -152.0, -88.0, -126.0, -172.0, -170.0, 0.0, 3.0, -133.0, -1.0, -179.0, -180.0, -163.0, -123.0, -104.0, -159.0, -143.0, -135.0, -173.0, -124.0, -178.0, -19.0, -159.0, 0.0, -71.0, 0.0, -9.0, -32.0, -159.0, -194.0, 0.0, -121.0, -6.0, 0.0, -165.0, -100.0, 0.0, -187.0, -4.0, -144.0, -149.0, -3.0, -3.0, -99.0, 0.0, -146.0, 0.0, -145.0, -128.0, 0.0], "policy_predator_policy_reward": [35.0, 50.0, 107.0, 1.0, 147.0, 11.0, 61.0, 1.0, 49.0, 144.0, 86.0, 181.0, 14.0, 126.0, 39.0, 92.0, 65.0, 184.0, 57.0, 117.0, 179.0, 20.0, 162.0, 70.0, 20.0, 100.0, 0.0, 10.0, 71.0, 54.0, 8.0, 92.0, 1.0, 74.0, 106.0, 23.0, 4.0, 174.0, 129.0, 135.0, 0.0, 198.0, 86.0, 0.0, 188.0, 76.0, 88.0, 6.0, 64.0, 168.0, 104.0, 113.0, 101.0, 122.0, 101.0, 0.0, 11.0, 115.0, 154.0, 136.0, 133.0, 19.0, 197.0, 150.0, 0.0, 153.0, 23.0, 176.0, 133.0, 150.0, 3.0, 148.0, 143.0, 52.0, 165.0, 20.0, 26.0, 45.0, 78.0, 127.0, 119.0, 177.0, 188.0, 0.0, 121.0, 0.0, 104.0, 181.0, 164.0, 170.0, 14.0, 179.0, 119.0, 143.0, 180.0, 114.0, 113.0, 32.0, 115.0, 170.0, 161.0, 138.0, 190.0, 170.0, 148.0, 168.0, 93.0, 118.0, 46.0, 183.0, 67.0, 126.0, 137.0, 0.0, 51.0, 91.0, 186.0, 112.0, 157.0, 150.0, 121.0, 93.0, 186.0, 195.0, 132.0, 63.0, 185.0, 142.0, 125.0, 44.0, 151.0, 155.0, 35.0, 128.0, 23.0, 179.0, 124.0, 156.0, 0.0, 113.0, 116.0, 124.0, 102.0, 176.0, 55.0, 33.0, 187.0, 186.0, 102.0, 200.0, 192.0, 159.0, 88.0, 166.0, 190.0, 147.0, 43.0, 30.0, 137.0, 161.0, 188.0, 136.0, 158.0, 181.0, 145.0, 178.0, 146.0, 184.0, 44.0, 187.0, 114.0, 175.0, 146.0, 131.0, 84.0, 97.0, 10.0, 125.0, 185.0, 200.0, 108.0, 145.0, 99.0, 65.0, 146.0, 155.0, 131.0, 182.0, 134.0, 108.0, 84.0, 148.0, 112.0, 92.0, 163.0, 5.0, 164.0, 73.0, 65.0, 129.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5815581279016853, "mean_inference_ms": 1.3171839047248808, "mean_action_processing_ms": 0.23008536568020446, "mean_env_wait_ms": 0.17302220347137418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006506085395812988, "StateBufferConnector_ms": 0.0035227537155151367, "ViewRequirementAgentConnector_ms": 0.09934532642364502}, "num_episodes": 22, "episode_return_max": 381.0, "episode_return_min": -146.0, "episode_return_mean": 66.82, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.44310991154575, "num_env_steps_trained_throughput_per_sec": 88.44310991154575, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 45338.437, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45338.39, "sample_time_ms": 1190.596, "learn_time_ms": 44129.982, "learn_throughput": 90.641, "synch_weights_time_ms": 15.213}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 72, "trial_id": "51025_00000", "date": "2024-08-12_21-18-47", "timestamp": 1723511927, "time_this_iter_s": 45.253429889678955, "time_total_s": 3278.933132171631, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158b48ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3278.933132171631, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 20.6, "ram_util_percent": 80.96249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.102207714035398, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.697111134302048, "policy_loss": -0.016246769380898623, "vf_loss": 7.709651610460231, "vf_explained_var": 0.02681678151958203, "kl": 0.012354271613179637, "entropy": 1.1885774658470558, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.499337226120883, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.550284207056439, "policy_loss": -0.006703921617871081, "vf_loss": 8.556364102590651, "vf_explained_var": 0.2599460237240665, "kl": 0.006240144116287162, "entropy": 0.6893411351890161, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "env_runners": {"episode_reward_max": 294.0, "episode_reward_min": -110.0, "episode_reward_mean": 72.34, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -194.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 140.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -84.045, "predator_policy": 120.215}, "custom_metrics": {}, "hist_stats": {"episode_reward": [163.0, -60.0, 159.0, 111.0, 13.0, 105.0, 78.0, 15.0, 1.0, 14.0, 45.0, 109.0, 44.0, 73.0, -34.0, 294.0, 76.0, 17.0, -110.0, 150.0, 8.0, 95.0, -62.0, 155.0, 0.0, 92.0, 27.0, 72.0, 38.0, 82.0, 72.0, -32.0, 109.0, 37.0, 57.0, -10.0, 69.0, 115.0, 38.0, 67.0, 27.0, 107.0, 69.0, 115.0, -57.0, 100.0, 82.0, 131.0, -5.0, 69.0, 83.0, -60.0, 24.0, 40.0, -5.0, 76.0, 164.0, -35.0, 53.0, 60.0, 52.0, -66.0, 92.0, 118.0, 110.0, 94.0, 32.0, 132.0, 158.0, 36.0, 126.0, 94.0, 80.0, 102.0, 22.0, 92.0, 66.0, 287.0, 193.0, 83.0, 94.0, 22.0, 251.0, 33.0, 51.0, 64.0, 5.0, 116.0, 93.0, 129.0, 43.0, 93.0, 179.0, 171.0, 87.0, 292.0, 25.0, 149.0, 102.0, 2.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [87.0, -18.0, -145.0, -147.0, -71.0, 13.0, -58.0, -54.0, -90.0, 2.0, -42.0, 21.0, -147.0, -65.0, -81.0, -56.0, -164.0, -182.0, -112.0, -27.0, -94.0, -60.0, -101.0, -73.0, 0.0, -107.0, -28.0, -94.0, -128.0, -91.0, 109.0, 114.0, -13.0, -116.0, -135.0, -144.0, -122.0, -176.0, 17.0, 12.0, -110.0, -167.0, -170.0, -69.0, -89.0, -166.0, -105.0, -2.0, -100.0, -194.0, -28.0, -25.0, -150.0, -108.0, -115.0, -112.0, -160.0, -162.0, -98.0, -136.0, -3.0, -136.0, -113.0, -148.0, -98.0, 14.0, -36.0, -64.0, 0.0, -85.0, -140.0, -168.0, -98.0, -140.0, -95.0, -4.0, -166.0, -177.0, -70.0, -58.0, -174.0, -126.0, -62.0, 0.0, -112.0, -125.0, -34.0, -14.0, -124.0, -135.0, -100.0, -80.0, -31.0, 0.0, 0.0, -109.0, -164.0, -119.0, -19.0, 0.0, -137.0, -153.0, -173.0, -189.0, -175.0, -152.0, -88.0, -126.0, -172.0, -170.0, 0.0, 3.0, -133.0, -1.0, -179.0, -180.0, -163.0, -123.0, -104.0, -159.0, -143.0, -135.0, -173.0, -124.0, -178.0, -19.0, -159.0, 0.0, -71.0, 0.0, -9.0, -32.0, -159.0, -194.0, 0.0, -121.0, -6.0, 0.0, -165.0, -100.0, 0.0, -187.0, -4.0, -144.0, -149.0, -3.0, -3.0, -99.0, 0.0, -146.0, 0.0, -145.0, -128.0, 0.0, -64.0, 70.0, -12.0, -129.0, -147.0, -60.0, -155.0, 0.0, -152.0, 0.0, -149.0, 50.0, -168.0, -84.0, -161.0, -87.0, -168.0, 0.0, -179.0, -164.0, -34.0, -140.0, -62.0, 32.0, -3.0, 0.0, 0.0, -108.0, -134.0, -99.0, -54.0, -141.0, -162.0, 0.0, -50.0, -31.0, 140.0, 5.0, -152.0, -164.0, -83.0, 0.0, -9.0, -134.0, -114.0, -38.0], "policy_predator_policy_reward": [88.0, 6.0, 64.0, 168.0, 104.0, 113.0, 101.0, 122.0, 101.0, 0.0, 11.0, 115.0, 154.0, 136.0, 133.0, 19.0, 197.0, 150.0, 0.0, 153.0, 23.0, 176.0, 133.0, 150.0, 3.0, 148.0, 143.0, 52.0, 165.0, 20.0, 26.0, 45.0, 78.0, 127.0, 119.0, 177.0, 188.0, 0.0, 121.0, 0.0, 104.0, 181.0, 164.0, 170.0, 14.0, 179.0, 119.0, 143.0, 180.0, 114.0, 113.0, 32.0, 115.0, 170.0, 161.0, 138.0, 190.0, 170.0, 148.0, 168.0, 93.0, 118.0, 46.0, 183.0, 67.0, 126.0, 137.0, 0.0, 51.0, 91.0, 186.0, 112.0, 157.0, 150.0, 121.0, 93.0, 186.0, 195.0, 132.0, 63.0, 185.0, 142.0, 125.0, 44.0, 151.0, 155.0, 35.0, 128.0, 23.0, 179.0, 124.0, 156.0, 0.0, 113.0, 116.0, 124.0, 102.0, 176.0, 55.0, 33.0, 187.0, 186.0, 102.0, 200.0, 192.0, 159.0, 88.0, 166.0, 190.0, 147.0, 43.0, 30.0, 137.0, 161.0, 188.0, 136.0, 158.0, 181.0, 145.0, 178.0, 146.0, 184.0, 44.0, 187.0, 114.0, 175.0, 146.0, 131.0, 84.0, 97.0, 10.0, 125.0, 185.0, 200.0, 108.0, 145.0, 99.0, 65.0, 146.0, 155.0, 131.0, 182.0, 134.0, 108.0, 84.0, 148.0, 112.0, 92.0, 163.0, 5.0, 164.0, 73.0, 65.0, 129.0, 145.0, 136.0, 179.0, 155.0, 117.0, 173.0, 90.0, 159.0, 0.0, 174.0, 154.0, 196.0, 119.0, 166.0, 119.0, 180.0, 59.0, 173.0, 161.0, 187.0, 126.0, 164.0, 61.0, 62.0, 101.0, 31.0, 0.0, 151.0, 143.0, 183.0, 183.0, 191.0, 161.0, 172.0, 133.0, 35.0, 38.0, 109.0, 182.0, 159.0, 128.0, 104.0, 114.0, 131.0, 154.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5814733317927311, "mean_inference_ms": 1.3162761238818284, "mean_action_processing_ms": 0.22986580225464107, "mean_env_wait_ms": 0.17289845652209823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006644129753112793, "StateBufferConnector_ms": 0.00352632999420166, "ViewRequirementAgentConnector_ms": 0.09914696216583252}, "num_episodes": 23, "episode_return_max": 294.0, "episode_return_min": -110.0, "episode_return_mean": 72.34, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.78986899310028, "num_env_steps_trained_throughput_per_sec": 88.78986899310028, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 1168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 45308.165, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45308.118, "sample_time_ms": 1190.797, "learn_time_ms": 44100.322, "learn_throughput": 90.702, "synch_weights_time_ms": 14.723}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "done": false, "training_iteration": 73, "trial_id": "51025_00000", "date": "2024-08-12_21-19-32", "timestamp": 1723511972, "time_this_iter_s": 45.07297325134277, "time_total_s": 3324.0061054229736, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158b10940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3324.0061054229736, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 20.584375, "ram_util_percent": 80.9671875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.60959799163556, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.617989975813205, "policy_loss": -0.016098778919568138, "vf_loss": 6.631097585940487, "vf_explained_var": 0.19163492709871321, "kl": 0.009970570055570558, "entropy": 1.186449254315997, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 36.71211953163147, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.73570165987368, "policy_loss": -0.00666916553699781, "vf_loss": 8.741837274460565, "vf_explained_var": 0.085459609794869, "kl": 0.005335576931168636, "entropy": 0.7410131032189364, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "env_runners": {"episode_reward_max": 333.0, "episode_reward_min": -110.0, "episode_reward_mean": 91.38, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -194.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 147.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -75.545, "predator_policy": 121.235}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-110.0, 150.0, 8.0, 95.0, -62.0, 155.0, 0.0, 92.0, 27.0, 72.0, 38.0, 82.0, 72.0, -32.0, 109.0, 37.0, 57.0, -10.0, 69.0, 115.0, 38.0, 67.0, 27.0, 107.0, 69.0, 115.0, -57.0, 100.0, 82.0, 131.0, -5.0, 69.0, 83.0, -60.0, 24.0, 40.0, -5.0, 76.0, 164.0, -35.0, 53.0, 60.0, 52.0, -66.0, 92.0, 118.0, 110.0, 94.0, 32.0, 132.0, 158.0, 36.0, 126.0, 94.0, 80.0, 102.0, 22.0, 92.0, 66.0, 287.0, 193.0, 83.0, 94.0, 22.0, 251.0, 33.0, 51.0, 64.0, 5.0, 116.0, 93.0, 129.0, 43.0, 93.0, 179.0, 171.0, 87.0, 292.0, 25.0, 149.0, 102.0, 2.0, 77.0, 157.0, 144.0, 204.0, 133.0, 194.0, 89.0, 260.0, 266.0, 0.0, 100.0, 333.0, 285.0, 215.0, 151.0, 106.0, 126.0, 287.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-122.0, -176.0, 17.0, 12.0, -110.0, -167.0, -170.0, -69.0, -89.0, -166.0, -105.0, -2.0, -100.0, -194.0, -28.0, -25.0, -150.0, -108.0, -115.0, -112.0, -160.0, -162.0, -98.0, -136.0, -3.0, -136.0, -113.0, -148.0, -98.0, 14.0, -36.0, -64.0, 0.0, -85.0, -140.0, -168.0, -98.0, -140.0, -95.0, -4.0, -166.0, -177.0, -70.0, -58.0, -174.0, -126.0, -62.0, 0.0, -112.0, -125.0, -34.0, -14.0, -124.0, -135.0, -100.0, -80.0, -31.0, 0.0, 0.0, -109.0, -164.0, -119.0, -19.0, 0.0, -137.0, -153.0, -173.0, -189.0, -175.0, -152.0, -88.0, -126.0, -172.0, -170.0, 0.0, 3.0, -133.0, -1.0, -179.0, -180.0, -163.0, -123.0, -104.0, -159.0, -143.0, -135.0, -173.0, -124.0, -178.0, -19.0, -159.0, 0.0, -71.0, 0.0, -9.0, -32.0, -159.0, -194.0, 0.0, -121.0, -6.0, 0.0, -165.0, -100.0, 0.0, -187.0, -4.0, -144.0, -149.0, -3.0, -3.0, -99.0, 0.0, -146.0, 0.0, -145.0, -128.0, 0.0, -64.0, 70.0, -12.0, -129.0, -147.0, -60.0, -155.0, 0.0, -152.0, 0.0, -149.0, 50.0, -168.0, -84.0, -161.0, -87.0, -168.0, 0.0, -179.0, -164.0, -34.0, -140.0, -62.0, 32.0, -3.0, 0.0, 0.0, -108.0, -134.0, -99.0, -54.0, -141.0, -162.0, 0.0, -50.0, -31.0, 140.0, 5.0, -152.0, -164.0, -83.0, 0.0, -9.0, -134.0, -114.0, -38.0, 0.0, -172.0, -64.0, 0.0, -99.0, 0.0, 6.0, -71.0, 29.0, 0.0, 35.0, -107.0, -168.0, 0.0, 147.0, -166.0, 146.0, -81.0, 0.0, 0.0, -118.0, 0.0, 96.0, 99.0, 102.0, -16.0, -159.0, 92.0, 0.0, -24.0, 0.0, -95.0, 23.0, 0.0, -112.0, 80.0], "policy_predator_policy_reward": [188.0, 0.0, 121.0, 0.0, 104.0, 181.0, 164.0, 170.0, 14.0, 179.0, 119.0, 143.0, 180.0, 114.0, 113.0, 32.0, 115.0, 170.0, 161.0, 138.0, 190.0, 170.0, 148.0, 168.0, 93.0, 118.0, 46.0, 183.0, 67.0, 126.0, 137.0, 0.0, 51.0, 91.0, 186.0, 112.0, 157.0, 150.0, 121.0, 93.0, 186.0, 195.0, 132.0, 63.0, 185.0, 142.0, 125.0, 44.0, 151.0, 155.0, 35.0, 128.0, 23.0, 179.0, 124.0, 156.0, 0.0, 113.0, 116.0, 124.0, 102.0, 176.0, 55.0, 33.0, 187.0, 186.0, 102.0, 200.0, 192.0, 159.0, 88.0, 166.0, 190.0, 147.0, 43.0, 30.0, 137.0, 161.0, 188.0, 136.0, 158.0, 181.0, 145.0, 178.0, 146.0, 184.0, 44.0, 187.0, 114.0, 175.0, 146.0, 131.0, 84.0, 97.0, 10.0, 125.0, 185.0, 200.0, 108.0, 145.0, 99.0, 65.0, 146.0, 155.0, 131.0, 182.0, 134.0, 108.0, 84.0, 148.0, 112.0, 92.0, 163.0, 5.0, 164.0, 73.0, 65.0, 129.0, 145.0, 136.0, 179.0, 155.0, 117.0, 173.0, 90.0, 159.0, 0.0, 174.0, 154.0, 196.0, 119.0, 166.0, 119.0, 180.0, 59.0, 173.0, 161.0, 187.0, 126.0, 164.0, 61.0, 62.0, 101.0, 31.0, 0.0, 151.0, 143.0, 183.0, 183.0, 191.0, 161.0, 172.0, 133.0, 35.0, 38.0, 109.0, 182.0, 159.0, 128.0, 104.0, 114.0, 131.0, 154.0, 0.0, 105.0, 144.0, 115.0, 106.0, 136.0, 107.0, 142.0, 127.0, 74.0, 30.0, 118.0, 148.0, 77.0, 180.0, 94.0, 185.0, 66.0, 135.0, 0.0, 0.0, 104.0, 114.0, 72.0, 66.0, 104.0, 95.0, 175.0, 107.0, 109.0, 66.0, 69.0, 132.0, 56.0, 47.0, 161.0, 158.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5808025290370948, "mean_inference_ms": 1.3157127176144752, "mean_action_processing_ms": 0.22999334246349418, "mean_env_wait_ms": 0.17288424105636643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006118059158325195, "StateBufferConnector_ms": 0.0034755468368530273, "ViewRequirementAgentConnector_ms": 0.0978546142578125}, "num_episodes": 18, "episode_return_max": 333.0, "episode_return_min": -110.0, "episode_return_mean": 91.38, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.93734121877968, "num_env_steps_trained_throughput_per_sec": 88.93734121877968, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 1184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 45271.688, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45271.64, "sample_time_ms": 1194.433, "learn_time_ms": 44060.501, "learn_throughput": 90.784, "synch_weights_time_ms": 14.524}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "training_iteration": 74, "trial_id": "51025_00000", "date": "2024-08-12_21-20-17", "timestamp": 1723512017, "time_this_iter_s": 45.00981593132019, "time_total_s": 3369.015921354294, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1580623a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3369.015921354294, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 20.36875, "ram_util_percent": 80.825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.007392275837994, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.926067089908337, "policy_loss": -0.014923047786085773, "vf_loss": 6.9379936841429855, "vf_explained_var": 0.4456463061312519, "kl": 0.009988124067610332, "entropy": 1.1533512408140476, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 38.71687678962788, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.060795470646449, "policy_loss": -0.010933396686361264, "vf_loss": 8.0708035090613, "vf_explained_var": 0.30147279116211745, "kl": 0.009253449423299096, "entropy": 0.7534859810556684, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 340.0, "episode_reward_min": -66.0, "episode_reward_mean": 117.55, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -194.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 181.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -54.055, "predator_policy": 112.83}, "custom_metrics": {}, "hist_stats": {"episode_reward": [69.0, 115.0, 38.0, 67.0, 27.0, 107.0, 69.0, 115.0, -57.0, 100.0, 82.0, 131.0, -5.0, 69.0, 83.0, -60.0, 24.0, 40.0, -5.0, 76.0, 164.0, -35.0, 53.0, 60.0, 52.0, -66.0, 92.0, 118.0, 110.0, 94.0, 32.0, 132.0, 158.0, 36.0, 126.0, 94.0, 80.0, 102.0, 22.0, 92.0, 66.0, 287.0, 193.0, 83.0, 94.0, 22.0, 251.0, 33.0, 51.0, 64.0, 5.0, 116.0, 93.0, 129.0, 43.0, 93.0, 179.0, 171.0, 87.0, 292.0, 25.0, 149.0, 102.0, 2.0, 77.0, 157.0, 144.0, 204.0, 133.0, 194.0, 89.0, 260.0, 266.0, 0.0, 100.0, 333.0, 285.0, 215.0, 151.0, 106.0, 126.0, 287.0, 163.0, 130.0, 147.0, 247.0, 157.0, 340.0, 195.0, 332.0, 215.0, 123.0, 209.0, 137.0, 169.0, 156.0, 142.0, 218.0, 169.0, 148.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-98.0, -140.0, -95.0, -4.0, -166.0, -177.0, -70.0, -58.0, -174.0, -126.0, -62.0, 0.0, -112.0, -125.0, -34.0, -14.0, -124.0, -135.0, -100.0, -80.0, -31.0, 0.0, 0.0, -109.0, -164.0, -119.0, -19.0, 0.0, -137.0, -153.0, -173.0, -189.0, -175.0, -152.0, -88.0, -126.0, -172.0, -170.0, 0.0, 3.0, -133.0, -1.0, -179.0, -180.0, -163.0, -123.0, -104.0, -159.0, -143.0, -135.0, -173.0, -124.0, -178.0, -19.0, -159.0, 0.0, -71.0, 0.0, -9.0, -32.0, -159.0, -194.0, 0.0, -121.0, -6.0, 0.0, -165.0, -100.0, 0.0, -187.0, -4.0, -144.0, -149.0, -3.0, -3.0, -99.0, 0.0, -146.0, 0.0, -145.0, -128.0, 0.0, -64.0, 70.0, -12.0, -129.0, -147.0, -60.0, -155.0, 0.0, -152.0, 0.0, -149.0, 50.0, -168.0, -84.0, -161.0, -87.0, -168.0, 0.0, -179.0, -164.0, -34.0, -140.0, -62.0, 32.0, -3.0, 0.0, 0.0, -108.0, -134.0, -99.0, -54.0, -141.0, -162.0, 0.0, -50.0, -31.0, 140.0, 5.0, -152.0, -164.0, -83.0, 0.0, -9.0, -134.0, -114.0, -38.0, 0.0, -172.0, -64.0, 0.0, -99.0, 0.0, 6.0, -71.0, 29.0, 0.0, 35.0, -107.0, -168.0, 0.0, 147.0, -166.0, 146.0, -81.0, 0.0, 0.0, -118.0, 0.0, 96.0, 99.0, 102.0, -16.0, -159.0, 92.0, 0.0, -24.0, 0.0, -95.0, 23.0, 0.0, -112.0, 80.0, -135.0, -7.0, 0.0, 73.0, 37.0, 0.0, 118.0, -185.0, 0.0, 96.0, 181.0, 122.0, -184.0, 134.0, 147.0, 110.0, 24.0, -99.0, 0.0, 0.0, 36.0, 34.0, -77.0, 0.0, 35.0, -4.0, 0.0, 46.0, 91.0, -5.0, -41.0, 39.0, 0.0, 104.0, 96.0, 0.0], "policy_predator_policy_reward": [157.0, 150.0, 121.0, 93.0, 186.0, 195.0, 132.0, 63.0, 185.0, 142.0, 125.0, 44.0, 151.0, 155.0, 35.0, 128.0, 23.0, 179.0, 124.0, 156.0, 0.0, 113.0, 116.0, 124.0, 102.0, 176.0, 55.0, 33.0, 187.0, 186.0, 102.0, 200.0, 192.0, 159.0, 88.0, 166.0, 190.0, 147.0, 43.0, 30.0, 137.0, 161.0, 188.0, 136.0, 158.0, 181.0, 145.0, 178.0, 146.0, 184.0, 44.0, 187.0, 114.0, 175.0, 146.0, 131.0, 84.0, 97.0, 10.0, 125.0, 185.0, 200.0, 108.0, 145.0, 99.0, 65.0, 146.0, 155.0, 131.0, 182.0, 134.0, 108.0, 84.0, 148.0, 112.0, 92.0, 163.0, 5.0, 164.0, 73.0, 65.0, 129.0, 145.0, 136.0, 179.0, 155.0, 117.0, 173.0, 90.0, 159.0, 0.0, 174.0, 154.0, 196.0, 119.0, 166.0, 119.0, 180.0, 59.0, 173.0, 161.0, 187.0, 126.0, 164.0, 61.0, 62.0, 101.0, 31.0, 0.0, 151.0, 143.0, 183.0, 183.0, 191.0, 161.0, 172.0, 133.0, 35.0, 38.0, 109.0, 182.0, 159.0, 128.0, 104.0, 114.0, 131.0, 154.0, 0.0, 105.0, 144.0, 115.0, 106.0, 136.0, 107.0, 142.0, 127.0, 74.0, 30.0, 118.0, 148.0, 77.0, 180.0, 94.0, 185.0, 66.0, 135.0, 0.0, 0.0, 104.0, 114.0, 72.0, 66.0, 104.0, 95.0, 175.0, 107.0, 109.0, 66.0, 69.0, 132.0, 56.0, 47.0, 161.0, 158.0, 154.0, 151.0, 44.0, 13.0, 40.0, 70.0, 171.0, 143.0, 25.0, 36.0, 0.0, 37.0, 187.0, 58.0, 57.0, 18.0, 157.0, 133.0, 63.0, 60.0, 38.0, 101.0, 84.0, 130.0, 67.0, 71.0, 76.0, 34.0, 11.0, 45.0, 103.0, 117.0, 28.0, 37.0, 1.0, 51.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5804445492935936, "mean_inference_ms": 1.3148208390237395, "mean_action_processing_ms": 0.22991460187603663, "mean_env_wait_ms": 0.17283022723334338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005386471748352051, "StateBufferConnector_ms": 0.0031991004943847656, "ViewRequirementAgentConnector_ms": 0.09721648693084717}, "num_episodes": 18, "episode_return_max": 340.0, "episode_return_min": -66.0, "episode_return_mean": 117.55, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.88818199814065, "num_env_steps_trained_throughput_per_sec": 88.88818199814065, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 45275.756, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45275.708, "sample_time_ms": 1188.492, "learn_time_ms": 44070.705, "learn_throughput": 90.763, "synch_weights_time_ms": 14.428}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 75, "trial_id": "51025_00000", "date": "2024-08-12_21-21-02", "timestamp": 1723512062, "time_this_iter_s": 45.042725801467896, "time_total_s": 3414.0586471557617, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1580395e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3414.0586471557617, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 20.244444444444447, "ram_util_percent": 81.37936507936506}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.547321384167546, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.803117572441303, "policy_loss": -0.012671707188291722, "vf_loss": 6.813571835321094, "vf_explained_var": 0.5236590682514131, "kl": 0.00739154231527902, "entropy": 1.1581923532107519, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 42.500530492439474, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.365774707440977, "policy_loss": -0.009048367072162883, "vf_loss": 7.374136557150139, "vf_explained_var": 0.3059241589730379, "kl": 0.00686521113417798, "entropy": 0.7609393687790664, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "env_runners": {"episode_reward_max": 396.0, "episode_reward_min": -66.0, "episode_reward_mean": 153.71, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -194.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -22.545, "predator_policy": 99.4}, "custom_metrics": {}, "hist_stats": {"episode_reward": [53.0, 60.0, 52.0, -66.0, 92.0, 118.0, 110.0, 94.0, 32.0, 132.0, 158.0, 36.0, 126.0, 94.0, 80.0, 102.0, 22.0, 92.0, 66.0, 287.0, 193.0, 83.0, 94.0, 22.0, 251.0, 33.0, 51.0, 64.0, 5.0, 116.0, 93.0, 129.0, 43.0, 93.0, 179.0, 171.0, 87.0, 292.0, 25.0, 149.0, 102.0, 2.0, 77.0, 157.0, 144.0, 204.0, 133.0, 194.0, 89.0, 260.0, 266.0, 0.0, 100.0, 333.0, 285.0, 215.0, 151.0, 106.0, 126.0, 287.0, 163.0, 130.0, 147.0, 247.0, 157.0, 340.0, 195.0, 332.0, 215.0, 123.0, 209.0, 137.0, 169.0, 156.0, 142.0, 218.0, 169.0, 148.0, 113.0, 202.0, 144.0, 203.0, 342.0, 271.0, 256.0, 366.0, 0.0, 269.0, 176.0, 349.0, 183.0, 98.0, 168.0, 396.0, 296.0, 81.0, 207.0, 168.0, 372.0, 170.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-163.0, -123.0, -104.0, -159.0, -143.0, -135.0, -173.0, -124.0, -178.0, -19.0, -159.0, 0.0, -71.0, 0.0, -9.0, -32.0, -159.0, -194.0, 0.0, -121.0, -6.0, 0.0, -165.0, -100.0, 0.0, -187.0, -4.0, -144.0, -149.0, -3.0, -3.0, -99.0, 0.0, -146.0, 0.0, -145.0, -128.0, 0.0, -64.0, 70.0, -12.0, -129.0, -147.0, -60.0, -155.0, 0.0, -152.0, 0.0, -149.0, 50.0, -168.0, -84.0, -161.0, -87.0, -168.0, 0.0, -179.0, -164.0, -34.0, -140.0, -62.0, 32.0, -3.0, 0.0, 0.0, -108.0, -134.0, -99.0, -54.0, -141.0, -162.0, 0.0, -50.0, -31.0, 140.0, 5.0, -152.0, -164.0, -83.0, 0.0, -9.0, -134.0, -114.0, -38.0, 0.0, -172.0, -64.0, 0.0, -99.0, 0.0, 6.0, -71.0, 29.0, 0.0, 35.0, -107.0, -168.0, 0.0, 147.0, -166.0, 146.0, -81.0, 0.0, 0.0, -118.0, 0.0, 96.0, 99.0, 102.0, -16.0, -159.0, 92.0, 0.0, -24.0, 0.0, -95.0, 23.0, 0.0, -112.0, 80.0, -135.0, -7.0, 0.0, 73.0, 37.0, 0.0, 118.0, -185.0, 0.0, 96.0, 181.0, 122.0, -184.0, 134.0, 147.0, 110.0, 24.0, -99.0, 0.0, 0.0, 36.0, 34.0, -77.0, 0.0, 35.0, -4.0, 0.0, 46.0, 91.0, -5.0, -41.0, 39.0, 0.0, 104.0, 96.0, 0.0, 0.0, -84.0, 18.0, 32.0, 0.0, 70.0, -15.0, -52.0, 50.0, 167.0, 106.0, 41.0, -160.0, 99.0, 178.0, 143.0, -7.0, 0.0, 119.0, 64.0, 156.0, 0.0, 160.0, 130.0, 0.0, 183.0, 0.0, -3.0, -7.0, -126.0, 200.0, 170.0, -63.0, 141.0, -192.0, -43.0, 62.0, -58.0, 139.0, 0.0, 190.0, 0.0, 133.0, 0.0], "policy_predator_policy_reward": [158.0, 181.0, 145.0, 178.0, 146.0, 184.0, 44.0, 187.0, 114.0, 175.0, 146.0, 131.0, 84.0, 97.0, 10.0, 125.0, 185.0, 200.0, 108.0, 145.0, 99.0, 65.0, 146.0, 155.0, 131.0, 182.0, 134.0, 108.0, 84.0, 148.0, 112.0, 92.0, 163.0, 5.0, 164.0, 73.0, 65.0, 129.0, 145.0, 136.0, 179.0, 155.0, 117.0, 173.0, 90.0, 159.0, 0.0, 174.0, 154.0, 196.0, 119.0, 166.0, 119.0, 180.0, 59.0, 173.0, 161.0, 187.0, 126.0, 164.0, 61.0, 62.0, 101.0, 31.0, 0.0, 151.0, 143.0, 183.0, 183.0, 191.0, 161.0, 172.0, 133.0, 35.0, 38.0, 109.0, 182.0, 159.0, 128.0, 104.0, 114.0, 131.0, 154.0, 0.0, 105.0, 144.0, 115.0, 106.0, 136.0, 107.0, 142.0, 127.0, 74.0, 30.0, 118.0, 148.0, 77.0, 180.0, 94.0, 185.0, 66.0, 135.0, 0.0, 0.0, 104.0, 114.0, 72.0, 66.0, 104.0, 95.0, 175.0, 107.0, 109.0, 66.0, 69.0, 132.0, 56.0, 47.0, 161.0, 158.0, 154.0, 151.0, 44.0, 13.0, 40.0, 70.0, 171.0, 143.0, 25.0, 36.0, 0.0, 37.0, 187.0, 58.0, 57.0, 18.0, 157.0, 133.0, 63.0, 60.0, 38.0, 101.0, 84.0, 130.0, 67.0, 71.0, 76.0, 34.0, 11.0, 45.0, 103.0, 117.0, 28.0, 37.0, 1.0, 51.0, 136.0, 61.0, 56.0, 96.0, 38.0, 36.0, 159.0, 111.0, 47.0, 78.0, 86.0, 38.0, 149.0, 168.0, 24.0, 21.0, 7.0, 0.0, 86.0, 0.0, 20.0, 0.0, 31.0, 28.0, 0.0, 0.0, 0.0, 101.0, 152.0, 149.0, 14.0, 12.0, 109.0, 109.0, 120.0, 196.0, 118.0, 85.0, 15.0, 14.0, 96.0, 86.0, 33.0, 4.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5800057869756676, "mean_inference_ms": 1.3128722468104979, "mean_action_processing_ms": 0.22966096315161452, "mean_env_wait_ms": 0.17275010061050558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004444122314453125, "StateBufferConnector_ms": 0.0030733346939086914, "ViewRequirementAgentConnector_ms": 0.09294676780700684}, "num_episodes": 22, "episode_return_max": 396.0, "episode_return_min": -66.0, "episode_return_mean": 153.71, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 89.1927171003831, "num_env_steps_trained_throughput_per_sec": 89.1927171003831, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 1216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1216000, "timers": {"training_iteration_time_ms": 45239.537, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45239.491, "sample_time_ms": 1185.63, "learn_time_ms": 44039.049, "learn_throughput": 90.828, "synch_weights_time_ms": 13.064}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "done": false, "training_iteration": 76, "trial_id": "51025_00000", "date": "2024-08-12_21-21-47", "timestamp": 1723512107, "time_this_iter_s": 44.898340702056885, "time_total_s": 3458.9569878578186, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1580de430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3458.9569878578186, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 20.120312499999997, "ram_util_percent": 81.275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.780905417601268, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.894841096010158, "policy_loss": -0.011635494429898995, "vf_loss": 6.904453506419268, "vf_explained_var": 0.28399705066882747, "kl": 0.006743579236320777, "entropy": 1.1672907869651834, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 45.30105926876976, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.655504782742294, "policy_loss": -0.014281289712538224, "vf_loss": 6.668708370854615, "vf_explained_var": 0.34102739701195367, "kl": 0.01077707967023532, "entropy": 0.7373080440299221, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "env_runners": {"episode_reward_max": 396.0, "episode_reward_min": 0.0, "episode_reward_mean": 179.69, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -192.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 196.0}, "policy_reward_mean": {"prey_policy": 5.595, "predator_policy": 84.25}, "custom_metrics": {}, "hist_stats": {"episode_reward": [66.0, 287.0, 193.0, 83.0, 94.0, 22.0, 251.0, 33.0, 51.0, 64.0, 5.0, 116.0, 93.0, 129.0, 43.0, 93.0, 179.0, 171.0, 87.0, 292.0, 25.0, 149.0, 102.0, 2.0, 77.0, 157.0, 144.0, 204.0, 133.0, 194.0, 89.0, 260.0, 266.0, 0.0, 100.0, 333.0, 285.0, 215.0, 151.0, 106.0, 126.0, 287.0, 163.0, 130.0, 147.0, 247.0, 157.0, 340.0, 195.0, 332.0, 215.0, 123.0, 209.0, 137.0, 169.0, 156.0, 142.0, 218.0, 169.0, 148.0, 113.0, 202.0, 144.0, 203.0, 342.0, 271.0, 256.0, 366.0, 0.0, 269.0, 176.0, 349.0, 183.0, 98.0, 168.0, 396.0, 296.0, 81.0, 207.0, 168.0, 372.0, 170.0, 373.0, 93.0, 305.0, 193.0, 146.0, 368.0, 94.0, 124.0, 340.0, 78.0, 314.0, 346.0, 309.0, 48.0, 169.0, 313.0, 184.0, 188.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-128.0, 0.0, -64.0, 70.0, -12.0, -129.0, -147.0, -60.0, -155.0, 0.0, -152.0, 0.0, -149.0, 50.0, -168.0, -84.0, -161.0, -87.0, -168.0, 0.0, -179.0, -164.0, -34.0, -140.0, -62.0, 32.0, -3.0, 0.0, 0.0, -108.0, -134.0, -99.0, -54.0, -141.0, -162.0, 0.0, -50.0, -31.0, 140.0, 5.0, -152.0, -164.0, -83.0, 0.0, -9.0, -134.0, -114.0, -38.0, 0.0, -172.0, -64.0, 0.0, -99.0, 0.0, 6.0, -71.0, 29.0, 0.0, 35.0, -107.0, -168.0, 0.0, 147.0, -166.0, 146.0, -81.0, 0.0, 0.0, -118.0, 0.0, 96.0, 99.0, 102.0, -16.0, -159.0, 92.0, 0.0, -24.0, 0.0, -95.0, 23.0, 0.0, -112.0, 80.0, -135.0, -7.0, 0.0, 73.0, 37.0, 0.0, 118.0, -185.0, 0.0, 96.0, 181.0, 122.0, -184.0, 134.0, 147.0, 110.0, 24.0, -99.0, 0.0, 0.0, 36.0, 34.0, -77.0, 0.0, 35.0, -4.0, 0.0, 46.0, 91.0, -5.0, -41.0, 39.0, 0.0, 104.0, 96.0, 0.0, 0.0, -84.0, 18.0, 32.0, 0.0, 70.0, -15.0, -52.0, 50.0, 167.0, 106.0, 41.0, -160.0, 99.0, 178.0, 143.0, -7.0, 0.0, 119.0, 64.0, 156.0, 0.0, 160.0, 130.0, 0.0, 183.0, 0.0, -3.0, -7.0, -126.0, 200.0, 170.0, -63.0, 141.0, -192.0, -43.0, 62.0, -58.0, 139.0, 0.0, 190.0, 0.0, 133.0, 0.0, 145.0, 152.0, -32.0, 0.0, 140.0, 75.0, 183.0, 0.0, 0.0, 78.0, 147.0, 179.0, -6.0, -22.0, -2.0, 38.0, 106.0, 176.0, -98.0, -102.0, 53.0, 126.0, 158.0, 166.0, 131.0, 122.0, -27.0, -95.0, 139.0, 0.0, 192.0, 60.0, 0.0, 166.0, 19.0, 44.0], "policy_predator_policy_reward": [65.0, 129.0, 145.0, 136.0, 179.0, 155.0, 117.0, 173.0, 90.0, 159.0, 0.0, 174.0, 154.0, 196.0, 119.0, 166.0, 119.0, 180.0, 59.0, 173.0, 161.0, 187.0, 126.0, 164.0, 61.0, 62.0, 101.0, 31.0, 0.0, 151.0, 143.0, 183.0, 183.0, 191.0, 161.0, 172.0, 133.0, 35.0, 38.0, 109.0, 182.0, 159.0, 128.0, 104.0, 114.0, 131.0, 154.0, 0.0, 105.0, 144.0, 115.0, 106.0, 136.0, 107.0, 142.0, 127.0, 74.0, 30.0, 118.0, 148.0, 77.0, 180.0, 94.0, 185.0, 66.0, 135.0, 0.0, 0.0, 104.0, 114.0, 72.0, 66.0, 104.0, 95.0, 175.0, 107.0, 109.0, 66.0, 69.0, 132.0, 56.0, 47.0, 161.0, 158.0, 154.0, 151.0, 44.0, 13.0, 40.0, 70.0, 171.0, 143.0, 25.0, 36.0, 0.0, 37.0, 187.0, 58.0, 57.0, 18.0, 157.0, 133.0, 63.0, 60.0, 38.0, 101.0, 84.0, 130.0, 67.0, 71.0, 76.0, 34.0, 11.0, 45.0, 103.0, 117.0, 28.0, 37.0, 1.0, 51.0, 136.0, 61.0, 56.0, 96.0, 38.0, 36.0, 159.0, 111.0, 47.0, 78.0, 86.0, 38.0, 149.0, 168.0, 24.0, 21.0, 7.0, 0.0, 86.0, 0.0, 20.0, 0.0, 31.0, 28.0, 0.0, 0.0, 0.0, 101.0, 152.0, 149.0, 14.0, 12.0, 109.0, 109.0, 120.0, 196.0, 118.0, 85.0, 15.0, 14.0, 96.0, 86.0, 33.0, 4.0, 38.0, 38.0, 113.0, 12.0, 43.0, 47.0, 8.0, 2.0, 9.0, 59.0, 27.0, 15.0, 111.0, 11.0, 13.0, 75.0, 0.0, 58.0, 95.0, 183.0, 69.0, 66.0, 22.0, 0.0, 46.0, 10.0, 155.0, 15.0, 21.0, 9.0, 53.0, 8.0, 8.0, 10.0, 25.0, 100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5796435724267865, "mean_inference_ms": 1.3127247270126674, "mean_action_processing_ms": 0.2297108387394595, "mean_env_wait_ms": 0.1727134032927741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036525726318359375, "StateBufferConnector_ms": 0.0029115676879882812, "ViewRequirementAgentConnector_ms": 0.08978021144866943}, "num_episodes": 18, "episode_return_max": 396.0, "episode_return_min": 0.0, "episode_return_mean": 179.69, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 89.71146529100234, "num_env_steps_trained_throughput_per_sec": 89.71146529100234, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 1232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1232000, "timers": {"training_iteration_time_ms": 44983.174, "restore_workers_time_ms": 0.013, "training_step_time_ms": 44983.128, "sample_time_ms": 1051.936, "learn_time_ms": 43916.61, "learn_throughput": 91.082, "synch_weights_time_ms": 12.93}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "done": false, "training_iteration": 77, "trial_id": "51025_00000", "date": "2024-08-12_21-22-31", "timestamp": 1723512151, "time_this_iter_s": 44.59320688247681, "time_total_s": 3503.5501947402954, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158b48f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3503.5501947402954, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 19.830158730158725, "ram_util_percent": 81.28095238095234}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.702505710768321, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.792635640139302, "policy_loss": -0.013900157428351502, "vf_loss": 7.803903668519681, "vf_explained_var": 0.08469239728791374, "kl": 0.008773716668438316, "entropy": 1.1332280681246802, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 41.569902900665525, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.490947334854691, "policy_loss": -0.00935163984725636, "vf_loss": 6.499443134933553, "vf_explained_var": 0.34469829255310946, "kl": 0.008558299226085959, "entropy": 0.6616230741379753, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 396.0, "episode_reward_min": 0.0, "episode_reward_mean": 195.95, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -192.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 196.0}, "policy_reward_mean": {"prey_policy": 30.155, "predator_policy": 67.82}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 77.0, 157.0, 144.0, 204.0, 133.0, 194.0, 89.0, 260.0, 266.0, 0.0, 100.0, 333.0, 285.0, 215.0, 151.0, 106.0, 126.0, 287.0, 163.0, 130.0, 147.0, 247.0, 157.0, 340.0, 195.0, 332.0, 215.0, 123.0, 209.0, 137.0, 169.0, 156.0, 142.0, 218.0, 169.0, 148.0, 113.0, 202.0, 144.0, 203.0, 342.0, 271.0, 256.0, 366.0, 0.0, 269.0, 176.0, 349.0, 183.0, 98.0, 168.0, 396.0, 296.0, 81.0, 207.0, 168.0, 372.0, 170.0, 373.0, 93.0, 305.0, 193.0, 146.0, 368.0, 94.0, 124.0, 340.0, 78.0, 314.0, 346.0, 309.0, 48.0, 169.0, 313.0, 184.0, 188.0, 178.0, 130.0, 146.0, 88.0, 394.0, 97.0, 178.0, 336.0, 73.0, 200.0, 168.0, 200.0, 73.0, 331.0, 116.0, 159.0, 164.0, 235.0, 368.0, 197.0, 199.0, 77.0, 147.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-114.0, -38.0, 0.0, -172.0, -64.0, 0.0, -99.0, 0.0, 6.0, -71.0, 29.0, 0.0, 35.0, -107.0, -168.0, 0.0, 147.0, -166.0, 146.0, -81.0, 0.0, 0.0, -118.0, 0.0, 96.0, 99.0, 102.0, -16.0, -159.0, 92.0, 0.0, -24.0, 0.0, -95.0, 23.0, 0.0, -112.0, 80.0, -135.0, -7.0, 0.0, 73.0, 37.0, 0.0, 118.0, -185.0, 0.0, 96.0, 181.0, 122.0, -184.0, 134.0, 147.0, 110.0, 24.0, -99.0, 0.0, 0.0, 36.0, 34.0, -77.0, 0.0, 35.0, -4.0, 0.0, 46.0, 91.0, -5.0, -41.0, 39.0, 0.0, 104.0, 96.0, 0.0, 0.0, -84.0, 18.0, 32.0, 0.0, 70.0, -15.0, -52.0, 50.0, 167.0, 106.0, 41.0, -160.0, 99.0, 178.0, 143.0, -7.0, 0.0, 119.0, 64.0, 156.0, 0.0, 160.0, 130.0, 0.0, 183.0, 0.0, -3.0, -7.0, -126.0, 200.0, 170.0, -63.0, 141.0, -192.0, -43.0, 62.0, -58.0, 139.0, 0.0, 190.0, 0.0, 133.0, 0.0, 145.0, 152.0, -32.0, 0.0, 140.0, 75.0, 183.0, 0.0, 0.0, 78.0, 147.0, 179.0, -6.0, -22.0, -2.0, 38.0, 106.0, 176.0, -98.0, -102.0, 53.0, 126.0, 158.0, 166.0, 131.0, 122.0, -27.0, -95.0, 139.0, 0.0, 192.0, 60.0, 0.0, 166.0, 19.0, 44.0, 156.0, -2.0, 36.0, 3.0, 0.0, 70.0, 16.0, -106.0, 194.0, 184.0, -38.0, -11.0, 74.0, -126.0, 149.0, 181.0, -56.0, 0.0, 0.0, 200.0, 0.0, 163.0, 200.0, 0.0, 0.0, -64.0, 162.0, 128.0, -40.0, -34.0, 20.0, -10.0, -43.0, -42.0, 18.0, 108.0, 198.0, 159.0, 89.0, -92.0, 198.0, 0.0, -152.0, -18.0, -162.0, -68.0], "policy_predator_policy_reward": [154.0, 0.0, 105.0, 144.0, 115.0, 106.0, 136.0, 107.0, 142.0, 127.0, 74.0, 30.0, 118.0, 148.0, 77.0, 180.0, 94.0, 185.0, 66.0, 135.0, 0.0, 0.0, 104.0, 114.0, 72.0, 66.0, 104.0, 95.0, 175.0, 107.0, 109.0, 66.0, 69.0, 132.0, 56.0, 47.0, 161.0, 158.0, 154.0, 151.0, 44.0, 13.0, 40.0, 70.0, 171.0, 143.0, 25.0, 36.0, 0.0, 37.0, 187.0, 58.0, 57.0, 18.0, 157.0, 133.0, 63.0, 60.0, 38.0, 101.0, 84.0, 130.0, 67.0, 71.0, 76.0, 34.0, 11.0, 45.0, 103.0, 117.0, 28.0, 37.0, 1.0, 51.0, 136.0, 61.0, 56.0, 96.0, 38.0, 36.0, 159.0, 111.0, 47.0, 78.0, 86.0, 38.0, 149.0, 168.0, 24.0, 21.0, 7.0, 0.0, 86.0, 0.0, 20.0, 0.0, 31.0, 28.0, 0.0, 0.0, 0.0, 101.0, 152.0, 149.0, 14.0, 12.0, 109.0, 109.0, 120.0, 196.0, 118.0, 85.0, 15.0, 14.0, 96.0, 86.0, 33.0, 4.0, 38.0, 38.0, 113.0, 12.0, 43.0, 47.0, 8.0, 2.0, 9.0, 59.0, 27.0, 15.0, 111.0, 11.0, 13.0, 75.0, 0.0, 58.0, 95.0, 183.0, 69.0, 66.0, 22.0, 0.0, 46.0, 10.0, 155.0, 15.0, 21.0, 9.0, 53.0, 8.0, 8.0, 10.0, 25.0, 100.0, 0.0, 24.0, 2.0, 89.0, 14.0, 62.0, 146.0, 32.0, 6.0, 10.0, 63.0, 83.0, 173.0, 57.0, 0.0, 6.0, 125.0, 4.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 7.0, 130.0, 0.0, 41.0, 162.0, 28.0, 119.0, 30.0, 137.0, 112.0, 14.0, 95.0, 0.0, 11.0, 55.0, 145.0, 1.0, 0.0, 70.0, 177.0, 195.0, 182.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5790659239083233, "mean_inference_ms": 1.311122201081186, "mean_action_processing_ms": 0.22954941606538867, "mean_env_wait_ms": 0.17260634557244697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033423900604248047, "StateBufferConnector_ms": 0.0029382705688476562, "ViewRequirementAgentConnector_ms": 0.0906071662902832}, "num_episodes": 23, "episode_return_max": 396.0, "episode_return_min": 0.0, "episode_return_mean": 195.95, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 87.1601616992664, "num_env_steps_trained_throughput_per_sec": 87.1601616992664, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 45079.453, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45079.407, "sample_time_ms": 1041.679, "learn_time_ms": 44022.963, "learn_throughput": 90.862, "synch_weights_time_ms": 13.029}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 78, "trial_id": "51025_00000", "date": "2024-08-12_21-23-17", "timestamp": 1723512197, "time_this_iter_s": 45.936755895614624, "time_total_s": 3549.48695063591, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158000f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3549.48695063591, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 25.18923076923077, "ram_util_percent": 81.91538461538461}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.795503539824612, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.992819993458097, "policy_loss": -0.012325894452444223, "vf_loss": 8.002933670477892, "vf_explained_var": -0.1437190100944862, "kl": 0.007374140564177882, "entropy": 1.103346016987291, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.2556690433038, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.748576633261625, "policy_loss": -0.008320370081580545, "vf_loss": 6.755841471909215, "vf_explained_var": 0.3371569488729749, "kl": 0.010555427300552133, "entropy": 0.675831224962517, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "env_runners": {"episode_reward_max": 396.0, "episode_reward_min": -63.0, "episode_reward_mean": 189.57, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -192.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 196.0}, "policy_reward_mean": {"prey_policy": 32.46, "predator_policy": 62.325}, "custom_metrics": {}, "hist_stats": {"episode_reward": [287.0, 163.0, 130.0, 147.0, 247.0, 157.0, 340.0, 195.0, 332.0, 215.0, 123.0, 209.0, 137.0, 169.0, 156.0, 142.0, 218.0, 169.0, 148.0, 113.0, 202.0, 144.0, 203.0, 342.0, 271.0, 256.0, 366.0, 0.0, 269.0, 176.0, 349.0, 183.0, 98.0, 168.0, 396.0, 296.0, 81.0, 207.0, 168.0, 372.0, 170.0, 373.0, 93.0, 305.0, 193.0, 146.0, 368.0, 94.0, 124.0, 340.0, 78.0, 314.0, 346.0, 309.0, 48.0, 169.0, 313.0, 184.0, 188.0, 178.0, 130.0, 146.0, 88.0, 394.0, 97.0, 178.0, 336.0, 73.0, 200.0, 168.0, 200.0, 73.0, 331.0, 116.0, 159.0, 164.0, 235.0, 368.0, 197.0, 199.0, 77.0, 147.0, 379.0, 315.0, 135.0, 87.0, -53.0, 337.0, 130.0, 20.0, 4.0, 70.0, 158.0, 204.0, -63.0, 146.0, 171.0, 64.0, 100.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-112.0, 80.0, -135.0, -7.0, 0.0, 73.0, 37.0, 0.0, 118.0, -185.0, 0.0, 96.0, 181.0, 122.0, -184.0, 134.0, 147.0, 110.0, 24.0, -99.0, 0.0, 0.0, 36.0, 34.0, -77.0, 0.0, 35.0, -4.0, 0.0, 46.0, 91.0, -5.0, -41.0, 39.0, 0.0, 104.0, 96.0, 0.0, 0.0, -84.0, 18.0, 32.0, 0.0, 70.0, -15.0, -52.0, 50.0, 167.0, 106.0, 41.0, -160.0, 99.0, 178.0, 143.0, -7.0, 0.0, 119.0, 64.0, 156.0, 0.0, 160.0, 130.0, 0.0, 183.0, 0.0, -3.0, -7.0, -126.0, 200.0, 170.0, -63.0, 141.0, -192.0, -43.0, 62.0, -58.0, 139.0, 0.0, 190.0, 0.0, 133.0, 0.0, 145.0, 152.0, -32.0, 0.0, 140.0, 75.0, 183.0, 0.0, 0.0, 78.0, 147.0, 179.0, -6.0, -22.0, -2.0, 38.0, 106.0, 176.0, -98.0, -102.0, 53.0, 126.0, 158.0, 166.0, 131.0, 122.0, -27.0, -95.0, 139.0, 0.0, 192.0, 60.0, 0.0, 166.0, 19.0, 44.0, 156.0, -2.0, 36.0, 3.0, 0.0, 70.0, 16.0, -106.0, 194.0, 184.0, -38.0, -11.0, 74.0, -126.0, 149.0, 181.0, -56.0, 0.0, 0.0, 200.0, 0.0, 163.0, 200.0, 0.0, 0.0, -64.0, 162.0, 128.0, -40.0, -34.0, 20.0, -10.0, -43.0, -42.0, 18.0, 108.0, 198.0, 159.0, 89.0, -92.0, 198.0, 0.0, -152.0, -18.0, -162.0, -68.0, 197.0, 138.0, 126.0, 172.0, 70.0, 0.0, -56.0, -6.0, -129.0, -152.0, 182.0, 111.0, -66.0, 2.0, -117.0, -75.0, -116.0, -102.0, -64.0, 0.0, 92.0, 0.0, 61.0, 26.0, -140.0, -111.0, 108.0, 0.0, 0.0, 145.0, -191.0, -34.0, -70.0, 14.0, -161.0, -110.0], "policy_predator_policy_reward": [161.0, 158.0, 154.0, 151.0, 44.0, 13.0, 40.0, 70.0, 171.0, 143.0, 25.0, 36.0, 0.0, 37.0, 187.0, 58.0, 57.0, 18.0, 157.0, 133.0, 63.0, 60.0, 38.0, 101.0, 84.0, 130.0, 67.0, 71.0, 76.0, 34.0, 11.0, 45.0, 103.0, 117.0, 28.0, 37.0, 1.0, 51.0, 136.0, 61.0, 56.0, 96.0, 38.0, 36.0, 159.0, 111.0, 47.0, 78.0, 86.0, 38.0, 149.0, 168.0, 24.0, 21.0, 7.0, 0.0, 86.0, 0.0, 20.0, 0.0, 31.0, 28.0, 0.0, 0.0, 0.0, 101.0, 152.0, 149.0, 14.0, 12.0, 109.0, 109.0, 120.0, 196.0, 118.0, 85.0, 15.0, 14.0, 96.0, 86.0, 33.0, 4.0, 38.0, 38.0, 113.0, 12.0, 43.0, 47.0, 8.0, 2.0, 9.0, 59.0, 27.0, 15.0, 111.0, 11.0, 13.0, 75.0, 0.0, 58.0, 95.0, 183.0, 69.0, 66.0, 22.0, 0.0, 46.0, 10.0, 155.0, 15.0, 21.0, 9.0, 53.0, 8.0, 8.0, 10.0, 25.0, 100.0, 0.0, 24.0, 2.0, 89.0, 14.0, 62.0, 146.0, 32.0, 6.0, 10.0, 63.0, 83.0, 173.0, 57.0, 0.0, 6.0, 125.0, 4.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 7.0, 130.0, 0.0, 41.0, 162.0, 28.0, 119.0, 30.0, 137.0, 112.0, 14.0, 95.0, 0.0, 11.0, 55.0, 145.0, 1.0, 0.0, 70.0, 177.0, 195.0, 182.0, 25.0, 19.0, 4.0, 13.0, 3.0, 62.0, 115.0, 34.0, 184.0, 44.0, 29.0, 15.0, 43.0, 151.0, 51.0, 161.0, 174.0, 48.0, 130.0, 4.0, 54.0, 12.0, 86.0, 31.0, 188.0, 0.0, 6.0, 32.0, 11.0, 15.0, 161.0, 128.0, 128.0, 28.0, 155.0, 116.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5787341449470458, "mean_inference_ms": 1.3102909343117002, "mean_action_processing_ms": 0.22947803179987097, "mean_env_wait_ms": 0.1725811766987082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034035444259643555, "StateBufferConnector_ms": 0.002989053726196289, "ViewRequirementAgentConnector_ms": 0.09292662143707275}, "num_episodes": 18, "episode_return_max": 396.0, "episode_return_min": -63.0, "episode_return_mean": 189.57, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 87.43086610656637, "num_env_steps_trained_throughput_per_sec": 87.43086610656637, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 1264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1264000, "timers": {"training_iteration_time_ms": 45152.959, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45152.911, "sample_time_ms": 1054.085, "learn_time_ms": 44083.786, "learn_throughput": 90.736, "synch_weights_time_ms": 12.963}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "done": false, "training_iteration": 79, "trial_id": "51025_00000", "date": "2024-08-12_21-24-03", "timestamp": 1723512243, "time_this_iter_s": 45.81390619277954, "time_total_s": 3595.3008568286896, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158b485e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3595.3008568286896, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 24.365624999999998, "ram_util_percent": 81.9265625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.27895683466442, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.458275815671083, "policy_loss": -0.014049527842413496, "vf_loss": 7.469714922375149, "vf_explained_var": -0.06190513836012946, "kl": 0.008701411790598993, "entropy": 1.0452621997979583, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.803063815737527, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.249010592162924, "policy_loss": -0.010235058851466174, "vf_loss": 6.258549770728621, "vf_explained_var": 0.3091736026226528, "kl": 0.006958861972340119, "entropy": 0.6968694359221786, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 396.0, "episode_reward_min": -63.0, "episode_reward_mean": 178.63, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -192.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 196.0}, "policy_reward_mean": {"prey_policy": 28.19, "predator_policy": 61.125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [203.0, 342.0, 271.0, 256.0, 366.0, 0.0, 269.0, 176.0, 349.0, 183.0, 98.0, 168.0, 396.0, 296.0, 81.0, 207.0, 168.0, 372.0, 170.0, 373.0, 93.0, 305.0, 193.0, 146.0, 368.0, 94.0, 124.0, 340.0, 78.0, 314.0, 346.0, 309.0, 48.0, 169.0, 313.0, 184.0, 188.0, 178.0, 130.0, 146.0, 88.0, 394.0, 97.0, 178.0, 336.0, 73.0, 200.0, 168.0, 200.0, 73.0, 331.0, 116.0, 159.0, 164.0, 235.0, 368.0, 197.0, 199.0, 77.0, 147.0, 379.0, 315.0, 135.0, 87.0, -53.0, 337.0, 130.0, 20.0, 4.0, 70.0, 158.0, 204.0, -63.0, 146.0, 171.0, 64.0, 100.0, 0.0, 277.0, 62.0, 184.0, 112.0, 144.0, 89.0, 74.0, 292.0, 372.0, -50.0, 240.0, 49.0, 89.0, 227.0, 105.0, 51.0, -8.0, 167.0, 26.0, 183.0, 326.0, 38.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-15.0, -52.0, 50.0, 167.0, 106.0, 41.0, -160.0, 99.0, 178.0, 143.0, -7.0, 0.0, 119.0, 64.0, 156.0, 0.0, 160.0, 130.0, 0.0, 183.0, 0.0, -3.0, -7.0, -126.0, 200.0, 170.0, -63.0, 141.0, -192.0, -43.0, 62.0, -58.0, 139.0, 0.0, 190.0, 0.0, 133.0, 0.0, 145.0, 152.0, -32.0, 0.0, 140.0, 75.0, 183.0, 0.0, 0.0, 78.0, 147.0, 179.0, -6.0, -22.0, -2.0, 38.0, 106.0, 176.0, -98.0, -102.0, 53.0, 126.0, 158.0, 166.0, 131.0, 122.0, -27.0, -95.0, 139.0, 0.0, 192.0, 60.0, 0.0, 166.0, 19.0, 44.0, 156.0, -2.0, 36.0, 3.0, 0.0, 70.0, 16.0, -106.0, 194.0, 184.0, -38.0, -11.0, 74.0, -126.0, 149.0, 181.0, -56.0, 0.0, 0.0, 200.0, 0.0, 163.0, 200.0, 0.0, 0.0, -64.0, 162.0, 128.0, -40.0, -34.0, 20.0, -10.0, -43.0, -42.0, 18.0, 108.0, 198.0, 159.0, 89.0, -92.0, 198.0, 0.0, -152.0, -18.0, -162.0, -68.0, 197.0, 138.0, 126.0, 172.0, 70.0, 0.0, -56.0, -6.0, -129.0, -152.0, 182.0, 111.0, -66.0, 2.0, -117.0, -75.0, -116.0, -102.0, -64.0, 0.0, 92.0, 0.0, 61.0, 26.0, -140.0, -111.0, 108.0, 0.0, 0.0, 145.0, -191.0, -34.0, -70.0, 14.0, -161.0, -110.0, 200.0, 52.0, -173.0, 0.0, 58.0, 32.0, -57.0, -56.0, -62.0, -2.0, 0.0, -69.0, -11.0, -170.0, 63.0, 165.0, 160.0, 191.0, -127.0, -129.0, -84.0, 128.0, -108.0, 0.0, -3.0, -19.0, 80.0, 88.0, 11.0, 0.0, -22.0, -114.0, -116.0, -62.0, 0.0, 134.0, 0.0, -138.0, -29.0, 88.0, 144.0, 143.0, -80.0, -170.0], "policy_predator_policy_reward": [159.0, 111.0, 47.0, 78.0, 86.0, 38.0, 149.0, 168.0, 24.0, 21.0, 7.0, 0.0, 86.0, 0.0, 20.0, 0.0, 31.0, 28.0, 0.0, 0.0, 0.0, 101.0, 152.0, 149.0, 14.0, 12.0, 109.0, 109.0, 120.0, 196.0, 118.0, 85.0, 15.0, 14.0, 96.0, 86.0, 33.0, 4.0, 38.0, 38.0, 113.0, 12.0, 43.0, 47.0, 8.0, 2.0, 9.0, 59.0, 27.0, 15.0, 111.0, 11.0, 13.0, 75.0, 0.0, 58.0, 95.0, 183.0, 69.0, 66.0, 22.0, 0.0, 46.0, 10.0, 155.0, 15.0, 21.0, 9.0, 53.0, 8.0, 8.0, 10.0, 25.0, 100.0, 0.0, 24.0, 2.0, 89.0, 14.0, 62.0, 146.0, 32.0, 6.0, 10.0, 63.0, 83.0, 173.0, 57.0, 0.0, 6.0, 125.0, 4.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 7.0, 130.0, 0.0, 41.0, 162.0, 28.0, 119.0, 30.0, 137.0, 112.0, 14.0, 95.0, 0.0, 11.0, 55.0, 145.0, 1.0, 0.0, 70.0, 177.0, 195.0, 182.0, 25.0, 19.0, 4.0, 13.0, 3.0, 62.0, 115.0, 34.0, 184.0, 44.0, 29.0, 15.0, 43.0, 151.0, 51.0, 161.0, 174.0, 48.0, 130.0, 4.0, 54.0, 12.0, 86.0, 31.0, 188.0, 0.0, 6.0, 32.0, 11.0, 15.0, 161.0, 128.0, 128.0, 28.0, 155.0, 116.0, 12.0, 13.0, 185.0, 50.0, 94.0, 0.0, 104.0, 121.0, 102.0, 106.0, 41.0, 117.0, 163.0, 92.0, 0.0, 64.0, 20.0, 1.0, 171.0, 35.0, 111.0, 85.0, 7.0, 150.0, 57.0, 54.0, 2.0, 57.0, 4.0, 90.0, 173.0, 14.0, 0.0, 170.0, 0.0, 33.0, 164.0, 0.0, 0.0, 124.0, 0.0, 39.0, 94.0, 194.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5783847619525168, "mean_inference_ms": 1.3086046499714632, "mean_action_processing_ms": 0.22930638155102667, "mean_env_wait_ms": 0.17257337140199375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003450632095336914, "StateBufferConnector_ms": 0.0029838085174560547, "ViewRequirementAgentConnector_ms": 0.09320640563964844}, "num_episodes": 22, "episode_return_max": 396.0, "episode_return_min": -63.0, "episode_return_mean": 178.63, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 87.73866228769374, "num_env_steps_trained_throughput_per_sec": 87.73866228769374, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 45218.496, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45218.449, "sample_time_ms": 1049.952, "learn_time_ms": 44153.129, "learn_throughput": 90.594, "synch_weights_time_ms": 13.091}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 80, "trial_id": "51025_00000", "date": "2024-08-12_21-24-49", "timestamp": 1723512289, "time_this_iter_s": 45.64885663986206, "time_total_s": 3640.9497134685516, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1580764c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3640.9497134685516, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 21.71076923076923, "ram_util_percent": 81.54615384615384}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.47122988688252, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.409035050427472, "policy_loss": -0.01088830429109592, "vf_loss": 7.4179280773041745, "vf_explained_var": -0.5516815881249766, "kl": 0.006650889802659677, "entropy": 0.9917993309636596, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.672070001294372, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.602591837524737, "policy_loss": -0.0077118614641703154, "vf_loss": 7.609713514772042, "vf_explained_var": 0.27553450332747564, "kl": 0.005901777460619853, "entropy": 0.6750531881259232, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 394.0, "episode_reward_min": -63.0, "episode_reward_mean": 157.54, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -198.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": 13.985, "predator_policy": 64.785}, "custom_metrics": {}, "hist_stats": {"episode_reward": [170.0, 373.0, 93.0, 305.0, 193.0, 146.0, 368.0, 94.0, 124.0, 340.0, 78.0, 314.0, 346.0, 309.0, 48.0, 169.0, 313.0, 184.0, 188.0, 178.0, 130.0, 146.0, 88.0, 394.0, 97.0, 178.0, 336.0, 73.0, 200.0, 168.0, 200.0, 73.0, 331.0, 116.0, 159.0, 164.0, 235.0, 368.0, 197.0, 199.0, 77.0, 147.0, 379.0, 315.0, 135.0, 87.0, -53.0, 337.0, 130.0, 20.0, 4.0, 70.0, 158.0, 204.0, -63.0, 146.0, 171.0, 64.0, 100.0, 0.0, 277.0, 62.0, 184.0, 112.0, 144.0, 89.0, 74.0, 292.0, 372.0, -50.0, 240.0, 49.0, 89.0, 227.0, 105.0, 51.0, -8.0, 167.0, 26.0, 183.0, 326.0, 38.0, 39.0, 254.0, 225.0, 114.0, 149.0, 91.0, 13.0, 75.0, 285.0, 6.0, 86.0, 126.0, 195.0, 78.0, 136.0, 104.0, 85.0, 31.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [133.0, 0.0, 145.0, 152.0, -32.0, 0.0, 140.0, 75.0, 183.0, 0.0, 0.0, 78.0, 147.0, 179.0, -6.0, -22.0, -2.0, 38.0, 106.0, 176.0, -98.0, -102.0, 53.0, 126.0, 158.0, 166.0, 131.0, 122.0, -27.0, -95.0, 139.0, 0.0, 192.0, 60.0, 0.0, 166.0, 19.0, 44.0, 156.0, -2.0, 36.0, 3.0, 0.0, 70.0, 16.0, -106.0, 194.0, 184.0, -38.0, -11.0, 74.0, -126.0, 149.0, 181.0, -56.0, 0.0, 0.0, 200.0, 0.0, 163.0, 200.0, 0.0, 0.0, -64.0, 162.0, 128.0, -40.0, -34.0, 20.0, -10.0, -43.0, -42.0, 18.0, 108.0, 198.0, 159.0, 89.0, -92.0, 198.0, 0.0, -152.0, -18.0, -162.0, -68.0, 197.0, 138.0, 126.0, 172.0, 70.0, 0.0, -56.0, -6.0, -129.0, -152.0, 182.0, 111.0, -66.0, 2.0, -117.0, -75.0, -116.0, -102.0, -64.0, 0.0, 92.0, 0.0, 61.0, 26.0, -140.0, -111.0, 108.0, 0.0, 0.0, 145.0, -191.0, -34.0, -70.0, 14.0, -161.0, -110.0, 200.0, 52.0, -173.0, 0.0, 58.0, 32.0, -57.0, -56.0, -62.0, -2.0, 0.0, -69.0, -11.0, -170.0, 63.0, 165.0, 160.0, 191.0, -127.0, -129.0, -84.0, 128.0, -108.0, 0.0, -3.0, -19.0, 80.0, 88.0, 11.0, 0.0, -22.0, -114.0, -116.0, -62.0, 0.0, 134.0, 0.0, -138.0, -29.0, 88.0, 144.0, 143.0, -80.0, -170.0, -19.0, -126.0, 44.0, 88.0, 80.0, -172.0, 8.0, 0.0, 0.0, 112.0, -114.0, -90.0, -184.0, -26.0, -69.0, -58.0, 64.0, 37.0, -48.0, -198.0, -168.0, -26.0, -43.0, 0.0, 193.0, 0.0, 0.0, -82.0, -11.0, 93.0, -178.0, -1.0, -18.0, 0.0, -87.0, -70.0], "policy_predator_policy_reward": [33.0, 4.0, 38.0, 38.0, 113.0, 12.0, 43.0, 47.0, 8.0, 2.0, 9.0, 59.0, 27.0, 15.0, 111.0, 11.0, 13.0, 75.0, 0.0, 58.0, 95.0, 183.0, 69.0, 66.0, 22.0, 0.0, 46.0, 10.0, 155.0, 15.0, 21.0, 9.0, 53.0, 8.0, 8.0, 10.0, 25.0, 100.0, 0.0, 24.0, 2.0, 89.0, 14.0, 62.0, 146.0, 32.0, 6.0, 10.0, 63.0, 83.0, 173.0, 57.0, 0.0, 6.0, 125.0, 4.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 7.0, 130.0, 0.0, 41.0, 162.0, 28.0, 119.0, 30.0, 137.0, 112.0, 14.0, 95.0, 0.0, 11.0, 55.0, 145.0, 1.0, 0.0, 70.0, 177.0, 195.0, 182.0, 25.0, 19.0, 4.0, 13.0, 3.0, 62.0, 115.0, 34.0, 184.0, 44.0, 29.0, 15.0, 43.0, 151.0, 51.0, 161.0, 174.0, 48.0, 130.0, 4.0, 54.0, 12.0, 86.0, 31.0, 188.0, 0.0, 6.0, 32.0, 11.0, 15.0, 161.0, 128.0, 128.0, 28.0, 155.0, 116.0, 12.0, 13.0, 185.0, 50.0, 94.0, 0.0, 104.0, 121.0, 102.0, 106.0, 41.0, 117.0, 163.0, 92.0, 0.0, 64.0, 20.0, 1.0, 171.0, 35.0, 111.0, 85.0, 7.0, 150.0, 57.0, 54.0, 2.0, 57.0, 4.0, 90.0, 173.0, 14.0, 0.0, 170.0, 0.0, 33.0, 164.0, 0.0, 0.0, 124.0, 0.0, 39.0, 94.0, 194.0, 0.0, 184.0, 122.0, 0.0, 164.0, 153.0, 58.0, 48.0, 37.0, 0.0, 118.0, 177.0, 200.0, 23.0, 131.0, 71.0, 69.0, 115.0, 199.0, 53.0, 108.0, 172.0, 93.0, 76.0, 1.0, 1.0, 70.0, 90.0, 54.0, 0.0, 188.0, 95.0, 23.0, 80.0, 47.0, 141.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5782211144849517, "mean_inference_ms": 1.3088099662321409, "mean_action_processing_ms": 0.229421624284021, "mean_env_wait_ms": 0.17258014259954127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003499150276184082, "StateBufferConnector_ms": 0.0031660795211791992, "ViewRequirementAgentConnector_ms": 0.09880661964416504}, "num_episodes": 18, "episode_return_max": 394.0, "episode_return_min": -63.0, "episode_return_mean": 157.54, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.56478909179638, "num_env_steps_trained_throughput_per_sec": 88.56478909179638, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 45208.459, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45208.412, "sample_time_ms": 1052.858, "learn_time_ms": 44140.164, "learn_throughput": 90.62, "synch_weights_time_ms": 13.103}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 81, "trial_id": "51025_00000", "date": "2024-08-12_21-25-34", "timestamp": 1723512334, "time_this_iter_s": 45.21778893470764, "time_total_s": 3686.1675024032593, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x15803c3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3686.1675024032593, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 19.693749999999998, "ram_util_percent": 81.33281250000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.74053360526524, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.092915544560347, "policy_loss": -0.011420881343148058, "vf_loss": 7.1023304979637185, "vf_explained_var": -0.6437693614492972, "kl": 0.006686432286889375, "entropy": 0.937440523994032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.621457088813578, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.149786174612701, "policy_loss": -0.010376121866437927, "vf_loss": 7.1593967780865055, "vf_explained_var": 0.35339751754488263, "kl": 0.0076551205543851615, "entropy": 0.6599213657555757, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "env_runners": {"episode_reward_max": 394.0, "episode_reward_min": -63.0, "episode_reward_mean": 130.28, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -198.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -8.995, "predator_policy": 74.135}, "custom_metrics": {}, "hist_stats": {"episode_reward": [394.0, 97.0, 178.0, 336.0, 73.0, 200.0, 168.0, 200.0, 73.0, 331.0, 116.0, 159.0, 164.0, 235.0, 368.0, 197.0, 199.0, 77.0, 147.0, 379.0, 315.0, 135.0, 87.0, -53.0, 337.0, 130.0, 20.0, 4.0, 70.0, 158.0, 204.0, -63.0, 146.0, 171.0, 64.0, 100.0, 0.0, 277.0, 62.0, 184.0, 112.0, 144.0, 89.0, 74.0, 292.0, 372.0, -50.0, 240.0, 49.0, 89.0, 227.0, 105.0, 51.0, -8.0, 167.0, 26.0, 183.0, 326.0, 38.0, 39.0, 254.0, 225.0, 114.0, 149.0, 91.0, 13.0, 75.0, 285.0, 6.0, 86.0, 126.0, 195.0, 78.0, 136.0, 104.0, 85.0, 31.0, 280.0, 52.0, 52.0, 40.0, 112.0, 116.0, 72.0, 96.0, 127.0, -62.0, 123.0, 74.0, 0.0, 135.0, 0.0, -13.0, 238.0, 90.0, 165.0, -63.0, 162.0, 81.0, 94.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [194.0, 184.0, -38.0, -11.0, 74.0, -126.0, 149.0, 181.0, -56.0, 0.0, 0.0, 200.0, 0.0, 163.0, 200.0, 0.0, 0.0, -64.0, 162.0, 128.0, -40.0, -34.0, 20.0, -10.0, -43.0, -42.0, 18.0, 108.0, 198.0, 159.0, 89.0, -92.0, 198.0, 0.0, -152.0, -18.0, -162.0, -68.0, 197.0, 138.0, 126.0, 172.0, 70.0, 0.0, -56.0, -6.0, -129.0, -152.0, 182.0, 111.0, -66.0, 2.0, -117.0, -75.0, -116.0, -102.0, -64.0, 0.0, 92.0, 0.0, 61.0, 26.0, -140.0, -111.0, 108.0, 0.0, 0.0, 145.0, -191.0, -34.0, -70.0, 14.0, -161.0, -110.0, 200.0, 52.0, -173.0, 0.0, 58.0, 32.0, -57.0, -56.0, -62.0, -2.0, 0.0, -69.0, -11.0, -170.0, 63.0, 165.0, 160.0, 191.0, -127.0, -129.0, -84.0, 128.0, -108.0, 0.0, -3.0, -19.0, 80.0, 88.0, 11.0, 0.0, -22.0, -114.0, -116.0, -62.0, 0.0, 134.0, 0.0, -138.0, -29.0, 88.0, 144.0, 143.0, -80.0, -170.0, -19.0, -126.0, 44.0, 88.0, 80.0, -172.0, 8.0, 0.0, 0.0, 112.0, -114.0, -90.0, -184.0, -26.0, -69.0, -58.0, 64.0, 37.0, -48.0, -198.0, -168.0, -26.0, -43.0, 0.0, 193.0, 0.0, 0.0, -82.0, -11.0, 93.0, -178.0, -1.0, -18.0, 0.0, -87.0, -70.0, 2.0, 183.0, -93.0, 0.0, -76.0, -117.0, -77.0, -167.0, 39.0, -63.0, 8.0, 0.0, -72.0, 0.0, 63.0, 0.0, -25.0, -146.0, -174.0, -125.0, -88.0, 39.0, 4.0, -176.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, -162.0, -40.0, 122.0, -33.0, 0.0, -84.0, 84.0, -18.0, -158.0, -123.0, -156.0, 30.0, -27.0, -120.0, -118.0, -23.0], "policy_predator_policy_reward": [6.0, 10.0, 63.0, 83.0, 173.0, 57.0, 0.0, 6.0, 125.0, 4.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 7.0, 130.0, 0.0, 41.0, 162.0, 28.0, 119.0, 30.0, 137.0, 112.0, 14.0, 95.0, 0.0, 11.0, 55.0, 145.0, 1.0, 0.0, 70.0, 177.0, 195.0, 182.0, 25.0, 19.0, 4.0, 13.0, 3.0, 62.0, 115.0, 34.0, 184.0, 44.0, 29.0, 15.0, 43.0, 151.0, 51.0, 161.0, 174.0, 48.0, 130.0, 4.0, 54.0, 12.0, 86.0, 31.0, 188.0, 0.0, 6.0, 32.0, 11.0, 15.0, 161.0, 128.0, 128.0, 28.0, 155.0, 116.0, 12.0, 13.0, 185.0, 50.0, 94.0, 0.0, 104.0, 121.0, 102.0, 106.0, 41.0, 117.0, 163.0, 92.0, 0.0, 64.0, 20.0, 1.0, 171.0, 35.0, 111.0, 85.0, 7.0, 150.0, 57.0, 54.0, 2.0, 57.0, 4.0, 90.0, 173.0, 14.0, 0.0, 170.0, 0.0, 33.0, 164.0, 0.0, 0.0, 124.0, 0.0, 39.0, 94.0, 194.0, 0.0, 184.0, 122.0, 0.0, 164.0, 153.0, 58.0, 48.0, 37.0, 0.0, 118.0, 177.0, 200.0, 23.0, 131.0, 71.0, 69.0, 115.0, 199.0, 53.0, 108.0, 172.0, 93.0, 76.0, 1.0, 1.0, 70.0, 90.0, 54.0, 0.0, 188.0, 95.0, 23.0, 80.0, 47.0, 141.0, 95.0, 0.0, 134.0, 11.0, 74.0, 171.0, 186.0, 98.0, 13.0, 123.0, 70.0, 38.0, 102.0, 42.0, 8.0, 25.0, 127.0, 171.0, 187.0, 50.0, 22.0, 150.0, 192.0, 54.0, 0.0, 0.0, 74.0, 53.0, 0.0, 0.0, 189.0, 0.0, 86.0, 63.0, 123.0, 51.0, 1.0, 98.0, 30.0, 188.0, 166.0, 122.0, 171.0, 57.0, 48.0, 187.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5783153621866431, "mean_inference_ms": 1.3080430044707405, "mean_action_processing_ms": 0.22924674269610773, "mean_env_wait_ms": 0.17253401718564196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034742355346679688, "StateBufferConnector_ms": 0.0031489133834838867, "ViewRequirementAgentConnector_ms": 0.09931063652038574}, "num_episodes": 23, "episode_return_max": 394.0, "episode_return_min": -63.0, "episode_return_mean": 130.28, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.41060685551376, "num_env_steps_trained_throughput_per_sec": 88.41060685551376, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 1312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1312000, "timers": {"training_iteration_time_ms": 45210.122, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45210.077, "sample_time_ms": 1068.33, "learn_time_ms": 44126.576, "learn_throughput": 90.648, "synch_weights_time_ms": 12.88}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "done": false, "training_iteration": 82, "trial_id": "51025_00000", "date": "2024-08-12_21-26-19", "timestamp": 1723512379, "time_this_iter_s": 45.286988735198975, "time_total_s": 3731.4544911384583, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158b48310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3731.4544911384583, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 20.2671875, "ram_util_percent": 81.09375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.003697302038708, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.174563213630959, "policy_loss": -0.014426806454778349, "vf_loss": 7.186354128267399, "vf_explained_var": -0.8418477358641447, "kl": 0.008786402640648948, "entropy": 0.9798052525394177, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.628423061194244, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.429101828671007, "policy_loss": -0.011219149039782307, "vf_loss": 7.43964213366231, "vf_explained_var": 0.2666431415333319, "kl": 0.006788405860469611, "entropy": 0.7126402952368297, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "env_runners": {"episode_reward_max": 379.0, "episode_reward_min": -63.0, "episode_reward_mean": 115.46, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -198.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -22.47, "predator_policy": 80.2}, "custom_metrics": {}, "hist_stats": {"episode_reward": [147.0, 379.0, 315.0, 135.0, 87.0, -53.0, 337.0, 130.0, 20.0, 4.0, 70.0, 158.0, 204.0, -63.0, 146.0, 171.0, 64.0, 100.0, 0.0, 277.0, 62.0, 184.0, 112.0, 144.0, 89.0, 74.0, 292.0, 372.0, -50.0, 240.0, 49.0, 89.0, 227.0, 105.0, 51.0, -8.0, 167.0, 26.0, 183.0, 326.0, 38.0, 39.0, 254.0, 225.0, 114.0, 149.0, 91.0, 13.0, 75.0, 285.0, 6.0, 86.0, 126.0, 195.0, 78.0, 136.0, 104.0, 85.0, 31.0, 280.0, 52.0, 52.0, 40.0, 112.0, 116.0, 72.0, 96.0, 127.0, -62.0, 123.0, 74.0, 0.0, 135.0, 0.0, -13.0, 238.0, 90.0, 165.0, -63.0, 162.0, 81.0, 94.0, 59.0, 106.0, 33.0, 119.0, 134.0, 83.0, 117.0, 125.0, 158.0, 108.0, 139.0, 191.0, 106.0, 101.0, 117.0, 93.0, 166.0, 128.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-162.0, -68.0, 197.0, 138.0, 126.0, 172.0, 70.0, 0.0, -56.0, -6.0, -129.0, -152.0, 182.0, 111.0, -66.0, 2.0, -117.0, -75.0, -116.0, -102.0, -64.0, 0.0, 92.0, 0.0, 61.0, 26.0, -140.0, -111.0, 108.0, 0.0, 0.0, 145.0, -191.0, -34.0, -70.0, 14.0, -161.0, -110.0, 200.0, 52.0, -173.0, 0.0, 58.0, 32.0, -57.0, -56.0, -62.0, -2.0, 0.0, -69.0, -11.0, -170.0, 63.0, 165.0, 160.0, 191.0, -127.0, -129.0, -84.0, 128.0, -108.0, 0.0, -3.0, -19.0, 80.0, 88.0, 11.0, 0.0, -22.0, -114.0, -116.0, -62.0, 0.0, 134.0, 0.0, -138.0, -29.0, 88.0, 144.0, 143.0, -80.0, -170.0, -19.0, -126.0, 44.0, 88.0, 80.0, -172.0, 8.0, 0.0, 0.0, 112.0, -114.0, -90.0, -184.0, -26.0, -69.0, -58.0, 64.0, 37.0, -48.0, -198.0, -168.0, -26.0, -43.0, 0.0, 193.0, 0.0, 0.0, -82.0, -11.0, 93.0, -178.0, -1.0, -18.0, 0.0, -87.0, -70.0, 2.0, 183.0, -93.0, 0.0, -76.0, -117.0, -77.0, -167.0, 39.0, -63.0, 8.0, 0.0, -72.0, 0.0, 63.0, 0.0, -25.0, -146.0, -174.0, -125.0, -88.0, 39.0, 4.0, -176.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, -162.0, -40.0, 122.0, -33.0, 0.0, -84.0, 84.0, -18.0, -158.0, -123.0, -156.0, 30.0, -27.0, -120.0, -118.0, -23.0, -104.0, -52.0, -79.0, -54.0, -29.0, -8.0, -57.0, 30.0, 0.0, -118.0, -64.0, 0.0, 0.0, 56.0, 13.0, -6.0, 104.0, 0.0, -8.0, -77.0, -64.0, -5.0, -24.0, 2.0, 15.0, -184.0, -140.0, 46.0, -14.0, -77.0, 0.0, -13.0, 80.0, -101.0, -134.0, 70.0], "policy_predator_policy_reward": [195.0, 182.0, 25.0, 19.0, 4.0, 13.0, 3.0, 62.0, 115.0, 34.0, 184.0, 44.0, 29.0, 15.0, 43.0, 151.0, 51.0, 161.0, 174.0, 48.0, 130.0, 4.0, 54.0, 12.0, 86.0, 31.0, 188.0, 0.0, 6.0, 32.0, 11.0, 15.0, 161.0, 128.0, 128.0, 28.0, 155.0, 116.0, 12.0, 13.0, 185.0, 50.0, 94.0, 0.0, 104.0, 121.0, 102.0, 106.0, 41.0, 117.0, 163.0, 92.0, 0.0, 64.0, 20.0, 1.0, 171.0, 35.0, 111.0, 85.0, 7.0, 150.0, 57.0, 54.0, 2.0, 57.0, 4.0, 90.0, 173.0, 14.0, 0.0, 170.0, 0.0, 33.0, 164.0, 0.0, 0.0, 124.0, 0.0, 39.0, 94.0, 194.0, 0.0, 184.0, 122.0, 0.0, 164.0, 153.0, 58.0, 48.0, 37.0, 0.0, 118.0, 177.0, 200.0, 23.0, 131.0, 71.0, 69.0, 115.0, 199.0, 53.0, 108.0, 172.0, 93.0, 76.0, 1.0, 1.0, 70.0, 90.0, 54.0, 0.0, 188.0, 95.0, 23.0, 80.0, 47.0, 141.0, 95.0, 0.0, 134.0, 11.0, 74.0, 171.0, 186.0, 98.0, 13.0, 123.0, 70.0, 38.0, 102.0, 42.0, 8.0, 25.0, 127.0, 171.0, 187.0, 50.0, 22.0, 150.0, 192.0, 54.0, 0.0, 0.0, 74.0, 53.0, 0.0, 0.0, 189.0, 0.0, 86.0, 63.0, 123.0, 51.0, 1.0, 98.0, 30.0, 188.0, 166.0, 122.0, 171.0, 57.0, 48.0, 187.0, 59.0, 156.0, 188.0, 51.0, 0.0, 70.0, 55.0, 91.0, 135.0, 117.0, 55.0, 92.0, 36.0, 25.0, 78.0, 40.0, 26.0, 28.0, 130.0, 63.0, 72.0, 136.0, 131.0, 82.0, 173.0, 102.0, 174.0, 21.0, 37.0, 171.0, 1.0, 105.0, 175.0, 12.0, 181.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5779270908300007, "mean_inference_ms": 1.3077808599111018, "mean_action_processing_ms": 0.2294318118513826, "mean_env_wait_ms": 0.17259497834190024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003542780876159668, "StateBufferConnector_ms": 0.00315093994140625, "ViewRequirementAgentConnector_ms": 0.10013687610626221}, "num_episodes": 18, "episode_return_max": 379.0, "episode_return_min": -63.0, "episode_return_mean": 115.46, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.16791836574635, "num_env_steps_trained_throughput_per_sec": 88.16791836574635, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 1328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1328000, "timers": {"training_iteration_time_ms": 45241.901, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45241.856, "sample_time_ms": 1065.213, "learn_time_ms": 44161.226, "learn_throughput": 90.577, "synch_weights_time_ms": 13.133}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "done": false, "training_iteration": 83, "trial_id": "51025_00000", "date": "2024-08-12_21-27-05", "timestamp": 1723512425, "time_this_iter_s": 45.42805504798889, "time_total_s": 3776.882546186447, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1580001f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3776.882546186447, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 20.053846153846155, "ram_util_percent": 81.34}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.32835168516825, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.73225047222521, "policy_loss": -0.015579085292112299, "vf_loss": 7.744761144294941, "vf_explained_var": -0.38922093318252965, "kl": 0.010228074226670589, "entropy": 0.9172095692031598, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.399132652762075, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.3575442069422, "policy_loss": -0.009477151209789097, "vf_loss": 7.365652828872519, "vf_explained_var": 0.18039671857521017, "kl": 0.013685408136299091, "entropy": 0.6959995176741686, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 372.0, "episode_reward_min": -63.0, "episode_reward_mean": 112.23, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -198.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -28.205, "predator_policy": 84.32}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 277.0, 62.0, 184.0, 112.0, 144.0, 89.0, 74.0, 292.0, 372.0, -50.0, 240.0, 49.0, 89.0, 227.0, 105.0, 51.0, -8.0, 167.0, 26.0, 183.0, 326.0, 38.0, 39.0, 254.0, 225.0, 114.0, 149.0, 91.0, 13.0, 75.0, 285.0, 6.0, 86.0, 126.0, 195.0, 78.0, 136.0, 104.0, 85.0, 31.0, 280.0, 52.0, 52.0, 40.0, 112.0, 116.0, 72.0, 96.0, 127.0, -62.0, 123.0, 74.0, 0.0, 135.0, 0.0, -13.0, 238.0, 90.0, 165.0, -63.0, 162.0, 81.0, 94.0, 59.0, 106.0, 33.0, 119.0, 134.0, 83.0, 117.0, 125.0, 158.0, 108.0, 139.0, 191.0, 106.0, 101.0, 117.0, 93.0, 166.0, 128.0, 30.0, 23.0, 207.0, 140.0, 124.0, 191.0, 107.0, 107.0, 119.0, 213.0, 110.0, 91.0, 58.0, 228.0, 4.0, 0.0, 135.0, 141.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-161.0, -110.0, 200.0, 52.0, -173.0, 0.0, 58.0, 32.0, -57.0, -56.0, -62.0, -2.0, 0.0, -69.0, -11.0, -170.0, 63.0, 165.0, 160.0, 191.0, -127.0, -129.0, -84.0, 128.0, -108.0, 0.0, -3.0, -19.0, 80.0, 88.0, 11.0, 0.0, -22.0, -114.0, -116.0, -62.0, 0.0, 134.0, 0.0, -138.0, -29.0, 88.0, 144.0, 143.0, -80.0, -170.0, -19.0, -126.0, 44.0, 88.0, 80.0, -172.0, 8.0, 0.0, 0.0, 112.0, -114.0, -90.0, -184.0, -26.0, -69.0, -58.0, 64.0, 37.0, -48.0, -198.0, -168.0, -26.0, -43.0, 0.0, 193.0, 0.0, 0.0, -82.0, -11.0, 93.0, -178.0, -1.0, -18.0, 0.0, -87.0, -70.0, 2.0, 183.0, -93.0, 0.0, -76.0, -117.0, -77.0, -167.0, 39.0, -63.0, 8.0, 0.0, -72.0, 0.0, 63.0, 0.0, -25.0, -146.0, -174.0, -125.0, -88.0, 39.0, 4.0, -176.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, -162.0, -40.0, 122.0, -33.0, 0.0, -84.0, 84.0, -18.0, -158.0, -123.0, -156.0, 30.0, -27.0, -120.0, -118.0, -23.0, -104.0, -52.0, -79.0, -54.0, -29.0, -8.0, -57.0, 30.0, 0.0, -118.0, -64.0, 0.0, 0.0, 56.0, 13.0, -6.0, 104.0, 0.0, -8.0, -77.0, -64.0, -5.0, -24.0, 2.0, 15.0, -184.0, -140.0, 46.0, -14.0, -77.0, 0.0, -13.0, 80.0, -101.0, -134.0, 70.0, -25.0, 0.0, -124.0, -120.0, 13.0, 38.0, -138.0, 1.0, -150.0, -1.0, -46.0, 12.0, 0.0, 11.0, -101.0, 12.0, -42.0, -71.0, -114.0, 82.0, -62.0, -20.0, -91.0, 0.0, -15.0, -149.0, -6.0, 78.0, -90.0, -143.0, 0.0, -4.0, -52.0, -12.0, 0.0, -33.0], "policy_predator_policy_reward": [155.0, 116.0, 12.0, 13.0, 185.0, 50.0, 94.0, 0.0, 104.0, 121.0, 102.0, 106.0, 41.0, 117.0, 163.0, 92.0, 0.0, 64.0, 20.0, 1.0, 171.0, 35.0, 111.0, 85.0, 7.0, 150.0, 57.0, 54.0, 2.0, 57.0, 4.0, 90.0, 173.0, 14.0, 0.0, 170.0, 0.0, 33.0, 164.0, 0.0, 0.0, 124.0, 0.0, 39.0, 94.0, 194.0, 0.0, 184.0, 122.0, 0.0, 164.0, 153.0, 58.0, 48.0, 37.0, 0.0, 118.0, 177.0, 200.0, 23.0, 131.0, 71.0, 69.0, 115.0, 199.0, 53.0, 108.0, 172.0, 93.0, 76.0, 1.0, 1.0, 70.0, 90.0, 54.0, 0.0, 188.0, 95.0, 23.0, 80.0, 47.0, 141.0, 95.0, 0.0, 134.0, 11.0, 74.0, 171.0, 186.0, 98.0, 13.0, 123.0, 70.0, 38.0, 102.0, 42.0, 8.0, 25.0, 127.0, 171.0, 187.0, 50.0, 22.0, 150.0, 192.0, 54.0, 0.0, 0.0, 74.0, 53.0, 0.0, 0.0, 189.0, 0.0, 86.0, 63.0, 123.0, 51.0, 1.0, 98.0, 30.0, 188.0, 166.0, 122.0, 171.0, 57.0, 48.0, 187.0, 59.0, 156.0, 188.0, 51.0, 0.0, 70.0, 55.0, 91.0, 135.0, 117.0, 55.0, 92.0, 36.0, 25.0, 78.0, 40.0, 26.0, 28.0, 130.0, 63.0, 72.0, 136.0, 131.0, 82.0, 173.0, 102.0, 174.0, 21.0, 37.0, 171.0, 1.0, 105.0, 175.0, 12.0, 181.0, 11.0, 55.0, 0.0, 183.0, 84.0, 156.0, 0.0, 153.0, 124.0, 118.0, 157.0, 124.0, 101.0, 75.0, 21.0, 83.0, 113.0, 135.0, 97.0, 115.0, 130.0, 105.0, 87.0, 55.0, 127.0, 141.0, 81.0, 44.0, 112.0, 77.0, 160.0, 0.0, 4.0, 104.0, 95.0, 96.0, 78.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5777951164480603, "mean_inference_ms": 1.3071268743130944, "mean_action_processing_ms": 0.22940285610211186, "mean_env_wait_ms": 0.1725686759070433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034946203231811523, "StateBufferConnector_ms": 0.0031050443649291992, "ViewRequirementAgentConnector_ms": 0.09866440296173096}, "num_episodes": 18, "episode_return_max": 372.0, "episode_return_min": -63.0, "episode_return_mean": 112.23, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.21493089019381, "num_env_steps_trained_throughput_per_sec": 88.21493089019381, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 45278.732, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45278.687, "sample_time_ms": 1068.308, "learn_time_ms": 44194.815, "learn_throughput": 90.508, "synch_weights_time_ms": 13.394}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 84, "trial_id": "51025_00000", "date": "2024-08-12_21-27-50", "timestamp": 1723512470, "time_this_iter_s": 45.388700008392334, "time_total_s": 3822.2712461948395, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x15808c0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3822.2712461948395, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 20.439062500000002, "ram_util_percent": 81.521875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.336678351044025, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.865036653084729, "policy_loss": -0.012470982141457695, "vf_loss": 7.8750000799774496, "vf_explained_var": -0.15586395862872007, "kl": 0.008358446548794373, "entropy": 0.9757453145804229, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.636949708978966, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.355634049763755, "policy_loss": -0.006360634945076767, "vf_loss": 7.361425977030759, "vf_explained_var": 0.09336255747805197, "kl": 0.005686999831006314, "entropy": 0.6895022562256565, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 342.0, "episode_reward_min": -63.0, "episode_reward_mean": 119.35, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -198.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -29.67, "predator_policy": 89.345}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.0, 39.0, 254.0, 225.0, 114.0, 149.0, 91.0, 13.0, 75.0, 285.0, 6.0, 86.0, 126.0, 195.0, 78.0, 136.0, 104.0, 85.0, 31.0, 280.0, 52.0, 52.0, 40.0, 112.0, 116.0, 72.0, 96.0, 127.0, -62.0, 123.0, 74.0, 0.0, 135.0, 0.0, -13.0, 238.0, 90.0, 165.0, -63.0, 162.0, 81.0, 94.0, 59.0, 106.0, 33.0, 119.0, 134.0, 83.0, 117.0, 125.0, 158.0, 108.0, 139.0, 191.0, 106.0, 101.0, 117.0, 93.0, 166.0, 128.0, 30.0, 23.0, 207.0, 140.0, 124.0, 191.0, 107.0, 107.0, 119.0, 213.0, 110.0, 91.0, 58.0, 228.0, 4.0, 0.0, 135.0, 141.0, 122.0, 342.0, 122.0, 229.0, 181.0, 92.0, 179.0, 169.0, 32.0, 172.0, 269.0, 270.0, 132.0, 153.0, 91.0, 246.0, 66.0, 222.0, 168.0, 208.0, 174.0, 84.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-80.0, -170.0, -19.0, -126.0, 44.0, 88.0, 80.0, -172.0, 8.0, 0.0, 0.0, 112.0, -114.0, -90.0, -184.0, -26.0, -69.0, -58.0, 64.0, 37.0, -48.0, -198.0, -168.0, -26.0, -43.0, 0.0, 193.0, 0.0, 0.0, -82.0, -11.0, 93.0, -178.0, -1.0, -18.0, 0.0, -87.0, -70.0, 2.0, 183.0, -93.0, 0.0, -76.0, -117.0, -77.0, -167.0, 39.0, -63.0, 8.0, 0.0, -72.0, 0.0, 63.0, 0.0, -25.0, -146.0, -174.0, -125.0, -88.0, 39.0, 4.0, -176.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, -162.0, -40.0, 122.0, -33.0, 0.0, -84.0, 84.0, -18.0, -158.0, -123.0, -156.0, 30.0, -27.0, -120.0, -118.0, -23.0, -104.0, -52.0, -79.0, -54.0, -29.0, -8.0, -57.0, 30.0, 0.0, -118.0, -64.0, 0.0, 0.0, 56.0, 13.0, -6.0, 104.0, 0.0, -8.0, -77.0, -64.0, -5.0, -24.0, 2.0, 15.0, -184.0, -140.0, 46.0, -14.0, -77.0, 0.0, -13.0, 80.0, -101.0, -134.0, 70.0, -25.0, 0.0, -124.0, -120.0, 13.0, 38.0, -138.0, 1.0, -150.0, -1.0, -46.0, 12.0, 0.0, 11.0, -101.0, 12.0, -42.0, -71.0, -114.0, 82.0, -62.0, -20.0, -91.0, 0.0, -15.0, -149.0, -6.0, 78.0, -90.0, -143.0, 0.0, -4.0, -52.0, -12.0, 0.0, -33.0, -50.0, 76.0, 143.0, -14.0, 0.0, 20.0, 8.0, 34.0, 181.0, -2.0, 0.0, -94.0, 87.0, -32.0, -56.0, 22.0, -12.0, 0.0, -157.0, 70.0, 14.0, 23.0, 117.0, -116.0, -90.0, 49.0, -142.0, 40.0, 0.0, 1.0, 9.0, 57.0, -79.0, -108.0, -166.0, 107.0, 18.0, -21.0, -182.0, 52.0, -75.0, 53.0, -90.0, -73.0], "policy_predator_policy_reward": [94.0, 194.0, 0.0, 184.0, 122.0, 0.0, 164.0, 153.0, 58.0, 48.0, 37.0, 0.0, 118.0, 177.0, 200.0, 23.0, 131.0, 71.0, 69.0, 115.0, 199.0, 53.0, 108.0, 172.0, 93.0, 76.0, 1.0, 1.0, 70.0, 90.0, 54.0, 0.0, 188.0, 95.0, 23.0, 80.0, 47.0, 141.0, 95.0, 0.0, 134.0, 11.0, 74.0, 171.0, 186.0, 98.0, 13.0, 123.0, 70.0, 38.0, 102.0, 42.0, 8.0, 25.0, 127.0, 171.0, 187.0, 50.0, 22.0, 150.0, 192.0, 54.0, 0.0, 0.0, 74.0, 53.0, 0.0, 0.0, 189.0, 0.0, 86.0, 63.0, 123.0, 51.0, 1.0, 98.0, 30.0, 188.0, 166.0, 122.0, 171.0, 57.0, 48.0, 187.0, 59.0, 156.0, 188.0, 51.0, 0.0, 70.0, 55.0, 91.0, 135.0, 117.0, 55.0, 92.0, 36.0, 25.0, 78.0, 40.0, 26.0, 28.0, 130.0, 63.0, 72.0, 136.0, 131.0, 82.0, 173.0, 102.0, 174.0, 21.0, 37.0, 171.0, 1.0, 105.0, 175.0, 12.0, 181.0, 11.0, 55.0, 0.0, 183.0, 84.0, 156.0, 0.0, 153.0, 124.0, 118.0, 157.0, 124.0, 101.0, 75.0, 21.0, 83.0, 113.0, 135.0, 97.0, 115.0, 130.0, 105.0, 87.0, 55.0, 127.0, 141.0, 81.0, 44.0, 112.0, 77.0, 160.0, 0.0, 4.0, 104.0, 95.0, 96.0, 78.0, 0.0, 96.0, 95.0, 118.0, 43.0, 59.0, 55.0, 132.0, 0.0, 2.0, 74.0, 112.0, 124.0, 0.0, 82.0, 121.0, 44.0, 0.0, 191.0, 68.0, 140.0, 92.0, 133.0, 136.0, 8.0, 165.0, 162.0, 93.0, 75.0, 15.0, 58.0, 122.0, 116.0, 137.0, 91.0, 190.0, 55.0, 116.0, 192.0, 146.0, 38.0, 158.0, 116.0, 131.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5776679886531109, "mean_inference_ms": 1.3066282015645754, "mean_action_processing_ms": 0.22936512353384145, "mean_env_wait_ms": 0.17254616924217892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034418106079101562, "StateBufferConnector_ms": 0.0030902624130249023, "ViewRequirementAgentConnector_ms": 0.0978250503540039}, "num_episodes": 22, "episode_return_max": 342.0, "episode_return_min": -63.0, "episode_return_mean": 119.35, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.283176326854, "num_env_steps_trained_throughput_per_sec": 88.283176326854, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 45309.571, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45309.525, "sample_time_ms": 1077.335, "learn_time_ms": 44215.721, "learn_throughput": 90.466, "synch_weights_time_ms": 14.218}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 85, "trial_id": "51025_00000", "date": "2024-08-12_21-28-36", "timestamp": 1723512516, "time_this_iter_s": 45.3433358669281, "time_total_s": 3867.6145820617676, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158000ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3867.6145820617676, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 20.646875, "ram_util_percent": 82.21875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.538625347109699, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.670440075132582, "policy_loss": -0.011622857859496166, "vf_loss": 7.679837178427076, "vf_explained_var": -0.015009106277788758, "kl": 0.007419193860579298, "entropy": 0.9368328684536869, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.84016223786369, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.06746316914836, "policy_loss": -0.009495824949431514, "vf_loss": 8.07625878601478, "vf_explained_var": 0.1221721262528152, "kl": 0.007002292308967756, "entropy": 0.662172550467587, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "env_runners": {"episode_reward_max": 342.0, "episode_reward_min": -63.0, "episode_reward_mean": 126.34, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -184.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 185.0, "predator_policy": 192.0}, "policy_reward_mean": {"prey_policy": -26.835, "predator_policy": 90.005}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.0, 280.0, 52.0, 52.0, 40.0, 112.0, 116.0, 72.0, 96.0, 127.0, -62.0, 123.0, 74.0, 0.0, 135.0, 0.0, -13.0, 238.0, 90.0, 165.0, -63.0, 162.0, 81.0, 94.0, 59.0, 106.0, 33.0, 119.0, 134.0, 83.0, 117.0, 125.0, 158.0, 108.0, 139.0, 191.0, 106.0, 101.0, 117.0, 93.0, 166.0, 128.0, 30.0, 23.0, 207.0, 140.0, 124.0, 191.0, 107.0, 107.0, 119.0, 213.0, 110.0, 91.0, 58.0, 228.0, 4.0, 0.0, 135.0, 141.0, 122.0, 342.0, 122.0, 229.0, 181.0, 92.0, 179.0, 169.0, 32.0, 172.0, 269.0, 270.0, 132.0, 153.0, 91.0, 246.0, 66.0, 222.0, 168.0, 208.0, 174.0, 84.0, 80.0, 97.0, 131.0, 162.0, 192.0, 85.0, 181.0, 101.0, 200.0, 261.0, 197.0, 64.0, 142.0, 151.0, 219.0, 181.0, 170.0, 184.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-87.0, -70.0, 2.0, 183.0, -93.0, 0.0, -76.0, -117.0, -77.0, -167.0, 39.0, -63.0, 8.0, 0.0, -72.0, 0.0, 63.0, 0.0, -25.0, -146.0, -174.0, -125.0, -88.0, 39.0, 4.0, -176.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, -162.0, -40.0, 122.0, -33.0, 0.0, -84.0, 84.0, -18.0, -158.0, -123.0, -156.0, 30.0, -27.0, -120.0, -118.0, -23.0, -104.0, -52.0, -79.0, -54.0, -29.0, -8.0, -57.0, 30.0, 0.0, -118.0, -64.0, 0.0, 0.0, 56.0, 13.0, -6.0, 104.0, 0.0, -8.0, -77.0, -64.0, -5.0, -24.0, 2.0, 15.0, -184.0, -140.0, 46.0, -14.0, -77.0, 0.0, -13.0, 80.0, -101.0, -134.0, 70.0, -25.0, 0.0, -124.0, -120.0, 13.0, 38.0, -138.0, 1.0, -150.0, -1.0, -46.0, 12.0, 0.0, 11.0, -101.0, 12.0, -42.0, -71.0, -114.0, 82.0, -62.0, -20.0, -91.0, 0.0, -15.0, -149.0, -6.0, 78.0, -90.0, -143.0, 0.0, -4.0, -52.0, -12.0, 0.0, -33.0, -50.0, 76.0, 143.0, -14.0, 0.0, 20.0, 8.0, 34.0, 181.0, -2.0, 0.0, -94.0, 87.0, -32.0, -56.0, 22.0, -12.0, 0.0, -157.0, 70.0, 14.0, 23.0, 117.0, -116.0, -90.0, 49.0, -142.0, 40.0, 0.0, 1.0, 9.0, 57.0, -79.0, -108.0, -166.0, 107.0, 18.0, -21.0, -182.0, 52.0, -75.0, 53.0, -90.0, -73.0, -89.0, -28.0, -20.0, 0.0, 36.0, 0.0, -72.0, -4.0, -97.0, 59.0, -122.0, -36.0, 81.0, -106.0, 0.0, -63.0, 12.0, 23.0, -52.0, 185.0, 21.0, -15.0, 0.0, -164.0, -115.0, -13.0, -116.0, 20.0, 23.0, 100.0, -113.0, 50.0, 27.0, 50.0, -28.0, -29.0], "policy_predator_policy_reward": [47.0, 141.0, 95.0, 0.0, 134.0, 11.0, 74.0, 171.0, 186.0, 98.0, 13.0, 123.0, 70.0, 38.0, 102.0, 42.0, 8.0, 25.0, 127.0, 171.0, 187.0, 50.0, 22.0, 150.0, 192.0, 54.0, 0.0, 0.0, 74.0, 53.0, 0.0, 0.0, 189.0, 0.0, 86.0, 63.0, 123.0, 51.0, 1.0, 98.0, 30.0, 188.0, 166.0, 122.0, 171.0, 57.0, 48.0, 187.0, 59.0, 156.0, 188.0, 51.0, 0.0, 70.0, 55.0, 91.0, 135.0, 117.0, 55.0, 92.0, 36.0, 25.0, 78.0, 40.0, 26.0, 28.0, 130.0, 63.0, 72.0, 136.0, 131.0, 82.0, 173.0, 102.0, 174.0, 21.0, 37.0, 171.0, 1.0, 105.0, 175.0, 12.0, 181.0, 11.0, 55.0, 0.0, 183.0, 84.0, 156.0, 0.0, 153.0, 124.0, 118.0, 157.0, 124.0, 101.0, 75.0, 21.0, 83.0, 113.0, 135.0, 97.0, 115.0, 130.0, 105.0, 87.0, 55.0, 127.0, 141.0, 81.0, 44.0, 112.0, 77.0, 160.0, 0.0, 4.0, 104.0, 95.0, 96.0, 78.0, 0.0, 96.0, 95.0, 118.0, 43.0, 59.0, 55.0, 132.0, 0.0, 2.0, 74.0, 112.0, 124.0, 0.0, 82.0, 121.0, 44.0, 0.0, 191.0, 68.0, 140.0, 92.0, 133.0, 136.0, 8.0, 165.0, 162.0, 93.0, 75.0, 15.0, 58.0, 122.0, 116.0, 137.0, 91.0, 190.0, 55.0, 116.0, 192.0, 146.0, 38.0, 158.0, 116.0, 131.0, 57.0, 140.0, 58.0, 59.0, 39.0, 56.0, 107.0, 131.0, 105.0, 125.0, 178.0, 65.0, 55.0, 151.0, 72.0, 92.0, 101.0, 64.0, 42.0, 86.0, 126.0, 65.0, 88.0, 140.0, 120.0, 150.0, 114.0, 133.0, 44.0, 52.0, 114.0, 130.0, 0.0, 93.0, 96.0, 145.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.577575016663185, "mean_inference_ms": 1.3063367924967677, "mean_action_processing_ms": 0.22934944844991165, "mean_env_wait_ms": 0.17254088761429143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00342559814453125, "StateBufferConnector_ms": 0.0029158592224121094, "ViewRequirementAgentConnector_ms": 0.0922708511352539}, "num_episodes": 18, "episode_return_max": 342.0, "episode_return_min": -63.0, "episode_return_mean": 126.34, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 86.49919650669214, "num_env_steps_trained_throughput_per_sec": 86.49919650669214, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1376000, "timers": {"training_iteration_time_ms": 45449.221, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45449.175, "sample_time_ms": 1081.994, "learn_time_ms": 44349.595, "learn_throughput": 90.192, "synch_weights_time_ms": 14.788}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "done": false, "training_iteration": 86, "trial_id": "51025_00000", "date": "2024-08-12_21-29-22", "timestamp": 1723512562, "time_this_iter_s": 46.28220796585083, "time_total_s": 3913.8967900276184, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158076a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3913.8967900276184, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 26.840000000000003, "ram_util_percent": 82.38461538461537}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.890797038179226, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.191271657792349, "policy_loss": -0.012665236493074902, "vf_loss": 7.201643816125456, "vf_explained_var": 0.22606303237733386, "kl": 0.007643579949723281, "entropy": 0.9533219352285698, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.561254856447693, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.169729237581687, "policy_loss": -0.009206441286754198, "vf_loss": 6.17838674550334, "vf_explained_var": 0.2441380865044064, "kl": 0.0054895321618007665, "entropy": 0.6847435811524669, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 347.0, "episode_reward_min": 0.0, "episode_reward_mean": 151.81, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -184.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 185.0, "predator_policy": 192.0}, "policy_reward_mean": {"prey_policy": -12.905, "predator_policy": 88.81}, "custom_metrics": {}, "hist_stats": {"episode_reward": [94.0, 59.0, 106.0, 33.0, 119.0, 134.0, 83.0, 117.0, 125.0, 158.0, 108.0, 139.0, 191.0, 106.0, 101.0, 117.0, 93.0, 166.0, 128.0, 30.0, 23.0, 207.0, 140.0, 124.0, 191.0, 107.0, 107.0, 119.0, 213.0, 110.0, 91.0, 58.0, 228.0, 4.0, 0.0, 135.0, 141.0, 122.0, 342.0, 122.0, 229.0, 181.0, 92.0, 179.0, 169.0, 32.0, 172.0, 269.0, 270.0, 132.0, 153.0, 91.0, 246.0, 66.0, 222.0, 168.0, 208.0, 174.0, 84.0, 80.0, 97.0, 131.0, 162.0, 192.0, 85.0, 181.0, 101.0, 200.0, 261.0, 197.0, 64.0, 142.0, 151.0, 219.0, 181.0, 170.0, 184.0, 219.0, 181.0, 144.0, 152.0, 141.0, 128.0, 119.0, 239.0, 60.0, 171.0, 347.0, 242.0, 266.0, 136.0, 220.0, 313.0, 149.0, 212.0, 115.0, 213.0, 180.0, 217.0, 291.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-118.0, -23.0, -104.0, -52.0, -79.0, -54.0, -29.0, -8.0, -57.0, 30.0, 0.0, -118.0, -64.0, 0.0, 0.0, 56.0, 13.0, -6.0, 104.0, 0.0, -8.0, -77.0, -64.0, -5.0, -24.0, 2.0, 15.0, -184.0, -140.0, 46.0, -14.0, -77.0, 0.0, -13.0, 80.0, -101.0, -134.0, 70.0, -25.0, 0.0, -124.0, -120.0, 13.0, 38.0, -138.0, 1.0, -150.0, -1.0, -46.0, 12.0, 0.0, 11.0, -101.0, 12.0, -42.0, -71.0, -114.0, 82.0, -62.0, -20.0, -91.0, 0.0, -15.0, -149.0, -6.0, 78.0, -90.0, -143.0, 0.0, -4.0, -52.0, -12.0, 0.0, -33.0, -50.0, 76.0, 143.0, -14.0, 0.0, 20.0, 8.0, 34.0, 181.0, -2.0, 0.0, -94.0, 87.0, -32.0, -56.0, 22.0, -12.0, 0.0, -157.0, 70.0, 14.0, 23.0, 117.0, -116.0, -90.0, 49.0, -142.0, 40.0, 0.0, 1.0, 9.0, 57.0, -79.0, -108.0, -166.0, 107.0, 18.0, -21.0, -182.0, 52.0, -75.0, 53.0, -90.0, -73.0, -89.0, -28.0, -20.0, 0.0, 36.0, 0.0, -72.0, -4.0, -97.0, 59.0, -122.0, -36.0, 81.0, -106.0, 0.0, -63.0, 12.0, 23.0, -52.0, 185.0, 21.0, -15.0, 0.0, -164.0, -115.0, -13.0, -116.0, 20.0, 23.0, 100.0, -113.0, 50.0, 27.0, 50.0, -28.0, -29.0, -111.0, 52.0, 0.0, 177.0, 41.0, -43.0, 78.0, 0.0, 83.0, 0.0, 51.0, -57.0, 0.0, 6.0, -45.0, 75.0, 0.0, -46.0, 0.0, 149.0, 116.0, 164.0, 65.0, -142.0, 178.0, -119.0, -69.0, 61.0, 13.0, 30.0, 121.0, -124.0, 0.0, 114.0, 8.0, 36.0, -70.0, -100.0, -34.0, 93.0, -122.0, 54.0, 171.0, -130.0, 135.0, 32.0], "policy_predator_policy_reward": [48.0, 187.0, 59.0, 156.0, 188.0, 51.0, 0.0, 70.0, 55.0, 91.0, 135.0, 117.0, 55.0, 92.0, 36.0, 25.0, 78.0, 40.0, 26.0, 28.0, 130.0, 63.0, 72.0, 136.0, 131.0, 82.0, 173.0, 102.0, 174.0, 21.0, 37.0, 171.0, 1.0, 105.0, 175.0, 12.0, 181.0, 11.0, 55.0, 0.0, 183.0, 84.0, 156.0, 0.0, 153.0, 124.0, 118.0, 157.0, 124.0, 101.0, 75.0, 21.0, 83.0, 113.0, 135.0, 97.0, 115.0, 130.0, 105.0, 87.0, 55.0, 127.0, 141.0, 81.0, 44.0, 112.0, 77.0, 160.0, 0.0, 4.0, 104.0, 95.0, 96.0, 78.0, 0.0, 96.0, 95.0, 118.0, 43.0, 59.0, 55.0, 132.0, 0.0, 2.0, 74.0, 112.0, 124.0, 0.0, 82.0, 121.0, 44.0, 0.0, 191.0, 68.0, 140.0, 92.0, 133.0, 136.0, 8.0, 165.0, 162.0, 93.0, 75.0, 15.0, 58.0, 122.0, 116.0, 137.0, 91.0, 190.0, 55.0, 116.0, 192.0, 146.0, 38.0, 158.0, 116.0, 131.0, 57.0, 140.0, 58.0, 59.0, 39.0, 56.0, 107.0, 131.0, 105.0, 125.0, 178.0, 65.0, 55.0, 151.0, 72.0, 92.0, 101.0, 64.0, 42.0, 86.0, 126.0, 65.0, 88.0, 140.0, 120.0, 150.0, 114.0, 133.0, 44.0, 52.0, 114.0, 130.0, 0.0, 93.0, 96.0, 145.0, 144.0, 134.0, 2.0, 2.0, 84.0, 62.0, 44.0, 30.0, 12.0, 46.0, 42.0, 92.0, 77.0, 36.0, 72.0, 137.0, 26.0, 80.0, 22.0, 0.0, 25.0, 42.0, 171.0, 148.0, 109.0, 98.0, 59.0, 85.0, 65.0, 112.0, 161.0, 155.0, 35.0, 0.0, 113.0, 55.0, 162.0, 123.0, 97.0, 57.0, 68.0, 180.0, 88.0, 88.0, 59.0, 65.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5778813173293541, "mean_inference_ms": 1.3068063818610138, "mean_action_processing_ms": 0.2294444576491215, "mean_env_wait_ms": 0.17261814660190977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036519765853881836, "StateBufferConnector_ms": 0.00303494930267334, "ViewRequirementAgentConnector_ms": 0.09872281551361084}, "num_episodes": 23, "episode_return_max": 347.0, "episode_return_min": 0.0, "episode_return_mean": 151.81, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 86.21370254323602, "num_env_steps_trained_throughput_per_sec": 86.21370254323602, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 45630.119, "restore_workers_time_ms": 0.016, "training_step_time_ms": 45630.062, "sample_time_ms": 1110.958, "learn_time_ms": 44501.584, "learn_throughput": 89.884, "synch_weights_time_ms": 14.621}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 87, "trial_id": "51025_00000", "date": "2024-08-12_21-30-08", "timestamp": 1723512608, "time_this_iter_s": 46.409207820892334, "time_total_s": 3960.3059978485107, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158bb9a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3960.3059978485107, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 23.40757575757576, "ram_util_percent": 81.2439393939394}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.517274727455522, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.22397135931348, "policy_loss": -0.01780729427743979, "vf_loss": 6.237760824627347, "vf_explained_var": 0.531046919091038, "kl": 0.013392748883529012, "entropy": 1.0233367255125096, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.144662620150854, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.357567423865909, "policy_loss": -0.008721692187011873, "vf_loss": 6.365659499042248, "vf_explained_var": 0.25459007239215586, "kl": 0.006296167355818836, "entropy": 0.6159280844466396, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "env_runners": {"episode_reward_max": 347.0, "episode_reward_min": 0.0, "episode_reward_mean": 155.02, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -182.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 185.0, "predator_policy": 192.0}, "policy_reward_mean": {"prey_policy": -6.38, "predator_policy": 83.89}, "custom_metrics": {}, "hist_stats": {"episode_reward": [128.0, 30.0, 23.0, 207.0, 140.0, 124.0, 191.0, 107.0, 107.0, 119.0, 213.0, 110.0, 91.0, 58.0, 228.0, 4.0, 0.0, 135.0, 141.0, 122.0, 342.0, 122.0, 229.0, 181.0, 92.0, 179.0, 169.0, 32.0, 172.0, 269.0, 270.0, 132.0, 153.0, 91.0, 246.0, 66.0, 222.0, 168.0, 208.0, 174.0, 84.0, 80.0, 97.0, 131.0, 162.0, 192.0, 85.0, 181.0, 101.0, 200.0, 261.0, 197.0, 64.0, 142.0, 151.0, 219.0, 181.0, 170.0, 184.0, 219.0, 181.0, 144.0, 152.0, 141.0, 128.0, 119.0, 239.0, 60.0, 171.0, 347.0, 242.0, 266.0, 136.0, 220.0, 313.0, 149.0, 212.0, 115.0, 213.0, 180.0, 217.0, 291.0, 30.0, 14.0, 272.0, 158.0, 47.0, 243.0, 89.0, 90.0, 281.0, 15.0, 128.0, 162.0, 172.0, 189.0, 110.0, 117.0, 42.0, 211.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-134.0, 70.0, -25.0, 0.0, -124.0, -120.0, 13.0, 38.0, -138.0, 1.0, -150.0, -1.0, -46.0, 12.0, 0.0, 11.0, -101.0, 12.0, -42.0, -71.0, -114.0, 82.0, -62.0, -20.0, -91.0, 0.0, -15.0, -149.0, -6.0, 78.0, -90.0, -143.0, 0.0, -4.0, -52.0, -12.0, 0.0, -33.0, -50.0, 76.0, 143.0, -14.0, 0.0, 20.0, 8.0, 34.0, 181.0, -2.0, 0.0, -94.0, 87.0, -32.0, -56.0, 22.0, -12.0, 0.0, -157.0, 70.0, 14.0, 23.0, 117.0, -116.0, -90.0, 49.0, -142.0, 40.0, 0.0, 1.0, 9.0, 57.0, -79.0, -108.0, -166.0, 107.0, 18.0, -21.0, -182.0, 52.0, -75.0, 53.0, -90.0, -73.0, -89.0, -28.0, -20.0, 0.0, 36.0, 0.0, -72.0, -4.0, -97.0, 59.0, -122.0, -36.0, 81.0, -106.0, 0.0, -63.0, 12.0, 23.0, -52.0, 185.0, 21.0, -15.0, 0.0, -164.0, -115.0, -13.0, -116.0, 20.0, 23.0, 100.0, -113.0, 50.0, 27.0, 50.0, -28.0, -29.0, -111.0, 52.0, 0.0, 177.0, 41.0, -43.0, 78.0, 0.0, 83.0, 0.0, 51.0, -57.0, 0.0, 6.0, -45.0, 75.0, 0.0, -46.0, 0.0, 149.0, 116.0, 164.0, 65.0, -142.0, 178.0, -119.0, -69.0, 61.0, 13.0, 30.0, 121.0, -124.0, 0.0, 114.0, 8.0, 36.0, -70.0, -100.0, -34.0, 93.0, -122.0, 54.0, 171.0, -130.0, 135.0, 32.0, 0.0, -90.0, -156.0, 0.0, 28.0, 117.0, 0.0, 118.0, 0.0, -35.0, 11.0, 110.0, -22.0, -143.0, -56.0, -70.0, 8.0, 76.0, -28.0, 0.0, 65.0, 0.0, 0.0, 118.0, 0.0, 109.0, 178.0, 0.0, 0.0, 20.0, -48.0, 0.0, -105.0, 0.0, -8.0, 35.0], "policy_predator_policy_reward": [181.0, 11.0, 55.0, 0.0, 183.0, 84.0, 156.0, 0.0, 153.0, 124.0, 118.0, 157.0, 124.0, 101.0, 75.0, 21.0, 83.0, 113.0, 135.0, 97.0, 115.0, 130.0, 105.0, 87.0, 55.0, 127.0, 141.0, 81.0, 44.0, 112.0, 77.0, 160.0, 0.0, 4.0, 104.0, 95.0, 96.0, 78.0, 0.0, 96.0, 95.0, 118.0, 43.0, 59.0, 55.0, 132.0, 0.0, 2.0, 74.0, 112.0, 124.0, 0.0, 82.0, 121.0, 44.0, 0.0, 191.0, 68.0, 140.0, 92.0, 133.0, 136.0, 8.0, 165.0, 162.0, 93.0, 75.0, 15.0, 58.0, 122.0, 116.0, 137.0, 91.0, 190.0, 55.0, 116.0, 192.0, 146.0, 38.0, 158.0, 116.0, 131.0, 57.0, 140.0, 58.0, 59.0, 39.0, 56.0, 107.0, 131.0, 105.0, 125.0, 178.0, 65.0, 55.0, 151.0, 72.0, 92.0, 101.0, 64.0, 42.0, 86.0, 126.0, 65.0, 88.0, 140.0, 120.0, 150.0, 114.0, 133.0, 44.0, 52.0, 114.0, 130.0, 0.0, 93.0, 96.0, 145.0, 144.0, 134.0, 2.0, 2.0, 84.0, 62.0, 44.0, 30.0, 12.0, 46.0, 42.0, 92.0, 77.0, 36.0, 72.0, 137.0, 26.0, 80.0, 22.0, 0.0, 25.0, 42.0, 171.0, 148.0, 109.0, 98.0, 59.0, 85.0, 65.0, 112.0, 161.0, 155.0, 35.0, 0.0, 113.0, 55.0, 162.0, 123.0, 97.0, 57.0, 68.0, 180.0, 88.0, 88.0, 59.0, 65.0, 77.0, 43.0, 14.0, 156.0, 52.0, 75.0, 0.0, 40.0, 41.0, 41.0, 96.0, 26.0, 179.0, 75.0, 117.0, 99.0, 90.0, 107.0, 33.0, 10.0, 63.0, 0.0, 16.0, 28.0, 32.0, 31.0, 10.0, 1.0, 90.0, 0.0, 64.0, 101.0, 1.0, 146.0, 84.0, 100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5781676238784121, "mean_inference_ms": 1.3073417215862109, "mean_action_processing_ms": 0.22951819406697735, "mean_env_wait_ms": 0.1726941558271964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035783052444458008, "StateBufferConnector_ms": 0.0030297040939331055, "ViewRequirementAgentConnector_ms": 0.09940743446350098}, "num_episodes": 18, "episode_return_max": 347.0, "episode_return_min": 0.0, "episode_return_mean": 155.02, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.3398236405561, "num_env_steps_trained_throughput_per_sec": 88.3398236405561, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1408000, "timers": {"training_iteration_time_ms": 45568.835, "restore_workers_time_ms": 0.016, "training_step_time_ms": 45568.777, "sample_time_ms": 1122.215, "learn_time_ms": 44427.924, "learn_throughput": 90.033, "synch_weights_time_ms": 14.724}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "done": false, "training_iteration": 88, "trial_id": "51025_00000", "date": "2024-08-12_21-30-54", "timestamp": 1723512654, "time_this_iter_s": 45.32283806800842, "time_total_s": 4005.628835916519, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158000ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4005.628835916519, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 20.678125, "ram_util_percent": 81.6796875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.47166310441557, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.192020692017974, "policy_loss": -0.011717450136328657, "vf_loss": 6.202135936293022, "vf_explained_var": 0.5656875070440706, "kl": 0.0053406889474489246, "entropy": 1.0351734209312964, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.40697548288517, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.717664194233203, "policy_loss": -0.01063615606319179, "vf_loss": 4.727410948213446, "vf_explained_var": 0.22777488061359952, "kl": 0.008893883449520606, "entropy": 0.6892629525648853, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "env_runners": {"episode_reward_max": 347.0, "episode_reward_min": 14.0, "episode_reward_mean": 170.21, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -182.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.0, "predator_policy": 192.0}, "policy_reward_mean": {"prey_policy": 11.68, "predator_policy": 73.425}, "custom_metrics": {}, "hist_stats": {"episode_reward": [229.0, 181.0, 92.0, 179.0, 169.0, 32.0, 172.0, 269.0, 270.0, 132.0, 153.0, 91.0, 246.0, 66.0, 222.0, 168.0, 208.0, 174.0, 84.0, 80.0, 97.0, 131.0, 162.0, 192.0, 85.0, 181.0, 101.0, 200.0, 261.0, 197.0, 64.0, 142.0, 151.0, 219.0, 181.0, 170.0, 184.0, 219.0, 181.0, 144.0, 152.0, 141.0, 128.0, 119.0, 239.0, 60.0, 171.0, 347.0, 242.0, 266.0, 136.0, 220.0, 313.0, 149.0, 212.0, 115.0, 213.0, 180.0, 217.0, 291.0, 30.0, 14.0, 272.0, 158.0, 47.0, 243.0, 89.0, 90.0, 281.0, 15.0, 128.0, 162.0, 172.0, 189.0, 110.0, 117.0, 42.0, 211.0, 273.0, 161.0, 286.0, 27.0, 113.0, 131.0, 306.0, 130.0, 326.0, 146.0, 180.0, 167.0, 274.0, 193.0, 181.0, 190.0, 214.0, 141.0, 265.0, 129.0, 298.0, 130.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [8.0, 34.0, 181.0, -2.0, 0.0, -94.0, 87.0, -32.0, -56.0, 22.0, -12.0, 0.0, -157.0, 70.0, 14.0, 23.0, 117.0, -116.0, -90.0, 49.0, -142.0, 40.0, 0.0, 1.0, 9.0, 57.0, -79.0, -108.0, -166.0, 107.0, 18.0, -21.0, -182.0, 52.0, -75.0, 53.0, -90.0, -73.0, -89.0, -28.0, -20.0, 0.0, 36.0, 0.0, -72.0, -4.0, -97.0, 59.0, -122.0, -36.0, 81.0, -106.0, 0.0, -63.0, 12.0, 23.0, -52.0, 185.0, 21.0, -15.0, 0.0, -164.0, -115.0, -13.0, -116.0, 20.0, 23.0, 100.0, -113.0, 50.0, 27.0, 50.0, -28.0, -29.0, -111.0, 52.0, 0.0, 177.0, 41.0, -43.0, 78.0, 0.0, 83.0, 0.0, 51.0, -57.0, 0.0, 6.0, -45.0, 75.0, 0.0, -46.0, 0.0, 149.0, 116.0, 164.0, 65.0, -142.0, 178.0, -119.0, -69.0, 61.0, 13.0, 30.0, 121.0, -124.0, 0.0, 114.0, 8.0, 36.0, -70.0, -100.0, -34.0, 93.0, -122.0, 54.0, 171.0, -130.0, 135.0, 32.0, 0.0, -90.0, -156.0, 0.0, 28.0, 117.0, 0.0, 118.0, 0.0, -35.0, 11.0, 110.0, -22.0, -143.0, -56.0, -70.0, 8.0, 76.0, -28.0, 0.0, 65.0, 0.0, 0.0, 118.0, 0.0, 109.0, 178.0, 0.0, 0.0, 20.0, -48.0, 0.0, -105.0, 0.0, -8.0, 35.0, -38.0, 175.0, -3.0, -13.0, 80.0, 101.0, -57.0, 0.0, -30.0, 0.0, 74.0, -2.0, 28.0, 188.0, 0.0, 27.0, 130.0, 148.0, 58.0, 0.0, 0.0, 179.0, -6.0, 68.0, 81.0, 107.0, -3.0, 180.0, 179.0, 0.0, -12.0, 185.0, -130.0, 159.0, -6.0, 83.0, -3.0, 196.0, 69.0, 0.0, -14.0, 124.0, 0.0, 59.0], "policy_predator_policy_reward": [55.0, 132.0, 0.0, 2.0, 74.0, 112.0, 124.0, 0.0, 82.0, 121.0, 44.0, 0.0, 191.0, 68.0, 140.0, 92.0, 133.0, 136.0, 8.0, 165.0, 162.0, 93.0, 75.0, 15.0, 58.0, 122.0, 116.0, 137.0, 91.0, 190.0, 55.0, 116.0, 192.0, 146.0, 38.0, 158.0, 116.0, 131.0, 57.0, 140.0, 58.0, 59.0, 39.0, 56.0, 107.0, 131.0, 105.0, 125.0, 178.0, 65.0, 55.0, 151.0, 72.0, 92.0, 101.0, 64.0, 42.0, 86.0, 126.0, 65.0, 88.0, 140.0, 120.0, 150.0, 114.0, 133.0, 44.0, 52.0, 114.0, 130.0, 0.0, 93.0, 96.0, 145.0, 144.0, 134.0, 2.0, 2.0, 84.0, 62.0, 44.0, 30.0, 12.0, 46.0, 42.0, 92.0, 77.0, 36.0, 72.0, 137.0, 26.0, 80.0, 22.0, 0.0, 25.0, 42.0, 171.0, 148.0, 109.0, 98.0, 59.0, 85.0, 65.0, 112.0, 161.0, 155.0, 35.0, 0.0, 113.0, 55.0, 162.0, 123.0, 97.0, 57.0, 68.0, 180.0, 88.0, 88.0, 59.0, 65.0, 77.0, 43.0, 14.0, 156.0, 52.0, 75.0, 0.0, 40.0, 41.0, 41.0, 96.0, 26.0, 179.0, 75.0, 117.0, 99.0, 90.0, 107.0, 33.0, 10.0, 63.0, 0.0, 16.0, 28.0, 32.0, 31.0, 10.0, 1.0, 90.0, 0.0, 64.0, 101.0, 1.0, 146.0, 84.0, 100.0, 119.0, 17.0, 121.0, 56.0, 45.0, 60.0, 15.0, 69.0, 105.0, 38.0, 57.0, 2.0, 17.0, 73.0, 57.0, 46.0, 15.0, 33.0, 33.0, 55.0, 1.0, 0.0, 60.0, 45.0, 76.0, 10.0, 13.0, 3.0, 2.0, 0.0, 12.0, 5.0, 47.0, 138.0, 33.0, 31.0, 29.0, 43.0, 60.0, 0.0, 75.0, 113.0, 36.0, 35.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5783719695455083, "mean_inference_ms": 1.3069691205723957, "mean_action_processing_ms": 0.22943066054722727, "mean_env_wait_ms": 0.17273548438589606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035361051559448242, "StateBufferConnector_ms": 0.0030286312103271484, "ViewRequirementAgentConnector_ms": 0.09948670864105225}, "num_episodes": 22, "episode_return_max": 347.0, "episode_return_min": 14.0, "episode_return_mean": 170.21, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 86.10213985157982, "num_env_steps_trained_throughput_per_sec": 86.10213985157982, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 1424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1424000, "timers": {"training_iteration_time_ms": 45639.438, "restore_workers_time_ms": 0.016, "training_step_time_ms": 45639.379, "sample_time_ms": 1105.959, "learn_time_ms": 44514.614, "learn_throughput": 89.858, "synch_weights_time_ms": 14.967}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "done": false, "training_iteration": 89, "trial_id": "51025_00000", "date": "2024-08-12_21-31-40", "timestamp": 1723512700, "time_this_iter_s": 46.479024171829224, "time_total_s": 4052.1078600883484, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158039dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4052.1078600883484, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 27.4, "ram_util_percent": 81.90923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.237447083942474, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.1573046855825595, "policy_loss": -0.018802368135447736, "vf_loss": 7.172790446357122, "vf_explained_var": 0.15061410331221484, "kl": 0.011055356701051169, "entropy": 1.0227828359477735, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.307180287976745, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.567121929340262, "policy_loss": -0.006501685636408785, "vf_loss": 5.5731409468978805, "vf_explained_var": 0.19936009803146282, "kl": 0.004826693634498422, "entropy": 0.6256832395911848, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 347.0, "episode_reward_min": 3.0, "episode_reward_mean": 167.49, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -164.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.0, "predator_policy": 181.0}, "policy_reward_mean": {"prey_policy": 15.615, "predator_policy": 68.13}, "custom_metrics": {}, "hist_stats": {"episode_reward": [84.0, 80.0, 97.0, 131.0, 162.0, 192.0, 85.0, 181.0, 101.0, 200.0, 261.0, 197.0, 64.0, 142.0, 151.0, 219.0, 181.0, 170.0, 184.0, 219.0, 181.0, 144.0, 152.0, 141.0, 128.0, 119.0, 239.0, 60.0, 171.0, 347.0, 242.0, 266.0, 136.0, 220.0, 313.0, 149.0, 212.0, 115.0, 213.0, 180.0, 217.0, 291.0, 30.0, 14.0, 272.0, 158.0, 47.0, 243.0, 89.0, 90.0, 281.0, 15.0, 128.0, 162.0, 172.0, 189.0, 110.0, 117.0, 42.0, 211.0, 273.0, 161.0, 286.0, 27.0, 113.0, 131.0, 306.0, 130.0, 326.0, 146.0, 180.0, 167.0, 274.0, 193.0, 181.0, 190.0, 214.0, 141.0, 265.0, 129.0, 298.0, 130.0, 3.0, 119.0, 195.0, 340.0, 138.0, 65.0, 164.0, 256.0, 93.0, 138.0, 78.0, 314.0, 169.0, 123.0, 233.0, 100.0, 82.0, 171.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-90.0, -73.0, -89.0, -28.0, -20.0, 0.0, 36.0, 0.0, -72.0, -4.0, -97.0, 59.0, -122.0, -36.0, 81.0, -106.0, 0.0, -63.0, 12.0, 23.0, -52.0, 185.0, 21.0, -15.0, 0.0, -164.0, -115.0, -13.0, -116.0, 20.0, 23.0, 100.0, -113.0, 50.0, 27.0, 50.0, -28.0, -29.0, -111.0, 52.0, 0.0, 177.0, 41.0, -43.0, 78.0, 0.0, 83.0, 0.0, 51.0, -57.0, 0.0, 6.0, -45.0, 75.0, 0.0, -46.0, 0.0, 149.0, 116.0, 164.0, 65.0, -142.0, 178.0, -119.0, -69.0, 61.0, 13.0, 30.0, 121.0, -124.0, 0.0, 114.0, 8.0, 36.0, -70.0, -100.0, -34.0, 93.0, -122.0, 54.0, 171.0, -130.0, 135.0, 32.0, 0.0, -90.0, -156.0, 0.0, 28.0, 117.0, 0.0, 118.0, 0.0, -35.0, 11.0, 110.0, -22.0, -143.0, -56.0, -70.0, 8.0, 76.0, -28.0, 0.0, 65.0, 0.0, 0.0, 118.0, 0.0, 109.0, 178.0, 0.0, 0.0, 20.0, -48.0, 0.0, -105.0, 0.0, -8.0, 35.0, -38.0, 175.0, -3.0, -13.0, 80.0, 101.0, -57.0, 0.0, -30.0, 0.0, 74.0, -2.0, 28.0, 188.0, 0.0, 27.0, 130.0, 148.0, 58.0, 0.0, 0.0, 179.0, -6.0, 68.0, 81.0, 107.0, -3.0, 180.0, 179.0, 0.0, -12.0, 185.0, -130.0, 159.0, -6.0, 83.0, -3.0, 196.0, 69.0, 0.0, -14.0, 124.0, 0.0, 59.0, 3.0, 0.0, 0.0, 36.0, 54.0, 24.0, 90.0, 108.0, 23.0, 18.0, -77.0, -104.0, 65.0, -135.0, -91.0, 172.0, -19.0, 0.0, 0.0, 15.0, -115.0, -55.0, 145.0, 100.0, 0.0, 129.0, -33.0, 56.0, 71.0, 59.0, -24.0, 0.0, -105.0, -30.0, 52.0, -35.0], "policy_predator_policy_reward": [116.0, 131.0, 57.0, 140.0, 58.0, 59.0, 39.0, 56.0, 107.0, 131.0, 105.0, 125.0, 178.0, 65.0, 55.0, 151.0, 72.0, 92.0, 101.0, 64.0, 42.0, 86.0, 126.0, 65.0, 88.0, 140.0, 120.0, 150.0, 114.0, 133.0, 44.0, 52.0, 114.0, 130.0, 0.0, 93.0, 96.0, 145.0, 144.0, 134.0, 2.0, 2.0, 84.0, 62.0, 44.0, 30.0, 12.0, 46.0, 42.0, 92.0, 77.0, 36.0, 72.0, 137.0, 26.0, 80.0, 22.0, 0.0, 25.0, 42.0, 171.0, 148.0, 109.0, 98.0, 59.0, 85.0, 65.0, 112.0, 161.0, 155.0, 35.0, 0.0, 113.0, 55.0, 162.0, 123.0, 97.0, 57.0, 68.0, 180.0, 88.0, 88.0, 59.0, 65.0, 77.0, 43.0, 14.0, 156.0, 52.0, 75.0, 0.0, 40.0, 41.0, 41.0, 96.0, 26.0, 179.0, 75.0, 117.0, 99.0, 90.0, 107.0, 33.0, 10.0, 63.0, 0.0, 16.0, 28.0, 32.0, 31.0, 10.0, 1.0, 90.0, 0.0, 64.0, 101.0, 1.0, 146.0, 84.0, 100.0, 119.0, 17.0, 121.0, 56.0, 45.0, 60.0, 15.0, 69.0, 105.0, 38.0, 57.0, 2.0, 17.0, 73.0, 57.0, 46.0, 15.0, 33.0, 33.0, 55.0, 1.0, 0.0, 60.0, 45.0, 76.0, 10.0, 13.0, 3.0, 2.0, 0.0, 12.0, 5.0, 47.0, 138.0, 33.0, 31.0, 29.0, 43.0, 60.0, 0.0, 75.0, 113.0, 36.0, 35.0, 0.0, 0.0, 9.0, 74.0, 31.0, 86.0, 69.0, 73.0, 24.0, 73.0, 65.0, 181.0, 77.0, 157.0, 136.0, 39.0, 51.0, 61.0, 46.0, 77.0, 127.0, 121.0, 67.0, 2.0, 21.0, 19.0, 33.0, 67.0, 101.0, 2.0, 22.0, 102.0, 105.0, 112.0, 136.0, 18.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5785631113581299, "mean_inference_ms": 1.3081256661331941, "mean_action_processing_ms": 0.22961385631920678, "mean_env_wait_ms": 0.17278817217383555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035952329635620117, "StateBufferConnector_ms": 0.003092050552368164, "ViewRequirementAgentConnector_ms": 0.10082435607910156}, "num_episodes": 18, "episode_return_max": 347.0, "episode_return_min": 3.0, "episode_return_mean": 167.49, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.7387782817892, "num_env_steps_trained_throughput_per_sec": 88.7387782817892, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 45588.056, "restore_workers_time_ms": 0.016, "training_step_time_ms": 45587.998, "sample_time_ms": 1110.489, "learn_time_ms": 44459.057, "learn_throughput": 89.97, "synch_weights_time_ms": 14.818}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 90, "trial_id": "51025_00000", "date": "2024-08-12_21-32-25", "timestamp": 1723512745, "time_this_iter_s": 45.11616086959839, "time_total_s": 4097.224020957947, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1580a00d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4097.224020957947, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 20.040625, "ram_util_percent": 79.96249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.413480436297322, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.304211665461303, "policy_loss": -0.015050499544173439, "vf_loss": 7.316702924455915, "vf_explained_var": 0.1964960601594713, "kl": 0.008530746747131921, "entropy": 1.0133342408629322, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.136279675317189, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.069013244891293, "policy_loss": -0.009141186454762069, "vf_loss": 6.0776348747273605, "vf_explained_var": 0.2856549816787558, "kl": 0.0103912117776233, "entropy": 0.6470114154475076, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "env_runners": {"episode_reward_max": 368.0, "episode_reward_min": 0.0, "episode_reward_mean": 176.07, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -196.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.0, "predator_policy": 189.0}, "policy_reward_mean": {"prey_policy": 25.635, "predator_policy": 62.4}, "custom_metrics": {}, "hist_stats": {"episode_reward": [141.0, 128.0, 119.0, 239.0, 60.0, 171.0, 347.0, 242.0, 266.0, 136.0, 220.0, 313.0, 149.0, 212.0, 115.0, 213.0, 180.0, 217.0, 291.0, 30.0, 14.0, 272.0, 158.0, 47.0, 243.0, 89.0, 90.0, 281.0, 15.0, 128.0, 162.0, 172.0, 189.0, 110.0, 117.0, 42.0, 211.0, 273.0, 161.0, 286.0, 27.0, 113.0, 131.0, 306.0, 130.0, 326.0, 146.0, 180.0, 167.0, 274.0, 193.0, 181.0, 190.0, 214.0, 141.0, 265.0, 129.0, 298.0, 130.0, 3.0, 119.0, 195.0, 340.0, 138.0, 65.0, 164.0, 256.0, 93.0, 138.0, 78.0, 314.0, 169.0, 123.0, 233.0, 100.0, 82.0, 171.0, 241.0, 253.0, 253.0, 173.0, 311.0, 143.0, 322.0, 118.0, 299.0, 256.0, 106.0, 99.0, 143.0, 183.0, 25.0, 174.0, 158.0, 297.0, 368.0, 280.0, 122.0, 0.0, 112.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [83.0, 0.0, 51.0, -57.0, 0.0, 6.0, -45.0, 75.0, 0.0, -46.0, 0.0, 149.0, 116.0, 164.0, 65.0, -142.0, 178.0, -119.0, -69.0, 61.0, 13.0, 30.0, 121.0, -124.0, 0.0, 114.0, 8.0, 36.0, -70.0, -100.0, -34.0, 93.0, -122.0, 54.0, 171.0, -130.0, 135.0, 32.0, 0.0, -90.0, -156.0, 0.0, 28.0, 117.0, 0.0, 118.0, 0.0, -35.0, 11.0, 110.0, -22.0, -143.0, -56.0, -70.0, 8.0, 76.0, -28.0, 0.0, 65.0, 0.0, 0.0, 118.0, 0.0, 109.0, 178.0, 0.0, 0.0, 20.0, -48.0, 0.0, -105.0, 0.0, -8.0, 35.0, -38.0, 175.0, -3.0, -13.0, 80.0, 101.0, -57.0, 0.0, -30.0, 0.0, 74.0, -2.0, 28.0, 188.0, 0.0, 27.0, 130.0, 148.0, 58.0, 0.0, 0.0, 179.0, -6.0, 68.0, 81.0, 107.0, -3.0, 180.0, 179.0, 0.0, -12.0, 185.0, -130.0, 159.0, -6.0, 83.0, -3.0, 196.0, 69.0, 0.0, -14.0, 124.0, 0.0, 59.0, 3.0, 0.0, 0.0, 36.0, 54.0, 24.0, 90.0, 108.0, 23.0, 18.0, -77.0, -104.0, 65.0, -135.0, -91.0, 172.0, -19.0, 0.0, 0.0, 15.0, -115.0, -55.0, 145.0, 100.0, 0.0, 129.0, -33.0, 56.0, 71.0, 59.0, -24.0, 0.0, -105.0, -30.0, 52.0, -35.0, -7.0, 137.0, -40.0, 130.0, 50.0, 180.0, 24.0, -12.0, 164.0, -196.0, 50.0, 0.0, 186.0, 118.0, 0.0, 32.0, 35.0, 169.0, 18.0, 145.0, -140.0, -58.0, -65.0, -66.0, 27.0, -81.0, -54.0, 50.0, -85.0, 0.0, 43.0, 40.0, 0.0, 119.0, 147.0, 56.0, 175.0, 167.0, 30.0, 6.0, 50.0, 0.0, 0.0, 0.0, 46.0, -150.0], "policy_predator_policy_reward": [12.0, 46.0, 42.0, 92.0, 77.0, 36.0, 72.0, 137.0, 26.0, 80.0, 22.0, 0.0, 25.0, 42.0, 171.0, 148.0, 109.0, 98.0, 59.0, 85.0, 65.0, 112.0, 161.0, 155.0, 35.0, 0.0, 113.0, 55.0, 162.0, 123.0, 97.0, 57.0, 68.0, 180.0, 88.0, 88.0, 59.0, 65.0, 77.0, 43.0, 14.0, 156.0, 52.0, 75.0, 0.0, 40.0, 41.0, 41.0, 96.0, 26.0, 179.0, 75.0, 117.0, 99.0, 90.0, 107.0, 33.0, 10.0, 63.0, 0.0, 16.0, 28.0, 32.0, 31.0, 10.0, 1.0, 90.0, 0.0, 64.0, 101.0, 1.0, 146.0, 84.0, 100.0, 119.0, 17.0, 121.0, 56.0, 45.0, 60.0, 15.0, 69.0, 105.0, 38.0, 57.0, 2.0, 17.0, 73.0, 57.0, 46.0, 15.0, 33.0, 33.0, 55.0, 1.0, 0.0, 60.0, 45.0, 76.0, 10.0, 13.0, 3.0, 2.0, 0.0, 12.0, 5.0, 47.0, 138.0, 33.0, 31.0, 29.0, 43.0, 60.0, 0.0, 75.0, 113.0, 36.0, 35.0, 0.0, 0.0, 9.0, 74.0, 31.0, 86.0, 69.0, 73.0, 24.0, 73.0, 65.0, 181.0, 77.0, 157.0, 136.0, 39.0, 51.0, 61.0, 46.0, 77.0, 127.0, 121.0, 67.0, 2.0, 21.0, 19.0, 33.0, 67.0, 101.0, 2.0, 22.0, 102.0, 105.0, 112.0, 136.0, 18.0, 67.0, 44.0, 99.0, 64.0, 19.0, 4.0, 145.0, 16.0, 154.0, 189.0, 67.0, 26.0, 14.0, 4.0, 14.0, 72.0, 70.0, 25.0, 25.0, 68.0, 136.0, 168.0, 98.0, 132.0, 53.0, 144.0, 31.0, 156.0, 2.0, 108.0, 17.0, 74.0, 23.0, 16.0, 29.0, 65.0, 10.0, 16.0, 131.0, 113.0, 2.0, 70.0, 0.0, 0.0, 164.0, 52.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5788638434696319, "mean_inference_ms": 1.3078934460273277, "mean_action_processing_ms": 0.22945912965615786, "mean_env_wait_ms": 0.1727591462028764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039501190185546875, "StateBufferConnector_ms": 0.003045320510864258, "ViewRequirementAgentConnector_ms": 0.09933781623840332}, "num_episodes": 23, "episode_return_max": 368.0, "episode_return_min": 0.0, "episode_return_mean": 176.07, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.31201455829846, "num_env_steps_trained_throughput_per_sec": 88.31201455829846, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 1456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1456000, "timers": {"training_iteration_time_ms": 45600.984, "restore_workers_time_ms": 0.016, "training_step_time_ms": 45600.926, "sample_time_ms": 1108.151, "learn_time_ms": 44474.202, "learn_throughput": 89.94, "synch_weights_time_ms": 14.874}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "done": false, "training_iteration": 91, "trial_id": "51025_00000", "date": "2024-08-12_21-33-11", "timestamp": 1723512791, "time_this_iter_s": 45.348503828048706, "time_total_s": 4142.5725247859955, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158039b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4142.5725247859955, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 20.05076923076923, "ram_util_percent": 80.13076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.174656290478177, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.603636750216206, "policy_loss": -0.013681032474364632, "vf_loss": 6.61491272714403, "vf_explained_var": -0.5747553489195607, "kl": 0.008016856660546298, "entropy": 0.9998575026080722, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.647675604795023, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.409540842702149, "policy_loss": -0.008085523937612023, "vf_loss": 6.417227076474951, "vf_explained_var": 0.3041943601199559, "kl": 0.007986044788084403, "entropy": 0.635748132606032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "env_runners": {"episode_reward_max": 368.0, "episode_reward_min": -73.0, "episode_reward_mean": 153.75, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -196.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.0, "predator_policy": 197.0}, "policy_reward_mean": {"prey_policy": 14.55, "predator_policy": 62.325}, "custom_metrics": {}, "hist_stats": {"episode_reward": [291.0, 30.0, 14.0, 272.0, 158.0, 47.0, 243.0, 89.0, 90.0, 281.0, 15.0, 128.0, 162.0, 172.0, 189.0, 110.0, 117.0, 42.0, 211.0, 273.0, 161.0, 286.0, 27.0, 113.0, 131.0, 306.0, 130.0, 326.0, 146.0, 180.0, 167.0, 274.0, 193.0, 181.0, 190.0, 214.0, 141.0, 265.0, 129.0, 298.0, 130.0, 3.0, 119.0, 195.0, 340.0, 138.0, 65.0, 164.0, 256.0, 93.0, 138.0, 78.0, 314.0, 169.0, 123.0, 233.0, 100.0, 82.0, 171.0, 241.0, 253.0, 253.0, 173.0, 311.0, 143.0, 322.0, 118.0, 299.0, 256.0, 106.0, 99.0, 143.0, 183.0, 25.0, 174.0, 158.0, 297.0, 368.0, 280.0, 122.0, 0.0, 112.0, -21.0, 218.0, -67.0, 39.0, 122.0, -73.0, -29.0, 19.0, 0.0, 84.0, 24.0, 132.0, 147.0, 223.0, -10.0, 156.0, 311.0, -39.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [135.0, 32.0, 0.0, -90.0, -156.0, 0.0, 28.0, 117.0, 0.0, 118.0, 0.0, -35.0, 11.0, 110.0, -22.0, -143.0, -56.0, -70.0, 8.0, 76.0, -28.0, 0.0, 65.0, 0.0, 0.0, 118.0, 0.0, 109.0, 178.0, 0.0, 0.0, 20.0, -48.0, 0.0, -105.0, 0.0, -8.0, 35.0, -38.0, 175.0, -3.0, -13.0, 80.0, 101.0, -57.0, 0.0, -30.0, 0.0, 74.0, -2.0, 28.0, 188.0, 0.0, 27.0, 130.0, 148.0, 58.0, 0.0, 0.0, 179.0, -6.0, 68.0, 81.0, 107.0, -3.0, 180.0, 179.0, 0.0, -12.0, 185.0, -130.0, 159.0, -6.0, 83.0, -3.0, 196.0, 69.0, 0.0, -14.0, 124.0, 0.0, 59.0, 3.0, 0.0, 0.0, 36.0, 54.0, 24.0, 90.0, 108.0, 23.0, 18.0, -77.0, -104.0, 65.0, -135.0, -91.0, 172.0, -19.0, 0.0, 0.0, 15.0, -115.0, -55.0, 145.0, 100.0, 0.0, 129.0, -33.0, 56.0, 71.0, 59.0, -24.0, 0.0, -105.0, -30.0, 52.0, -35.0, -7.0, 137.0, -40.0, 130.0, 50.0, 180.0, 24.0, -12.0, 164.0, -196.0, 50.0, 0.0, 186.0, 118.0, 0.0, 32.0, 35.0, 169.0, 18.0, 145.0, -140.0, -58.0, -65.0, -66.0, 27.0, -81.0, -54.0, 50.0, -85.0, 0.0, 43.0, 40.0, 0.0, 119.0, 147.0, 56.0, 175.0, 167.0, 30.0, 6.0, 50.0, 0.0, 0.0, 0.0, 46.0, -150.0, -165.0, -82.0, -39.0, 67.0, -131.0, -149.0, -110.0, 0.0, 74.0, 0.0, -125.0, -121.0, -100.0, -124.0, -32.0, -121.0, -1.0, 0.0, 0.0, -95.0, -15.0, 0.0, 0.0, -59.0, 31.0, -119.0, 156.0, -70.0, -113.0, -56.0, 56.0, -69.0, -104.0, 168.0, -74.0, -165.0], "policy_predator_policy_reward": [59.0, 65.0, 77.0, 43.0, 14.0, 156.0, 52.0, 75.0, 0.0, 40.0, 41.0, 41.0, 96.0, 26.0, 179.0, 75.0, 117.0, 99.0, 90.0, 107.0, 33.0, 10.0, 63.0, 0.0, 16.0, 28.0, 32.0, 31.0, 10.0, 1.0, 90.0, 0.0, 64.0, 101.0, 1.0, 146.0, 84.0, 100.0, 119.0, 17.0, 121.0, 56.0, 45.0, 60.0, 15.0, 69.0, 105.0, 38.0, 57.0, 2.0, 17.0, 73.0, 57.0, 46.0, 15.0, 33.0, 33.0, 55.0, 1.0, 0.0, 60.0, 45.0, 76.0, 10.0, 13.0, 3.0, 2.0, 0.0, 12.0, 5.0, 47.0, 138.0, 33.0, 31.0, 29.0, 43.0, 60.0, 0.0, 75.0, 113.0, 36.0, 35.0, 0.0, 0.0, 9.0, 74.0, 31.0, 86.0, 69.0, 73.0, 24.0, 73.0, 65.0, 181.0, 77.0, 157.0, 136.0, 39.0, 51.0, 61.0, 46.0, 77.0, 127.0, 121.0, 67.0, 2.0, 21.0, 19.0, 33.0, 67.0, 101.0, 2.0, 22.0, 102.0, 105.0, 112.0, 136.0, 18.0, 67.0, 44.0, 99.0, 64.0, 19.0, 4.0, 145.0, 16.0, 154.0, 189.0, 67.0, 26.0, 14.0, 4.0, 14.0, 72.0, 70.0, 25.0, 25.0, 68.0, 136.0, 168.0, 98.0, 132.0, 53.0, 144.0, 31.0, 156.0, 2.0, 108.0, 17.0, 74.0, 23.0, 16.0, 29.0, 65.0, 10.0, 16.0, 131.0, 113.0, 2.0, 70.0, 0.0, 0.0, 164.0, 52.0, 184.0, 42.0, 122.0, 68.0, 197.0, 16.0, 0.0, 149.0, 42.0, 6.0, 7.0, 166.0, 174.0, 21.0, 126.0, 46.0, 0.0, 1.0, 78.0, 101.0, 12.0, 27.0, 85.0, 106.0, 149.0, 86.0, 2.0, 135.0, 159.0, 0.0, 67.0, 102.0, 136.0, 111.0, 197.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5783500423747695, "mean_inference_ms": 1.307342599448493, "mean_action_processing_ms": 0.22954344984432218, "mean_env_wait_ms": 0.1727387516611861, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004417300224304199, "StateBufferConnector_ms": 0.002953767776489258, "ViewRequirementAgentConnector_ms": 0.09505891799926758}, "num_episodes": 18, "episode_return_max": 368.0, "episode_return_min": -73.0, "episode_return_mean": 153.75, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.33150567866025, "num_env_steps_trained_throughput_per_sec": 88.33150567866025, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1472000, "timers": {"training_iteration_time_ms": 45605.035, "restore_workers_time_ms": 0.016, "training_step_time_ms": 45604.978, "sample_time_ms": 1092.369, "learn_time_ms": 44493.787, "learn_throughput": 89.9, "synch_weights_time_ms": 15.154}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "done": false, "training_iteration": 92, "trial_id": "51025_00000", "date": "2024-08-12_21-33-56", "timestamp": 1723512836, "time_this_iter_s": 45.31238389015198, "time_total_s": 4187.8849086761475, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158086ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4187.8849086761475, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 19.765625, "ram_util_percent": 80.05624999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.015961707269073, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.682392900456827, "policy_loss": -0.009986213234218734, "vf_loss": 6.690625899178642, "vf_explained_var": 0.13186988575117928, "kl": 0.005843982233646165, "entropy": 0.9533491314088226, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.470357533611319, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.950535255512864, "policy_loss": -0.007662126977765371, "vf_loss": 5.957748085859591, "vf_explained_var": 0.2233017716458235, "kl": 0.00898598940520228, "entropy": 0.6407812955833617, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 368.0, "episode_reward_min": -73.0, "episode_reward_mean": 153.89, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -196.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": 12.44, "predator_policy": 64.505}, "custom_metrics": {}, "hist_stats": {"episode_reward": [211.0, 273.0, 161.0, 286.0, 27.0, 113.0, 131.0, 306.0, 130.0, 326.0, 146.0, 180.0, 167.0, 274.0, 193.0, 181.0, 190.0, 214.0, 141.0, 265.0, 129.0, 298.0, 130.0, 3.0, 119.0, 195.0, 340.0, 138.0, 65.0, 164.0, 256.0, 93.0, 138.0, 78.0, 314.0, 169.0, 123.0, 233.0, 100.0, 82.0, 171.0, 241.0, 253.0, 253.0, 173.0, 311.0, 143.0, 322.0, 118.0, 299.0, 256.0, 106.0, 99.0, 143.0, 183.0, 25.0, 174.0, 158.0, 297.0, 368.0, 280.0, 122.0, 0.0, 112.0, -21.0, 218.0, -67.0, 39.0, 122.0, -73.0, -29.0, 19.0, 0.0, 84.0, 24.0, 132.0, 147.0, 223.0, -10.0, 156.0, 311.0, -39.0, 0.0, 208.0, 84.0, 167.0, 57.0, 159.0, 150.0, 306.0, 297.0, 56.0, 314.0, 156.0, 80.0, 147.0, 92.0, 18.0, -28.0, 201.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-8.0, 35.0, -38.0, 175.0, -3.0, -13.0, 80.0, 101.0, -57.0, 0.0, -30.0, 0.0, 74.0, -2.0, 28.0, 188.0, 0.0, 27.0, 130.0, 148.0, 58.0, 0.0, 0.0, 179.0, -6.0, 68.0, 81.0, 107.0, -3.0, 180.0, 179.0, 0.0, -12.0, 185.0, -130.0, 159.0, -6.0, 83.0, -3.0, 196.0, 69.0, 0.0, -14.0, 124.0, 0.0, 59.0, 3.0, 0.0, 0.0, 36.0, 54.0, 24.0, 90.0, 108.0, 23.0, 18.0, -77.0, -104.0, 65.0, -135.0, -91.0, 172.0, -19.0, 0.0, 0.0, 15.0, -115.0, -55.0, 145.0, 100.0, 0.0, 129.0, -33.0, 56.0, 71.0, 59.0, -24.0, 0.0, -105.0, -30.0, 52.0, -35.0, -7.0, 137.0, -40.0, 130.0, 50.0, 180.0, 24.0, -12.0, 164.0, -196.0, 50.0, 0.0, 186.0, 118.0, 0.0, 32.0, 35.0, 169.0, 18.0, 145.0, -140.0, -58.0, -65.0, -66.0, 27.0, -81.0, -54.0, 50.0, -85.0, 0.0, 43.0, 40.0, 0.0, 119.0, 147.0, 56.0, 175.0, 167.0, 30.0, 6.0, 50.0, 0.0, 0.0, 0.0, 46.0, -150.0, -165.0, -82.0, -39.0, 67.0, -131.0, -149.0, -110.0, 0.0, 74.0, 0.0, -125.0, -121.0, -100.0, -124.0, -32.0, -121.0, -1.0, 0.0, 0.0, -95.0, -15.0, 0.0, 0.0, -59.0, 31.0, -119.0, 156.0, -70.0, -113.0, -56.0, 56.0, -69.0, -104.0, 168.0, -74.0, -165.0, 0.0, 0.0, 172.0, -156.0, 2.0, -112.0, 167.0, 0.0, -173.0, 0.0, 0.0, -63.0, 0.0, -14.0, 69.0, 135.0, 60.0, 123.0, -145.0, -110.0, 116.0, 148.0, 110.0, -6.0, -4.0, 0.0, 103.0, 0.0, 9.0, -196.0, 0.0, -40.0, -184.0, -155.0, -18.0, 112.0], "policy_predator_policy_reward": [84.0, 100.0, 119.0, 17.0, 121.0, 56.0, 45.0, 60.0, 15.0, 69.0, 105.0, 38.0, 57.0, 2.0, 17.0, 73.0, 57.0, 46.0, 15.0, 33.0, 33.0, 55.0, 1.0, 0.0, 60.0, 45.0, 76.0, 10.0, 13.0, 3.0, 2.0, 0.0, 12.0, 5.0, 47.0, 138.0, 33.0, 31.0, 29.0, 43.0, 60.0, 0.0, 75.0, 113.0, 36.0, 35.0, 0.0, 0.0, 9.0, 74.0, 31.0, 86.0, 69.0, 73.0, 24.0, 73.0, 65.0, 181.0, 77.0, 157.0, 136.0, 39.0, 51.0, 61.0, 46.0, 77.0, 127.0, 121.0, 67.0, 2.0, 21.0, 19.0, 33.0, 67.0, 101.0, 2.0, 22.0, 102.0, 105.0, 112.0, 136.0, 18.0, 67.0, 44.0, 99.0, 64.0, 19.0, 4.0, 145.0, 16.0, 154.0, 189.0, 67.0, 26.0, 14.0, 4.0, 14.0, 72.0, 70.0, 25.0, 25.0, 68.0, 136.0, 168.0, 98.0, 132.0, 53.0, 144.0, 31.0, 156.0, 2.0, 108.0, 17.0, 74.0, 23.0, 16.0, 29.0, 65.0, 10.0, 16.0, 131.0, 113.0, 2.0, 70.0, 0.0, 0.0, 164.0, 52.0, 184.0, 42.0, 122.0, 68.0, 197.0, 16.0, 0.0, 149.0, 42.0, 6.0, 7.0, 166.0, 174.0, 21.0, 126.0, 46.0, 0.0, 1.0, 78.0, 101.0, 12.0, 27.0, 85.0, 106.0, 149.0, 86.0, 2.0, 135.0, 159.0, 0.0, 67.0, 102.0, 136.0, 111.0, 197.0, 3.0, 0.0, 0.0, 21.0, 171.0, 150.0, 44.0, 0.0, 0.0, 76.0, 154.0, 96.0, 126.0, 86.0, 78.0, 90.0, 12.0, 60.0, 54.0, 146.0, 165.0, 50.0, 0.0, 34.0, 18.0, 65.0, 19.0, 0.0, 44.0, 200.0, 79.0, 46.0, 12.0, 119.0, 192.0, 62.0, 45.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.578053642949512, "mean_inference_ms": 1.3065823664020573, "mean_action_processing_ms": 0.22947044586681442, "mean_env_wait_ms": 0.17268399215056773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00491786003112793, "StateBufferConnector_ms": 0.0029467344284057617, "ViewRequirementAgentConnector_ms": 0.09278523921966553}, "num_episodes": 18, "episode_return_max": 368.0, "episode_return_min": -73.0, "episode_return_mean": 153.89, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 87.41038863756894, "num_env_steps_trained_throughput_per_sec": 87.41038863756894, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 45644.353, "restore_workers_time_ms": 0.016, "training_step_time_ms": 45644.296, "sample_time_ms": 1096.861, "learn_time_ms": 44528.076, "learn_throughput": 89.831, "synch_weights_time_ms": 15.528}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 93, "trial_id": "51025_00000", "date": "2024-08-12_21-34-42", "timestamp": 1723512882, "time_this_iter_s": 45.81867218017578, "time_total_s": 4233.703580856323, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158bbfd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4233.703580856323, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 22.0828125, "ram_util_percent": 80.26093750000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.5482889734248, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.261305163650916, "policy_loss": -0.011423771296228681, "vf_loss": 6.270561817461852, "vf_explained_var": 0.07077756621850231, "kl": 0.007223684321976538, "entropy": 0.989741059144338, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.715656582136003, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.119929589165581, "policy_loss": -0.007488249735007427, "vf_loss": 7.126970731392109, "vf_explained_var": 0.19854719638824464, "kl": 0.008941994714878955, "entropy": 0.6664158177754236, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "env_runners": {"episode_reward_max": 368.0, "episode_reward_min": -73.0, "episode_reward_mean": 139.99, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -196.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 186.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": 0.685, "predator_policy": 69.31}, "custom_metrics": {}, "hist_stats": {"episode_reward": [130.0, 3.0, 119.0, 195.0, 340.0, 138.0, 65.0, 164.0, 256.0, 93.0, 138.0, 78.0, 314.0, 169.0, 123.0, 233.0, 100.0, 82.0, 171.0, 241.0, 253.0, 253.0, 173.0, 311.0, 143.0, 322.0, 118.0, 299.0, 256.0, 106.0, 99.0, 143.0, 183.0, 25.0, 174.0, 158.0, 297.0, 368.0, 280.0, 122.0, 0.0, 112.0, -21.0, 218.0, -67.0, 39.0, 122.0, -73.0, -29.0, 19.0, 0.0, 84.0, 24.0, 132.0, 147.0, 223.0, -10.0, 156.0, 311.0, -39.0, 0.0, 208.0, 84.0, 167.0, 57.0, 159.0, 150.0, 306.0, 297.0, 56.0, 314.0, 156.0, 80.0, 147.0, 92.0, 18.0, -28.0, 201.0, 251.0, 135.0, 0.0, 79.0, 173.0, 224.0, 67.0, 79.0, 184.0, 165.0, 94.0, 173.0, 325.0, 148.0, 31.0, 121.0, 127.0, 151.0, 38.0, 127.0, 82.0, 178.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 59.0, 3.0, 0.0, 0.0, 36.0, 54.0, 24.0, 90.0, 108.0, 23.0, 18.0, -77.0, -104.0, 65.0, -135.0, -91.0, 172.0, -19.0, 0.0, 0.0, 15.0, -115.0, -55.0, 145.0, 100.0, 0.0, 129.0, -33.0, 56.0, 71.0, 59.0, -24.0, 0.0, -105.0, -30.0, 52.0, -35.0, -7.0, 137.0, -40.0, 130.0, 50.0, 180.0, 24.0, -12.0, 164.0, -196.0, 50.0, 0.0, 186.0, 118.0, 0.0, 32.0, 35.0, 169.0, 18.0, 145.0, -140.0, -58.0, -65.0, -66.0, 27.0, -81.0, -54.0, 50.0, -85.0, 0.0, 43.0, 40.0, 0.0, 119.0, 147.0, 56.0, 175.0, 167.0, 30.0, 6.0, 50.0, 0.0, 0.0, 0.0, 46.0, -150.0, -165.0, -82.0, -39.0, 67.0, -131.0, -149.0, -110.0, 0.0, 74.0, 0.0, -125.0, -121.0, -100.0, -124.0, -32.0, -121.0, -1.0, 0.0, 0.0, -95.0, -15.0, 0.0, 0.0, -59.0, 31.0, -119.0, 156.0, -70.0, -113.0, -56.0, 56.0, -69.0, -104.0, 168.0, -74.0, -165.0, 0.0, 0.0, 172.0, -156.0, 2.0, -112.0, 167.0, 0.0, -173.0, 0.0, 0.0, -63.0, 0.0, -14.0, 69.0, 135.0, 60.0, 123.0, -145.0, -110.0, 116.0, 148.0, 110.0, -6.0, -4.0, 0.0, 103.0, 0.0, 9.0, -196.0, 0.0, -40.0, -184.0, -155.0, -18.0, 112.0, 100.0, 30.0, 0.0, 8.0, 0.0, 0.0, -67.0, -74.0, 141.0, -10.0, -77.0, 120.0, -52.0, 0.0, 0.0, -68.0, 15.0, -2.0, 126.0, -107.0, -7.0, -37.0, 29.0, -89.0, 104.0, 145.0, 44.0, 0.0, -119.0, -49.0, 46.0, -160.0, 51.0, 0.0, -71.0, 2.0, -173.0, 0.0, 0.0, 81.0, 0.0, -15.0, 17.0, 96.0], "policy_predator_policy_reward": [36.0, 35.0, 0.0, 0.0, 9.0, 74.0, 31.0, 86.0, 69.0, 73.0, 24.0, 73.0, 65.0, 181.0, 77.0, 157.0, 136.0, 39.0, 51.0, 61.0, 46.0, 77.0, 127.0, 121.0, 67.0, 2.0, 21.0, 19.0, 33.0, 67.0, 101.0, 2.0, 22.0, 102.0, 105.0, 112.0, 136.0, 18.0, 67.0, 44.0, 99.0, 64.0, 19.0, 4.0, 145.0, 16.0, 154.0, 189.0, 67.0, 26.0, 14.0, 4.0, 14.0, 72.0, 70.0, 25.0, 25.0, 68.0, 136.0, 168.0, 98.0, 132.0, 53.0, 144.0, 31.0, 156.0, 2.0, 108.0, 17.0, 74.0, 23.0, 16.0, 29.0, 65.0, 10.0, 16.0, 131.0, 113.0, 2.0, 70.0, 0.0, 0.0, 164.0, 52.0, 184.0, 42.0, 122.0, 68.0, 197.0, 16.0, 0.0, 149.0, 42.0, 6.0, 7.0, 166.0, 174.0, 21.0, 126.0, 46.0, 0.0, 1.0, 78.0, 101.0, 12.0, 27.0, 85.0, 106.0, 149.0, 86.0, 2.0, 135.0, 159.0, 0.0, 67.0, 102.0, 136.0, 111.0, 197.0, 3.0, 0.0, 0.0, 21.0, 171.0, 150.0, 44.0, 0.0, 0.0, 76.0, 154.0, 96.0, 126.0, 86.0, 78.0, 90.0, 12.0, 60.0, 54.0, 146.0, 165.0, 50.0, 0.0, 34.0, 18.0, 65.0, 19.0, 0.0, 44.0, 200.0, 79.0, 46.0, 12.0, 119.0, 192.0, 62.0, 45.0, 3.0, 118.0, 57.0, 70.0, 0.0, 0.0, 124.0, 96.0, 29.0, 13.0, 60.0, 121.0, 57.0, 62.0, 71.0, 76.0, 153.0, 18.0, 2.0, 144.0, 40.0, 98.0, 122.0, 111.0, 27.0, 49.0, 43.0, 61.0, 27.0, 172.0, 170.0, 65.0, 2.0, 74.0, 92.0, 128.0, 175.0, 36.0, 12.0, 34.0, 97.0, 0.0, 0.0, 65.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.577709121692388, "mean_inference_ms": 1.3056172910582695, "mean_action_processing_ms": 0.22939179471346577, "mean_env_wait_ms": 0.17262137267053843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005792140960693359, "StateBufferConnector_ms": 0.002966165542602539, "ViewRequirementAgentConnector_ms": 0.08921802043914795}, "num_episodes": 22, "episode_return_max": 368.0, "episode_return_min": -73.0, "episode_return_mean": 139.99, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.8113486917765, "num_env_steps_trained_throughput_per_sec": 88.8113486917765, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1504000, "timers": {"training_iteration_time_ms": 45613.902, "restore_workers_time_ms": 0.016, "training_step_time_ms": 45613.847, "sample_time_ms": 1093.397, "learn_time_ms": 44501.478, "learn_throughput": 89.885, "synch_weights_time_ms": 15.392}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "done": false, "training_iteration": 94, "trial_id": "51025_00000", "date": "2024-08-12_21-35-27", "timestamp": 1723512927, "time_this_iter_s": 45.04357194900513, "time_total_s": 4278.747152805328, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1580de4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4278.747152805328, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 19.315625, "ram_util_percent": 80.175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.45370483101991, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.444593275161017, "policy_loss": -0.015779188929480457, "vf_loss": 6.457781547717947, "vf_explained_var": 0.3082794843527375, "kl": 0.008636414927089173, "entropy": 1.006772419510695, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.288054922018102, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.4616685723501535, "policy_loss": -0.007093815241260306, "vf_loss": 6.468485201477374, "vf_explained_var": 0.13744264027429007, "kl": 0.005543727012097846, "entropy": 0.7009695481055628, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 368.0, "episode_reward_min": -73.0, "episode_reward_mean": 136.71, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -200.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 190.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": 0.115, "predator_policy": 68.24}, "custom_metrics": {}, "hist_stats": {"episode_reward": [171.0, 241.0, 253.0, 253.0, 173.0, 311.0, 143.0, 322.0, 118.0, 299.0, 256.0, 106.0, 99.0, 143.0, 183.0, 25.0, 174.0, 158.0, 297.0, 368.0, 280.0, 122.0, 0.0, 112.0, -21.0, 218.0, -67.0, 39.0, 122.0, -73.0, -29.0, 19.0, 0.0, 84.0, 24.0, 132.0, 147.0, 223.0, -10.0, 156.0, 311.0, -39.0, 0.0, 208.0, 84.0, 167.0, 57.0, 159.0, 150.0, 306.0, 297.0, 56.0, 314.0, 156.0, 80.0, 147.0, 92.0, 18.0, -28.0, 201.0, 251.0, 135.0, 0.0, 79.0, 173.0, 224.0, 67.0, 79.0, 184.0, 165.0, 94.0, 173.0, 325.0, 148.0, 31.0, 121.0, 127.0, 151.0, 38.0, 127.0, 82.0, 178.0, 22.0, 98.0, 174.0, 118.0, 180.0, 23.0, 203.0, 235.0, 117.0, 78.0, 169.0, 340.0, 0.0, 168.0, 94.0, 1.0, 172.0, 220.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [52.0, -35.0, -7.0, 137.0, -40.0, 130.0, 50.0, 180.0, 24.0, -12.0, 164.0, -196.0, 50.0, 0.0, 186.0, 118.0, 0.0, 32.0, 35.0, 169.0, 18.0, 145.0, -140.0, -58.0, -65.0, -66.0, 27.0, -81.0, -54.0, 50.0, -85.0, 0.0, 43.0, 40.0, 0.0, 119.0, 147.0, 56.0, 175.0, 167.0, 30.0, 6.0, 50.0, 0.0, 0.0, 0.0, 46.0, -150.0, -165.0, -82.0, -39.0, 67.0, -131.0, -149.0, -110.0, 0.0, 74.0, 0.0, -125.0, -121.0, -100.0, -124.0, -32.0, -121.0, -1.0, 0.0, 0.0, -95.0, -15.0, 0.0, 0.0, -59.0, 31.0, -119.0, 156.0, -70.0, -113.0, -56.0, 56.0, -69.0, -104.0, 168.0, -74.0, -165.0, 0.0, 0.0, 172.0, -156.0, 2.0, -112.0, 167.0, 0.0, -173.0, 0.0, 0.0, -63.0, 0.0, -14.0, 69.0, 135.0, 60.0, 123.0, -145.0, -110.0, 116.0, 148.0, 110.0, -6.0, -4.0, 0.0, 103.0, 0.0, 9.0, -196.0, 0.0, -40.0, -184.0, -155.0, -18.0, 112.0, 100.0, 30.0, 0.0, 8.0, 0.0, 0.0, -67.0, -74.0, 141.0, -10.0, -77.0, 120.0, -52.0, 0.0, 0.0, -68.0, 15.0, -2.0, 126.0, -107.0, -7.0, -37.0, 29.0, -89.0, 104.0, 145.0, 44.0, 0.0, -119.0, -49.0, 46.0, -160.0, 51.0, 0.0, -71.0, 2.0, -173.0, 0.0, 0.0, 81.0, 0.0, -15.0, 17.0, 96.0, 0.0, -119.0, -37.0, 0.0, -59.0, 26.0, 20.0, -11.0, 52.0, -41.0, 0.0, -39.0, 71.0, -18.0, 14.0, 80.0, 0.0, 84.0, 0.0, 9.0, 162.0, 0.0, 190.0, 54.0, -200.0, 0.0, 0.0, 91.0, 18.0, 0.0, -81.0, -15.0, -37.0, -32.0, -40.0, 183.0], "policy_predator_policy_reward": [136.0, 18.0, 67.0, 44.0, 99.0, 64.0, 19.0, 4.0, 145.0, 16.0, 154.0, 189.0, 67.0, 26.0, 14.0, 4.0, 14.0, 72.0, 70.0, 25.0, 25.0, 68.0, 136.0, 168.0, 98.0, 132.0, 53.0, 144.0, 31.0, 156.0, 2.0, 108.0, 17.0, 74.0, 23.0, 16.0, 29.0, 65.0, 10.0, 16.0, 131.0, 113.0, 2.0, 70.0, 0.0, 0.0, 164.0, 52.0, 184.0, 42.0, 122.0, 68.0, 197.0, 16.0, 0.0, 149.0, 42.0, 6.0, 7.0, 166.0, 174.0, 21.0, 126.0, 46.0, 0.0, 1.0, 78.0, 101.0, 12.0, 27.0, 85.0, 106.0, 149.0, 86.0, 2.0, 135.0, 159.0, 0.0, 67.0, 102.0, 136.0, 111.0, 197.0, 3.0, 0.0, 0.0, 21.0, 171.0, 150.0, 44.0, 0.0, 0.0, 76.0, 154.0, 96.0, 126.0, 86.0, 78.0, 90.0, 12.0, 60.0, 54.0, 146.0, 165.0, 50.0, 0.0, 34.0, 18.0, 65.0, 19.0, 0.0, 44.0, 200.0, 79.0, 46.0, 12.0, 119.0, 192.0, 62.0, 45.0, 3.0, 118.0, 57.0, 70.0, 0.0, 0.0, 124.0, 96.0, 29.0, 13.0, 60.0, 121.0, 57.0, 62.0, 71.0, 76.0, 153.0, 18.0, 2.0, 144.0, 40.0, 98.0, 122.0, 111.0, 27.0, 49.0, 43.0, 61.0, 27.0, 172.0, 170.0, 65.0, 2.0, 74.0, 92.0, 128.0, 175.0, 36.0, 12.0, 34.0, 97.0, 0.0, 0.0, 65.0, 135.0, 6.0, 46.0, 89.0, 57.0, 150.0, 26.0, 83.0, 73.0, 96.0, 17.0, 45.0, 107.0, 43.0, 67.0, 74.0, 6.0, 27.0, 30.0, 39.0, 1.0, 6.0, 31.0, 65.0, 200.0, 0.0, 32.0, 45.0, 76.0, 0.0, 96.0, 1.0, 122.0, 119.0, 40.0, 37.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5773894066010499, "mean_inference_ms": 1.3046515946752646, "mean_action_processing_ms": 0.22931242935113136, "mean_env_wait_ms": 0.17254339487528328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006764411926269531, "StateBufferConnector_ms": 0.0029642581939697266, "ViewRequirementAgentConnector_ms": 0.09353077411651611}, "num_episodes": 18, "episode_return_max": 368.0, "episode_return_min": -73.0, "episode_return_mean": 136.71, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.90968149683884, "num_env_steps_trained_throughput_per_sec": 88.90968149683884, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 45581.975, "restore_workers_time_ms": 0.016, "training_step_time_ms": 45581.921, "sample_time_ms": 1084.809, "learn_time_ms": 44479.36, "learn_throughput": 89.929, "synch_weights_time_ms": 14.312}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 95, "trial_id": "51025_00000", "date": "2024-08-12_21-36-12", "timestamp": 1723512972, "time_this_iter_s": 45.042876958847046, "time_total_s": 4323.790029764175, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158039f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4323.790029764175, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 19.88125, "ram_util_percent": 80.1609375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.248884705008653, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.713513686164977, "policy_loss": -0.011538478860966664, "vf_loss": 6.7228222927719195, "vf_explained_var": 0.1555397590001424, "kl": 0.007432824366162663, "entropy": 1.0180888951140106, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.425035111235562, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.819444168181646, "policy_loss": -0.007100608912124126, "vf_loss": 5.826189445061658, "vf_explained_var": 0.15107405545219543, "kl": 0.007106626913891112, "entropy": 0.690277100240112, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 390.0, "episode_reward_min": -73.0, "episode_reward_mean": 130.46, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -200.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": -2.49, "predator_policy": 67.72}, "custom_metrics": {}, "hist_stats": {"episode_reward": [112.0, -21.0, 218.0, -67.0, 39.0, 122.0, -73.0, -29.0, 19.0, 0.0, 84.0, 24.0, 132.0, 147.0, 223.0, -10.0, 156.0, 311.0, -39.0, 0.0, 208.0, 84.0, 167.0, 57.0, 159.0, 150.0, 306.0, 297.0, 56.0, 314.0, 156.0, 80.0, 147.0, 92.0, 18.0, -28.0, 201.0, 251.0, 135.0, 0.0, 79.0, 173.0, 224.0, 67.0, 79.0, 184.0, 165.0, 94.0, 173.0, 325.0, 148.0, 31.0, 121.0, 127.0, 151.0, 38.0, 127.0, 82.0, 178.0, 22.0, 98.0, 174.0, 118.0, 180.0, 23.0, 203.0, 235.0, 117.0, 78.0, 169.0, 340.0, 0.0, 168.0, 94.0, 1.0, 172.0, 220.0, 157.0, 57.0, 224.0, 170.0, 229.0, 63.0, 81.0, 155.0, 180.0, 108.0, 30.0, 250.0, 390.0, 199.0, 166.0, 100.0, 173.0, 281.0, 0.0, 260.0, 166.0, 232.0, 199.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [46.0, -150.0, -165.0, -82.0, -39.0, 67.0, -131.0, -149.0, -110.0, 0.0, 74.0, 0.0, -125.0, -121.0, -100.0, -124.0, -32.0, -121.0, -1.0, 0.0, 0.0, -95.0, -15.0, 0.0, 0.0, -59.0, 31.0, -119.0, 156.0, -70.0, -113.0, -56.0, 56.0, -69.0, -104.0, 168.0, -74.0, -165.0, 0.0, 0.0, 172.0, -156.0, 2.0, -112.0, 167.0, 0.0, -173.0, 0.0, 0.0, -63.0, 0.0, -14.0, 69.0, 135.0, 60.0, 123.0, -145.0, -110.0, 116.0, 148.0, 110.0, -6.0, -4.0, 0.0, 103.0, 0.0, 9.0, -196.0, 0.0, -40.0, -184.0, -155.0, -18.0, 112.0, 100.0, 30.0, 0.0, 8.0, 0.0, 0.0, -67.0, -74.0, 141.0, -10.0, -77.0, 120.0, -52.0, 0.0, 0.0, -68.0, 15.0, -2.0, 126.0, -107.0, -7.0, -37.0, 29.0, -89.0, 104.0, 145.0, 44.0, 0.0, -119.0, -49.0, 46.0, -160.0, 51.0, 0.0, -71.0, 2.0, -173.0, 0.0, 0.0, 81.0, 0.0, -15.0, 17.0, 96.0, 0.0, -119.0, -37.0, 0.0, -59.0, 26.0, 20.0, -11.0, 52.0, -41.0, 0.0, -39.0, 71.0, -18.0, 14.0, 80.0, 0.0, 84.0, 0.0, 9.0, 162.0, 0.0, 190.0, 54.0, -200.0, 0.0, 0.0, 91.0, 18.0, 0.0, -81.0, -15.0, -37.0, -32.0, -40.0, 183.0, 12.0, 0.0, -14.0, -82.0, 66.0, 14.0, 0.0, 137.0, 32.0, -25.0, 0.0, -42.0, -44.0, -36.0, 64.0, 0.0, 162.0, 0.0, 2.0, -100.0, -147.0, -164.0, 77.0, 47.0, 200.0, 190.0, 50.0, 77.0, -24.0, 60.0, 4.0, 0.0, 80.0, 0.0, 88.0, 132.0, 0.0, 0.0, 78.0, 55.0, -68.0, 28.0, -81.0, 170.0, 12.0, 30.0], "policy_predator_policy_reward": [164.0, 52.0, 184.0, 42.0, 122.0, 68.0, 197.0, 16.0, 0.0, 149.0, 42.0, 6.0, 7.0, 166.0, 174.0, 21.0, 126.0, 46.0, 0.0, 1.0, 78.0, 101.0, 12.0, 27.0, 85.0, 106.0, 149.0, 86.0, 2.0, 135.0, 159.0, 0.0, 67.0, 102.0, 136.0, 111.0, 197.0, 3.0, 0.0, 0.0, 21.0, 171.0, 150.0, 44.0, 0.0, 0.0, 76.0, 154.0, 96.0, 126.0, 86.0, 78.0, 90.0, 12.0, 60.0, 54.0, 146.0, 165.0, 50.0, 0.0, 34.0, 18.0, 65.0, 19.0, 0.0, 44.0, 200.0, 79.0, 46.0, 12.0, 119.0, 192.0, 62.0, 45.0, 3.0, 118.0, 57.0, 70.0, 0.0, 0.0, 124.0, 96.0, 29.0, 13.0, 60.0, 121.0, 57.0, 62.0, 71.0, 76.0, 153.0, 18.0, 2.0, 144.0, 40.0, 98.0, 122.0, 111.0, 27.0, 49.0, 43.0, 61.0, 27.0, 172.0, 170.0, 65.0, 2.0, 74.0, 92.0, 128.0, 175.0, 36.0, 12.0, 34.0, 97.0, 0.0, 0.0, 65.0, 135.0, 6.0, 46.0, 89.0, 57.0, 150.0, 26.0, 83.0, 73.0, 96.0, 17.0, 45.0, 107.0, 43.0, 67.0, 74.0, 6.0, 27.0, 30.0, 39.0, 1.0, 6.0, 31.0, 65.0, 200.0, 0.0, 32.0, 45.0, 76.0, 0.0, 96.0, 1.0, 122.0, 119.0, 40.0, 37.0, 88.0, 57.0, 128.0, 25.0, 15.0, 129.0, 11.0, 22.0, 110.0, 112.0, 2.0, 103.0, 113.0, 48.0, 49.0, 42.0, 0.0, 18.0, 155.0, 51.0, 172.0, 169.0, 34.0, 92.0, 0.0, 0.0, 31.0, 41.0, 28.0, 102.0, 68.0, 28.0, 39.0, 54.0, 15.0, 46.0, 0.0, 0.0, 57.0, 70.0, 84.0, 122.0, 139.0, 4.0, 81.0, 76.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5771340331641981, "mean_inference_ms": 1.3037108169115712, "mean_action_processing_ms": 0.22922474563051998, "mean_env_wait_ms": 0.1724652224764487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006462574005126953, "StateBufferConnector_ms": 0.0031110048294067383, "ViewRequirementAgentConnector_ms": 0.0975104570388794}, "num_episodes": 23, "episode_return_max": 390.0, "episode_return_min": -73.0, "episode_return_mean": 130.46, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.01089035894263, "num_env_steps_trained_throughput_per_sec": 88.01089035894263, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 45502.546, "restore_workers_time_ms": 0.016, "training_step_time_ms": 45502.493, "sample_time_ms": 1084.66, "learn_time_ms": 44400.828, "learn_throughput": 90.088, "synch_weights_time_ms": 13.944}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 96, "trial_id": "51025_00000", "date": "2024-08-12_21-36-58", "timestamp": 1723513018, "time_this_iter_s": 45.495681047439575, "time_total_s": 4369.285710811615, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1580dd5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4369.285710811615, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 21.034375, "ram_util_percent": 80.5609375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.3190412802671, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.503474779734536, "policy_loss": -0.011818792583006952, "vf_loss": 6.513283905907283, "vf_explained_var": 0.19549990223829078, "kl": 0.006698868159593188, "entropy": 0.9753386209250758, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.250107467237603, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.080983778156301, "policy_loss": -0.01022320153147337, "vf_loss": 5.090794622330439, "vf_explained_var": 0.2553140492350967, "kl": 0.008246731774730285, "entropy": 0.7086824636610728, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "env_runners": {"episode_reward_max": 390.0, "episode_reward_min": -39.0, "episode_reward_mean": 142.61, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -200.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": 8.495, "predator_policy": 62.81}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-39.0, 0.0, 208.0, 84.0, 167.0, 57.0, 159.0, 150.0, 306.0, 297.0, 56.0, 314.0, 156.0, 80.0, 147.0, 92.0, 18.0, -28.0, 201.0, 251.0, 135.0, 0.0, 79.0, 173.0, 224.0, 67.0, 79.0, 184.0, 165.0, 94.0, 173.0, 325.0, 148.0, 31.0, 121.0, 127.0, 151.0, 38.0, 127.0, 82.0, 178.0, 22.0, 98.0, 174.0, 118.0, 180.0, 23.0, 203.0, 235.0, 117.0, 78.0, 169.0, 340.0, 0.0, 168.0, 94.0, 1.0, 172.0, 220.0, 157.0, 57.0, 224.0, 170.0, 229.0, 63.0, 81.0, 155.0, 180.0, 108.0, 30.0, 250.0, 390.0, 199.0, 166.0, 100.0, 173.0, 281.0, 0.0, 260.0, 166.0, 232.0, 199.0, 265.0, 90.0, 234.0, 46.0, 147.0, 78.0, 96.0, 19.0, 119.0, 127.0, 51.0, 128.0, 117.0, 135.0, 182.0, 317.0, 289.0, 162.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-74.0, -165.0, 0.0, 0.0, 172.0, -156.0, 2.0, -112.0, 167.0, 0.0, -173.0, 0.0, 0.0, -63.0, 0.0, -14.0, 69.0, 135.0, 60.0, 123.0, -145.0, -110.0, 116.0, 148.0, 110.0, -6.0, -4.0, 0.0, 103.0, 0.0, 9.0, -196.0, 0.0, -40.0, -184.0, -155.0, -18.0, 112.0, 100.0, 30.0, 0.0, 8.0, 0.0, 0.0, -67.0, -74.0, 141.0, -10.0, -77.0, 120.0, -52.0, 0.0, 0.0, -68.0, 15.0, -2.0, 126.0, -107.0, -7.0, -37.0, 29.0, -89.0, 104.0, 145.0, 44.0, 0.0, -119.0, -49.0, 46.0, -160.0, 51.0, 0.0, -71.0, 2.0, -173.0, 0.0, 0.0, 81.0, 0.0, -15.0, 17.0, 96.0, 0.0, -119.0, -37.0, 0.0, -59.0, 26.0, 20.0, -11.0, 52.0, -41.0, 0.0, -39.0, 71.0, -18.0, 14.0, 80.0, 0.0, 84.0, 0.0, 9.0, 162.0, 0.0, 190.0, 54.0, -200.0, 0.0, 0.0, 91.0, 18.0, 0.0, -81.0, -15.0, -37.0, -32.0, -40.0, 183.0, 12.0, 0.0, -14.0, -82.0, 66.0, 14.0, 0.0, 137.0, 32.0, -25.0, 0.0, -42.0, -44.0, -36.0, 64.0, 0.0, 162.0, 0.0, 2.0, -100.0, -147.0, -164.0, 77.0, 47.0, 200.0, 190.0, 50.0, 77.0, -24.0, 60.0, 4.0, 0.0, 80.0, 0.0, 88.0, 132.0, 0.0, 0.0, 78.0, 55.0, -68.0, 28.0, -81.0, 170.0, 12.0, 30.0, 135.0, 111.0, -24.0, 0.0, -82.0, 176.0, -132.0, -34.0, 56.0, 0.0, -52.0, -45.0, -15.0, 0.0, -1.0, -17.0, -22.0, -5.0, 93.0, 0.0, -63.0, 0.0, 44.0, -73.0, -36.0, -72.0, 55.0, -158.0, 0.0, 166.0, 172.0, 86.0, 128.0, 137.0, 128.0, -11.0], "policy_predator_policy_reward": [197.0, 3.0, 0.0, 0.0, 21.0, 171.0, 150.0, 44.0, 0.0, 0.0, 76.0, 154.0, 96.0, 126.0, 86.0, 78.0, 90.0, 12.0, 60.0, 54.0, 146.0, 165.0, 50.0, 0.0, 34.0, 18.0, 65.0, 19.0, 0.0, 44.0, 200.0, 79.0, 46.0, 12.0, 119.0, 192.0, 62.0, 45.0, 3.0, 118.0, 57.0, 70.0, 0.0, 0.0, 124.0, 96.0, 29.0, 13.0, 60.0, 121.0, 57.0, 62.0, 71.0, 76.0, 153.0, 18.0, 2.0, 144.0, 40.0, 98.0, 122.0, 111.0, 27.0, 49.0, 43.0, 61.0, 27.0, 172.0, 170.0, 65.0, 2.0, 74.0, 92.0, 128.0, 175.0, 36.0, 12.0, 34.0, 97.0, 0.0, 0.0, 65.0, 135.0, 6.0, 46.0, 89.0, 57.0, 150.0, 26.0, 83.0, 73.0, 96.0, 17.0, 45.0, 107.0, 43.0, 67.0, 74.0, 6.0, 27.0, 30.0, 39.0, 1.0, 6.0, 31.0, 65.0, 200.0, 0.0, 32.0, 45.0, 76.0, 0.0, 96.0, 1.0, 122.0, 119.0, 40.0, 37.0, 88.0, 57.0, 128.0, 25.0, 15.0, 129.0, 11.0, 22.0, 110.0, 112.0, 2.0, 103.0, 113.0, 48.0, 49.0, 42.0, 0.0, 18.0, 155.0, 51.0, 172.0, 169.0, 34.0, 92.0, 0.0, 0.0, 31.0, 41.0, 28.0, 102.0, 68.0, 28.0, 39.0, 54.0, 15.0, 46.0, 0.0, 0.0, 57.0, 70.0, 84.0, 122.0, 139.0, 4.0, 81.0, 76.0, 1.0, 18.0, 109.0, 5.0, 2.0, 138.0, 69.0, 143.0, 53.0, 38.0, 78.0, 97.0, 18.0, 93.0, 0.0, 37.0, 100.0, 46.0, 0.0, 34.0, 0.0, 114.0, 102.0, 55.0, 192.0, 33.0, 136.0, 102.0, 16.0, 0.0, 32.0, 27.0, 0.0, 24.0, 11.0, 34.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5768907100092167, "mean_inference_ms": 1.3030605791628531, "mean_action_processing_ms": 0.22917029468249292, "mean_env_wait_ms": 0.17241919170717396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005789279937744141, "StateBufferConnector_ms": 0.0030783414840698242, "ViewRequirementAgentConnector_ms": 0.09645569324493408}, "num_episodes": 18, "episode_return_max": 390.0, "episode_return_min": -39.0, "episode_return_mean": 142.61, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 87.50220486862112, "num_env_steps_trained_throughput_per_sec": 87.50220486862112, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 1552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1552000, "timers": {"training_iteration_time_ms": 45434.223, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45434.179, "sample_time_ms": 1056.689, "learn_time_ms": 44360.391, "learn_throughput": 90.171, "synch_weights_time_ms": 14.072}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "done": false, "training_iteration": 97, "trial_id": "51025_00000", "date": "2024-08-12_21-37-43", "timestamp": 1723513063, "time_this_iter_s": 45.73931694030762, "time_total_s": 4415.025027751923, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32cb47160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4415.025027751923, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 20.42, "ram_util_percent": 80.57538461538462}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.171315002693701, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.57176303686919, "policy_loss": -0.013399449359901526, "vf_loss": 6.582503925303302, "vf_explained_var": -0.09370287133272363, "kl": 0.008861838727921428, "entropy": 1.0186131597511352, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.03222234097738, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.158265993077919, "policy_loss": -0.007789366998803364, "vf_loss": 6.165744461332049, "vf_explained_var": 0.22184756026066169, "kl": 0.006218328622142306, "entropy": 0.7384863370625431, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "env_runners": {"episode_reward_max": 390.0, "episode_reward_min": -7.0, "episode_reward_mean": 142.8, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -200.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": 12.055, "predator_policy": 59.345}, "custom_metrics": {}, "hist_stats": {"episode_reward": [79.0, 173.0, 224.0, 67.0, 79.0, 184.0, 165.0, 94.0, 173.0, 325.0, 148.0, 31.0, 121.0, 127.0, 151.0, 38.0, 127.0, 82.0, 178.0, 22.0, 98.0, 174.0, 118.0, 180.0, 23.0, 203.0, 235.0, 117.0, 78.0, 169.0, 340.0, 0.0, 168.0, 94.0, 1.0, 172.0, 220.0, 157.0, 57.0, 224.0, 170.0, 229.0, 63.0, 81.0, 155.0, 180.0, 108.0, 30.0, 250.0, 390.0, 199.0, 166.0, 100.0, 173.0, 281.0, 0.0, 260.0, 166.0, 232.0, 199.0, 265.0, 90.0, 234.0, 46.0, 147.0, 78.0, 96.0, 19.0, 119.0, 127.0, 51.0, 128.0, 117.0, 135.0, 182.0, 317.0, 289.0, 162.0, 190.0, 188.0, 0.0, 0.0, 107.0, 179.0, 35.0, 101.0, 205.0, 238.0, 100.0, 298.0, 102.0, 101.0, 154.0, 128.0, 0.0, 204.0, 203.0, 210.0, -7.0, 94.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-67.0, -74.0, 141.0, -10.0, -77.0, 120.0, -52.0, 0.0, 0.0, -68.0, 15.0, -2.0, 126.0, -107.0, -7.0, -37.0, 29.0, -89.0, 104.0, 145.0, 44.0, 0.0, -119.0, -49.0, 46.0, -160.0, 51.0, 0.0, -71.0, 2.0, -173.0, 0.0, 0.0, 81.0, 0.0, -15.0, 17.0, 96.0, 0.0, -119.0, -37.0, 0.0, -59.0, 26.0, 20.0, -11.0, 52.0, -41.0, 0.0, -39.0, 71.0, -18.0, 14.0, 80.0, 0.0, 84.0, 0.0, 9.0, 162.0, 0.0, 190.0, 54.0, -200.0, 0.0, 0.0, 91.0, 18.0, 0.0, -81.0, -15.0, -37.0, -32.0, -40.0, 183.0, 12.0, 0.0, -14.0, -82.0, 66.0, 14.0, 0.0, 137.0, 32.0, -25.0, 0.0, -42.0, -44.0, -36.0, 64.0, 0.0, 162.0, 0.0, 2.0, -100.0, -147.0, -164.0, 77.0, 47.0, 200.0, 190.0, 50.0, 77.0, -24.0, 60.0, 4.0, 0.0, 80.0, 0.0, 88.0, 132.0, 0.0, 0.0, 78.0, 55.0, -68.0, 28.0, -81.0, 170.0, 12.0, 30.0, 135.0, 111.0, -24.0, 0.0, -82.0, 176.0, -132.0, -34.0, 56.0, 0.0, -52.0, -45.0, -15.0, 0.0, -1.0, -17.0, -22.0, -5.0, 93.0, 0.0, -63.0, 0.0, 44.0, -73.0, -36.0, -72.0, 55.0, -158.0, 0.0, 166.0, 172.0, 86.0, 128.0, 137.0, 128.0, -11.0, 79.0, -24.0, 16.0, 88.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 110.0, -100.0, 0.0, -19.0, 2.0, 0.0, 18.0, 12.0, 152.0, -9.0, 62.0, 0.0, 118.0, 126.0, 0.0, -12.0, -80.0, -100.0, 0.0, 121.0, 108.0, 0.0, 0.0, 0.0, 11.0, 38.0, -32.0, 146.0, 150.0, -84.0, -161.0, -190.0, 5.0, 0.0], "policy_predator_policy_reward": [124.0, 96.0, 29.0, 13.0, 60.0, 121.0, 57.0, 62.0, 71.0, 76.0, 153.0, 18.0, 2.0, 144.0, 40.0, 98.0, 122.0, 111.0, 27.0, 49.0, 43.0, 61.0, 27.0, 172.0, 170.0, 65.0, 2.0, 74.0, 92.0, 128.0, 175.0, 36.0, 12.0, 34.0, 97.0, 0.0, 0.0, 65.0, 135.0, 6.0, 46.0, 89.0, 57.0, 150.0, 26.0, 83.0, 73.0, 96.0, 17.0, 45.0, 107.0, 43.0, 67.0, 74.0, 6.0, 27.0, 30.0, 39.0, 1.0, 6.0, 31.0, 65.0, 200.0, 0.0, 32.0, 45.0, 76.0, 0.0, 96.0, 1.0, 122.0, 119.0, 40.0, 37.0, 88.0, 57.0, 128.0, 25.0, 15.0, 129.0, 11.0, 22.0, 110.0, 112.0, 2.0, 103.0, 113.0, 48.0, 49.0, 42.0, 0.0, 18.0, 155.0, 51.0, 172.0, 169.0, 34.0, 92.0, 0.0, 0.0, 31.0, 41.0, 28.0, 102.0, 68.0, 28.0, 39.0, 54.0, 15.0, 46.0, 0.0, 0.0, 57.0, 70.0, 84.0, 122.0, 139.0, 4.0, 81.0, 76.0, 1.0, 18.0, 109.0, 5.0, 2.0, 138.0, 69.0, 143.0, 53.0, 38.0, 78.0, 97.0, 18.0, 93.0, 0.0, 37.0, 100.0, 46.0, 0.0, 34.0, 0.0, 114.0, 102.0, 55.0, 192.0, 33.0, 136.0, 102.0, 16.0, 0.0, 32.0, 27.0, 0.0, 24.0, 11.0, 34.0, 38.0, 97.0, 36.0, 48.0, 0.0, 0.0, 0.0, 0.0, 83.0, 14.0, 33.0, 136.0, 0.0, 54.0, 72.0, 27.0, 91.0, 84.0, 3.0, 92.0, 14.0, 24.0, 51.0, 3.0, 37.0, 77.0, 164.0, 117.0, 9.0, 24.0, 20.0, 0.0, 0.0, 0.0, 88.0, 67.0, 33.0, 56.0, 1.0, 143.0, 194.0, 150.0, 65.0, 24.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5765571961659658, "mean_inference_ms": 1.3014735856306323, "mean_action_processing_ms": 0.22894516446906302, "mean_env_wait_ms": 0.17233736654364784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005133509635925293, "StateBufferConnector_ms": 0.0030785799026489258, "ViewRequirementAgentConnector_ms": 0.09774386882781982}, "num_episodes": 22, "episode_return_max": 390.0, "episode_return_min": -7.0, "episode_return_mean": 142.8, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.65411928384204, "num_env_steps_trained_throughput_per_sec": 88.65411928384204, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 1568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1568000, "timers": {"training_iteration_time_ms": 45418.17, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45418.127, "sample_time_ms": 1057.895, "learn_time_ms": 44344.376, "learn_throughput": 90.203, "synch_weights_time_ms": 13.84}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "done": false, "training_iteration": 98, "trial_id": "51025_00000", "date": "2024-08-12_21-38-29", "timestamp": 1723513109, "time_this_iter_s": 45.16210889816284, "time_total_s": 4460.187136650085, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1580db040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4460.187136650085, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 20.034375, "ram_util_percent": 80.996875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.19719379925854, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.368035022796146, "policy_loss": -0.012060127152184212, "vf_loss": 7.37766989551524, "vf_explained_var": -0.30893353403560697, "kl": 0.008084140975334015, "entropy": 1.0166311376940005, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.337643937585215, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.654719844444719, "policy_loss": -0.007885057736119186, "vf_loss": 6.662300393694923, "vf_explained_var": 0.24995503573821334, "kl": 0.0060900819205669055, "entropy": 0.7169406775759641, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 390.0, "episode_reward_min": -58.0, "episode_reward_mean": 141.15, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -200.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 200.0}, "policy_reward_mean": {"prey_policy": 10.99, "predator_policy": 59.585}, "custom_metrics": {}, "hist_stats": {"episode_reward": [178.0, 22.0, 98.0, 174.0, 118.0, 180.0, 23.0, 203.0, 235.0, 117.0, 78.0, 169.0, 340.0, 0.0, 168.0, 94.0, 1.0, 172.0, 220.0, 157.0, 57.0, 224.0, 170.0, 229.0, 63.0, 81.0, 155.0, 180.0, 108.0, 30.0, 250.0, 390.0, 199.0, 166.0, 100.0, 173.0, 281.0, 0.0, 260.0, 166.0, 232.0, 199.0, 265.0, 90.0, 234.0, 46.0, 147.0, 78.0, 96.0, 19.0, 119.0, 127.0, 51.0, 128.0, 117.0, 135.0, 182.0, 317.0, 289.0, 162.0, 190.0, 188.0, 0.0, 0.0, 107.0, 179.0, 35.0, 101.0, 205.0, 238.0, 100.0, 298.0, 102.0, 101.0, 154.0, 128.0, 0.0, 204.0, 203.0, 210.0, -7.0, 94.0, 218.0, 145.0, 193.0, 188.0, 132.0, 127.0, 115.0, -58.0, 181.0, 113.0, 208.0, 191.0, 103.0, 192.0, -26.0, 0.0, 68.0, 133.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [17.0, 96.0, 0.0, -119.0, -37.0, 0.0, -59.0, 26.0, 20.0, -11.0, 52.0, -41.0, 0.0, -39.0, 71.0, -18.0, 14.0, 80.0, 0.0, 84.0, 0.0, 9.0, 162.0, 0.0, 190.0, 54.0, -200.0, 0.0, 0.0, 91.0, 18.0, 0.0, -81.0, -15.0, -37.0, -32.0, -40.0, 183.0, 12.0, 0.0, -14.0, -82.0, 66.0, 14.0, 0.0, 137.0, 32.0, -25.0, 0.0, -42.0, -44.0, -36.0, 64.0, 0.0, 162.0, 0.0, 2.0, -100.0, -147.0, -164.0, 77.0, 47.0, 200.0, 190.0, 50.0, 77.0, -24.0, 60.0, 4.0, 0.0, 80.0, 0.0, 88.0, 132.0, 0.0, 0.0, 78.0, 55.0, -68.0, 28.0, -81.0, 170.0, 12.0, 30.0, 135.0, 111.0, -24.0, 0.0, -82.0, 176.0, -132.0, -34.0, 56.0, 0.0, -52.0, -45.0, -15.0, 0.0, -1.0, -17.0, -22.0, -5.0, 93.0, 0.0, -63.0, 0.0, 44.0, -73.0, -36.0, -72.0, 55.0, -158.0, 0.0, 166.0, 172.0, 86.0, 128.0, 137.0, 128.0, -11.0, 79.0, -24.0, 16.0, 88.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 110.0, -100.0, 0.0, -19.0, 2.0, 0.0, 18.0, 12.0, 152.0, -9.0, 62.0, 0.0, 118.0, 126.0, 0.0, -12.0, -80.0, -100.0, 0.0, 121.0, 108.0, 0.0, 0.0, 0.0, 11.0, 38.0, -32.0, 146.0, 150.0, -84.0, -161.0, -190.0, 5.0, 0.0, 64.0, -22.0, 0.0, 96.0, -87.0, 141.0, 116.0, -167.0, 44.0, -115.0, -133.0, -12.0, -19.0, 28.0, -103.0, -152.0, 135.0, -100.0, -16.0, -112.0, 153.0, -73.0, 61.0, 34.0, 0.0, 50.0, 118.0, -80.0, -108.0, -192.0, 0.0, 0.0, 33.0, -166.0, 0.0, 98.0], "policy_predator_policy_reward": [0.0, 65.0, 135.0, 6.0, 46.0, 89.0, 57.0, 150.0, 26.0, 83.0, 73.0, 96.0, 17.0, 45.0, 107.0, 43.0, 67.0, 74.0, 6.0, 27.0, 30.0, 39.0, 1.0, 6.0, 31.0, 65.0, 200.0, 0.0, 32.0, 45.0, 76.0, 0.0, 96.0, 1.0, 122.0, 119.0, 40.0, 37.0, 88.0, 57.0, 128.0, 25.0, 15.0, 129.0, 11.0, 22.0, 110.0, 112.0, 2.0, 103.0, 113.0, 48.0, 49.0, 42.0, 0.0, 18.0, 155.0, 51.0, 172.0, 169.0, 34.0, 92.0, 0.0, 0.0, 31.0, 41.0, 28.0, 102.0, 68.0, 28.0, 39.0, 54.0, 15.0, 46.0, 0.0, 0.0, 57.0, 70.0, 84.0, 122.0, 139.0, 4.0, 81.0, 76.0, 1.0, 18.0, 109.0, 5.0, 2.0, 138.0, 69.0, 143.0, 53.0, 38.0, 78.0, 97.0, 18.0, 93.0, 0.0, 37.0, 100.0, 46.0, 0.0, 34.0, 0.0, 114.0, 102.0, 55.0, 192.0, 33.0, 136.0, 102.0, 16.0, 0.0, 32.0, 27.0, 0.0, 24.0, 11.0, 34.0, 38.0, 97.0, 36.0, 48.0, 0.0, 0.0, 0.0, 0.0, 83.0, 14.0, 33.0, 136.0, 0.0, 54.0, 72.0, 27.0, 91.0, 84.0, 3.0, 92.0, 14.0, 24.0, 51.0, 3.0, 37.0, 77.0, 164.0, 117.0, 9.0, 24.0, 20.0, 0.0, 0.0, 0.0, 88.0, 67.0, 33.0, 56.0, 1.0, 143.0, 194.0, 150.0, 65.0, 24.0, 86.0, 90.0, 49.0, 0.0, 139.0, 0.0, 130.0, 109.0, 74.0, 129.0, 93.0, 179.0, 34.0, 72.0, 0.0, 197.0, 10.0, 136.0, 189.0, 52.0, 95.0, 33.0, 89.0, 7.0, 41.0, 12.0, 142.0, 12.0, 197.0, 77.0, 0.0, 0.0, 193.0, 8.0, 12.0, 23.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5763165025114679, "mean_inference_ms": 1.301694704860384, "mean_action_processing_ms": 0.22903957868704336, "mean_env_wait_ms": 0.1722734721982482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004413723945617676, "StateBufferConnector_ms": 0.0030711889266967773, "ViewRequirementAgentConnector_ms": 0.09844207763671875}, "num_episodes": 18, "episode_return_max": 390.0, "episode_return_min": -58.0, "episode_return_mean": 141.15, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.17421933486949, "num_env_steps_trained_throughput_per_sec": 88.17421933486949, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 45308.999, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45308.954, "sample_time_ms": 1059.535, "learn_time_ms": 44233.649, "learn_throughput": 90.429, "synch_weights_time_ms": 13.841}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 99, "trial_id": "51025_00000", "date": "2024-08-12_21-39-14", "timestamp": 1723513154, "time_this_iter_s": 45.398606061935425, "time_total_s": 4505.585742712021, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158b5b430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4505.585742712021, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 20.3625, "ram_util_percent": 80.021875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.693505798950397, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.00294717758421, "policy_loss": -0.011686276917459158, "vf_loss": 8.012188363958288, "vf_explained_var": -0.505207783173001, "kl": 0.008150323877347808, "entropy": 0.9862975253314569, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.714270333385972, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.206746580991796, "policy_loss": -0.009347454173411563, "vf_loss": 7.215709602265131, "vf_explained_var": 0.2581293665858173, "kl": 0.007688302379451784, "entropy": 0.761321952513286, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 390.0, "episode_reward_min": -125.0, "episode_reward_mean": 140.74, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -192.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 197.0}, "policy_reward_mean": {"prey_policy": 5.19, "predator_policy": 65.18}, "custom_metrics": {}, "hist_stats": {"episode_reward": [229.0, 63.0, 81.0, 155.0, 180.0, 108.0, 30.0, 250.0, 390.0, 199.0, 166.0, 100.0, 173.0, 281.0, 0.0, 260.0, 166.0, 232.0, 199.0, 265.0, 90.0, 234.0, 46.0, 147.0, 78.0, 96.0, 19.0, 119.0, 127.0, 51.0, 128.0, 117.0, 135.0, 182.0, 317.0, 289.0, 162.0, 190.0, 188.0, 0.0, 0.0, 107.0, 179.0, 35.0, 101.0, 205.0, 238.0, 100.0, 298.0, 102.0, 101.0, 154.0, 128.0, 0.0, 204.0, 203.0, 210.0, -7.0, 94.0, 218.0, 145.0, 193.0, 188.0, 132.0, 127.0, 115.0, -58.0, 181.0, 113.0, 208.0, 191.0, 103.0, 192.0, -26.0, 0.0, 68.0, 133.0, 284.0, 74.0, 129.0, 24.0, 190.0, 176.0, 84.0, 143.0, 216.0, 118.0, -125.0, 68.0, 117.0, 124.0, 90.0, 57.0, 140.0, 296.0, 151.0, 259.0, 191.0, 84.0, 267.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [32.0, -25.0, 0.0, -42.0, -44.0, -36.0, 64.0, 0.0, 162.0, 0.0, 2.0, -100.0, -147.0, -164.0, 77.0, 47.0, 200.0, 190.0, 50.0, 77.0, -24.0, 60.0, 4.0, 0.0, 80.0, 0.0, 88.0, 132.0, 0.0, 0.0, 78.0, 55.0, -68.0, 28.0, -81.0, 170.0, 12.0, 30.0, 135.0, 111.0, -24.0, 0.0, -82.0, 176.0, -132.0, -34.0, 56.0, 0.0, -52.0, -45.0, -15.0, 0.0, -1.0, -17.0, -22.0, -5.0, 93.0, 0.0, -63.0, 0.0, 44.0, -73.0, -36.0, -72.0, 55.0, -158.0, 0.0, 166.0, 172.0, 86.0, 128.0, 137.0, 128.0, -11.0, 79.0, -24.0, 16.0, 88.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 110.0, -100.0, 0.0, -19.0, 2.0, 0.0, 18.0, 12.0, 152.0, -9.0, 62.0, 0.0, 118.0, 126.0, 0.0, -12.0, -80.0, -100.0, 0.0, 121.0, 108.0, 0.0, 0.0, 0.0, 11.0, 38.0, -32.0, 146.0, 150.0, -84.0, -161.0, -190.0, 5.0, 0.0, 64.0, -22.0, 0.0, 96.0, -87.0, 141.0, 116.0, -167.0, 44.0, -115.0, -133.0, -12.0, -19.0, 28.0, -103.0, -152.0, 135.0, -100.0, -16.0, -112.0, 153.0, -73.0, 61.0, 34.0, 0.0, 50.0, 118.0, -80.0, -108.0, -192.0, 0.0, 0.0, 33.0, -166.0, 0.0, 98.0, 87.0, 124.0, -126.0, -25.0, -27.0, -57.0, -149.0, -104.0, 28.0, 52.0, 143.0, -159.0, -6.0, 23.0, 19.0, -22.0, 60.0, 44.0, -12.0, 12.0, -168.0, -171.0, -14.0, 0.0, -8.0, 2.0, -8.0, 8.0, -34.0, -6.0, -128.0, -87.0, -18.0, -38.0, 74.0, 136.0, -78.0, 72.0, 174.0, -56.0, -4.0, -8.0, -184.0, -64.0, 70.0, 44.0], "policy_predator_policy_reward": [110.0, 112.0, 2.0, 103.0, 113.0, 48.0, 49.0, 42.0, 0.0, 18.0, 155.0, 51.0, 172.0, 169.0, 34.0, 92.0, 0.0, 0.0, 31.0, 41.0, 28.0, 102.0, 68.0, 28.0, 39.0, 54.0, 15.0, 46.0, 0.0, 0.0, 57.0, 70.0, 84.0, 122.0, 139.0, 4.0, 81.0, 76.0, 1.0, 18.0, 109.0, 5.0, 2.0, 138.0, 69.0, 143.0, 53.0, 38.0, 78.0, 97.0, 18.0, 93.0, 0.0, 37.0, 100.0, 46.0, 0.0, 34.0, 0.0, 114.0, 102.0, 55.0, 192.0, 33.0, 136.0, 102.0, 16.0, 0.0, 32.0, 27.0, 0.0, 24.0, 11.0, 34.0, 38.0, 97.0, 36.0, 48.0, 0.0, 0.0, 0.0, 0.0, 83.0, 14.0, 33.0, 136.0, 0.0, 54.0, 72.0, 27.0, 91.0, 84.0, 3.0, 92.0, 14.0, 24.0, 51.0, 3.0, 37.0, 77.0, 164.0, 117.0, 9.0, 24.0, 20.0, 0.0, 0.0, 0.0, 88.0, 67.0, 33.0, 56.0, 1.0, 143.0, 194.0, 150.0, 65.0, 24.0, 86.0, 90.0, 49.0, 0.0, 139.0, 0.0, 130.0, 109.0, 74.0, 129.0, 93.0, 179.0, 34.0, 72.0, 0.0, 197.0, 10.0, 136.0, 189.0, 52.0, 95.0, 33.0, 89.0, 7.0, 41.0, 12.0, 142.0, 12.0, 197.0, 77.0, 0.0, 0.0, 193.0, 8.0, 12.0, 23.0, 38.0, 35.0, 149.0, 76.0, 79.0, 134.0, 95.0, 182.0, 43.0, 67.0, 5.0, 187.0, 0.0, 67.0, 48.0, 98.0, 19.0, 93.0, 18.0, 100.0, 31.0, 183.0, 31.0, 51.0, 41.0, 82.0, 48.0, 76.0, 80.0, 50.0, 106.0, 166.0, 145.0, 51.0, 31.0, 55.0, 130.0, 27.0, 13.0, 128.0, 106.0, 97.0, 136.0, 196.0, 73.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5762357836560765, "mean_inference_ms": 1.3009632809093645, "mean_action_processing_ms": 0.22882210203422176, "mean_env_wait_ms": 0.17220697199276322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033529996871948242, "StateBufferConnector_ms": 0.003026247024536133, "ViewRequirementAgentConnector_ms": 0.09196484088897705}, "num_episodes": 23, "episode_return_max": 390.0, "episode_return_min": -125.0, "episode_return_mean": 140.74, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 88.74293842329658, "num_env_steps_trained_throughput_per_sec": 88.74293842329658, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 45308.788, "restore_workers_time_ms": 0.013, "training_step_time_ms": 45308.742, "sample_time_ms": 1053.795, "learn_time_ms": 44239.207, "learn_throughput": 90.418, "synch_weights_time_ms": 13.78}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": true, "training_iteration": 100, "trial_id": "51025_00000", "date": "2024-08-12_21-39-59", "timestamp": 1723513199, "time_this_iter_s": 45.10696315765381, "time_total_s": 4550.692705869675, "pid": 99942, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x158bbf670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4550.692705869675, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 20.81875, "ram_util_percent": 79.91718750000001}}
