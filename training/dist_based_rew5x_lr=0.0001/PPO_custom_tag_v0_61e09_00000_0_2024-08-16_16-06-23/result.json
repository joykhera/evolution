{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1747278474468403, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.481387391418377, "policy_loss": -0.0065704955335056025, "vf_loss": 6.486265629813785, "vf_explained_var": -0.0014619943010743964, "kl": 0.00846124765754048, "entropy": 1.601075247734312, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9551199624147365, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.855193828148817, "policy_loss": -0.008662006414862517, "vf_loss": 6.862312632767612, "vf_explained_var": -0.0010838955798477092, "kl": 0.007715978338784086, "entropy": 1.6017500676806011, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 249.1099999999998, "episode_reward_min": 2.1099999999999968, "episode_reward_mean": 65.7645735662889, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 3600, "policy_reward_min": {"prey_policy": -321.58386780825504, "predator_policy": 3.853430757883432}, "policy_reward_max": {"prey_policy": 150.93481970473897, "predator_policy": 326.820959025744}, "policy_reward_mean": {"prey_policy": -88.61607365584526, "predator_policy": 121.49836043898975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [78.08999999999979, 47.0, 14.379999999999981, 2.1099999999999968, 60.48999999999993, 200.58228875954052, 95.55335951455254, 104.16196116745155, 51.58990093440226, 249.1099999999998, 92.85999999999984, 2.119999999999999, 2.694087317972107, 82.27000000000005, 59.781956483520034, 2.6699999999999893, 6.179999999999974, 32.11877001576178], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-103.5242418761921, -81.81003529581253, -42.98429543062066, 0.9072238993152485, -165.7023045811779, -292.5034025171278, -222.7149271137139, -135.31925762140315, -60.21783957606403, -50.89304985045738, 88.39996332575862, 0.24644109032492229, 14.645152672507, -148.68369329620603, -104.91730666925082, -241.93746976817272, -99.06745223599818, -180.06135038307474, 150.93481970473897, 44.896060884385754, -23.71601370457904, -75.50699551593367, -61.585306073112086, -321.58386780825504, -91.00046190037094, -65.94739571756995, -99.18090459190515, -33.22599373524084, 8.761098744617007, -136.24805180195654, -90.43480632713148, -124.11042643849008, -125.42071903151452, 3.3249136878179906, -316.59456968951275, -7.402187069051008], "policy_predator_policy_reward": [105.19424187619295, 158.23003529581266, 59.7421281976018, 29.334943333703606, 175.712304581177, 296.87340251712743, 223.68492711371306, 136.45925762140345, 71.68783957606388, 99.91304985045738, 3.853430757883432, 108.08245358557451, 27.036503546729847, 202.5553965915216, 259.288400850083, 191.72833675479112, 3.8977445277316987, 326.820959025744, 17.23518029526103, 36.0439391156141, 31.897322959445255, 160.1856862610677, 63.18530607311178, 322.10386780825456, 104.93150544235617, 54.71043949355795, 150.07090459190536, 64.60599373524057, 49.1112761914083, 138.15763334945106, 91.82480632713197, 125.39042643849073, 97.53686489481606, 30.7389404488811, 38.187784682607095, 317.92774209171824]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5107287521192738, "mean_inference_ms": 4.817351500980785, "mean_action_processing_ms": 0.6197269388261009, "mean_env_wait_ms": 0.6360559381066286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007040633095635308, "StateBufferConnector_ms": 0.003439188003540039, "ViewRequirementAgentConnector_ms": 0.3877209292517768}, "num_episodes": 18, "episode_return_max": 249.1099999999998, "episode_return_min": 2.1099999999999968, "episode_return_mean": 65.7645735662889, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 233.71230960412888, "num_env_steps_trained_throughput_per_sec": 233.71230960412888, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 17115.068, "restore_workers_time_ms": 0.018, "training_step_time_ms": 17115.009, "sample_time_ms": 3546.167, "learn_time_ms": 13544.342, "learn_throughput": 295.326, "synch_weights_time_ms": 12.593}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "61e09_00000", "date": "2024-08-16_16-06-51", "timestamp": 1723804611, "time_this_iter_s": 17.15475106239319, "time_total_s": 17.15475106239319, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b244bd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 17.15475106239319, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 81.376, "ram_util_percent": 82.868}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1285532933378977, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.042068543257536, "policy_loss": -0.01027694888900788, "vf_loss": 6.050031188429979, "vf_explained_var": -0.0007570871285029821, "kl": 0.011571403738612436, "entropy": 1.592627833318458, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1053345388363278, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.1087203149442315, "policy_loss": -0.01234394084272916, "vf_loss": 7.118835336947567, "vf_explained_var": 0.009025641156252099, "kl": 0.01114462313733832, "entropy": 1.5862013831340447, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 249.1099999999998, "episode_reward_min": -234.01781301357434, "episode_reward_mean": 60.18471504545187, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 7200, "policy_reward_min": {"prey_policy": -575.997855459317, "predator_policy": 3.853430757883432}, "policy_reward_max": {"prey_policy": 150.93481970473897, "predator_policy": 609.4289070677154}, "policy_reward_mean": {"prey_policy": -102.96225617669178, "predator_policy": 133.05461369941773}, "custom_metrics": {}, "hist_stats": {"episode_reward": [78.08999999999979, 47.0, 14.379999999999981, 2.1099999999999968, 60.48999999999993, 200.58228875954052, 95.55335951455254, 104.16196116745155, 51.58990093440226, 249.1099999999998, 92.85999999999984, 2.119999999999999, 2.694087317972107, 82.27000000000005, 59.781956483520034, 2.6699999999999893, 6.179999999999974, 32.11877001576178, 101.87118801125378, -234.01781301357434, -22.783779866597264, 52.44513272292032, 1.929999999999997, 60.156228686260754, 17.9208782371109, 164.2218886247016, 85.56922133978246, 3.501411222170618, 102.3131617225637, 3.129999999999974, 205.28635933896834, 191.57810156228808, -13.244561144781638, 60.549999999999834, 1.849999999999999, 200.61], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-103.5242418761921, -81.81003529581253, -42.98429543062066, 0.9072238993152485, -165.7023045811779, -292.5034025171278, -222.7149271137139, -135.31925762140315, -60.21783957606403, -50.89304985045738, 88.39996332575862, 0.24644109032492229, 14.645152672507, -148.68369329620603, -104.91730666925082, -241.93746976817272, -99.06745223599818, -180.06135038307474, 150.93481970473897, 44.896060884385754, -23.71601370457904, -75.50699551593367, -61.585306073112086, -321.58386780825504, -91.00046190037094, -65.94739571756995, -99.18090459190515, -33.22599373524084, 8.761098744617007, -136.24805180195654, -90.43480632713148, -124.11042643849008, -125.42071903151452, 3.3249136878179906, -316.59456968951275, -7.402187069051008, 59.07809974566553, -337.7105694346598, -371.72090922723044, -575.997855459317, -55.09450155850011, -95.07562678839179, -275.5652700744161, -201.22947249747605, -298.9501173479944, -42.6366824516197, 10.325568587277072, -22.129984477022127, -109.66286191476694, -9.690776252283467, -41.69860655906872, -2.1230502868104963, -59.761498738314245, -76.15429948873317, -52.234776689883795, -270.361152989875, -128.59600380202846, 75.06087009092542, -86.12782235763152, -100.23229717545213, -206.00901031573468, 43.95820762430526, -11.963073555859925, 5.286340664813162, -125.7966061770731, -72.66947715664905, 31.610498793604663, -351.663072864699, -271.73894509180104, -173.94034252022163, 135.21731343215976, -157.10602879661533], "policy_predator_policy_reward": [105.19424187619295, 158.23003529581266, 59.7421281976018, 29.334943333703606, 175.712304581177, 296.87340251712743, 223.68492711371306, 136.45925762140345, 71.68783957606388, 99.91304985045738, 3.853430757883432, 108.08245358557451, 27.036503546729847, 202.5553965915216, 259.288400850083, 191.72833675479112, 3.8977445277316987, 326.820959025744, 17.23518029526103, 36.0439391156141, 31.897322959445255, 160.1856862610677, 63.18530607311178, 322.10386780825456, 104.93150544235617, 54.71043949355795, 150.07090459190536, 64.60599373524057, 49.1112761914083, 138.15763334945106, 91.82480632713197, 125.39042643849073, 97.53686489481606, 30.7389404488811, 38.187784682607095, 317.92774209171824, 58.0025919215457, 322.50106577870207, 104.27204460525753, 609.4289070677154, 10.026084220710215, 117.36026425958427, 238.8054572495079, 290.4344180453044, 299.23011734799417, 44.28668245161937, 35.7942470206064, 36.166397555399875, 12.723092550330243, 124.55142385383107, 124.53513248589239, 83.50841298468859, 85.01892012221253, 136.46609944461767, 287.5576198450263, 38.53972105690226, 126.70693807526541, 29.14135735840113, 87.78782235763236, 101.7022971754521, 183.32313496237808, 184.01402706801966, 120.66854914286539, 77.58628531046989, 156.80290374319264, 28.418618445748987, 27.569501206395465, 353.0330728646987, 272.62894509180023, 174.90034252022093, 14.152686567840242, 208.34602879661537]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3655711309704635, "mean_inference_ms": 4.223635334264295, "mean_action_processing_ms": 0.5491989311112889, "mean_env_wait_ms": 0.553665440730047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00645087824927436, "StateBufferConnector_ms": 0.010260277324252658, "ViewRequirementAgentConnector_ms": 0.24095839924282497}, "num_episodes": 18, "episode_return_max": 249.1099999999998, "episode_return_min": -234.01781301357434, "episode_return_mean": 60.18471504545187, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 327.4220016946022, "num_env_steps_trained_throughput_per_sec": 327.4220016946022, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 14665.966, "restore_workers_time_ms": 0.189, "training_step_time_ms": 14665.555, "sample_time_ms": 2718.136, "learn_time_ms": 11927.595, "learn_throughput": 335.357, "synch_weights_time_ms": 12.547}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "61e09_00000", "date": "2024-08-16_16-07-06", "timestamp": 1723804626, "time_this_iter_s": 12.265699863433838, "time_total_s": 29.420450925827026, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24d3280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29.420450925827026, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 61.713636363636375, "ram_util_percent": 83.0090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2781860510350536, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.9508876025992095, "policy_loss": -0.008703973516082717, "vf_loss": 4.95746647151059, "vf_explained_var": -9.337190597776382e-05, "kl": 0.010625487672604112, "entropy": 1.5897821093993212, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2924704001378762, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.15516102957347, "policy_loss": -0.01371528294242958, "vf_loss": 6.166590656300701, "vf_explained_var": 0.004853259854846531, "kl": 0.011428264180156585, "entropy": 1.5717403281933415, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 249.1099999999998, "episode_reward_min": -234.01781301357434, "episode_reward_mean": 63.21981019680697, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 10800, "policy_reward_min": {"prey_policy": -575.997855459317, "predator_policy": 3.5974056992524917}, "policy_reward_max": {"prey_policy": 154.17585322328014, "predator_policy": 609.4289070677154}, "policy_reward_mean": {"prey_policy": -92.8926031720669, "predator_policy": 124.50250827047039}, "custom_metrics": {}, "hist_stats": {"episode_reward": [78.08999999999979, 47.0, 14.379999999999981, 2.1099999999999968, 60.48999999999993, 200.58228875954052, 95.55335951455254, 104.16196116745155, 51.58990093440226, 249.1099999999998, 92.85999999999984, 2.119999999999999, 2.694087317972107, 82.27000000000005, 59.781956483520034, 2.6699999999999893, 6.179999999999974, 32.11877001576178, 101.87118801125378, -234.01781301357434, -22.783779866597264, 52.44513272292032, 1.929999999999997, 60.156228686260754, 17.9208782371109, 164.2218886247016, 85.56922133978246, 3.501411222170618, 102.3131617225637, 3.129999999999974, 205.28635933896834, 191.57810156228808, -13.244561144781638, 60.549999999999834, 1.849999999999999, 200.61, 9.092206653800002, 195.41999999999985, 90.44121045403404, 51.96999999999979, 3.519999999999969, 54.634320499730315, 30.990000000000126, 145.32999999999907, 213.8486004150227, 88.88000000000004, 20.618777062900993, 102.66469417481798, 30.760000000000016, 87.5500000000001, 33.74999999999997, 3.5299999999999683, 9.299999999999955, 74.92019973100328], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-103.5242418761921, -81.81003529581253, -42.98429543062066, 0.9072238993152485, -165.7023045811779, -292.5034025171278, -222.7149271137139, -135.31925762140315, -60.21783957606403, -50.89304985045738, 88.39996332575862, 0.24644109032492229, 14.645152672507, -148.68369329620603, -104.91730666925082, -241.93746976817272, -99.06745223599818, -180.06135038307474, 150.93481970473897, 44.896060884385754, -23.71601370457904, -75.50699551593367, -61.585306073112086, -321.58386780825504, -91.00046190037094, -65.94739571756995, -99.18090459190515, -33.22599373524084, 8.761098744617007, -136.24805180195654, -90.43480632713148, -124.11042643849008, -125.42071903151452, 3.3249136878179906, -316.59456968951275, -7.402187069051008, 59.07809974566553, -337.7105694346598, -371.72090922723044, -575.997855459317, -55.09450155850011, -95.07562678839179, -275.5652700744161, -201.22947249747605, -298.9501173479944, -42.6366824516197, 10.325568587277072, -22.129984477022127, -109.66286191476694, -9.690776252283467, -41.69860655906872, -2.1230502868104963, -59.761498738314245, -76.15429948873317, -52.234776689883795, -270.361152989875, -128.59600380202846, 75.06087009092542, -86.12782235763152, -100.23229717545213, -206.00901031573468, 43.95820762430526, -11.963073555859925, 5.286340664813162, -125.7966061770731, -72.66947715664905, 31.610498793604663, -351.663072864699, -271.73894509180104, -173.94034252022163, 135.21731343215976, -157.10602879661533, -66.29201894317765, -326.3576850556221, -32.16092082825571, 154.17585322328014, 9.015821120963947, -202.26636869468612, -86.74743775505847, -96.8862057062761, -61.90114009406941, -6.182421050538297, -105.6469683881934, -143.96274806917276, -19.785648124092088, -338.4744560534311, 88.57290685292064, 29.91310124375922, 37.036842470097, 108.97591930505638, 23.60138891768446, -93.71490227243105, -25.355742469206042, -45.93676294212788, -18.499589027070535, 73.21457893072595, -52.496175730780436, -92.96681574249052, -53.54213623514823, -201.81076287310873, -278.26428379187325, -56.24904033635941, -65.73050401030686, -1.637405699252519, -180.47232132381936, -178.24347007267372, -320.89775856199736, 8.856579925314604], "policy_predator_policy_reward": [105.19424187619295, 158.23003529581266, 59.7421281976018, 29.334943333703606, 175.712304581177, 296.87340251712743, 223.68492711371306, 136.45925762140345, 71.68783957606388, 99.91304985045738, 3.853430757883432, 108.08245358557451, 27.036503546729847, 202.5553965915216, 259.288400850083, 191.72833675479112, 3.8977445277316987, 326.820959025744, 17.23518029526103, 36.0439391156141, 31.897322959445255, 160.1856862610677, 63.18530607311178, 322.10386780825456, 104.93150544235617, 54.71043949355795, 150.07090459190536, 64.60599373524057, 49.1112761914083, 138.15763334945106, 91.82480632713197, 125.39042643849073, 97.53686489481606, 30.7389404488811, 38.187784682607095, 317.92774209171824, 58.0025919215457, 322.50106577870207, 104.27204460525753, 609.4289070677154, 10.026084220710215, 117.36026425958427, 238.8054572495079, 290.4344180453044, 299.23011734799417, 44.28668245161937, 35.7942470206064, 36.166397555399875, 12.723092550330243, 124.55142385383107, 124.53513248589239, 83.50841298468859, 85.01892012221253, 136.46609944461767, 287.5576198450263, 38.53972105690226, 126.70693807526541, 29.14135735840113, 87.78782235763236, 101.7022971754521, 183.32313496237808, 184.01402706801966, 120.66854914286539, 77.58628531046989, 156.80290374319264, 28.418618445748987, 27.569501206395465, 353.0330728646987, 272.62894509180023, 174.90034252022093, 14.152686567840242, 208.34602879661537, 8.527970480264635, 393.2139401723359, 18.55461023209419, 54.85045737288138, 89.66777283894407, 194.0239851888108, 117.47743775505879, 118.12620570627617, 63.471140094069234, 8.132421050538255, 148.2495733300447, 155.99446362705214, 49.15564812409197, 340.0944560534306, 15.237093147079698, 11.60689875624102, 13.941188864224966, 53.89464977564585, 64.00861108231543, 94.98490227243165, 42.9444293988454, 48.966853075389245, 32.634532530107116, 15.315171741055444, 66.86583815747203, 109.35715331579979, 139.97213623514838, 202.93076287310777, 279.91428379187295, 88.34904033635937, 67.30050401030742, 3.5974056992524917, 187.78232132381828, 180.2334700726732, 161.50933210163944, 225.45204626604536]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3024807953709374, "mean_inference_ms": 3.888950554644862, "mean_action_processing_ms": 0.5182394941850352, "mean_env_wait_ms": 0.509792170780048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006582118846752026, "StateBufferConnector_ms": 0.007869579173900463, "ViewRequirementAgentConnector_ms": 0.25054591673391835}, "num_episodes": 18, "episode_return_max": 249.1099999999998, "episode_return_min": -234.01781301357434, "episode_return_mean": 63.21981019680697, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.1044381885527, "num_env_steps_trained_throughput_per_sec": 288.1044381885527, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 14405.266, "restore_workers_time_ms": 0.131, "training_step_time_ms": 14404.975, "sample_time_ms": 2564.12, "learn_time_ms": 11822.542, "learn_throughput": 338.337, "synch_weights_time_ms": 13.0}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "61e09_00000", "date": "2024-08-16_16-07-20", "timestamp": 1723804640, "time_this_iter_s": 13.941422939300537, "time_total_s": 43.36187386512756, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24d31f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 43.36187386512756, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 65.56499999999998, "ram_util_percent": 82.84}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1716914727416619, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.433712722637035, "policy_loss": -0.011129566544676742, "vf_loss": 5.442751978187965, "vf_explained_var": 0.006333616202470487, "kl": 0.01045153420540323, "entropy": 1.5806889812782328, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4195828357701579, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.927970400310698, "policy_loss": -0.010599428084038355, "vf_loss": 6.936553324341143, "vf_explained_var": 0.03289855888911656, "kl": 0.0100825493692701, "entropy": 1.553504569000668, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 278.8199999999995, "episode_reward_min": -234.01781301357434, "episode_reward_mean": 67.62612032013259, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -575.997855459317, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 154.17585322328014, "predator_policy": 609.4289070677154}, "policy_reward_mean": {"prey_policy": -82.77254306253361, "predator_policy": 116.5856032225999}, "custom_metrics": {}, "hist_stats": {"episode_reward": [78.08999999999979, 47.0, 14.379999999999981, 2.1099999999999968, 60.48999999999993, 200.58228875954052, 95.55335951455254, 104.16196116745155, 51.58990093440226, 249.1099999999998, 92.85999999999984, 2.119999999999999, 2.694087317972107, 82.27000000000005, 59.781956483520034, 2.6699999999999893, 6.179999999999974, 32.11877001576178, 101.87118801125378, -234.01781301357434, -22.783779866597264, 52.44513272292032, 1.929999999999997, 60.156228686260754, 17.9208782371109, 164.2218886247016, 85.56922133978246, 3.501411222170618, 102.3131617225637, 3.129999999999974, 205.28635933896834, 191.57810156228808, -13.244561144781638, 60.549999999999834, 1.849999999999999, 200.61, 9.092206653800002, 195.41999999999985, 90.44121045403404, 51.96999999999979, 3.519999999999969, 54.634320499730315, 30.990000000000126, 145.32999999999907, 213.8486004150227, 88.88000000000004, 20.618777062900993, 102.66469417481798, 30.760000000000016, 87.5500000000001, 33.74999999999997, 3.5299999999999683, 9.299999999999955, 74.92019973100328, 6.549999999999969, 40.89999999999942, 94.31000000000024, 104.51917107504774, 102.10000000000043, 14.201323296144384, 0.4644315649566231, 278.8199999999995, 2.3507484930434024, 77.99000000000065, 29.495883848654387, 18.250000000000288, 50.56999999999996, 121.21714110785446, 33.14000000000002, 148.95000000000033, 192.9099999999998, 138.47221303626975], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-103.5242418761921, -81.81003529581253, -42.98429543062066, 0.9072238993152485, -165.7023045811779, -292.5034025171278, -222.7149271137139, -135.31925762140315, -60.21783957606403, -50.89304985045738, 88.39996332575862, 0.24644109032492229, 14.645152672507, -148.68369329620603, -104.91730666925082, -241.93746976817272, -99.06745223599818, -180.06135038307474, 150.93481970473897, 44.896060884385754, -23.71601370457904, -75.50699551593367, -61.585306073112086, -321.58386780825504, -91.00046190037094, -65.94739571756995, -99.18090459190515, -33.22599373524084, 8.761098744617007, -136.24805180195654, -90.43480632713148, -124.11042643849008, -125.42071903151452, 3.3249136878179906, -316.59456968951275, -7.402187069051008, 59.07809974566553, -337.7105694346598, -371.72090922723044, -575.997855459317, -55.09450155850011, -95.07562678839179, -275.5652700744161, -201.22947249747605, -298.9501173479944, -42.6366824516197, 10.325568587277072, -22.129984477022127, -109.66286191476694, -9.690776252283467, -41.69860655906872, -2.1230502868104963, -59.761498738314245, -76.15429948873317, -52.234776689883795, -270.361152989875, -128.59600380202846, 75.06087009092542, -86.12782235763152, -100.23229717545213, -206.00901031573468, 43.95820762430526, -11.963073555859925, 5.286340664813162, -125.7966061770731, -72.66947715664905, 31.610498793604663, -351.663072864699, -271.73894509180104, -173.94034252022163, 135.21731343215976, -157.10602879661533, -66.29201894317765, -326.3576850556221, -32.16092082825571, 154.17585322328014, 9.015821120963947, -202.26636869468612, -86.74743775505847, -96.8862057062761, -61.90114009406941, -6.182421050538297, -105.6469683881934, -143.96274806917276, -19.785648124092088, -338.4744560534311, 88.57290685292064, 29.91310124375922, 37.036842470097, 108.97591930505638, 23.60138891768446, -93.71490227243105, -25.355742469206042, -45.93676294212788, -18.499589027070535, 73.21457893072595, -52.496175730780436, -92.96681574249052, -53.54213623514823, -201.81076287310873, -278.26428379187325, -56.24904033635941, -65.73050401030686, -1.637405699252519, -180.47232132381936, -178.24347007267372, -320.89775856199736, 8.856579925314604, -13.993347469265133, -28.286211395987092, 29.011350326207822, -180.90608963041075, 9.77824972831864, -24.792816134493044, -20.572926024990366, -19.762965469762417, -69.42967990788091, -25.133791218918695, -33.4077812458683, -16.646472300518287, -258.051491136863, -172.09582815613894, 39.871778118861506, 136.52564933504834, -9.071584531559534, 0.47074849304341, -26.412690446102527, -142.60745156368498, -185.41963699270596, -13.81494548199328, -18.76607963183233, -45.08602758457313, 48.26559742983428, -497.623463132112, -145.9503340417118, -83.82332127766912, -130.10457032559907, -102.10688704037953, 8.355547062019976, 37.45378439248259, 131.67383498549685, 36.649999999999935, 71.44118010034636, -172.4763862522552], "policy_predator_policy_reward": [105.19424187619295, 158.23003529581266, 59.7421281976018, 29.334943333703606, 175.712304581177, 296.87340251712743, 223.68492711371306, 136.45925762140345, 71.68783957606388, 99.91304985045738, 3.853430757883432, 108.08245358557451, 27.036503546729847, 202.5553965915216, 259.288400850083, 191.72833675479112, 3.8977445277316987, 326.820959025744, 17.23518029526103, 36.0439391156141, 31.897322959445255, 160.1856862610677, 63.18530607311178, 322.10386780825456, 104.93150544235617, 54.71043949355795, 150.07090459190536, 64.60599373524057, 49.1112761914083, 138.15763334945106, 91.82480632713197, 125.39042643849073, 97.53686489481606, 30.7389404488811, 38.187784682607095, 317.92774209171824, 58.0025919215457, 322.50106577870207, 104.27204460525753, 609.4289070677154, 10.026084220710215, 117.36026425958427, 238.8054572495079, 290.4344180453044, 299.23011734799417, 44.28668245161937, 35.7942470206064, 36.166397555399875, 12.723092550330243, 124.55142385383107, 124.53513248589239, 83.50841298468859, 85.01892012221253, 136.46609944461767, 287.5576198450263, 38.53972105690226, 126.70693807526541, 29.14135735840113, 87.78782235763236, 101.7022971754521, 183.32313496237808, 184.01402706801966, 120.66854914286539, 77.58628531046989, 156.80290374319264, 28.418618445748987, 27.569501206395465, 353.0330728646987, 272.62894509180023, 174.90034252022093, 14.152686567840242, 208.34602879661537, 8.527970480264635, 393.2139401723359, 18.55461023209419, 54.85045737288138, 89.66777283894407, 194.0239851888108, 117.47743775505879, 118.12620570627617, 63.471140094069234, 8.132421050538255, 148.2495733300447, 155.99446362705214, 49.15564812409197, 340.0944560534306, 15.237093147079698, 11.60689875624102, 13.941188864224966, 53.89464977564585, 64.00861108231543, 94.98490227243165, 42.9444293988454, 48.966853075389245, 32.634532530107116, 15.315171741055444, 66.86583815747203, 109.35715331579979, 139.97213623514838, 202.93076287310777, 279.91428379187295, 88.34904033635937, 67.30050401030742, 3.5974056992524917, 187.78232132381828, 180.2334700726732, 161.50933210163944, 225.45204626604536, 27.710053601291406, 21.119505263961045, 10.518649673792417, 182.2760896304099, 51.42638837454577, 57.89817803162891, 24.059166738912783, 120.79589583088737, 188.40925394411556, 8.254217182684327, 7.2568519868132775, 56.998724855718024, 323.6244761025639, 106.98727475539417, 85.7183909193891, 16.704181626701107, 0.0, 10.951584531559494, 28.18269044610278, 218.82745156368486, 61.87017641190359, 166.86028991144855, 21.372705778066496, 60.72940143833881, 2.2244025701656875, 497.703463132112, 123.25611897685965, 227.73467745037527, 101.74490061853896, 163.60655674743973, 101.97445293798003, 1.166215607517408, 24.5861650145031, 0.0, 87.37528617813616, 152.1321330100423]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.239388488701478, "mean_inference_ms": 3.6272501537411284, "mean_action_processing_ms": 0.49118237518404306, "mean_env_wait_ms": 0.47521908420085546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006770756509568956, "StateBufferConnector_ms": 0.0066492292616102434, "ViewRequirementAgentConnector_ms": 0.2324662274784512}, "num_episodes": 18, "episode_return_max": 278.8199999999995, "episode_return_min": -234.01781301357434, "episode_return_mean": 67.62612032013259, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.45499250479713, "num_env_steps_trained_throughput_per_sec": 299.45499250479713, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 14143.353, "restore_workers_time_ms": 0.102, "training_step_time_ms": 14143.057, "sample_time_ms": 2265.18, "learn_time_ms": 11860.616, "learn_throughput": 337.251, "synch_weights_time_ms": 12.986}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "61e09_00000", "date": "2024-08-16_16-07-34", "timestamp": 1723804654, "time_this_iter_s": 13.413441896438599, "time_total_s": 56.77531576156616, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b25345e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 56.77531576156616, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 66.40526315789472, "ram_util_percent": 82.42105263157896}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2510284478702243, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.1806416004423115, "policy_loss": -0.010795495527298757, "vf_loss": 4.189270858411436, "vf_explained_var": 0.004548981328489919, "kl": 0.01083114789542214, "entropy": 1.5663410998526073, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7050091154045528, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.12228094787194, "policy_loss": -0.012471431122462033, "vf_loss": 6.1322723444176725, "vf_explained_var": 0.05836309450013297, "kl": 0.012400253177179726, "entropy": 1.5268099777912967, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 278.8199999999995, "episode_reward_min": -234.01781301357434, "episode_reward_mean": 73.55750775237712, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 19800, "policy_reward_min": {"prey_policy": -575.997855459317, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 154.17585322328014, "predator_policy": 609.4289070677154}, "policy_reward_mean": {"prey_policy": -71.37822220743844, "predator_policy": 108.156976083627}, "custom_metrics": {}, "hist_stats": {"episode_reward": [78.08999999999979, 47.0, 14.379999999999981, 2.1099999999999968, 60.48999999999993, 200.58228875954052, 95.55335951455254, 104.16196116745155, 51.58990093440226, 249.1099999999998, 92.85999999999984, 2.119999999999999, 2.694087317972107, 82.27000000000005, 59.781956483520034, 2.6699999999999893, 6.179999999999974, 32.11877001576178, 101.87118801125378, -234.01781301357434, -22.783779866597264, 52.44513272292032, 1.929999999999997, 60.156228686260754, 17.9208782371109, 164.2218886247016, 85.56922133978246, 3.501411222170618, 102.3131617225637, 3.129999999999974, 205.28635933896834, 191.57810156228808, -13.244561144781638, 60.549999999999834, 1.849999999999999, 200.61, 9.092206653800002, 195.41999999999985, 90.44121045403404, 51.96999999999979, 3.519999999999969, 54.634320499730315, 30.990000000000126, 145.32999999999907, 213.8486004150227, 88.88000000000004, 20.618777062900993, 102.66469417481798, 30.760000000000016, 87.5500000000001, 33.74999999999997, 3.5299999999999683, 9.299999999999955, 74.92019973100328, 6.549999999999969, 40.89999999999942, 94.31000000000024, 104.51917107504774, 102.10000000000043, 14.201323296144384, 0.4644315649566231, 278.8199999999995, 2.3507484930434024, 77.99000000000065, 29.495883848654387, 18.250000000000288, 50.56999999999996, 121.21714110785446, 33.14000000000002, 148.95000000000033, 192.9099999999998, 138.47221303626975, 54.8210768401524, 45.16268603828341, 35.10897190268536, 120.42000000000039, -0.3608310408918465, 189.42999999999995, 4.039999999999978, 161.20999999999998, 142.44000000000057, 112.6900000000002, 62.0629780378541, 135.30840219942417, 79.95999999999997, 84.62000000000025, 101.78699373345347, 114.10823279427085, 38.63000000000026, 253.899594264613, 97.75000000000021, 10.569999999999924, 165.52199625401414, 165.83999999999992, 54.08336451036052, 87.84943183335761, 22.356751872021036, 70.12295519618773, 3.6799999999999646], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-103.5242418761921, -81.81003529581253, -42.98429543062066, 0.9072238993152485, -165.7023045811779, -292.5034025171278, -222.7149271137139, -135.31925762140315, -60.21783957606403, -50.89304985045738, 88.39996332575862, 0.24644109032492229, 14.645152672507, -148.68369329620603, -104.91730666925082, -241.93746976817272, -99.06745223599818, -180.06135038307474, 150.93481970473897, 44.896060884385754, -23.71601370457904, -75.50699551593367, -61.585306073112086, -321.58386780825504, -91.00046190037094, -65.94739571756995, -99.18090459190515, -33.22599373524084, 8.761098744617007, -136.24805180195654, -90.43480632713148, -124.11042643849008, -125.42071903151452, 3.3249136878179906, -316.59456968951275, -7.402187069051008, 59.07809974566553, -337.7105694346598, -371.72090922723044, -575.997855459317, -55.09450155850011, -95.07562678839179, -275.5652700744161, -201.22947249747605, -298.9501173479944, -42.6366824516197, 10.325568587277072, -22.129984477022127, -109.66286191476694, -9.690776252283467, -41.69860655906872, -2.1230502868104963, -59.761498738314245, -76.15429948873317, -52.234776689883795, -270.361152989875, -128.59600380202846, 75.06087009092542, -86.12782235763152, -100.23229717545213, -206.00901031573468, 43.95820762430526, -11.963073555859925, 5.286340664813162, -125.7966061770731, -72.66947715664905, 31.610498793604663, -351.663072864699, -271.73894509180104, -173.94034252022163, 135.21731343215976, -157.10602879661533, -66.29201894317765, -326.3576850556221, -32.16092082825571, 154.17585322328014, 9.015821120963947, -202.26636869468612, -86.74743775505847, -96.8862057062761, -61.90114009406941, -6.182421050538297, -105.6469683881934, -143.96274806917276, -19.785648124092088, -338.4744560534311, 88.57290685292064, 29.91310124375922, 37.036842470097, 108.97591930505638, 23.60138891768446, -93.71490227243105, -25.355742469206042, -45.93676294212788, -18.499589027070535, 73.21457893072595, -52.496175730780436, -92.96681574249052, -53.54213623514823, -201.81076287310873, -278.26428379187325, -56.24904033635941, -65.73050401030686, -1.637405699252519, -180.47232132381936, -178.24347007267372, -320.89775856199736, 8.856579925314604, -13.993347469265133, -28.286211395987092, 29.011350326207822, -180.90608963041075, 9.77824972831864, -24.792816134493044, -20.572926024990366, -19.762965469762417, -69.42967990788091, -25.133791218918695, -33.4077812458683, -16.646472300518287, -258.051491136863, -172.09582815613894, 39.871778118861506, 136.52564933504834, -9.071584531559534, 0.47074849304341, -26.412690446102527, -142.60745156368498, -185.41963699270596, -13.81494548199328, -18.76607963183233, -45.08602758457313, 48.26559742983428, -497.623463132112, -145.9503340417118, -83.82332127766912, -130.10457032559907, -102.10688704037953, 8.355547062019976, 37.45378439248259, 131.67383498549685, 36.649999999999935, 71.44118010034636, -172.4763862522552, -40.078654309443436, -234.99109101476157, -28.45446592916728, -56.37436460017381, -81.55055909574631, -143.75882827595106, 80.8232961216641, -13.549665598881454, -18.03296531587482, -59.84357705572482, 17.875435122787863, -190.14760233741964, -173.47409901902927, 0.3010178113822048, -1.3897552944757066, 141.60556803000438, -1.8333320812717788, 124.67786047214985, 0.7636182303681213, 83.92519718561473, -158.27384305111065, -86.11429226032897, -8.900158391086002, 69.05711262863677, -75.09143285832072, -66.9058065989403, -42.17957578627204, -75.20588718916308, -48.023626510757744, -53.61159029001895, 63.05070235274745, -288.52446274867225, -126.42898083744066, -0.890952995186366, 69.77504926756339, 77.3180242128474, -111.97636690506067, -18.01820031163278, -13.22072277248694, -32.566862874638666, -23.99598899027316, 26.897729484113878, 121.14530030559497, -23.77601902057216, -156.61606973734646, -15.58550956249178, -80.30190170039528, -28.9831682973387, -119.24391105323451, -159.2455809971355, 61.07073508620812, -243.93283353200835, -43.84790095191084, -6.987836227912048], "policy_predator_policy_reward": [105.19424187619295, 158.23003529581266, 59.7421281976018, 29.334943333703606, 175.712304581177, 296.87340251712743, 223.68492711371306, 136.45925762140345, 71.68783957606388, 99.91304985045738, 3.853430757883432, 108.08245358557451, 27.036503546729847, 202.5553965915216, 259.288400850083, 191.72833675479112, 3.8977445277316987, 326.820959025744, 17.23518029526103, 36.0439391156141, 31.897322959445255, 160.1856862610677, 63.18530607311178, 322.10386780825456, 104.93150544235617, 54.71043949355795, 150.07090459190536, 64.60599373524057, 49.1112761914083, 138.15763334945106, 91.82480632713197, 125.39042643849073, 97.53686489481606, 30.7389404488811, 38.187784682607095, 317.92774209171824, 58.0025919215457, 322.50106577870207, 104.27204460525753, 609.4289070677154, 10.026084220710215, 117.36026425958427, 238.8054572495079, 290.4344180453044, 299.23011734799417, 44.28668245161937, 35.7942470206064, 36.166397555399875, 12.723092550330243, 124.55142385383107, 124.53513248589239, 83.50841298468859, 85.01892012221253, 136.46609944461767, 287.5576198450263, 38.53972105690226, 126.70693807526541, 29.14135735840113, 87.78782235763236, 101.7022971754521, 183.32313496237808, 184.01402706801966, 120.66854914286539, 77.58628531046989, 156.80290374319264, 28.418618445748987, 27.569501206395465, 353.0330728646987, 272.62894509180023, 174.90034252022093, 14.152686567840242, 208.34602879661537, 8.527970480264635, 393.2139401723359, 18.55461023209419, 54.85045737288138, 89.66777283894407, 194.0239851888108, 117.47743775505879, 118.12620570627617, 63.471140094069234, 8.132421050538255, 148.2495733300447, 155.99446362705214, 49.15564812409197, 340.0944560534306, 15.237093147079698, 11.60689875624102, 13.941188864224966, 53.89464977564585, 64.00861108231543, 94.98490227243165, 42.9444293988454, 48.966853075389245, 32.634532530107116, 15.315171741055444, 66.86583815747203, 109.35715331579979, 139.97213623514838, 202.93076287310777, 279.91428379187295, 88.34904033635937, 67.30050401030742, 3.5974056992524917, 187.78232132381828, 180.2334700726732, 161.50933210163944, 225.45204626604536, 27.710053601291406, 21.119505263961045, 10.518649673792417, 182.2760896304099, 51.42638837454577, 57.89817803162891, 24.059166738912783, 120.79589583088737, 188.40925394411556, 8.254217182684327, 7.2568519868132775, 56.998724855718024, 323.6244761025639, 106.98727475539417, 85.7183909193891, 16.704181626701107, 0.0, 10.951584531559494, 28.18269044610278, 218.82745156368486, 61.87017641190359, 166.86028991144855, 21.372705778066496, 60.72940143833881, 2.2244025701656875, 497.703463132112, 123.25611897685965, 227.73467745037527, 101.74490061853896, 163.60655674743973, 101.97445293798003, 1.166215607517408, 24.5861650145031, 0.0, 87.37528617813616, 152.1321330100423, 188.44218057067792, 141.44864159367913, 103.22523878341515, 26.766277784209805, 164.35506515692646, 96.06329411745658, 37.696703878335896, 15.449665598881413, 4.080583120168974, 73.43512821053882, 192.49621543660555, 169.2059517780261, 80.11450475839376, 97.09857644925322, 3.3597552944756783, 17.63443196999565, 3.793332081271741, 15.802139527850386, 1.2263817696318802, 26.774802814385268, 58.62587747109764, 247.82523587819676, 45.84262779898942, 29.30882016288401, 153.5114328583207, 68.4458065989403, 125.37957578627196, 76.6258871891636, 124.35889277026426, 79.06331776396584, 281.84253326475675, 57.73945992543843, 147.32898083744107, 18.62095299518637, 18.4924258587447, 88.31409492545816, 113.30636690506115, 114.43820031163285, 22.020722772486902, 34.336862874638314, 82.93946235356303, 79.68079340661092, 41.309668898749635, 27.161049816227827, 220.60149414092893, 5.683449669269821, 157.4309034395978, 39.70359839149352, 125.14130992239377, 175.7049339999976, 8.12222010997852, 244.86283353200778, 45.617900951910485, 8.897836227912014]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1781380931834375, "mean_inference_ms": 3.3837382405217324, "mean_action_processing_ms": 0.46605684618208304, "mean_env_wait_ms": 0.4439545906812282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0084348399229724, "StateBufferConnector_ms": 0.005725537887727371, "ViewRequirementAgentConnector_ms": 0.21003388395213118}, "num_episodes": 27, "episode_return_max": 278.8199999999995, "episode_return_min": -234.01781301357434, "episode_return_mean": 73.55750775237712, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.91193721601337, "num_env_steps_trained_throughput_per_sec": 294.91193721601337, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 14027.358, "restore_workers_time_ms": 0.084, "training_step_time_ms": 14027.112, "sample_time_ms": 2165.106, "learn_time_ms": 11845.557, "learn_throughput": 337.679, "synch_weights_time_ms": 12.666}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "61e09_00000", "date": "2024-08-16_16-07-48", "timestamp": 1723804668, "time_this_iter_s": 13.603742837905884, "time_total_s": 70.37905859947205, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2549160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 70.37905859947205, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 64.49000000000002, "ram_util_percent": 82.24500000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2617781733236615, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.751526252176396, "policy_loss": -0.01069025041907533, "vf_loss": 2.7602733334536276, "vf_explained_var": 0.0028041630825668415, "kl": 0.009715867718430233, "entropy": 1.5626395087393503, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5525031558104925, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.3407758553822835, "policy_loss": -0.011979973350439673, "vf_loss": 3.350719442190947, "vf_explained_var": -0.0142940499795177, "kl": 0.010181963528290434, "entropy": 1.5307713584925131, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 278.8199999999995, "episode_reward_min": -234.01781301357434, "episode_reward_mean": 68.86205492792612, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -575.997855459317, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 154.17585322328014, "predator_policy": 609.4289070677154}, "policy_reward_mean": {"prey_policy": -66.17268961078645, "predator_policy": 100.6037170747495}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.11877001576178, 101.87118801125378, -234.01781301357434, -22.783779866597264, 52.44513272292032, 1.929999999999997, 60.156228686260754, 17.9208782371109, 164.2218886247016, 85.56922133978246, 3.501411222170618, 102.3131617225637, 3.129999999999974, 205.28635933896834, 191.57810156228808, -13.244561144781638, 60.549999999999834, 1.849999999999999, 200.61, 9.092206653800002, 195.41999999999985, 90.44121045403404, 51.96999999999979, 3.519999999999969, 54.634320499730315, 30.990000000000126, 145.32999999999907, 213.8486004150227, 88.88000000000004, 20.618777062900993, 102.66469417481798, 30.760000000000016, 87.5500000000001, 33.74999999999997, 3.5299999999999683, 9.299999999999955, 74.92019973100328, 6.549999999999969, 40.89999999999942, 94.31000000000024, 104.51917107504774, 102.10000000000043, 14.201323296144384, 0.4644315649566231, 278.8199999999995, 2.3507484930434024, 77.99000000000065, 29.495883848654387, 18.250000000000288, 50.56999999999996, 121.21714110785446, 33.14000000000002, 148.95000000000033, 192.9099999999998, 138.47221303626975, 54.8210768401524, 45.16268603828341, 35.10897190268536, 120.42000000000039, -0.3608310408918465, 189.42999999999995, 4.039999999999978, 161.20999999999998, 142.44000000000057, 112.6900000000002, 62.0629780378541, 135.30840219942417, 79.95999999999997, 84.62000000000025, 101.78699373345347, 114.10823279427085, 38.63000000000026, 253.899594264613, 97.75000000000021, 10.569999999999924, 165.52199625401414, 165.83999999999992, 54.08336451036052, 87.84943183335761, 22.356751872021036, 70.12295519618773, 3.6799999999999646, 18.930000000000046, 15.649999999999922, 22.330000000000187, 9.409999999999927, 3.229999999999975, 47.33999999999944, 15.605336762459835, 33.80000000000009, 23.01796001596217, 54.839999999999506, 50.42999999999942, 19.040000000000102, 17.440000000000182, 1.9524827062950185, 175.43999999999983, 35.32999999999941, 126.96000000000069, 84.91000000000109], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-316.59456968951275, -7.402187069051008, 59.07809974566553, -337.7105694346598, -371.72090922723044, -575.997855459317, -55.09450155850011, -95.07562678839179, -275.5652700744161, -201.22947249747605, -298.9501173479944, -42.6366824516197, 10.325568587277072, -22.129984477022127, -109.66286191476694, -9.690776252283467, -41.69860655906872, -2.1230502868104963, -59.761498738314245, -76.15429948873317, -52.234776689883795, -270.361152989875, -128.59600380202846, 75.06087009092542, -86.12782235763152, -100.23229717545213, -206.00901031573468, 43.95820762430526, -11.963073555859925, 5.286340664813162, -125.7966061770731, -72.66947715664905, 31.610498793604663, -351.663072864699, -271.73894509180104, -173.94034252022163, 135.21731343215976, -157.10602879661533, -66.29201894317765, -326.3576850556221, -32.16092082825571, 154.17585322328014, 9.015821120963947, -202.26636869468612, -86.74743775505847, -96.8862057062761, -61.90114009406941, -6.182421050538297, -105.6469683881934, -143.96274806917276, -19.785648124092088, -338.4744560534311, 88.57290685292064, 29.91310124375922, 37.036842470097, 108.97591930505638, 23.60138891768446, -93.71490227243105, -25.355742469206042, -45.93676294212788, -18.499589027070535, 73.21457893072595, -52.496175730780436, -92.96681574249052, -53.54213623514823, -201.81076287310873, -278.26428379187325, -56.24904033635941, -65.73050401030686, -1.637405699252519, -180.47232132381936, -178.24347007267372, -320.89775856199736, 8.856579925314604, -13.993347469265133, -28.286211395987092, 29.011350326207822, -180.90608963041075, 9.77824972831864, -24.792816134493044, -20.572926024990366, -19.762965469762417, -69.42967990788091, -25.133791218918695, -33.4077812458683, -16.646472300518287, -258.051491136863, -172.09582815613894, 39.871778118861506, 136.52564933504834, -9.071584531559534, 0.47074849304341, -26.412690446102527, -142.60745156368498, -185.41963699270596, -13.81494548199328, -18.76607963183233, -45.08602758457313, 48.26559742983428, -497.623463132112, -145.9503340417118, -83.82332127766912, -130.10457032559907, -102.10688704037953, 8.355547062019976, 37.45378439248259, 131.67383498549685, 36.649999999999935, 71.44118010034636, -172.4763862522552, -40.078654309443436, -234.99109101476157, -28.45446592916728, -56.37436460017381, -81.55055909574631, -143.75882827595106, 80.8232961216641, -13.549665598881454, -18.03296531587482, -59.84357705572482, 17.875435122787863, -190.14760233741964, -173.47409901902927, 0.3010178113822048, -1.3897552944757066, 141.60556803000438, -1.8333320812717788, 124.67786047214985, 0.7636182303681213, 83.92519718561473, -158.27384305111065, -86.11429226032897, -8.900158391086002, 69.05711262863677, -75.09143285832072, -66.9058065989403, -42.17957578627204, -75.20588718916308, -48.023626510757744, -53.61159029001895, 63.05070235274745, -288.52446274867225, -126.42898083744066, -0.890952995186366, 69.77504926756339, 77.3180242128474, -111.97636690506067, -18.01820031163278, -13.22072277248694, -32.566862874638666, -23.99598899027316, 26.897729484113878, 121.14530030559497, -23.77601902057216, -156.61606973734646, -15.58550956249178, -80.30190170039528, -28.9831682973387, -119.24391105323451, -159.2455809971355, 61.07073508620812, -243.93283353200835, -43.84790095191084, -6.987836227912048, -458.46710520659, -274.9657112790857, -4.683733859933949, -23.59286777562311, -75.15204756491521, 0.03108695154116143, -64.15586828527726, -25.049044967304507, -7.334460883074858, -140.07758185663593, -13.057199961568559, 21.32409844348275, -45.59892692871782, -2.8846632375401358, -31.111098790678806, -250.63082085078742, 2.0000000000000013, -47.25789324513521, -65.20070384919404, -24.504300933750798, 33.41455322451079, 1.1133413972792323, -352.38416088110336, -11.970761737456955, -19.47098893253768, -6.580778736926238, -6.449522524027316, -124.636194287502, 100.7811669520928, -58.24838909540418, -25.591639999911337, -3.3922558285068085, -33.93077398178879, 29.255312016667858, 48.54425359568338, -7.91613703662088], "policy_predator_policy_reward": [38.187784682607095, 317.92774209171824, 58.0025919215457, 322.50106577870207, 104.27204460525753, 609.4289070677154, 10.026084220710215, 117.36026425958427, 238.8054572495079, 290.4344180453044, 299.23011734799417, 44.28668245161937, 35.7942470206064, 36.166397555399875, 12.723092550330243, 124.55142385383107, 124.53513248589239, 83.50841298468859, 85.01892012221253, 136.46609944461767, 287.5576198450263, 38.53972105690226, 126.70693807526541, 29.14135735840113, 87.78782235763236, 101.7022971754521, 183.32313496237808, 184.01402706801966, 120.66854914286539, 77.58628531046989, 156.80290374319264, 28.418618445748987, 27.569501206395465, 353.0330728646987, 272.62894509180023, 174.90034252022093, 14.152686567840242, 208.34602879661537, 8.527970480264635, 393.2139401723359, 18.55461023209419, 54.85045737288138, 89.66777283894407, 194.0239851888108, 117.47743775505879, 118.12620570627617, 63.471140094069234, 8.132421050538255, 148.2495733300447, 155.99446362705214, 49.15564812409197, 340.0944560534306, 15.237093147079698, 11.60689875624102, 13.941188864224966, 53.89464977564585, 64.00861108231543, 94.98490227243165, 42.9444293988454, 48.966853075389245, 32.634532530107116, 15.315171741055444, 66.86583815747203, 109.35715331579979, 139.97213623514838, 202.93076287310777, 279.91428379187295, 88.34904033635937, 67.30050401030742, 3.5974056992524917, 187.78232132381828, 180.2334700726732, 161.50933210163944, 225.45204626604536, 27.710053601291406, 21.119505263961045, 10.518649673792417, 182.2760896304099, 51.42638837454577, 57.89817803162891, 24.059166738912783, 120.79589583088737, 188.40925394411556, 8.254217182684327, 7.2568519868132775, 56.998724855718024, 323.6244761025639, 106.98727475539417, 85.7183909193891, 16.704181626701107, 0.0, 10.951584531559494, 28.18269044610278, 218.82745156368486, 61.87017641190359, 166.86028991144855, 21.372705778066496, 60.72940143833881, 2.2244025701656875, 497.703463132112, 123.25611897685965, 227.73467745037527, 101.74490061853896, 163.60655674743973, 101.97445293798003, 1.166215607517408, 24.5861650145031, 0.0, 87.37528617813616, 152.1321330100423, 188.44218057067792, 141.44864159367913, 103.22523878341515, 26.766277784209805, 164.35506515692646, 96.06329411745658, 37.696703878335896, 15.449665598881413, 4.080583120168974, 73.43512821053882, 192.49621543660555, 169.2059517780261, 80.11450475839376, 97.09857644925322, 3.3597552944756783, 17.63443196999565, 3.793332081271741, 15.802139527850386, 1.2263817696318802, 26.774802814385268, 58.62587747109764, 247.82523587819676, 45.84262779898942, 29.30882016288401, 153.5114328583207, 68.4458065989403, 125.37957578627196, 76.6258871891636, 124.35889277026426, 79.06331776396584, 281.84253326475675, 57.73945992543843, 147.32898083744107, 18.62095299518637, 18.4924258587447, 88.31409492545816, 113.30636690506115, 114.43820031163285, 22.020722772486902, 34.336862874638314, 82.93946235356303, 79.68079340661092, 41.309668898749635, 27.161049816227827, 220.60149414092893, 5.683449669269821, 157.4309034395978, 39.70359839149352, 125.14130992239377, 175.7049339999976, 8.12222010997852, 244.86283353200778, 45.617900951910485, 8.897836227912014, 476.48710520659, 275.8757112790851, 18.423733859933908, 25.502867775623407, 95.5020475649159, 1.9489130484588402, 56.5867404987287, 42.02817275385411, 9.244460883074819, 141.39758185663482, 14.957199961568518, 24.115901556517468, 19.163177047155926, 44.925749881561615, 32.891098790678925, 282.65082085078717, 35.55578478668154, 32.720068474414894, 108.950585548944, 35.5944192340017, 15.025446775488934, 0.8766586027207689, 284.6239181771893, 98.77100444137105, 21.24098893253794, 22.250778736926204, 19.140685776863428, 113.89751374096116, 50.34883304790717, 82.55838909540411, 28.381639999911616, 35.932255828506776, 35.74077398178843, 95.89468798333212, 34.47574640431642, 9.80613703662084]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0829649292786274, "mean_inference_ms": 2.992685186877324, "mean_action_processing_ms": 0.4260932528236825, "mean_env_wait_ms": 0.39197121264319046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077931880950927734, "StateBufferConnector_ms": 0.005622744560241699, "ViewRequirementAgentConnector_ms": 0.1612396240234375}, "num_episodes": 18, "episode_return_max": 278.8199999999995, "episode_return_min": -234.01781301357434, "episode_return_mean": 68.86205492792612, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.56649296211793, "num_env_steps_trained_throughput_per_sec": 311.56649296211793, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 13829.192, "restore_workers_time_ms": 0.072, "training_step_time_ms": 13828.98, "sample_time_ms": 2037.782, "learn_time_ms": 11774.414, "learn_throughput": 339.72, "synch_weights_time_ms": 13.244}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "61e09_00000", "date": "2024-08-16_16-08-00", "timestamp": 1723804680, "time_this_iter_s": 12.882345914840698, "time_total_s": 83.26140451431274, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b25493a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 83.26140451431274, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 67.64444444444445, "ram_util_percent": 82.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3089313687470856, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.919235240088569, "policy_loss": -0.009644608350381965, "vf_loss": 4.926931035960162, "vf_explained_var": 0.004443699279159465, "kl": 0.009744083220406768, "entropy": 1.541114334454612, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7590123764106205, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.06384331511442, "policy_loss": -0.008609571821849656, "vf_loss": 5.0709007200109895, "vf_explained_var": -0.02992494304974874, "kl": 0.007760870027867898, "entropy": 1.5170966581062035, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 278.8199999999995, "episode_reward_min": -19.404774875631524, "episode_reward_mean": 72.56266234584103, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -497.623463132112, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 154.17585322328014, "predator_policy": 497.703463132112}, "policy_reward_mean": {"prey_policy": -53.13127526427625, "predator_policy": 89.41260643719671}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.61, 9.092206653800002, 195.41999999999985, 90.44121045403404, 51.96999999999979, 3.519999999999969, 54.634320499730315, 30.990000000000126, 145.32999999999907, 213.8486004150227, 88.88000000000004, 20.618777062900993, 102.66469417481798, 30.760000000000016, 87.5500000000001, 33.74999999999997, 3.5299999999999683, 9.299999999999955, 74.92019973100328, 6.549999999999969, 40.89999999999942, 94.31000000000024, 104.51917107504774, 102.10000000000043, 14.201323296144384, 0.4644315649566231, 278.8199999999995, 2.3507484930434024, 77.99000000000065, 29.495883848654387, 18.250000000000288, 50.56999999999996, 121.21714110785446, 33.14000000000002, 148.95000000000033, 192.9099999999998, 138.47221303626975, 54.8210768401524, 45.16268603828341, 35.10897190268536, 120.42000000000039, -0.3608310408918465, 189.42999999999995, 4.039999999999978, 161.20999999999998, 142.44000000000057, 112.6900000000002, 62.0629780378541, 135.30840219942417, 79.95999999999997, 84.62000000000025, 101.78699373345347, 114.10823279427085, 38.63000000000026, 253.899594264613, 97.75000000000021, 10.569999999999924, 165.52199625401414, 165.83999999999992, 54.08336451036052, 87.84943183335761, 22.356751872021036, 70.12295519618773, 3.6799999999999646, 18.930000000000046, 15.649999999999922, 22.330000000000187, 9.409999999999927, 3.229999999999975, 47.33999999999944, 15.605336762459835, 33.80000000000009, 23.01796001596217, 54.839999999999506, 50.42999999999942, 19.040000000000102, 17.440000000000182, 1.9524827062950185, 175.43999999999983, 35.32999999999941, 126.96000000000069, 84.91000000000109, 3.619999999999965, 73.93999999999998, 93.3800000000005, 75.22000000000077, 125.72000000000043, 73.6918721211706, 144.23000000000013, 63.55195210619177, 10.609999999999925, 51.0966790479463, 101.93998181364395, 80.56078902602847, 83.85000000000126, 25.470000000000294, 88.71550299977557, 68.20552456453424, -19.404774875631524, 40.05940244665633], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [135.21731343215976, -157.10602879661533, -66.29201894317765, -326.3576850556221, -32.16092082825571, 154.17585322328014, 9.015821120963947, -202.26636869468612, -86.74743775505847, -96.8862057062761, -61.90114009406941, -6.182421050538297, -105.6469683881934, -143.96274806917276, -19.785648124092088, -338.4744560534311, 88.57290685292064, 29.91310124375922, 37.036842470097, 108.97591930505638, 23.60138891768446, -93.71490227243105, -25.355742469206042, -45.93676294212788, -18.499589027070535, 73.21457893072595, -52.496175730780436, -92.96681574249052, -53.54213623514823, -201.81076287310873, -278.26428379187325, -56.24904033635941, -65.73050401030686, -1.637405699252519, -180.47232132381936, -178.24347007267372, -320.89775856199736, 8.856579925314604, -13.993347469265133, -28.286211395987092, 29.011350326207822, -180.90608963041075, 9.77824972831864, -24.792816134493044, -20.572926024990366, -19.762965469762417, -69.42967990788091, -25.133791218918695, -33.4077812458683, -16.646472300518287, -258.051491136863, -172.09582815613894, 39.871778118861506, 136.52564933504834, -9.071584531559534, 0.47074849304341, -26.412690446102527, -142.60745156368498, -185.41963699270596, -13.81494548199328, -18.76607963183233, -45.08602758457313, 48.26559742983428, -497.623463132112, -145.9503340417118, -83.82332127766912, -130.10457032559907, -102.10688704037953, 8.355547062019976, 37.45378439248259, 131.67383498549685, 36.649999999999935, 71.44118010034636, -172.4763862522552, -40.078654309443436, -234.99109101476157, -28.45446592916728, -56.37436460017381, -81.55055909574631, -143.75882827595106, 80.8232961216641, -13.549665598881454, -18.03296531587482, -59.84357705572482, 17.875435122787863, -190.14760233741964, -173.47409901902927, 0.3010178113822048, -1.3897552944757066, 141.60556803000438, -1.8333320812717788, 124.67786047214985, 0.7636182303681213, 83.92519718561473, -158.27384305111065, -86.11429226032897, -8.900158391086002, 69.05711262863677, -75.09143285832072, -66.9058065989403, -42.17957578627204, -75.20588718916308, -48.023626510757744, -53.61159029001895, 63.05070235274745, -288.52446274867225, -126.42898083744066, -0.890952995186366, 69.77504926756339, 77.3180242128474, -111.97636690506067, -18.01820031163278, -13.22072277248694, -32.566862874638666, -23.99598899027316, 26.897729484113878, 121.14530030559497, -23.77601902057216, -156.61606973734646, -15.58550956249178, -80.30190170039528, -28.9831682973387, -119.24391105323451, -159.2455809971355, 61.07073508620812, -243.93283353200835, -43.84790095191084, -6.987836227912048, -458.46710520659, -274.9657112790857, -4.683733859933949, -23.59286777562311, -75.15204756491521, 0.03108695154116143, -64.15586828527726, -25.049044967304507, -7.334460883074858, -140.07758185663593, -13.057199961568559, 21.32409844348275, -45.59892692871782, -2.8846632375401358, -31.111098790678806, -250.63082085078742, 2.0000000000000013, -47.25789324513521, -65.20070384919404, -24.504300933750798, 33.41455322451079, 1.1133413972792323, -352.38416088110336, -11.970761737456955, -19.47098893253768, -6.580778736926238, -6.449522524027316, -124.636194287502, 100.7811669520928, -58.24838909540418, -25.591639999911337, -3.3922558285068085, -33.93077398178879, 29.255312016667858, 48.54425359568338, -7.91613703662088, -1.8407013170382367, -80.7502813262472, -6.01127476659882, -120.28640590033197, -8.53158625886359, 19.34041243839357, -107.12339999822088, -12.973672932311363, -35.27349896433194, 34.16437721023174, -140.29308438648897, -7.387147050944497, -20.801615514965725, 122.80792009440358, -173.7759768498491, -66.64651911121943, -38.158740428837355, 2.0000000000000013, -63.01872319965528, -192.4635464968081, -298.2831824437531, 0.9521797207675621, -162.53500293726287, -26.88150939316645, 50.17330052619922, -16.126187188668915, -4.682962211512086, -16.56470250284849, 39.7050728518054, -64.7366757290412, 47.58919410251294, 0.9834139460817065, -33.116400781823785, -133.355862955855, -61.06830521540581, -341.95787023179116], "policy_predator_policy_reward": [14.152686567840242, 208.34602879661537, 8.527970480264635, 393.2139401723359, 18.55461023209419, 54.85045737288138, 89.66777283894407, 194.0239851888108, 117.47743775505879, 118.12620570627617, 63.471140094069234, 8.132421050538255, 148.2495733300447, 155.99446362705214, 49.15564812409197, 340.0944560534306, 15.237093147079698, 11.60689875624102, 13.941188864224966, 53.89464977564585, 64.00861108231543, 94.98490227243165, 42.9444293988454, 48.966853075389245, 32.634532530107116, 15.315171741055444, 66.86583815747203, 109.35715331579979, 139.97213623514838, 202.93076287310777, 279.91428379187295, 88.34904033635937, 67.30050401030742, 3.5974056992524917, 187.78232132381828, 180.2334700726732, 161.50933210163944, 225.45204626604536, 27.710053601291406, 21.119505263961045, 10.518649673792417, 182.2760896304099, 51.42638837454577, 57.89817803162891, 24.059166738912783, 120.79589583088737, 188.40925394411556, 8.254217182684327, 7.2568519868132775, 56.998724855718024, 323.6244761025639, 106.98727475539417, 85.7183909193891, 16.704181626701107, 0.0, 10.951584531559494, 28.18269044610278, 218.82745156368486, 61.87017641190359, 166.86028991144855, 21.372705778066496, 60.72940143833881, 2.2244025701656875, 497.703463132112, 123.25611897685965, 227.73467745037527, 101.74490061853896, 163.60655674743973, 101.97445293798003, 1.166215607517408, 24.5861650145031, 0.0, 87.37528617813616, 152.1321330100423, 188.44218057067792, 141.44864159367913, 103.22523878341515, 26.766277784209805, 164.35506515692646, 96.06329411745658, 37.696703878335896, 15.449665598881413, 4.080583120168974, 73.43512821053882, 192.49621543660555, 169.2059517780261, 80.11450475839376, 97.09857644925322, 3.3597552944756783, 17.63443196999565, 3.793332081271741, 15.802139527850386, 1.2263817696318802, 26.774802814385268, 58.62587747109764, 247.82523587819676, 45.84262779898942, 29.30882016288401, 153.5114328583207, 68.4458065989403, 125.37957578627196, 76.6258871891636, 124.35889277026426, 79.06331776396584, 281.84253326475675, 57.73945992543843, 147.32898083744107, 18.62095299518637, 18.4924258587447, 88.31409492545816, 113.30636690506115, 114.43820031163285, 22.020722772486902, 34.336862874638314, 82.93946235356303, 79.68079340661092, 41.309668898749635, 27.161049816227827, 220.60149414092893, 5.683449669269821, 157.4309034395978, 39.70359839149352, 125.14130992239377, 175.7049339999976, 8.12222010997852, 244.86283353200778, 45.617900951910485, 8.897836227912014, 476.48710520659, 275.8757112790851, 18.423733859933908, 25.502867775623407, 95.5020475649159, 1.9489130484588402, 56.5867404987287, 42.02817275385411, 9.244460883074819, 141.39758185663482, 14.957199961568518, 24.115901556517468, 19.163177047155926, 44.925749881561615, 32.891098790678925, 282.65082085078717, 35.55578478668154, 32.720068474414894, 108.950585548944, 35.5944192340017, 15.025446775488934, 0.8766586027207689, 284.6239181771893, 98.77100444137105, 21.24098893253794, 22.250778736926204, 19.140685776863428, 113.89751374096116, 50.34883304790717, 82.55838909540411, 28.381639999911616, 35.932255828506776, 35.74077398178843, 95.89468798333212, 34.47574640431642, 9.80613703662084, 3.8107013170381983, 82.40028132624805, 7.95127476659878, 192.28640590033214, 10.451586258863548, 72.11958756160652, 110.24412662075659, 85.07294630977638, 76.85604689236231, 49.97307486173755, 206.55084401626877, 14.821259542335218, 22.64161551496599, 19.58207990559648, 111.86619214062299, 192.1082559266376, 46.76874042883705, 0.0, 150.29360072602927, 156.28534801838046, 245.25619679954684, 154.01478773708254, 132.22791429875682, 137.7493870577012, 12.332216845780767, 37.470669816688954, 23.402962211512158, 23.314702502848682, 51.01729223524183, 62.7298136417684, 7.960600188247197, 11.67231632769093, 141.01437001353835, 6.0531188485087455, 84.6299095427842, 358.4556683510688]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0252500749113147, "mean_inference_ms": 2.772276934289757, "mean_action_processing_ms": 0.4036345759743463, "mean_env_wait_ms": 0.3646935456550213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00747227668762207, "StateBufferConnector_ms": 0.0031311511993408203, "ViewRequirementAgentConnector_ms": 0.15946757793426514}, "num_episodes": 18, "episode_return_max": 278.8199999999995, "episode_return_min": -19.404774875631524, "episode_return_mean": 72.56266234584103, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.94196103445864, "num_env_steps_trained_throughput_per_sec": 309.94196103445864, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 13697.258, "restore_workers_time_ms": 0.064, "training_step_time_ms": 13697.07, "sample_time_ms": 1943.104, "learn_time_ms": 11737.752, "learn_throughput": 340.781, "synch_weights_time_ms": 13.066}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "61e09_00000", "date": "2024-08-16_16-08-13", "timestamp": 1723804693, "time_this_iter_s": 12.941930532455444, "time_total_s": 96.20333504676819, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b55a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 96.20333504676819, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 64.80000000000001, "ram_util_percent": 82.70555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1259044425828115, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.550332074821311, "policy_loss": -0.012533219808604194, "vf_loss": 4.56066990996164, "vf_explained_var": 0.0025345037538538535, "kl": 0.010976972443214073, "entropy": 1.525249496212712, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.862642570084365, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.310981145359221, "policy_loss": -0.01618034755958924, "vf_loss": 5.324525329927919, "vf_explained_var": 0.0014302079009000587, "kl": 0.013180818237711844, "entropy": 1.5081038432777243, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 278.8199999999995, "episode_reward_min": -38.03819566771353, "episode_reward_mean": 75.86422368202409, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -568.8057223201024, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 155.55807909203733, "predator_policy": 553.2704254996934}, "policy_reward_mean": {"prey_policy": -57.49449504309181, "predator_policy": 95.4266068841038}, "custom_metrics": {}, "hist_stats": {"episode_reward": [74.92019973100328, 6.549999999999969, 40.89999999999942, 94.31000000000024, 104.51917107504774, 102.10000000000043, 14.201323296144384, 0.4644315649566231, 278.8199999999995, 2.3507484930434024, 77.99000000000065, 29.495883848654387, 18.250000000000288, 50.56999999999996, 121.21714110785446, 33.14000000000002, 148.95000000000033, 192.9099999999998, 138.47221303626975, 54.8210768401524, 45.16268603828341, 35.10897190268536, 120.42000000000039, -0.3608310408918465, 189.42999999999995, 4.039999999999978, 161.20999999999998, 142.44000000000057, 112.6900000000002, 62.0629780378541, 135.30840219942417, 79.95999999999997, 84.62000000000025, 101.78699373345347, 114.10823279427085, 38.63000000000026, 253.899594264613, 97.75000000000021, 10.569999999999924, 165.52199625401414, 165.83999999999992, 54.08336451036052, 87.84943183335761, 22.356751872021036, 70.12295519618773, 3.6799999999999646, 18.930000000000046, 15.649999999999922, 22.330000000000187, 9.409999999999927, 3.229999999999975, 47.33999999999944, 15.605336762459835, 33.80000000000009, 23.01796001596217, 54.839999999999506, 50.42999999999942, 19.040000000000102, 17.440000000000182, 1.9524827062950185, 175.43999999999983, 35.32999999999941, 126.96000000000069, 84.91000000000109, 3.619999999999965, 73.93999999999998, 93.3800000000005, 75.22000000000077, 125.72000000000043, 73.6918721211706, 144.23000000000013, 63.55195210619177, 10.609999999999925, 51.0966790479463, 101.93998181364395, 80.56078902602847, 83.85000000000126, 25.470000000000294, 88.71550299977557, 68.20552456453424, -19.404774875631524, 40.05940244665633, 69.74999999999974, 113.56395735610452, 185.64542497750773, 88.98725216377468, 178.1899999999997, 139.4026952326672, 66.69468644498987, 3.1799999999999704, 193.8271545062963, 3.369999999999968, 3.559999999999966, 94.16797756185046, 248.23499030313496, 32.450000000000166, 105.18000000000049, 152.98999999999987, 61.90999999999975, -38.03819566771353], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-320.89775856199736, 8.856579925314604, -13.993347469265133, -28.286211395987092, 29.011350326207822, -180.90608963041075, 9.77824972831864, -24.792816134493044, -20.572926024990366, -19.762965469762417, -69.42967990788091, -25.133791218918695, -33.4077812458683, -16.646472300518287, -258.051491136863, -172.09582815613894, 39.871778118861506, 136.52564933504834, -9.071584531559534, 0.47074849304341, -26.412690446102527, -142.60745156368498, -185.41963699270596, -13.81494548199328, -18.76607963183233, -45.08602758457313, 48.26559742983428, -497.623463132112, -145.9503340417118, -83.82332127766912, -130.10457032559907, -102.10688704037953, 8.355547062019976, 37.45378439248259, 131.67383498549685, 36.649999999999935, 71.44118010034636, -172.4763862522552, -40.078654309443436, -234.99109101476157, -28.45446592916728, -56.37436460017381, -81.55055909574631, -143.75882827595106, 80.8232961216641, -13.549665598881454, -18.03296531587482, -59.84357705572482, 17.875435122787863, -190.14760233741964, -173.47409901902927, 0.3010178113822048, -1.3897552944757066, 141.60556803000438, -1.8333320812717788, 124.67786047214985, 0.7636182303681213, 83.92519718561473, -158.27384305111065, -86.11429226032897, -8.900158391086002, 69.05711262863677, -75.09143285832072, -66.9058065989403, -42.17957578627204, -75.20588718916308, -48.023626510757744, -53.61159029001895, 63.05070235274745, -288.52446274867225, -126.42898083744066, -0.890952995186366, 69.77504926756339, 77.3180242128474, -111.97636690506067, -18.01820031163278, -13.22072277248694, -32.566862874638666, -23.99598899027316, 26.897729484113878, 121.14530030559497, -23.77601902057216, -156.61606973734646, -15.58550956249178, -80.30190170039528, -28.9831682973387, -119.24391105323451, -159.2455809971355, 61.07073508620812, -243.93283353200835, -43.84790095191084, -6.987836227912048, -458.46710520659, -274.9657112790857, -4.683733859933949, -23.59286777562311, -75.15204756491521, 0.03108695154116143, -64.15586828527726, -25.049044967304507, -7.334460883074858, -140.07758185663593, -13.057199961568559, 21.32409844348275, -45.59892692871782, -2.8846632375401358, -31.111098790678806, -250.63082085078742, 2.0000000000000013, -47.25789324513521, -65.20070384919404, -24.504300933750798, 33.41455322451079, 1.1133413972792323, -352.38416088110336, -11.970761737456955, -19.47098893253768, -6.580778736926238, -6.449522524027316, -124.636194287502, 100.7811669520928, -58.24838909540418, -25.591639999911337, -3.3922558285068085, -33.93077398178879, 29.255312016667858, 48.54425359568338, -7.91613703662088, -1.8407013170382367, -80.7502813262472, -6.01127476659882, -120.28640590033197, -8.53158625886359, 19.34041243839357, -107.12339999822088, -12.973672932311363, -35.27349896433194, 34.16437721023174, -140.29308438648897, -7.387147050944497, -20.801615514965725, 122.80792009440358, -173.7759768498491, -66.64651911121943, -38.158740428837355, 2.0000000000000013, -63.01872319965528, -192.4635464968081, -298.2831824437531, 0.9521797207675621, -162.53500293726287, -26.88150939316645, 50.17330052619922, -16.126187188668915, -4.682962211512086, -16.56470250284849, 39.7050728518054, -64.7366757290412, 47.58919410251294, 0.9834139460817065, -33.116400781823785, -133.355862955855, -61.06830521540581, -341.95787023179116, -200.21527336292897, 27.34134102565931, -214.8310814939729, -347.58432196603644, 30.143245829167817, -25.45982199031745, -3.7047997007193025, -3.09369088438741, -158.87799056713772, 155.55807909203733, -55.79525792250436, 5.322628421338257, -75.61412799917211, -16.99464372535428, -102.11918873663834, -101.1725177089311, -35.61127672352919, 64.6267006748201, -152.34272999779202, -0.317066125054122, -36.38099439541248, -55.94519297375708, -146.6420689408723, -301.57008044605135, -151.3036632075689, -568.8057223201024, -3.622830688208765, -187.77892224687645, -213.26988066791228, -24.292139610782698, 66.37540120673386, 26.443324963728244, -19.628514881076047, -148.71258871305403, -174.41443408275325, -51.320089486886026], "policy_predator_policy_reward": [161.50933210163944, 225.45204626604536, 27.710053601291406, 21.119505263961045, 10.518649673792417, 182.2760896304099, 51.42638837454577, 57.89817803162891, 24.059166738912783, 120.79589583088737, 188.40925394411556, 8.254217182684327, 7.2568519868132775, 56.998724855718024, 323.6244761025639, 106.98727475539417, 85.7183909193891, 16.704181626701107, 0.0, 10.951584531559494, 28.18269044610278, 218.82745156368486, 61.87017641190359, 166.86028991144855, 21.372705778066496, 60.72940143833881, 2.2244025701656875, 497.703463132112, 123.25611897685965, 227.73467745037527, 101.74490061853896, 163.60655674743973, 101.97445293798003, 1.166215607517408, 24.5861650145031, 0.0, 87.37528617813616, 152.1321330100423, 188.44218057067792, 141.44864159367913, 103.22523878341515, 26.766277784209805, 164.35506515692646, 96.06329411745658, 37.696703878335896, 15.449665598881413, 4.080583120168974, 73.43512821053882, 192.49621543660555, 169.2059517780261, 80.11450475839376, 97.09857644925322, 3.3597552944756783, 17.63443196999565, 3.793332081271741, 15.802139527850386, 1.2263817696318802, 26.774802814385268, 58.62587747109764, 247.82523587819676, 45.84262779898942, 29.30882016288401, 153.5114328583207, 68.4458065989403, 125.37957578627196, 76.6258871891636, 124.35889277026426, 79.06331776396584, 281.84253326475675, 57.73945992543843, 147.32898083744107, 18.62095299518637, 18.4924258587447, 88.31409492545816, 113.30636690506115, 114.43820031163285, 22.020722772486902, 34.336862874638314, 82.93946235356303, 79.68079340661092, 41.309668898749635, 27.161049816227827, 220.60149414092893, 5.683449669269821, 157.4309034395978, 39.70359839149352, 125.14130992239377, 175.7049339999976, 8.12222010997852, 244.86283353200778, 45.617900951910485, 8.897836227912014, 476.48710520659, 275.8757112790851, 18.423733859933908, 25.502867775623407, 95.5020475649159, 1.9489130484588402, 56.5867404987287, 42.02817275385411, 9.244460883074819, 141.39758185663482, 14.957199961568518, 24.115901556517468, 19.163177047155926, 44.925749881561615, 32.891098790678925, 282.65082085078717, 35.55578478668154, 32.720068474414894, 108.950585548944, 35.5944192340017, 15.025446775488934, 0.8766586027207689, 284.6239181771893, 98.77100444137105, 21.24098893253794, 22.250778736926204, 19.140685776863428, 113.89751374096116, 50.34883304790717, 82.55838909540411, 28.381639999911616, 35.932255828506776, 35.74077398178843, 95.89468798333212, 34.47574640431642, 9.80613703662084, 3.8107013170381983, 82.40028132624805, 7.95127476659878, 192.28640590033214, 10.451586258863548, 72.11958756160652, 110.24412662075659, 85.07294630977638, 76.85604689236231, 49.97307486173755, 206.55084401626877, 14.821259542335218, 22.64161551496599, 19.58207990559648, 111.86619214062299, 192.1082559266376, 46.76874042883705, 0.0, 150.29360072602927, 156.28534801838046, 245.25619679954684, 154.01478773708254, 132.22791429875682, 137.7493870577012, 12.332216845780767, 37.470669816688954, 23.402962211512158, 23.314702502848682, 51.01729223524183, 62.7298136417684, 7.960600188247197, 11.67231632769093, 141.01437001353835, 6.0531188485087455, 84.6299095427842, 358.4556683510688, 227.51527336292898, 15.108658974340912, 380.86117407924417, 295.11818673686946, 137.89476166985114, 43.06723946880618, 43.556490973264445, 52.22925177561587, 160.0179905671372, 21.491920907962662, 94.9707015730826, 94.90462316075116, 86.81455494541699, 72.48890322409943, 103.64918873663902, 102.82251770893194, 155.96557673087273, 8.846153824133884, 153.73272999779076, 2.2970661250541173, 38.160994395412125, 57.72519297375673, 278.19229242088124, 264.1878345278918, 415.0739503311119, 553.2704254996934, 35.122830688208694, 188.72892224687558, 252.1185527092848, 90.62346756940954, 14.237377025728081, 45.9338968038099, 21.538514881076345, 208.71258871305412, 183.6705992226076, 4.025728679318613]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9709479300872608, "mean_inference_ms": 2.6167635231397566, "mean_action_processing_ms": 0.3842286761277496, "mean_env_wait_ms": 0.3453223108958611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006976485252380371, "StateBufferConnector_ms": 0.003152608871459961, "ViewRequirementAgentConnector_ms": 0.1306772232055664}, "num_episodes": 18, "episode_return_max": 278.8199999999995, "episode_return_min": -38.03819566771353, "episode_return_mean": 75.86422368202409, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 259.4069727115171, "num_env_steps_trained_throughput_per_sec": 259.4069727115171, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 13912.575, "restore_workers_time_ms": 0.057, "training_step_time_ms": 13912.405, "sample_time_ms": 1872.216, "learn_time_ms": 12023.339, "learn_throughput": 332.686, "synch_weights_time_ms": 13.693}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "61e09_00000", "date": "2024-08-16_16-08-29", "timestamp": 1723804709, "time_this_iter_s": 15.441843032836914, "time_total_s": 111.6451780796051, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b25344c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 111.6451780796051, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 62.213636363636354, "ram_util_percent": 81.29545454545456}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0672224847570297, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.023177242152905, "policy_loss": -0.010899084395477696, "vf_loss": 4.031641264693447, "vf_explained_var": 0.0013893280395124324, "kl": 0.012175310011924626, "entropy": 1.5084464072550416, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6346536304900254, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.88640698642327, "policy_loss": -0.0069263857551579355, "vf_loss": 4.892010930101708, "vf_explained_var": 0.03329925136591392, "kl": 0.006612224485243881, "entropy": 1.502295383322176, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 253.899594264613, "episode_reward_min": -55.29957249797109, "episode_reward_mean": 72.4105250431414, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -568.8057223201024, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 155.55807909203733, "predator_policy": 619.2478692780039}, "policy_reward_mean": {"prey_policy": -61.4613097272238, "predator_policy": 97.6665722487945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.42000000000039, -0.3608310408918465, 189.42999999999995, 4.039999999999978, 161.20999999999998, 142.44000000000057, 112.6900000000002, 62.0629780378541, 135.30840219942417, 79.95999999999997, 84.62000000000025, 101.78699373345347, 114.10823279427085, 38.63000000000026, 253.899594264613, 97.75000000000021, 10.569999999999924, 165.52199625401414, 165.83999999999992, 54.08336451036052, 87.84943183335761, 22.356751872021036, 70.12295519618773, 3.6799999999999646, 18.930000000000046, 15.649999999999922, 22.330000000000187, 9.409999999999927, 3.229999999999975, 47.33999999999944, 15.605336762459835, 33.80000000000009, 23.01796001596217, 54.839999999999506, 50.42999999999942, 19.040000000000102, 17.440000000000182, 1.9524827062950185, 175.43999999999983, 35.32999999999941, 126.96000000000069, 84.91000000000109, 3.619999999999965, 73.93999999999998, 93.3800000000005, 75.22000000000077, 125.72000000000043, 73.6918721211706, 144.23000000000013, 63.55195210619177, 10.609999999999925, 51.0966790479463, 101.93998181364395, 80.56078902602847, 83.85000000000126, 25.470000000000294, 88.71550299977557, 68.20552456453424, -19.404774875631524, 40.05940244665633, 69.74999999999974, 113.56395735610452, 185.64542497750773, 88.98725216377468, 178.1899999999997, 139.4026952326672, 66.69468644498987, 3.1799999999999704, 193.8271545062963, 3.369999999999968, 3.559999999999966, 94.16797756185046, 248.23499030313496, 32.450000000000166, 105.18000000000049, 152.98999999999987, 61.90999999999975, -38.03819566771353, 144.48031191006174, 78.380000000001, 26.660000000000405, 46.69124738851589, 63.72999999999959, -6.049651733637116, 77.49000000000096, 201.78205381557285, 129.88000000000005, 176.96855404639268, 2.0236713851817716, 36.08063037089814, 32.760074807389444, 3.8299999999999623, 37.699999999999676, -55.29957249797109, -4.742894104779747, 91.86455560068129, 56.16999999999944, 3.8499999999999623, 37.96500205751985, 137.63999999999967], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [80.8232961216641, -13.549665598881454, -18.03296531587482, -59.84357705572482, 17.875435122787863, -190.14760233741964, -173.47409901902927, 0.3010178113822048, -1.3897552944757066, 141.60556803000438, -1.8333320812717788, 124.67786047214985, 0.7636182303681213, 83.92519718561473, -158.27384305111065, -86.11429226032897, -8.900158391086002, 69.05711262863677, -75.09143285832072, -66.9058065989403, -42.17957578627204, -75.20588718916308, -48.023626510757744, -53.61159029001895, 63.05070235274745, -288.52446274867225, -126.42898083744066, -0.890952995186366, 69.77504926756339, 77.3180242128474, -111.97636690506067, -18.01820031163278, -13.22072277248694, -32.566862874638666, -23.99598899027316, 26.897729484113878, 121.14530030559497, -23.77601902057216, -156.61606973734646, -15.58550956249178, -80.30190170039528, -28.9831682973387, -119.24391105323451, -159.2455809971355, 61.07073508620812, -243.93283353200835, -43.84790095191084, -6.987836227912048, -458.46710520659, -274.9657112790857, -4.683733859933949, -23.59286777562311, -75.15204756491521, 0.03108695154116143, -64.15586828527726, -25.049044967304507, -7.334460883074858, -140.07758185663593, -13.057199961568559, 21.32409844348275, -45.59892692871782, -2.8846632375401358, -31.111098790678806, -250.63082085078742, 2.0000000000000013, -47.25789324513521, -65.20070384919404, -24.504300933750798, 33.41455322451079, 1.1133413972792323, -352.38416088110336, -11.970761737456955, -19.47098893253768, -6.580778736926238, -6.449522524027316, -124.636194287502, 100.7811669520928, -58.24838909540418, -25.591639999911337, -3.3922558285068085, -33.93077398178879, 29.255312016667858, 48.54425359568338, -7.91613703662088, -1.8407013170382367, -80.7502813262472, -6.01127476659882, -120.28640590033197, -8.53158625886359, 19.34041243839357, -107.12339999822088, -12.973672932311363, -35.27349896433194, 34.16437721023174, -140.29308438648897, -7.387147050944497, -20.801615514965725, 122.80792009440358, -173.7759768498491, -66.64651911121943, -38.158740428837355, 2.0000000000000013, -63.01872319965528, -192.4635464968081, -298.2831824437531, 0.9521797207675621, -162.53500293726287, -26.88150939316645, 50.17330052619922, -16.126187188668915, -4.682962211512086, -16.56470250284849, 39.7050728518054, -64.7366757290412, 47.58919410251294, 0.9834139460817065, -33.116400781823785, -133.355862955855, -61.06830521540581, -341.95787023179116, -200.21527336292897, 27.34134102565931, -214.8310814939729, -347.58432196603644, 30.143245829167817, -25.45982199031745, -3.7047997007193025, -3.09369088438741, -158.87799056713772, 155.55807909203733, -55.79525792250436, 5.322628421338257, -75.61412799917211, -16.99464372535428, -102.11918873663834, -101.1725177089311, -35.61127672352919, 64.6267006748201, -152.34272999779202, -0.317066125054122, -36.38099439541248, -55.94519297375708, -146.6420689408723, -301.57008044605135, -151.3036632075689, -568.8057223201024, -3.622830688208765, -187.77892224687645, -213.26988066791228, -24.292139610782698, 66.37540120673386, 26.443324963728244, -19.628514881076047, -148.71258871305403, -174.41443408275325, -51.320089486886026, 6.904584303456419, -208.93741526286954, -115.67526449861236, 60.313253904381675, -113.33212972380593, -34.80106005218285, -46.83169917285824, -137.11538553720854, -56.531791108155076, -16.419932451189332, -299.5906052763954, -73.2640463153928, -70.73948040090478, 2.202712180812611, 33.27342834240416, -261.30347679485965, -325.48126495335407, 98.3280098049848, 105.78579032077133, -81.10964841060513, -57.98239883242479, -97.95512863701177, -122.73902449472614, -40.18375914157757, 3.0877466029388168, -93.06483909555249, -1.7158094227592964, -18.91889400086918, -67.1766993241661, -78.20085643035374, -252.23123544127063, -557.911345235587, -30.1491055660406, -26.312403824411565, -158.59103919571137, 31.522807567311283, -18.558157053650636, 38.343716980080416, -5.230840134282634, -8.72430030222931, -65.27772282743969, 26.60080548637186, 105.33169062925768, -547.0949243142518], "policy_predator_policy_reward": [37.696703878335896, 15.449665598881413, 4.080583120168974, 73.43512821053882, 192.49621543660555, 169.2059517780261, 80.11450475839376, 97.09857644925322, 3.3597552944756783, 17.63443196999565, 3.793332081271741, 15.802139527850386, 1.2263817696318802, 26.774802814385268, 58.62587747109764, 247.82523587819676, 45.84262779898942, 29.30882016288401, 153.5114328583207, 68.4458065989403, 125.37957578627196, 76.6258871891636, 124.35889277026426, 79.06331776396584, 281.84253326475675, 57.73945992543843, 147.32898083744107, 18.62095299518637, 18.4924258587447, 88.31409492545816, 113.30636690506115, 114.43820031163285, 22.020722772486902, 34.336862874638314, 82.93946235356303, 79.68079340661092, 41.309668898749635, 27.161049816227827, 220.60149414092893, 5.683449669269821, 157.4309034395978, 39.70359839149352, 125.14130992239377, 175.7049339999976, 8.12222010997852, 244.86283353200778, 45.617900951910485, 8.897836227912014, 476.48710520659, 275.8757112790851, 18.423733859933908, 25.502867775623407, 95.5020475649159, 1.9489130484588402, 56.5867404987287, 42.02817275385411, 9.244460883074819, 141.39758185663482, 14.957199961568518, 24.115901556517468, 19.163177047155926, 44.925749881561615, 32.891098790678925, 282.65082085078717, 35.55578478668154, 32.720068474414894, 108.950585548944, 35.5944192340017, 15.025446775488934, 0.8766586027207689, 284.6239181771893, 98.77100444137105, 21.24098893253794, 22.250778736926204, 19.140685776863428, 113.89751374096116, 50.34883304790717, 82.55838909540411, 28.381639999911616, 35.932255828506776, 35.74077398178843, 95.89468798333212, 34.47574640431642, 9.80613703662084, 3.8107013170381983, 82.40028132624805, 7.95127476659878, 192.28640590033214, 10.451586258863548, 72.11958756160652, 110.24412662075659, 85.07294630977638, 76.85604689236231, 49.97307486173755, 206.55084401626877, 14.821259542335218, 22.64161551496599, 19.58207990559648, 111.86619214062299, 192.1082559266376, 46.76874042883705, 0.0, 150.29360072602927, 156.28534801838046, 245.25619679954684, 154.01478773708254, 132.22791429875682, 137.7493870577012, 12.332216845780767, 37.470669816688954, 23.402962211512158, 23.314702502848682, 51.01729223524183, 62.7298136417684, 7.960600188247197, 11.67231632769093, 141.01437001353835, 6.0531188485087455, 84.6299095427842, 358.4556683510688, 227.51527336292898, 15.108658974340912, 380.86117407924417, 295.11818673686946, 137.89476166985114, 43.06723946880618, 43.556490973264445, 52.22925177561587, 160.0179905671372, 21.491920907962662, 94.9707015730826, 94.90462316075116, 86.81455494541699, 72.48890322409943, 103.64918873663902, 102.82251770893194, 155.96557673087273, 8.846153824133884, 153.73272999779076, 2.2970661250541173, 38.160994395412125, 57.72519297375673, 278.19229242088124, 264.1878345278918, 415.0739503311119, 553.2704254996934, 35.122830688208694, 188.72892224687558, 252.1185527092848, 90.62346756940954, 14.237377025728081, 45.9338968038099, 21.538514881076345, 208.71258871305412, 183.6705992226076, 4.025728679318613, 282.05982570143374, 64.45331716804127, 116.88526449861276, 16.85674609561811, 90.13711195551583, 84.65607782047245, 80.35196699864608, 150.2863650999361, 58.16179110815504, 78.5199324511895, 340.2383307896137, 26.566669068537294, 77.29948040090551, 68.7272878191874, 213.39838344599474, 216.41371882203396, 325.81126495335405, 31.221990195015472, 112.96406647053082, 39.32834566569725, 98.95018706030591, 59.01101179431285, 148.63902449472664, 50.364389512475654, 27.0525106248285, 95.68465667517518, 3.6758094227592624, 20.788894000869462, 69.00669932416703, 114.07085643035416, 135.59513890088266, 619.2478692780039, 22.353971459481137, 29.3646438261919, 101.07275159463187, 117.86003563444754, 20.408157053650925, 15.976283019919322, 1.1918343697827696, 16.6133060667291, 74.40833316624486, 2.2335862323444795, 32.018309370742486, 547.3849243142517]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.932634690900812, "mean_inference_ms": 2.5128570994801755, "mean_action_processing_ms": 0.3685881058318847, "mean_env_wait_ms": 0.32934101282127703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006367921829223633, "StateBufferConnector_ms": 0.0031925439834594727, "ViewRequirementAgentConnector_ms": 0.12685120105743408}, "num_episodes": 22, "episode_return_max": 253.899594264613, "episode_return_min": -55.29957249797109, "episode_return_mean": 72.4105250431414, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 261.4407407474357, "num_env_steps_trained_throughput_per_sec": 261.4407407474357, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 14066.716, "restore_workers_time_ms": 0.052, "training_step_time_ms": 14066.56, "sample_time_ms": 1852.179, "learn_time_ms": 12197.228, "learn_throughput": 327.943, "synch_weights_time_ms": 13.969}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 9, "trial_id": "61e09_00000", "date": "2024-08-16_16-08-44", "timestamp": 1723804724, "time_this_iter_s": 15.347095012664795, "time_total_s": 126.9922730922699, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b25341f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 126.9922730922699, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 62.036363636363646, "ram_util_percent": 82.17727272727272}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.206248888672975, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.630634024029686, "policy_loss": -0.013535946474050877, "vf_loss": 4.641582455963054, "vf_explained_var": 0.002840075070265109, "kl": 0.01293758606163913, "entropy": 1.4869827455944484, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.771522758372877, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.027489382880074, "policy_loss": -0.007705629376014547, "vf_loss": 6.033683560638831, "vf_explained_var": 0.03093072876097664, "kl": 0.007557316978674761, "entropy": 1.4946242054303487, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 248.23499030313496, "episode_reward_min": -260.0804712518504, "episode_reward_mean": 60.824050316471904, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -833.272550462457, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 155.55807909203733, "predator_policy": 830.587775585948}, "policy_reward_mean": {"prey_policy": -82.19478191147337, "predator_policy": 112.60680706970929}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.6799999999999646, 18.930000000000046, 15.649999999999922, 22.330000000000187, 9.409999999999927, 3.229999999999975, 47.33999999999944, 15.605336762459835, 33.80000000000009, 23.01796001596217, 54.839999999999506, 50.42999999999942, 19.040000000000102, 17.440000000000182, 1.9524827062950185, 175.43999999999983, 35.32999999999941, 126.96000000000069, 84.91000000000109, 3.619999999999965, 73.93999999999998, 93.3800000000005, 75.22000000000077, 125.72000000000043, 73.6918721211706, 144.23000000000013, 63.55195210619177, 10.609999999999925, 51.0966790479463, 101.93998181364395, 80.56078902602847, 83.85000000000126, 25.470000000000294, 88.71550299977557, 68.20552456453424, -19.404774875631524, 40.05940244665633, 69.74999999999974, 113.56395735610452, 185.64542497750773, 88.98725216377468, 178.1899999999997, 139.4026952326672, 66.69468644498987, 3.1799999999999704, 193.8271545062963, 3.369999999999968, 3.559999999999966, 94.16797756185046, 248.23499030313496, 32.450000000000166, 105.18000000000049, 152.98999999999987, 61.90999999999975, -38.03819566771353, 144.48031191006174, 78.380000000001, 26.660000000000405, 46.69124738851589, 63.72999999999959, -6.049651733637116, 77.49000000000096, 201.78205381557285, 129.88000000000005, 176.96855404639268, 2.0236713851817716, 36.08063037089814, 32.760074807389444, 3.8299999999999623, 37.699999999999676, -55.29957249797109, -4.742894104779747, 91.86455560068129, 56.16999999999944, 3.8499999999999623, 37.96500205751985, 137.63999999999967, 59.4399999999994, -43.44218401666123, 102.58000000000011, 111.16693815776007, 101.63343821649441, 129.629999999999, -260.0804712518504, 38.315853715776825, 171.73999999999887, 67.43000000000058, 140.34207876189794, 83.06392902335745, -103.5389389410739, 74.89795653042763, 74.77000000000042, 85.25000000000014, 3.9999999999999587, 71.94000000000095, 171.73999999999887, -144.184432802739, 3.209999999999976, 130.8782295943281, 44.90999999999957], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-43.84790095191084, -6.987836227912048, -458.46710520659, -274.9657112790857, -4.683733859933949, -23.59286777562311, -75.15204756491521, 0.03108695154116143, -64.15586828527726, -25.049044967304507, -7.334460883074858, -140.07758185663593, -13.057199961568559, 21.32409844348275, -45.59892692871782, -2.8846632375401358, -31.111098790678806, -250.63082085078742, 2.0000000000000013, -47.25789324513521, -65.20070384919404, -24.504300933750798, 33.41455322451079, 1.1133413972792323, -352.38416088110336, -11.970761737456955, -19.47098893253768, -6.580778736926238, -6.449522524027316, -124.636194287502, 100.7811669520928, -58.24838909540418, -25.591639999911337, -3.3922558285068085, -33.93077398178879, 29.255312016667858, 48.54425359568338, -7.91613703662088, -1.8407013170382367, -80.7502813262472, -6.01127476659882, -120.28640590033197, -8.53158625886359, 19.34041243839357, -107.12339999822088, -12.973672932311363, -35.27349896433194, 34.16437721023174, -140.29308438648897, -7.387147050944497, -20.801615514965725, 122.80792009440358, -173.7759768498491, -66.64651911121943, -38.158740428837355, 2.0000000000000013, -63.01872319965528, -192.4635464968081, -298.2831824437531, 0.9521797207675621, -162.53500293726287, -26.88150939316645, 50.17330052619922, -16.126187188668915, -4.682962211512086, -16.56470250284849, 39.7050728518054, -64.7366757290412, 47.58919410251294, 0.9834139460817065, -33.116400781823785, -133.355862955855, -61.06830521540581, -341.95787023179116, -200.21527336292897, 27.34134102565931, -214.8310814939729, -347.58432196603644, 30.143245829167817, -25.45982199031745, -3.7047997007193025, -3.09369088438741, -158.87799056713772, 155.55807909203733, -55.79525792250436, 5.322628421338257, -75.61412799917211, -16.99464372535428, -102.11918873663834, -101.1725177089311, -35.61127672352919, 64.6267006748201, -152.34272999779202, -0.317066125054122, -36.38099439541248, -55.94519297375708, -146.6420689408723, -301.57008044605135, -151.3036632075689, -568.8057223201024, -3.622830688208765, -187.77892224687645, -213.26988066791228, -24.292139610782698, 66.37540120673386, 26.443324963728244, -19.628514881076047, -148.71258871305403, -174.41443408275325, -51.320089486886026, 6.904584303456419, -208.93741526286954, -115.67526449861236, 60.313253904381675, -113.33212972380593, -34.80106005218285, -46.83169917285824, -137.11538553720854, -56.531791108155076, -16.419932451189332, -299.5906052763954, -73.2640463153928, -70.73948040090478, 2.202712180812611, 33.27342834240416, -261.30347679485965, -325.48126495335407, 98.3280098049848, 105.78579032077133, -81.10964841060513, -57.98239883242479, -97.95512863701177, -122.73902449472614, -40.18375914157757, 3.0877466029388168, -93.06483909555249, -1.7158094227592964, -18.91889400086918, -67.1766993241661, -78.20085643035374, -252.23123544127063, -557.911345235587, -30.1491055660406, -26.312403824411565, -158.59103919571137, 31.522807567311283, -18.558157053650636, 38.343716980080416, -5.230840134282634, -8.72430030222931, -65.27772282743969, 26.60080548637186, 105.33169062925768, -547.0949243142518, 57.43999999999971, 2.0000000000000013, -96.28698294559092, -341.62208899132725, -44.47148765875425, -329.3546196557747, -39.47715731264247, -13.461157723342525, 6.548769589023294, -63.47468264171996, 52.67922386406216, 54.36551420784128, -571.5861043051093, -657.8162034812218, -33.166221464953956, -120.6989978175997, -8.927302595736592, 60.6409385195032, 52.972404761764686, -760.3017403678962, 60.24153286974843, -4.899007716876394, -47.8151711357469, -52.449897671716, -833.272550462457, -704.8631191442381, -199.27301010568382, 4.312814866000133, -5.88035658273804, -4.149440731533801, -1.0801428010456027, -170.1306399774418, 2.0000000000000013, 2.0000000000000013, 37.639999999999674, -13.50958992597883, 36.09098539951931, 41.70528813686598, -331.50123127244115, -386.79467571634484, 2.0000000000000013, -110.98055779400485, -152.35276695986767, 37.74132693673341, -144.00442670409655, 8.929999999999962], "policy_predator_policy_reward": [45.617900951910485, 8.897836227912014, 476.48710520659, 275.8757112790851, 18.423733859933908, 25.502867775623407, 95.5020475649159, 1.9489130484588402, 56.5867404987287, 42.02817275385411, 9.244460883074819, 141.39758185663482, 14.957199961568518, 24.115901556517468, 19.163177047155926, 44.925749881561615, 32.891098790678925, 282.65082085078717, 35.55578478668154, 32.720068474414894, 108.950585548944, 35.5944192340017, 15.025446775488934, 0.8766586027207689, 284.6239181771893, 98.77100444137105, 21.24098893253794, 22.250778736926204, 19.140685776863428, 113.89751374096116, 50.34883304790717, 82.55838909540411, 28.381639999911616, 35.932255828506776, 35.74077398178843, 95.89468798333212, 34.47574640431642, 9.80613703662084, 3.8107013170381983, 82.40028132624805, 7.95127476659878, 192.28640590033214, 10.451586258863548, 72.11958756160652, 110.24412662075659, 85.07294630977638, 76.85604689236231, 49.97307486173755, 206.55084401626877, 14.821259542335218, 22.64161551496599, 19.58207990559648, 111.86619214062299, 192.1082559266376, 46.76874042883705, 0.0, 150.29360072602927, 156.28534801838046, 245.25619679954684, 154.01478773708254, 132.22791429875682, 137.7493870577012, 12.332216845780767, 37.470669816688954, 23.402962211512158, 23.314702502848682, 51.01729223524183, 62.7298136417684, 7.960600188247197, 11.67231632769093, 141.01437001353835, 6.0531188485087455, 84.6299095427842, 358.4556683510688, 227.51527336292898, 15.108658974340912, 380.86117407924417, 295.11818673686946, 137.89476166985114, 43.06723946880618, 43.556490973264445, 52.22925177561587, 160.0179905671372, 21.491920907962662, 94.9707015730826, 94.90462316075116, 86.81455494541699, 72.48890322409943, 103.64918873663902, 102.82251770893194, 155.96557673087273, 8.846153824133884, 153.73272999779076, 2.2970661250541173, 38.160994395412125, 57.72519297375673, 278.19229242088124, 264.1878345278918, 415.0739503311119, 553.2704254996934, 35.122830688208694, 188.72892224687558, 252.1185527092848, 90.62346756940954, 14.237377025728081, 45.9338968038099, 21.538514881076345, 208.71258871305412, 183.6705992226076, 4.025728679318613, 282.05982570143374, 64.45331716804127, 116.88526449861276, 16.85674609561811, 90.13711195551583, 84.65607782047245, 80.35196699864608, 150.2863650999361, 58.16179110815504, 78.5199324511895, 340.2383307896137, 26.566669068537294, 77.29948040090551, 68.7272878191874, 213.39838344599474, 216.41371882203396, 325.81126495335405, 31.221990195015472, 112.96406647053082, 39.32834566569725, 98.95018706030591, 59.01101179431285, 148.63902449472664, 50.364389512475654, 27.0525106248285, 95.68465667517518, 3.6758094227592624, 20.788894000869462, 69.00669932416703, 114.07085643035416, 135.59513890088266, 619.2478692780039, 22.353971459481137, 29.3646438261919, 101.07275159463187, 117.86003563444754, 20.408157053650925, 15.976283019919322, 1.1918343697827696, 16.6133060667291, 74.40833316624486, 2.2335862323444795, 32.018309370742486, 547.3849243142517, 0.0, 0.0, 44.175866740795385, 350.29102117946184, 146.57148765875422, 329.8346196557746, 36.56265799886666, 127.54259519487724, 120.42220768800247, 38.13714358118766, 0.9984271050085901, 21.58683482308745, 315.0632252025897, 654.2586113318914, 125.65955423872057, 66.52151875961081, 111.83391040992932, 8.192453666303892, 14.237595238235087, 760.5217403678962, 23.04446041701423, 61.95509319201183, 81.26966850073939, 102.05932933008062, 830.587775585948, 604.008955079673, 263.65383237972935, 6.204319390381296, 58.363869966322234, 26.435927347949598, 12.025964553908855, 244.43481822457844, 0.0, 0.0, 0.0, 47.80958992597881, 68.99973231599887, 24.94399414761566, 82.89063714709863, 491.220837038948, 0.0, 112.19055779400493, 138.4181308985446, 107.07153871891806, 98.72866777802082, 81.25575892607525]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8906203825051985, "mean_inference_ms": 2.4227759606824866, "mean_action_processing_ms": 0.3574169487166789, "mean_env_wait_ms": 0.31961878935061794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005746126174926758, "StateBufferConnector_ms": 0.004565119743347168, "ViewRequirementAgentConnector_ms": 0.1282864809036255}, "num_episodes": 23, "episode_return_max": 248.23499030313496, "episode_return_min": -260.0804712518504, "episode_return_mean": 60.824050316471904, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 256.17283535901237, "num_env_steps_trained_throughput_per_sec": 256.17283535901237, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 14221.492, "restore_workers_time_ms": 0.048, "training_step_time_ms": 14221.346, "sample_time_ms": 1838.772, "learn_time_ms": 12365.171, "learn_throughput": 323.489, "synch_weights_time_ms": 14.391}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 10, "trial_id": "61e09_00000", "date": "2024-08-16_16-09-00", "timestamp": 1723804740, "time_this_iter_s": 15.65441107749939, "time_total_s": 142.6466841697693, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24be160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 142.6466841697693, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 60.4090909090909, "ram_util_percent": 82.12272727272729}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2379406890541158, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.155146429273818, "policy_loss": -0.014277236076643465, "vf_loss": 5.166696106693732, "vf_explained_var": 0.0021920294673354536, "kl": 0.01363785113064979, "entropy": 1.4778364906235346, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7892958731563002, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.302286453095693, "policy_loss": -0.01036231278567501, "vf_loss": 6.310196797809904, "vf_explained_var": 0.03509882612833901, "kl": 0.012259809746362007, "entropy": 1.50688848659475, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 396.9868151226862, "episode_reward_min": -260.0804712518504, "episode_reward_mean": 69.40210637161056, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -833.272550462457, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 155.55807909203733, "predator_policy": 830.587775585948}, "policy_reward_mean": {"prey_policy": -89.13895437986547, "predator_policy": 123.84000756567066}, "custom_metrics": {}, "hist_stats": {"episode_reward": [84.91000000000109, 3.619999999999965, 73.93999999999998, 93.3800000000005, 75.22000000000077, 125.72000000000043, 73.6918721211706, 144.23000000000013, 63.55195210619177, 10.609999999999925, 51.0966790479463, 101.93998181364395, 80.56078902602847, 83.85000000000126, 25.470000000000294, 88.71550299977557, 68.20552456453424, -19.404774875631524, 40.05940244665633, 69.74999999999974, 113.56395735610452, 185.64542497750773, 88.98725216377468, 178.1899999999997, 139.4026952326672, 66.69468644498987, 3.1799999999999704, 193.8271545062963, 3.369999999999968, 3.559999999999966, 94.16797756185046, 248.23499030313496, 32.450000000000166, 105.18000000000049, 152.98999999999987, 61.90999999999975, -38.03819566771353, 144.48031191006174, 78.380000000001, 26.660000000000405, 46.69124738851589, 63.72999999999959, -6.049651733637116, 77.49000000000096, 201.78205381557285, 129.88000000000005, 176.96855404639268, 2.0236713851817716, 36.08063037089814, 32.760074807389444, 3.8299999999999623, 37.699999999999676, -55.29957249797109, -4.742894104779747, 91.86455560068129, 56.16999999999944, 3.8499999999999623, 37.96500205751985, 137.63999999999967, 59.4399999999994, -43.44218401666123, 102.58000000000011, 111.16693815776007, 101.63343821649441, 129.629999999999, -260.0804712518504, 38.315853715776825, 171.73999999999887, 67.43000000000058, 140.34207876189794, 83.06392902335745, -103.5389389410739, 74.89795653042763, 74.77000000000042, 85.25000000000014, 3.9999999999999587, 71.94000000000095, 171.73999999999887, -144.184432802739, 3.209999999999976, 130.8782295943281, 44.90999999999957, 94.80802814917615, 123.03127277307772, 47.61999999999983, 70.61867196614114, -29.48414746636452, 396.9868151226862, 4.6053183879280315, 283.0247561121779, 85.34482042562244, 168.44001330116538, 26.700869311084205, 11.425019083557185, 97.2200000000007, 32.60975671763678, 162.55999999999977, 78.09000000000106, -139.17980888530926, 17.810000000000265], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [48.54425359568338, -7.91613703662088, -1.8407013170382367, -80.7502813262472, -6.01127476659882, -120.28640590033197, -8.53158625886359, 19.34041243839357, -107.12339999822088, -12.973672932311363, -35.27349896433194, 34.16437721023174, -140.29308438648897, -7.387147050944497, -20.801615514965725, 122.80792009440358, -173.7759768498491, -66.64651911121943, -38.158740428837355, 2.0000000000000013, -63.01872319965528, -192.4635464968081, -298.2831824437531, 0.9521797207675621, -162.53500293726287, -26.88150939316645, 50.17330052619922, -16.126187188668915, -4.682962211512086, -16.56470250284849, 39.7050728518054, -64.7366757290412, 47.58919410251294, 0.9834139460817065, -33.116400781823785, -133.355862955855, -61.06830521540581, -341.95787023179116, -200.21527336292897, 27.34134102565931, -214.8310814939729, -347.58432196603644, 30.143245829167817, -25.45982199031745, -3.7047997007193025, -3.09369088438741, -158.87799056713772, 155.55807909203733, -55.79525792250436, 5.322628421338257, -75.61412799917211, -16.99464372535428, -102.11918873663834, -101.1725177089311, -35.61127672352919, 64.6267006748201, -152.34272999779202, -0.317066125054122, -36.38099439541248, -55.94519297375708, -146.6420689408723, -301.57008044605135, -151.3036632075689, -568.8057223201024, -3.622830688208765, -187.77892224687645, -213.26988066791228, -24.292139610782698, 66.37540120673386, 26.443324963728244, -19.628514881076047, -148.71258871305403, -174.41443408275325, -51.320089486886026, 6.904584303456419, -208.93741526286954, -115.67526449861236, 60.313253904381675, -113.33212972380593, -34.80106005218285, -46.83169917285824, -137.11538553720854, -56.531791108155076, -16.419932451189332, -299.5906052763954, -73.2640463153928, -70.73948040090478, 2.202712180812611, 33.27342834240416, -261.30347679485965, -325.48126495335407, 98.3280098049848, 105.78579032077133, -81.10964841060513, -57.98239883242479, -97.95512863701177, -122.73902449472614, -40.18375914157757, 3.0877466029388168, -93.06483909555249, -1.7158094227592964, -18.91889400086918, -67.1766993241661, -78.20085643035374, -252.23123544127063, -557.911345235587, -30.1491055660406, -26.312403824411565, -158.59103919571137, 31.522807567311283, -18.558157053650636, 38.343716980080416, -5.230840134282634, -8.72430030222931, -65.27772282743969, 26.60080548637186, 105.33169062925768, -547.0949243142518, 57.43999999999971, 2.0000000000000013, -96.28698294559092, -341.62208899132725, -44.47148765875425, -329.3546196557747, -39.47715731264247, -13.461157723342525, 6.548769589023294, -63.47468264171996, 52.67922386406216, 54.36551420784128, -571.5861043051093, -657.8162034812218, -33.166221464953956, -120.6989978175997, -8.927302595736592, 60.6409385195032, 52.972404761764686, -760.3017403678962, 60.24153286974843, -4.899007716876394, -47.8151711357469, -52.449897671716, -833.272550462457, -704.8631191442381, -199.27301010568382, 4.312814866000133, -5.88035658273804, -4.149440731533801, -1.0801428010456027, -170.1306399774418, 2.0000000000000013, 2.0000000000000013, 37.639999999999674, -13.50958992597883, 36.09098539951931, 41.70528813686598, -331.50123127244115, -386.79467571634484, 2.0000000000000013, -110.98055779400485, -152.35276695986767, 37.74132693673341, -144.00442670409655, 8.929999999999962, -2.9270882444222384, 28.81257739043694, -8.446283625740863, 49.48108575385716, -462.86282009029185, -8.445614744942468, 70.23867196614103, -403.4518361808045, -273.2516660479052, -161.85830400377648, 112.16115315255723, -548.9947563585118, 2.0000000000000013, -35.82124245723193, 140.28086322681654, 72.36218365907494, -61.87156455476751, 9.39770180542001, -30.41668800580174, 16.05501252790371, -48.33195112863897, -107.89776093667092, -131.44969360146746, -43.60652061937441, 34.02907387157225, -85.14809689247085, -35.01089864671046, -35.121332363489216, 154.39787107977045, -471.98068735865024, 36.09863303542282, -135.95336777041416, -186.31585047671447, -662.9790686379837, -1.184316852453866, -230.11758522338155], "policy_predator_policy_reward": [34.47574640431642, 9.80613703662084, 3.8107013170381983, 82.40028132624805, 7.95127476659878, 192.28640590033214, 10.451586258863548, 72.11958756160652, 110.24412662075659, 85.07294630977638, 76.85604689236231, 49.97307486173755, 206.55084401626877, 14.821259542335218, 22.64161551496599, 19.58207990559648, 111.86619214062299, 192.1082559266376, 46.76874042883705, 0.0, 150.29360072602927, 156.28534801838046, 245.25619679954684, 154.01478773708254, 132.22791429875682, 137.7493870577012, 12.332216845780767, 37.470669816688954, 23.402962211512158, 23.314702502848682, 51.01729223524183, 62.7298136417684, 7.960600188247197, 11.67231632769093, 141.01437001353835, 6.0531188485087455, 84.6299095427842, 358.4556683510688, 227.51527336292898, 15.108658974340912, 380.86117407924417, 295.11818673686946, 137.89476166985114, 43.06723946880618, 43.556490973264445, 52.22925177561587, 160.0179905671372, 21.491920907962662, 94.9707015730826, 94.90462316075116, 86.81455494541699, 72.48890322409943, 103.64918873663902, 102.82251770893194, 155.96557673087273, 8.846153824133884, 153.73272999779076, 2.2970661250541173, 38.160994395412125, 57.72519297375673, 278.19229242088124, 264.1878345278918, 415.0739503311119, 553.2704254996934, 35.122830688208694, 188.72892224687558, 252.1185527092848, 90.62346756940954, 14.237377025728081, 45.9338968038099, 21.538514881076345, 208.71258871305412, 183.6705992226076, 4.025728679318613, 282.05982570143374, 64.45331716804127, 116.88526449861276, 16.85674609561811, 90.13711195551583, 84.65607782047245, 80.35196699864608, 150.2863650999361, 58.16179110815504, 78.5199324511895, 340.2383307896137, 26.566669068537294, 77.29948040090551, 68.7272878191874, 213.39838344599474, 216.41371882203396, 325.81126495335405, 31.221990195015472, 112.96406647053082, 39.32834566569725, 98.95018706030591, 59.01101179431285, 148.63902449472664, 50.364389512475654, 27.0525106248285, 95.68465667517518, 3.6758094227592624, 20.788894000869462, 69.00669932416703, 114.07085643035416, 135.59513890088266, 619.2478692780039, 22.353971459481137, 29.3646438261919, 101.07275159463187, 117.86003563444754, 20.408157053650925, 15.976283019919322, 1.1918343697827696, 16.6133060667291, 74.40833316624486, 2.2335862323444795, 32.018309370742486, 547.3849243142517, 0.0, 0.0, 44.175866740795385, 350.29102117946184, 146.57148765875422, 329.8346196557746, 36.56265799886666, 127.54259519487724, 120.42220768800247, 38.13714358118766, 0.9984271050085901, 21.58683482308745, 315.0632252025897, 654.2586113318914, 125.65955423872057, 66.52151875961081, 111.83391040992932, 8.192453666303892, 14.237595238235087, 760.5217403678962, 23.04446041701423, 61.95509319201183, 81.26966850073939, 102.05932933008062, 830.587775585948, 604.008955079673, 263.65383237972935, 6.204319390381296, 58.363869966322234, 26.435927347949598, 12.025964553908855, 244.43481822457844, 0.0, 0.0, 0.0, 47.80958992597881, 68.99973231599887, 24.94399414761566, 82.89063714709863, 491.220837038948, 0.0, 112.19055779400493, 138.4181308985446, 107.07153871891806, 98.72866777802082, 81.25575892607525, 1.6835524117672116, 67.23898659139324, 59.76754384052741, 22.228926804433485, 463.4728200902918, 55.455614744942444, 0.0, 403.8318361808043, 368.2976205714282, 37.32820201388683, 344.7387107005573, 489.08170762808425, 0.7553183879280865, 37.671242457231564, 11.756054130503625, 58.62565509578314, 110.8222514730038, 26.996431701964738, 110.64846796588243, 72.15322081318133, 47.85388730630058, 135.07669407009354, 99.07514668392473, 87.40608662047299, 61.750926128427636, 86.58809689247128, 26.764267728210932, 75.97771999962502, 7.902128920229514, 472.2406873586504, 167.37392581830983, 10.57080891668116, 23.724224148836225, 686.3908860805531, 235.21872302801071, 13.893179047823965]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8678671805692821, "mean_inference_ms": 2.3789169172677065, "mean_action_processing_ms": 0.3491167894908571, "mean_env_wait_ms": 0.3128594003705663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005824446678161621, "StateBufferConnector_ms": 0.004531741142272949, "ViewRequirementAgentConnector_ms": 0.12605774402618408}, "num_episodes": 18, "episode_return_max": 396.9868151226862, "episode_return_min": -260.0804712518504, "episode_return_mean": 69.40210637161056, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 252.02277708580186, "num_env_steps_trained_throughput_per_sec": 252.02277708580186, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 14097.144, "restore_workers_time_ms": 0.048, "training_step_time_ms": 14096.999, "sample_time_ms": 1653.888, "learn_time_ms": 12424.275, "learn_throughput": 321.95, "synch_weights_time_ms": 16.89}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 11, "trial_id": "61e09_00000", "date": "2024-08-16_16-09-16", "timestamp": 1723804756, "time_this_iter_s": 15.910974264144897, "time_total_s": 158.55765843391418, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24bee50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 158.55765843391418, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 56.89130434782608, "ram_util_percent": 82.2086956521739}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2766216922689366, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.013248069954928, "policy_loss": -0.012784236136986505, "vf_loss": 7.023266999683683, "vf_explained_var": 0.004860636166163853, "kl": 0.013826489114805591, "entropy": 1.4557767683866794, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0839247553436846, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.3628115737248985, "policy_loss": -0.008943414726545886, "vf_loss": 7.369596115495793, "vf_explained_var": 0.049676193383635665, "kl": 0.010794390166678828, "entropy": 1.5066757011035132, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 396.9868151226862, "episode_reward_min": -260.0804712518504, "episode_reward_mean": 73.33742976705105, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -833.272550462457, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 155.55807909203733, "predator_policy": 830.587775585948}, "policy_reward_mean": {"prey_policy": -114.04807047686838, "predator_policy": 150.71678536039383}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.05940244665633, 69.74999999999974, 113.56395735610452, 185.64542497750773, 88.98725216377468, 178.1899999999997, 139.4026952326672, 66.69468644498987, 3.1799999999999704, 193.8271545062963, 3.369999999999968, 3.559999999999966, 94.16797756185046, 248.23499030313496, 32.450000000000166, 105.18000000000049, 152.98999999999987, 61.90999999999975, -38.03819566771353, 144.48031191006174, 78.380000000001, 26.660000000000405, 46.69124738851589, 63.72999999999959, -6.049651733637116, 77.49000000000096, 201.78205381557285, 129.88000000000005, 176.96855404639268, 2.0236713851817716, 36.08063037089814, 32.760074807389444, 3.8299999999999623, 37.699999999999676, -55.29957249797109, -4.742894104779747, 91.86455560068129, 56.16999999999944, 3.8499999999999623, 37.96500205751985, 137.63999999999967, 59.4399999999994, -43.44218401666123, 102.58000000000011, 111.16693815776007, 101.63343821649441, 129.629999999999, -260.0804712518504, 38.315853715776825, 171.73999999999887, 67.43000000000058, 140.34207876189794, 83.06392902335745, -103.5389389410739, 74.89795653042763, 74.77000000000042, 85.25000000000014, 3.9999999999999587, 71.94000000000095, 171.73999999999887, -144.184432802739, 3.209999999999976, 130.8782295943281, 44.90999999999957, 94.80802814917615, 123.03127277307772, 47.61999999999983, 70.61867196614114, -29.48414746636452, 396.9868151226862, 4.6053183879280315, 283.0247561121779, 85.34482042562244, 168.44001330116538, 26.700869311084205, 11.425019083557185, 97.2200000000007, 32.60975671763678, 162.55999999999977, 78.09000000000106, -139.17980888530926, 17.810000000000265, 3.0729128282835068, 78.10080253222509, 168.0275381050209, 141.80000000000027, 98.20293194138122, 182.82423080951284, 66.8038148030246, 156.5151740374615, 34.24999999999964, 12.452048241060357, -31.422358164565033, 5.579999999999968, 295.30102094153415, 50.05672040153252, 6.616426800548073, 105.30000000000054, 124.16498741956718, 125.19361565112708], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-61.06830521540581, -341.95787023179116, -200.21527336292897, 27.34134102565931, -214.8310814939729, -347.58432196603644, 30.143245829167817, -25.45982199031745, -3.7047997007193025, -3.09369088438741, -158.87799056713772, 155.55807909203733, -55.79525792250436, 5.322628421338257, -75.61412799917211, -16.99464372535428, -102.11918873663834, -101.1725177089311, -35.61127672352919, 64.6267006748201, -152.34272999779202, -0.317066125054122, -36.38099439541248, -55.94519297375708, -146.6420689408723, -301.57008044605135, -151.3036632075689, -568.8057223201024, -3.622830688208765, -187.77892224687645, -213.26988066791228, -24.292139610782698, 66.37540120673386, 26.443324963728244, -19.628514881076047, -148.71258871305403, -174.41443408275325, -51.320089486886026, 6.904584303456419, -208.93741526286954, -115.67526449861236, 60.313253904381675, -113.33212972380593, -34.80106005218285, -46.83169917285824, -137.11538553720854, -56.531791108155076, -16.419932451189332, -299.5906052763954, -73.2640463153928, -70.73948040090478, 2.202712180812611, 33.27342834240416, -261.30347679485965, -325.48126495335407, 98.3280098049848, 105.78579032077133, -81.10964841060513, -57.98239883242479, -97.95512863701177, -122.73902449472614, -40.18375914157757, 3.0877466029388168, -93.06483909555249, -1.7158094227592964, -18.91889400086918, -67.1766993241661, -78.20085643035374, -252.23123544127063, -557.911345235587, -30.1491055660406, -26.312403824411565, -158.59103919571137, 31.522807567311283, -18.558157053650636, 38.343716980080416, -5.230840134282634, -8.72430030222931, -65.27772282743969, 26.60080548637186, 105.33169062925768, -547.0949243142518, 57.43999999999971, 2.0000000000000013, -96.28698294559092, -341.62208899132725, -44.47148765875425, -329.3546196557747, -39.47715731264247, -13.461157723342525, 6.548769589023294, -63.47468264171996, 52.67922386406216, 54.36551420784128, -571.5861043051093, -657.8162034812218, -33.166221464953956, -120.6989978175997, -8.927302595736592, 60.6409385195032, 52.972404761764686, -760.3017403678962, 60.24153286974843, -4.899007716876394, -47.8151711357469, -52.449897671716, -833.272550462457, -704.8631191442381, -199.27301010568382, 4.312814866000133, -5.88035658273804, -4.149440731533801, -1.0801428010456027, -170.1306399774418, 2.0000000000000013, 2.0000000000000013, 37.639999999999674, -13.50958992597883, 36.09098539951931, 41.70528813686598, -331.50123127244115, -386.79467571634484, 2.0000000000000013, -110.98055779400485, -152.35276695986767, 37.74132693673341, -144.00442670409655, 8.929999999999962, -2.9270882444222384, 28.81257739043694, -8.446283625740863, 49.48108575385716, -462.86282009029185, -8.445614744942468, 70.23867196614103, -403.4518361808045, -273.2516660479052, -161.85830400377648, 112.16115315255723, -548.9947563585118, 2.0000000000000013, -35.82124245723193, 140.28086322681654, 72.36218365907494, -61.87156455476751, 9.39770180542001, -30.41668800580174, 16.05501252790371, -48.33195112863897, -107.89776093667092, -131.44969360146746, -43.60652061937441, 34.02907387157225, -85.14809689247085, -35.01089864671046, -35.121332363489216, 154.39787107977045, -471.98068735865024, 36.09863303542282, -135.95336777041416, -186.31585047671447, -662.9790686379837, -1.184316852453866, -230.11758522338155, -4.611223386550635, -4.462797082695191, -485.6280661054918, -193.68531907108053, -543.3078010022131, -12.24760780708847, -273.4145057609883, 66.8120559487308, -93.9103175565759, -85.13658347072219, 50.3795738315558, -21.345149662135576, -229.0861846364342, -70.10284322517087, -370.3751418889319, 28.53239709804206, 28.9398698938647, -436.5301670552284, -12.778085952660243, -241.0406045318969, -122.332141737629, -193.96196815058747, -95.39728095298986, -561.6705481420806, 41.41381901355996, -568.6020435668598, -34.940000173972884, -400.3367181758519, -278.66673241498773, -216.26286187085262, 53.224070773084655, -446.52736177804996, -382.4270374186804, -275.0203502231766, -39.617276770376236, -30.97495958464855], "policy_predator_policy_reward": [84.6299095427842, 358.4556683510688, 227.51527336292898, 15.108658974340912, 380.86117407924417, 295.11818673686946, 137.89476166985114, 43.06723946880618, 43.556490973264445, 52.22925177561587, 160.0179905671372, 21.491920907962662, 94.9707015730826, 94.90462316075116, 86.81455494541699, 72.48890322409943, 103.64918873663902, 102.82251770893194, 155.96557673087273, 8.846153824133884, 153.73272999779076, 2.2970661250541173, 38.160994395412125, 57.72519297375673, 278.19229242088124, 264.1878345278918, 415.0739503311119, 553.2704254996934, 35.122830688208694, 188.72892224687558, 252.1185527092848, 90.62346756940954, 14.237377025728081, 45.9338968038099, 21.538514881076345, 208.71258871305412, 183.6705992226076, 4.025728679318613, 282.05982570143374, 64.45331716804127, 116.88526449861276, 16.85674609561811, 90.13711195551583, 84.65607782047245, 80.35196699864608, 150.2863650999361, 58.16179110815504, 78.5199324511895, 340.2383307896137, 26.566669068537294, 77.29948040090551, 68.7272878191874, 213.39838344599474, 216.41371882203396, 325.81126495335405, 31.221990195015472, 112.96406647053082, 39.32834566569725, 98.95018706030591, 59.01101179431285, 148.63902449472664, 50.364389512475654, 27.0525106248285, 95.68465667517518, 3.6758094227592624, 20.788894000869462, 69.00669932416703, 114.07085643035416, 135.59513890088266, 619.2478692780039, 22.353971459481137, 29.3646438261919, 101.07275159463187, 117.86003563444754, 20.408157053650925, 15.976283019919322, 1.1918343697827696, 16.6133060667291, 74.40833316624486, 2.2335862323444795, 32.018309370742486, 547.3849243142517, 0.0, 0.0, 44.175866740795385, 350.29102117946184, 146.57148765875422, 329.8346196557746, 36.56265799886666, 127.54259519487724, 120.42220768800247, 38.13714358118766, 0.9984271050085901, 21.58683482308745, 315.0632252025897, 654.2586113318914, 125.65955423872057, 66.52151875961081, 111.83391040992932, 8.192453666303892, 14.237595238235087, 760.5217403678962, 23.04446041701423, 61.95509319201183, 81.26966850073939, 102.05932933008062, 830.587775585948, 604.008955079673, 263.65383237972935, 6.204319390381296, 58.363869966322234, 26.435927347949598, 12.025964553908855, 244.43481822457844, 0.0, 0.0, 0.0, 47.80958992597881, 68.99973231599887, 24.94399414761566, 82.89063714709863, 491.220837038948, 0.0, 112.19055779400493, 138.4181308985446, 107.07153871891806, 98.72866777802082, 81.25575892607525, 1.6835524117672116, 67.23898659139324, 59.76754384052741, 22.228926804433485, 463.4728200902918, 55.455614744942444, 0.0, 403.8318361808043, 368.2976205714282, 37.32820201388683, 344.7387107005573, 489.08170762808425, 0.7553183879280865, 37.671242457231564, 11.756054130503625, 58.62565509578314, 110.8222514730038, 26.996431701964738, 110.64846796588243, 72.15322081318133, 47.85388730630058, 135.07669407009354, 99.07514668392473, 87.40608662047299, 61.750926128427636, 86.58809689247128, 26.764267728210932, 75.97771999962502, 7.902128920229514, 472.2406873586504, 167.37392581830983, 10.57080891668116, 23.724224148836225, 686.3908860805531, 235.21872302801071, 13.893179047823965, 9.270106477405482, 2.8768268201237897, 338.66332842329973, 418.75085928549703, 324.50384847192487, 399.07909844239794, 274.19450576098814, 74.20794405126918, 164.76801433304087, 112.4818186356388, 81.05146879995866, 72.73833784013485, 173.30052012827355, 192.69232253635542, 181.55081979456114, 316.8070990337907, 4.700130106135557, 437.1401670552282, 225.72217720234565, 40.54856152327162, 103.92827578638212, 180.94347593726917, 100.71728095299054, 561.9305481420805, 379.6953022624679, 442.7939432323664, 41.31849485372745, 444.01494389762945, 163.84195403719704, 337.7040670491897, 51.525929226915196, 447.07736177804964, 342.82051971877905, 438.7918553426447, 41.487620590918326, 154.29823141523315]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8503871590243398, "mean_inference_ms": 2.355806127296212, "mean_action_processing_ms": 0.34348643467682094, "mean_env_wait_ms": 0.30746238742289433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005783200263977051, "StateBufferConnector_ms": 0.004481792449951172, "ViewRequirementAgentConnector_ms": 0.13341665267944336}, "num_episodes": 18, "episode_return_max": 396.9868151226862, "episode_return_min": -260.0804712518504, "episode_return_mean": 73.33742976705105, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 259.28640453561303, "num_env_steps_trained_throughput_per_sec": 259.28640453561303, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 14418.154, "restore_workers_time_ms": 0.013, "training_step_time_ms": 14418.08, "sample_time_ms": 1630.553, "learn_time_ms": 12767.933, "learn_throughput": 313.285, "synch_weights_time_ms": 17.627}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 12, "trial_id": "61e09_00000", "date": "2024-08-16_16-09-31", "timestamp": 1723804771, "time_this_iter_s": 15.47111439704895, "time_total_s": 174.02877283096313, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24be280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 174.02877283096313, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 60.98636363636365, "ram_util_percent": 82.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.409357721591122, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.515460179091761, "policy_loss": -0.009057504500794624, "vf_loss": 6.522502450085191, "vf_explained_var": 0.0008664870072924902, "kl": 0.010076152305710778, "entropy": 1.427722181151153, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0843321771218033, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.203874537301441, "policy_loss": -0.009599212362251131, "vf_loss": 8.21124775523231, "vf_explained_var": 0.07848968963143686, "kl": 0.011129996832453195, "entropy": 1.481871460859107, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 396.9868151226862, "episode_reward_min": -260.0804712518504, "episode_reward_mean": 70.89468879115913, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -833.272550462457, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 154.39787107977045, "predator_policy": 830.587775585948}, "policy_reward_mean": {"prey_policy": -124.62893544902091, "predator_policy": 160.07627984460044}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-38.03819566771353, 144.48031191006174, 78.380000000001, 26.660000000000405, 46.69124738851589, 63.72999999999959, -6.049651733637116, 77.49000000000096, 201.78205381557285, 129.88000000000005, 176.96855404639268, 2.0236713851817716, 36.08063037089814, 32.760074807389444, 3.8299999999999623, 37.699999999999676, -55.29957249797109, -4.742894104779747, 91.86455560068129, 56.16999999999944, 3.8499999999999623, 37.96500205751985, 137.63999999999967, 59.4399999999994, -43.44218401666123, 102.58000000000011, 111.16693815776007, 101.63343821649441, 129.629999999999, -260.0804712518504, 38.315853715776825, 171.73999999999887, 67.43000000000058, 140.34207876189794, 83.06392902335745, -103.5389389410739, 74.89795653042763, 74.77000000000042, 85.25000000000014, 3.9999999999999587, 71.94000000000095, 171.73999999999887, -144.184432802739, 3.209999999999976, 130.8782295943281, 44.90999999999957, 94.80802814917615, 123.03127277307772, 47.61999999999983, 70.61867196614114, -29.48414746636452, 396.9868151226862, 4.6053183879280315, 283.0247561121779, 85.34482042562244, 168.44001330116538, 26.700869311084205, 11.425019083557185, 97.2200000000007, 32.60975671763678, 162.55999999999977, 78.09000000000106, -139.17980888530926, 17.810000000000265, 3.0729128282835068, 78.10080253222509, 168.0275381050209, 141.80000000000027, 98.20293194138122, 182.82423080951284, 66.8038148030246, 156.5151740374615, 34.24999999999964, 12.452048241060357, -31.422358164565033, 5.579999999999968, 295.30102094153415, 50.05672040153252, 6.616426800548073, 105.30000000000054, 124.16498741956718, 125.19361565112708, 106.62000000000032, -19.802694973450972, -130.80062189703088, 232.26999999999896, 72.8300000000011, 1.240000000000003, 2.59999999999998, 156.43, 152.0606377954013, 62.52999999999987, 166.00000000000023, 92.22712277684964, 47.36999999999999, 89.04999999999988, 162.84583792506572, 271.4864091810135, 83.72594341037882, -11.79319081443926], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-174.41443408275325, -51.320089486886026, 6.904584303456419, -208.93741526286954, -115.67526449861236, 60.313253904381675, -113.33212972380593, -34.80106005218285, -46.83169917285824, -137.11538553720854, -56.531791108155076, -16.419932451189332, -299.5906052763954, -73.2640463153928, -70.73948040090478, 2.202712180812611, 33.27342834240416, -261.30347679485965, -325.48126495335407, 98.3280098049848, 105.78579032077133, -81.10964841060513, -57.98239883242479, -97.95512863701177, -122.73902449472614, -40.18375914157757, 3.0877466029388168, -93.06483909555249, -1.7158094227592964, -18.91889400086918, -67.1766993241661, -78.20085643035374, -252.23123544127063, -557.911345235587, -30.1491055660406, -26.312403824411565, -158.59103919571137, 31.522807567311283, -18.558157053650636, 38.343716980080416, -5.230840134282634, -8.72430030222931, -65.27772282743969, 26.60080548637186, 105.33169062925768, -547.0949243142518, 57.43999999999971, 2.0000000000000013, -96.28698294559092, -341.62208899132725, -44.47148765875425, -329.3546196557747, -39.47715731264247, -13.461157723342525, 6.548769589023294, -63.47468264171996, 52.67922386406216, 54.36551420784128, -571.5861043051093, -657.8162034812218, -33.166221464953956, -120.6989978175997, -8.927302595736592, 60.6409385195032, 52.972404761764686, -760.3017403678962, 60.24153286974843, -4.899007716876394, -47.8151711357469, -52.449897671716, -833.272550462457, -704.8631191442381, -199.27301010568382, 4.312814866000133, -5.88035658273804, -4.149440731533801, -1.0801428010456027, -170.1306399774418, 2.0000000000000013, 2.0000000000000013, 37.639999999999674, -13.50958992597883, 36.09098539951931, 41.70528813686598, -331.50123127244115, -386.79467571634484, 2.0000000000000013, -110.98055779400485, -152.35276695986767, 37.74132693673341, -144.00442670409655, 8.929999999999962, -2.9270882444222384, 28.81257739043694, -8.446283625740863, 49.48108575385716, -462.86282009029185, -8.445614744942468, 70.23867196614103, -403.4518361808045, -273.2516660479052, -161.85830400377648, 112.16115315255723, -548.9947563585118, 2.0000000000000013, -35.82124245723193, 140.28086322681654, 72.36218365907494, -61.87156455476751, 9.39770180542001, -30.41668800580174, 16.05501252790371, -48.33195112863897, -107.89776093667092, -131.44969360146746, -43.60652061937441, 34.02907387157225, -85.14809689247085, -35.01089864671046, -35.121332363489216, 154.39787107977045, -471.98068735865024, 36.09863303542282, -135.95336777041416, -186.31585047671447, -662.9790686379837, -1.184316852453866, -230.11758522338155, -4.611223386550635, -4.462797082695191, -485.6280661054918, -193.68531907108053, -543.3078010022131, -12.24760780708847, -273.4145057609883, 66.8120559487308, -93.9103175565759, -85.13658347072219, 50.3795738315558, -21.345149662135576, -229.0861846364342, -70.10284322517087, -370.3751418889319, 28.53239709804206, 28.9398698938647, -436.5301670552284, -12.778085952660243, -241.0406045318969, -122.332141737629, -193.96196815058747, -95.39728095298986, -561.6705481420806, 41.41381901355996, -568.6020435668598, -34.940000173972884, -400.3367181758519, -278.66673241498773, -216.26286187085262, 53.224070773084655, -446.52736177804996, -382.4270374186804, -275.0203502231766, -39.617276770376236, -30.97495958464855, -54.678815241026825, -90.5342948739592, -293.3787982452499, -99.32714471173537, -543.5597254945175, -561.7775217832983, 147.33718670093972, 32.87230850384011, -55.87325642685575, 67.37190119672823, -542.0006049560449, -327.57663156482323, -176.50915601327924, -195.7558515217633, -122.56618753467855, 85.83046349750762, 11.714769933050409, -151.7666595809348, -70.83984213047147, -229.8477508923223, 122.44906909560699, -267.1548318685955, 10.639590670309756, -130.95669444517156, -396.4351397177162, -240.89660838997068, 10.43249688619067, -197.5346208653347, -6.343734596289615, 83.2334284096494, 31.214651030171908, -295.3647931213601, -265.76930863483415, -96.0064367131531, -487.06198310665974, -198.65431015431994], "policy_predator_policy_reward": [183.6705992226076, 4.025728679318613, 282.05982570143374, 64.45331716804127, 116.88526449861276, 16.85674609561811, 90.13711195551583, 84.65607782047245, 80.35196699864608, 150.2863650999361, 58.16179110815504, 78.5199324511895, 340.2383307896137, 26.566669068537294, 77.29948040090551, 68.7272878191874, 213.39838344599474, 216.41371882203396, 325.81126495335405, 31.221990195015472, 112.96406647053082, 39.32834566569725, 98.95018706030591, 59.01101179431285, 148.63902449472664, 50.364389512475654, 27.0525106248285, 95.68465667517518, 3.6758094227592624, 20.788894000869462, 69.00669932416703, 114.07085643035416, 135.59513890088266, 619.2478692780039, 22.353971459481137, 29.3646438261919, 101.07275159463187, 117.86003563444754, 20.408157053650925, 15.976283019919322, 1.1918343697827696, 16.6133060667291, 74.40833316624486, 2.2335862323444795, 32.018309370742486, 547.3849243142517, 0.0, 0.0, 44.175866740795385, 350.29102117946184, 146.57148765875422, 329.8346196557746, 36.56265799886666, 127.54259519487724, 120.42220768800247, 38.13714358118766, 0.9984271050085901, 21.58683482308745, 315.0632252025897, 654.2586113318914, 125.65955423872057, 66.52151875961081, 111.83391040992932, 8.192453666303892, 14.237595238235087, 760.5217403678962, 23.04446041701423, 61.95509319201183, 81.26966850073939, 102.05932933008062, 830.587775585948, 604.008955079673, 263.65383237972935, 6.204319390381296, 58.363869966322234, 26.435927347949598, 12.025964553908855, 244.43481822457844, 0.0, 0.0, 0.0, 47.80958992597881, 68.99973231599887, 24.94399414761566, 82.89063714709863, 491.220837038948, 0.0, 112.19055779400493, 138.4181308985446, 107.07153871891806, 98.72866777802082, 81.25575892607525, 1.6835524117672116, 67.23898659139324, 59.76754384052741, 22.228926804433485, 463.4728200902918, 55.455614744942444, 0.0, 403.8318361808043, 368.2976205714282, 37.32820201388683, 344.7387107005573, 489.08170762808425, 0.7553183879280865, 37.671242457231564, 11.756054130503625, 58.62565509578314, 110.8222514730038, 26.996431701964738, 110.64846796588243, 72.15322081318133, 47.85388730630058, 135.07669407009354, 99.07514668392473, 87.40608662047299, 61.750926128427636, 86.58809689247128, 26.764267728210932, 75.97771999962502, 7.902128920229514, 472.2406873586504, 167.37392581830983, 10.57080891668116, 23.724224148836225, 686.3908860805531, 235.21872302801071, 13.893179047823965, 9.270106477405482, 2.8768268201237897, 338.66332842329973, 418.75085928549703, 324.50384847192487, 399.07909844239794, 274.19450576098814, 74.20794405126918, 164.76801433304087, 112.4818186356388, 81.05146879995866, 72.73833784013485, 173.30052012827355, 192.69232253635542, 181.55081979456114, 316.8070990337907, 4.700130106135557, 437.1401670552282, 225.72217720234565, 40.54856152327162, 103.92827578638212, 180.94347593726917, 100.71728095299054, 561.9305481420805, 379.6953022624679, 442.7939432323664, 41.31849485372745, 444.01494389762945, 163.84195403719704, 337.7040670491897, 51.525929226915196, 447.07736177804964, 342.82051971877905, 438.7918553426447, 41.487620590918326, 154.29823141523315, 159.73881524102674, 92.09429487395998, 359.91763610524515, 12.985611878289086, 753.8548642174986, 220.68176116328678, 5.077946272941995, 46.9825585222779, 57.43325642685571, 3.89809880327242, 542.6006049560443, 328.2166315648228, 374.86500753504083, 0.0, 127.91618753467924, 65.24953650249236, 141.5752795458486, 150.5372478974367, 132.47984213047178, 230.73775089232183, 42.69093090439302, 268.0148318685954, 16.5697327958988, 195.97449375581252, 396.63513971771613, 288.06660838997055, 226.70317602070338, 49.44894795844062, 51.16218248218013, 34.79396162952577, 234.5391170841254, 301.0974341880765, 253.1027388105835, 192.39894994778166, 485.02312742850296, 188.89997501803674]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8413964985699303, "mean_inference_ms": 2.357758924206641, "mean_action_processing_ms": 0.340938383116914, "mean_env_wait_ms": 0.30448939201121966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005756735801696777, "StateBufferConnector_ms": 0.004495859146118164, "ViewRequirementAgentConnector_ms": 0.13191437721252441}, "num_episodes": 18, "episode_return_max": 396.9868151226862, "episode_return_min": -260.0804712518504, "episode_return_mean": 70.89468879115913, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 242.84896307635952, "num_env_steps_trained_throughput_per_sec": 242.84896307635952, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 14676.883, "restore_workers_time_ms": 0.013, "training_step_time_ms": 14676.808, "sample_time_ms": 1643.871, "learn_time_ms": 13007.699, "learn_throughput": 307.51, "synch_weights_time_ms": 22.598}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 13, "trial_id": "61e09_00000", "date": "2024-08-16_16-09-48", "timestamp": 1723804788, "time_this_iter_s": 16.505265951156616, "time_total_s": 190.53403878211975, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b249b550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 190.53403878211975, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 61.356521739130436, "ram_util_percent": 82.55217391304348}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.452124551711259, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.5720446425140215, "policy_loss": -0.009994142422965042, "vf_loss": 6.579838045816573, "vf_explained_var": 0.0004560497387376412, "kl": 0.011003699950856406, "entropy": 1.4289879678418396, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1039227824677864, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.44032329377674, "policy_loss": -0.009987464155656873, "vf_loss": 8.447939656272768, "vf_explained_var": 0.08866371070897137, "kl": 0.011855495950897469, "entropy": 1.4823856259149217, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 396.9868151226862, "episode_reward_min": -260.0804712518504, "episode_reward_mean": 86.04416765574386, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -833.272550462457, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 154.39787107977045, "predator_policy": 830.587775585948}, "policy_reward_mean": {"prey_policy": -132.28826083769553, "predator_policy": 175.31034466556736}, "custom_metrics": {}, "hist_stats": {"episode_reward": [101.63343821649441, 129.629999999999, -260.0804712518504, 38.315853715776825, 171.73999999999887, 67.43000000000058, 140.34207876189794, 83.06392902335745, -103.5389389410739, 74.89795653042763, 74.77000000000042, 85.25000000000014, 3.9999999999999587, 71.94000000000095, 171.73999999999887, -144.184432802739, 3.209999999999976, 130.8782295943281, 44.90999999999957, 94.80802814917615, 123.03127277307772, 47.61999999999983, 70.61867196614114, -29.48414746636452, 396.9868151226862, 4.6053183879280315, 283.0247561121779, 85.34482042562244, 168.44001330116538, 26.700869311084205, 11.425019083557185, 97.2200000000007, 32.60975671763678, 162.55999999999977, 78.09000000000106, -139.17980888530926, 17.810000000000265, 3.0729128282835068, 78.10080253222509, 168.0275381050209, 141.80000000000027, 98.20293194138122, 182.82423080951284, 66.8038148030246, 156.5151740374615, 34.24999999999964, 12.452048241060357, -31.422358164565033, 5.579999999999968, 295.30102094153415, 50.05672040153252, 6.616426800548073, 105.30000000000054, 124.16498741956718, 125.19361565112708, 106.62000000000032, -19.802694973450972, -130.80062189703088, 232.26999999999896, 72.8300000000011, 1.240000000000003, 2.59999999999998, 156.43, 152.0606377954013, 62.52999999999987, 166.00000000000023, 92.22712277684964, 47.36999999999999, 89.04999999999988, 162.84583792506572, 271.4864091810135, 83.72594341037882, -11.79319081443926, 32.581411614384564, 99.88891459741545, 97.48000000000012, -50.73816119494711, 166.19999999999996, 319.2, 67.84182917459353, -3.3465586298257484, -88.00161041546157, 229.51501292928955, 160.34000000000003, 37.728819936396675, 16.60000000000004, 130.17000000000002, 143.3037628025016, 65.07263018445443, 125.53665312847488, 306.34747735883946, 110.36955962942551, 175.3400000000002, -63.666848756859, 171.71827951703594, 142.53700492929215, 109.59000000000027, 232.3599999999988, 117.87025117267433, 174.66999999999985], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [6.548769589023294, -63.47468264171996, 52.67922386406216, 54.36551420784128, -571.5861043051093, -657.8162034812218, -33.166221464953956, -120.6989978175997, -8.927302595736592, 60.6409385195032, 52.972404761764686, -760.3017403678962, 60.24153286974843, -4.899007716876394, -47.8151711357469, -52.449897671716, -833.272550462457, -704.8631191442381, -199.27301010568382, 4.312814866000133, -5.88035658273804, -4.149440731533801, -1.0801428010456027, -170.1306399774418, 2.0000000000000013, 2.0000000000000013, 37.639999999999674, -13.50958992597883, 36.09098539951931, 41.70528813686598, -331.50123127244115, -386.79467571634484, 2.0000000000000013, -110.98055779400485, -152.35276695986767, 37.74132693673341, -144.00442670409655, 8.929999999999962, -2.9270882444222384, 28.81257739043694, -8.446283625740863, 49.48108575385716, -462.86282009029185, -8.445614744942468, 70.23867196614103, -403.4518361808045, -273.2516660479052, -161.85830400377648, 112.16115315255723, -548.9947563585118, 2.0000000000000013, -35.82124245723193, 140.28086322681654, 72.36218365907494, -61.87156455476751, 9.39770180542001, -30.41668800580174, 16.05501252790371, -48.33195112863897, -107.89776093667092, -131.44969360146746, -43.60652061937441, 34.02907387157225, -85.14809689247085, -35.01089864671046, -35.121332363489216, 154.39787107977045, -471.98068735865024, 36.09863303542282, -135.95336777041416, -186.31585047671447, -662.9790686379837, -1.184316852453866, -230.11758522338155, -4.611223386550635, -4.462797082695191, -485.6280661054918, -193.68531907108053, -543.3078010022131, -12.24760780708847, -273.4145057609883, 66.8120559487308, -93.9103175565759, -85.13658347072219, 50.3795738315558, -21.345149662135576, -229.0861846364342, -70.10284322517087, -370.3751418889319, 28.53239709804206, 28.9398698938647, -436.5301670552284, -12.778085952660243, -241.0406045318969, -122.332141737629, -193.96196815058747, -95.39728095298986, -561.6705481420806, 41.41381901355996, -568.6020435668598, -34.940000173972884, -400.3367181758519, -278.66673241498773, -216.26286187085262, 53.224070773084655, -446.52736177804996, -382.4270374186804, -275.0203502231766, -39.617276770376236, -30.97495958464855, -54.678815241026825, -90.5342948739592, -293.3787982452499, -99.32714471173537, -543.5597254945175, -561.7775217832983, 147.33718670093972, 32.87230850384011, -55.87325642685575, 67.37190119672823, -542.0006049560449, -327.57663156482323, -176.50915601327924, -195.7558515217633, -122.56618753467855, 85.83046349750762, 11.714769933050409, -151.7666595809348, -70.83984213047147, -229.8477508923223, 122.44906909560699, -267.1548318685955, 10.639590670309756, -130.95669444517156, -396.4351397177162, -240.89660838997068, 10.43249688619067, -197.5346208653347, -6.343734596289615, 83.2334284096494, 31.214651030171908, -295.3647931213601, -265.76930863483415, -96.0064367131531, -487.06198310665974, -198.65431015431994, -563.6902720012678, 11.595077977502232, -148.96949244598753, -34.729387766508864, -401.21911095212374, -30.423154176462273, -312.25629837209704, -391.419991998816, -7.9818034672098275, 153.94754598239894, 131.80328000926667, 78.8538875104676, -432.56490110794886, -182.0730536158278, -226.13874269676552, -85.34608633342438, -401.7146351006654, -420.0015803946386, -89.685527501246, 82.44079996644192, 114.39753635736385, -141.82843707251925, -39.959758013592996, -304.32035623371036, -141.2457277330459, -306.605500745271, -161.0191563465718, -2.0771159490901745, -422.1415270592482, -176.620002165952, -313.7118980324619, -67.19964663556522, -246.50738500531045, -261.88118461208296, 107.11102907020671, 118.57536050368356, 4.710745221085757, 45.49340803332844, 142.2934612344772, -122.47954632761689, -130.88767101341426, -354.669599330856, 123.76163131550096, -150.2770594301749, -142.6675735836369, 76.64030647449246, -9.451569324780074, -79.91875580925031, 129.82394669867955, 60.95542021655595, -261.2119510483716, -37.88732357128986, 130.7, -50.610886298585996], "policy_predator_policy_reward": [120.42220768800247, 38.13714358118766, 0.9984271050085901, 21.58683482308745, 315.0632252025897, 654.2586113318914, 125.65955423872057, 66.52151875961081, 111.83391040992932, 8.192453666303892, 14.237595238235087, 760.5217403678962, 23.04446041701423, 61.95509319201183, 81.26966850073939, 102.05932933008062, 830.587775585948, 604.008955079673, 263.65383237972935, 6.204319390381296, 58.363869966322234, 26.435927347949598, 12.025964553908855, 244.43481822457844, 0.0, 0.0, 0.0, 47.80958992597881, 68.99973231599887, 24.94399414761566, 82.89063714709863, 491.220837038948, 0.0, 112.19055779400493, 138.4181308985446, 107.07153871891806, 98.72866777802082, 81.25575892607525, 1.6835524117672116, 67.23898659139324, 59.76754384052741, 22.228926804433485, 463.4728200902918, 55.455614744942444, 0.0, 403.8318361808043, 368.2976205714282, 37.32820201388683, 344.7387107005573, 489.08170762808425, 0.7553183879280865, 37.671242457231564, 11.756054130503625, 58.62565509578314, 110.8222514730038, 26.996431701964738, 110.64846796588243, 72.15322081318133, 47.85388730630058, 135.07669407009354, 99.07514668392473, 87.40608662047299, 61.750926128427636, 86.58809689247128, 26.764267728210932, 75.97771999962502, 7.902128920229514, 472.2406873586504, 167.37392581830983, 10.57080891668116, 23.724224148836225, 686.3908860805531, 235.21872302801071, 13.893179047823965, 9.270106477405482, 2.8768268201237897, 338.66332842329973, 418.75085928549703, 324.50384847192487, 399.07909844239794, 274.19450576098814, 74.20794405126918, 164.76801433304087, 112.4818186356388, 81.05146879995866, 72.73833784013485, 173.30052012827355, 192.69232253635542, 181.55081979456114, 316.8070990337907, 4.700130106135557, 437.1401670552282, 225.72217720234565, 40.54856152327162, 103.92827578638212, 180.94347593726917, 100.71728095299054, 561.9305481420805, 379.6953022624679, 442.7939432323664, 41.31849485372745, 444.01494389762945, 163.84195403719704, 337.7040670491897, 51.525929226915196, 447.07736177804964, 342.82051971877905, 438.7918553426447, 41.487620590918326, 154.29823141523315, 159.73881524102674, 92.09429487395998, 359.91763610524515, 12.985611878289086, 753.8548642174986, 220.68176116328678, 5.077946272941995, 46.9825585222779, 57.43325642685571, 3.89809880327242, 542.6006049560443, 328.2166315648228, 374.86500753504083, 0.0, 127.91618753467924, 65.24953650249236, 141.5752795458486, 150.5372478974367, 132.47984213047178, 230.73775089232183, 42.69093090439302, 268.0148318685954, 16.5697327958988, 195.97449375581252, 396.63513971771613, 288.06660838997055, 226.70317602070338, 49.44894795844062, 51.16218248218013, 34.79396162952577, 234.5391170841254, 301.0974341880765, 253.1027388105835, 192.39894994778166, 485.02312742850296, 188.89997501803674, 563.7402720012677, 20.93633363688205, 49.751152518847036, 233.83664229106412, 401.4591109521236, 127.66315417646231, 310.53458803551234, 342.4035411404534, 9.881803467209787, 10.35245401760106, 31.306719990733324, 77.23611248953242, 395.31140037310416, 287.16838352526554, 264.2442767411554, 43.89399365920854, 588.7120892251385, 145.00251585470306, 75.82265679355316, 160.937083670541, 53.43438597787295, 134.3365147372831, 210.08155154986054, 171.9273826338391, 144.74606447990743, 319.7051639984091, 162.1791563465716, 131.08711594909013, 332.49288388453164, 409.5724081431711, 344.2823773552705, 101.70179749721072, 238.64494068788156, 395.2802820579859, 32.952449902965675, 47.708637881983925, 46.51777718753433, 13.647629187475292, 31.716538765522806, 123.80954632761687, 14.91961007717198, 406.97081151023747, 95.75431531718483, 102.47939231452484, 145.7029017709907, 62.8613702674458, 146.67792674014427, 52.28239839388593, 23.476053301320285, 18.10457978344453, 279.6098514389386, 137.35967435339722, 78.09434313940307, 16.486543159182773]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8380083443713734, "mean_inference_ms": 2.3804836985180176, "mean_action_processing_ms": 0.3379101101179504, "mean_env_wait_ms": 0.30225786711437125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006805419921875, "StateBufferConnector_ms": 0.0045212507247924805, "ViewRequirementAgentConnector_ms": 0.1393657922744751}, "num_episodes": 27, "episode_return_max": 396.9868151226862, "episode_return_min": -260.0804712518504, "episode_return_mean": 86.04416765574386, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 249.78256526741694, "num_env_steps_trained_throughput_per_sec": 249.78256526741694, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 14942.516, "restore_workers_time_ms": 0.013, "training_step_time_ms": 14942.467, "sample_time_ms": 1726.957, "learn_time_ms": 13189.778, "learn_throughput": 303.265, "synch_weights_time_ms": 22.872}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 14, "trial_id": "61e09_00000", "date": "2024-08-16_16-10-04", "timestamp": 1723804804, "time_this_iter_s": 16.065327882766724, "time_total_s": 206.59936666488647, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b244bd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 206.59936666488647, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 63.99565217391304, "ram_util_percent": 82.63478260869564}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3395378832148497, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.7146956934499995, "policy_loss": -0.015332402092547565, "vf_loss": 4.727340026759597, "vf_explained_var": 0.019773521499028283, "kl": 0.013440315495445344, "entropy": 1.4144429208740354, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2323960665672544, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.01582814499184, "policy_loss": -0.007517718782195102, "vf_loss": 8.021053413360837, "vf_explained_var": 0.06500963499306371, "kl": 0.011462222013745154, "entropy": 1.4735472770595046, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 396.9868151226862, "episode_reward_min": -139.17980888530926, "episode_reward_mean": 110.31329010640874, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -662.9790686379837, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 181.26128222985284, "predator_policy": 753.8548642174986}, "policy_reward_mean": {"prey_policy": -113.39014053325636, "predator_policy": 168.5467855864606}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.90999999999957, 94.80802814917615, 123.03127277307772, 47.61999999999983, 70.61867196614114, -29.48414746636452, 396.9868151226862, 4.6053183879280315, 283.0247561121779, 85.34482042562244, 168.44001330116538, 26.700869311084205, 11.425019083557185, 97.2200000000007, 32.60975671763678, 162.55999999999977, 78.09000000000106, -139.17980888530926, 17.810000000000265, 3.0729128282835068, 78.10080253222509, 168.0275381050209, 141.80000000000027, 98.20293194138122, 182.82423080951284, 66.8038148030246, 156.5151740374615, 34.24999999999964, 12.452048241060357, -31.422358164565033, 5.579999999999968, 295.30102094153415, 50.05672040153252, 6.616426800548073, 105.30000000000054, 124.16498741956718, 125.19361565112708, 106.62000000000032, -19.802694973450972, -130.80062189703088, 232.26999999999896, 72.8300000000011, 1.240000000000003, 2.59999999999998, 156.43, 152.0606377954013, 62.52999999999987, 166.00000000000023, 92.22712277684964, 47.36999999999999, 89.04999999999988, 162.84583792506572, 271.4864091810135, 83.72594341037882, -11.79319081443926, 32.581411614384564, 99.88891459741545, 97.48000000000012, -50.73816119494711, 166.19999999999996, 319.2, 67.84182917459353, -3.3465586298257484, -88.00161041546157, 229.51501292928955, 160.34000000000003, 37.728819936396675, 16.60000000000004, 130.17000000000002, 143.3037628025016, 65.07263018445443, 125.53665312847488, 306.34747735883946, 110.36955962942551, 175.3400000000002, -63.666848756859, 171.71827951703594, 142.53700492929215, 109.59000000000027, 232.3599999999988, 117.87025117267433, 174.66999999999985, 190.13834851742774, 238.8010369170034, 188.2954145403773, 138.64000000000016, 79.77000000000018, 178.9599999999998, 230.78193829113565, 165.93999999999983, 96.01203917619739, 177.73000000000002, 187.12071792929993, 82.2428524952129, 265.21669850755274, 272.94168236420325, 311.59999999999997, 368.15, -44.06084082530136, 139.67000000000016], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-144.00442670409655, 8.929999999999962, -2.9270882444222384, 28.81257739043694, -8.446283625740863, 49.48108575385716, -462.86282009029185, -8.445614744942468, 70.23867196614103, -403.4518361808045, -273.2516660479052, -161.85830400377648, 112.16115315255723, -548.9947563585118, 2.0000000000000013, -35.82124245723193, 140.28086322681654, 72.36218365907494, -61.87156455476751, 9.39770180542001, -30.41668800580174, 16.05501252790371, -48.33195112863897, -107.89776093667092, -131.44969360146746, -43.60652061937441, 34.02907387157225, -85.14809689247085, -35.01089864671046, -35.121332363489216, 154.39787107977045, -471.98068735865024, 36.09863303542282, -135.95336777041416, -186.31585047671447, -662.9790686379837, -1.184316852453866, -230.11758522338155, -4.611223386550635, -4.462797082695191, -485.6280661054918, -193.68531907108053, -543.3078010022131, -12.24760780708847, -273.4145057609883, 66.8120559487308, -93.9103175565759, -85.13658347072219, 50.3795738315558, -21.345149662135576, -229.0861846364342, -70.10284322517087, -370.3751418889319, 28.53239709804206, 28.9398698938647, -436.5301670552284, -12.778085952660243, -241.0406045318969, -122.332141737629, -193.96196815058747, -95.39728095298986, -561.6705481420806, 41.41381901355996, -568.6020435668598, -34.940000173972884, -400.3367181758519, -278.66673241498773, -216.26286187085262, 53.224070773084655, -446.52736177804996, -382.4270374186804, -275.0203502231766, -39.617276770376236, -30.97495958464855, -54.678815241026825, -90.5342948739592, -293.3787982452499, -99.32714471173537, -543.5597254945175, -561.7775217832983, 147.33718670093972, 32.87230850384011, -55.87325642685575, 67.37190119672823, -542.0006049560449, -327.57663156482323, -176.50915601327924, -195.7558515217633, -122.56618753467855, 85.83046349750762, 11.714769933050409, -151.7666595809348, -70.83984213047147, -229.8477508923223, 122.44906909560699, -267.1548318685955, 10.639590670309756, -130.95669444517156, -396.4351397177162, -240.89660838997068, 10.43249688619067, -197.5346208653347, -6.343734596289615, 83.2334284096494, 31.214651030171908, -295.3647931213601, -265.76930863483415, -96.0064367131531, -487.06198310665974, -198.65431015431994, -563.6902720012678, 11.595077977502232, -148.96949244598753, -34.729387766508864, -401.21911095212374, -30.423154176462273, -312.25629837209704, -391.419991998816, -7.9818034672098275, 153.94754598239894, 131.80328000926667, 78.8538875104676, -432.56490110794886, -182.0730536158278, -226.13874269676552, -85.34608633342438, -401.7146351006654, -420.0015803946386, -89.685527501246, 82.44079996644192, 114.39753635736385, -141.82843707251925, -39.959758013592996, -304.32035623371036, -141.2457277330459, -306.605500745271, -161.0191563465718, -2.0771159490901745, -422.1415270592482, -176.620002165952, -313.7118980324619, -67.19964663556522, -246.50738500531045, -261.88118461208296, 107.11102907020671, 118.57536050368356, 4.710745221085757, 45.49340803332844, 142.2934612344772, -122.47954632761689, -130.88767101341426, -354.669599330856, 123.76163131550096, -150.2770594301749, -142.6675735836369, 76.64030647449246, -9.451569324780074, -79.91875580925031, 129.82394669867955, 60.95542021655595, -261.2119510483716, -37.88732357128986, 130.7, -50.610886298585996, 23.318024167876864, 2.6341066286742496, -123.65744753126303, 87.09190737528192, 31.982113694155046, -226.65118211754296, -102.7478400305175, 20.895373097469104, -312.0866749168186, 2.601347019749203, -24.760123042326217, 164.20594958552897, -195.65162098062592, 152.40288518137152, -18.69626024195539, 129.57210710119563, -228.9170334147109, -269.39972369716327, 155.2790864632683, -306.06844655760244, -69.03626593615758, 67.01844844647188, -181.32069496696155, -81.37595236488323, 89.98382111154633, 50.30395060545941, 116.5166949332203, 17.151717050084258, 128.52502417891503, 123.42356378768868, 156.9151155253629, 181.26128222985284, -160.94556210981887, -177.5570799181804, 30.146115715491213, -256.71727670558977], "policy_predator_policy_reward": [98.72866777802082, 81.25575892607525, 1.6835524117672116, 67.23898659139324, 59.76754384052741, 22.228926804433485, 463.4728200902918, 55.455614744942444, 0.0, 403.8318361808043, 368.2976205714282, 37.32820201388683, 344.7387107005573, 489.08170762808425, 0.7553183879280865, 37.671242457231564, 11.756054130503625, 58.62565509578314, 110.8222514730038, 26.996431701964738, 110.64846796588243, 72.15322081318133, 47.85388730630058, 135.07669407009354, 99.07514668392473, 87.40608662047299, 61.750926128427636, 86.58809689247128, 26.764267728210932, 75.97771999962502, 7.902128920229514, 472.2406873586504, 167.37392581830983, 10.57080891668116, 23.724224148836225, 686.3908860805531, 235.21872302801071, 13.893179047823965, 9.270106477405482, 2.8768268201237897, 338.66332842329973, 418.75085928549703, 324.50384847192487, 399.07909844239794, 274.19450576098814, 74.20794405126918, 164.76801433304087, 112.4818186356388, 81.05146879995866, 72.73833784013485, 173.30052012827355, 192.69232253635542, 181.55081979456114, 316.8070990337907, 4.700130106135557, 437.1401670552282, 225.72217720234565, 40.54856152327162, 103.92827578638212, 180.94347593726917, 100.71728095299054, 561.9305481420805, 379.6953022624679, 442.7939432323664, 41.31849485372745, 444.01494389762945, 163.84195403719704, 337.7040670491897, 51.525929226915196, 447.07736177804964, 342.82051971877905, 438.7918553426447, 41.487620590918326, 154.29823141523315, 159.73881524102674, 92.09429487395998, 359.91763610524515, 12.985611878289086, 753.8548642174986, 220.68176116328678, 5.077946272941995, 46.9825585222779, 57.43325642685571, 3.89809880327242, 542.6006049560443, 328.2166315648228, 374.86500753504083, 0.0, 127.91618753467924, 65.24953650249236, 141.5752795458486, 150.5372478974367, 132.47984213047178, 230.73775089232183, 42.69093090439302, 268.0148318685954, 16.5697327958988, 195.97449375581252, 396.63513971771613, 288.06660838997055, 226.70317602070338, 49.44894795844062, 51.16218248218013, 34.79396162952577, 234.5391170841254, 301.0974341880765, 253.1027388105835, 192.39894994778166, 485.02312742850296, 188.89997501803674, 563.7402720012677, 20.93633363688205, 49.751152518847036, 233.83664229106412, 401.4591109521236, 127.66315417646231, 310.53458803551234, 342.4035411404534, 9.881803467209787, 10.35245401760106, 31.306719990733324, 77.23611248953242, 395.31140037310416, 287.16838352526554, 264.2442767411554, 43.89399365920854, 588.7120892251385, 145.00251585470306, 75.82265679355316, 160.937083670541, 53.43438597787295, 134.3365147372831, 210.08155154986054, 171.9273826338391, 144.74606447990743, 319.7051639984091, 162.1791563465716, 131.08711594909013, 332.49288388453164, 409.5724081431711, 344.2823773552705, 101.70179749721072, 238.64494068788156, 395.2802820579859, 32.952449902965675, 47.708637881983925, 46.51777718753433, 13.647629187475292, 31.716538765522806, 123.80954632761687, 14.91961007717198, 406.97081151023747, 95.75431531718483, 102.47939231452484, 145.7029017709907, 62.8613702674458, 146.67792674014427, 52.28239839388593, 23.476053301320285, 18.10457978344453, 279.6098514389386, 137.35967435339722, 78.09434313940307, 16.486543159182773, 147.283919240801, 16.902298480075945, 132.11109929368644, 143.25547777929805, 86.08453903447693, 296.87994392928834, 104.28784003051828, 116.20462690253095, 377.0866749168186, 12.168652980250776, 24.791035788151706, 14.723137668645796, 192.8463378237521, 81.18433626663786, 19.282533799719797, 35.781619341040226, 375.80701540210885, 218.52178088596256, 249.59297800267362, 78.92638209166086, 188.003481770935, 1.1350536480513795, 217.0560293360142, 127.88347049104257, 70.92861192042275, 54.00031487012423, 1.6632994451236285, 137.60997093577495, 46.52497582108498, 13.126436212311331, 28.084884474637114, 1.8887177701471454, 293.4541933810172, 0.987607821678923, 124.11385437560679, 242.1273066144911]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8345201063573762, "mean_inference_ms": 2.3914468535475693, "mean_action_processing_ms": 0.3369870999285122, "mean_env_wait_ms": 0.3019138998066068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005221009254455566, "StateBufferConnector_ms": 0.0031480789184570312, "ViewRequirementAgentConnector_ms": 0.13208377361297607}, "num_episodes": 18, "episode_return_max": 396.9868151226862, "episode_return_min": -139.17980888530926, "episode_return_mean": 110.31329010640874, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 264.58463199893, "num_env_steps_trained_throughput_per_sec": 264.58463199893, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 15097.983, "restore_workers_time_ms": 0.013, "training_step_time_ms": 15097.933, "sample_time_ms": 1714.913, "learn_time_ms": 13356.763, "learn_throughput": 299.474, "synch_weights_time_ms": 23.455}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 15, "trial_id": "61e09_00000", "date": "2024-08-16_16-10-19", "timestamp": 1723804819, "time_this_iter_s": 15.180891990661621, "time_total_s": 221.7802586555481, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2549ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 221.7802586555481, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 59.622727272727275, "ram_util_percent": 82.28636363636365}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3454519590057392, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.978849218509815, "policy_loss": -0.01469799827848359, "vf_loss": 5.990980589831317, "vf_explained_var": 0.02908186638166034, "kl": 0.012833178409424894, "entropy": 1.3877706489235004, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.099969874078004, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.913169749325546, "policy_loss": -0.009361104758347942, "vf_loss": 8.920335583964352, "vf_explained_var": -0.006087963164798797, "kl": 0.010976318297909066, "entropy": 1.4384280366241617, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 368.15, "episode_reward_min": -264.953929105918, "episode_reward_mean": 111.58289434284717, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -684.5836317911838, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 181.26128222985284, "predator_policy": 753.8548642174986}, "policy_reward_mean": {"prey_policy": -130.7610065079929, "predator_policy": 186.55245367941643}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.810000000000265, 3.0729128282835068, 78.10080253222509, 168.0275381050209, 141.80000000000027, 98.20293194138122, 182.82423080951284, 66.8038148030246, 156.5151740374615, 34.24999999999964, 12.452048241060357, -31.422358164565033, 5.579999999999968, 295.30102094153415, 50.05672040153252, 6.616426800548073, 105.30000000000054, 124.16498741956718, 125.19361565112708, 106.62000000000032, -19.802694973450972, -130.80062189703088, 232.26999999999896, 72.8300000000011, 1.240000000000003, 2.59999999999998, 156.43, 152.0606377954013, 62.52999999999987, 166.00000000000023, 92.22712277684964, 47.36999999999999, 89.04999999999988, 162.84583792506572, 271.4864091810135, 83.72594341037882, -11.79319081443926, 32.581411614384564, 99.88891459741545, 97.48000000000012, -50.73816119494711, 166.19999999999996, 319.2, 67.84182917459353, -3.3465586298257484, -88.00161041546157, 229.51501292928955, 160.34000000000003, 37.728819936396675, 16.60000000000004, 130.17000000000002, 143.3037628025016, 65.07263018445443, 125.53665312847488, 306.34747735883946, 110.36955962942551, 175.3400000000002, -63.666848756859, 171.71827951703594, 142.53700492929215, 109.59000000000027, 232.3599999999988, 117.87025117267433, 174.66999999999985, 190.13834851742774, 238.8010369170034, 188.2954145403773, 138.64000000000016, 79.77000000000018, 178.9599999999998, 230.78193829113565, 165.93999999999983, 96.01203917619739, 177.73000000000002, 187.12071792929993, 82.2428524952129, 265.21669850755274, 272.94168236420325, 311.59999999999997, 368.15, -44.06084082530136, 139.67000000000016, 148.62, -264.953929105918, -40.63095893745101, -105.17836227746216, 336.28025461637856, 230.8787406019521, 145.34122883625474, 237.83864022373564, 91.8336850900917, 131.78184282250902, 186.18238195194527, -216.58397861391748, 44.880000000000095, 303.3114577128871, 301.13016149461083, 94.23336654528829, 10.777277681518434, 50.55000000000006], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1.184316852453866, -230.11758522338155, -4.611223386550635, -4.462797082695191, -485.6280661054918, -193.68531907108053, -543.3078010022131, -12.24760780708847, -273.4145057609883, 66.8120559487308, -93.9103175565759, -85.13658347072219, 50.3795738315558, -21.345149662135576, -229.0861846364342, -70.10284322517087, -370.3751418889319, 28.53239709804206, 28.9398698938647, -436.5301670552284, -12.778085952660243, -241.0406045318969, -122.332141737629, -193.96196815058747, -95.39728095298986, -561.6705481420806, 41.41381901355996, -568.6020435668598, -34.940000173972884, -400.3367181758519, -278.66673241498773, -216.26286187085262, 53.224070773084655, -446.52736177804996, -382.4270374186804, -275.0203502231766, -39.617276770376236, -30.97495958464855, -54.678815241026825, -90.5342948739592, -293.3787982452499, -99.32714471173537, -543.5597254945175, -561.7775217832983, 147.33718670093972, 32.87230850384011, -55.87325642685575, 67.37190119672823, -542.0006049560449, -327.57663156482323, -176.50915601327924, -195.7558515217633, -122.56618753467855, 85.83046349750762, 11.714769933050409, -151.7666595809348, -70.83984213047147, -229.8477508923223, 122.44906909560699, -267.1548318685955, 10.639590670309756, -130.95669444517156, -396.4351397177162, -240.89660838997068, 10.43249688619067, -197.5346208653347, -6.343734596289615, 83.2334284096494, 31.214651030171908, -295.3647931213601, -265.76930863483415, -96.0064367131531, -487.06198310665974, -198.65431015431994, -563.6902720012678, 11.595077977502232, -148.96949244598753, -34.729387766508864, -401.21911095212374, -30.423154176462273, -312.25629837209704, -391.419991998816, -7.9818034672098275, 153.94754598239894, 131.80328000926667, 78.8538875104676, -432.56490110794886, -182.0730536158278, -226.13874269676552, -85.34608633342438, -401.7146351006654, -420.0015803946386, -89.685527501246, 82.44079996644192, 114.39753635736385, -141.82843707251925, -39.959758013592996, -304.32035623371036, -141.2457277330459, -306.605500745271, -161.0191563465718, -2.0771159490901745, -422.1415270592482, -176.620002165952, -313.7118980324619, -67.19964663556522, -246.50738500531045, -261.88118461208296, 107.11102907020671, 118.57536050368356, 4.710745221085757, 45.49340803332844, 142.2934612344772, -122.47954632761689, -130.88767101341426, -354.669599330856, 123.76163131550096, -150.2770594301749, -142.6675735836369, 76.64030647449246, -9.451569324780074, -79.91875580925031, 129.82394669867955, 60.95542021655595, -261.2119510483716, -37.88732357128986, 130.7, -50.610886298585996, 23.318024167876864, 2.6341066286742496, -123.65744753126303, 87.09190737528192, 31.982113694155046, -226.65118211754296, -102.7478400305175, 20.895373097469104, -312.0866749168186, 2.601347019749203, -24.760123042326217, 164.20594958552897, -195.65162098062592, 152.40288518137152, -18.69626024195539, 129.57210710119563, -228.9170334147109, -269.39972369716327, 155.2790864632683, -306.06844655760244, -69.03626593615758, 67.01844844647188, -181.32069496696155, -81.37595236488323, 89.98382111154633, 50.30395060545941, 116.5166949332203, 17.151717050084258, 128.52502417891503, 123.42356378768868, 156.9151155253629, 181.26128222985284, -160.94556210981887, -177.5570799181804, 30.146115715491213, -256.71727670558977, -275.059947132851, 20.104113367516582, -576.1289116292235, -520.4241881524647, -480.3516357487767, -482.76860080950064, -153.0043216180232, -342.9759057407005, -35.30917044548188, -486.6276482278304, 62.68414624443281, 11.269951946635553, -49.99413862398655, -684.5836317911838, 8.222240456396182, -115.14883815947405, -19.32719503407792, -294.28389876885706, -322.7979338848154, -5.8543936882275105, 6.266901772182692, -73.82475548791555, -476.8326794872154, -353.4739805463083, -210.2213874604535, -246.27285086440543, 110.27744386123875, 106.62068389722134, 92.0671816046358, 96.22320494200116, -42.24155809923105, -43.63621621798393, -73.65026297851541, -315.50072033012935, -332.15615970863007, -327.3608243852128], "policy_predator_policy_reward": [235.21872302801071, 13.893179047823965, 9.270106477405482, 2.8768268201237897, 338.66332842329973, 418.75085928549703, 324.50384847192487, 399.07909844239794, 274.19450576098814, 74.20794405126918, 164.76801433304087, 112.4818186356388, 81.05146879995866, 72.73833784013485, 173.30052012827355, 192.69232253635542, 181.55081979456114, 316.8070990337907, 4.700130106135557, 437.1401670552282, 225.72217720234565, 40.54856152327162, 103.92827578638212, 180.94347593726917, 100.71728095299054, 561.9305481420805, 379.6953022624679, 442.7939432323664, 41.31849485372745, 444.01494389762945, 163.84195403719704, 337.7040670491897, 51.525929226915196, 447.07736177804964, 342.82051971877905, 438.7918553426447, 41.487620590918326, 154.29823141523315, 159.73881524102674, 92.09429487395998, 359.91763610524515, 12.985611878289086, 753.8548642174986, 220.68176116328678, 5.077946272941995, 46.9825585222779, 57.43325642685571, 3.89809880327242, 542.6006049560443, 328.2166315648228, 374.86500753504083, 0.0, 127.91618753467924, 65.24953650249236, 141.5752795458486, 150.5372478974367, 132.47984213047178, 230.73775089232183, 42.69093090439302, 268.0148318685954, 16.5697327958988, 195.97449375581252, 396.63513971771613, 288.06660838997055, 226.70317602070338, 49.44894795844062, 51.16218248218013, 34.79396162952577, 234.5391170841254, 301.0974341880765, 253.1027388105835, 192.39894994778166, 485.02312742850296, 188.89997501803674, 563.7402720012677, 20.93633363688205, 49.751152518847036, 233.83664229106412, 401.4591109521236, 127.66315417646231, 310.53458803551234, 342.4035411404534, 9.881803467209787, 10.35245401760106, 31.306719990733324, 77.23611248953242, 395.31140037310416, 287.16838352526554, 264.2442767411554, 43.89399365920854, 588.7120892251385, 145.00251585470306, 75.82265679355316, 160.937083670541, 53.43438597787295, 134.3365147372831, 210.08155154986054, 171.9273826338391, 144.74606447990743, 319.7051639984091, 162.1791563465716, 131.08711594909013, 332.49288388453164, 409.5724081431711, 344.2823773552705, 101.70179749721072, 238.64494068788156, 395.2802820579859, 32.952449902965675, 47.708637881983925, 46.51777718753433, 13.647629187475292, 31.716538765522806, 123.80954632761687, 14.91961007717198, 406.97081151023747, 95.75431531718483, 102.47939231452484, 145.7029017709907, 62.8613702674458, 146.67792674014427, 52.28239839388593, 23.476053301320285, 18.10457978344453, 279.6098514389386, 137.35967435339722, 78.09434313940307, 16.486543159182773, 147.283919240801, 16.902298480075945, 132.11109929368644, 143.25547777929805, 86.08453903447693, 296.87994392928834, 104.28784003051828, 116.20462690253095, 377.0866749168186, 12.168652980250776, 24.791035788151706, 14.723137668645796, 192.8463378237521, 81.18433626663786, 19.282533799719797, 35.781619341040226, 375.80701540210885, 218.52178088596256, 249.59297800267362, 78.92638209166086, 188.003481770935, 1.1350536480513795, 217.0560293360142, 127.88347049104257, 70.92861192042275, 54.00031487012423, 1.6632994451236285, 137.60997093577495, 46.52497582108498, 13.126436212311331, 28.084884474637114, 1.8887177701471454, 293.4541933810172, 0.987607821678923, 124.11385437560679, 242.1273066144911, 172.60593470087792, 230.96989906445592, 123.81233253515896, 707.7868381406114, 571.6869590428217, 350.8023185780047, 89.70354669874608, 301.09831838251455, 391.4508733387507, 466.7661999509411, 23.47952097149251, 133.4451214393914, 474.683777721053, 405.23522153037277, 105.28584843392399, 239.47938949288954, 193.00191138109378, 212.44286751193275, 302.96791758920534, 157.46625280634677, 7.1364858110549, 246.60374985662327, 54.68520891045319, 559.0374725091538, 211.08138746045276, 290.29285086440535, 7.2529592847653035, 79.16037066966165, 58.49531038159929, 54.34446456637466, 93.86719757795449, 86.24394328454822, 2.875889830851672, 397.05237115931146, 332.70615970863, 377.3608243852127]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8331805028008713, "mean_inference_ms": 2.4033443158277406, "mean_action_processing_ms": 0.33595418673292654, "mean_env_wait_ms": 0.3005833497984268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005483150482177734, "StateBufferConnector_ms": 0.0031930208206176758, "ViewRequirementAgentConnector_ms": 0.1283419132232666}, "num_episodes": 18, "episode_return_max": 368.15, "episode_return_min": -264.953929105918, "episode_return_mean": 111.58289434284717, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 258.88049184469054, "num_env_steps_trained_throughput_per_sec": 258.88049184469054, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 15359.262, "restore_workers_time_ms": 0.013, "training_step_time_ms": 15359.211, "sample_time_ms": 1743.355, "learn_time_ms": 13589.221, "learn_throughput": 294.351, "synch_weights_time_ms": 23.72}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 16, "trial_id": "61e09_00000", "date": "2024-08-16_16-10-35", "timestamp": 1723804835, "time_this_iter_s": 15.49456787109375, "time_total_s": 237.27482652664185, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24ac310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 237.27482652664185, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 60.5, "ram_util_percent": 82.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2100375604061853, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.489566771189372, "policy_loss": -0.015095910275473244, "vf_loss": 6.50170070809662, "vf_explained_var": 0.050412252908030517, "kl": 0.014809890305175306, "entropy": 1.3485475456273115, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2027333052070053, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.33317042355815, "policy_loss": -0.013826580487792848, "vf_loss": 8.34447344497398, "vf_explained_var": -0.038030006204332625, "kl": 0.012617812194909516, "entropy": 1.3678207515408753, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 378.12, "episode_reward_min": -264.953929105918, "episode_reward_mean": 123.67845635741168, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -684.5836317911838, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.09890252259106, "predator_policy": 753.8548642174986}, "policy_reward_mean": {"prey_policy": -123.9589703059385, "predator_policy": 185.79819848464425}, "custom_metrics": {}, "hist_stats": {"episode_reward": [125.19361565112708, 106.62000000000032, -19.802694973450972, -130.80062189703088, 232.26999999999896, 72.8300000000011, 1.240000000000003, 2.59999999999998, 156.43, 152.0606377954013, 62.52999999999987, 166.00000000000023, 92.22712277684964, 47.36999999999999, 89.04999999999988, 162.84583792506572, 271.4864091810135, 83.72594341037882, -11.79319081443926, 32.581411614384564, 99.88891459741545, 97.48000000000012, -50.73816119494711, 166.19999999999996, 319.2, 67.84182917459353, -3.3465586298257484, -88.00161041546157, 229.51501292928955, 160.34000000000003, 37.728819936396675, 16.60000000000004, 130.17000000000002, 143.3037628025016, 65.07263018445443, 125.53665312847488, 306.34747735883946, 110.36955962942551, 175.3400000000002, -63.666848756859, 171.71827951703594, 142.53700492929215, 109.59000000000027, 232.3599999999988, 117.87025117267433, 174.66999999999985, 190.13834851742774, 238.8010369170034, 188.2954145403773, 138.64000000000016, 79.77000000000018, 178.9599999999998, 230.78193829113565, 165.93999999999983, 96.01203917619739, 177.73000000000002, 187.12071792929993, 82.2428524952129, 265.21669850755274, 272.94168236420325, 311.59999999999997, 368.15, -44.06084082530136, 139.67000000000016, 148.62, -264.953929105918, -40.63095893745101, -105.17836227746216, 336.28025461637856, 230.8787406019521, 145.34122883625474, 237.83864022373564, 91.8336850900917, 131.78184282250902, 186.18238195194527, -216.58397861391748, 44.880000000000095, 303.3114577128871, 301.13016149461083, 94.23336654528829, 10.777277681518434, 50.55000000000006, -7.823670551666169, -9.184838447781477, 378.12, 86.59182016497692, 144.02045497227297, 172.67999999999992, 225.60762400895618, 188.27828244896185, 161.75999999999996, 253.6782438706598, 229.11917502913764, 60.90999999999982, 150.8748426558829, 115.50340825095326, 244.60021341349335, 78.3931627720784, 156.16373356511002, 95.72000000000011], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-39.617276770376236, -30.97495958464855, -54.678815241026825, -90.5342948739592, -293.3787982452499, -99.32714471173537, -543.5597254945175, -561.7775217832983, 147.33718670093972, 32.87230850384011, -55.87325642685575, 67.37190119672823, -542.0006049560449, -327.57663156482323, -176.50915601327924, -195.7558515217633, -122.56618753467855, 85.83046349750762, 11.714769933050409, -151.7666595809348, -70.83984213047147, -229.8477508923223, 122.44906909560699, -267.1548318685955, 10.639590670309756, -130.95669444517156, -396.4351397177162, -240.89660838997068, 10.43249688619067, -197.5346208653347, -6.343734596289615, 83.2334284096494, 31.214651030171908, -295.3647931213601, -265.76930863483415, -96.0064367131531, -487.06198310665974, -198.65431015431994, -563.6902720012678, 11.595077977502232, -148.96949244598753, -34.729387766508864, -401.21911095212374, -30.423154176462273, -312.25629837209704, -391.419991998816, -7.9818034672098275, 153.94754598239894, 131.80328000926667, 78.8538875104676, -432.56490110794886, -182.0730536158278, -226.13874269676552, -85.34608633342438, -401.7146351006654, -420.0015803946386, -89.685527501246, 82.44079996644192, 114.39753635736385, -141.82843707251925, -39.959758013592996, -304.32035623371036, -141.2457277330459, -306.605500745271, -161.0191563465718, -2.0771159490901745, -422.1415270592482, -176.620002165952, -313.7118980324619, -67.19964663556522, -246.50738500531045, -261.88118461208296, 107.11102907020671, 118.57536050368356, 4.710745221085757, 45.49340803332844, 142.2934612344772, -122.47954632761689, -130.88767101341426, -354.669599330856, 123.76163131550096, -150.2770594301749, -142.6675735836369, 76.64030647449246, -9.451569324780074, -79.91875580925031, 129.82394669867955, 60.95542021655595, -261.2119510483716, -37.88732357128986, 130.7, -50.610886298585996, 23.318024167876864, 2.6341066286742496, -123.65744753126303, 87.09190737528192, 31.982113694155046, -226.65118211754296, -102.7478400305175, 20.895373097469104, -312.0866749168186, 2.601347019749203, -24.760123042326217, 164.20594958552897, -195.65162098062592, 152.40288518137152, -18.69626024195539, 129.57210710119563, -228.9170334147109, -269.39972369716327, 155.2790864632683, -306.06844655760244, -69.03626593615758, 67.01844844647188, -181.32069496696155, -81.37595236488323, 89.98382111154633, 50.30395060545941, 116.5166949332203, 17.151717050084258, 128.52502417891503, 123.42356378768868, 156.9151155253629, 181.26128222985284, -160.94556210981887, -177.5570799181804, 30.146115715491213, -256.71727670558977, -275.059947132851, 20.104113367516582, -576.1289116292235, -520.4241881524647, -480.3516357487767, -482.76860080950064, -153.0043216180232, -342.9759057407005, -35.30917044548188, -486.6276482278304, 62.68414624443281, 11.269951946635553, -49.99413862398655, -684.5836317911838, 8.222240456396182, -115.14883815947405, -19.32719503407792, -294.28389876885706, -322.7979338848154, -5.8543936882275105, 6.266901772182692, -73.82475548791555, -476.8326794872154, -353.4739805463083, -210.2213874604535, -246.27285086440543, 110.27744386123875, 106.62068389722134, 92.0671816046358, 96.22320494200116, -42.24155809923105, -43.63621621798393, -73.65026297851541, -315.50072033012935, -332.15615970863007, -327.3608243852128, -161.93261501530773, -341.74238648158325, -192.91232750589873, -214.42285147387818, 193.09890252259106, 166.5841631469808, -46.17147937113053, -252.706169055231, -255.33718081810449, -442.55824779483675, 93.1934995190626, -59.805223287211696, 181.20412183107058, -94.37645058937967, -299.9338839178583, -479.2368767226328, 158.4891727246229, -137.9993953831267, -481.6366659648458, -189.103707871416, -27.9644816747672, 25.456309023199935, -295.8353694244052, -302.31499516832884, -9.402187720746916, 75.92538528601368, -16.57755533281183, -285.59151949591484, -144.63944011002818, -263.71274609880356, -373.6971010437394, -387.10800423341817, -283.804272629484, 71.49258572577641, -52.21401694335239, -128.10730655876992], "policy_predator_policy_reward": [41.487620590918326, 154.29823141523315, 159.73881524102674, 92.09429487395998, 359.91763610524515, 12.985611878289086, 753.8548642174986, 220.68176116328678, 5.077946272941995, 46.9825585222779, 57.43325642685571, 3.89809880327242, 542.6006049560443, 328.2166315648228, 374.86500753504083, 0.0, 127.91618753467924, 65.24953650249236, 141.5752795458486, 150.5372478974367, 132.47984213047178, 230.73775089232183, 42.69093090439302, 268.0148318685954, 16.5697327958988, 195.97449375581252, 396.63513971771613, 288.06660838997055, 226.70317602070338, 49.44894795844062, 51.16218248218013, 34.79396162952577, 234.5391170841254, 301.0974341880765, 253.1027388105835, 192.39894994778166, 485.02312742850296, 188.89997501803674, 563.7402720012677, 20.93633363688205, 49.751152518847036, 233.83664229106412, 401.4591109521236, 127.66315417646231, 310.53458803551234, 342.4035411404534, 9.881803467209787, 10.35245401760106, 31.306719990733324, 77.23611248953242, 395.31140037310416, 287.16838352526554, 264.2442767411554, 43.89399365920854, 588.7120892251385, 145.00251585470306, 75.82265679355316, 160.937083670541, 53.43438597787295, 134.3365147372831, 210.08155154986054, 171.9273826338391, 144.74606447990743, 319.7051639984091, 162.1791563465716, 131.08711594909013, 332.49288388453164, 409.5724081431711, 344.2823773552705, 101.70179749721072, 238.64494068788156, 395.2802820579859, 32.952449902965675, 47.708637881983925, 46.51777718753433, 13.647629187475292, 31.716538765522806, 123.80954632761687, 14.91961007717198, 406.97081151023747, 95.75431531718483, 102.47939231452484, 145.7029017709907, 62.8613702674458, 146.67792674014427, 52.28239839388593, 23.476053301320285, 18.10457978344453, 279.6098514389386, 137.35967435339722, 78.09434313940307, 16.486543159182773, 147.283919240801, 16.902298480075945, 132.11109929368644, 143.25547777929805, 86.08453903447693, 296.87994392928834, 104.28784003051828, 116.20462690253095, 377.0866749168186, 12.168652980250776, 24.791035788151706, 14.723137668645796, 192.8463378237521, 81.18433626663786, 19.282533799719797, 35.781619341040226, 375.80701540210885, 218.52178088596256, 249.59297800267362, 78.92638209166086, 188.003481770935, 1.1350536480513795, 217.0560293360142, 127.88347049104257, 70.92861192042275, 54.00031487012423, 1.6632994451236285, 137.60997093577495, 46.52497582108498, 13.126436212311331, 28.084884474637114, 1.8887177701471454, 293.4541933810172, 0.987607821678923, 124.11385437560679, 242.1273066144911, 172.60593470087792, 230.96989906445592, 123.81233253515896, 707.7868381406114, 571.6869590428217, 350.8023185780047, 89.70354669874608, 301.09831838251455, 391.4508733387507, 466.7661999509411, 23.47952097149251, 133.4451214393914, 474.683777721053, 405.23522153037277, 105.28584843392399, 239.47938949288954, 193.00191138109378, 212.44286751193275, 302.96791758920534, 157.46625280634677, 7.1364858110549, 246.60374985662327, 54.68520891045319, 559.0374725091538, 211.08138746045276, 290.29285086440535, 7.2529592847653035, 79.16037066966165, 58.49531038159929, 54.34446456637466, 93.86719757795449, 86.24394328454822, 2.875889830851672, 397.05237115931146, 332.70615970863, 377.3608243852127, 135.67735414007052, 360.17397680515427, 77.2832090738481, 320.86713145814736, 1.9310974774089544, 16.50583685301919, 2.893108229482003, 382.57636036185613, 347.65901269890196, 494.2568708863122, 77.80650048093743, 61.48522328721138, 46.13312002824392, 92.64683273902234, 555.1427986532045, 412.3062444362482, 1.8908272753770907, 139.37939538312546, 499.3908079571346, 425.02780974978674, 140.60943602615774, 91.01791165454723, 355.8353694244051, 303.22499516832806, 78.9295268387728, 5.422118251843422, 143.52209543473305, 274.1503876449464, 405.15599644257566, 247.79640317974946, 411.38506180514395, 427.8132062440921, 123.69556438350803, 244.7798560853084, 53.93401694335205, 222.10730655876984]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8343997155249667, "mean_inference_ms": 2.4213545399766563, "mean_action_processing_ms": 0.33576347619032293, "mean_env_wait_ms": 0.30061706469750155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005812525749206543, "StateBufferConnector_ms": 0.0033909082412719727, "ViewRequirementAgentConnector_ms": 0.13558006286621094}, "num_episodes": 18, "episode_return_max": 378.12, "episode_return_min": -264.953929105918, "episode_return_mean": 123.67845635741168, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 253.30446954715399, "num_env_steps_trained_throughput_per_sec": 253.30446954715399, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 15647.826, "restore_workers_time_ms": 0.013, "training_step_time_ms": 15647.766, "sample_time_ms": 1812.447, "learn_time_ms": 13807.478, "learn_throughput": 289.698, "synch_weights_time_ms": 24.315}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 17, "trial_id": "61e09_00000", "date": "2024-08-16_16-10-51", "timestamp": 1723804851, "time_this_iter_s": 15.82082986831665, "time_total_s": 253.0956563949585, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30000b550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 253.0956563949585, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 62.57272727272727, "ram_util_percent": 82.47727272727272}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8236339072701793, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.032305190929029, "policy_loss": -0.01051655481249173, "vf_loss": 7.040314429651493, "vf_explained_var": 0.021400227464696088, "kl": 0.01253654905325017, "entropy": 1.348862393886324, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7633298134362256, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.302193399964187, "policy_loss": -0.013004934198774949, "vf_loss": 8.312001835606086, "vf_explained_var": 0.06878600259306569, "kl": 0.015982500761699624, "entropy": 1.2996174157611908, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 389.4865927756938, "episode_reward_min": -264.953929105918, "episode_reward_mean": 140.52074435667177, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -684.5836317911838, "predator_policy": 0.987607821678923}, "policy_reward_max": {"prey_policy": 193.09890252259106, "predator_policy": 707.7868381406114}, "policy_reward_mean": {"prey_policy": -119.22002557364405, "predator_policy": 189.48039775197984}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.73816119494711, 166.19999999999996, 319.2, 67.84182917459353, -3.3465586298257484, -88.00161041546157, 229.51501292928955, 160.34000000000003, 37.728819936396675, 16.60000000000004, 130.17000000000002, 143.3037628025016, 65.07263018445443, 125.53665312847488, 306.34747735883946, 110.36955962942551, 175.3400000000002, -63.666848756859, 171.71827951703594, 142.53700492929215, 109.59000000000027, 232.3599999999988, 117.87025117267433, 174.66999999999985, 190.13834851742774, 238.8010369170034, 188.2954145403773, 138.64000000000016, 79.77000000000018, 178.9599999999998, 230.78193829113565, 165.93999999999983, 96.01203917619739, 177.73000000000002, 187.12071792929993, 82.2428524952129, 265.21669850755274, 272.94168236420325, 311.59999999999997, 368.15, -44.06084082530136, 139.67000000000016, 148.62, -264.953929105918, -40.63095893745101, -105.17836227746216, 336.28025461637856, 230.8787406019521, 145.34122883625474, 237.83864022373564, 91.8336850900917, 131.78184282250902, 186.18238195194527, -216.58397861391748, 44.880000000000095, 303.3114577128871, 301.13016149461083, 94.23336654528829, 10.777277681518434, 50.55000000000006, -7.823670551666169, -9.184838447781477, 378.12, 86.59182016497692, 144.02045497227297, 172.67999999999992, 225.60762400895618, 188.27828244896185, 161.75999999999996, 253.6782438706598, 229.11917502913764, 60.90999999999982, 150.8748426558829, 115.50340825095326, 244.60021341349335, 78.3931627720784, 156.16373356511002, 95.72000000000011, 98.56649464011863, 232.37354799373992, 231.46297813750357, 63.55888441414307, 121.99786429701757, 138.97000000000037, 82.42939226954148, 138.6730063871395, 166.17115559441055, 25.49026754858832, 200.13726132465345, 278.4574769275576, 77.91630492246506, 119.59000000000052, 211.97165323662338, 332.1902277611796, 234.63173025232564, 132.27935804011463, 44.94999999999998, 389.4865927756938, 48.19080845903651, 206.7671802108723], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-312.25629837209704, -391.419991998816, -7.9818034672098275, 153.94754598239894, 131.80328000926667, 78.8538875104676, -432.56490110794886, -182.0730536158278, -226.13874269676552, -85.34608633342438, -401.7146351006654, -420.0015803946386, -89.685527501246, 82.44079996644192, 114.39753635736385, -141.82843707251925, -39.959758013592996, -304.32035623371036, -141.2457277330459, -306.605500745271, -161.0191563465718, -2.0771159490901745, -422.1415270592482, -176.620002165952, -313.7118980324619, -67.19964663556522, -246.50738500531045, -261.88118461208296, 107.11102907020671, 118.57536050368356, 4.710745221085757, 45.49340803332844, 142.2934612344772, -122.47954632761689, -130.88767101341426, -354.669599330856, 123.76163131550096, -150.2770594301749, -142.6675735836369, 76.64030647449246, -9.451569324780074, -79.91875580925031, 129.82394669867955, 60.95542021655595, -261.2119510483716, -37.88732357128986, 130.7, -50.610886298585996, 23.318024167876864, 2.6341066286742496, -123.65744753126303, 87.09190737528192, 31.982113694155046, -226.65118211754296, -102.7478400305175, 20.895373097469104, -312.0866749168186, 2.601347019749203, -24.760123042326217, 164.20594958552897, -195.65162098062592, 152.40288518137152, -18.69626024195539, 129.57210710119563, -228.9170334147109, -269.39972369716327, 155.2790864632683, -306.06844655760244, -69.03626593615758, 67.01844844647188, -181.32069496696155, -81.37595236488323, 89.98382111154633, 50.30395060545941, 116.5166949332203, 17.151717050084258, 128.52502417891503, 123.42356378768868, 156.9151155253629, 181.26128222985284, -160.94556210981887, -177.5570799181804, 30.146115715491213, -256.71727670558977, -275.059947132851, 20.104113367516582, -576.1289116292235, -520.4241881524647, -480.3516357487767, -482.76860080950064, -153.0043216180232, -342.9759057407005, -35.30917044548188, -486.6276482278304, 62.68414624443281, 11.269951946635553, -49.99413862398655, -684.5836317911838, 8.222240456396182, -115.14883815947405, -19.32719503407792, -294.28389876885706, -322.7979338848154, -5.8543936882275105, 6.266901772182692, -73.82475548791555, -476.8326794872154, -353.4739805463083, -210.2213874604535, -246.27285086440543, 110.27744386123875, 106.62068389722134, 92.0671816046358, 96.22320494200116, -42.24155809923105, -43.63621621798393, -73.65026297851541, -315.50072033012935, -332.15615970863007, -327.3608243852128, -161.93261501530773, -341.74238648158325, -192.91232750589873, -214.42285147387818, 193.09890252259106, 166.5841631469808, -46.17147937113053, -252.706169055231, -255.33718081810449, -442.55824779483675, 93.1934995190626, -59.805223287211696, 181.20412183107058, -94.37645058937967, -299.9338839178583, -479.2368767226328, 158.4891727246229, -137.9993953831267, -481.6366659648458, -189.103707871416, -27.9644816747672, 25.456309023199935, -295.8353694244052, -302.31499516832884, -9.402187720746916, 75.92538528601368, -16.57755533281183, -285.59151949591484, -144.63944011002818, -263.71274609880356, -373.6971010437394, -387.10800423341817, -283.804272629484, 71.49258572577641, -52.21401694335239, -128.10730655876992, -76.31411057990832, -250.47507146284767, 191.93365615794886, -200.16247619423862, -101.08585687458178, 5.124998565104109, -390.5146049679809, -484.5389103129172, -106.57950795711186, -137.61344556006753, 64.15732198046335, -215.41844380060266, -46.67159670946859, -206.8678733347382, -50.475444891353995, -116.49556689102259, -133.65757985570303, -143.92262859942457, -367.78281406228183, -142.34298367571677, 42.8970572597372, -276.3706151272592, -36.4623997261817, -74.69845011838112, -94.99498504219945, -439.2623323841164, -33.21369770236553, -61.59683563147089, -50.81020661288925, -462.53737856122564, 114.06495688610204, 161.2984679111038, 170.59869557005322, -192.87911663878805, -166.26159884391794, -136.356737347707, -318.2736493555532, -197.53187918628123, -263.12555166070257, 115.5422457349088, -224.13639138278143, -91.41889967130673, -520.5283210678589, 160.44609580417534], "policy_predator_policy_reward": [310.53458803551234, 342.4035411404534, 9.881803467209787, 10.35245401760106, 31.306719990733324, 77.23611248953242, 395.31140037310416, 287.16838352526554, 264.2442767411554, 43.89399365920854, 588.7120892251385, 145.00251585470306, 75.82265679355316, 160.937083670541, 53.43438597787295, 134.3365147372831, 210.08155154986054, 171.9273826338391, 144.74606447990743, 319.7051639984091, 162.1791563465716, 131.08711594909013, 332.49288388453164, 409.5724081431711, 344.2823773552705, 101.70179749721072, 238.64494068788156, 395.2802820579859, 32.952449902965675, 47.708637881983925, 46.51777718753433, 13.647629187475292, 31.716538765522806, 123.80954632761687, 14.91961007717198, 406.97081151023747, 95.75431531718483, 102.47939231452484, 145.7029017709907, 62.8613702674458, 146.67792674014427, 52.28239839388593, 23.476053301320285, 18.10457978344453, 279.6098514389386, 137.35967435339722, 78.09434313940307, 16.486543159182773, 147.283919240801, 16.902298480075945, 132.11109929368644, 143.25547777929805, 86.08453903447693, 296.87994392928834, 104.28784003051828, 116.20462690253095, 377.0866749168186, 12.168652980250776, 24.791035788151706, 14.723137668645796, 192.8463378237521, 81.18433626663786, 19.282533799719797, 35.781619341040226, 375.80701540210885, 218.52178088596256, 249.59297800267362, 78.92638209166086, 188.003481770935, 1.1350536480513795, 217.0560293360142, 127.88347049104257, 70.92861192042275, 54.00031487012423, 1.6632994451236285, 137.60997093577495, 46.52497582108498, 13.126436212311331, 28.084884474637114, 1.8887177701471454, 293.4541933810172, 0.987607821678923, 124.11385437560679, 242.1273066144911, 172.60593470087792, 230.96989906445592, 123.81233253515896, 707.7868381406114, 571.6869590428217, 350.8023185780047, 89.70354669874608, 301.09831838251455, 391.4508733387507, 466.7661999509411, 23.47952097149251, 133.4451214393914, 474.683777721053, 405.23522153037277, 105.28584843392399, 239.47938949288954, 193.00191138109378, 212.44286751193275, 302.96791758920534, 157.46625280634677, 7.1364858110549, 246.60374985662327, 54.68520891045319, 559.0374725091538, 211.08138746045276, 290.29285086440535, 7.2529592847653035, 79.16037066966165, 58.49531038159929, 54.34446456637466, 93.86719757795449, 86.24394328454822, 2.875889830851672, 397.05237115931146, 332.70615970863, 377.3608243852127, 135.67735414007052, 360.17397680515427, 77.2832090738481, 320.86713145814736, 1.9310974774089544, 16.50583685301919, 2.893108229482003, 382.57636036185613, 347.65901269890196, 494.2568708863122, 77.80650048093743, 61.48522328721138, 46.13312002824392, 92.64683273902234, 555.1427986532045, 412.3062444362482, 1.8908272753770907, 139.37939538312546, 499.3908079571346, 425.02780974978674, 140.60943602615774, 91.01791165454723, 355.8353694244051, 303.22499516832806, 78.9295268387728, 5.422118251843422, 143.52209543473305, 274.1503876449464, 405.15599644257566, 247.79640317974946, 411.38506180514395, 427.8132062440921, 123.69556438350803, 244.7798560853084, 53.93401694335205, 222.10730655876984, 159.49334990176754, 265.8623267811059, 195.15849967580002, 45.4438683542291, 11.756477817794526, 315.66735862918654, 518.6326077698485, 419.9797919251928, 160.0346072337616, 206.15621058043524, 73.84267801953665, 216.3884438006019, 5.496766374497155, 330.4720959392508, 223.10829539129813, 82.53572277821819, 314.3260767313285, 129.42528731820966, 1.250678173326879, 534.3653871132601, 144.9486775595319, 288.6621416326433, 174.1299307305918, 215.48839604152866, 250.79139211837688, 361.3822302304044, 151.21369770236555, 63.18683563147067, 344.33661511557483, 380.9826232951633, 53.896385745561766, 2.930417218412048, 69.82314882967155, 187.08900249138875, 237.367825267433, 197.52986896430642, 363.90170804273225, 196.85382049910166, 281.2795002426712, 255.79039845881636, 339.64871196007556, 24.09738755304959, 520.4330689040828, 46.41633657047304]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.834722902196195, "mean_inference_ms": 2.433297013250111, "mean_action_processing_ms": 0.33383656984484816, "mean_env_wait_ms": 0.2984877227997821, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005911111831665039, "StateBufferConnector_ms": 0.003364086151123047, "ViewRequirementAgentConnector_ms": 0.13441693782806396}, "num_episodes": 22, "episode_return_max": 389.4865927756938, "episode_return_min": -264.953929105918, "episode_return_mean": 140.52074435667177, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 259.7623204594326, "num_env_steps_trained_throughput_per_sec": 259.7623204594326, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 15645.716, "restore_workers_time_ms": 0.013, "training_step_time_ms": 15645.657, "sample_time_ms": 1861.991, "learn_time_ms": 13755.926, "learn_throughput": 290.784, "synch_weights_time_ms": 24.33}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 18, "trial_id": "61e09_00000", "date": "2024-08-16_16-11-06", "timestamp": 1723804866, "time_this_iter_s": 15.434682846069336, "time_total_s": 268.53033924102783, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b25495e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 268.53033924102783, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 60.50909090909092, "ram_util_percent": 82.00909090909092}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8038633288845185, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.260245576485124, "policy_loss": -0.008733232886032768, "vf_loss": 6.266887051970871, "vf_explained_var": -0.008794447038539504, "kl": 0.010458793269835903, "entropy": 1.3080145553937035, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.913784118682619, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.390325295735919, "policy_loss": -0.010952535778451612, "vf_loss": 7.398496943428403, "vf_explained_var": 0.14873237496330624, "kl": 0.013904411500603427, "entropy": 1.2707993937547875, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 389.4865927756938, "episode_reward_min": -264.953929105918, "episode_reward_mean": 153.46694291456504, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -684.5836317911838, "predator_policy": 0.987607821678923}, "policy_reward_max": {"prey_policy": 195.86265631801263, "predator_policy": 707.7868381406114}, "policy_reward_mean": {"prey_policy": -102.35282563809514, "predator_policy": 179.08629709537766}, "custom_metrics": {}, "hist_stats": {"episode_reward": [174.66999999999985, 190.13834851742774, 238.8010369170034, 188.2954145403773, 138.64000000000016, 79.77000000000018, 178.9599999999998, 230.78193829113565, 165.93999999999983, 96.01203917619739, 177.73000000000002, 187.12071792929993, 82.2428524952129, 265.21669850755274, 272.94168236420325, 311.59999999999997, 368.15, -44.06084082530136, 139.67000000000016, 148.62, -264.953929105918, -40.63095893745101, -105.17836227746216, 336.28025461637856, 230.8787406019521, 145.34122883625474, 237.83864022373564, 91.8336850900917, 131.78184282250902, 186.18238195194527, -216.58397861391748, 44.880000000000095, 303.3114577128871, 301.13016149461083, 94.23336654528829, 10.777277681518434, 50.55000000000006, -7.823670551666169, -9.184838447781477, 378.12, 86.59182016497692, 144.02045497227297, 172.67999999999992, 225.60762400895618, 188.27828244896185, 161.75999999999996, 253.6782438706598, 229.11917502913764, 60.90999999999982, 150.8748426558829, 115.50340825095326, 244.60021341349335, 78.3931627720784, 156.16373356511002, 95.72000000000011, 98.56649464011863, 232.37354799373992, 231.46297813750357, 63.55888441414307, 121.99786429701757, 138.97000000000037, 82.42939226954148, 138.6730063871395, 166.17115559441055, 25.49026754858832, 200.13726132465345, 278.4574769275576, 77.91630492246506, 119.59000000000052, 211.97165323662338, 332.1902277611796, 234.63173025232564, 132.27935804011463, 44.94999999999998, 389.4865927756938, 48.19080845903651, 206.7671802108723, 152.40999999999977, 248.59971425804042, 4.135533369654153, 189.81482494435807, 193.19291146531026, 207.37918670028063, 154.95509830367854, 2.469999999999988, 160.13467674857003, 239.99000000000007, 262.48523865305856, 242.65857531682346, 160.32, 25.97000000000033, 316.9306439516502, 161.61894264215206, 106.09615075721734, 126.56794895721195, 135.3645797420015, 220.60673891650256, 213.40300644524444, 167.0196660836272, 224.38452029983134], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [130.7, -50.610886298585996, 23.318024167876864, 2.6341066286742496, -123.65744753126303, 87.09190737528192, 31.982113694155046, -226.65118211754296, -102.7478400305175, 20.895373097469104, -312.0866749168186, 2.601347019749203, -24.760123042326217, 164.20594958552897, -195.65162098062592, 152.40288518137152, -18.69626024195539, 129.57210710119563, -228.9170334147109, -269.39972369716327, 155.2790864632683, -306.06844655760244, -69.03626593615758, 67.01844844647188, -181.32069496696155, -81.37595236488323, 89.98382111154633, 50.30395060545941, 116.5166949332203, 17.151717050084258, 128.52502417891503, 123.42356378768868, 156.9151155253629, 181.26128222985284, -160.94556210981887, -177.5570799181804, 30.146115715491213, -256.71727670558977, -275.059947132851, 20.104113367516582, -576.1289116292235, -520.4241881524647, -480.3516357487767, -482.76860080950064, -153.0043216180232, -342.9759057407005, -35.30917044548188, -486.6276482278304, 62.68414624443281, 11.269951946635553, -49.99413862398655, -684.5836317911838, 8.222240456396182, -115.14883815947405, -19.32719503407792, -294.28389876885706, -322.7979338848154, -5.8543936882275105, 6.266901772182692, -73.82475548791555, -476.8326794872154, -353.4739805463083, -210.2213874604535, -246.27285086440543, 110.27744386123875, 106.62068389722134, 92.0671816046358, 96.22320494200116, -42.24155809923105, -43.63621621798393, -73.65026297851541, -315.50072033012935, -332.15615970863007, -327.3608243852128, -161.93261501530773, -341.74238648158325, -192.91232750589873, -214.42285147387818, 193.09890252259106, 166.5841631469808, -46.17147937113053, -252.706169055231, -255.33718081810449, -442.55824779483675, 93.1934995190626, -59.805223287211696, 181.20412183107058, -94.37645058937967, -299.9338839178583, -479.2368767226328, 158.4891727246229, -137.9993953831267, -481.6366659648458, -189.103707871416, -27.9644816747672, 25.456309023199935, -295.8353694244052, -302.31499516832884, -9.402187720746916, 75.92538528601368, -16.57755533281183, -285.59151949591484, -144.63944011002818, -263.71274609880356, -373.6971010437394, -387.10800423341817, -283.804272629484, 71.49258572577641, -52.21401694335239, -128.10730655876992, -76.31411057990832, -250.47507146284767, 191.93365615794886, -200.16247619423862, -101.08585687458178, 5.124998565104109, -390.5146049679809, -484.5389103129172, -106.57950795711186, -137.61344556006753, 64.15732198046335, -215.41844380060266, -46.67159670946859, -206.8678733347382, -50.475444891353995, -116.49556689102259, -133.65757985570303, -143.92262859942457, -367.78281406228183, -142.34298367571677, 42.8970572597372, -276.3706151272592, -36.4623997261817, -74.69845011838112, -94.99498504219945, -439.2623323841164, -33.21369770236553, -61.59683563147089, -50.81020661288925, -462.53737856122564, 114.06495688610204, 161.2984679111038, 170.59869557005322, -192.87911663878805, -166.26159884391794, -136.356737347707, -318.2736493555532, -197.53187918628123, -263.12555166070257, 115.5422457349088, -224.13639138278143, -91.41889967130673, -520.5283210678589, 160.44609580417534, -405.2130977674834, 85.56274085385317, 107.93, 36.01206100161544, -172.51952654674045, -0.6863666435775846, -82.10281418171999, 52.02672700560896, 103.6559751107723, 2.0000000000000013, -63.63059649674449, 78.39227511554414, 7.098340844917519, 0.9790764191079183, -6.807791530246268, -249.74011032008238, -21.01538253315087, -0.6358060884479266, -49.02447401936827, 195.86265631801263, -20.038387619418124, -78.12820584348951, -32.71579656704612, 139.56352363091972, -92.43472912252756, 109.91797065585953, -180.87949427938764, -2.7901782190104063, -162.4155433784786, -113.88963613946254, -32.55275603345953, -0.9664448158931118, -49.0164564606041, -269.406022376059, -15.770069848712774, -23.55988624415813, 4.658772292613728, -45.16780171276847, 13.323857796006987, -68.04493253202969, -124.7002692885167, -29.292456075774673, -3.863973983631701, -97.90957718107892, -47.8232086935902, -73.74520443089955], "policy_predator_policy_reward": [78.09434313940307, 16.486543159182773, 147.283919240801, 16.902298480075945, 132.11109929368644, 143.25547777929805, 86.08453903447693, 296.87994392928834, 104.28784003051828, 116.20462690253095, 377.0866749168186, 12.168652980250776, 24.791035788151706, 14.723137668645796, 192.8463378237521, 81.18433626663786, 19.282533799719797, 35.781619341040226, 375.80701540210885, 218.52178088596256, 249.59297800267362, 78.92638209166086, 188.003481770935, 1.1350536480513795, 217.0560293360142, 127.88347049104257, 70.92861192042275, 54.00031487012423, 1.6632994451236285, 137.60997093577495, 46.52497582108498, 13.126436212311331, 28.084884474637114, 1.8887177701471454, 293.4541933810172, 0.987607821678923, 124.11385437560679, 242.1273066144911, 172.60593470087792, 230.96989906445592, 123.81233253515896, 707.7868381406114, 571.6869590428217, 350.8023185780047, 89.70354669874608, 301.09831838251455, 391.4508733387507, 466.7661999509411, 23.47952097149251, 133.4451214393914, 474.683777721053, 405.23522153037277, 105.28584843392399, 239.47938949288954, 193.00191138109378, 212.44286751193275, 302.96791758920534, 157.46625280634677, 7.1364858110549, 246.60374985662327, 54.68520891045319, 559.0374725091538, 211.08138746045276, 290.29285086440535, 7.2529592847653035, 79.16037066966165, 58.49531038159929, 54.34446456637466, 93.86719757795449, 86.24394328454822, 2.875889830851672, 397.05237115931146, 332.70615970863, 377.3608243852127, 135.67735414007052, 360.17397680515427, 77.2832090738481, 320.86713145814736, 1.9310974774089544, 16.50583685301919, 2.893108229482003, 382.57636036185613, 347.65901269890196, 494.2568708863122, 77.80650048093743, 61.48522328721138, 46.13312002824392, 92.64683273902234, 555.1427986532045, 412.3062444362482, 1.8908272753770907, 139.37939538312546, 499.3908079571346, 425.02780974978674, 140.60943602615774, 91.01791165454723, 355.8353694244051, 303.22499516832806, 78.9295268387728, 5.422118251843422, 143.52209543473305, 274.1503876449464, 405.15599644257566, 247.79640317974946, 411.38506180514395, 427.8132062440921, 123.69556438350803, 244.7798560853084, 53.93401694335205, 222.10730655876984, 159.49334990176754, 265.8623267811059, 195.15849967580002, 45.4438683542291, 11.756477817794526, 315.66735862918654, 518.6326077698485, 419.9797919251928, 160.0346072337616, 206.15621058043524, 73.84267801953665, 216.3884438006019, 5.496766374497155, 330.4720959392508, 223.10829539129813, 82.53572277821819, 314.3260767313285, 129.42528731820966, 1.250678173326879, 534.3653871132601, 144.9486775595319, 288.6621416326433, 174.1299307305918, 215.48839604152866, 250.79139211837688, 361.3822302304044, 151.21369770236555, 63.18683563147067, 344.33661511557483, 380.9826232951633, 53.896385745561766, 2.930417218412048, 69.82314882967155, 187.08900249138875, 237.367825267433, 197.52986896430642, 363.90170804273225, 196.85382049910166, 281.2795002426712, 255.79039845881636, 339.64871196007556, 24.09738755304959, 520.4330689040828, 46.41633657047304, 405.62309776748305, 66.43725914614681, 12.885371800796651, 91.7722814556285, 151.15191012682246, 26.189516433148533, 195.7997399241464, 24.09117219632352, 38.12358781460655, 49.41334853993178, 116.78997040416553, 75.82753767731552, 135.42237173148888, 11.455309308164113, 8.737791530246227, 250.28011032008212, 108.69880421756415, 73.08706115260468, 91.01447401936875, 2.1373436819873586, 164.46786008281944, 196.1839720331465, 129.2867747460483, 6.524073506902173, 93.75472912252822, 49.082029344140466, 200.40332277101706, 9.236349727380016, 222.975330080561, 370.26049338903033, 145.59769296357936, 49.54045052792545, 7.850144142807794, 416.6684854510728, 28.7382361115921, 137.15966893849037, 29.951737014039708, 145.92187214811665, 185.93565285453212, 89.39216079799313, 191.87990176417136, 175.51583004536423, 155.8870243313916, 112.90619291694728, 192.93670396436985, 153.01622945995135]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8274742403490859, "mean_inference_ms": 2.4324965827777616, "mean_action_processing_ms": 0.3326279795040042, "mean_env_wait_ms": 0.29718692901219845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005147457122802734, "StateBufferConnector_ms": 0.0037508010864257812, "ViewRequirementAgentConnector_ms": 0.12323474884033203}, "num_episodes": 23, "episode_return_max": 389.4865927756938, "episode_return_min": -264.953929105918, "episode_return_mean": 153.46694291456504, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 263.02248688674905, "num_env_steps_trained_throughput_per_sec": 263.02248688674905, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 15636.515, "restore_workers_time_ms": 0.013, "training_step_time_ms": 15636.456, "sample_time_ms": 1855.916, "learn_time_ms": 13752.976, "learn_throughput": 290.846, "synch_weights_time_ms": 24.24}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 19, "trial_id": "61e09_00000", "date": "2024-08-16_16-11-21", "timestamp": 1723804881, "time_this_iter_s": 15.257806062698364, "time_total_s": 283.7881453037262, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2549160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 283.7881453037262, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 61.17727272727272, "ram_util_percent": 81.83181818181819}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8289201677476288, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.9166491879357235, "policy_loss": -0.012221358411467423, "vf_loss": 5.926537057583925, "vf_explained_var": 0.02384210295147366, "kl": 0.011667477257721565, "entropy": 1.2753765147829812, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.598010768808385, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.950081488695094, "policy_loss": -0.007454398348828945, "vf_loss": 6.955306066028656, "vf_explained_var": 0.04604506965667483, "kl": 0.011149148632737329, "entropy": 1.2825520010221572, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 389.4865927756938, "episode_reward_min": -264.953929105918, "episode_reward_mean": 153.31078168595957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -684.5836317911838, "predator_policy": 1.250678173326879}, "policy_reward_max": {"prey_policy": 195.86265631801263, "predator_policy": 707.7868381406114}, "policy_reward_mean": {"prey_policy": -103.17674332510052, "predator_policy": 179.83213416808027}, "custom_metrics": {}, "hist_stats": {"episode_reward": [139.67000000000016, 148.62, -264.953929105918, -40.63095893745101, -105.17836227746216, 336.28025461637856, 230.8787406019521, 145.34122883625474, 237.83864022373564, 91.8336850900917, 131.78184282250902, 186.18238195194527, -216.58397861391748, 44.880000000000095, 303.3114577128871, 301.13016149461083, 94.23336654528829, 10.777277681518434, 50.55000000000006, -7.823670551666169, -9.184838447781477, 378.12, 86.59182016497692, 144.02045497227297, 172.67999999999992, 225.60762400895618, 188.27828244896185, 161.75999999999996, 253.6782438706598, 229.11917502913764, 60.90999999999982, 150.8748426558829, 115.50340825095326, 244.60021341349335, 78.3931627720784, 156.16373356511002, 95.72000000000011, 98.56649464011863, 232.37354799373992, 231.46297813750357, 63.55888441414307, 121.99786429701757, 138.97000000000037, 82.42939226954148, 138.6730063871395, 166.17115559441055, 25.49026754858832, 200.13726132465345, 278.4574769275576, 77.91630492246506, 119.59000000000052, 211.97165323662338, 332.1902277611796, 234.63173025232564, 132.27935804011463, 44.94999999999998, 389.4865927756938, 48.19080845903651, 206.7671802108723, 152.40999999999977, 248.59971425804042, 4.135533369654153, 189.81482494435807, 193.19291146531026, 207.37918670028063, 154.95509830367854, 2.469999999999988, 160.13467674857003, 239.99000000000007, 262.48523865305856, 242.65857531682346, 160.32, 25.97000000000033, 316.9306439516502, 161.61894264215206, 106.09615075721734, 126.56794895721195, 135.3645797420015, 220.60673891650256, 213.40300644524444, 167.0196660836272, 224.38452029983134, 127.1504514279861, 193.32528681709414, 289.340483010789, 132.98000000000025, 310.6779292967165, 193.37264617336058, 229.539597207991, 152.92000000000007, 111.79831385377165, 244.67131648002595, 230.82431118974102, 307.15781127526793, 124.04000000000025, 3.7899999999999636, 203.7387190294255, 99.96689929039049, 242.31000000000023, 89.73000000000012], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [30.146115715491213, -256.71727670558977, -275.059947132851, 20.104113367516582, -576.1289116292235, -520.4241881524647, -480.3516357487767, -482.76860080950064, -153.0043216180232, -342.9759057407005, -35.30917044548188, -486.6276482278304, 62.68414624443281, 11.269951946635553, -49.99413862398655, -684.5836317911838, 8.222240456396182, -115.14883815947405, -19.32719503407792, -294.28389876885706, -322.7979338848154, -5.8543936882275105, 6.266901772182692, -73.82475548791555, -476.8326794872154, -353.4739805463083, -210.2213874604535, -246.27285086440543, 110.27744386123875, 106.62068389722134, 92.0671816046358, 96.22320494200116, -42.24155809923105, -43.63621621798393, -73.65026297851541, -315.50072033012935, -332.15615970863007, -327.3608243852128, -161.93261501530773, -341.74238648158325, -192.91232750589873, -214.42285147387818, 193.09890252259106, 166.5841631469808, -46.17147937113053, -252.706169055231, -255.33718081810449, -442.55824779483675, 93.1934995190626, -59.805223287211696, 181.20412183107058, -94.37645058937967, -299.9338839178583, -479.2368767226328, 158.4891727246229, -137.9993953831267, -481.6366659648458, -189.103707871416, -27.9644816747672, 25.456309023199935, -295.8353694244052, -302.31499516832884, -9.402187720746916, 75.92538528601368, -16.57755533281183, -285.59151949591484, -144.63944011002818, -263.71274609880356, -373.6971010437394, -387.10800423341817, -283.804272629484, 71.49258572577641, -52.21401694335239, -128.10730655876992, -76.31411057990832, -250.47507146284767, 191.93365615794886, -200.16247619423862, -101.08585687458178, 5.124998565104109, -390.5146049679809, -484.5389103129172, -106.57950795711186, -137.61344556006753, 64.15732198046335, -215.41844380060266, -46.67159670946859, -206.8678733347382, -50.475444891353995, -116.49556689102259, -133.65757985570303, -143.92262859942457, -367.78281406228183, -142.34298367571677, 42.8970572597372, -276.3706151272592, -36.4623997261817, -74.69845011838112, -94.99498504219945, -439.2623323841164, -33.21369770236553, -61.59683563147089, -50.81020661288925, -462.53737856122564, 114.06495688610204, 161.2984679111038, 170.59869557005322, -192.87911663878805, -166.26159884391794, -136.356737347707, -318.2736493555532, -197.53187918628123, -263.12555166070257, 115.5422457349088, -224.13639138278143, -91.41889967130673, -520.5283210678589, 160.44609580417534, -405.2130977674834, 85.56274085385317, 107.93, 36.01206100161544, -172.51952654674045, -0.6863666435775846, -82.10281418171999, 52.02672700560896, 103.6559751107723, 2.0000000000000013, -63.63059649674449, 78.39227511554414, 7.098340844917519, 0.9790764191079183, -6.807791530246268, -249.74011032008238, -21.01538253315087, -0.6358060884479266, -49.02447401936827, 195.86265631801263, -20.038387619418124, -78.12820584348951, -32.71579656704612, 139.56352363091972, -92.43472912252756, 109.91797065585953, -180.87949427938764, -2.7901782190104063, -162.4155433784786, -113.88963613946254, -32.55275603345953, -0.9664448158931118, -49.0164564606041, -269.406022376059, -15.770069848712774, -23.55988624415813, 4.658772292613728, -45.16780171276847, 13.323857796006987, -68.04493253202969, -124.7002692885167, -29.292456075774673, -3.863973983631701, -97.90957718107892, -47.8232086935902, -73.74520443089955, -2.8392302083981633, -94.79659473419146, -44.051876596763876, -70.48111199394937, 62.32269415023082, -233.4935895357334, 51.47482306772453, -55.72493780348227, -66.53295591791222, -223.55003338933312, -116.21400187106795, 2.0000000000000013, 16.128946855361686, -116.49646831439794, -11.07567100307302, 74.05414336932206, -73.0887123540556, -110.75726632894106, 86.63144951590525, 115.73555470800537, 21.02730217358062, -23.6295136211685, 94.89082987835025, 21.810981578519037, -13.644509072671127, -174.80960105772638, -16.116482376328644, -13.980519755043007, 30.760823783571936, -17.82357167865093, -6.677267956969459, -171.35668603863988, 138.48943288895762, 68.1320399060611, -10.389868834367656, 21.58763522425945], "policy_predator_policy_reward": [124.11385437560679, 242.1273066144911, 172.60593470087792, 230.96989906445592, 123.81233253515896, 707.7868381406114, 571.6869590428217, 350.8023185780047, 89.70354669874608, 301.09831838251455, 391.4508733387507, 466.7661999509411, 23.47952097149251, 133.4451214393914, 474.683777721053, 405.23522153037277, 105.28584843392399, 239.47938949288954, 193.00191138109378, 212.44286751193275, 302.96791758920534, 157.46625280634677, 7.1364858110549, 246.60374985662327, 54.68520891045319, 559.0374725091538, 211.08138746045276, 290.29285086440535, 7.2529592847653035, 79.16037066966165, 58.49531038159929, 54.34446456637466, 93.86719757795449, 86.24394328454822, 2.875889830851672, 397.05237115931146, 332.70615970863, 377.3608243852127, 135.67735414007052, 360.17397680515427, 77.2832090738481, 320.86713145814736, 1.9310974774089544, 16.50583685301919, 2.893108229482003, 382.57636036185613, 347.65901269890196, 494.2568708863122, 77.80650048093743, 61.48522328721138, 46.13312002824392, 92.64683273902234, 555.1427986532045, 412.3062444362482, 1.8908272753770907, 139.37939538312546, 499.3908079571346, 425.02780974978674, 140.60943602615774, 91.01791165454723, 355.8353694244051, 303.22499516832806, 78.9295268387728, 5.422118251843422, 143.52209543473305, 274.1503876449464, 405.15599644257566, 247.79640317974946, 411.38506180514395, 427.8132062440921, 123.69556438350803, 244.7798560853084, 53.93401694335205, 222.10730655876984, 159.49334990176754, 265.8623267811059, 195.15849967580002, 45.4438683542291, 11.756477817794526, 315.66735862918654, 518.6326077698485, 419.9797919251928, 160.0346072337616, 206.15621058043524, 73.84267801953665, 216.3884438006019, 5.496766374497155, 330.4720959392508, 223.10829539129813, 82.53572277821819, 314.3260767313285, 129.42528731820966, 1.250678173326879, 534.3653871132601, 144.9486775595319, 288.6621416326433, 174.1299307305918, 215.48839604152866, 250.79139211837688, 361.3822302304044, 151.21369770236555, 63.18683563147067, 344.33661511557483, 380.9826232951633, 53.896385745561766, 2.930417218412048, 69.82314882967155, 187.08900249138875, 237.367825267433, 197.52986896430642, 363.90170804273225, 196.85382049910166, 281.2795002426712, 255.79039845881636, 339.64871196007556, 24.09738755304959, 520.4330689040828, 46.41633657047304, 405.62309776748305, 66.43725914614681, 12.885371800796651, 91.7722814556285, 151.15191012682246, 26.189516433148533, 195.7997399241464, 24.09117219632352, 38.12358781460655, 49.41334853993178, 116.78997040416553, 75.82753767731552, 135.42237173148888, 11.455309308164113, 8.737791530246227, 250.28011032008212, 108.69880421756415, 73.08706115260468, 91.01447401936875, 2.1373436819873586, 164.46786008281944, 196.1839720331465, 129.2867747460483, 6.524073506902173, 93.75472912252822, 49.082029344140466, 200.40332277101706, 9.236349727380016, 222.975330080561, 370.26049338903033, 145.59769296357936, 49.54045052792545, 7.850144142807794, 416.6684854510728, 28.7382361115921, 137.15966893849037, 29.951737014039708, 145.92187214811665, 185.93565285453212, 89.39216079799313, 191.87990176417136, 175.51583004536423, 155.8870243313916, 112.90619291694728, 192.93670396436985, 153.01622945995135, 101.20588873257333, 123.58038763800195, 165.6487085859458, 142.20956682186153, 247.9521277775634, 212.5592506187285, 79.73517693227551, 57.49493780348192, 314.3962462697175, 286.36467233424446, 148.54248636228616, 159.0441616821429, 104.28321666452375, 225.62390200250346, 12.98567100307298, 76.95585663067794, 247.4387095468063, 48.20558298996221, 34.65083633902874, 7.653475917086581, 131.790852023403, 101.63567061392583, 61.03460154720465, 129.42139827119448, 136.6645090726711, 175.82960105772577, 17.996482376328938, 15.890519755042966, 147.62434615503335, 43.17712076947104, 233.76314892344834, 44.23770436255124, 19.10336267456498, 16.58516453041629, 12.329868834367614, 66.20236477574055]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8241724931426253, "mean_inference_ms": 2.433161226939075, "mean_action_processing_ms": 0.33131492975568805, "mean_env_wait_ms": 0.29537994689243857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012378096580505371, "StateBufferConnector_ms": 0.003721475601196289, "ViewRequirementAgentConnector_ms": 0.11529898643493652}, "num_episodes": 18, "episode_return_max": 389.4865927756938, "episode_return_min": -264.953929105918, "episode_return_mean": 153.31078168595957, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.7465804620062, "num_env_steps_trained_throughput_per_sec": 267.7465804620062, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 15569.019, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15568.959, "sample_time_ms": 1852.383, "learn_time_ms": 13688.255, "learn_throughput": 292.221, "synch_weights_time_ms": 24.664}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 20, "trial_id": "61e09_00000", "date": "2024-08-16_16-11-36", "timestamp": 1723804896, "time_this_iter_s": 14.976098775863647, "time_total_s": 298.76424407958984, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b249b9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 298.76424407958984, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 61.395238095238106, "ram_util_percent": 81.82857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.886626448233922, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.478490073592575, "policy_loss": -0.012812923480973397, "vf_loss": 5.489415201055941, "vf_explained_var": 0.0005927327133360363, "kl": 0.009439021084374818, "entropy": 1.2193238202856962, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.834912699713278, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.328174383173544, "policy_loss": -0.007236023230734404, "vf_loss": 6.333481327188078, "vf_explained_var": -0.06293619066949875, "kl": 0.009645405064191806, "entropy": 1.3032647822269057, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 389.4865927756938, "episode_reward_min": -233.91381239707147, "episode_reward_mean": 151.15912452126443, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -824.0791047381845, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 195.86265631801263, "predator_policy": 973.1339925691149}, "policy_reward_mean": {"prey_policy": -88.49754663842128, "predator_policy": 164.07710889905343}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.55000000000006, -7.823670551666169, -9.184838447781477, 378.12, 86.59182016497692, 144.02045497227297, 172.67999999999992, 225.60762400895618, 188.27828244896185, 161.75999999999996, 253.6782438706598, 229.11917502913764, 60.90999999999982, 150.8748426558829, 115.50340825095326, 244.60021341349335, 78.3931627720784, 156.16373356511002, 95.72000000000011, 98.56649464011863, 232.37354799373992, 231.46297813750357, 63.55888441414307, 121.99786429701757, 138.97000000000037, 82.42939226954148, 138.6730063871395, 166.17115559441055, 25.49026754858832, 200.13726132465345, 278.4574769275576, 77.91630492246506, 119.59000000000052, 211.97165323662338, 332.1902277611796, 234.63173025232564, 132.27935804011463, 44.94999999999998, 389.4865927756938, 48.19080845903651, 206.7671802108723, 152.40999999999977, 248.59971425804042, 4.135533369654153, 189.81482494435807, 193.19291146531026, 207.37918670028063, 154.95509830367854, 2.469999999999988, 160.13467674857003, 239.99000000000007, 262.48523865305856, 242.65857531682346, 160.32, 25.97000000000033, 316.9306439516502, 161.61894264215206, 106.09615075721734, 126.56794895721195, 135.3645797420015, 220.60673891650256, 213.40300644524444, 167.0196660836272, 224.38452029983134, 127.1504514279861, 193.32528681709414, 289.340483010789, 132.98000000000025, 310.6779292967165, 193.37264617336058, 229.539597207991, 152.92000000000007, 111.79831385377165, 244.67131648002595, 230.82431118974102, 307.15781127526793, 124.04000000000025, 3.7899999999999636, 203.7387190294255, 99.96689929039049, 242.31000000000023, 89.73000000000012, -40.432977140305205, 8.789999999999978, 55.53604148244912, 149.91000000000008, 3.899999999999961, 3.9999999999999587, 270.9926972635103, 177.65999999999983, 3.8599999999999604, -233.91381239707147, 155.38000000000005, 152.05000000000004, 251.3345226800718, 187.13749096508275, -122.2523176352712, 259.8499999999999, 140.87000000000035, 135.57444695444], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-332.15615970863007, -327.3608243852128, -161.93261501530773, -341.74238648158325, -192.91232750589873, -214.42285147387818, 193.09890252259106, 166.5841631469808, -46.17147937113053, -252.706169055231, -255.33718081810449, -442.55824779483675, 93.1934995190626, -59.805223287211696, 181.20412183107058, -94.37645058937967, -299.9338839178583, -479.2368767226328, 158.4891727246229, -137.9993953831267, -481.6366659648458, -189.103707871416, -27.9644816747672, 25.456309023199935, -295.8353694244052, -302.31499516832884, -9.402187720746916, 75.92538528601368, -16.57755533281183, -285.59151949591484, -144.63944011002818, -263.71274609880356, -373.6971010437394, -387.10800423341817, -283.804272629484, 71.49258572577641, -52.21401694335239, -128.10730655876992, -76.31411057990832, -250.47507146284767, 191.93365615794886, -200.16247619423862, -101.08585687458178, 5.124998565104109, -390.5146049679809, -484.5389103129172, -106.57950795711186, -137.61344556006753, 64.15732198046335, -215.41844380060266, -46.67159670946859, -206.8678733347382, -50.475444891353995, -116.49556689102259, -133.65757985570303, -143.92262859942457, -367.78281406228183, -142.34298367571677, 42.8970572597372, -276.3706151272592, -36.4623997261817, -74.69845011838112, -94.99498504219945, -439.2623323841164, -33.21369770236553, -61.59683563147089, -50.81020661288925, -462.53737856122564, 114.06495688610204, 161.2984679111038, 170.59869557005322, -192.87911663878805, -166.26159884391794, -136.356737347707, -318.2736493555532, -197.53187918628123, -263.12555166070257, 115.5422457349088, -224.13639138278143, -91.41889967130673, -520.5283210678589, 160.44609580417534, -405.2130977674834, 85.56274085385317, 107.93, 36.01206100161544, -172.51952654674045, -0.6863666435775846, -82.10281418171999, 52.02672700560896, 103.6559751107723, 2.0000000000000013, -63.63059649674449, 78.39227511554414, 7.098340844917519, 0.9790764191079183, -6.807791530246268, -249.74011032008238, -21.01538253315087, -0.6358060884479266, -49.02447401936827, 195.86265631801263, -20.038387619418124, -78.12820584348951, -32.71579656704612, 139.56352363091972, -92.43472912252756, 109.91797065585953, -180.87949427938764, -2.7901782190104063, -162.4155433784786, -113.88963613946254, -32.55275603345953, -0.9664448158931118, -49.0164564606041, -269.406022376059, -15.770069848712774, -23.55988624415813, 4.658772292613728, -45.16780171276847, 13.323857796006987, -68.04493253202969, -124.7002692885167, -29.292456075774673, -3.863973983631701, -97.90957718107892, -47.8232086935902, -73.74520443089955, -2.8392302083981633, -94.79659473419146, -44.051876596763876, -70.48111199394937, 62.32269415023082, -233.4935895357334, 51.47482306772453, -55.72493780348227, -66.53295591791222, -223.55003338933312, -116.21400187106795, 2.0000000000000013, 16.128946855361686, -116.49646831439794, -11.07567100307302, 74.05414336932206, -73.0887123540556, -110.75726632894106, 86.63144951590525, 115.73555470800537, 21.02730217358062, -23.6295136211685, 94.89082987835025, 21.810981578519037, -13.644509072671127, -174.80960105772638, -16.116482376328644, -13.980519755043007, 30.760823783571936, -17.82357167865093, -6.677267956969459, -171.35668603863988, 138.48943288895762, 68.1320399060611, -10.389868834367656, 21.58763522425945, -325.54014168374806, -518.6200874851783, -596.2312239396749, -12.228370745912903, -281.1197738126353, -42.43598830469742, -38.61196280131927, 70.78122760144905, -2.269751507515429, -3.9734951955325064, 2.0000000000000013, 2.0000000000000013, -132.6290363674111, -85.43624014905728, -49.30862234695567, 148.2722200244644, -33.592057694205714, 2.0000000000000013, -445.03674106944766, -824.0791047381845, 0.9201615087461233, 140.91087820621692, -48.10289135229735, 118.29445629689951, 72.79828458547018, -113.83934488326157, 0.7549375045524988, 164.7823808415841, -472.7900049862526, -330.81047456316276, 96.57466501041006, 79.43904372450282, -64.75055925878374, 14.116293445207397, -17.165804694363565, 67.63640234047077], "policy_predator_policy_reward": [332.70615970863, 377.3608243852127, 135.67735414007052, 360.17397680515427, 77.2832090738481, 320.86713145814736, 1.9310974774089544, 16.50583685301919, 2.893108229482003, 382.57636036185613, 347.65901269890196, 494.2568708863122, 77.80650048093743, 61.48522328721138, 46.13312002824392, 92.64683273902234, 555.1427986532045, 412.3062444362482, 1.8908272753770907, 139.37939538312546, 499.3908079571346, 425.02780974978674, 140.60943602615774, 91.01791165454723, 355.8353694244051, 303.22499516832806, 78.9295268387728, 5.422118251843422, 143.52209543473305, 274.1503876449464, 405.15599644257566, 247.79640317974946, 411.38506180514395, 427.8132062440921, 123.69556438350803, 244.7798560853084, 53.93401694335205, 222.10730655876984, 159.49334990176754, 265.8623267811059, 195.15849967580002, 45.4438683542291, 11.756477817794526, 315.66735862918654, 518.6326077698485, 419.9797919251928, 160.0346072337616, 206.15621058043524, 73.84267801953665, 216.3884438006019, 5.496766374497155, 330.4720959392508, 223.10829539129813, 82.53572277821819, 314.3260767313285, 129.42528731820966, 1.250678173326879, 534.3653871132601, 144.9486775595319, 288.6621416326433, 174.1299307305918, 215.48839604152866, 250.79139211837688, 361.3822302304044, 151.21369770236555, 63.18683563147067, 344.33661511557483, 380.9826232951633, 53.896385745561766, 2.930417218412048, 69.82314882967155, 187.08900249138875, 237.367825267433, 197.52986896430642, 363.90170804273225, 196.85382049910166, 281.2795002426712, 255.79039845881636, 339.64871196007556, 24.09738755304959, 520.4330689040828, 46.41633657047304, 405.62309776748305, 66.43725914614681, 12.885371800796651, 91.7722814556285, 151.15191012682246, 26.189516433148533, 195.7997399241464, 24.09117219632352, 38.12358781460655, 49.41334853993178, 116.78997040416553, 75.82753767731552, 135.42237173148888, 11.455309308164113, 8.737791530246227, 250.28011032008212, 108.69880421756415, 73.08706115260468, 91.01447401936875, 2.1373436819873586, 164.46786008281944, 196.1839720331465, 129.2867747460483, 6.524073506902173, 93.75472912252822, 49.082029344140466, 200.40332277101706, 9.236349727380016, 222.975330080561, 370.26049338903033, 145.59769296357936, 49.54045052792545, 7.850144142807794, 416.6684854510728, 28.7382361115921, 137.15966893849037, 29.951737014039708, 145.92187214811665, 185.93565285453212, 89.39216079799313, 191.87990176417136, 175.51583004536423, 155.8870243313916, 112.90619291694728, 192.93670396436985, 153.01622945995135, 101.20588873257333, 123.58038763800195, 165.6487085859458, 142.20956682186153, 247.9521277775634, 212.5592506187285, 79.73517693227551, 57.49493780348192, 314.3962462697175, 286.36467233424446, 148.54248636228616, 159.0441616821429, 104.28321666452375, 225.62390200250346, 12.98567100307298, 76.95585663067794, 247.4387095468063, 48.20558298996221, 34.65083633902874, 7.653475917086581, 131.790852023403, 101.63567061392583, 61.03460154720465, 129.42139827119448, 136.6645090726711, 175.82960105772577, 17.996482376328938, 15.890519755042966, 147.62434615503335, 43.17712076947104, 233.76314892344834, 44.23770436255124, 19.10336267456498, 16.58516453041629, 12.329868834367614, 66.20236477574055, 586.4685185632704, 217.2587334653513, 597.2312239396749, 20.018370745913174, 110.80011185252923, 268.291691747252, 40.44196280131891, 77.29877239855092, 4.219751507515388, 5.923495195532465, 0.0, 0.0, 194.60282938768842, 294.4551443922902, 50.96862234695534, 27.72777997553556, 35.452057694205344, 0.0, 62.06804084144464, 973.1339925691149, 1.069838491253878, 12.479121793783087, 49.94289135229698, 31.915543703100496, 122.4175572066168, 169.9580257712463, 13.379222548334894, 8.22095007061164, 165.21981524252723, 516.1283466716163, 80.72314152492201, 3.1131497401651194, 66.50055925878463, 125.00370655479261, 57.37291672869511, 27.730932579637678]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8220310049699691, "mean_inference_ms": 2.4372169385648745, "mean_action_processing_ms": 0.3305364684100725, "mean_env_wait_ms": 0.29431044489705094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012153387069702148, "StateBufferConnector_ms": 0.003739595413208008, "ViewRequirementAgentConnector_ms": 0.12635695934295654}, "num_episodes": 18, "episode_return_max": 389.4865927756938, "episode_return_min": -233.91381239707147, "episode_return_mean": 151.15912452126443, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 259.2600399271083, "num_env_steps_trained_throughput_per_sec": 259.2600399271083, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 15524.713, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15524.654, "sample_time_ms": 1876.808, "learn_time_ms": 13622.179, "learn_throughput": 293.639, "synch_weights_time_ms": 22.02}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 21, "trial_id": "61e09_00000", "date": "2024-08-16_16-11-52", "timestamp": 1723804912, "time_this_iter_s": 15.47518801689148, "time_total_s": 314.2394320964813, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24be1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 314.2394320964813, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 60.99545454545454, "ram_util_percent": 82.14090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.196274919358511, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.151072486241659, "policy_loss": -0.007087407997691087, "vf_loss": 5.15678108457535, "vf_explained_var": 0.010606009840334534, "kl": 0.006894029328706399, "entropy": 1.1955285493028227, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6248328170448385, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.553551079482628, "policy_loss": -0.006483571632967267, "vf_loss": 6.557938101682714, "vf_explained_var": -0.08984463063497392, "kl": 0.01048277103094337, "entropy": 1.2961592084516294, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 389.4865927756938, "episode_reward_min": -233.91381239707147, "episode_reward_mean": 155.34195471575384, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -824.0791047381845, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 195.86265631801263, "predator_policy": 973.1339925691149}, "policy_reward_mean": {"prey_policy": -66.7439426165648, "predator_policy": 144.4149199744417}, "custom_metrics": {}, "hist_stats": {"episode_reward": [95.72000000000011, 98.56649464011863, 232.37354799373992, 231.46297813750357, 63.55888441414307, 121.99786429701757, 138.97000000000037, 82.42939226954148, 138.6730063871395, 166.17115559441055, 25.49026754858832, 200.13726132465345, 278.4574769275576, 77.91630492246506, 119.59000000000052, 211.97165323662338, 332.1902277611796, 234.63173025232564, 132.27935804011463, 44.94999999999998, 389.4865927756938, 48.19080845903651, 206.7671802108723, 152.40999999999977, 248.59971425804042, 4.135533369654153, 189.81482494435807, 193.19291146531026, 207.37918670028063, 154.95509830367854, 2.469999999999988, 160.13467674857003, 239.99000000000007, 262.48523865305856, 242.65857531682346, 160.32, 25.97000000000033, 316.9306439516502, 161.61894264215206, 106.09615075721734, 126.56794895721195, 135.3645797420015, 220.60673891650256, 213.40300644524444, 167.0196660836272, 224.38452029983134, 127.1504514279861, 193.32528681709414, 289.340483010789, 132.98000000000025, 310.6779292967165, 193.37264617336058, 229.539597207991, 152.92000000000007, 111.79831385377165, 244.67131648002595, 230.82431118974102, 307.15781127526793, 124.04000000000025, 3.7899999999999636, 203.7387190294255, 99.96689929039049, 242.31000000000023, 89.73000000000012, -40.432977140305205, 8.789999999999978, 55.53604148244912, 149.91000000000008, 3.899999999999961, 3.9999999999999587, 270.9926972635103, 177.65999999999983, 3.8599999999999604, -233.91381239707147, 155.38000000000005, 152.05000000000004, 251.3345226800718, 187.13749096508275, -122.2523176352712, 259.8499999999999, 140.87000000000035, 135.57444695444, 150.31601391533155, 258.56091635831086, 135.20376619690995, 278.1938356342402, 315.7085600927363, 234.052233847573, 44.2399999999999, 3.699999999999965, 277.21496483334454, -64.64450270314256, 163.71999999999986, 163.92999999999995, 199.18287850122056, 255.5313588977029, 278.3429585682289, 141.44000000000005, 103.51248745952218, 159.92], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-52.21401694335239, -128.10730655876992, -76.31411057990832, -250.47507146284767, 191.93365615794886, -200.16247619423862, -101.08585687458178, 5.124998565104109, -390.5146049679809, -484.5389103129172, -106.57950795711186, -137.61344556006753, 64.15732198046335, -215.41844380060266, -46.67159670946859, -206.8678733347382, -50.475444891353995, -116.49556689102259, -133.65757985570303, -143.92262859942457, -367.78281406228183, -142.34298367571677, 42.8970572597372, -276.3706151272592, -36.4623997261817, -74.69845011838112, -94.99498504219945, -439.2623323841164, -33.21369770236553, -61.59683563147089, -50.81020661288925, -462.53737856122564, 114.06495688610204, 161.2984679111038, 170.59869557005322, -192.87911663878805, -166.26159884391794, -136.356737347707, -318.2736493555532, -197.53187918628123, -263.12555166070257, 115.5422457349088, -224.13639138278143, -91.41889967130673, -520.5283210678589, 160.44609580417534, -405.2130977674834, 85.56274085385317, 107.93, 36.01206100161544, -172.51952654674045, -0.6863666435775846, -82.10281418171999, 52.02672700560896, 103.6559751107723, 2.0000000000000013, -63.63059649674449, 78.39227511554414, 7.098340844917519, 0.9790764191079183, -6.807791530246268, -249.74011032008238, -21.01538253315087, -0.6358060884479266, -49.02447401936827, 195.86265631801263, -20.038387619418124, -78.12820584348951, -32.71579656704612, 139.56352363091972, -92.43472912252756, 109.91797065585953, -180.87949427938764, -2.7901782190104063, -162.4155433784786, -113.88963613946254, -32.55275603345953, -0.9664448158931118, -49.0164564606041, -269.406022376059, -15.770069848712774, -23.55988624415813, 4.658772292613728, -45.16780171276847, 13.323857796006987, -68.04493253202969, -124.7002692885167, -29.292456075774673, -3.863973983631701, -97.90957718107892, -47.8232086935902, -73.74520443089955, -2.8392302083981633, -94.79659473419146, -44.051876596763876, -70.48111199394937, 62.32269415023082, -233.4935895357334, 51.47482306772453, -55.72493780348227, -66.53295591791222, -223.55003338933312, -116.21400187106795, 2.0000000000000013, 16.128946855361686, -116.49646831439794, -11.07567100307302, 74.05414336932206, -73.0887123540556, -110.75726632894106, 86.63144951590525, 115.73555470800537, 21.02730217358062, -23.6295136211685, 94.89082987835025, 21.810981578519037, -13.644509072671127, -174.80960105772638, -16.116482376328644, -13.980519755043007, 30.760823783571936, -17.82357167865093, -6.677267956969459, -171.35668603863988, 138.48943288895762, 68.1320399060611, -10.389868834367656, 21.58763522425945, -325.54014168374806, -518.6200874851783, -596.2312239396749, -12.228370745912903, -281.1197738126353, -42.43598830469742, -38.61196280131927, 70.78122760144905, -2.269751507515429, -3.9734951955325064, 2.0000000000000013, 2.0000000000000013, -132.6290363674111, -85.43624014905728, -49.30862234695567, 148.2722200244644, -33.592057694205714, 2.0000000000000013, -445.03674106944766, -824.0791047381845, 0.9201615087461233, 140.91087820621692, -48.10289135229735, 118.29445629689951, 72.79828458547018, -113.83934488326157, 0.7549375045524988, 164.7823808415841, -472.7900049862526, -330.81047456316276, 96.57466501041006, 79.43904372450282, -64.75055925878374, 14.116293445207397, -17.165804694363565, 67.63640234047077, 0.09072347481886811, 26.446630038779166, -795.7058797434329, 32.916263518962644, -74.10337821161768, 52.78548543800613, -154.3555793636755, 66.63090478645009, -178.03840480352432, 10.523969304567384, 19.309039664551616, 164.80808684354196, -80.32673624564622, -121.72302808911398, -9.048789006741364, -20.09523506149845, -1.65604673471147, 75.72480809096358, -390.3813462710944, -134.6805153601846, 117.68367773384753, -54.774732618706196, 155.33280377664602, -96.76762413076531, 126.41877643867004, -222.81664032379294, -6.538237332413141, 60.467726284437035, -0.9723700802923705, 119.24557729236905, 62.03771667498431, -117.33888656199701, -80.99784554683592, -1.2870571747679689, 78.5778509777299, -11.266881806628756], "policy_predator_policy_reward": [53.93401694335205, 222.10730655876984, 159.49334990176754, 265.8623267811059, 195.15849967580002, 45.4438683542291, 11.756477817794526, 315.66735862918654, 518.6326077698485, 419.9797919251928, 160.0346072337616, 206.15621058043524, 73.84267801953665, 216.3884438006019, 5.496766374497155, 330.4720959392508, 223.10829539129813, 82.53572277821819, 314.3260767313285, 129.42528731820966, 1.250678173326879, 534.3653871132601, 144.9486775595319, 288.6621416326433, 174.1299307305918, 215.48839604152866, 250.79139211837688, 361.3822302304044, 151.21369770236555, 63.18683563147067, 344.33661511557483, 380.9826232951633, 53.896385745561766, 2.930417218412048, 69.82314882967155, 187.08900249138875, 237.367825267433, 197.52986896430642, 363.90170804273225, 196.85382049910166, 281.2795002426712, 255.79039845881636, 339.64871196007556, 24.09738755304959, 520.4330689040828, 46.41633657047304, 405.62309776748305, 66.43725914614681, 12.885371800796651, 91.7722814556285, 151.15191012682246, 26.189516433148533, 195.7997399241464, 24.09117219632352, 38.12358781460655, 49.41334853993178, 116.78997040416553, 75.82753767731552, 135.42237173148888, 11.455309308164113, 8.737791530246227, 250.28011032008212, 108.69880421756415, 73.08706115260468, 91.01447401936875, 2.1373436819873586, 164.46786008281944, 196.1839720331465, 129.2867747460483, 6.524073506902173, 93.75472912252822, 49.082029344140466, 200.40332277101706, 9.236349727380016, 222.975330080561, 370.26049338903033, 145.59769296357936, 49.54045052792545, 7.850144142807794, 416.6684854510728, 28.7382361115921, 137.15966893849037, 29.951737014039708, 145.92187214811665, 185.93565285453212, 89.39216079799313, 191.87990176417136, 175.51583004536423, 155.8870243313916, 112.90619291694728, 192.93670396436985, 153.01622945995135, 101.20588873257333, 123.58038763800195, 165.6487085859458, 142.20956682186153, 247.9521277775634, 212.5592506187285, 79.73517693227551, 57.49493780348192, 314.3962462697175, 286.36467233424446, 148.54248636228616, 159.0441616821429, 104.28321666452375, 225.62390200250346, 12.98567100307298, 76.95585663067794, 247.4387095468063, 48.20558298996221, 34.65083633902874, 7.653475917086581, 131.790852023403, 101.63567061392583, 61.03460154720465, 129.42139827119448, 136.6645090726711, 175.82960105772577, 17.996482376328938, 15.890519755042966, 147.62434615503335, 43.17712076947104, 233.76314892344834, 44.23770436255124, 19.10336267456498, 16.58516453041629, 12.329868834367614, 66.20236477574055, 586.4685185632704, 217.2587334653513, 597.2312239396749, 20.018370745913174, 110.80011185252923, 268.291691747252, 40.44196280131891, 77.29877239855092, 4.219751507515388, 5.923495195532465, 0.0, 0.0, 194.60282938768842, 294.4551443922902, 50.96862234695534, 27.72777997553556, 35.452057694205344, 0.0, 62.06804084144464, 973.1339925691149, 1.069838491253878, 12.479121793783087, 49.94289135229698, 31.915543703100496, 122.4175572066168, 169.9580257712463, 13.379222548334894, 8.22095007061164, 165.21981524252723, 516.1283466716163, 80.72314152492201, 3.1131497401651194, 66.50055925878463, 125.00370655479261, 57.37291672869511, 27.730932579637678, 88.99547226499352, 34.78318813674002, 737.3150270672309, 284.03550551554974, 75.73337821161851, 80.7882807589036, 173.40057315769113, 192.51793705377457, 239.17119514654615, 244.0518004451466, 33.67582435198205, 16.259282987498455, 130.2936409693815, 115.99612336537953, 10.958789006741323, 21.885235061498722, 90.23204421129759, 112.91415926579569, 413.3076399132477, 47.109719014887496, 44.31632226615247, 56.49473261870586, 6.97719622335396, 98.38762413076614, 49.377639952674386, 246.20310243366896, 51.307083743383636, 150.2947862022957, 64.82098684309392, 95.2487645130584, 78.12228332501574, 118.61888656199767, 185.00784554683602, 0.789544634289759, 79.43214902227011, 13.176881806628716]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8184600561760556, "mean_inference_ms": 2.435952802083176, "mean_action_processing_ms": 0.32956664000020225, "mean_env_wait_ms": 0.2924868484107253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014483451843261719, "StateBufferConnector_ms": 0.003932476043701172, "ViewRequirementAgentConnector_ms": 0.11360287666320801}, "num_episodes": 18, "episode_return_max": 389.4865927756938, "episode_return_min": -233.91381239707147, "episode_return_mean": 155.34195471575384, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 263.1738940254397, "num_env_steps_trained_throughput_per_sec": 263.1738940254397, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 15501.925, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15501.866, "sample_time_ms": 1886.509, "learn_time_ms": 13590.197, "learn_throughput": 294.33, "synch_weights_time_ms": 21.558}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 22, "trial_id": "61e09_00000", "date": "2024-08-16_16-12-07", "timestamp": 1723804927, "time_this_iter_s": 15.242875814437866, "time_total_s": 329.4823079109192, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30000bca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 329.4823079109192, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 60.4, "ram_util_percent": 82.17727272727274}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9420609389663372, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.2240887040183654, "policy_loss": -0.008039450979540272, "vf_loss": 5.2303866772424605, "vf_explained_var": 0.005024609237751633, "kl": 0.008707318138386815, "entropy": 1.1231443331985878, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.55434072014516, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.685668732375695, "policy_loss": -0.007546657865014538, "vf_loss": 5.6910731363548805, "vf_explained_var": -0.056372094217431605, "kl": 0.010711202263147559, "entropy": 1.3494745772351664, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 339.8306673110893, "episode_reward_min": -233.91381239707147, "episode_reward_mean": 149.73275807061944, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -824.0791047381845, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 195.86265631801263, "predator_policy": 973.1339925691149}, "policy_reward_mean": {"prey_policy": -57.98182766094545, "predator_policy": 132.84820669625518}, "custom_metrics": {}, "hist_stats": {"episode_reward": [193.19291146531026, 207.37918670028063, 154.95509830367854, 2.469999999999988, 160.13467674857003, 239.99000000000007, 262.48523865305856, 242.65857531682346, 160.32, 25.97000000000033, 316.9306439516502, 161.61894264215206, 106.09615075721734, 126.56794895721195, 135.3645797420015, 220.60673891650256, 213.40300644524444, 167.0196660836272, 224.38452029983134, 127.1504514279861, 193.32528681709414, 289.340483010789, 132.98000000000025, 310.6779292967165, 193.37264617336058, 229.539597207991, 152.92000000000007, 111.79831385377165, 244.67131648002595, 230.82431118974102, 307.15781127526793, 124.04000000000025, 3.7899999999999636, 203.7387190294255, 99.96689929039049, 242.31000000000023, 89.73000000000012, -40.432977140305205, 8.789999999999978, 55.53604148244912, 149.91000000000008, 3.899999999999961, 3.9999999999999587, 270.9926972635103, 177.65999999999983, 3.8599999999999604, -233.91381239707147, 155.38000000000005, 152.05000000000004, 251.3345226800718, 187.13749096508275, -122.2523176352712, 259.8499999999999, 140.87000000000035, 135.57444695444, 150.31601391533155, 258.56091635831086, 135.20376619690995, 278.1938356342402, 315.7085600927363, 234.052233847573, 44.2399999999999, 3.699999999999965, 277.21496483334454, -64.64450270314256, 163.71999999999986, 163.92999999999995, 199.18287850122056, 255.5313588977029, 278.3429585682289, 141.44000000000005, 103.51248745952218, 159.92, 83.45881549917485, 289.3345503199479, 3.8499999999999615, 103.72636323833333, 247.39363878518668, 184.69375629698158, -182.99752207955837, 188.42999999999978, 125.30170717660428, 247.01872723781673, 339.8306673110893, 0.14706666048859635, 56.389999999999915, 183.56471881258625, 7.769999999999962, 167.76999999999992, 91.06803485431425, 152.92000000000007, 3.679999999999964, 207.2665547201101, 21.675004287560242, 212.4600000000001, 173.85999999999987, 149.0019794729463, 166.10999999999999, 335.33999523136555, 146.9585354263893], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [103.6559751107723, 2.0000000000000013, -63.63059649674449, 78.39227511554414, 7.098340844917519, 0.9790764191079183, -6.807791530246268, -249.74011032008238, -21.01538253315087, -0.6358060884479266, -49.02447401936827, 195.86265631801263, -20.038387619418124, -78.12820584348951, -32.71579656704612, 139.56352363091972, -92.43472912252756, 109.91797065585953, -180.87949427938764, -2.7901782190104063, -162.4155433784786, -113.88963613946254, -32.55275603345953, -0.9664448158931118, -49.0164564606041, -269.406022376059, -15.770069848712774, -23.55988624415813, 4.658772292613728, -45.16780171276847, 13.323857796006987, -68.04493253202969, -124.7002692885167, -29.292456075774673, -3.863973983631701, -97.90957718107892, -47.8232086935902, -73.74520443089955, -2.8392302083981633, -94.79659473419146, -44.051876596763876, -70.48111199394937, 62.32269415023082, -233.4935895357334, 51.47482306772453, -55.72493780348227, -66.53295591791222, -223.55003338933312, -116.21400187106795, 2.0000000000000013, 16.128946855361686, -116.49646831439794, -11.07567100307302, 74.05414336932206, -73.0887123540556, -110.75726632894106, 86.63144951590525, 115.73555470800537, 21.02730217358062, -23.6295136211685, 94.89082987835025, 21.810981578519037, -13.644509072671127, -174.80960105772638, -16.116482376328644, -13.980519755043007, 30.760823783571936, -17.82357167865093, -6.677267956969459, -171.35668603863988, 138.48943288895762, 68.1320399060611, -10.389868834367656, 21.58763522425945, -325.54014168374806, -518.6200874851783, -596.2312239396749, -12.228370745912903, -281.1197738126353, -42.43598830469742, -38.61196280131927, 70.78122760144905, -2.269751507515429, -3.9734951955325064, 2.0000000000000013, 2.0000000000000013, -132.6290363674111, -85.43624014905728, -49.30862234695567, 148.2722200244644, -33.592057694205714, 2.0000000000000013, -445.03674106944766, -824.0791047381845, 0.9201615087461233, 140.91087820621692, -48.10289135229735, 118.29445629689951, 72.79828458547018, -113.83934488326157, 0.7549375045524988, 164.7823808415841, -472.7900049862526, -330.81047456316276, 96.57466501041006, 79.43904372450282, -64.75055925878374, 14.116293445207397, -17.165804694363565, 67.63640234047077, 0.09072347481886811, 26.446630038779166, -795.7058797434329, 32.916263518962644, -74.10337821161768, 52.78548543800613, -154.3555793636755, 66.63090478645009, -178.03840480352432, 10.523969304567384, 19.309039664551616, 164.80808684354196, -80.32673624564622, -121.72302808911398, -9.048789006741364, -20.09523506149845, -1.65604673471147, 75.72480809096358, -390.3813462710944, -134.6805153601846, 117.68367773384753, -54.774732618706196, 155.33280377664602, -96.76762413076531, 126.41877643867004, -222.81664032379294, -6.538237332413141, 60.467726284437035, -0.9723700802923705, 119.24557729236905, 62.03771667498431, -117.33888656199701, -80.99784554683592, -1.2870571747679689, 78.5778509777299, -11.266881806628756, -17.824957262659986, -193.05518231392782, 144.24353718358674, -147.41711536633008, -6.110028897223341, -11.283598230698813, -2.0864356499163064, -157.72958146801048, -200.74307050686457, 158.03334989985999, 170.1210829176651, -95.8431654406671, -666.3530782083229, -389.65613145131056, -140.44402335467387, 173.11506969823955, -71.97979801035984, -109.65361565601528, 114.53187783484655, -161.36986170495686, 152.65615167763337, 4.884508581137801, -17.748022804834537, -9.439020203237446, -219.8089451606953, -189.85300332326773, -34.742570744802116, -481.71449024124956, -52.10155208861009, -656.2763792889896, -39.85587883050079, 109.77090177015661, -8.970997796973219, -101.86854892972818, 93.85873253036023, -48.204033978534625, -63.692093228818955, 2.0000000000000013, 182.0696174757299, -69.5505517231942, -18.070092908996138, -392.47652460894545, 27.79677142387411, 116.17442213269173, -30.521861139422832, 111.78847134073743, -164.92856989051904, -453.6418499094741, 129.70798823027695, -0.08304706039829098, -704.201356310004, -4.864179164326871, -138.23496164542308, -10.557382771963644], "policy_predator_policy_reward": [38.12358781460655, 49.41334853993178, 116.78997040416553, 75.82753767731552, 135.42237173148888, 11.455309308164113, 8.737791530246227, 250.28011032008212, 108.69880421756415, 73.08706115260468, 91.01447401936875, 2.1373436819873586, 164.46786008281944, 196.1839720331465, 129.2867747460483, 6.524073506902173, 93.75472912252822, 49.082029344140466, 200.40332277101706, 9.236349727380016, 222.975330080561, 370.26049338903033, 145.59769296357936, 49.54045052792545, 7.850144142807794, 416.6684854510728, 28.7382361115921, 137.15966893849037, 29.951737014039708, 145.92187214811665, 185.93565285453212, 89.39216079799313, 191.87990176417136, 175.51583004536423, 155.8870243313916, 112.90619291694728, 192.93670396436985, 153.01622945995135, 101.20588873257333, 123.58038763800195, 165.6487085859458, 142.20956682186153, 247.9521277775634, 212.5592506187285, 79.73517693227551, 57.49493780348192, 314.3962462697175, 286.36467233424446, 148.54248636228616, 159.0441616821429, 104.28321666452375, 225.62390200250346, 12.98567100307298, 76.95585663067794, 247.4387095468063, 48.20558298996221, 34.65083633902874, 7.653475917086581, 131.790852023403, 101.63567061392583, 61.03460154720465, 129.42139827119448, 136.6645090726711, 175.82960105772577, 17.996482376328938, 15.890519755042966, 147.62434615503335, 43.17712076947104, 233.76314892344834, 44.23770436255124, 19.10336267456498, 16.58516453041629, 12.329868834367614, 66.20236477574055, 586.4685185632704, 217.2587334653513, 597.2312239396749, 20.018370745913174, 110.80011185252923, 268.291691747252, 40.44196280131891, 77.29877239855092, 4.219751507515388, 5.923495195532465, 0.0, 0.0, 194.60282938768842, 294.4551443922902, 50.96862234695534, 27.72777997553556, 35.452057694205344, 0.0, 62.06804084144464, 973.1339925691149, 1.069838491253878, 12.479121793783087, 49.94289135229698, 31.915543703100496, 122.4175572066168, 169.9580257712463, 13.379222548334894, 8.22095007061164, 165.21981524252723, 516.1283466716163, 80.72314152492201, 3.1131497401651194, 66.50055925878463, 125.00370655479261, 57.37291672869511, 27.730932579637678, 88.99547226499352, 34.78318813674002, 737.3150270672309, 284.03550551554974, 75.73337821161851, 80.7882807589036, 173.40057315769113, 192.51793705377457, 239.17119514654615, 244.0518004451466, 33.67582435198205, 16.259282987498455, 130.2936409693815, 115.99612336537953, 10.958789006741323, 21.885235061498722, 90.23204421129759, 112.91415926579569, 413.3076399132477, 47.109719014887496, 44.31632226615247, 56.49473261870586, 6.97719622335396, 98.38762413076614, 49.377639952674386, 246.20310243366896, 51.307083743383636, 150.2947862022957, 64.82098684309392, 95.2487645130584, 78.12228332501574, 118.61888656199767, 185.00784554683602, 0.789544634289759, 79.43214902227011, 13.176881806628716, 171.8355623065372, 122.50339276922548, 58.13617177703382, 234.37195672565716, 8.0500288972233, 13.193598230698772, 168.81308989868714, 94.72929045757253, 229.61000996440873, 60.49334942778258, 8.092673379316844, 102.32316544066785, 776.2738670890056, 96.73782049106939, 142.68173461628197, 13.077219040151189, 294.1650407810033, 12.77008006197644, 76.10504895935675, 217.7516621485704, 48.04496000422819, 134.24504704808993, 21.148092394791597, 6.186017273769257, 274.98894516069504, 191.06300332326666, 317.87560806723303, 382.14617173140516, 53.87155208860974, 662.2763792889896, 41.62587883050044, 56.229098229843395, 12.039032651287492, 189.8685489297283, 57.20126746963975, 50.064033978534255, 65.3720932288196, 0.0, 58.39502903589662, 36.35245993167905, 54.93797268585089, 377.2836491196504, 27.267277023599043, 41.221529419835335, 32.37186113942299, 60.22152865926256, 318.74333830703284, 448.829060965906, 24.56715295964519, 11.917905870476215, 611.3217584050427, 433.0837723006552, 78.07233971101681, 217.67854013275945]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8110954704317394, "mean_inference_ms": 2.4345701794312036, "mean_action_processing_ms": 0.32745149382909733, "mean_env_wait_ms": 0.28974613316864606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014874696731567383, "StateBufferConnector_ms": 0.0037349462509155273, "ViewRequirementAgentConnector_ms": 0.12331008911132812}, "num_episodes": 27, "episode_return_max": 339.8306673110893, "episode_return_min": -233.91381239707147, "episode_return_mean": 149.73275807061944, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 260.2765483005124, "num_env_steps_trained_throughput_per_sec": 260.2765483005124, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 15391.638, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15391.579, "sample_time_ms": 1810.184, "learn_time_ms": 13560.824, "learn_throughput": 294.967, "synch_weights_time_ms": 17.517}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 23, "trial_id": "61e09_00000", "date": "2024-08-16_16-12-23", "timestamp": 1723804943, "time_this_iter_s": 15.40959906578064, "time_total_s": 344.89190697669983, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30000bee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 344.89190697669983, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 58.08636363636364, "ram_util_percent": 82.07272727272728}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.401302391747949, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.585062872795832, "policy_loss": -0.008197801463458707, "vf_loss": 4.591481943231411, "vf_explained_var": 0.0025081616860848886, "kl": 0.00889359397740662, "entropy": 1.0630901239851795, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2895168633372696, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.291614562493783, "policy_loss": -0.007981808538050958, "vf_loss": 5.297319340832019, "vf_explained_var": -0.1850350617100953, "kl": 0.011385173117056826, "entropy": 1.3607885987039596, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 342.8058333489641, "episode_reward_min": -233.91381239707147, "episode_reward_mean": 137.17080478672852, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -824.0791047381845, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 182.0696174757299, "predator_policy": 973.1339925691149}, "policy_reward_mean": {"prey_policy": -69.30940851568435, "predator_policy": 137.8948109090486}, "custom_metrics": {}, "hist_stats": {"episode_reward": [224.38452029983134, 127.1504514279861, 193.32528681709414, 289.340483010789, 132.98000000000025, 310.6779292967165, 193.37264617336058, 229.539597207991, 152.92000000000007, 111.79831385377165, 244.67131648002595, 230.82431118974102, 307.15781127526793, 124.04000000000025, 3.7899999999999636, 203.7387190294255, 99.96689929039049, 242.31000000000023, 89.73000000000012, -40.432977140305205, 8.789999999999978, 55.53604148244912, 149.91000000000008, 3.899999999999961, 3.9999999999999587, 270.9926972635103, 177.65999999999983, 3.8599999999999604, -233.91381239707147, 155.38000000000005, 152.05000000000004, 251.3345226800718, 187.13749096508275, -122.2523176352712, 259.8499999999999, 140.87000000000035, 135.57444695444, 150.31601391533155, 258.56091635831086, 135.20376619690995, 278.1938356342402, 315.7085600927363, 234.052233847573, 44.2399999999999, 3.699999999999965, 277.21496483334454, -64.64450270314256, 163.71999999999986, 163.92999999999995, 199.18287850122056, 255.5313588977029, 278.3429585682289, 141.44000000000005, 103.51248745952218, 159.92, 83.45881549917485, 289.3345503199479, 3.8499999999999615, 103.72636323833333, 247.39363878518668, 184.69375629698158, -182.99752207955837, 188.42999999999978, 125.30170717660428, 247.01872723781673, 339.8306673110893, 0.14706666048859635, 56.389999999999915, 183.56471881258625, 7.769999999999962, 167.76999999999992, 91.06803485431425, 152.92000000000007, 3.679999999999964, 207.2665547201101, 21.675004287560242, 212.4600000000001, 173.85999999999987, 149.0019794729463, 166.10999999999999, 335.33999523136555, 146.9585354263893, 216.2691031968784, 219.8028727627101, 3.2599999999999727, 17.90224061843379, 241.9598871153482, 205.67999999999998, 2.159999999999993, 3.799999999999963, 179.19999999999965, -117.70160538497805, -13.00179257943573, 79.86000000000004, 177.34205191921646, 37.08604571031249, 151.44048759882634, 98.30000000000034, 342.8058333489641, -5.197088012038751], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-47.8232086935902, -73.74520443089955, -2.8392302083981633, -94.79659473419146, -44.051876596763876, -70.48111199394937, 62.32269415023082, -233.4935895357334, 51.47482306772453, -55.72493780348227, -66.53295591791222, -223.55003338933312, -116.21400187106795, 2.0000000000000013, 16.128946855361686, -116.49646831439794, -11.07567100307302, 74.05414336932206, -73.0887123540556, -110.75726632894106, 86.63144951590525, 115.73555470800537, 21.02730217358062, -23.6295136211685, 94.89082987835025, 21.810981578519037, -13.644509072671127, -174.80960105772638, -16.116482376328644, -13.980519755043007, 30.760823783571936, -17.82357167865093, -6.677267956969459, -171.35668603863988, 138.48943288895762, 68.1320399060611, -10.389868834367656, 21.58763522425945, -325.54014168374806, -518.6200874851783, -596.2312239396749, -12.228370745912903, -281.1197738126353, -42.43598830469742, -38.61196280131927, 70.78122760144905, -2.269751507515429, -3.9734951955325064, 2.0000000000000013, 2.0000000000000013, -132.6290363674111, -85.43624014905728, -49.30862234695567, 148.2722200244644, -33.592057694205714, 2.0000000000000013, -445.03674106944766, -824.0791047381845, 0.9201615087461233, 140.91087820621692, -48.10289135229735, 118.29445629689951, 72.79828458547018, -113.83934488326157, 0.7549375045524988, 164.7823808415841, -472.7900049862526, -330.81047456316276, 96.57466501041006, 79.43904372450282, -64.75055925878374, 14.116293445207397, -17.165804694363565, 67.63640234047077, 0.09072347481886811, 26.446630038779166, -795.7058797434329, 32.916263518962644, -74.10337821161768, 52.78548543800613, -154.3555793636755, 66.63090478645009, -178.03840480352432, 10.523969304567384, 19.309039664551616, 164.80808684354196, -80.32673624564622, -121.72302808911398, -9.048789006741364, -20.09523506149845, -1.65604673471147, 75.72480809096358, -390.3813462710944, -134.6805153601846, 117.68367773384753, -54.774732618706196, 155.33280377664602, -96.76762413076531, 126.41877643867004, -222.81664032379294, -6.538237332413141, 60.467726284437035, -0.9723700802923705, 119.24557729236905, 62.03771667498431, -117.33888656199701, -80.99784554683592, -1.2870571747679689, 78.5778509777299, -11.266881806628756, -17.824957262659986, -193.05518231392782, 144.24353718358674, -147.41711536633008, -6.110028897223341, -11.283598230698813, -2.0864356499163064, -157.72958146801048, -200.74307050686457, 158.03334989985999, 170.1210829176651, -95.8431654406671, -666.3530782083229, -389.65613145131056, -140.44402335467387, 173.11506969823955, -71.97979801035984, -109.65361565601528, 114.53187783484655, -161.36986170495686, 152.65615167763337, 4.884508581137801, -17.748022804834537, -9.439020203237446, -219.8089451606953, -189.85300332326773, -34.742570744802116, -481.71449024124956, -52.10155208861009, -656.2763792889896, -39.85587883050079, 109.77090177015661, -8.970997796973219, -101.86854892972818, 93.85873253036023, -48.204033978534625, -63.692093228818955, 2.0000000000000013, 182.0696174757299, -69.5505517231942, -18.070092908996138, -392.47652460894545, 27.79677142387411, 116.17442213269173, -30.521861139422832, 111.78847134073743, -164.92856989051904, -453.6418499094741, 129.70798823027695, -0.08304706039829098, -704.201356310004, -4.864179164326871, -138.23496164542308, -10.557382771963644, -676.6432692495828, 120.41311673695775, -110.54502698137644, 143.4678796830608, -61.29969202895895, -95.93504340934665, -289.5200674979927, -23.6922463736394, -89.57592491314793, 118.05771522734715, -280.48633793410994, 179.1208285652702, -425.63772892356934, -39.93969024169496, -1.691958541613879, -52.997130382418526, 177.2299999999999, -1.5601991175318388, -263.32254911268296, -418.6289193445402, -86.30417563253508, -23.943108996856736, 52.33238730577884, -69.2175618032121, -75.74139635999394, -14.889421682682158, -19.020396112583473, -600.2948252783445, 13.502745388028888, 0.7533410612314896, 1.1259669404857684, 8.452020242881826, 141.42775356561435, -534.8566656726717, -9.655203676587996, -134.94571692255894], "policy_predator_policy_reward": [192.93670396436985, 153.01622945995135, 101.20588873257333, 123.58038763800195, 165.6487085859458, 142.20956682186153, 247.9521277775634, 212.5592506187285, 79.73517693227551, 57.49493780348192, 314.3962462697175, 286.36467233424446, 148.54248636228616, 159.0441616821429, 104.28321666452375, 225.62390200250346, 12.98567100307298, 76.95585663067794, 247.4387095468063, 48.20558298996221, 34.65083633902874, 7.653475917086581, 131.790852023403, 101.63567061392583, 61.03460154720465, 129.42139827119448, 136.6645090726711, 175.82960105772577, 17.996482376328938, 15.890519755042966, 147.62434615503335, 43.17712076947104, 233.76314892344834, 44.23770436255124, 19.10336267456498, 16.58516453041629, 12.329868834367614, 66.20236477574055, 586.4685185632704, 217.2587334653513, 597.2312239396749, 20.018370745913174, 110.80011185252923, 268.291691747252, 40.44196280131891, 77.29877239855092, 4.219751507515388, 5.923495195532465, 0.0, 0.0, 194.60282938768842, 294.4551443922902, 50.96862234695534, 27.72777997553556, 35.452057694205344, 0.0, 62.06804084144464, 973.1339925691149, 1.069838491253878, 12.479121793783087, 49.94289135229698, 31.915543703100496, 122.4175572066168, 169.9580257712463, 13.379222548334894, 8.22095007061164, 165.21981524252723, 516.1283466716163, 80.72314152492201, 3.1131497401651194, 66.50055925878463, 125.00370655479261, 57.37291672869511, 27.730932579637678, 88.99547226499352, 34.78318813674002, 737.3150270672309, 284.03550551554974, 75.73337821161851, 80.7882807589036, 173.40057315769113, 192.51793705377457, 239.17119514654615, 244.0518004451466, 33.67582435198205, 16.259282987498455, 130.2936409693815, 115.99612336537953, 10.958789006741323, 21.885235061498722, 90.23204421129759, 112.91415926579569, 413.3076399132477, 47.109719014887496, 44.31632226615247, 56.49473261870586, 6.97719622335396, 98.38762413076614, 49.377639952674386, 246.20310243366896, 51.307083743383636, 150.2947862022957, 64.82098684309392, 95.2487645130584, 78.12228332501574, 118.61888656199767, 185.00784554683602, 0.789544634289759, 79.43214902227011, 13.176881806628716, 171.8355623065372, 122.50339276922548, 58.13617177703382, 234.37195672565716, 8.0500288972233, 13.193598230698772, 168.81308989868714, 94.72929045757253, 229.61000996440873, 60.49334942778258, 8.092673379316844, 102.32316544066785, 776.2738670890056, 96.73782049106939, 142.68173461628197, 13.077219040151189, 294.1650407810033, 12.77008006197644, 76.10504895935675, 217.7516621485704, 48.04496000422819, 134.24504704808993, 21.148092394791597, 6.186017273769257, 274.98894516069504, 191.06300332326666, 317.87560806723303, 382.14617173140516, 53.87155208860974, 662.2763792889896, 41.62587883050044, 56.229098229843395, 12.039032651287492, 189.8685489297283, 57.20126746963975, 50.064033978534255, 65.3720932288196, 0.0, 58.39502903589662, 36.35245993167905, 54.93797268585089, 377.2836491196504, 27.267277023599043, 41.221529419835335, 32.37186113942299, 60.22152865926256, 318.74333830703284, 448.829060965906, 24.56715295964519, 11.917905870476215, 611.3217584050427, 433.0837723006552, 78.07233971101681, 217.67854013275945, 658.8991091192523, 113.60014659025143, 122.23788440566528, 64.64213565536065, 62.96969202895862, 97.52504340934746, 283.27811460408464, 47.83643988598011, 99.89634702239432, 113.58174977875643, 304.9963379341099, 2.0491714347298275, 426.1377289235689, 41.59969024169463, 3.661958541613844, 54.827130382418176, 0.0, 3.5301991175318066, 528.3634378951862, 35.88642517705632, 96.23484662330672, 1.0106454266504528, 25.79761269422134, 70.94756180321298, 155.82119161733652, 112.15167834455639, 56.10644182289627, 600.2948252783445, 8.637146537594807, 128.5472546119711, 81.90849209585029, 6.813520720782096, 253.65909942125217, 482.5756460347693, 3.1681156645492727, 136.2357169225578]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8080545244467016, "mean_inference_ms": 2.42912523818378, "mean_action_processing_ms": 0.32657616259930544, "mean_env_wait_ms": 0.2886235105517549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014911174774169922, "StateBufferConnector_ms": 0.0035458803176879883, "ViewRequirementAgentConnector_ms": 0.11779475212097168}, "num_episodes": 18, "episode_return_max": 342.8058333489641, "episode_return_min": -233.91381239707147, "episode_return_mean": 137.17080478672852, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 257.9035498336354, "num_env_steps_trained_throughput_per_sec": 257.9035498336354, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 15341.212, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15341.154, "sample_time_ms": 1757.734, "learn_time_ms": 13562.819, "learn_throughput": 294.924, "synch_weights_time_ms": 17.664}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 24, "trial_id": "61e09_00000", "date": "2024-08-16_16-12-38", "timestamp": 1723804958, "time_this_iter_s": 15.548089027404785, "time_total_s": 360.4399960041046, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b249b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 360.4399960041046, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 61.46818181818182, "ram_util_percent": 82.19090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.292887547754106, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.1216687503315153, "policy_loss": -0.009086110426369247, "vf_loss": 3.1295155705598297, "vf_explained_var": 0.003751869113356979, "kl": 0.006196502548486354, "entropy": 0.9688052551140861, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9006118385564714, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.600196782621757, "policy_loss": -0.015130540339655623, "vf_loss": 4.612132615387124, "vf_explained_var": -0.054333897589375735, "kl": 0.01597344626942907, "entropy": 1.3759909563594395, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 363.14, "episode_reward_min": -233.91381239707147, "episode_reward_mean": 131.1012533072656, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -824.0791047381845, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 184.5067564519146, "predator_policy": 973.1339925691149}, "policy_reward_mean": {"prey_policy": -72.2792785495391, "predator_policy": 137.8299052031719}, "custom_metrics": {}, "hist_stats": {"episode_reward": [89.73000000000012, -40.432977140305205, 8.789999999999978, 55.53604148244912, 149.91000000000008, 3.899999999999961, 3.9999999999999587, 270.9926972635103, 177.65999999999983, 3.8599999999999604, -233.91381239707147, 155.38000000000005, 152.05000000000004, 251.3345226800718, 187.13749096508275, -122.2523176352712, 259.8499999999999, 140.87000000000035, 135.57444695444, 150.31601391533155, 258.56091635831086, 135.20376619690995, 278.1938356342402, 315.7085600927363, 234.052233847573, 44.2399999999999, 3.699999999999965, 277.21496483334454, -64.64450270314256, 163.71999999999986, 163.92999999999995, 199.18287850122056, 255.5313588977029, 278.3429585682289, 141.44000000000005, 103.51248745952218, 159.92, 83.45881549917485, 289.3345503199479, 3.8499999999999615, 103.72636323833333, 247.39363878518668, 184.69375629698158, -182.99752207955837, 188.42999999999978, 125.30170717660428, 247.01872723781673, 339.8306673110893, 0.14706666048859635, 56.389999999999915, 183.56471881258625, 7.769999999999962, 167.76999999999992, 91.06803485431425, 152.92000000000007, 3.679999999999964, 207.2665547201101, 21.675004287560242, 212.4600000000001, 173.85999999999987, 149.0019794729463, 166.10999999999999, 335.33999523136555, 146.9585354263893, 216.2691031968784, 219.8028727627101, 3.2599999999999727, 17.90224061843379, 241.9598871153482, 205.67999999999998, 2.159999999999993, 3.799999999999963, 179.19999999999965, -117.70160538497805, -13.00179257943573, 79.86000000000004, 177.34205191921646, 37.08604571031249, 151.44048759882634, 98.30000000000034, 342.8058333489641, -5.197088012038751, 3.039999999999974, 78.64370500469967, 290.3368537258673, 48.7566254984408, 123.58000000000025, 215.3598785349243, 166.97999999999996, 208.51513585736427, 164.43882347179266, 363.14, 222.5099999999992, -14.413848666262815, 3.7999999999999634, 3.639999999999967, 215.48943791750398, 163.79560872540466, 263.9992516129617, 293.42166572340864], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-10.389868834367656, 21.58763522425945, -325.54014168374806, -518.6200874851783, -596.2312239396749, -12.228370745912903, -281.1197738126353, -42.43598830469742, -38.61196280131927, 70.78122760144905, -2.269751507515429, -3.9734951955325064, 2.0000000000000013, 2.0000000000000013, -132.6290363674111, -85.43624014905728, -49.30862234695567, 148.2722200244644, -33.592057694205714, 2.0000000000000013, -445.03674106944766, -824.0791047381845, 0.9201615087461233, 140.91087820621692, -48.10289135229735, 118.29445629689951, 72.79828458547018, -113.83934488326157, 0.7549375045524988, 164.7823808415841, -472.7900049862526, -330.81047456316276, 96.57466501041006, 79.43904372450282, -64.75055925878374, 14.116293445207397, -17.165804694363565, 67.63640234047077, 0.09072347481886811, 26.446630038779166, -795.7058797434329, 32.916263518962644, -74.10337821161768, 52.78548543800613, -154.3555793636755, 66.63090478645009, -178.03840480352432, 10.523969304567384, 19.309039664551616, 164.80808684354196, -80.32673624564622, -121.72302808911398, -9.048789006741364, -20.09523506149845, -1.65604673471147, 75.72480809096358, -390.3813462710944, -134.6805153601846, 117.68367773384753, -54.774732618706196, 155.33280377664602, -96.76762413076531, 126.41877643867004, -222.81664032379294, -6.538237332413141, 60.467726284437035, -0.9723700802923705, 119.24557729236905, 62.03771667498431, -117.33888656199701, -80.99784554683592, -1.2870571747679689, 78.5778509777299, -11.266881806628756, -17.824957262659986, -193.05518231392782, 144.24353718358674, -147.41711536633008, -6.110028897223341, -11.283598230698813, -2.0864356499163064, -157.72958146801048, -200.74307050686457, 158.03334989985999, 170.1210829176651, -95.8431654406671, -666.3530782083229, -389.65613145131056, -140.44402335467387, 173.11506969823955, -71.97979801035984, -109.65361565601528, 114.53187783484655, -161.36986170495686, 152.65615167763337, 4.884508581137801, -17.748022804834537, -9.439020203237446, -219.8089451606953, -189.85300332326773, -34.742570744802116, -481.71449024124956, -52.10155208861009, -656.2763792889896, -39.85587883050079, 109.77090177015661, -8.970997796973219, -101.86854892972818, 93.85873253036023, -48.204033978534625, -63.692093228818955, 2.0000000000000013, 182.0696174757299, -69.5505517231942, -18.070092908996138, -392.47652460894545, 27.79677142387411, 116.17442213269173, -30.521861139422832, 111.78847134073743, -164.92856989051904, -453.6418499094741, 129.70798823027695, -0.08304706039829098, -704.201356310004, -4.864179164326871, -138.23496164542308, -10.557382771963644, -676.6432692495828, 120.41311673695775, -110.54502698137644, 143.4678796830608, -61.29969202895895, -95.93504340934665, -289.5200674979927, -23.6922463736394, -89.57592491314793, 118.05771522734715, -280.48633793410994, 179.1208285652702, -425.63772892356934, -39.93969024169496, -1.691958541613879, -52.997130382418526, 177.2299999999999, -1.5601991175318388, -263.32254911268296, -418.6289193445402, -86.30417563253508, -23.943108996856736, 52.33238730577884, -69.2175618032121, -75.74139635999394, -14.889421682682158, -19.020396112583473, -600.2948252783445, 13.502745388028888, 0.7533410612314896, 1.1259669404857684, 8.452020242881826, 141.42775356561435, -534.8566656726717, -9.655203676587996, -134.94571692255894, -221.4953985151369, -0.3805376367681075, -186.61756421505217, -230.76614361200365, -37.65607034729189, 184.5067564519146, -139.42565363933824, 0.14963626953758696, -29.862539445585565, 118.94422354749778, -376.1283386433822, -44.11265244708432, 138.6354676667682, -35.218967394762, 155.1107637424392, -56.08094285219432, 67.89869035225041, -37.29785396061766, 168.43622728869957, 166.5231843178193, 136.25890420024132, 56.228224391102025, -132.0718338862551, -562.2193131105944, -7.528191729200657, -15.34266749014774, -19.156966634802252, -34.51565806992998, 98.09204195528876, 53.479999999999706, -324.9486798653646, 2.0000000000000013, -428.4457445355097, -6.955822960042633, -192.03880938850503, 182.7782305676642], "policy_predator_policy_reward": [12.329868834367614, 66.20236477574055, 586.4685185632704, 217.2587334653513, 597.2312239396749, 20.018370745913174, 110.80011185252923, 268.291691747252, 40.44196280131891, 77.29877239855092, 4.219751507515388, 5.923495195532465, 0.0, 0.0, 194.60282938768842, 294.4551443922902, 50.96862234695534, 27.72777997553556, 35.452057694205344, 0.0, 62.06804084144464, 973.1339925691149, 1.069838491253878, 12.479121793783087, 49.94289135229698, 31.915543703100496, 122.4175572066168, 169.9580257712463, 13.379222548334894, 8.22095007061164, 165.21981524252723, 516.1283466716163, 80.72314152492201, 3.1131497401651194, 66.50055925878463, 125.00370655479261, 57.37291672869511, 27.730932579637678, 88.99547226499352, 34.78318813674002, 737.3150270672309, 284.03550551554974, 75.73337821161851, 80.7882807589036, 173.40057315769113, 192.51793705377457, 239.17119514654615, 244.0518004451466, 33.67582435198205, 16.259282987498455, 130.2936409693815, 115.99612336537953, 10.958789006741323, 21.885235061498722, 90.23204421129759, 112.91415926579569, 413.3076399132477, 47.109719014887496, 44.31632226615247, 56.49473261870586, 6.97719622335396, 98.38762413076614, 49.377639952674386, 246.20310243366896, 51.307083743383636, 150.2947862022957, 64.82098684309392, 95.2487645130584, 78.12228332501574, 118.61888656199767, 185.00784554683602, 0.789544634289759, 79.43214902227011, 13.176881806628716, 171.8355623065372, 122.50339276922548, 58.13617177703382, 234.37195672565716, 8.0500288972233, 13.193598230698772, 168.81308989868714, 94.72929045757253, 229.61000996440873, 60.49334942778258, 8.092673379316844, 102.32316544066785, 776.2738670890056, 96.73782049106939, 142.68173461628197, 13.077219040151189, 294.1650407810033, 12.77008006197644, 76.10504895935675, 217.7516621485704, 48.04496000422819, 134.24504704808993, 21.148092394791597, 6.186017273769257, 274.98894516069504, 191.06300332326666, 317.87560806723303, 382.14617173140516, 53.87155208860974, 662.2763792889896, 41.62587883050044, 56.229098229843395, 12.039032651287492, 189.8685489297283, 57.20126746963975, 50.064033978534255, 65.3720932288196, 0.0, 58.39502903589662, 36.35245993167905, 54.93797268585089, 377.2836491196504, 27.267277023599043, 41.221529419835335, 32.37186113942299, 60.22152865926256, 318.74333830703284, 448.829060965906, 24.56715295964519, 11.917905870476215, 611.3217584050427, 433.0837723006552, 78.07233971101681, 217.67854013275945, 658.8991091192523, 113.60014659025143, 122.23788440566528, 64.64213565536065, 62.96969202895862, 97.52504340934746, 283.27811460408464, 47.83643988598011, 99.89634702239432, 113.58174977875643, 304.9963379341099, 2.0491714347298275, 426.1377289235689, 41.59969024169463, 3.661958541613844, 54.827130382418176, 0.0, 3.5301991175318066, 528.3634378951862, 35.88642517705632, 96.23484662330672, 1.0106454266504528, 25.79761269422134, 70.94756180321298, 155.82119161733652, 112.15167834455639, 56.10644182289627, 600.2948252783445, 8.637146537594807, 128.5472546119711, 81.90849209585029, 6.813520720782096, 253.65909942125217, 482.5756460347693, 3.1681156645492727, 136.2357169225578, 222.55539851513595, 2.3605376367681012, 290.69850635193495, 205.32890647981702, 54.17603448684265, 89.3101331344025, 37.03477206603892, 150.99787080220204, 31.672539445585848, 2.825776452502202, 333.89534171435736, 301.7055279110339, 26.5545323332318, 37.00896739476164, 68.40740494338618, 41.07791002373365, 84.14130964774958, 49.69667743241003, 13.623772711300408, 14.556815682180702, 26.905075206054526, 3.1177962026019044, 522.6218942893234, 157.25540404126204, 9.448191729200616, 17.222667490147916, 21.01696663480254, 36.29565806992962, 48.30602806282228, 15.611367899393453, 207.21284637058184, 279.53144222018824, 312.84362807561587, 386.5571910328984, 178.12202650017656, 124.56021804407294]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8053394219984423, "mean_inference_ms": 2.428134471570089, "mean_action_processing_ms": 0.3327876596627048, "mean_env_wait_ms": 0.28739021232371337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008240938186645508, "StateBufferConnector_ms": 0.003598332405090332, "ViewRequirementAgentConnector_ms": 0.13482701778411865}, "num_episodes": 18, "episode_return_max": 363.14, "episode_return_min": -233.91381239707147, "episode_return_mean": 131.1012533072656, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 251.87660442220383, "num_env_steps_trained_throughput_per_sec": 251.87660442220383, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 15417.488, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15417.429, "sample_time_ms": 1817.928, "learn_time_ms": 13578.517, "learn_throughput": 294.583, "synch_weights_time_ms": 17.938}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 25, "trial_id": "61e09_00000", "date": "2024-08-16_16-12-54", "timestamp": 1723804974, "time_this_iter_s": 15.91449522972107, "time_total_s": 376.3544912338257, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b249b3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 376.3544912338257, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 62.863636363636374, "ram_util_percent": 81.81363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3585021910528656, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.681949577318928, "policy_loss": -0.0077670199100529315, "vf_loss": 2.6883961298478343, "vf_explained_var": 0.003001123477542211, "kl": 0.006602376330016658, "entropy": 0.9076920773301805, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9503345438096888, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.525289099620133, "policy_loss": -0.016388590931251803, "vf_loss": 3.53930391432747, "vf_explained_var": 0.06379496524573634, "kl": 0.011868861192247468, "entropy": 1.3690587314348373, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 373.7612153013031, "episode_reward_min": -182.99752207955837, "episode_reward_mean": 133.82730108610957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -795.7058797434329, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 184.5067564519146, "predator_policy": 776.2738670890056}, "policy_reward_mean": {"prey_policy": -60.92328024407372, "predator_policy": 127.83693078712851}, "custom_metrics": {}, "hist_stats": {"episode_reward": [135.57444695444, 150.31601391533155, 258.56091635831086, 135.20376619690995, 278.1938356342402, 315.7085600927363, 234.052233847573, 44.2399999999999, 3.699999999999965, 277.21496483334454, -64.64450270314256, 163.71999999999986, 163.92999999999995, 199.18287850122056, 255.5313588977029, 278.3429585682289, 141.44000000000005, 103.51248745952218, 159.92, 83.45881549917485, 289.3345503199479, 3.8499999999999615, 103.72636323833333, 247.39363878518668, 184.69375629698158, -182.99752207955837, 188.42999999999978, 125.30170717660428, 247.01872723781673, 339.8306673110893, 0.14706666048859635, 56.389999999999915, 183.56471881258625, 7.769999999999962, 167.76999999999992, 91.06803485431425, 152.92000000000007, 3.679999999999964, 207.2665547201101, 21.675004287560242, 212.4600000000001, 173.85999999999987, 149.0019794729463, 166.10999999999999, 335.33999523136555, 146.9585354263893, 216.2691031968784, 219.8028727627101, 3.2599999999999727, 17.90224061843379, 241.9598871153482, 205.67999999999998, 2.159999999999993, 3.799999999999963, 179.19999999999965, -117.70160538497805, -13.00179257943573, 79.86000000000004, 177.34205191921646, 37.08604571031249, 151.44048759882634, 98.30000000000034, 342.8058333489641, -5.197088012038751, 3.039999999999974, 78.64370500469967, 290.3368537258673, 48.7566254984408, 123.58000000000025, 215.3598785349243, 166.97999999999996, 208.51513585736427, 164.43882347179266, 363.14, 222.5099999999992, -14.413848666262815, 3.7999999999999634, 3.639999999999967, 215.48943791750398, 163.79560872540466, 263.9992516129617, 293.42166572340864, -43.796748889636234, 0.19507133707155838, 2.9099999999999757, 3.6299999999999657, 3.8599999999999612, 3.919999999999961, 3.9099999999999606, 3.4799999999999693, 161.10000000000002, 230.4500000000001, 188.91999999999973, 47.30568203141116, 373.7612153013031, 3.6599999999999655, 225.38789031039366, 203.94842188588774, 182.43489112643013, 191.92999999999972], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-17.165804694363565, 67.63640234047077, 0.09072347481886811, 26.446630038779166, -795.7058797434329, 32.916263518962644, -74.10337821161768, 52.78548543800613, -154.3555793636755, 66.63090478645009, -178.03840480352432, 10.523969304567384, 19.309039664551616, 164.80808684354196, -80.32673624564622, -121.72302808911398, -9.048789006741364, -20.09523506149845, -1.65604673471147, 75.72480809096358, -390.3813462710944, -134.6805153601846, 117.68367773384753, -54.774732618706196, 155.33280377664602, -96.76762413076531, 126.41877643867004, -222.81664032379294, -6.538237332413141, 60.467726284437035, -0.9723700802923705, 119.24557729236905, 62.03771667498431, -117.33888656199701, -80.99784554683592, -1.2870571747679689, 78.5778509777299, -11.266881806628756, -17.824957262659986, -193.05518231392782, 144.24353718358674, -147.41711536633008, -6.110028897223341, -11.283598230698813, -2.0864356499163064, -157.72958146801048, -200.74307050686457, 158.03334989985999, 170.1210829176651, -95.8431654406671, -666.3530782083229, -389.65613145131056, -140.44402335467387, 173.11506969823955, -71.97979801035984, -109.65361565601528, 114.53187783484655, -161.36986170495686, 152.65615167763337, 4.884508581137801, -17.748022804834537, -9.439020203237446, -219.8089451606953, -189.85300332326773, -34.742570744802116, -481.71449024124956, -52.10155208861009, -656.2763792889896, -39.85587883050079, 109.77090177015661, -8.970997796973219, -101.86854892972818, 93.85873253036023, -48.204033978534625, -63.692093228818955, 2.0000000000000013, 182.0696174757299, -69.5505517231942, -18.070092908996138, -392.47652460894545, 27.79677142387411, 116.17442213269173, -30.521861139422832, 111.78847134073743, -164.92856989051904, -453.6418499094741, 129.70798823027695, -0.08304706039829098, -704.201356310004, -4.864179164326871, -138.23496164542308, -10.557382771963644, -676.6432692495828, 120.41311673695775, -110.54502698137644, 143.4678796830608, -61.29969202895895, -95.93504340934665, -289.5200674979927, -23.6922463736394, -89.57592491314793, 118.05771522734715, -280.48633793410994, 179.1208285652702, -425.63772892356934, -39.93969024169496, -1.691958541613879, -52.997130382418526, 177.2299999999999, -1.5601991175318388, -263.32254911268296, -418.6289193445402, -86.30417563253508, -23.943108996856736, 52.33238730577884, -69.2175618032121, -75.74139635999394, -14.889421682682158, -19.020396112583473, -600.2948252783445, 13.502745388028888, 0.7533410612314896, 1.1259669404857684, 8.452020242881826, 141.42775356561435, -534.8566656726717, -9.655203676587996, -134.94571692255894, -221.4953985151369, -0.3805376367681075, -186.61756421505217, -230.76614361200365, -37.65607034729189, 184.5067564519146, -139.42565363933824, 0.14963626953758696, -29.862539445585565, 118.94422354749778, -376.1283386433822, -44.11265244708432, 138.6354676667682, -35.218967394762, 155.1107637424392, -56.08094285219432, 67.89869035225041, -37.29785396061766, 168.43622728869957, 166.5231843178193, 136.25890420024132, 56.228224391102025, -132.0718338862551, -562.2193131105944, -7.528191729200657, -15.34266749014774, -19.156966634802252, -34.51565806992998, 98.09204195528876, 53.479999999999706, -324.9486798653646, 2.0000000000000013, -428.4457445355097, -6.955822960042633, -192.03880938850503, 182.7782305676642, -201.04366364483877, -250.38169338705234, -74.54302116597212, -144.25199534166862, -247.82956164549293, -26.464906314351914, -69.91837853694511, -9.163197142656744, 2.0000000000000013, -24.52777888328994, -5.517141557626564, -0.2798789008381115, 1.0308514041473689, -11.78136460422097, -2.622951822548643, -103.4219546717288, 103.0524505126826, 2.0000000000000013, 49.3760858203721, 133.07411836253937, 182.80954078869436, -18.31133071333977, 7.807925190885025, -18.68900793412175, -80.31610228371704, -242.17008639381174, -8.982794830451136, -29.069222684075736, -90.94107579798792, -223.5369619661501, -9.707180828794122, -7.260740824239402, 180.2, -143.41798697965314, -18.64598325406922, 176.08109337755945], "policy_predator_policy_reward": [57.37291672869511, 27.730932579637678, 88.99547226499352, 34.78318813674002, 737.3150270672309, 284.03550551554974, 75.73337821161851, 80.7882807589036, 173.40057315769113, 192.51793705377457, 239.17119514654615, 244.0518004451466, 33.67582435198205, 16.259282987498455, 130.2936409693815, 115.99612336537953, 10.958789006741323, 21.885235061498722, 90.23204421129759, 112.91415926579569, 413.3076399132477, 47.109719014887496, 44.31632226615247, 56.49473261870586, 6.97719622335396, 98.38762413076614, 49.377639952674386, 246.20310243366896, 51.307083743383636, 150.2947862022957, 64.82098684309392, 95.2487645130584, 78.12228332501574, 118.61888656199767, 185.00784554683602, 0.789544634289759, 79.43214902227011, 13.176881806628716, 171.8355623065372, 122.50339276922548, 58.13617177703382, 234.37195672565716, 8.0500288972233, 13.193598230698772, 168.81308989868714, 94.72929045757253, 229.61000996440873, 60.49334942778258, 8.092673379316844, 102.32316544066785, 776.2738670890056, 96.73782049106939, 142.68173461628197, 13.077219040151189, 294.1650407810033, 12.77008006197644, 76.10504895935675, 217.7516621485704, 48.04496000422819, 134.24504704808993, 21.148092394791597, 6.186017273769257, 274.98894516069504, 191.06300332326666, 317.87560806723303, 382.14617173140516, 53.87155208860974, 662.2763792889896, 41.62587883050044, 56.229098229843395, 12.039032651287492, 189.8685489297283, 57.20126746963975, 50.064033978534255, 65.3720932288196, 0.0, 58.39502903589662, 36.35245993167905, 54.93797268585089, 377.2836491196504, 27.267277023599043, 41.221529419835335, 32.37186113942299, 60.22152865926256, 318.74333830703284, 448.829060965906, 24.56715295964519, 11.917905870476215, 611.3217584050427, 433.0837723006552, 78.07233971101681, 217.67854013275945, 658.8991091192523, 113.60014659025143, 122.23788440566528, 64.64213565536065, 62.96969202895862, 97.52504340934746, 283.27811460408464, 47.83643988598011, 99.89634702239432, 113.58174977875643, 304.9963379341099, 2.0491714347298275, 426.1377289235689, 41.59969024169463, 3.661958541613844, 54.827130382418176, 0.0, 3.5301991175318066, 528.3634378951862, 35.88642517705632, 96.23484662330672, 1.0106454266504528, 25.79761269422134, 70.94756180321298, 155.82119161733652, 112.15167834455639, 56.10644182289627, 600.2948252783445, 8.637146537594807, 128.5472546119711, 81.90849209585029, 6.813520720782096, 253.65909942125217, 482.5756460347693, 3.1681156645492727, 136.2357169225578, 222.55539851513595, 2.3605376367681012, 290.69850635193495, 205.32890647981702, 54.17603448684265, 89.3101331344025, 37.03477206603892, 150.99787080220204, 31.672539445585848, 2.825776452502202, 333.89534171435736, 301.7055279110339, 26.5545323332318, 37.00896739476164, 68.40740494338618, 41.07791002373365, 84.14130964774958, 49.69667743241003, 13.623772711300408, 14.556815682180702, 26.905075206054526, 3.1177962026019044, 522.6218942893234, 157.25540404126204, 9.448191729200616, 17.222667490147916, 21.01696663480254, 36.29565806992962, 48.30602806282228, 15.611367899393453, 207.21284637058184, 279.53144222018824, 312.84362807561587, 386.5571910328984, 178.12202650017656, 124.56021804407294, 353.2565492687273, 54.37205887352698, 99.9532225236304, 119.0368653210815, 248.9695616454919, 28.234906314352187, 71.59837853694597, 11.113197142656702, 0.0, 26.38777888329023, 7.457141557626523, 2.2598789008381077, 0.9591485958526326, 13.70136460422093, 4.572951822548603, 104.95195467172958, 56.047549487317404, 0.0, 10.904237539748184, 37.095558277340366, 4.2704592113056385, 20.151330713340048, 29.687597104620473, 28.499167670028232, 380.9432264274401, 315.3041775513923, 10.892794830451095, 30.81922268407601, 260.59717511853603, 279.2687529559968, 117.62557974390663, 103.29076379501504, 0.7548911264303774, 144.89798697965205, 20.56598325406952, 13.92890662244055]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8054522745606204, "mean_inference_ms": 2.4316052151969108, "mean_action_processing_ms": 0.3402751718080485, "mean_env_wait_ms": 0.2866637667737438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008707404136657715, "StateBufferConnector_ms": 0.008958697319030762, "ViewRequirementAgentConnector_ms": 0.14108455181121826}, "num_episodes": 18, "episode_return_max": 373.7612153013031, "episode_return_min": -182.99752207955837, "episode_return_mean": 133.82730108610957, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 245.68145750943597, "num_env_steps_trained_throughput_per_sec": 245.68145750943597, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 15500.497, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15500.439, "sample_time_ms": 1911.93, "learn_time_ms": 13563.292, "learn_throughput": 294.914, "synch_weights_time_ms": 21.907}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 26, "trial_id": "61e09_00000", "date": "2024-08-16_16-13-11", "timestamp": 1723804991, "time_this_iter_s": 16.33793592453003, "time_total_s": 392.6924271583557, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24ac940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 392.6924271583557, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 61.50833333333333, "ram_util_percent": 81.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2785216716862229, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.100073912660912, "policy_loss": -0.00867774473409607, "vf_loss": 2.1071415202642876, "vf_explained_var": 0.004536122430569281, "kl": 0.008050709417691518, "entropy": 0.8230943377686556, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.854696099278788, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.473485373946094, "policy_loss": -0.011661795690463531, "vf_loss": 3.4833703169747006, "vf_explained_var": 0.2626917118433291, "kl": 0.00888426058339729, "entropy": 1.3559186680607065, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 373.7612153013031, "episode_reward_min": -182.99752207955837, "episode_reward_mean": 113.23178491597615, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -704.201356310004, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 185.57761420227004, "predator_policy": 776.2738670890056}, "policy_reward_mean": {"prey_policy": -66.17918277821714, "predator_policy": 122.7950752362052}, "custom_metrics": {}, "hist_stats": {"episode_reward": [103.72636323833333, 247.39363878518668, 184.69375629698158, -182.99752207955837, 188.42999999999978, 125.30170717660428, 247.01872723781673, 339.8306673110893, 0.14706666048859635, 56.389999999999915, 183.56471881258625, 7.769999999999962, 167.76999999999992, 91.06803485431425, 152.92000000000007, 3.679999999999964, 207.2665547201101, 21.675004287560242, 212.4600000000001, 173.85999999999987, 149.0019794729463, 166.10999999999999, 335.33999523136555, 146.9585354263893, 216.2691031968784, 219.8028727627101, 3.2599999999999727, 17.90224061843379, 241.9598871153482, 205.67999999999998, 2.159999999999993, 3.799999999999963, 179.19999999999965, -117.70160538497805, -13.00179257943573, 79.86000000000004, 177.34205191921646, 37.08604571031249, 151.44048759882634, 98.30000000000034, 342.8058333489641, -5.197088012038751, 3.039999999999974, 78.64370500469967, 290.3368537258673, 48.7566254984408, 123.58000000000025, 215.3598785349243, 166.97999999999996, 208.51513585736427, 164.43882347179266, 363.14, 222.5099999999992, -14.413848666262815, 3.7999999999999634, 3.639999999999967, 215.48943791750398, 163.79560872540466, 263.9992516129617, 293.42166572340864, -43.796748889636234, 0.19507133707155838, 2.9099999999999757, 3.6299999999999657, 3.8599999999999612, 3.919999999999961, 3.9099999999999606, 3.4799999999999693, 161.10000000000002, 230.4500000000001, 188.91999999999973, 47.30568203141116, 373.7612153013031, 3.6599999999999655, 225.38789031039366, 203.94842188588774, 182.43489112643013, 191.92999999999972, 0.6199720801672638, 28.440695235574918, 191.0199999999997, 304.2068298740079, 109.70571365780674, 3.74999999999996, 6.169745352901657, 51.510393543848174, 17.34875684388027, 335.46091321139255, 165.07, 3.819999999999963, 126.86793964911327, -27.805771937777436, 4.339999999999951, 3.7799999999999625, 3.92999999999996, 34.82145926638767, 4.199999999999956, 170.06999999999994, -0.2584372670558348, 13.723457851952237], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.0864356499163064, -157.72958146801048, -200.74307050686457, 158.03334989985999, 170.1210829176651, -95.8431654406671, -666.3530782083229, -389.65613145131056, -140.44402335467387, 173.11506969823955, -71.97979801035984, -109.65361565601528, 114.53187783484655, -161.36986170495686, 152.65615167763337, 4.884508581137801, -17.748022804834537, -9.439020203237446, -219.8089451606953, -189.85300332326773, -34.742570744802116, -481.71449024124956, -52.10155208861009, -656.2763792889896, -39.85587883050079, 109.77090177015661, -8.970997796973219, -101.86854892972818, 93.85873253036023, -48.204033978534625, -63.692093228818955, 2.0000000000000013, 182.0696174757299, -69.5505517231942, -18.070092908996138, -392.47652460894545, 27.79677142387411, 116.17442213269173, -30.521861139422832, 111.78847134073743, -164.92856989051904, -453.6418499094741, 129.70798823027695, -0.08304706039829098, -704.201356310004, -4.864179164326871, -138.23496164542308, -10.557382771963644, -676.6432692495828, 120.41311673695775, -110.54502698137644, 143.4678796830608, -61.29969202895895, -95.93504340934665, -289.5200674979927, -23.6922463736394, -89.57592491314793, 118.05771522734715, -280.48633793410994, 179.1208285652702, -425.63772892356934, -39.93969024169496, -1.691958541613879, -52.997130382418526, 177.2299999999999, -1.5601991175318388, -263.32254911268296, -418.6289193445402, -86.30417563253508, -23.943108996856736, 52.33238730577884, -69.2175618032121, -75.74139635999394, -14.889421682682158, -19.020396112583473, -600.2948252783445, 13.502745388028888, 0.7533410612314896, 1.1259669404857684, 8.452020242881826, 141.42775356561435, -534.8566656726717, -9.655203676587996, -134.94571692255894, -221.4953985151369, -0.3805376367681075, -186.61756421505217, -230.76614361200365, -37.65607034729189, 184.5067564519146, -139.42565363933824, 0.14963626953758696, -29.862539445585565, 118.94422354749778, -376.1283386433822, -44.11265244708432, 138.6354676667682, -35.218967394762, 155.1107637424392, -56.08094285219432, 67.89869035225041, -37.29785396061766, 168.43622728869957, 166.5231843178193, 136.25890420024132, 56.228224391102025, -132.0718338862551, -562.2193131105944, -7.528191729200657, -15.34266749014774, -19.156966634802252, -34.51565806992998, 98.09204195528876, 53.479999999999706, -324.9486798653646, 2.0000000000000013, -428.4457445355097, -6.955822960042633, -192.03880938850503, 182.7782305676642, -201.04366364483877, -250.38169338705234, -74.54302116597212, -144.25199534166862, -247.82956164549293, -26.464906314351914, -69.91837853694511, -9.163197142656744, 2.0000000000000013, -24.52777888328994, -5.517141557626564, -0.2798789008381115, 1.0308514041473689, -11.78136460422097, -2.622951822548643, -103.4219546717288, 103.0524505126826, 2.0000000000000013, 49.3760858203721, 133.07411836253937, 182.80954078869436, -18.31133071333977, 7.807925190885025, -18.68900793412175, -80.31610228371704, -242.17008639381174, -8.982794830451136, -29.069222684075736, -90.94107579798792, -223.5369619661501, -9.707180828794122, -7.260740824239402, 180.2, -143.41798697965314, -18.64598325406922, 176.08109337755945, -75.52481195249149, -54.92103546803118, -57.856185726744535, -86.61082924047027, 185.57761420227004, -4.241111130129621, 68.87041131757974, -67.26127486366758, -120.24790600838922, 47.62413869665823, -77.38914843994267, 2.0000000000000013, -7.240034553878516, -230.0002297605091, -78.34519834142344, -0.6732030563171436, -8.744653691997888, -230.05007008007706, -470.51726820602494, -204.87055932768803, -14.344017288347985, 117.1682319944371, -15.076158313456139, -3.4500782021278784, -0.2735207287369177, -277.88594106629546, -211.05586823562825, -169.49508167022188, -44.53964650505241, -41.48253356530898, -32.53431241008316, 0.7420026351633472, -3.387830882686286, -2.697557327535094, -54.857107482718035, -44.522990627607726, -27.23330089714973, -143.38811774260913, 154.25379070431148, -38.756670012342404, -75.81626599552017, -24.47568937786982, -145.08984956876594, -47.412560000519235], "policy_predator_policy_reward": [168.81308989868714, 94.72929045757253, 229.61000996440873, 60.49334942778258, 8.092673379316844, 102.32316544066785, 776.2738670890056, 96.73782049106939, 142.68173461628197, 13.077219040151189, 294.1650407810033, 12.77008006197644, 76.10504895935675, 217.7516621485704, 48.04496000422819, 134.24504704808993, 21.148092394791597, 6.186017273769257, 274.98894516069504, 191.06300332326666, 317.87560806723303, 382.14617173140516, 53.87155208860974, 662.2763792889896, 41.62587883050044, 56.229098229843395, 12.039032651287492, 189.8685489297283, 57.20126746963975, 50.064033978534255, 65.3720932288196, 0.0, 58.39502903589662, 36.35245993167905, 54.93797268585089, 377.2836491196504, 27.267277023599043, 41.221529419835335, 32.37186113942299, 60.22152865926256, 318.74333830703284, 448.829060965906, 24.56715295964519, 11.917905870476215, 611.3217584050427, 433.0837723006552, 78.07233971101681, 217.67854013275945, 658.8991091192523, 113.60014659025143, 122.23788440566528, 64.64213565536065, 62.96969202895862, 97.52504340934746, 283.27811460408464, 47.83643988598011, 99.89634702239432, 113.58174977875643, 304.9963379341099, 2.0491714347298275, 426.1377289235689, 41.59969024169463, 3.661958541613844, 54.827130382418176, 0.0, 3.5301991175318066, 528.3634378951862, 35.88642517705632, 96.23484662330672, 1.0106454266504528, 25.79761269422134, 70.94756180321298, 155.82119161733652, 112.15167834455639, 56.10644182289627, 600.2948252783445, 8.637146537594807, 128.5472546119711, 81.90849209585029, 6.813520720782096, 253.65909942125217, 482.5756460347693, 3.1681156645492727, 136.2357169225578, 222.55539851513595, 2.3605376367681012, 290.69850635193495, 205.32890647981702, 54.17603448684265, 89.3101331344025, 37.03477206603892, 150.99787080220204, 31.672539445585848, 2.825776452502202, 333.89534171435736, 301.7055279110339, 26.5545323332318, 37.00896739476164, 68.40740494338618, 41.07791002373365, 84.14130964774958, 49.69667743241003, 13.623772711300408, 14.556815682180702, 26.905075206054526, 3.1177962026019044, 522.6218942893234, 157.25540404126204, 9.448191729200616, 17.222667490147916, 21.01696663480254, 36.29565806992962, 48.30602806282228, 15.611367899393453, 207.21284637058184, 279.53144222018824, 312.84362807561587, 386.5571910328984, 178.12202650017656, 124.56021804407294, 353.2565492687273, 54.37205887352698, 99.9532225236304, 119.0368653210815, 248.9695616454919, 28.234906314352187, 71.59837853694597, 11.113197142656702, 0.0, 26.38777888329023, 7.457141557626523, 2.2598789008381077, 0.9591485958526326, 13.70136460422093, 4.572951822548603, 104.95195467172958, 56.047549487317404, 0.0, 10.904237539748184, 37.095558277340366, 4.2704592113056385, 20.151330713340048, 29.687597104620473, 28.499167670028232, 380.9432264274401, 315.3041775513923, 10.892794830451095, 30.81922268407601, 260.59717511853603, 279.2687529559968, 117.62557974390663, 103.29076379501504, 0.7548911264303774, 144.89798697965205, 20.56598325406952, 13.92890662244055, 9.186891101749557, 121.87892839894083, 90.71455392124487, 82.19315628154482, 3.4923857977299546, 6.191111130129579, 197.66554312112495, 104.93215029897125, 122.55605164759079, 59.77342932194675, 79.13914843994357, 0.0, 12.15977990678019, 231.25022976050795, 31.845335743737245, 98.68345919785257, 101.41006386062587, 154.73341675532788, 420.84308534551604, 590.0056553995885, 16.22401728834798, 46.021768005562905, 16.936158313456264, 5.410078202127837, 169.6355570124942, 235.3918444316489, 77.62334717615927, 275.1218307919131, 46.229646505052074, 44.132533565308655, 34.324312410082804, 1.2479973648366542, 5.357830882686244, 4.657557327535052, 86.75811546391192, 47.443441912801305, 29.04330089715001, 145.77811774260786, 13.956209295688542, 40.616670012342034, 19.11168029813097, 80.92183780820423, 10.413691219476227, 195.8121762017603]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8097434204774859, "mean_inference_ms": 2.442302841977875, "mean_action_processing_ms": 0.3498496512175139, "mean_env_wait_ms": 0.2859404288611244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014739036560058594, "StateBufferConnector_ms": 0.009296298027038574, "ViewRequirementAgentConnector_ms": 0.18310952186584473}, "num_episodes": 22, "episode_return_max": 373.7612153013031, "episode_return_min": -182.99752207955837, "episode_return_mean": 113.23178491597615, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 251.2308611328924, "num_env_steps_trained_throughput_per_sec": 251.2308611328924, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 15513.531, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15513.48, "sample_time_ms": 1946.509, "learn_time_ms": 13542.233, "learn_throughput": 295.372, "synch_weights_time_ms": 21.926}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 27, "trial_id": "61e09_00000", "date": "2024-08-16_16-13-27", "timestamp": 1723805007, "time_this_iter_s": 15.964492082595825, "time_total_s": 408.65691924095154, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24acdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 408.65691924095154, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 61.70454545454545, "ram_util_percent": 82.20454545454545}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2579760805008904, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 1.993133201548662, "policy_loss": -0.011438581887287674, "vf_loss": 2.003149683860244, "vf_explained_var": 0.008683345999036517, "kl": 0.007110527411138581, "entropy": 0.8383020467543728, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2063713260743985, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.6749292700378984, "policy_loss": -0.008175658099304038, "vf_loss": 3.6814217234414723, "vf_explained_var": 0.24717822898001898, "kl": 0.00841607273520791, "entropy": 1.3313141636116794, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 373.7612153013031, "episode_reward_min": -118.79382875257168, "episode_reward_mean": 92.96597438159013, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -676.6432692495828, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 185.57761420227004, "predator_policy": 658.8991091192523}, "policy_reward_mean": {"prey_policy": -52.142586585164224, "predator_policy": 98.62557377595927}, "custom_metrics": {}, "hist_stats": {"episode_reward": [146.9585354263893, 216.2691031968784, 219.8028727627101, 3.2599999999999727, 17.90224061843379, 241.9598871153482, 205.67999999999998, 2.159999999999993, 3.799999999999963, 179.19999999999965, -117.70160538497805, -13.00179257943573, 79.86000000000004, 177.34205191921646, 37.08604571031249, 151.44048759882634, 98.30000000000034, 342.8058333489641, -5.197088012038751, 3.039999999999974, 78.64370500469967, 290.3368537258673, 48.7566254984408, 123.58000000000025, 215.3598785349243, 166.97999999999996, 208.51513585736427, 164.43882347179266, 363.14, 222.5099999999992, -14.413848666262815, 3.7999999999999634, 3.639999999999967, 215.48943791750398, 163.79560872540466, 263.9992516129617, 293.42166572340864, -43.796748889636234, 0.19507133707155838, 2.9099999999999757, 3.6299999999999657, 3.8599999999999612, 3.919999999999961, 3.9099999999999606, 3.4799999999999693, 161.10000000000002, 230.4500000000001, 188.91999999999973, 47.30568203141116, 373.7612153013031, 3.6599999999999655, 225.38789031039366, 203.94842188588774, 182.43489112643013, 191.92999999999972, 0.6199720801672638, 28.440695235574918, 191.0199999999997, 304.2068298740079, 109.70571365780674, 3.74999999999996, 6.169745352901657, 51.510393543848174, 17.34875684388027, 335.46091321139255, 165.07, 3.819999999999963, 126.86793964911327, -27.805771937777436, 4.339999999999951, 3.7799999999999625, 3.92999999999996, 34.82145926638767, 4.199999999999956, 170.06999999999994, -0.2584372670558348, 13.723457851952237, 3.6045570496451727, 179.96211450789696, 3.759999999999962, 3.409999999999971, -118.79382875257168, -8.464493556166184, 3.449999999999969, 3.8599999999999612, 24.713592286538773, 15.749999999999922, 3.759999999999963, -32.83443070754633, 2.625326574073381, -29.004227011068664, 180.32996151056128, 197.00999999999965, 79.8, 191.9299999999997, 149.2800000000001, 16.387236668001364, 185.96999999999974, 66.08382999786018, 33.25000000000003], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-138.23496164542308, -10.557382771963644, -676.6432692495828, 120.41311673695775, -110.54502698137644, 143.4678796830608, -61.29969202895895, -95.93504340934665, -289.5200674979927, -23.6922463736394, -89.57592491314793, 118.05771522734715, -280.48633793410994, 179.1208285652702, -425.63772892356934, -39.93969024169496, -1.691958541613879, -52.997130382418526, 177.2299999999999, -1.5601991175318388, -263.32254911268296, -418.6289193445402, -86.30417563253508, -23.943108996856736, 52.33238730577884, -69.2175618032121, -75.74139635999394, -14.889421682682158, -19.020396112583473, -600.2948252783445, 13.502745388028888, 0.7533410612314896, 1.1259669404857684, 8.452020242881826, 141.42775356561435, -534.8566656726717, -9.655203676587996, -134.94571692255894, -221.4953985151369, -0.3805376367681075, -186.61756421505217, -230.76614361200365, -37.65607034729189, 184.5067564519146, -139.42565363933824, 0.14963626953758696, -29.862539445585565, 118.94422354749778, -376.1283386433822, -44.11265244708432, 138.6354676667682, -35.218967394762, 155.1107637424392, -56.08094285219432, 67.89869035225041, -37.29785396061766, 168.43622728869957, 166.5231843178193, 136.25890420024132, 56.228224391102025, -132.0718338862551, -562.2193131105944, -7.528191729200657, -15.34266749014774, -19.156966634802252, -34.51565806992998, 98.09204195528876, 53.479999999999706, -324.9486798653646, 2.0000000000000013, -428.4457445355097, -6.955822960042633, -192.03880938850503, 182.7782305676642, -201.04366364483877, -250.38169338705234, -74.54302116597212, -144.25199534166862, -247.82956164549293, -26.464906314351914, -69.91837853694511, -9.163197142656744, 2.0000000000000013, -24.52777888328994, -5.517141557626564, -0.2798789008381115, 1.0308514041473689, -11.78136460422097, -2.622951822548643, -103.4219546717288, 103.0524505126826, 2.0000000000000013, 49.3760858203721, 133.07411836253937, 182.80954078869436, -18.31133071333977, 7.807925190885025, -18.68900793412175, -80.31610228371704, -242.17008639381174, -8.982794830451136, -29.069222684075736, -90.94107579798792, -223.5369619661501, -9.707180828794122, -7.260740824239402, 180.2, -143.41798697965314, -18.64598325406922, 176.08109337755945, -75.52481195249149, -54.92103546803118, -57.856185726744535, -86.61082924047027, 185.57761420227004, -4.241111130129621, 68.87041131757974, -67.26127486366758, -120.24790600838922, 47.62413869665823, -77.38914843994267, 2.0000000000000013, -7.240034553878516, -230.0002297605091, -78.34519834142344, -0.6732030563171436, -8.744653691997888, -230.05007008007706, -470.51726820602494, -204.87055932768803, -14.344017288347985, 117.1682319944371, -15.076158313456139, -3.4500782021278784, -0.2735207287369177, -277.88594106629546, -211.05586823562825, -169.49508167022188, -44.53964650505241, -41.48253356530898, -32.53431241008316, 0.7420026351633472, -3.387830882686286, -2.697557327535094, -54.857107482718035, -44.522990627607726, -27.23330089714973, -143.38811774260913, 154.25379070431148, -38.756670012342404, -75.81626599552017, -24.47568937786982, -145.08984956876594, -47.412560000519235, -41.58202602846673, -75.13599843512378, 149.21818491150051, -33.07909113751523, -48.135307726832835, -4.571349535963152, -16.35177479254254, -74.80524196679667, -271.7977368391828, -178.6723110150625, -152.42031338145938, -97.5786904033954, -1.818146377267457, -81.0979165358943, -6.749129571669608, -10.303277811065099, -79.17264925572005, -127.79737728908806, 1.08704884032179, -0.39331003839404466, -25.25737878054415, -11.178351937767976, -151.52016723323197, -99.362936142304, -13.322044782954523, -3.5505046132804923, -114.8165911504289, -178.8554190802455, -104.06539899338095, 162.602150260372, 178.8828833522676, 2.0000000000000013, -81.46987138912348, 44.65241609157467, -27.6957766883481, 178.2514142068883, 129.4190827918702, -12.908334078316607, -49.29852294424445, -1.3750736253228497, 163.33064201360182, -5.304789479818886, -128.65727007731203, -30.1026785209697, -22.287587296814156, -51.597624175376886], "policy_predator_policy_reward": [78.07233971101681, 217.67854013275945, 658.8991091192523, 113.60014659025143, 122.23788440566528, 64.64213565536065, 62.96969202895862, 97.52504340934746, 283.27811460408464, 47.83643988598011, 99.89634702239432, 113.58174977875643, 304.9963379341099, 2.0491714347298275, 426.1377289235689, 41.59969024169463, 3.661958541613844, 54.827130382418176, 0.0, 3.5301991175318066, 528.3634378951862, 35.88642517705632, 96.23484662330672, 1.0106454266504528, 25.79761269422134, 70.94756180321298, 155.82119161733652, 112.15167834455639, 56.10644182289627, 600.2948252783445, 8.637146537594807, 128.5472546119711, 81.90849209585029, 6.813520720782096, 253.65909942125217, 482.5756460347693, 3.1681156645492727, 136.2357169225578, 222.55539851513595, 2.3605376367681012, 290.69850635193495, 205.32890647981702, 54.17603448684265, 89.3101331344025, 37.03477206603892, 150.99787080220204, 31.672539445585848, 2.825776452502202, 333.89534171435736, 301.7055279110339, 26.5545323332318, 37.00896739476164, 68.40740494338618, 41.07791002373365, 84.14130964774958, 49.69667743241003, 13.623772711300408, 14.556815682180702, 26.905075206054526, 3.1177962026019044, 522.6218942893234, 157.25540404126204, 9.448191729200616, 17.222667490147916, 21.01696663480254, 36.29565806992962, 48.30602806282228, 15.611367899393453, 207.21284637058184, 279.53144222018824, 312.84362807561587, 386.5571910328984, 178.12202650017656, 124.56021804407294, 353.2565492687273, 54.37205887352698, 99.9532225236304, 119.0368653210815, 248.9695616454919, 28.234906314352187, 71.59837853694597, 11.113197142656702, 0.0, 26.38777888329023, 7.457141557626523, 2.2598789008381077, 0.9591485958526326, 13.70136460422093, 4.572951822548603, 104.95195467172958, 56.047549487317404, 0.0, 10.904237539748184, 37.095558277340366, 4.2704592113056385, 20.151330713340048, 29.687597104620473, 28.499167670028232, 380.9432264274401, 315.3041775513923, 10.892794830451095, 30.81922268407601, 260.59717511853603, 279.2687529559968, 117.62557974390663, 103.29076379501504, 0.7548911264303774, 144.89798697965205, 20.56598325406952, 13.92890662244055, 9.186891101749557, 121.87892839894083, 90.71455392124487, 82.19315628154482, 3.4923857977299546, 6.191111130129579, 197.66554312112495, 104.93215029897125, 122.55605164759079, 59.77342932194675, 79.13914843994357, 0.0, 12.15977990678019, 231.25022976050795, 31.845335743737245, 98.68345919785257, 101.41006386062587, 154.73341675532788, 420.84308534551604, 590.0056553995885, 16.22401728834798, 46.021768005562905, 16.936158313456264, 5.410078202127837, 169.6355570124942, 235.3918444316489, 77.62334717615927, 275.1218307919131, 46.229646505052074, 44.132533565308655, 34.324312410082804, 1.2479973648366542, 5.357830882686244, 4.657557327535052, 86.75811546391192, 47.443441912801305, 29.04330089715001, 145.77811774260786, 13.956209295688542, 40.616670012342034, 19.11168029813097, 80.92183780820423, 10.413691219476227, 195.8121762017603, 107.39258845280092, 12.929993060435226, 42.046409302482175, 21.77661143142941, 49.945307726832475, 6.52134953596311, 18.28177479254284, 76.2852419667971, 2.2918701134723998, 329.3843489882005, 29.94856715283956, 211.5859430758491, 3.7881463772674193, 82.57791653589466, 8.679129571669566, 12.233277811065058, 128.54711125111973, 103.13650758022627, 0.9029511596782114, 14.153310038394043, 27.117378780544442, 13.078351937767941, 40.05552285441988, 177.9931498135697, 15.222044782954482, 4.275831187353844, 242.45971512372824, 22.208068095877714, 115.38547438413671, 6.407735859434467, 16.127116647732386, 0.0, 91.03987138912427, 25.57758390842552, 32.73499505672016, 8.639367424739927, 17.99091720812984, 14.778334078316567, 42.50403761404087, 24.556795623527428, 20.699357986398173, 7.244789479818845, 125.19361833803876, 99.65016025810141, 24.087587296814437, 83.0476241753766]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8115653910195302, "mean_inference_ms": 2.4582598946222483, "mean_action_processing_ms": 0.3606476886892733, "mean_env_wait_ms": 0.2867636836188961, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014907598495483398, "StateBufferConnector_ms": 0.009270548820495605, "ViewRequirementAgentConnector_ms": 0.172255277633667}, "num_episodes": 23, "episode_return_max": 373.7612153013031, "episode_return_min": -118.79382875257168, "episode_return_mean": 92.96597438159013, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 259.8399584880926, "num_env_steps_trained_throughput_per_sec": 259.8399584880926, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 15513.071, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15513.02, "sample_time_ms": 1940.978, "learn_time_ms": 13547.364, "learn_throughput": 295.26, "synch_weights_time_ms": 21.875}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 28, "trial_id": "61e09_00000", "date": "2024-08-16_16-13-42", "timestamp": 1723805022, "time_this_iter_s": 15.445188760757446, "time_total_s": 424.102108001709, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24af670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 424.102108001709, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 64.17727272727274, "ram_util_percent": 82.64999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3338315748348437, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 1.6795539125248238, "policy_loss": -0.012561992347171461, "vf_loss": 1.6906479393048262, "vf_explained_var": 0.013371045564217542, "kl": 0.007339842878491271, "entropy": 0.8472901349345212, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1614997473974076, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.5552941795379396, "policy_loss": -0.010211451551211732, "vf_loss": 3.564159392805957, "vf_explained_var": 0.5354114004859218, "kl": 0.006731207032171009, "entropy": 1.309000291521587, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 373.7612153013031, "episode_reward_min": -118.79382875257168, "episode_reward_mean": 84.56309165360518, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -562.2193131105944, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 189.88718802684642, "predator_policy": 590.0056553995885}, "policy_reward_mean": {"prey_policy": -38.314295439387834, "predator_policy": 80.59584126619039}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.197088012038751, 3.039999999999974, 78.64370500469967, 290.3368537258673, 48.7566254984408, 123.58000000000025, 215.3598785349243, 166.97999999999996, 208.51513585736427, 164.43882347179266, 363.14, 222.5099999999992, -14.413848666262815, 3.7999999999999634, 3.639999999999967, 215.48943791750398, 163.79560872540466, 263.9992516129617, 293.42166572340864, -43.796748889636234, 0.19507133707155838, 2.9099999999999757, 3.6299999999999657, 3.8599999999999612, 3.919999999999961, 3.9099999999999606, 3.4799999999999693, 161.10000000000002, 230.4500000000001, 188.91999999999973, 47.30568203141116, 373.7612153013031, 3.6599999999999655, 225.38789031039366, 203.94842188588774, 182.43489112643013, 191.92999999999972, 0.6199720801672638, 28.440695235574918, 191.0199999999997, 304.2068298740079, 109.70571365780674, 3.74999999999996, 6.169745352901657, 51.510393543848174, 17.34875684388027, 335.46091321139255, 165.07, 3.819999999999963, 126.86793964911327, -27.805771937777436, 4.339999999999951, 3.7799999999999625, 3.92999999999996, 34.82145926638767, 4.199999999999956, 170.06999999999994, -0.2584372670558348, 13.723457851952237, 3.6045570496451727, 179.96211450789696, 3.759999999999962, 3.409999999999971, -118.79382875257168, -8.464493556166184, 3.449999999999969, 3.8599999999999612, 24.713592286538773, 15.749999999999922, 3.759999999999963, -32.83443070754633, 2.625326574073381, -29.004227011068664, 180.32996151056128, 197.00999999999965, 79.8, 191.9299999999997, 149.2800000000001, 16.387236668001364, 185.96999999999974, 66.08382999786018, 33.25000000000003, 160.2, 189.82999999999973, -72.89763953960203, 172.15999999999957, -22.890660300395965, 3.8299999999999628, 3.92999999999996, 3.169999999999978, -50.50198579475633, 159.89999999999998, 3.6699999999999635, 3.8999999999999604, 173.62999999999988, 213.78219571317257, -15.71346170475846, 218.08693856051178, 4.809999999999941, 3.93999999999996], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-9.655203676587996, -134.94571692255894, -221.4953985151369, -0.3805376367681075, -186.61756421505217, -230.76614361200365, -37.65607034729189, 184.5067564519146, -139.42565363933824, 0.14963626953758696, -29.862539445585565, 118.94422354749778, -376.1283386433822, -44.11265244708432, 138.6354676667682, -35.218967394762, 155.1107637424392, -56.08094285219432, 67.89869035225041, -37.29785396061766, 168.43622728869957, 166.5231843178193, 136.25890420024132, 56.228224391102025, -132.0718338862551, -562.2193131105944, -7.528191729200657, -15.34266749014774, -19.156966634802252, -34.51565806992998, 98.09204195528876, 53.479999999999706, -324.9486798653646, 2.0000000000000013, -428.4457445355097, -6.955822960042633, -192.03880938850503, 182.7782305676642, -201.04366364483877, -250.38169338705234, -74.54302116597212, -144.25199534166862, -247.82956164549293, -26.464906314351914, -69.91837853694511, -9.163197142656744, 2.0000000000000013, -24.52777888328994, -5.517141557626564, -0.2798789008381115, 1.0308514041473689, -11.78136460422097, -2.622951822548643, -103.4219546717288, 103.0524505126826, 2.0000000000000013, 49.3760858203721, 133.07411836253937, 182.80954078869436, -18.31133071333977, 7.807925190885025, -18.68900793412175, -80.31610228371704, -242.17008639381174, -8.982794830451136, -29.069222684075736, -90.94107579798792, -223.5369619661501, -9.707180828794122, -7.260740824239402, 180.2, -143.41798697965314, -18.64598325406922, 176.08109337755945, -75.52481195249149, -54.92103546803118, -57.856185726744535, -86.61082924047027, 185.57761420227004, -4.241111130129621, 68.87041131757974, -67.26127486366758, -120.24790600838922, 47.62413869665823, -77.38914843994267, 2.0000000000000013, -7.240034553878516, -230.0002297605091, -78.34519834142344, -0.6732030563171436, -8.744653691997888, -230.05007008007706, -470.51726820602494, -204.87055932768803, -14.344017288347985, 117.1682319944371, -15.076158313456139, -3.4500782021278784, -0.2735207287369177, -277.88594106629546, -211.05586823562825, -169.49508167022188, -44.53964650505241, -41.48253356530898, -32.53431241008316, 0.7420026351633472, -3.387830882686286, -2.697557327535094, -54.857107482718035, -44.522990627607726, -27.23330089714973, -143.38811774260913, 154.25379070431148, -38.756670012342404, -75.81626599552017, -24.47568937786982, -145.08984956876594, -47.412560000519235, -41.58202602846673, -75.13599843512378, 149.21818491150051, -33.07909113751523, -48.135307726832835, -4.571349535963152, -16.35177479254254, -74.80524196679667, -271.7977368391828, -178.6723110150625, -152.42031338145938, -97.5786904033954, -1.818146377267457, -81.0979165358943, -6.749129571669608, -10.303277811065099, -79.17264925572005, -127.79737728908806, 1.08704884032179, -0.39331003839404466, -25.25737878054415, -11.178351937767976, -151.52016723323197, -99.362936142304, -13.322044782954523, -3.5505046132804923, -114.8165911504289, -178.8554190802455, -104.06539899338095, 162.602150260372, 178.8828833522676, 2.0000000000000013, -81.46987138912348, 44.65241609157467, -27.6957766883481, 178.2514142068883, 129.4190827918702, -12.908334078316607, -49.29852294424445, -1.3750736253228497, 163.33064201360182, -5.304789479818886, -128.65727007731203, -30.1026785209697, -22.287587296814156, -51.597624175376886, -12.16161628969007, 144.5152980987985, -23.169682411084416, 179.0167820581746, -124.70577281734722, -129.48969190544886, 165.36758859165934, -10.56138273011682, -67.90169726383138, -113.77457892050221, -19.867602312557214, 2.0000000000000013, 2.0000000000000013, -5.814498406408091, -38.3591435526389, -145.02568712110445, -163.171014389629, -90.44220268612962, -26.957806416636398, 38.289064097312924, -100.34134679590446, 0.9519411483134762, -7.318071881308816, -2.357656549094269, 142.45268819597334, -43.947151871532164, -38.73270668622645, 189.88718802684642, -71.01428448430237, -78.60213872015753, 47.55020364293022, -256.01237069924395, -4.705970980507768, -18.471096518645837, -3.183558076854016, 1.0642804903561263], "policy_predator_policy_reward": [3.1681156645492727, 136.2357169225578, 222.55539851513595, 2.3605376367681012, 290.69850635193495, 205.32890647981702, 54.17603448684265, 89.3101331344025, 37.03477206603892, 150.99787080220204, 31.672539445585848, 2.825776452502202, 333.89534171435736, 301.7055279110339, 26.5545323332318, 37.00896739476164, 68.40740494338618, 41.07791002373365, 84.14130964774958, 49.69667743241003, 13.623772711300408, 14.556815682180702, 26.905075206054526, 3.1177962026019044, 522.6218942893234, 157.25540404126204, 9.448191729200616, 17.222667490147916, 21.01696663480254, 36.29565806992962, 48.30602806282228, 15.611367899393453, 207.21284637058184, 279.53144222018824, 312.84362807561587, 386.5571910328984, 178.12202650017656, 124.56021804407294, 353.2565492687273, 54.37205887352698, 99.9532225236304, 119.0368653210815, 248.9695616454919, 28.234906314352187, 71.59837853694597, 11.113197142656702, 0.0, 26.38777888329023, 7.457141557626523, 2.2598789008381077, 0.9591485958526326, 13.70136460422093, 4.572951822548603, 104.95195467172958, 56.047549487317404, 0.0, 10.904237539748184, 37.095558277340366, 4.2704592113056385, 20.151330713340048, 29.687597104620473, 28.499167670028232, 380.9432264274401, 315.3041775513923, 10.892794830451095, 30.81922268407601, 260.59717511853603, 279.2687529559968, 117.62557974390663, 103.29076379501504, 0.7548911264303774, 144.89798697965205, 20.56598325406952, 13.92890662244055, 9.186891101749557, 121.87892839894083, 90.71455392124487, 82.19315628154482, 3.4923857977299546, 6.191111130129579, 197.66554312112495, 104.93215029897125, 122.55605164759079, 59.77342932194675, 79.13914843994357, 0.0, 12.15977990678019, 231.25022976050795, 31.845335743737245, 98.68345919785257, 101.41006386062587, 154.73341675532788, 420.84308534551604, 590.0056553995885, 16.22401728834798, 46.021768005562905, 16.936158313456264, 5.410078202127837, 169.6355570124942, 235.3918444316489, 77.62334717615927, 275.1218307919131, 46.229646505052074, 44.132533565308655, 34.324312410082804, 1.2479973648366542, 5.357830882686244, 4.657557327535052, 86.75811546391192, 47.443441912801305, 29.04330089715001, 145.77811774260786, 13.956209295688542, 40.616670012342034, 19.11168029813097, 80.92183780820423, 10.413691219476227, 195.8121762017603, 107.39258845280092, 12.929993060435226, 42.046409302482175, 21.77661143142941, 49.945307726832475, 6.52134953596311, 18.28177479254284, 76.2852419667971, 2.2918701134723998, 329.3843489882005, 29.94856715283956, 211.5859430758491, 3.7881463772674193, 82.57791653589466, 8.679129571669566, 12.233277811065058, 128.54711125111973, 103.13650758022627, 0.9029511596782114, 14.153310038394043, 27.117378780544442, 13.078351937767941, 40.05552285441988, 177.9931498135697, 15.222044782954482, 4.275831187353844, 242.45971512372824, 22.208068095877714, 115.38547438413671, 6.407735859434467, 16.127116647732386, 0.0, 91.03987138912427, 25.57758390842552, 32.73499505672016, 8.639367424739927, 17.99091720812984, 14.778334078316567, 42.50403761404087, 24.556795623527428, 20.699357986398173, 7.244789479818845, 125.19361833803876, 99.65016025810141, 24.087587296814437, 83.0476241753766, 14.031616289690033, 13.814701901201488, 24.959682411084696, 9.023217941825402, 180.50226727011767, 0.7955579130742962, 4.8924114083405295, 12.46138273011678, 135.56433603216396, 23.22127985177416, 21.6976023125575, 0.0, 0.0, 7.744498406408051, 107.92118831053727, 78.63364236320469, 199.20496491168322, 3.9062663693190895, 28.81780641663669, 119.75093590268708, 93.96557808926869, 9.093827558323138, 9.248071881308775, 4.327656549094227, 29.547311804026677, 45.577151871531846, 35.52207533567582, 27.105639036876905, 132.9953543508311, 0.9076071488714543, 228.8660723145343, 197.68303330229065, 6.645970980507727, 21.34109651864613, 5.133558076853975, 0.9257195096438752]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8143239089666301, "mean_inference_ms": 2.4693157762062667, "mean_action_processing_ms": 0.3683226224659656, "mean_env_wait_ms": 0.28682387820781585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014410734176635742, "StateBufferConnector_ms": 0.009232163429260254, "ViewRequirementAgentConnector_ms": 0.1690312623977661}, "num_episodes": 18, "episode_return_max": 373.7612153013031, "episode_return_min": -118.79382875257168, "episode_return_mean": 84.56309165360518, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.19996185318536, "num_env_steps_trained_throughput_per_sec": 267.19996185318536, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 15489.295, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15489.244, "sample_time_ms": 1950.745, "learn_time_ms": 13513.557, "learn_throughput": 295.999, "synch_weights_time_ms": 22.116}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 29, "trial_id": "61e09_00000", "date": "2024-08-16_16-13-57", "timestamp": 1723805037, "time_this_iter_s": 15.005632877349854, "time_total_s": 439.10774087905884, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24acee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 439.10774087905884, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 64.62272727272727, "ram_util_percent": 82.28181818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.332744417367158, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 1.2063863306133835, "policy_loss": -0.008732219994629895, "vf_loss": 1.2139013729398214, "vf_explained_var": 0.01133953266673618, "kl": 0.006085887795935858, "entropy": 0.7194034620567604, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1589873546330387, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.703712042109676, "policy_loss": -0.00956497948269345, "vf_loss": 2.7118530608989575, "vf_explained_var": 0.5866342688048327, "kl": 0.0071197627335004175, "entropy": 1.3149319704878266, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 373.7612153013031, "episode_reward_min": -118.79382875257168, "episode_reward_mean": 77.88723040236117, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -470.51726820602494, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.97257175807573, "predator_policy": 590.0056553995885}, "policy_reward_mean": {"prey_policy": -25.854571276030214, "predator_policy": 64.7981864772108}, "custom_metrics": {}, "hist_stats": {"episode_reward": [293.42166572340864, -43.796748889636234, 0.19507133707155838, 2.9099999999999757, 3.6299999999999657, 3.8599999999999612, 3.919999999999961, 3.9099999999999606, 3.4799999999999693, 161.10000000000002, 230.4500000000001, 188.91999999999973, 47.30568203141116, 373.7612153013031, 3.6599999999999655, 225.38789031039366, 203.94842188588774, 182.43489112643013, 191.92999999999972, 0.6199720801672638, 28.440695235574918, 191.0199999999997, 304.2068298740079, 109.70571365780674, 3.74999999999996, 6.169745352901657, 51.510393543848174, 17.34875684388027, 335.46091321139255, 165.07, 3.819999999999963, 126.86793964911327, -27.805771937777436, 4.339999999999951, 3.7799999999999625, 3.92999999999996, 34.82145926638767, 4.199999999999956, 170.06999999999994, -0.2584372670558348, 13.723457851952237, 3.6045570496451727, 179.96211450789696, 3.759999999999962, 3.409999999999971, -118.79382875257168, -8.464493556166184, 3.449999999999969, 3.8599999999999612, 24.713592286538773, 15.749999999999922, 3.759999999999963, -32.83443070754633, 2.625326574073381, -29.004227011068664, 180.32996151056128, 197.00999999999965, 79.8, 191.9299999999997, 149.2800000000001, 16.387236668001364, 185.96999999999974, 66.08382999786018, 33.25000000000003, 160.2, 189.82999999999973, -72.89763953960203, 172.15999999999957, -22.890660300395965, 3.8299999999999628, 3.92999999999996, 3.169999999999978, -50.50198579475633, 159.89999999999998, 3.6699999999999635, 3.8999999999999604, 173.62999999999988, 213.78219571317257, -15.71346170475846, 218.08693856051178, 4.809999999999941, 3.93999999999996, 12.879999999999914, 13.862573922711384, 185.96999999999974, 180.99999999999977, 180.54999999999978, 3.869999999999962, -0.04295812311041314, 192.0099999999997, 104.64838382885874, 3.7599999999999643, 213.46999999999952, 186.90999999999985, 193.80999999999966, 15.653718110867448, 194.97999999999968, -4.345617860846943, 165.94215866777827, 3.899999999999961], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-192.03880938850503, 182.7782305676642, -201.04366364483877, -250.38169338705234, -74.54302116597212, -144.25199534166862, -247.82956164549293, -26.464906314351914, -69.91837853694511, -9.163197142656744, 2.0000000000000013, -24.52777888328994, -5.517141557626564, -0.2798789008381115, 1.0308514041473689, -11.78136460422097, -2.622951822548643, -103.4219546717288, 103.0524505126826, 2.0000000000000013, 49.3760858203721, 133.07411836253937, 182.80954078869436, -18.31133071333977, 7.807925190885025, -18.68900793412175, -80.31610228371704, -242.17008639381174, -8.982794830451136, -29.069222684075736, -90.94107579798792, -223.5369619661501, -9.707180828794122, -7.260740824239402, 180.2, -143.41798697965314, -18.64598325406922, 176.08109337755945, -75.52481195249149, -54.92103546803118, -57.856185726744535, -86.61082924047027, 185.57761420227004, -4.241111130129621, 68.87041131757974, -67.26127486366758, -120.24790600838922, 47.62413869665823, -77.38914843994267, 2.0000000000000013, -7.240034553878516, -230.0002297605091, -78.34519834142344, -0.6732030563171436, -8.744653691997888, -230.05007008007706, -470.51726820602494, -204.87055932768803, -14.344017288347985, 117.1682319944371, -15.076158313456139, -3.4500782021278784, -0.2735207287369177, -277.88594106629546, -211.05586823562825, -169.49508167022188, -44.53964650505241, -41.48253356530898, -32.53431241008316, 0.7420026351633472, -3.387830882686286, -2.697557327535094, -54.857107482718035, -44.522990627607726, -27.23330089714973, -143.38811774260913, 154.25379070431148, -38.756670012342404, -75.81626599552017, -24.47568937786982, -145.08984956876594, -47.412560000519235, -41.58202602846673, -75.13599843512378, 149.21818491150051, -33.07909113751523, -48.135307726832835, -4.571349535963152, -16.35177479254254, -74.80524196679667, -271.7977368391828, -178.6723110150625, -152.42031338145938, -97.5786904033954, -1.818146377267457, -81.0979165358943, -6.749129571669608, -10.303277811065099, -79.17264925572005, -127.79737728908806, 1.08704884032179, -0.39331003839404466, -25.25737878054415, -11.178351937767976, -151.52016723323197, -99.362936142304, -13.322044782954523, -3.5505046132804923, -114.8165911504289, -178.8554190802455, -104.06539899338095, 162.602150260372, 178.8828833522676, 2.0000000000000013, -81.46987138912348, 44.65241609157467, -27.6957766883481, 178.2514142068883, 129.4190827918702, -12.908334078316607, -49.29852294424445, -1.3750736253228497, 163.33064201360182, -5.304789479818886, -128.65727007731203, -30.1026785209697, -22.287587296814156, -51.597624175376886, -12.16161628969007, 144.5152980987985, -23.169682411084416, 179.0167820581746, -124.70577281734722, -129.48969190544886, 165.36758859165934, -10.56138273011682, -67.90169726383138, -113.77457892050221, -19.867602312557214, 2.0000000000000013, 2.0000000000000013, -5.814498406408091, -38.3591435526389, -145.02568712110445, -163.171014389629, -90.44220268612962, -26.957806416636398, 38.289064097312924, -100.34134679590446, 0.9519411483134762, -7.318071881308816, -2.357656549094269, 142.45268819597334, -43.947151871532164, -38.73270668622645, 189.88718802684642, -71.01428448430237, -78.60213872015753, 47.55020364293022, -256.01237069924395, -4.705970980507768, -18.471096518645837, -3.183558076854016, 1.0642804903561263, 1.1267331698296112, 8.861861521648855, -94.45857860938125, -4.489392798071494, -9.954943430973321, 165.46646968214327, 137.30486310253852, 2.0000000000000013, 146.8674147781877, -95.87634724752805, -4.935849865834518, -6.561613841634237, -31.56965885007113, -62.232763214644756, 1.0862704714032112, 180.5266742019099, -9.554479919797226, -198.71289392320037, 1.1001506572962505, -22.179051566826402, -48.542821864624386, 196.97257175807573, -24.181106498064104, 175.40277332404236, -25.942416027812023, 185.68086501800397, -4.317597294979592, -25.83061632873322, -0.18129045575268998, 182.47699529793508, -21.70064751618861, -7.825945186756432, 90.51187982514479, 0.8644912906281085, -2.8195030531947447, -7.002005339847983], "policy_predator_policy_reward": [178.12202650017656, 124.56021804407294, 353.2565492687273, 54.37205887352698, 99.9532225236304, 119.0368653210815, 248.9695616454919, 28.234906314352187, 71.59837853694597, 11.113197142656702, 0.0, 26.38777888329023, 7.457141557626523, 2.2598789008381077, 0.9591485958526326, 13.70136460422093, 4.572951822548603, 104.95195467172958, 56.047549487317404, 0.0, 10.904237539748184, 37.095558277340366, 4.2704592113056385, 20.151330713340048, 29.687597104620473, 28.499167670028232, 380.9432264274401, 315.3041775513923, 10.892794830451095, 30.81922268407601, 260.59717511853603, 279.2687529559968, 117.62557974390663, 103.29076379501504, 0.7548911264303774, 144.89798697965205, 20.56598325406952, 13.92890662244055, 9.186891101749557, 121.87892839894083, 90.71455392124487, 82.19315628154482, 3.4923857977299546, 6.191111130129579, 197.66554312112495, 104.93215029897125, 122.55605164759079, 59.77342932194675, 79.13914843994357, 0.0, 12.15977990678019, 231.25022976050795, 31.845335743737245, 98.68345919785257, 101.41006386062587, 154.73341675532788, 420.84308534551604, 590.0056553995885, 16.22401728834798, 46.021768005562905, 16.936158313456264, 5.410078202127837, 169.6355570124942, 235.3918444316489, 77.62334717615927, 275.1218307919131, 46.229646505052074, 44.132533565308655, 34.324312410082804, 1.2479973648366542, 5.357830882686244, 4.657557327535052, 86.75811546391192, 47.443441912801305, 29.04330089715001, 145.77811774260786, 13.956209295688542, 40.616670012342034, 19.11168029813097, 80.92183780820423, 10.413691219476227, 195.8121762017603, 107.39258845280092, 12.929993060435226, 42.046409302482175, 21.77661143142941, 49.945307726832475, 6.52134953596311, 18.28177479254284, 76.2852419667971, 2.2918701134723998, 329.3843489882005, 29.94856715283956, 211.5859430758491, 3.7881463772674193, 82.57791653589466, 8.679129571669566, 12.233277811065058, 128.54711125111973, 103.13650758022627, 0.9029511596782114, 14.153310038394043, 27.117378780544442, 13.078351937767941, 40.05552285441988, 177.9931498135697, 15.222044782954482, 4.275831187353844, 242.45971512372824, 22.208068095877714, 115.38547438413671, 6.407735859434467, 16.127116647732386, 0.0, 91.03987138912427, 25.57758390842552, 32.73499505672016, 8.639367424739927, 17.99091720812984, 14.778334078316567, 42.50403761404087, 24.556795623527428, 20.699357986398173, 7.244789479818845, 125.19361833803876, 99.65016025810141, 24.087587296814437, 83.0476241753766, 14.031616289690033, 13.814701901201488, 24.959682411084696, 9.023217941825402, 180.50226727011767, 0.7955579130742962, 4.8924114083405295, 12.46138273011678, 135.56433603216396, 23.22127985177416, 21.6976023125575, 0.0, 0.0, 7.744498406408051, 107.92118831053727, 78.63364236320469, 199.20496491168322, 3.9062663693190895, 28.81780641663669, 119.75093590268708, 93.96557808926869, 9.093827558323138, 9.248071881308775, 4.327656549094227, 29.547311804026677, 45.577151871531846, 35.52207533567582, 27.105639036876905, 132.9953543508311, 0.9076071488714543, 228.8660723145343, 197.68303330229065, 6.645970980507727, 21.34109651864613, 5.133558076853975, 0.9257195096438752, 0.86326683017039, 2.0281384783511047, 92.69629901913653, 20.114246311028484, 11.91494343097328, 18.54353031785671, 3.009576027540888, 38.68556086992059, 32.142585221812276, 97.41634724752878, 6.8858498658344764, 8.481613841634196, 25.731638109551653, 68.0278258320533, 0.9037295285967901, 9.493325798090078, 123.08817263602494, 189.82758503582997, 0.8898493427037508, 23.94905156682666, 32.593990590708295, 32.4462595158401, 26.031106498064393, 9.657226675957665, 27.7224160278123, 6.3491349819960226, 29.472300419053788, 16.32963131552677, 2.161290455752688, 10.52300470206492, 23.651896800281463, 1.5290780418169603, 10.245801362566786, 64.31998618943838, 4.789503053194703, 8.932005339847942]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8162754685480225, "mean_inference_ms": 2.4787903842674064, "mean_action_processing_ms": 0.36907761942874073, "mean_env_wait_ms": 0.28678371529540414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013831853866577148, "StateBufferConnector_ms": 0.009173989295959473, "ViewRequirementAgentConnector_ms": 0.1517941951751709}, "num_episodes": 18, "episode_return_max": 373.7612153013031, "episode_return_min": -118.79382875257168, "episode_return_mean": 77.88723040236117, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 270.768540712569, "num_env_steps_trained_throughput_per_sec": 270.768540712569, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 15472.622, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15472.568, "sample_time_ms": 1947.938, "learn_time_ms": 13500.178, "learn_throughput": 296.292, "synch_weights_time_ms": 21.474}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 30, "trial_id": "61e09_00000", "date": "2024-08-16_16-14-12", "timestamp": 1723805052, "time_this_iter_s": 14.816297054290771, "time_total_s": 453.9240379333496, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24acc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 453.9240379333496, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 62.719047619047615, "ram_util_percent": 82.32380952380953}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.295010992963478, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 1.9206828562670915, "policy_loss": -0.010900405927304986, "vf_loss": 1.9302479585957906, "vf_explained_var": 0.016202846216777013, "kl": 0.00667650019739315, "entropy": 0.7171591546169664, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2496259067109023, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.8221075104657936, "policy_loss": -0.009484197642831576, "vf_loss": 3.829782181315952, "vf_explained_var": 0.5325300755639556, "kl": 0.009047655742420065, "entropy": 1.3213468469639935, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 335.46091321139255, "episode_reward_min": -118.79382875257168, "episode_reward_mean": 67.68026991757353, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -470.51726820602494, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.97257175807573, "predator_policy": 590.0056553995885}, "policy_reward_mean": {"prey_policy": -21.86822560107622, "predator_policy": 55.70836055986301}, "custom_metrics": {}, "hist_stats": {"episode_reward": [191.92999999999972, 0.6199720801672638, 28.440695235574918, 191.0199999999997, 304.2068298740079, 109.70571365780674, 3.74999999999996, 6.169745352901657, 51.510393543848174, 17.34875684388027, 335.46091321139255, 165.07, 3.819999999999963, 126.86793964911327, -27.805771937777436, 4.339999999999951, 3.7799999999999625, 3.92999999999996, 34.82145926638767, 4.199999999999956, 170.06999999999994, -0.2584372670558348, 13.723457851952237, 3.6045570496451727, 179.96211450789696, 3.759999999999962, 3.409999999999971, -118.79382875257168, -8.464493556166184, 3.449999999999969, 3.8599999999999612, 24.713592286538773, 15.749999999999922, 3.759999999999963, -32.83443070754633, 2.625326574073381, -29.004227011068664, 180.32996151056128, 197.00999999999965, 79.8, 191.9299999999997, 149.2800000000001, 16.387236668001364, 185.96999999999974, 66.08382999786018, 33.25000000000003, 160.2, 189.82999999999973, -72.89763953960203, 172.15999999999957, -22.890660300395965, 3.8299999999999628, 3.92999999999996, 3.169999999999978, -50.50198579475633, 159.89999999999998, 3.6699999999999635, 3.8999999999999604, 173.62999999999988, 213.78219571317257, -15.71346170475846, 218.08693856051178, 4.809999999999941, 3.93999999999996, 12.879999999999914, 13.862573922711384, 185.96999999999974, 180.99999999999977, 180.54999999999978, 3.869999999999962, -0.04295812311041314, 192.0099999999997, 104.64838382885874, 3.7599999999999643, 213.46999999999952, 186.90999999999985, 193.80999999999966, 15.653718110867448, 194.97999999999968, -4.345617860846943, 165.94215866777827, 3.899999999999961, 3.729999999999964, 162.39999999999998, 3.7599999999999634, 3.90999999999996, 3.2099999999999755, 196.28999999999968, 1.9519660112501078, 4.675216161947491, 223.47700692918053, 40.104430476002825, 3.889999999999961, 9.852957021285556, 14.880463747839986, 3.5999999999999677, 3.4599999999999698, 180.9299999999998, 3.87999999999996, 3.7999999999999625], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-18.64598325406922, 176.08109337755945, -75.52481195249149, -54.92103546803118, -57.856185726744535, -86.61082924047027, 185.57761420227004, -4.241111130129621, 68.87041131757974, -67.26127486366758, -120.24790600838922, 47.62413869665823, -77.38914843994267, 2.0000000000000013, -7.240034553878516, -230.0002297605091, -78.34519834142344, -0.6732030563171436, -8.744653691997888, -230.05007008007706, -470.51726820602494, -204.87055932768803, -14.344017288347985, 117.1682319944371, -15.076158313456139, -3.4500782021278784, -0.2735207287369177, -277.88594106629546, -211.05586823562825, -169.49508167022188, -44.53964650505241, -41.48253356530898, -32.53431241008316, 0.7420026351633472, -3.387830882686286, -2.697557327535094, -54.857107482718035, -44.522990627607726, -27.23330089714973, -143.38811774260913, 154.25379070431148, -38.756670012342404, -75.81626599552017, -24.47568937786982, -145.08984956876594, -47.412560000519235, -41.58202602846673, -75.13599843512378, 149.21818491150051, -33.07909113751523, -48.135307726832835, -4.571349535963152, -16.35177479254254, -74.80524196679667, -271.7977368391828, -178.6723110150625, -152.42031338145938, -97.5786904033954, -1.818146377267457, -81.0979165358943, -6.749129571669608, -10.303277811065099, -79.17264925572005, -127.79737728908806, 1.08704884032179, -0.39331003839404466, -25.25737878054415, -11.178351937767976, -151.52016723323197, -99.362936142304, -13.322044782954523, -3.5505046132804923, -114.8165911504289, -178.8554190802455, -104.06539899338095, 162.602150260372, 178.8828833522676, 2.0000000000000013, -81.46987138912348, 44.65241609157467, -27.6957766883481, 178.2514142068883, 129.4190827918702, -12.908334078316607, -49.29852294424445, -1.3750736253228497, 163.33064201360182, -5.304789479818886, -128.65727007731203, -30.1026785209697, -22.287587296814156, -51.597624175376886, -12.16161628969007, 144.5152980987985, -23.169682411084416, 179.0167820581746, -124.70577281734722, -129.48969190544886, 165.36758859165934, -10.56138273011682, -67.90169726383138, -113.77457892050221, -19.867602312557214, 2.0000000000000013, 2.0000000000000013, -5.814498406408091, -38.3591435526389, -145.02568712110445, -163.171014389629, -90.44220268612962, -26.957806416636398, 38.289064097312924, -100.34134679590446, 0.9519411483134762, -7.318071881308816, -2.357656549094269, 142.45268819597334, -43.947151871532164, -38.73270668622645, 189.88718802684642, -71.01428448430237, -78.60213872015753, 47.55020364293022, -256.01237069924395, -4.705970980507768, -18.471096518645837, -3.183558076854016, 1.0642804903561263, 1.1267331698296112, 8.861861521648855, -94.45857860938125, -4.489392798071494, -9.954943430973321, 165.46646968214327, 137.30486310253852, 2.0000000000000013, 146.8674147781877, -95.87634724752805, -4.935849865834518, -6.561613841634237, -31.56965885007113, -62.232763214644756, 1.0862704714032112, 180.5266742019099, -9.554479919797226, -198.71289392320037, 1.1001506572962505, -22.179051566826402, -48.542821864624386, 196.97257175807573, -24.181106498064104, 175.40277332404236, -25.942416027812023, 185.68086501800397, -4.317597294979592, -25.83061632873322, -0.18129045575268998, 182.47699529793508, -21.70064751618861, -7.825945186756432, 90.51187982514479, 0.8644912906281085, -2.8195030531947447, -7.002005339847983, -24.493802068222653, -9.134184156854825, 160.4, 2.0000000000000013, 0.2935885616020559, -34.759862915164526, -19.826312953381933, 2.0000000000000013, -91.21845126674543, -90.70167900672857, 189.4609036321562, -157.853217194305, -62.36232957038701, -86.64014517539842, -5.801138407551441, -22.910274615674776, -28.489778522176792, 93.66290437084324, -96.07057322340326, -3.6424754930301084, -12.078331859275522, 0.5557809563656068, -16.03140504412586, -16.53350492891106, -103.89937615608628, -68.04100028426436, -50.882458137484264, -3.207638449787634, -7.230539963854197, -109.63572101568188, 144.92908700692823, -8.23698034115056, -19.77019589618217, -1.806439214632543, 2.0000000000000013, -38.83489927372846], "policy_predator_policy_reward": [20.56598325406952, 13.92890662244055, 9.186891101749557, 121.87892839894083, 90.71455392124487, 82.19315628154482, 3.4923857977299546, 6.191111130129579, 197.66554312112495, 104.93215029897125, 122.55605164759079, 59.77342932194675, 79.13914843994357, 0.0, 12.15977990678019, 231.25022976050795, 31.845335743737245, 98.68345919785257, 101.41006386062587, 154.73341675532788, 420.84308534551604, 590.0056553995885, 16.22401728834798, 46.021768005562905, 16.936158313456264, 5.410078202127837, 169.6355570124942, 235.3918444316489, 77.62334717615927, 275.1218307919131, 46.229646505052074, 44.132533565308655, 34.324312410082804, 1.2479973648366542, 5.357830882686244, 4.657557327535052, 86.75811546391192, 47.443441912801305, 29.04330089715001, 145.77811774260786, 13.956209295688542, 40.616670012342034, 19.11168029813097, 80.92183780820423, 10.413691219476227, 195.8121762017603, 107.39258845280092, 12.929993060435226, 42.046409302482175, 21.77661143142941, 49.945307726832475, 6.52134953596311, 18.28177479254284, 76.2852419667971, 2.2918701134723998, 329.3843489882005, 29.94856715283956, 211.5859430758491, 3.7881463772674193, 82.57791653589466, 8.679129571669566, 12.233277811065058, 128.54711125111973, 103.13650758022627, 0.9029511596782114, 14.153310038394043, 27.117378780544442, 13.078351937767941, 40.05552285441988, 177.9931498135697, 15.222044782954482, 4.275831187353844, 242.45971512372824, 22.208068095877714, 115.38547438413671, 6.407735859434467, 16.127116647732386, 0.0, 91.03987138912427, 25.57758390842552, 32.73499505672016, 8.639367424739927, 17.99091720812984, 14.778334078316567, 42.50403761404087, 24.556795623527428, 20.699357986398173, 7.244789479818845, 125.19361833803876, 99.65016025810141, 24.087587296814437, 83.0476241753766, 14.031616289690033, 13.814701901201488, 24.959682411084696, 9.023217941825402, 180.50226727011767, 0.7955579130742962, 4.8924114083405295, 12.46138273011678, 135.56433603216396, 23.22127985177416, 21.6976023125575, 0.0, 0.0, 7.744498406408051, 107.92118831053727, 78.63364236320469, 199.20496491168322, 3.9062663693190895, 28.81780641663669, 119.75093590268708, 93.96557808926869, 9.093827558323138, 9.248071881308775, 4.327656549094227, 29.547311804026677, 45.577151871531846, 35.52207533567582, 27.105639036876905, 132.9953543508311, 0.9076071488714543, 228.8660723145343, 197.68303330229065, 6.645970980507727, 21.34109651864613, 5.133558076853975, 0.9257195096438752, 0.86326683017039, 2.0281384783511047, 92.69629901913653, 20.114246311028484, 11.91494343097328, 18.54353031785671, 3.009576027540888, 38.68556086992059, 32.142585221812276, 97.41634724752878, 6.8858498658344764, 8.481613841634196, 25.731638109551653, 68.0278258320533, 0.9037295285967901, 9.493325798090078, 123.08817263602494, 189.82758503582997, 0.8898493427037508, 23.94905156682666, 32.593990590708295, 32.4462595158401, 26.031106498064393, 9.657226675957665, 27.7224160278123, 6.3491349819960226, 29.472300419053788, 16.32963131552677, 2.161290455752688, 10.52300470206492, 23.651896800281463, 1.5290780418169603, 10.245801362566786, 64.31998618943838, 4.789503053194703, 8.932005339847942, 26.31380206822294, 11.044184156854785, 0.0, 0.0, 1.6864114383979456, 36.53986291516417, 21.73631295338223, 0.0, 92.87845126674628, 92.25167900672936, 5.539096367843813, 159.14321719430382, 100.9285256453294, 50.025915111706446, 8.646354569498946, 24.740274615675062, 98.77687415133391, 59.52700692918097, 104.46057322340397, 35.35690596903345, 13.978331859275482, 1.4342190436343947, 18.369602344220734, 24.048264650102418, 88.81649673546748, 98.00434345272352, 52.532458137483935, 5.1576384497875924, 9.170539963854155, 111.15572101568266, 34.0909129930718, 10.146980341150517, 21.680195896182468, 3.7764392146325054, 0.0, 40.6348992737281]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8154693487426112, "mean_inference_ms": 2.4826333187604304, "mean_action_processing_ms": 0.3680159719171936, "mean_env_wait_ms": 0.28598810051589824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013415336608886719, "StateBufferConnector_ms": 0.003877997398376465, "ViewRequirementAgentConnector_ms": 0.14151668548583984}, "num_episodes": 18, "episode_return_max": 335.46091321139255, "episode_return_min": -118.79382875257168, "episode_return_mean": 67.68026991757353, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 263.565606992717, "num_env_steps_trained_throughput_per_sec": 263.565606992717, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 15447.418, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15447.364, "sample_time_ms": 1931.198, "learn_time_ms": 13490.859, "learn_throughput": 296.497, "synch_weights_time_ms": 22.121}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 31, "trial_id": "61e09_00000", "date": "2024-08-16_16-14-27", "timestamp": 1723805067, "time_this_iter_s": 15.21903109550476, "time_total_s": 469.14306902885437, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24be1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 469.14306902885437, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 62.32857142857142, "ram_util_percent": 82.15238095238095}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2633323842886264, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.1314046568971463, "policy_loss": -0.013117776245430663, "vf_loss": 2.1425203773079726, "vf_explained_var": 0.03611530677351371, "kl": 0.010010281433480568, "entropy": 0.7507130948324052, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.217658884878512, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.3490405032243675, "policy_loss": -0.007856303673956996, "vf_loss": 5.354142706482499, "vf_explained_var": 0.6470331557844051, "kl": 0.013770482894343405, "entropy": 1.303057797812911, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 365.28, "episode_reward_min": -118.79382875257168, "episode_reward_mean": 81.06554989738406, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -271.7977368391828, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.97257175807573, "predator_policy": 329.3843489882005}, "policy_reward_mean": {"prey_policy": -7.963508445063881, "predator_policy": 48.49628339375596}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-118.79382875257168, -8.464493556166184, 3.449999999999969, 3.8599999999999612, 24.713592286538773, 15.749999999999922, 3.759999999999963, -32.83443070754633, 2.625326574073381, -29.004227011068664, 180.32996151056128, 197.00999999999965, 79.8, 191.9299999999997, 149.2800000000001, 16.387236668001364, 185.96999999999974, 66.08382999786018, 33.25000000000003, 160.2, 189.82999999999973, -72.89763953960203, 172.15999999999957, -22.890660300395965, 3.8299999999999628, 3.92999999999996, 3.169999999999978, -50.50198579475633, 159.89999999999998, 3.6699999999999635, 3.8999999999999604, 173.62999999999988, 213.78219571317257, -15.71346170475846, 218.08693856051178, 4.809999999999941, 3.93999999999996, 12.879999999999914, 13.862573922711384, 185.96999999999974, 180.99999999999977, 180.54999999999978, 3.869999999999962, -0.04295812311041314, 192.0099999999997, 104.64838382885874, 3.7599999999999643, 213.46999999999952, 186.90999999999985, 193.80999999999966, 15.653718110867448, 194.97999999999968, -4.345617860846943, 165.94215866777827, 3.899999999999961, 3.729999999999964, 162.39999999999998, 3.7599999999999634, 3.90999999999996, 3.2099999999999755, 196.28999999999968, 1.9519660112501078, 4.675216161947491, 223.47700692918053, 40.104430476002825, 3.889999999999961, 9.852957021285556, 14.880463747839986, 3.5999999999999677, 3.4599999999999698, 180.9299999999998, 3.87999999999996, 3.7999999999999625, 174.55975599549515, 185.58999999999975, -15.391355432482403, 3.0099999999999785, 183.4299999999996, 181.9699999999998, 187.0799999999997, 300.05525915725934, 187.94009980615778, 365.28, 3.7199999999999656, 193.93999999999966, 73.25067320798043, 119.11699682142574, 3.629999999999966, -5.71016027578548, 5.024716741439585, -25.077433568756486, -50.967261327156564, 133.03000000000026, 170.94999999999993, 364.40975576327594, 28.885290011940988, 3.619999999999965, 175.94999999999982, 3.1899999999999755, 321.5], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-271.7977368391828, -178.6723110150625, -152.42031338145938, -97.5786904033954, -1.818146377267457, -81.0979165358943, -6.749129571669608, -10.303277811065099, -79.17264925572005, -127.79737728908806, 1.08704884032179, -0.39331003839404466, -25.25737878054415, -11.178351937767976, -151.52016723323197, -99.362936142304, -13.322044782954523, -3.5505046132804923, -114.8165911504289, -178.8554190802455, -104.06539899338095, 162.602150260372, 178.8828833522676, 2.0000000000000013, -81.46987138912348, 44.65241609157467, -27.6957766883481, 178.2514142068883, 129.4190827918702, -12.908334078316607, -49.29852294424445, -1.3750736253228497, 163.33064201360182, -5.304789479818886, -128.65727007731203, -30.1026785209697, -22.287587296814156, -51.597624175376886, -12.16161628969007, 144.5152980987985, -23.169682411084416, 179.0167820581746, -124.70577281734722, -129.48969190544886, 165.36758859165934, -10.56138273011682, -67.90169726383138, -113.77457892050221, -19.867602312557214, 2.0000000000000013, 2.0000000000000013, -5.814498406408091, -38.3591435526389, -145.02568712110445, -163.171014389629, -90.44220268612962, -26.957806416636398, 38.289064097312924, -100.34134679590446, 0.9519411483134762, -7.318071881308816, -2.357656549094269, 142.45268819597334, -43.947151871532164, -38.73270668622645, 189.88718802684642, -71.01428448430237, -78.60213872015753, 47.55020364293022, -256.01237069924395, -4.705970980507768, -18.471096518645837, -3.183558076854016, 1.0642804903561263, 1.1267331698296112, 8.861861521648855, -94.45857860938125, -4.489392798071494, -9.954943430973321, 165.46646968214327, 137.30486310253852, 2.0000000000000013, 146.8674147781877, -95.87634724752805, -4.935849865834518, -6.561613841634237, -31.56965885007113, -62.232763214644756, 1.0862704714032112, 180.5266742019099, -9.554479919797226, -198.71289392320037, 1.1001506572962505, -22.179051566826402, -48.542821864624386, 196.97257175807573, -24.181106498064104, 175.40277332404236, -25.942416027812023, 185.68086501800397, -4.317597294979592, -25.83061632873322, -0.18129045575268998, 182.47699529793508, -21.70064751618861, -7.825945186756432, 90.51187982514479, 0.8644912906281085, -2.8195030531947447, -7.002005339847983, -24.493802068222653, -9.134184156854825, 160.4, 2.0000000000000013, 0.2935885616020559, -34.759862915164526, -19.826312953381933, 2.0000000000000013, -91.21845126674543, -90.70167900672857, 189.4609036321562, -157.853217194305, -62.36232957038701, -86.64014517539842, -5.801138407551441, -22.910274615674776, -28.489778522176792, 93.66290437084324, -96.07057322340326, -3.6424754930301084, -12.078331859275522, 0.5557809563656068, -16.03140504412586, -16.53350492891106, -103.89937615608628, -68.04100028426436, -50.882458137484264, -3.207638449787634, -7.230539963854197, -109.63572101568188, 144.92908700692823, -8.23698034115056, -19.77019589618217, -1.806439214632543, 2.0000000000000013, -38.83489927372846, -6.049445001317277, 106.04877259227403, 176.3115350410742, -84.80186933643752, -136.58168402110877, -76.06833071231758, -114.76070632761612, -45.662012715154994, -127.36615627316003, 173.38146182134557, -2.7693250868740087, 145.72234275541825, -12.555059673811733, 183.79447010271798, 100.97556649513557, 69.99261823285721, 29.379257066965565, -56.85408197002508, 181.00702459110485, 173.26999999999998, -9.422774934738879, -24.86386354491622, 188.99281973131758, -31.093732106938422, -191.84344738002338, -55.63869733872833, -45.051473503294424, 73.99856037365826, -28.2545191380116, -20.105609881911203, -132.2296038735145, -110.36701160031599, -12.676712476022754, -36.068964400750744, -47.162003156883365, -71.58938929115402, -119.75738267863282, -219.90458857724036, -15.15945609682271, 33.418452328515954, -7.855574943220944, 54.605921763611704, 142.09558361195994, 169.28443207982545, -0.954941464626206, -81.75185350951325, -5.238883664638948, -85.47842601190958, 87.1394916061805, -20.602171556178437, -105.22910718978447, -16.807894808070895, 139.62649842711085, 107.43545404086427], "policy_predator_policy_reward": [2.2918701134723998, 329.3843489882005, 29.94856715283956, 211.5859430758491, 3.7881463772674193, 82.57791653589466, 8.679129571669566, 12.233277811065058, 128.54711125111973, 103.13650758022627, 0.9029511596782114, 14.153310038394043, 27.117378780544442, 13.078351937767941, 40.05552285441988, 177.9931498135697, 15.222044782954482, 4.275831187353844, 242.45971512372824, 22.208068095877714, 115.38547438413671, 6.407735859434467, 16.127116647732386, 0.0, 91.03987138912427, 25.57758390842552, 32.73499505672016, 8.639367424739927, 17.99091720812984, 14.778334078316567, 42.50403761404087, 24.556795623527428, 20.699357986398173, 7.244789479818845, 125.19361833803876, 99.65016025810141, 24.087587296814437, 83.0476241753766, 14.031616289690033, 13.814701901201488, 24.959682411084696, 9.023217941825402, 180.50226727011767, 0.7955579130742962, 4.8924114083405295, 12.46138273011678, 135.56433603216396, 23.22127985177416, 21.6976023125575, 0.0, 0.0, 7.744498406408051, 107.92118831053727, 78.63364236320469, 199.20496491168322, 3.9062663693190895, 28.81780641663669, 119.75093590268708, 93.96557808926869, 9.093827558323138, 9.248071881308775, 4.327656549094227, 29.547311804026677, 45.577151871531846, 35.52207533567582, 27.105639036876905, 132.9953543508311, 0.9076071488714543, 228.8660723145343, 197.68303330229065, 6.645970980507727, 21.34109651864613, 5.133558076853975, 0.9257195096438752, 0.86326683017039, 2.0281384783511047, 92.69629901913653, 20.114246311028484, 11.91494343097328, 18.54353031785671, 3.009576027540888, 38.68556086992059, 32.142585221812276, 97.41634724752878, 6.8858498658344764, 8.481613841634196, 25.731638109551653, 68.0278258320533, 0.9037295285967901, 9.493325798090078, 123.08817263602494, 189.82758503582997, 0.8898493427037508, 23.94905156682666, 32.593990590708295, 32.4462595158401, 26.031106498064393, 9.657226675957665, 27.7224160278123, 6.3491349819960226, 29.472300419053788, 16.32963131552677, 2.161290455752688, 10.52300470206492, 23.651896800281463, 1.5290780418169603, 10.245801362566786, 64.31998618943838, 4.789503053194703, 8.932005339847942, 26.31380206822294, 11.044184156854785, 0.0, 0.0, 1.6864114383979456, 36.53986291516417, 21.73631295338223, 0.0, 92.87845126674628, 92.25167900672936, 5.539096367843813, 159.14321719430382, 100.9285256453294, 50.025915111706446, 8.646354569498946, 24.740274615675062, 98.77687415133391, 59.52700692918097, 104.46057322340397, 35.35690596903345, 13.978331859275482, 1.4342190436343947, 18.369602344220734, 24.048264650102418, 88.81649673546748, 98.00434345272352, 52.532458137483935, 5.1576384497875924, 9.170539963854155, 111.15572101568266, 34.0909129930718, 10.146980341150517, 21.680195896182468, 3.7764392146325054, 0.0, 40.6348992737281, 22.58920099681245, 51.97122740772594, 7.768464958925804, 86.31186933643829, 38.50441081085331, 158.75424849009065, 115.94070632761604, 47.49201271515463, 0.0, 137.41469445181457, 4.729325086873967, 34.28765724458173, 14.495059673811692, 1.345529897281969, 120.86531955676799, 8.221754872498606, 205.84295866537474, 9.571966043842572, 11.002975408895143, 0.0, 11.362774934738837, 26.643863544916492, 3.057180268682403, 32.98373210693837, 171.45290606661538, 149.27991186011434, 44.42822014401832, 45.74168980704291, 49.85254994072258, 2.137579079200629, 60.96297432596246, 175.92348087208245, 15.911429217462365, 37.85896440075039, 64.51032985212132, 29.163629027159597, 236.7464270997417, 51.948282828974584, 113.78775544684933, 0.9832483214575445, 9.785574943220903, 114.41407823638829, 32.14919972326118, 20.880540348229324, 71.3255723849714, 40.26651260110936, 7.188883664638906, 87.14842601191043, 86.87050839381949, 22.54217155617874, 6.559651740802902, 118.667350257053, 6.84350157288914, 67.59454595913574]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8120380083773382, "mean_inference_ms": 2.4809616695896333, "mean_action_processing_ms": 0.365149229049339, "mean_env_wait_ms": 0.28390714196437516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048596858978271484, "StateBufferConnector_ms": 0.0033986568450927734, "ViewRequirementAgentConnector_ms": 0.10315561294555664}, "num_episodes": 27, "episode_return_max": 365.28, "episode_return_min": -118.79382875257168, "episode_return_mean": 81.06554989738406, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 252.90045288300016, "num_env_steps_trained_throughput_per_sec": 252.90045288300016, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 15509.161, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15509.106, "sample_time_ms": 1928.195, "learn_time_ms": 13554.605, "learn_throughput": 295.103, "synch_weights_time_ms": 23.22}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 32, "trial_id": "61e09_00000", "date": "2024-08-16_16-14-43", "timestamp": 1723805083, "time_this_iter_s": 15.845830917358398, "time_total_s": 484.98889994621277, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24acee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 484.98889994621277, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 60.28695652173913, "ram_util_percent": 81.75217391304349}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.075835682522683, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 1.782675401117436, "policy_loss": -0.011215091224700685, "vf_loss": 1.7920710862944367, "vf_explained_var": 0.010967070526546902, "kl": 0.009097035221936287, "entropy": 0.6474498460217127, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5712834691244457, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.8817802406492685, "policy_loss": -0.012568176415054097, "vf_loss": 5.891184520721436, "vf_explained_var": 0.568862455799466, "kl": 0.015819520971131276, "entropy": 1.2800039782725945, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 381.06, "episode_reward_min": -72.89763953960203, "episode_reward_mean": 103.83173244625785, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -256.01237069924395, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.97257175807573, "predator_policy": 362.00597760745256}, "policy_reward_mean": {"prey_policy": 5.149875217700949, "predator_policy": 46.76599100542802}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.25000000000003, 160.2, 189.82999999999973, -72.89763953960203, 172.15999999999957, -22.890660300395965, 3.8299999999999628, 3.92999999999996, 3.169999999999978, -50.50198579475633, 159.89999999999998, 3.6699999999999635, 3.8999999999999604, 173.62999999999988, 213.78219571317257, -15.71346170475846, 218.08693856051178, 4.809999999999941, 3.93999999999996, 12.879999999999914, 13.862573922711384, 185.96999999999974, 180.99999999999977, 180.54999999999978, 3.869999999999962, -0.04295812311041314, 192.0099999999997, 104.64838382885874, 3.7599999999999643, 213.46999999999952, 186.90999999999985, 193.80999999999966, 15.653718110867448, 194.97999999999968, -4.345617860846943, 165.94215866777827, 3.899999999999961, 3.729999999999964, 162.39999999999998, 3.7599999999999634, 3.90999999999996, 3.2099999999999755, 196.28999999999968, 1.9519660112501078, 4.675216161947491, 223.47700692918053, 40.104430476002825, 3.889999999999961, 9.852957021285556, 14.880463747839986, 3.5999999999999677, 3.4599999999999698, 180.9299999999998, 3.87999999999996, 3.7999999999999625, 174.55975599549515, 185.58999999999975, -15.391355432482403, 3.0099999999999785, 183.4299999999996, 181.9699999999998, 187.0799999999997, 300.05525915725934, 187.94009980615778, 365.28, 3.7199999999999656, 193.93999999999966, 73.25067320798043, 119.11699682142574, 3.629999999999966, -5.71016027578548, 5.024716741439585, -25.077433568756486, -50.967261327156564, 133.03000000000026, 170.94999999999993, 364.40975576327594, 28.885290011940988, 3.619999999999965, 175.94999999999982, 3.1899999999999755, 321.5, 3.5599999999999685, 161.96003344633388, 176.60999999999984, 186.25999999999965, 153.85000000000008, 4.799999999999941, 219.3499999999999, 2.50999999999999, 346.48999999999995, 108.99000000000017, 244.44813561705257, 381.06, 3.5899999999999666, 379.13, 143.63844340633761, 168.27999999999986, 330.3246094273364, 193.6199999999996], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-22.287587296814156, -51.597624175376886, -12.16161628969007, 144.5152980987985, -23.169682411084416, 179.0167820581746, -124.70577281734722, -129.48969190544886, 165.36758859165934, -10.56138273011682, -67.90169726383138, -113.77457892050221, -19.867602312557214, 2.0000000000000013, 2.0000000000000013, -5.814498406408091, -38.3591435526389, -145.02568712110445, -163.171014389629, -90.44220268612962, -26.957806416636398, 38.289064097312924, -100.34134679590446, 0.9519411483134762, -7.318071881308816, -2.357656549094269, 142.45268819597334, -43.947151871532164, -38.73270668622645, 189.88718802684642, -71.01428448430237, -78.60213872015753, 47.55020364293022, -256.01237069924395, -4.705970980507768, -18.471096518645837, -3.183558076854016, 1.0642804903561263, 1.1267331698296112, 8.861861521648855, -94.45857860938125, -4.489392798071494, -9.954943430973321, 165.46646968214327, 137.30486310253852, 2.0000000000000013, 146.8674147781877, -95.87634724752805, -4.935849865834518, -6.561613841634237, -31.56965885007113, -62.232763214644756, 1.0862704714032112, 180.5266742019099, -9.554479919797226, -198.71289392320037, 1.1001506572962505, -22.179051566826402, -48.542821864624386, 196.97257175807573, -24.181106498064104, 175.40277332404236, -25.942416027812023, 185.68086501800397, -4.317597294979592, -25.83061632873322, -0.18129045575268998, 182.47699529793508, -21.70064751618861, -7.825945186756432, 90.51187982514479, 0.8644912906281085, -2.8195030531947447, -7.002005339847983, -24.493802068222653, -9.134184156854825, 160.4, 2.0000000000000013, 0.2935885616020559, -34.759862915164526, -19.826312953381933, 2.0000000000000013, -91.21845126674543, -90.70167900672857, 189.4609036321562, -157.853217194305, -62.36232957038701, -86.64014517539842, -5.801138407551441, -22.910274615674776, -28.489778522176792, 93.66290437084324, -96.07057322340326, -3.6424754930301084, -12.078331859275522, 0.5557809563656068, -16.03140504412586, -16.53350492891106, -103.89937615608628, -68.04100028426436, -50.882458137484264, -3.207638449787634, -7.230539963854197, -109.63572101568188, 144.92908700692823, -8.23698034115056, -19.77019589618217, -1.806439214632543, 2.0000000000000013, -38.83489927372846, -6.049445001317277, 106.04877259227403, 176.3115350410742, -84.80186933643752, -136.58168402110877, -76.06833071231758, -114.76070632761612, -45.662012715154994, -127.36615627316003, 173.38146182134557, -2.7693250868740087, 145.72234275541825, -12.555059673811733, 183.79447010271798, 100.97556649513557, 69.99261823285721, 29.379257066965565, -56.85408197002508, 181.00702459110485, 173.26999999999998, -9.422774934738879, -24.86386354491622, 188.99281973131758, -31.093732106938422, -191.84344738002338, -55.63869733872833, -45.051473503294424, 73.99856037365826, -28.2545191380116, -20.105609881911203, -132.2296038735145, -110.36701160031599, -12.676712476022754, -36.068964400750744, -47.162003156883365, -71.58938929115402, -119.75738267863282, -219.90458857724036, -15.15945609682271, 33.418452328515954, -7.855574943220944, 54.605921763611704, 142.09558361195994, 169.28443207982545, -0.954941464626206, -81.75185350951325, -5.238883664638948, -85.47842601190958, 87.1394916061805, -20.602171556178437, -105.22910718978447, -16.807894808070895, 139.62649842711085, 107.43545404086427, -55.85617139682218, 2.0000000000000013, -8.505276662274696, 100.83332351078171, -60.081631312852366, 73.66714944331345, 181.64489414513798, -127.83839516726495, -41.97095926542745, 85.03197147111825, 1.9791360292648008, -31.037220800367646, -28.58691986864146, 181.5281438103825, -69.35861612300117, -194.86411696336998, 191.06850982503005, 150.29104223581325, -255.00597760745256, 0.676408973432448, 142.07146452236236, -60.46992913334461, 188.53740115248777, 177.04663305841274, -0.45363322660379723, -66.05271198911905, 189.09758263612989, 173.8752602932214, -47.26138401628319, 109.51315200799183, 162.86088259114376, -1.501698497437486, 149.46623359136362, 114.90469806598044, 190.17351798542768, -81.06236124446417], "policy_predator_policy_reward": [24.087587296814437, 83.0476241753766, 14.031616289690033, 13.814701901201488, 24.959682411084696, 9.023217941825402, 180.50226727011767, 0.7955579130742962, 4.8924114083405295, 12.46138273011678, 135.56433603216396, 23.22127985177416, 21.6976023125575, 0.0, 0.0, 7.744498406408051, 107.92118831053727, 78.63364236320469, 199.20496491168322, 3.9062663693190895, 28.81780641663669, 119.75093590268708, 93.96557808926869, 9.093827558323138, 9.248071881308775, 4.327656549094227, 29.547311804026677, 45.577151871531846, 35.52207533567582, 27.105639036876905, 132.9953543508311, 0.9076071488714543, 228.8660723145343, 197.68303330229065, 6.645970980507727, 21.34109651864613, 5.133558076853975, 0.9257195096438752, 0.86326683017039, 2.0281384783511047, 92.69629901913653, 20.114246311028484, 11.91494343097328, 18.54353031785671, 3.009576027540888, 38.68556086992059, 32.142585221812276, 97.41634724752878, 6.8858498658344764, 8.481613841634196, 25.731638109551653, 68.0278258320533, 0.9037295285967901, 9.493325798090078, 123.08817263602494, 189.82758503582997, 0.8898493427037508, 23.94905156682666, 32.593990590708295, 32.4462595158401, 26.031106498064393, 9.657226675957665, 27.7224160278123, 6.3491349819960226, 29.472300419053788, 16.32963131552677, 2.161290455752688, 10.52300470206492, 23.651896800281463, 1.5290780418169603, 10.245801362566786, 64.31998618943838, 4.789503053194703, 8.932005339847942, 26.31380206822294, 11.044184156854785, 0.0, 0.0, 1.6864114383979456, 36.53986291516417, 21.73631295338223, 0.0, 92.87845126674628, 92.25167900672936, 5.539096367843813, 159.14321719430382, 100.9285256453294, 50.025915111706446, 8.646354569498946, 24.740274615675062, 98.77687415133391, 59.52700692918097, 104.46057322340397, 35.35690596903345, 13.978331859275482, 1.4342190436343947, 18.369602344220734, 24.048264650102418, 88.81649673546748, 98.00434345272352, 52.532458137483935, 5.1576384497875924, 9.170539963854155, 111.15572101568266, 34.0909129930718, 10.146980341150517, 21.680195896182468, 3.7764392146325054, 0.0, 40.6348992737281, 22.58920099681245, 51.97122740772594, 7.768464958925804, 86.31186933643829, 38.50441081085331, 158.75424849009065, 115.94070632761604, 47.49201271515463, 0.0, 137.41469445181457, 4.729325086873967, 34.28765724458173, 14.495059673811692, 1.345529897281969, 120.86531955676799, 8.221754872498606, 205.84295866537474, 9.571966043842572, 11.002975408895143, 0.0, 11.362774934738837, 26.643863544916492, 3.057180268682403, 32.98373210693837, 171.45290606661538, 149.27991186011434, 44.42822014401832, 45.74168980704291, 49.85254994072258, 2.137579079200629, 60.96297432596246, 175.92348087208245, 15.911429217462365, 37.85896440075039, 64.51032985212132, 29.163629027159597, 236.7464270997417, 51.948282828974584, 113.78775544684933, 0.9832483214575445, 9.785574943220903, 114.41407823638829, 32.14919972326118, 20.880540348229324, 71.3255723849714, 40.26651260110936, 7.188883664638906, 87.14842601191043, 86.87050839381949, 22.54217155617874, 6.559651740802902, 118.667350257053, 6.84350157288914, 67.59454595913574, 57.416171396821866, 0.0, 34.82892934602763, 34.80305725179925, 61.691631312852095, 101.33285055668655, 3.4751058548620235, 128.9783951672643, 44.7709592654271, 66.01802852888176, 1.0008639707352007, 32.85722080036763, 57.88691986864123, 8.52185618961748, 103.50080785434433, 163.23192523202687, 2.9614901749699447, 2.168957764186753, 362.00597760745256, 1.3135910265675534, 83.91510554236518, 78.93149468567044, 4.502598847512234, 10.973366941587248, 2.4236332266037905, 67.67271198911988, 7.902417363870118, 8.254739706778622, 43.76133446986101, 37.62534094476757, 3.44911740885622, 3.471698497437455, 23.907848564372248, 42.04582920562007, 1.8864820145723225, 82.62236124446497]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8088279334315475, "mean_inference_ms": 2.4734361008936943, "mean_action_processing_ms": 0.3631141475569693, "mean_env_wait_ms": 0.28272213388143497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004248499870300293, "StateBufferConnector_ms": 0.003345012664794922, "ViewRequirementAgentConnector_ms": 0.10127913951873779}, "num_episodes": 18, "episode_return_max": 381.06, "episode_return_min": -72.89763953960203, "episode_return_mean": 103.83173244625785, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.0470449918788, "num_env_steps_trained_throughput_per_sec": 274.0470449918788, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 15431.937, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15431.884, "sample_time_ms": 1923.258, "learn_time_ms": 13482.536, "learn_throughput": 296.68, "synch_weights_time_ms": 23.124}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 33, "trial_id": "61e09_00000", "date": "2024-08-16_16-14-58", "timestamp": 1723805098, "time_this_iter_s": 14.632795810699463, "time_total_s": 499.62169575691223, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30000b9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 499.62169575691223, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 61.97142857142857, "ram_util_percent": 81.44285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2015211728199449, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 1.3740171576933886, "policy_loss": -0.009510213780714564, "vf_loss": 1.3826404678127753, "vf_explained_var": 0.02364549860752449, "kl": 0.004434540909550422, "entropy": 0.6965895853660725, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.794674711599552, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.531111682155145, "policy_loss": -0.010919935974691595, "vf_loss": 4.539858637158833, "vf_explained_var": 0.7099618284790604, "kl": 0.010864936082906052, "entropy": 1.233651211274364, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 381.06, "episode_reward_min": -50.967261327156564, "episode_reward_mean": 116.7410661032368, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -259.7437126099718, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 362.00597760745256}, "policy_reward_mean": {"prey_policy": 12.744898030210022, "predator_policy": 45.625635021408414}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.93999999999996, 12.879999999999914, 13.862573922711384, 185.96999999999974, 180.99999999999977, 180.54999999999978, 3.869999999999962, -0.04295812311041314, 192.0099999999997, 104.64838382885874, 3.7599999999999643, 213.46999999999952, 186.90999999999985, 193.80999999999966, 15.653718110867448, 194.97999999999968, -4.345617860846943, 165.94215866777827, 3.899999999999961, 3.729999999999964, 162.39999999999998, 3.7599999999999634, 3.90999999999996, 3.2099999999999755, 196.28999999999968, 1.9519660112501078, 4.675216161947491, 223.47700692918053, 40.104430476002825, 3.889999999999961, 9.852957021285556, 14.880463747839986, 3.5999999999999677, 3.4599999999999698, 180.9299999999998, 3.87999999999996, 3.7999999999999625, 174.55975599549515, 185.58999999999975, -15.391355432482403, 3.0099999999999785, 183.4299999999996, 181.9699999999998, 187.0799999999997, 300.05525915725934, 187.94009980615778, 365.28, 3.7199999999999656, 193.93999999999966, 73.25067320798043, 119.11699682142574, 3.629999999999966, -5.71016027578548, 5.024716741439585, -25.077433568756486, -50.967261327156564, 133.03000000000026, 170.94999999999993, 364.40975576327594, 28.885290011940988, 3.619999999999965, 175.94999999999982, 3.1899999999999755, 321.5, 3.5599999999999685, 161.96003344633388, 176.60999999999984, 186.25999999999965, 153.85000000000008, 4.799999999999941, 219.3499999999999, 2.50999999999999, 346.48999999999995, 108.99000000000017, 244.44813561705257, 381.06, 3.5899999999999666, 379.13, 143.63844340633761, 168.27999999999986, 330.3246094273364, 193.6199999999996, 4.0227663972578425, 267.12, 149.23655233629205, 3.8399999999999626, 2.020000000000002, 129.78846885804344, 201.53999999999962, 1.8207479486966316, 200.63999999999965, 117.65005726227909, 3.8399999999999617, 171.8209265121689, 164.62837346457525, 3.9399999999999595, 363.5408598527534, 190.32999999999993, 153.77000000000012, 343.53], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-3.183558076854016, 1.0642804903561263, 1.1267331698296112, 8.861861521648855, -94.45857860938125, -4.489392798071494, -9.954943430973321, 165.46646968214327, 137.30486310253852, 2.0000000000000013, 146.8674147781877, -95.87634724752805, -4.935849865834518, -6.561613841634237, -31.56965885007113, -62.232763214644756, 1.0862704714032112, 180.5266742019099, -9.554479919797226, -198.71289392320037, 1.1001506572962505, -22.179051566826402, -48.542821864624386, 196.97257175807573, -24.181106498064104, 175.40277332404236, -25.942416027812023, 185.68086501800397, -4.317597294979592, -25.83061632873322, -0.18129045575268998, 182.47699529793508, -21.70064751618861, -7.825945186756432, 90.51187982514479, 0.8644912906281085, -2.8195030531947447, -7.002005339847983, -24.493802068222653, -9.134184156854825, 160.4, 2.0000000000000013, 0.2935885616020559, -34.759862915164526, -19.826312953381933, 2.0000000000000013, -91.21845126674543, -90.70167900672857, 189.4609036321562, -157.853217194305, -62.36232957038701, -86.64014517539842, -5.801138407551441, -22.910274615674776, -28.489778522176792, 93.66290437084324, -96.07057322340326, -3.6424754930301084, -12.078331859275522, 0.5557809563656068, -16.03140504412586, -16.53350492891106, -103.89937615608628, -68.04100028426436, -50.882458137484264, -3.207638449787634, -7.230539963854197, -109.63572101568188, 144.92908700692823, -8.23698034115056, -19.77019589618217, -1.806439214632543, 2.0000000000000013, -38.83489927372846, -6.049445001317277, 106.04877259227403, 176.3115350410742, -84.80186933643752, -136.58168402110877, -76.06833071231758, -114.76070632761612, -45.662012715154994, -127.36615627316003, 173.38146182134557, -2.7693250868740087, 145.72234275541825, -12.555059673811733, 183.79447010271798, 100.97556649513557, 69.99261823285721, 29.379257066965565, -56.85408197002508, 181.00702459110485, 173.26999999999998, -9.422774934738879, -24.86386354491622, 188.99281973131758, -31.093732106938422, -191.84344738002338, -55.63869733872833, -45.051473503294424, 73.99856037365826, -28.2545191380116, -20.105609881911203, -132.2296038735145, -110.36701160031599, -12.676712476022754, -36.068964400750744, -47.162003156883365, -71.58938929115402, -119.75738267863282, -219.90458857724036, -15.15945609682271, 33.418452328515954, -7.855574943220944, 54.605921763611704, 142.09558361195994, 169.28443207982545, -0.954941464626206, -81.75185350951325, -5.238883664638948, -85.47842601190958, 87.1394916061805, -20.602171556178437, -105.22910718978447, -16.807894808070895, 139.62649842711085, 107.43545404086427, -55.85617139682218, 2.0000000000000013, -8.505276662274696, 100.83332351078171, -60.081631312852366, 73.66714944331345, 181.64489414513798, -127.83839516726495, -41.97095926542745, 85.03197147111825, 1.9791360292648008, -31.037220800367646, -28.58691986864146, 181.5281438103825, -69.35861612300117, -194.86411696336998, 191.06850982503005, 150.29104223581325, -255.00597760745256, 0.676408973432448, 142.07146452236236, -60.46992913334461, 188.53740115248777, 177.04663305841274, -0.45363322660379723, -66.05271198911905, 189.09758263612989, 173.8752602932214, -47.26138401628319, 109.51315200799183, 162.86088259114376, -1.501698497437486, 149.46623359136362, 114.90469806598044, 190.17351798542768, -81.06236124446417, -163.55964162301734, -0.399595362455506, 112.15199966848682, 106.94625397336354, 73.0244065379589, 1.0980125525363875, 1.1242854594721043, -15.872466775498088, -91.35130516168256, -259.7437126099718, -57.50097084307404, -31.857607641637443, -102.62981859926307, 200.0, -1.0826466551414442, -0.14925205130336971, 199.01, -47.22070018171472, 42.11767651710613, -7.937932371725973, 2.0000000000000013, -33.977212260445974, -35.87284552754942, 127.05924086463544, -2.8713786656654126, -9.729323009872417, -3.0194677125491376, -2.608259645456938, 194.7086019276528, 165.51133657604387, -102.04740781015197, 178.45789510158068, -125.82621243244861, 116.99244891517694, 177.59004025153286, 161.71049107466325], "policy_predator_policy_reward": [5.133558076853975, 0.9257195096438752, 0.86326683017039, 2.0281384783511047, 92.69629901913653, 20.114246311028484, 11.91494343097328, 18.54353031785671, 3.009576027540888, 38.68556086992059, 32.142585221812276, 97.41634724752878, 6.8858498658344764, 8.481613841634196, 25.731638109551653, 68.0278258320533, 0.9037295285967901, 9.493325798090078, 123.08817263602494, 189.82758503582997, 0.8898493427037508, 23.94905156682666, 32.593990590708295, 32.4462595158401, 26.031106498064393, 9.657226675957665, 27.7224160278123, 6.3491349819960226, 29.472300419053788, 16.32963131552677, 2.161290455752688, 10.52300470206492, 23.651896800281463, 1.5290780418169603, 10.245801362566786, 64.31998618943838, 4.789503053194703, 8.932005339847942, 26.31380206822294, 11.044184156854785, 0.0, 0.0, 1.6864114383979456, 36.53986291516417, 21.73631295338223, 0.0, 92.87845126674628, 92.25167900672936, 5.539096367843813, 159.14321719430382, 100.9285256453294, 50.025915111706446, 8.646354569498946, 24.740274615675062, 98.77687415133391, 59.52700692918097, 104.46057322340397, 35.35690596903345, 13.978331859275482, 1.4342190436343947, 18.369602344220734, 24.048264650102418, 88.81649673546748, 98.00434345272352, 52.532458137483935, 5.1576384497875924, 9.170539963854155, 111.15572101568266, 34.0909129930718, 10.146980341150517, 21.680195896182468, 3.7764392146325054, 0.0, 40.6348992737281, 22.58920099681245, 51.97122740772594, 7.768464958925804, 86.31186933643829, 38.50441081085331, 158.75424849009065, 115.94070632761604, 47.49201271515463, 0.0, 137.41469445181457, 4.729325086873967, 34.28765724458173, 14.495059673811692, 1.345529897281969, 120.86531955676799, 8.221754872498606, 205.84295866537474, 9.571966043842572, 11.002975408895143, 0.0, 11.362774934738837, 26.643863544916492, 3.057180268682403, 32.98373210693837, 171.45290606661538, 149.27991186011434, 44.42822014401832, 45.74168980704291, 49.85254994072258, 2.137579079200629, 60.96297432596246, 175.92348087208245, 15.911429217462365, 37.85896440075039, 64.51032985212132, 29.163629027159597, 236.7464270997417, 51.948282828974584, 113.78775544684933, 0.9832483214575445, 9.785574943220903, 114.41407823638829, 32.14919972326118, 20.880540348229324, 71.3255723849714, 40.26651260110936, 7.188883664638906, 87.14842601191043, 86.87050839381949, 22.54217155617874, 6.559651740802902, 118.667350257053, 6.84350157288914, 67.59454595913574, 57.416171396821866, 0.0, 34.82892934602763, 34.80305725179925, 61.691631312852095, 101.33285055668655, 3.4751058548620235, 128.9783951672643, 44.7709592654271, 66.01802852888176, 1.0008639707352007, 32.85722080036763, 57.88691986864123, 8.52185618961748, 103.50080785434433, 163.23192523202687, 2.9614901749699447, 2.168957764186753, 362.00597760745256, 1.3135910265675534, 83.91510554236518, 78.93149468567044, 4.502598847512234, 10.973366941587248, 2.4236332266037905, 67.67271198911988, 7.902417363870118, 8.254739706778622, 43.76133446986101, 37.62534094476757, 3.44911740885622, 3.471698497437455, 23.907848564372248, 42.04582920562007, 1.8864820145723225, 82.62236124446497, 134.92977389158366, 33.052229491146164, 43.108000331513125, 4.913746026636455, 6.346467401614414, 68.76766584418228, 14.773567955379235, 3.814613360647012, 171.9481107537622, 181.1669070178922, 214.48000811334597, 4.667039229408318, 104.16981859926386, 0.0, 3.0526466551414226, 0.0, 0.0, 48.850700181714394, 33.64730488159607, 49.82300823530233, 0.0, 35.81721226044561, 37.5528455275491, 43.081685647533654, 124.74307014365267, 52.486004996460395, 4.989467712549096, 4.578259645456896, 2.3013980723471708, 1.0195232767095193, 103.34740781015262, 10.57210489841932, 127.25621243244935, 35.34755108482303, 2.589959748467159, 1.639508925336739]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8059571492712615, "mean_inference_ms": 2.4685728406392804, "mean_action_processing_ms": 0.36089583890224397, "mean_env_wait_ms": 0.2814165775887069, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004307746887207031, "StateBufferConnector_ms": 0.003626108169555664, "ViewRequirementAgentConnector_ms": 0.10169088840484619}, "num_episodes": 18, "episode_return_max": 381.06, "episode_return_min": -50.967261327156564, "episode_return_mean": 116.7410661032368, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.37298605061835, "num_env_steps_trained_throughput_per_sec": 269.37298605061835, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 15365.901, "restore_workers_time_ms": 0.016, "training_step_time_ms": 15365.844, "sample_time_ms": 1924.566, "learn_time_ms": 13415.342, "learn_throughput": 298.166, "synch_weights_time_ms": 23.106}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 34, "trial_id": "61e09_00000", "date": "2024-08-16_16-15-13", "timestamp": 1723805113, "time_this_iter_s": 14.89170503616333, "time_total_s": 514.5134007930756, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24beee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 514.5134007930756, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 60.847619047619055, "ram_util_percent": 81.51428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0181690185316026, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 1.2983666725890346, "policy_loss": -0.005763227145172774, "vf_loss": 1.3035395107729726, "vf_explained_var": 0.014458768613754757, "kl": 0.005903828790584226, "entropy": 0.7284408512569609, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2639331806904424, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.792176470933137, "policy_loss": -0.002634254807394451, "vf_loss": 5.792055533424256, "vf_explained_var": 0.720844157852193, "kl": 0.013775888326218344, "entropy": 1.260565411413788, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 381.06, "episode_reward_min": -50.967261327156564, "episode_reward_mean": 125.34499942118056, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -259.7437126099718, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 362.00597760745256}, "policy_reward_mean": {"prey_policy": 12.976433569458333, "predator_policy": 49.69606614113201}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.899999999999961, 3.729999999999964, 162.39999999999998, 3.7599999999999634, 3.90999999999996, 3.2099999999999755, 196.28999999999968, 1.9519660112501078, 4.675216161947491, 223.47700692918053, 40.104430476002825, 3.889999999999961, 9.852957021285556, 14.880463747839986, 3.5999999999999677, 3.4599999999999698, 180.9299999999998, 3.87999999999996, 3.7999999999999625, 174.55975599549515, 185.58999999999975, -15.391355432482403, 3.0099999999999785, 183.4299999999996, 181.9699999999998, 187.0799999999997, 300.05525915725934, 187.94009980615778, 365.28, 3.7199999999999656, 193.93999999999966, 73.25067320798043, 119.11699682142574, 3.629999999999966, -5.71016027578548, 5.024716741439585, -25.077433568756486, -50.967261327156564, 133.03000000000026, 170.94999999999993, 364.40975576327594, 28.885290011940988, 3.619999999999965, 175.94999999999982, 3.1899999999999755, 321.5, 3.5599999999999685, 161.96003344633388, 176.60999999999984, 186.25999999999965, 153.85000000000008, 4.799999999999941, 219.3499999999999, 2.50999999999999, 346.48999999999995, 108.99000000000017, 244.44813561705257, 381.06, 3.5899999999999666, 379.13, 143.63844340633761, 168.27999999999986, 330.3246094273364, 193.6199999999996, 4.0227663972578425, 267.12, 149.23655233629205, 3.8399999999999626, 2.020000000000002, 129.78846885804344, 201.53999999999962, 1.8207479486966316, 200.63999999999965, 117.65005726227909, 3.8399999999999617, 171.8209265121689, 164.62837346457525, 3.9399999999999595, 363.5408598527534, 190.32999999999993, 153.77000000000012, 343.53, 3.539999999999966, 128.1700000000003, 190.9599999999997, 355.1566871273884, 3.8099999999999614, 185.84000000000003, 5.365502306834283, 111.39839100697726, 157.03000000000003, 29.686800139836617, 189.97999999999968, 354.00420975959906, 164.48000000000025, 184.97999999999973, 45.969999999999985, 273.13, 236.71999999999997, 89.04000000000005], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.8195030531947447, -7.002005339847983, -24.493802068222653, -9.134184156854825, 160.4, 2.0000000000000013, 0.2935885616020559, -34.759862915164526, -19.826312953381933, 2.0000000000000013, -91.21845126674543, -90.70167900672857, 189.4609036321562, -157.853217194305, -62.36232957038701, -86.64014517539842, -5.801138407551441, -22.910274615674776, -28.489778522176792, 93.66290437084324, -96.07057322340326, -3.6424754930301084, -12.078331859275522, 0.5557809563656068, -16.03140504412586, -16.53350492891106, -103.89937615608628, -68.04100028426436, -50.882458137484264, -3.207638449787634, -7.230539963854197, -109.63572101568188, 144.92908700692823, -8.23698034115056, -19.77019589618217, -1.806439214632543, 2.0000000000000013, -38.83489927372846, -6.049445001317277, 106.04877259227403, 176.3115350410742, -84.80186933643752, -136.58168402110877, -76.06833071231758, -114.76070632761612, -45.662012715154994, -127.36615627316003, 173.38146182134557, -2.7693250868740087, 145.72234275541825, -12.555059673811733, 183.79447010271798, 100.97556649513557, 69.99261823285721, 29.379257066965565, -56.85408197002508, 181.00702459110485, 173.26999999999998, -9.422774934738879, -24.86386354491622, 188.99281973131758, -31.093732106938422, -191.84344738002338, -55.63869733872833, -45.051473503294424, 73.99856037365826, -28.2545191380116, -20.105609881911203, -132.2296038735145, -110.36701160031599, -12.676712476022754, -36.068964400750744, -47.162003156883365, -71.58938929115402, -119.75738267863282, -219.90458857724036, -15.15945609682271, 33.418452328515954, -7.855574943220944, 54.605921763611704, 142.09558361195994, 169.28443207982545, -0.954941464626206, -81.75185350951325, -5.238883664638948, -85.47842601190958, 87.1394916061805, -20.602171556178437, -105.22910718978447, -16.807894808070895, 139.62649842711085, 107.43545404086427, -55.85617139682218, 2.0000000000000013, -8.505276662274696, 100.83332351078171, -60.081631312852366, 73.66714944331345, 181.64489414513798, -127.83839516726495, -41.97095926542745, 85.03197147111825, 1.9791360292648008, -31.037220800367646, -28.58691986864146, 181.5281438103825, -69.35861612300117, -194.86411696336998, 191.06850982503005, 150.29104223581325, -255.00597760745256, 0.676408973432448, 142.07146452236236, -60.46992913334461, 188.53740115248777, 177.04663305841274, -0.45363322660379723, -66.05271198911905, 189.09758263612989, 173.8752602932214, -47.26138401628319, 109.51315200799183, 162.86088259114376, -1.501698497437486, 149.46623359136362, 114.90469806598044, 190.17351798542768, -81.06236124446417, -163.55964162301734, -0.399595362455506, 112.15199966848682, 106.94625397336354, 73.0244065379589, 1.0980125525363875, 1.1242854594721043, -15.872466775498088, -91.35130516168256, -259.7437126099718, -57.50097084307404, -31.857607641637443, -102.62981859926307, 200.0, -1.0826466551414442, -0.14925205130336971, 199.01, -47.22070018171472, 42.11767651710613, -7.937932371725973, 2.0000000000000013, -33.977212260445974, -35.87284552754942, 127.05924086463544, -2.8713786656654126, -9.729323009872417, -3.0194677125491376, -2.608259645456938, 194.7086019276528, 165.51133657604387, -102.04740781015197, 178.45789510158068, -125.82621243244861, 116.99244891517694, 177.59004025153286, 161.71049107466325, -101.08542330037706, -34.133413688323735, 2.0000000000000013, -8.503824872101362, 182.20058820875533, -10.194506291783798, 151.44788951189213, 159.2650229169596, -60.4922026011344, -2.823842044153986, 140.62586166744302, 5.509578619802182, -1.9678922836284247, -5.1559711173810925, -162.31604084804422, -42.34016654036953, 147.68362164721418, -225.0765881581319, -8.611617949498077, -76.8104829495053, 176.61772096961386, -3.342431443189784, 109.61784870124424, 159.35664299075657, 60.567888714097634, -56.60042769554907, 138.4207997508363, -6.233342134358624, -44.530897164222026, -2.3302369363395172, 159.2756066840296, 86.00381317625212, -9.475392467673071, 76.79156561283708, -14.300987477456847, -57.668931287434546], "policy_predator_policy_reward": [4.789503053194703, 8.932005339847942, 26.31380206822294, 11.044184156854785, 0.0, 0.0, 1.6864114383979456, 36.53986291516417, 21.73631295338223, 0.0, 92.87845126674628, 92.25167900672936, 5.539096367843813, 159.14321719430382, 100.9285256453294, 50.025915111706446, 8.646354569498946, 24.740274615675062, 98.77687415133391, 59.52700692918097, 104.46057322340397, 35.35690596903345, 13.978331859275482, 1.4342190436343947, 18.369602344220734, 24.048264650102418, 88.81649673546748, 98.00434345272352, 52.532458137483935, 5.1576384497875924, 9.170539963854155, 111.15572101568266, 34.0909129930718, 10.146980341150517, 21.680195896182468, 3.7764392146325054, 0.0, 40.6348992737281, 22.58920099681245, 51.97122740772594, 7.768464958925804, 86.31186933643829, 38.50441081085331, 158.75424849009065, 115.94070632761604, 47.49201271515463, 0.0, 137.41469445181457, 4.729325086873967, 34.28765724458173, 14.495059673811692, 1.345529897281969, 120.86531955676799, 8.221754872498606, 205.84295866537474, 9.571966043842572, 11.002975408895143, 0.0, 11.362774934738837, 26.643863544916492, 3.057180268682403, 32.98373210693837, 171.45290606661538, 149.27991186011434, 44.42822014401832, 45.74168980704291, 49.85254994072258, 2.137579079200629, 60.96297432596246, 175.92348087208245, 15.911429217462365, 37.85896440075039, 64.51032985212132, 29.163629027159597, 236.7464270997417, 51.948282828974584, 113.78775544684933, 0.9832483214575445, 9.785574943220903, 114.41407823638829, 32.14919972326118, 20.880540348229324, 71.3255723849714, 40.26651260110936, 7.188883664638906, 87.14842601191043, 86.87050839381949, 22.54217155617874, 6.559651740802902, 118.667350257053, 6.84350157288914, 67.59454595913574, 57.416171396821866, 0.0, 34.82892934602763, 34.80305725179925, 61.691631312852095, 101.33285055668655, 3.4751058548620235, 128.9783951672643, 44.7709592654271, 66.01802852888176, 1.0008639707352007, 32.85722080036763, 57.88691986864123, 8.52185618961748, 103.50080785434433, 163.23192523202687, 2.9614901749699447, 2.168957764186753, 362.00597760745256, 1.3135910265675534, 83.91510554236518, 78.93149468567044, 4.502598847512234, 10.973366941587248, 2.4236332266037905, 67.67271198911988, 7.902417363870118, 8.254739706778622, 43.76133446986101, 37.62534094476757, 3.44911740885622, 3.471698497437455, 23.907848564372248, 42.04582920562007, 1.8864820145723225, 82.62236124446497, 134.92977389158366, 33.052229491146164, 43.108000331513125, 4.913746026636455, 6.346467401614414, 68.76766584418228, 14.773567955379235, 3.814613360647012, 171.9481107537622, 181.1669070178922, 214.48000811334597, 4.667039229408318, 104.16981859926386, 0.0, 3.0526466551414226, 0.0, 0.0, 48.850700181714394, 33.64730488159607, 49.82300823530233, 0.0, 35.81721226044561, 37.5528455275491, 43.081685647533654, 124.74307014365267, 52.486004996460395, 4.989467712549096, 4.578259645456896, 2.3013980723471708, 1.0195232767095193, 103.34740781015262, 10.57210489841932, 127.25621243244935, 35.34755108482303, 2.589959748467159, 1.639508925336739, 102.71542330037789, 36.043413688323355, 0.0, 134.67382487210136, 6.8494117912446555, 12.104506291783757, 24.319937793434892, 20.123836905101843, 62.342202601134034, 4.783842044153944, 30.42413833255696, 9.28042138019778, 6.358776012693401, 6.130589695150393, 294.3560408480442, 21.698557547346276, 121.4918391028707, 112.93112740804672, 49.58935427837214, 65.51954676046805, 11.422279030386143, 5.282431443189743, 6.753027329642199, 78.27669073795606, 87.46211128590237, 73.05042769554967, 44.619200249163725, 8.173342134358583, 88.53089716422251, 4.300236936339475, 14.894393315970369, 12.956186823747876, 22.79467426295794, 146.6091525918782, 16.150987477456823, 144.85893128743436]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8037031818258251, "mean_inference_ms": 2.4642423340913724, "mean_action_processing_ms": 0.3588836210435048, "mean_env_wait_ms": 0.2803709104978123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004441022872924805, "StateBufferConnector_ms": 0.003712773323059082, "ViewRequirementAgentConnector_ms": 0.10990703105926514}, "num_episodes": 18, "episode_return_max": 381.06, "episode_return_min": -50.967261327156564, "episode_return_mean": 125.34499942118056, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.71669920944043, "num_env_steps_trained_throughput_per_sec": 277.71669920944043, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 15218.138, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15218.082, "sample_time_ms": 1873.712, "learn_time_ms": 13318.428, "learn_throughput": 300.336, "synch_weights_time_ms": 23.183}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 35, "trial_id": "61e09_00000", "date": "2024-08-16_16-15-27", "timestamp": 1723805127, "time_this_iter_s": 14.447958946228027, "time_total_s": 528.9613597393036, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24be280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 528.9613597393036, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 62.269999999999996, "ram_util_percent": 81.385}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.362846036941286, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 2.3712646997794904, "policy_loss": -0.008285326432934396, "vf_loss": 2.377246008537434, "vf_explained_var": 0.037311500310897826, "kl": 0.023040125339867223, "entropy": 0.6340528303037876, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.00060232530826, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.578986937406833, "policy_loss": -0.0033590553189189265, "vf_loss": 5.580037684163089, "vf_explained_var": 0.3996181183706516, "kl": 0.011541561974538232, "entropy": 1.2844383529885106, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 381.06, "episode_reward_min": -222.37558869787574, "episode_reward_mean": 142.7822502905181, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -397.4106505910279, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 479.6244984150183}, "policy_reward_mean": {"prey_policy": 19.855828480024705, "predator_policy": 51.53529666523437}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.0099999999999785, 183.4299999999996, 181.9699999999998, 187.0799999999997, 300.05525915725934, 187.94009980615778, 365.28, 3.7199999999999656, 193.93999999999966, 73.25067320798043, 119.11699682142574, 3.629999999999966, -5.71016027578548, 5.024716741439585, -25.077433568756486, -50.967261327156564, 133.03000000000026, 170.94999999999993, 364.40975576327594, 28.885290011940988, 3.619999999999965, 175.94999999999982, 3.1899999999999755, 321.5, 3.5599999999999685, 161.96003344633388, 176.60999999999984, 186.25999999999965, 153.85000000000008, 4.799999999999941, 219.3499999999999, 2.50999999999999, 346.48999999999995, 108.99000000000017, 244.44813561705257, 381.06, 3.5899999999999666, 379.13, 143.63844340633761, 168.27999999999986, 330.3246094273364, 193.6199999999996, 4.0227663972578425, 267.12, 149.23655233629205, 3.8399999999999626, 2.020000000000002, 129.78846885804344, 201.53999999999962, 1.8207479486966316, 200.63999999999965, 117.65005726227909, 3.8399999999999617, 171.8209265121689, 164.62837346457525, 3.9399999999999595, 363.5408598527534, 190.32999999999993, 153.77000000000012, 343.53, 3.539999999999966, 128.1700000000003, 190.9599999999997, 355.1566871273884, 3.8099999999999614, 185.84000000000003, 5.365502306834283, 111.39839100697726, 157.03000000000003, 29.686800139836617, 189.97999999999968, 354.00420975959906, 164.48000000000025, 184.97999999999973, 45.969999999999985, 273.13, 236.71999999999997, 89.04000000000005, 15.728220570005938, 170.94999999999987, 249.07219081452732, 361.25999999999993, 217.11000000000007, 181.11999999999978, 156.83000000000004, 194.03173585148699, 175.08999999999975, 3.8399999999999626, 171.96, -3.658444846784331, 190.32999999999998, 364.1899999999999, 310.65999999999997, 47.84999999999997, 174.74999999999977, 189.29999999999978, 3.4799999999999693, -222.37558869787574, 4.7974141529102114, 3.869999999999962], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-114.76070632761612, -45.662012715154994, -127.36615627316003, 173.38146182134557, -2.7693250868740087, 145.72234275541825, -12.555059673811733, 183.79447010271798, 100.97556649513557, 69.99261823285721, 29.379257066965565, -56.85408197002508, 181.00702459110485, 173.26999999999998, -9.422774934738879, -24.86386354491622, 188.99281973131758, -31.093732106938422, -191.84344738002338, -55.63869733872833, -45.051473503294424, 73.99856037365826, -28.2545191380116, -20.105609881911203, -132.2296038735145, -110.36701160031599, -12.676712476022754, -36.068964400750744, -47.162003156883365, -71.58938929115402, -119.75738267863282, -219.90458857724036, -15.15945609682271, 33.418452328515954, -7.855574943220944, 54.605921763611704, 142.09558361195994, 169.28443207982545, -0.954941464626206, -81.75185350951325, -5.238883664638948, -85.47842601190958, 87.1394916061805, -20.602171556178437, -105.22910718978447, -16.807894808070895, 139.62649842711085, 107.43545404086427, -55.85617139682218, 2.0000000000000013, -8.505276662274696, 100.83332351078171, -60.081631312852366, 73.66714944331345, 181.64489414513798, -127.83839516726495, -41.97095926542745, 85.03197147111825, 1.9791360292648008, -31.037220800367646, -28.58691986864146, 181.5281438103825, -69.35861612300117, -194.86411696336998, 191.06850982503005, 150.29104223581325, -255.00597760745256, 0.676408973432448, 142.07146452236236, -60.46992913334461, 188.53740115248777, 177.04663305841274, -0.45363322660379723, -66.05271198911905, 189.09758263612989, 173.8752602932214, -47.26138401628319, 109.51315200799183, 162.86088259114376, -1.501698497437486, 149.46623359136362, 114.90469806598044, 190.17351798542768, -81.06236124446417, -163.55964162301734, -0.399595362455506, 112.15199966848682, 106.94625397336354, 73.0244065379589, 1.0980125525363875, 1.1242854594721043, -15.872466775498088, -91.35130516168256, -259.7437126099718, -57.50097084307404, -31.857607641637443, -102.62981859926307, 200.0, -1.0826466551414442, -0.14925205130336971, 199.01, -47.22070018171472, 42.11767651710613, -7.937932371725973, 2.0000000000000013, -33.977212260445974, -35.87284552754942, 127.05924086463544, -2.8713786656654126, -9.729323009872417, -3.0194677125491376, -2.608259645456938, 194.7086019276528, 165.51133657604387, -102.04740781015197, 178.45789510158068, -125.82621243244861, 116.99244891517694, 177.59004025153286, 161.71049107466325, -101.08542330037706, -34.133413688323735, 2.0000000000000013, -8.503824872101362, 182.20058820875533, -10.194506291783798, 151.44788951189213, 159.2650229169596, -60.4922026011344, -2.823842044153986, 140.62586166744302, 5.509578619802182, -1.9678922836284247, -5.1559711173810925, -162.31604084804422, -42.34016654036953, 147.68362164721418, -225.0765881581319, -8.611617949498077, -76.8104829495053, 176.61772096961386, -3.342431443189784, 109.61784870124424, 159.35664299075657, 60.567888714097634, -56.60042769554907, 138.4207997508363, -6.233342134358624, -44.530897164222026, -2.3302369363395172, 159.2756066840296, 86.00381317625212, -9.475392467673071, 76.79156561283708, -14.300987477456847, -57.668931287434546, -4.066129408391335, 10.023720193937432, 78.68977361289124, -3.6595101066924283, 162.1177236461583, -128.5385807098462, 159.99672666912343, 181.18877357279376, 149.0873199343235, -21.96500454106888, 2.0000000000000013, 161.04715335998137, -36.10460686481963, 74.37542875243373, -136.63316452282433, 186.2249822452765, 152.70988523966258, 2.0000000000000013, -16.809514672369943, 2.0000000000000013, -194.08268547266027, 144.2108415918571, -11.456839499062232, -7.651602085673515, 183.13000842552032, -101.64970381854575, 180.869171404309, 152.4367367405108, 116.15804887638117, 158.20163425641925, -165.59048639892887, -46.036979714488595, -71.06062581090853, 172.04510520791777, -105.3436645457979, 176.28625927380358, 0.8088659553814367, -86.74106695899394, -309.66074656599733, -397.4106505910279, -0.043727263789916315, 2.0000000000000013, -4.023173009910687, -8.953694720779687], "policy_predator_policy_reward": [115.94070632761604, 47.49201271515463, 0.0, 137.41469445181457, 4.729325086873967, 34.28765724458173, 14.495059673811692, 1.345529897281969, 120.86531955676799, 8.221754872498606, 205.84295866537474, 9.571966043842572, 11.002975408895143, 0.0, 11.362774934738837, 26.643863544916492, 3.057180268682403, 32.98373210693837, 171.45290606661538, 149.27991186011434, 44.42822014401832, 45.74168980704291, 49.85254994072258, 2.137579079200629, 60.96297432596246, 175.92348087208245, 15.911429217462365, 37.85896440075039, 64.51032985212132, 29.163629027159597, 236.7464270997417, 51.948282828974584, 113.78775544684933, 0.9832483214575445, 9.785574943220903, 114.41407823638829, 32.14919972326118, 20.880540348229324, 71.3255723849714, 40.26651260110936, 7.188883664638906, 87.14842601191043, 86.87050839381949, 22.54217155617874, 6.559651740802902, 118.667350257053, 6.84350157288914, 67.59454595913574, 57.416171396821866, 0.0, 34.82892934602763, 34.80305725179925, 61.691631312852095, 101.33285055668655, 3.4751058548620235, 128.9783951672643, 44.7709592654271, 66.01802852888176, 1.0008639707352007, 32.85722080036763, 57.88691986864123, 8.52185618961748, 103.50080785434433, 163.23192523202687, 2.9614901749699447, 2.168957764186753, 362.00597760745256, 1.3135910265675534, 83.91510554236518, 78.93149468567044, 4.502598847512234, 10.973366941587248, 2.4236332266037905, 67.67271198911988, 7.902417363870118, 8.254739706778622, 43.76133446986101, 37.62534094476757, 3.44911740885622, 3.471698497437455, 23.907848564372248, 42.04582920562007, 1.8864820145723225, 82.62236124446497, 134.92977389158366, 33.052229491146164, 43.108000331513125, 4.913746026636455, 6.346467401614414, 68.76766584418228, 14.773567955379235, 3.814613360647012, 171.9481107537622, 181.1669070178922, 214.48000811334597, 4.667039229408318, 104.16981859926386, 0.0, 3.0526466551414226, 0.0, 0.0, 48.850700181714394, 33.64730488159607, 49.82300823530233, 0.0, 35.81721226044561, 37.5528455275491, 43.081685647533654, 124.74307014365267, 52.486004996460395, 4.989467712549096, 4.578259645456896, 2.3013980723471708, 1.0195232767095193, 103.34740781015262, 10.57210489841932, 127.25621243244935, 35.34755108482303, 2.589959748467159, 1.639508925336739, 102.71542330037789, 36.043413688323355, 0.0, 134.67382487210136, 6.8494117912446555, 12.104506291783757, 24.319937793434892, 20.123836905101843, 62.342202601134034, 4.783842044153944, 30.42413833255696, 9.28042138019778, 6.358776012693401, 6.130589695150393, 294.3560408480442, 21.698557547346276, 121.4918391028707, 112.93112740804672, 49.58935427837214, 65.51954676046805, 11.422279030386143, 5.282431443189743, 6.753027329642199, 78.27669073795606, 87.46211128590237, 73.05042769554967, 44.619200249163725, 8.173342134358583, 88.53089716422251, 4.300236936339475, 14.894393315970369, 12.956186823747876, 22.79467426295794, 146.6091525918782, 16.150987477456823, 144.85893128743436, 3.7456983306147507, 6.024931453845089, 90.31022638710876, 5.609510106692387, 130.54836459948297, 84.94468327873234, 16.143273330876564, 3.9312264272061794, 74.93554638108309, 15.052138225662468, 0.0, 18.07284664001865, 37.89460686481927, 80.66457124756626, 64.93737593217973, 79.50254219685431, 7.678085339229261, 12.702029421108154, 18.64951467237022, 0.0, 123.20807498842778, 98.62376889237578, 13.635642886547297, 1.8143538514041153, 5.929991574479681, 102.91970381854581, 2.2808285956910437, 28.60326325948914, 28.231951123618884, 8.068365743580765, 207.59048639892882, 51.88697971448823, 72.5506258109093, 1.2148947920821884, 106.62366454579856, 11.733740726196437, 1.1811340446185647, 88.2310669589947, 5.071310044132968, 479.6244984150183, 0.8174141529102696, 2.0237272637899175, 5.9831730099106455, 10.863694720779646]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8025149543953338, "mean_inference_ms": 2.457367819637793, "mean_action_processing_ms": 0.3565065686519853, "mean_env_wait_ms": 0.2787747659375882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046225786209106445, "StateBufferConnector_ms": 0.0036629438400268555, "ViewRequirementAgentConnector_ms": 0.11429154872894287}, "num_episodes": 22, "episode_return_max": 381.06, "episode_return_min": -222.37558869787574, "episode_return_mean": 142.7822502905181, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.5593303986181, "num_env_steps_trained_throughput_per_sec": 266.5593303986181, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 15090.618, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15090.563, "sample_time_ms": 1779.303, "learn_time_ms": 13289.899, "learn_throughput": 300.98, "synch_weights_time_ms": 19.123}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 36, "trial_id": "61e09_00000", "date": "2024-08-16_16-15-42", "timestamp": 1723805142, "time_this_iter_s": 15.051817893981934, "time_total_s": 544.0131776332855, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24afe50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 544.0131776332855, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 61.99090909090909, "ram_util_percent": 81.75909090909092}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5002298806867902, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 2.8050470990478678, "policy_loss": -0.00499132193708743, "vf_loss": 2.809145167643431, "vf_explained_var": 0.04449274754398084, "kl": 0.005955040881917018, "entropy": 0.7537678929548415, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9720337261283207, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.444823215878199, "policy_loss": -0.003502064158588096, "vf_loss": 5.446046180826015, "vf_explained_var": 0.23858015776942015, "kl": 0.0113955159741297, "entropy": 1.2748763378335055, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 381.06, "episode_reward_min": -222.37558869787574, "episode_reward_mean": 149.59618330550066, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -425.7664967524088, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 593.5154553130867}, "policy_reward_mean": {"prey_policy": 23.63132008522687, "predator_policy": 51.16677156752349}, "custom_metrics": {}, "hist_stats": {"episode_reward": [321.5, 3.5599999999999685, 161.96003344633388, 176.60999999999984, 186.25999999999965, 153.85000000000008, 4.799999999999941, 219.3499999999999, 2.50999999999999, 346.48999999999995, 108.99000000000017, 244.44813561705257, 381.06, 3.5899999999999666, 379.13, 143.63844340633761, 168.27999999999986, 330.3246094273364, 193.6199999999996, 4.0227663972578425, 267.12, 149.23655233629205, 3.8399999999999626, 2.020000000000002, 129.78846885804344, 201.53999999999962, 1.8207479486966316, 200.63999999999965, 117.65005726227909, 3.8399999999999617, 171.8209265121689, 164.62837346457525, 3.9399999999999595, 363.5408598527534, 190.32999999999993, 153.77000000000012, 343.53, 3.539999999999966, 128.1700000000003, 190.9599999999997, 355.1566871273884, 3.8099999999999614, 185.84000000000003, 5.365502306834283, 111.39839100697726, 157.03000000000003, 29.686800139836617, 189.97999999999968, 354.00420975959906, 164.48000000000025, 184.97999999999973, 45.969999999999985, 273.13, 236.71999999999997, 89.04000000000005, 15.728220570005938, 170.94999999999987, 249.07219081452732, 361.25999999999993, 217.11000000000007, 181.11999999999978, 156.83000000000004, 194.03173585148699, 175.08999999999975, 3.8399999999999626, 171.96, -3.658444846784331, 190.32999999999998, 364.1899999999999, 310.65999999999997, 47.84999999999997, 174.74999999999977, 189.29999999999978, 3.4799999999999693, -222.37558869787574, 4.7974141529102114, 3.869999999999962, 170.2199999999999, -0.38758019376080655, 187.06999999999977, 289.9400000000001, 170.70000000000005, 167.83999999999992, 186.75999999999968, 184.3124033401278, 368.2499999999999, 54.14999999999997, 148.18000000000012, 176.13999999999987, 33.81000000000004, 3.8599999999999612, 3.119999999999981, 348.87613447403453, 114.55402897992799, 349.25999999999993, 41.740184501159355, 86.13000000000014, -6.8739332654557845, 164.11000000000007, 45.35999999999998], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [139.62649842711085, 107.43545404086427, -55.85617139682218, 2.0000000000000013, -8.505276662274696, 100.83332351078171, -60.081631312852366, 73.66714944331345, 181.64489414513798, -127.83839516726495, -41.97095926542745, 85.03197147111825, 1.9791360292648008, -31.037220800367646, -28.58691986864146, 181.5281438103825, -69.35861612300117, -194.86411696336998, 191.06850982503005, 150.29104223581325, -255.00597760745256, 0.676408973432448, 142.07146452236236, -60.46992913334461, 188.53740115248777, 177.04663305841274, -0.45363322660379723, -66.05271198911905, 189.09758263612989, 173.8752602932214, -47.26138401628319, 109.51315200799183, 162.86088259114376, -1.501698497437486, 149.46623359136362, 114.90469806598044, 190.17351798542768, -81.06236124446417, -163.55964162301734, -0.399595362455506, 112.15199966848682, 106.94625397336354, 73.0244065379589, 1.0980125525363875, 1.1242854594721043, -15.872466775498088, -91.35130516168256, -259.7437126099718, -57.50097084307404, -31.857607641637443, -102.62981859926307, 200.0, -1.0826466551414442, -0.14925205130336971, 199.01, -47.22070018171472, 42.11767651710613, -7.937932371725973, 2.0000000000000013, -33.977212260445974, -35.87284552754942, 127.05924086463544, -2.8713786656654126, -9.729323009872417, -3.0194677125491376, -2.608259645456938, 194.7086019276528, 165.51133657604387, -102.04740781015197, 178.45789510158068, -125.82621243244861, 116.99244891517694, 177.59004025153286, 161.71049107466325, -101.08542330037706, -34.133413688323735, 2.0000000000000013, -8.503824872101362, 182.20058820875533, -10.194506291783798, 151.44788951189213, 159.2650229169596, -60.4922026011344, -2.823842044153986, 140.62586166744302, 5.509578619802182, -1.9678922836284247, -5.1559711173810925, -162.31604084804422, -42.34016654036953, 147.68362164721418, -225.0765881581319, -8.611617949498077, -76.8104829495053, 176.61772096961386, -3.342431443189784, 109.61784870124424, 159.35664299075657, 60.567888714097634, -56.60042769554907, 138.4207997508363, -6.233342134358624, -44.530897164222026, -2.3302369363395172, 159.2756066840296, 86.00381317625212, -9.475392467673071, 76.79156561283708, -14.300987477456847, -57.668931287434546, -4.066129408391335, 10.023720193937432, 78.68977361289124, -3.6595101066924283, 162.1177236461583, -128.5385807098462, 159.99672666912343, 181.18877357279376, 149.0873199343235, -21.96500454106888, 2.0000000000000013, 161.04715335998137, -36.10460686481963, 74.37542875243373, -136.63316452282433, 186.2249822452765, 152.70988523966258, 2.0000000000000013, -16.809514672369943, 2.0000000000000013, -194.08268547266027, 144.2108415918571, -11.456839499062232, -7.651602085673515, 183.13000842552032, -101.64970381854575, 180.869171404309, 152.4367367405108, 116.15804887638117, 158.20163425641925, -165.59048639892887, -46.036979714488595, -71.06062581090853, 172.04510520791777, -105.3436645457979, 176.28625927380358, 0.8088659553814367, -86.74106695899394, -309.66074656599733, -397.4106505910279, -0.043727263789916315, 2.0000000000000013, -4.023173009910687, -8.953694720779687, 157.45903149303035, -1.0868663279576465, -81.03355209019671, -53.387266794210994, -5.644959657904366, 183.09271733264262, 86.86820241000217, 181.41624440750272, -80.77875305176639, 154.1379524244353, 142.85056272081684, -50.052504853880244, -84.50669940695705, 169.84913723584617, -19.208376959175776, -12.472154724095347, 179.71255148565018, 177.68090236896916, 1.2211286982361453, -208.8591672278929, -15.99172218648061, 105.37398433367512, -2.7276611392605465, 166.66674730558105, -181.71570544785789, -50.922233367361265, -0.9856460712182895, -18.111313549304118, -65.07736738629563, -107.59510777788553, 170.6911344879436, 159.302888724721, -48.46615750795159, -66.80386392628566, 155.0359241139936, 166.1498982700374, -130.4401723400286, -425.7664967524088, -43.23076913540667, -8.877989451599184, -10.582276747246322, -18.687499126537894, 1.1665952612785913, 136.23206263355934, -11.603309221038131, 16.7888249468468], "policy_predator_policy_reward": [6.84350157288914, 67.59454595913574, 57.416171396821866, 0.0, 34.82892934602763, 34.80305725179925, 61.691631312852095, 101.33285055668655, 3.4751058548620235, 128.9783951672643, 44.7709592654271, 66.01802852888176, 1.0008639707352007, 32.85722080036763, 57.88691986864123, 8.52185618961748, 103.50080785434433, 163.23192523202687, 2.9614901749699447, 2.168957764186753, 362.00597760745256, 1.3135910265675534, 83.91510554236518, 78.93149468567044, 4.502598847512234, 10.973366941587248, 2.4236332266037905, 67.67271198911988, 7.902417363870118, 8.254739706778622, 43.76133446986101, 37.62534094476757, 3.44911740885622, 3.471698497437455, 23.907848564372248, 42.04582920562007, 1.8864820145723225, 82.62236124446497, 134.92977389158366, 33.052229491146164, 43.108000331513125, 4.913746026636455, 6.346467401614414, 68.76766584418228, 14.773567955379235, 3.814613360647012, 171.9481107537622, 181.1669070178922, 214.48000811334597, 4.667039229408318, 104.16981859926386, 0.0, 3.0526466551414226, 0.0, 0.0, 48.850700181714394, 33.64730488159607, 49.82300823530233, 0.0, 35.81721226044561, 37.5528455275491, 43.081685647533654, 124.74307014365267, 52.486004996460395, 4.989467712549096, 4.578259645456896, 2.3013980723471708, 1.0195232767095193, 103.34740781015262, 10.57210489841932, 127.25621243244935, 35.34755108482303, 2.589959748467159, 1.639508925336739, 102.71542330037789, 36.043413688323355, 0.0, 134.67382487210136, 6.8494117912446555, 12.104506291783757, 24.319937793434892, 20.123836905101843, 62.342202601134034, 4.783842044153944, 30.42413833255696, 9.28042138019778, 6.358776012693401, 6.130589695150393, 294.3560408480442, 21.698557547346276, 121.4918391028707, 112.93112740804672, 49.58935427837214, 65.51954676046805, 11.422279030386143, 5.282431443189743, 6.753027329642199, 78.27669073795606, 87.46211128590237, 73.05042769554967, 44.619200249163725, 8.173342134358583, 88.53089716422251, 4.300236936339475, 14.894393315970369, 12.956186823747876, 22.79467426295794, 146.6091525918782, 16.150987477456823, 144.85893128743436, 3.7456983306147507, 6.024931453845089, 90.31022638710876, 5.609510106692387, 130.54836459948297, 84.94468327873234, 16.143273330876564, 3.9312264272061794, 74.93554638108309, 15.052138225662468, 0.0, 18.07284664001865, 37.89460686481927, 80.66457124756626, 64.93737593217973, 79.50254219685431, 7.678085339229261, 12.702029421108154, 18.64951467237022, 0.0, 123.20807498842778, 98.62376889237578, 13.635642886547297, 1.8143538514041153, 5.929991574479681, 102.91970381854581, 2.2808285956910437, 28.60326325948914, 28.231951123618884, 8.068365743580765, 207.59048639892882, 51.88697971448823, 72.5506258109093, 1.2148947920821884, 106.62366454579856, 11.733740726196437, 1.1811340446185647, 88.2310669589947, 5.071310044132968, 479.6244984150183, 0.8174141529102696, 2.0237272637899175, 5.9831730099106455, 10.863694720779646, 10.79096850696964, 3.056866327957625, 30.3562402488013, 103.67699844184611, 8.725938065635354, 0.8963042596263356, 15.02179758999782, 6.633755592497308, 55.08189655337725, 42.25890407395356, 12.657009899742114, 62.38493223332102, 88.33212411155868, 13.085438059553084, 93.19379586493349, 122.79913915846629, 7.3874485143497814, 3.469097631030847, 0.768871301763856, 261.01916722789286, 24.284845453732064, 34.51289239907376, 11.211802837016528, 0.9891109966629203, 213.71570544785803, 52.732233367360905, 4.71749326115292, 18.23946635936976, 66.79736738629651, 108.99510777788625, 5.944999986090992, 12.937111275279007, 114.97212535960801, 114.8519250545582, 19.438103863765825, 8.636073752203211, 593.5154553130867, 4.431398280508519, 127.4507691354066, 10.787989451599145, 21.14943139255903, 1.2464112157697447, 0.8234047387214102, 25.887937366440724, 13.53330922103809, 26.641175053153425]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8003475155141015, "mean_inference_ms": 2.4584891386932797, "mean_action_processing_ms": 0.355680526836061, "mean_env_wait_ms": 0.2787997316982453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004554390907287598, "StateBufferConnector_ms": 0.003467559814453125, "ViewRequirementAgentConnector_ms": 0.12170171737670898}, "num_episodes": 23, "episode_return_max": 381.06, "episode_return_min": -222.37558869787574, "episode_return_mean": 149.59618330550066, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 260.9047919243814, "num_env_steps_trained_throughput_per_sec": 260.9047919243814, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 15031.583, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15031.529, "sample_time_ms": 1795.753, "learn_time_ms": 13208.226, "learn_throughput": 302.842, "synch_weights_time_ms": 24.454}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 37, "trial_id": "61e09_00000", "date": "2024-08-16_16-15-58", "timestamp": 1723805158, "time_this_iter_s": 15.385670185089111, "time_total_s": 559.3988478183746, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24b1820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 559.3988478183746, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 61.10454545454545, "ram_util_percent": 81.55454545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4669860660399079, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 1.6473562690631423, "policy_loss": -0.0027907881073939503, "vf_loss": 1.6495211949739506, "vf_explained_var": 0.04191437038795027, "kl": 0.004172377788670427, "entropy": 0.7096419177358113, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2999438581643283, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.2554919535520845, "policy_loss": -7.447542809935473e-05, "vf_loss": 6.2534798261349795, "vf_explained_var": 0.17685949367190165, "kl": 0.010432965298904098, "entropy": 1.3235716867699194, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 379.1599999999999, "episode_reward_min": -347.19831990731274, "episode_reward_mean": 150.33029380401956, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -551.0737258731845, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 714.2073588936861}, "policy_reward_mean": {"prey_policy": 20.45777737499654, "predator_policy": 54.707369527013334}, "custom_metrics": {}, "hist_stats": {"episode_reward": [193.6199999999996, 4.0227663972578425, 267.12, 149.23655233629205, 3.8399999999999626, 2.020000000000002, 129.78846885804344, 201.53999999999962, 1.8207479486966316, 200.63999999999965, 117.65005726227909, 3.8399999999999617, 171.8209265121689, 164.62837346457525, 3.9399999999999595, 363.5408598527534, 190.32999999999993, 153.77000000000012, 343.53, 3.539999999999966, 128.1700000000003, 190.9599999999997, 355.1566871273884, 3.8099999999999614, 185.84000000000003, 5.365502306834283, 111.39839100697726, 157.03000000000003, 29.686800139836617, 189.97999999999968, 354.00420975959906, 164.48000000000025, 184.97999999999973, 45.969999999999985, 273.13, 236.71999999999997, 89.04000000000005, 15.728220570005938, 170.94999999999987, 249.07219081452732, 361.25999999999993, 217.11000000000007, 181.11999999999978, 156.83000000000004, 194.03173585148699, 175.08999999999975, 3.8399999999999626, 171.96, -3.658444846784331, 190.32999999999998, 364.1899999999999, 310.65999999999997, 47.84999999999997, 174.74999999999977, 189.29999999999978, 3.4799999999999693, -222.37558869787574, 4.7974141529102114, 3.869999999999962, 170.2199999999999, -0.38758019376080655, 187.06999999999977, 289.9400000000001, 170.70000000000005, 167.83999999999992, 186.75999999999968, 184.3124033401278, 368.2499999999999, 54.14999999999997, 148.18000000000012, 176.13999999999987, 33.81000000000004, 3.8599999999999612, 3.119999999999981, 348.87613447403453, 114.55402897992799, 349.25999999999993, 41.740184501159355, 86.13000000000014, -6.8739332654557845, 164.11000000000007, 45.35999999999998, 198.46560137711907, 163.16999999999996, 200.4520530764268, 189.94556337986188, 116.40066749425652, -347.19831990731274, 180.97999999999985, 371.0799999999999, 167.03000000000003, 116.00548643501656, 377.90444636106326, 182.00999999999974, 312.16999999999985, 379.1599999999999, 167.96617864280424, 188.98059488972115, 91.93000000000025, 353.3099999999999], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [190.17351798542768, -81.06236124446417, -163.55964162301734, -0.399595362455506, 112.15199966848682, 106.94625397336354, 73.0244065379589, 1.0980125525363875, 1.1242854594721043, -15.872466775498088, -91.35130516168256, -259.7437126099718, -57.50097084307404, -31.857607641637443, -102.62981859926307, 200.0, -1.0826466551414442, -0.14925205130336971, 199.01, -47.22070018171472, 42.11767651710613, -7.937932371725973, 2.0000000000000013, -33.977212260445974, -35.87284552754942, 127.05924086463544, -2.8713786656654126, -9.729323009872417, -3.0194677125491376, -2.608259645456938, 194.7086019276528, 165.51133657604387, -102.04740781015197, 178.45789510158068, -125.82621243244861, 116.99244891517694, 177.59004025153286, 161.71049107466325, -101.08542330037706, -34.133413688323735, 2.0000000000000013, -8.503824872101362, 182.20058820875533, -10.194506291783798, 151.44788951189213, 159.2650229169596, -60.4922026011344, -2.823842044153986, 140.62586166744302, 5.509578619802182, -1.9678922836284247, -5.1559711173810925, -162.31604084804422, -42.34016654036953, 147.68362164721418, -225.0765881581319, -8.611617949498077, -76.8104829495053, 176.61772096961386, -3.342431443189784, 109.61784870124424, 159.35664299075657, 60.567888714097634, -56.60042769554907, 138.4207997508363, -6.233342134358624, -44.530897164222026, -2.3302369363395172, 159.2756066840296, 86.00381317625212, -9.475392467673071, 76.79156561283708, -14.300987477456847, -57.668931287434546, -4.066129408391335, 10.023720193937432, 78.68977361289124, -3.6595101066924283, 162.1177236461583, -128.5385807098462, 159.99672666912343, 181.18877357279376, 149.0873199343235, -21.96500454106888, 2.0000000000000013, 161.04715335998137, -36.10460686481963, 74.37542875243373, -136.63316452282433, 186.2249822452765, 152.70988523966258, 2.0000000000000013, -16.809514672369943, 2.0000000000000013, -194.08268547266027, 144.2108415918571, -11.456839499062232, -7.651602085673515, 183.13000842552032, -101.64970381854575, 180.869171404309, 152.4367367405108, 116.15804887638117, 158.20163425641925, -165.59048639892887, -46.036979714488595, -71.06062581090853, 172.04510520791777, -105.3436645457979, 176.28625927380358, 0.8088659553814367, -86.74106695899394, -309.66074656599733, -397.4106505910279, -0.043727263789916315, 2.0000000000000013, -4.023173009910687, -8.953694720779687, 157.45903149303035, -1.0868663279576465, -81.03355209019671, -53.387266794210994, -5.644959657904366, 183.09271733264262, 86.86820241000217, 181.41624440750272, -80.77875305176639, 154.1379524244353, 142.85056272081684, -50.052504853880244, -84.50669940695705, 169.84913723584617, -19.208376959175776, -12.472154724095347, 179.71255148565018, 177.68090236896916, 1.2211286982361453, -208.8591672278929, -15.99172218648061, 105.37398433367512, -2.7276611392605465, 166.66674730558105, -181.71570544785789, -50.922233367361265, -0.9856460712182895, -18.111313549304118, -65.07736738629563, -107.59510777788553, 170.6911344879436, 159.302888724721, -48.46615750795159, -66.80386392628566, 155.0359241139936, 166.1498982700374, -130.4401723400286, -425.7664967524088, -43.23076913540667, -8.877989451599184, -10.582276747246322, -18.687499126537894, 1.1665952612785913, 136.23206263355934, -11.603309221038131, 16.7888249468468, 85.06820034939494, -0.6118799131393289, 148.1779097305519, -16.234566618250525, -77.77644663865986, 161.3328927404567, 185.14999999999986, -53.27584418015535, -25.79994980848507, -119.69833501652823, -515.2721565765952, -551.0737258731845, 179.21000000000004, -103.39546536793549, 116.77670503171022, 189.2238384777739, -31.43680850651815, 158.31840985200006, -66.98601232214189, -115.08364651167622, 168.86857780226728, 179.6383581121658, 124.37051105121955, -9.615392323924985, 51.99269261702527, 171.95738698709002, 183.19350175959732, 191.2111057355305, 160.98474375545055, -3.319059248684499, 31.31293555153355, 29.850941919264518, -170.20468040283603, -21.516519521436532, 145.10353525785686, 159.16089785427647], "policy_predator_policy_reward": [1.8864820145723225, 82.62236124446497, 134.92977389158366, 33.052229491146164, 43.108000331513125, 4.913746026636455, 6.346467401614414, 68.76766584418228, 14.773567955379235, 3.814613360647012, 171.9481107537622, 181.1669070178922, 214.48000811334597, 4.667039229408318, 104.16981859926386, 0.0, 3.0526466551414226, 0.0, 0.0, 48.850700181714394, 33.64730488159607, 49.82300823530233, 0.0, 35.81721226044561, 37.5528455275491, 43.081685647533654, 124.74307014365267, 52.486004996460395, 4.989467712549096, 4.578259645456896, 2.3013980723471708, 1.0195232767095193, 103.34740781015262, 10.57210489841932, 127.25621243244935, 35.34755108482303, 2.589959748467159, 1.639508925336739, 102.71542330037789, 36.043413688323355, 0.0, 134.67382487210136, 6.8494117912446555, 12.104506291783757, 24.319937793434892, 20.123836905101843, 62.342202601134034, 4.783842044153944, 30.42413833255696, 9.28042138019778, 6.358776012693401, 6.130589695150393, 294.3560408480442, 21.698557547346276, 121.4918391028707, 112.93112740804672, 49.58935427837214, 65.51954676046805, 11.422279030386143, 5.282431443189743, 6.753027329642199, 78.27669073795606, 87.46211128590237, 73.05042769554967, 44.619200249163725, 8.173342134358583, 88.53089716422251, 4.300236936339475, 14.894393315970369, 12.956186823747876, 22.79467426295794, 146.6091525918782, 16.150987477456823, 144.85893128743436, 3.7456983306147507, 6.024931453845089, 90.31022638710876, 5.609510106692387, 130.54836459948297, 84.94468327873234, 16.143273330876564, 3.9312264272061794, 74.93554638108309, 15.052138225662468, 0.0, 18.07284664001865, 37.89460686481927, 80.66457124756626, 64.93737593217973, 79.50254219685431, 7.678085339229261, 12.702029421108154, 18.64951467237022, 0.0, 123.20807498842778, 98.62376889237578, 13.635642886547297, 1.8143538514041153, 5.929991574479681, 102.91970381854581, 2.2808285956910437, 28.60326325948914, 28.231951123618884, 8.068365743580765, 207.59048639892882, 51.88697971448823, 72.5506258109093, 1.2148947920821884, 106.62366454579856, 11.733740726196437, 1.1811340446185647, 88.2310669589947, 5.071310044132968, 479.6244984150183, 0.8174141529102696, 2.0237272637899175, 5.9831730099106455, 10.863694720779646, 10.79096850696964, 3.056866327957625, 30.3562402488013, 103.67699844184611, 8.725938065635354, 0.8963042596263356, 15.02179758999782, 6.633755592497308, 55.08189655337725, 42.25890407395356, 12.657009899742114, 62.38493223332102, 88.33212411155868, 13.085438059553084, 93.19379586493349, 122.79913915846629, 7.3874485143497814, 3.469097631030847, 0.768871301763856, 261.01916722789286, 24.284845453732064, 34.51289239907376, 11.211802837016528, 0.9891109966629203, 213.71570544785803, 52.732233367360905, 4.71749326115292, 18.23946635936976, 66.79736738629651, 108.99510777788625, 5.944999986090992, 12.937111275279007, 114.97212535960801, 114.8519250545582, 19.438103863765825, 8.636073752203211, 593.5154553130867, 4.431398280508519, 127.4507691354066, 10.787989451599145, 21.14943139255903, 1.2464112157697447, 0.8234047387214102, 25.887937366440724, 13.53330922103809, 26.641175053153425, 59.852233346115945, 54.157047594748114, 9.109068405993938, 22.11758848170495, 76.82659040190244, 40.069016572728906, 3.265563379862415, 54.80584418015505, 130.8089684101578, 131.08998390911165, 4.940203648781722, 714.2073588936861, 0.0, 105.16546536793639, 61.273294968289804, 3.8061615222260885, 33.19680850651801, 6.951590147999973, 16.318687571407196, 281.75645769742766, 20.151422197732742, 9.24608824889752, 55.69948894878046, 11.555392323924943, 7.716173287928518, 80.50374710795624, 3.8964982404026456, 0.8588942644695223, 0.9867188041741466, 9.313775331864257, 6.823414935512986, 120.99330248341015, 4.9653499345760475, 278.685849989697, 26.09646474214315, 22.949102145723483]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8010750025864448, "mean_inference_ms": 2.4641780605158754, "mean_action_processing_ms": 0.3559310326455406, "mean_env_wait_ms": 0.2791091774729759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004581451416015625, "StateBufferConnector_ms": 0.003498077392578125, "ViewRequirementAgentConnector_ms": 0.13731753826141357}, "num_episodes": 18, "episode_return_max": 379.1599999999999, "episode_return_min": -347.19831990731274, "episode_return_mean": 150.33029380401956, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 251.22407455435516, "num_env_steps_trained_throughput_per_sec": 251.22407455435516, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 15084.378, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15084.323, "sample_time_ms": 1855.286, "learn_time_ms": 13199.753, "learn_throughput": 303.036, "synch_weights_time_ms": 25.955}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 38, "trial_id": "61e09_00000", "date": "2024-08-16_16-16-14", "timestamp": 1723805174, "time_this_iter_s": 15.977249145507812, "time_total_s": 575.3760969638824, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24b1430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 575.3760969638824, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 64.63181818181818, "ram_util_percent": 81.81818181818183}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.871064490647543, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 0.00010000000000000003, "total_loss": 2.9597440854582207, "policy_loss": -0.0053265264059451445, "vf_loss": 2.9642716525092956, "vf_explained_var": 0.040201357558921534, "kl": 0.010652804049339548, "entropy": 0.6769699030136936, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.595651693634255, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.090555212232801, "policy_loss": -0.004124517080733779, "vf_loss": 6.092050381312295, "vf_explained_var": 0.2918203908299643, "kl": 0.013146737674997695, "entropy": 1.3506616941204777, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 379.1599999999999, "episode_reward_min": -347.19831990731274, "episode_reward_mean": 161.9412224250626, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -551.0737258731845, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 191.2111057355305, "predator_policy": 714.2073588936861}, "policy_reward_mean": {"prey_policy": 23.34452319282107, "predator_policy": 57.6260880197103}, "custom_metrics": {}, "hist_stats": {"episode_reward": [343.53, 3.539999999999966, 128.1700000000003, 190.9599999999997, 355.1566871273884, 3.8099999999999614, 185.84000000000003, 5.365502306834283, 111.39839100697726, 157.03000000000003, 29.686800139836617, 189.97999999999968, 354.00420975959906, 164.48000000000025, 184.97999999999973, 45.969999999999985, 273.13, 236.71999999999997, 89.04000000000005, 15.728220570005938, 170.94999999999987, 249.07219081452732, 361.25999999999993, 217.11000000000007, 181.11999999999978, 156.83000000000004, 194.03173585148699, 175.08999999999975, 3.8399999999999626, 171.96, -3.658444846784331, 190.32999999999998, 364.1899999999999, 310.65999999999997, 47.84999999999997, 174.74999999999977, 189.29999999999978, 3.4799999999999693, -222.37558869787574, 4.7974141529102114, 3.869999999999962, 170.2199999999999, -0.38758019376080655, 187.06999999999977, 289.9400000000001, 170.70000000000005, 167.83999999999992, 186.75999999999968, 184.3124033401278, 368.2499999999999, 54.14999999999997, 148.18000000000012, 176.13999999999987, 33.81000000000004, 3.8599999999999612, 3.119999999999981, 348.87613447403453, 114.55402897992799, 349.25999999999993, 41.740184501159355, 86.13000000000014, -6.8739332654557845, 164.11000000000007, 45.35999999999998, 198.46560137711907, 163.16999999999996, 200.4520530764268, 189.94556337986188, 116.40066749425652, -347.19831990731274, 180.97999999999985, 371.0799999999999, 167.03000000000003, 116.00548643501656, 377.90444636106326, 182.00999999999974, 312.16999999999985, 379.1599999999999, 167.96617864280424, 188.98059488972115, 91.93000000000025, 353.3099999999999, 363.22, 88.87732187481842, 161.2199999999998, 292.27, 3.5099999999999665, 171.15069112128765, 324.2599999999998, 186.84999999999957, 3.8799999999999617, 183.03999999999974, 18.889999999999965, -87.30126309480376, 358.74478997885296, 336.28137729954744, 297.3999999999998, 170.3986975566644, 304.1299999999999, 307.4399999999999], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [177.59004025153286, 161.71049107466325, -101.08542330037706, -34.133413688323735, 2.0000000000000013, -8.503824872101362, 182.20058820875533, -10.194506291783798, 151.44788951189213, 159.2650229169596, -60.4922026011344, -2.823842044153986, 140.62586166744302, 5.509578619802182, -1.9678922836284247, -5.1559711173810925, -162.31604084804422, -42.34016654036953, 147.68362164721418, -225.0765881581319, -8.611617949498077, -76.8104829495053, 176.61772096961386, -3.342431443189784, 109.61784870124424, 159.35664299075657, 60.567888714097634, -56.60042769554907, 138.4207997508363, -6.233342134358624, -44.530897164222026, -2.3302369363395172, 159.2756066840296, 86.00381317625212, -9.475392467673071, 76.79156561283708, -14.300987477456847, -57.668931287434546, -4.066129408391335, 10.023720193937432, 78.68977361289124, -3.6595101066924283, 162.1177236461583, -128.5385807098462, 159.99672666912343, 181.18877357279376, 149.0873199343235, -21.96500454106888, 2.0000000000000013, 161.04715335998137, -36.10460686481963, 74.37542875243373, -136.63316452282433, 186.2249822452765, 152.70988523966258, 2.0000000000000013, -16.809514672369943, 2.0000000000000013, -194.08268547266027, 144.2108415918571, -11.456839499062232, -7.651602085673515, 183.13000842552032, -101.64970381854575, 180.869171404309, 152.4367367405108, 116.15804887638117, 158.20163425641925, -165.59048639892887, -46.036979714488595, -71.06062581090853, 172.04510520791777, -105.3436645457979, 176.28625927380358, 0.8088659553814367, -86.74106695899394, -309.66074656599733, -397.4106505910279, -0.043727263789916315, 2.0000000000000013, -4.023173009910687, -8.953694720779687, 157.45903149303035, -1.0868663279576465, -81.03355209019671, -53.387266794210994, -5.644959657904366, 183.09271733264262, 86.86820241000217, 181.41624440750272, -80.77875305176639, 154.1379524244353, 142.85056272081684, -50.052504853880244, -84.50669940695705, 169.84913723584617, -19.208376959175776, -12.472154724095347, 179.71255148565018, 177.68090236896916, 1.2211286982361453, -208.8591672278929, -15.99172218648061, 105.37398433367512, -2.7276611392605465, 166.66674730558105, -181.71570544785789, -50.922233367361265, -0.9856460712182895, -18.111313549304118, -65.07736738629563, -107.59510777788553, 170.6911344879436, 159.302888724721, -48.46615750795159, -66.80386392628566, 155.0359241139936, 166.1498982700374, -130.4401723400286, -425.7664967524088, -43.23076913540667, -8.877989451599184, -10.582276747246322, -18.687499126537894, 1.1665952612785913, 136.23206263355934, -11.603309221038131, 16.7888249468468, 85.06820034939494, -0.6118799131393289, 148.1779097305519, -16.234566618250525, -77.77644663865986, 161.3328927404567, 185.14999999999986, -53.27584418015535, -25.79994980848507, -119.69833501652823, -515.2721565765952, -551.0737258731845, 179.21000000000004, -103.39546536793549, 116.77670503171022, 189.2238384777739, -31.43680850651815, 158.31840985200006, -66.98601232214189, -115.08364651167622, 168.86857780226728, 179.6383581121658, 124.37051105121955, -9.615392323924985, 51.99269261702527, 171.95738698709002, 183.19350175959732, 191.2111057355305, 160.98474375545055, -3.319059248684499, 31.31293555153355, 29.850941919264518, -170.20468040283603, -21.516519521436532, 145.10353525785686, 159.16089785427647, 175.12231075349723, 171.9861128248175, 76.78326594756597, -95.71688401373748, 2.0000000000000013, 119.48156474896096, -9.783517009123841, 165.98193631416143, -114.30685299437452, -6.98401912359347, 120.57849403794572, 2.0000000000000013, 80.95319930665897, 178.35937832391704, 179.9123324627337, -44.77780680371994, 1.035362814811421, -9.03392880332161, 2.0000000000000013, 151.17614563608237, -352.06134303315866, -26.783202157293832, -294.18897244217317, -409.2232710783713, 175.5779364127658, 166.9116297131081, 156.6467844033604, 139.05155679420665, 165.3499999999999, -64.57131411241471, -47.97007060650208, 126.38025925803086, -194.20048736784986, 184.03387353586848, 145.07740883264353, 94.60683888375803], "policy_predator_policy_reward": [2.589959748467159, 1.639508925336739, 102.71542330037789, 36.043413688323355, 0.0, 134.67382487210136, 6.8494117912446555, 12.104506291783757, 24.319937793434892, 20.123836905101843, 62.342202601134034, 4.783842044153944, 30.42413833255696, 9.28042138019778, 6.358776012693401, 6.130589695150393, 294.3560408480442, 21.698557547346276, 121.4918391028707, 112.93112740804672, 49.58935427837214, 65.51954676046805, 11.422279030386143, 5.282431443189743, 6.753027329642199, 78.27669073795606, 87.46211128590237, 73.05042769554967, 44.619200249163725, 8.173342134358583, 88.53089716422251, 4.300236936339475, 14.894393315970369, 12.956186823747876, 22.79467426295794, 146.6091525918782, 16.150987477456823, 144.85893128743436, 3.7456983306147507, 6.024931453845089, 90.31022638710876, 5.609510106692387, 130.54836459948297, 84.94468327873234, 16.143273330876564, 3.9312264272061794, 74.93554638108309, 15.052138225662468, 0.0, 18.07284664001865, 37.89460686481927, 80.66457124756626, 64.93737593217973, 79.50254219685431, 7.678085339229261, 12.702029421108154, 18.64951467237022, 0.0, 123.20807498842778, 98.62376889237578, 13.635642886547297, 1.8143538514041153, 5.929991574479681, 102.91970381854581, 2.2808285956910437, 28.60326325948914, 28.231951123618884, 8.068365743580765, 207.59048639892882, 51.88697971448823, 72.5506258109093, 1.2148947920821884, 106.62366454579856, 11.733740726196437, 1.1811340446185647, 88.2310669589947, 5.071310044132968, 479.6244984150183, 0.8174141529102696, 2.0237272637899175, 5.9831730099106455, 10.863694720779646, 10.79096850696964, 3.056866327957625, 30.3562402488013, 103.67699844184611, 8.725938065635354, 0.8963042596263356, 15.02179758999782, 6.633755592497308, 55.08189655337725, 42.25890407395356, 12.657009899742114, 62.38493223332102, 88.33212411155868, 13.085438059553084, 93.19379586493349, 122.79913915846629, 7.3874485143497814, 3.469097631030847, 0.768871301763856, 261.01916722789286, 24.284845453732064, 34.51289239907376, 11.211802837016528, 0.9891109966629203, 213.71570544785803, 52.732233367360905, 4.71749326115292, 18.23946635936976, 66.79736738629651, 108.99510777788625, 5.944999986090992, 12.937111275279007, 114.97212535960801, 114.8519250545582, 19.438103863765825, 8.636073752203211, 593.5154553130867, 4.431398280508519, 127.4507691354066, 10.787989451599145, 21.14943139255903, 1.2464112157697447, 0.8234047387214102, 25.887937366440724, 13.53330922103809, 26.641175053153425, 59.852233346115945, 54.157047594748114, 9.109068405993938, 22.11758848170495, 76.82659040190244, 40.069016572728906, 3.265563379862415, 54.80584418015505, 130.8089684101578, 131.08998390911165, 4.940203648781722, 714.2073588936861, 0.0, 105.16546536793639, 61.273294968289804, 3.8061615222260885, 33.19680850651801, 6.951590147999973, 16.318687571407196, 281.75645769742766, 20.151422197732742, 9.24608824889752, 55.69948894878046, 11.555392323924943, 7.716173287928518, 80.50374710795624, 3.8964982404026456, 0.8588942644695223, 0.9867188041741466, 9.313775331864257, 6.823414935512986, 120.99330248341015, 4.9653499345760475, 278.685849989697, 26.09646474214315, 22.949102145723483, 10.314081904356224, 5.7974945173290955, 73.08211416323584, 34.72882577775466, 7.01158753360716, 32.726847717431916, 131.7835170091238, 4.288063685838651, 115.86685299437532, 8.934019123593428, 41.511505962054315, 7.060691121287883, 61.16680069334108, 3.7806216760830305, 5.21766753726622, 46.4978068037196, 0.9546371851885804, 10.92392880332157, 0.0, 29.863854363917657, 369.06134303315866, 28.673202157294128, 402.076711740724, 214.0342686850168, 11.472063587234151, 4.783160265745005, 2.328209896003586, 38.25482620597691, 194.26519193628667, 2.3561221761280553, 48.74618713001913, 43.24232177511685, 310.2404873678498, 4.056126464131456, 9.322591167356517, 58.433161116241955]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8023493038809357, "mean_inference_ms": 2.470227906774239, "mean_action_processing_ms": 0.35635094128970535, "mean_env_wait_ms": 0.27948353982078805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0045850276947021484, "StateBufferConnector_ms": 0.0033086538314819336, "ViewRequirementAgentConnector_ms": 0.14370262622833252}, "num_episodes": 18, "episode_return_max": 379.1599999999999, "episode_return_min": -347.19831990731274, "episode_return_mean": 161.9412224250626, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.37874951356247, "num_env_steps_trained_throughput_per_sec": 267.37874951356247, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 15083.377, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15083.321, "sample_time_ms": 1853.742, "learn_time_ms": 13200.165, "learn_throughput": 303.027, "synch_weights_time_ms": 26.103}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 39, "trial_id": "61e09_00000", "date": "2024-08-16_16-16-29", "timestamp": 1723805189, "time_this_iter_s": 15.01961898803711, "time_total_s": 590.3957159519196, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2499ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 590.3957159519196, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 64.07272727272726, "ram_util_percent": 81.58636363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3909982771312117, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 0.00010000000000000003, "total_loss": 2.1279239546684994, "policy_loss": -0.004482987815287536, "vf_loss": 2.1317483399280164, "vf_explained_var": 0.061454000832542544, "kl": 0.00878135720795077, "entropy": 0.7919080480381294, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.983523896510008, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.688239592345304, "policy_loss": -0.004486266184085734, "vf_loss": 5.690245768128249, "vf_explained_var": 0.4812251510758879, "kl": 0.01240038486653611, "entropy": 1.3538181487214629, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 398.0229607336323, "episode_reward_min": -347.19831990731274, "episode_reward_mean": 171.92070864777816, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -551.0737258731845, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 191.2111057355305, "predator_policy": 714.2073588936861}, "policy_reward_mean": {"prey_policy": 21.847516769323438, "predator_policy": 64.11283755456574}, "custom_metrics": {}, "hist_stats": {"episode_reward": [361.25999999999993, 217.11000000000007, 181.11999999999978, 156.83000000000004, 194.03173585148699, 175.08999999999975, 3.8399999999999626, 171.96, -3.658444846784331, 190.32999999999998, 364.1899999999999, 310.65999999999997, 47.84999999999997, 174.74999999999977, 189.29999999999978, 3.4799999999999693, -222.37558869787574, 4.7974141529102114, 3.869999999999962, 170.2199999999999, -0.38758019376080655, 187.06999999999977, 289.9400000000001, 170.70000000000005, 167.83999999999992, 186.75999999999968, 184.3124033401278, 368.2499999999999, 54.14999999999997, 148.18000000000012, 176.13999999999987, 33.81000000000004, 3.8599999999999612, 3.119999999999981, 348.87613447403453, 114.55402897992799, 349.25999999999993, 41.740184501159355, 86.13000000000014, -6.8739332654557845, 164.11000000000007, 45.35999999999998, 198.46560137711907, 163.16999999999996, 200.4520530764268, 189.94556337986188, 116.40066749425652, -347.19831990731274, 180.97999999999985, 371.0799999999999, 167.03000000000003, 116.00548643501656, 377.90444636106326, 182.00999999999974, 312.16999999999985, 379.1599999999999, 167.96617864280424, 188.98059488972115, 91.93000000000025, 353.3099999999999, 363.22, 88.87732187481842, 161.2199999999998, 292.27, 3.5099999999999665, 171.15069112128765, 324.2599999999998, 186.84999999999957, 3.8799999999999617, 183.03999999999974, 18.889999999999965, -87.30126309480376, 358.74478997885296, 336.28137729954744, 297.3999999999998, 170.3986975566644, 304.1299999999999, 307.4399999999999, 307.49999999999994, 3.8799999999999613, 13.140938794606493, 287.8966833031958, 318.45042425067317, 176.03000000000003, 373.2839684778155, 150.04002538312417, 325.27999999999986, 279.0077610320391, 35.42865960002828, 305.0816076766607, 109.65000000000008, 6.989999999999959, 398.0229607336323, 351.4299999999997, 101.94188667620706, 185.07999999999987, 141.97000000000043, 153.1100000000001, 287.5057080687453, 175.76999999999998], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [159.99672666912343, 181.18877357279376, 149.0873199343235, -21.96500454106888, 2.0000000000000013, 161.04715335998137, -36.10460686481963, 74.37542875243373, -136.63316452282433, 186.2249822452765, 152.70988523966258, 2.0000000000000013, -16.809514672369943, 2.0000000000000013, -194.08268547266027, 144.2108415918571, -11.456839499062232, -7.651602085673515, 183.13000842552032, -101.64970381854575, 180.869171404309, 152.4367367405108, 116.15804887638117, 158.20163425641925, -165.59048639892887, -46.036979714488595, -71.06062581090853, 172.04510520791777, -105.3436645457979, 176.28625927380358, 0.8088659553814367, -86.74106695899394, -309.66074656599733, -397.4106505910279, -0.043727263789916315, 2.0000000000000013, -4.023173009910687, -8.953694720779687, 157.45903149303035, -1.0868663279576465, -81.03355209019671, -53.387266794210994, -5.644959657904366, 183.09271733264262, 86.86820241000217, 181.41624440750272, -80.77875305176639, 154.1379524244353, 142.85056272081684, -50.052504853880244, -84.50669940695705, 169.84913723584617, -19.208376959175776, -12.472154724095347, 179.71255148565018, 177.68090236896916, 1.2211286982361453, -208.8591672278929, -15.99172218648061, 105.37398433367512, -2.7276611392605465, 166.66674730558105, -181.71570544785789, -50.922233367361265, -0.9856460712182895, -18.111313549304118, -65.07736738629563, -107.59510777788553, 170.6911344879436, 159.302888724721, -48.46615750795159, -66.80386392628566, 155.0359241139936, 166.1498982700374, -130.4401723400286, -425.7664967524088, -43.23076913540667, -8.877989451599184, -10.582276747246322, -18.687499126537894, 1.1665952612785913, 136.23206263355934, -11.603309221038131, 16.7888249468468, 85.06820034939494, -0.6118799131393289, 148.1779097305519, -16.234566618250525, -77.77644663865986, 161.3328927404567, 185.14999999999986, -53.27584418015535, -25.79994980848507, -119.69833501652823, -515.2721565765952, -551.0737258731845, 179.21000000000004, -103.39546536793549, 116.77670503171022, 189.2238384777739, -31.43680850651815, 158.31840985200006, -66.98601232214189, -115.08364651167622, 168.86857780226728, 179.6383581121658, 124.37051105121955, -9.615392323924985, 51.99269261702527, 171.95738698709002, 183.19350175959732, 191.2111057355305, 160.98474375545055, -3.319059248684499, 31.31293555153355, 29.850941919264518, -170.20468040283603, -21.516519521436532, 145.10353525785686, 159.16089785427647, 175.12231075349723, 171.9861128248175, 76.78326594756597, -95.71688401373748, 2.0000000000000013, 119.48156474896096, -9.783517009123841, 165.98193631416143, -114.30685299437452, -6.98401912359347, 120.57849403794572, 2.0000000000000013, 80.95319930665897, 178.35937832391704, 179.9123324627337, -44.77780680371994, 1.035362814811421, -9.03392880332161, 2.0000000000000013, 151.17614563608237, -352.06134303315866, -26.783202157293832, -294.18897244217317, -409.2232710783713, 175.5779364127658, 166.9116297131081, 156.6467844033604, 139.05155679420665, 165.3499999999999, -64.57131411241471, -47.97007060650208, 126.38025925803086, -194.20048736784986, 184.03387353586848, 145.07740883264353, 94.60683888375803, 140.5926666205412, 121.48922731606919, -0.39715670349163434, -10.193619207695516, -50.70371148872361, -84.34473282995555, 88.13812337601681, -11.526169090343522, 177.0771361591593, 125.68889298393748, -14.956864688917953, 157.12621737517298, -106.79435811253818, 143.30426354376058, -191.13543896010344, -9.987897714391245, 172.5957023038083, 97.92932349275738, 120.53452460754994, 4.0046011158483985, -250.32998152118026, -214.05949680145898, 129.42017051100237, 142.9254590251498, -95.42620357210956, -51.43451591866504, 0.7482095130278629, -410.69885879831776, -194.81479359471564, 141.80029029474014, 174.4431531829643, 169.38035244200108, -92.79754034159545, 48.68074693336846, 181.27657746948543, -29.910459442086196, 75.2154393729687, -7.065546278603307, 103.22268505061172, -24.925660379442704, 75.73546187650261, 132.33320294477596, -45.25476436211873, 148.95141607103756], "policy_predator_policy_reward": [16.143273330876564, 3.9312264272061794, 74.93554638108309, 15.052138225662468, 0.0, 18.07284664001865, 37.89460686481927, 80.66457124756626, 64.93737593217973, 79.50254219685431, 7.678085339229261, 12.702029421108154, 18.64951467237022, 0.0, 123.20807498842778, 98.62376889237578, 13.635642886547297, 1.8143538514041153, 5.929991574479681, 102.91970381854581, 2.2808285956910437, 28.60326325948914, 28.231951123618884, 8.068365743580765, 207.59048639892882, 51.88697971448823, 72.5506258109093, 1.2148947920821884, 106.62366454579856, 11.733740726196437, 1.1811340446185647, 88.2310669589947, 5.071310044132968, 479.6244984150183, 0.8174141529102696, 2.0237272637899175, 5.9831730099106455, 10.863694720779646, 10.79096850696964, 3.056866327957625, 30.3562402488013, 103.67699844184611, 8.725938065635354, 0.8963042596263356, 15.02179758999782, 6.633755592497308, 55.08189655337725, 42.25890407395356, 12.657009899742114, 62.38493223332102, 88.33212411155868, 13.085438059553084, 93.19379586493349, 122.79913915846629, 7.3874485143497814, 3.469097631030847, 0.768871301763856, 261.01916722789286, 24.284845453732064, 34.51289239907376, 11.211802837016528, 0.9891109966629203, 213.71570544785803, 52.732233367360905, 4.71749326115292, 18.23946635936976, 66.79736738629651, 108.99510777788625, 5.944999986090992, 12.937111275279007, 114.97212535960801, 114.8519250545582, 19.438103863765825, 8.636073752203211, 593.5154553130867, 4.431398280508519, 127.4507691354066, 10.787989451599145, 21.14943139255903, 1.2464112157697447, 0.8234047387214102, 25.887937366440724, 13.53330922103809, 26.641175053153425, 59.852233346115945, 54.157047594748114, 9.109068405993938, 22.11758848170495, 76.82659040190244, 40.069016572728906, 3.265563379862415, 54.80584418015505, 130.8089684101578, 131.08998390911165, 4.940203648781722, 714.2073588936861, 0.0, 105.16546536793639, 61.273294968289804, 3.8061615222260885, 33.19680850651801, 6.951590147999973, 16.318687571407196, 281.75645769742766, 20.151422197732742, 9.24608824889752, 55.69948894878046, 11.555392323924943, 7.716173287928518, 80.50374710795624, 3.8964982404026456, 0.8588942644695223, 0.9867188041741466, 9.313775331864257, 6.823414935512986, 120.99330248341015, 4.9653499345760475, 278.685849989697, 26.09646474214315, 22.949102145723483, 10.314081904356224, 5.7974945173290955, 73.08211416323584, 34.72882577775466, 7.01158753360716, 32.726847717431916, 131.7835170091238, 4.288063685838651, 115.86685299437532, 8.934019123593428, 41.511505962054315, 7.060691121287883, 61.16680069334108, 3.7806216760830305, 5.21766753726622, 46.4978068037196, 0.9546371851885804, 10.92392880332157, 0.0, 29.863854363917657, 369.06134303315866, 28.673202157294128, 402.076711740724, 214.0342686850168, 11.472063587234151, 4.783160265745005, 2.328209896003586, 38.25482620597691, 194.26519193628667, 2.3561221761280553, 48.74618713001913, 43.24232177511685, 310.2404873678498, 4.056126464131456, 9.322591167356517, 58.433161116241955, 5.907333379458871, 39.5107726839308, 2.377156703491628, 12.093619207695475, 2.005954832156885, 146.1834282811284, 64.84268521404645, 146.44204380347603, 8.191829091066332, 7.492566016510192, 16.826864688917954, 17.033782624827058, 209.30698937138075, 127.4670736752126, 191.57543896010344, 159.58792309751536, 14.414297696191678, 40.34067650724261, 34.51014046288734, 119.9584948457536, 254.70864112120728, 245.1094968014589, 16.50261910675777, 16.233359033751007, 252.8820982676392, 3.628621223135466, 349.9642367820646, 66.97641250322529, 272.3578768322101, 178.67958720139782, 5.716846817035681, 1.8896475579987673, 91.22193346494912, 54.836746619485396, 1.8734225305146284, 31.840459442086498, 44.20456062703125, 29.615546278603553, 48.0473149493883, 26.76566037944299, 43.068047020970305, 36.36899622649625, 46.8547643621184, 25.218583928962513]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8054147644913732, "mean_inference_ms": 2.4765017058625376, "mean_action_processing_ms": 0.35691116943484547, "mean_env_wait_ms": 0.2795836233522399, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004550814628601074, "StateBufferConnector_ms": 0.003264188766479492, "ViewRequirementAgentConnector_ms": 0.14350008964538574}, "num_episodes": 22, "episode_return_max": 398.0229607336323, "episode_return_min": -347.19831990731274, "episode_return_mean": 171.92070864777816, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 255.0792648952582, "num_env_steps_trained_throughput_per_sec": 255.0792648952582, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 15174.24, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15174.188, "sample_time_ms": 1864.402, "learn_time_ms": 13281.123, "learn_throughput": 301.179, "synch_weights_time_ms": 25.666}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 40, "trial_id": "61e09_00000", "date": "2024-08-16_16-16-45", "timestamp": 1723805205, "time_this_iter_s": 15.745362758636475, "time_total_s": 606.141078710556, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24af040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 606.141078710556, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 61.1409090909091, "ram_util_percent": 81.90454545454544}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4386107098803949, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 0.00010000000000000003, "total_loss": 2.0932726155513177, "policy_loss": -0.003994464133644388, "vf_loss": 2.0966075485345548, "vf_explained_var": 0.02178743522633951, "kl": 0.008793701959925767, "entropy": 0.7327781870251611, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.336345310564394, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.871558213360095, "policy_loss": -0.0039299695801837415, "vf_loss": 5.873459917653805, "vf_explained_var": 0.017566665928199807, "kl": 0.010141238112781689, "entropy": 1.3704688096172595, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 398.0229607336323, "episode_reward_min": -347.19831990731274, "episode_reward_mean": 173.4935711402214, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -595.0203801421802, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 191.2111057355305, "predator_policy": 714.2073588936861}, "policy_reward_mean": {"prey_policy": 18.36832076928531, "predator_policy": 68.37846480082545}, "custom_metrics": {}, "hist_stats": {"episode_reward": [170.70000000000005, 167.83999999999992, 186.75999999999968, 184.3124033401278, 368.2499999999999, 54.14999999999997, 148.18000000000012, 176.13999999999987, 33.81000000000004, 3.8599999999999612, 3.119999999999981, 348.87613447403453, 114.55402897992799, 349.25999999999993, 41.740184501159355, 86.13000000000014, -6.8739332654557845, 164.11000000000007, 45.35999999999998, 198.46560137711907, 163.16999999999996, 200.4520530764268, 189.94556337986188, 116.40066749425652, -347.19831990731274, 180.97999999999985, 371.0799999999999, 167.03000000000003, 116.00548643501656, 377.90444636106326, 182.00999999999974, 312.16999999999985, 379.1599999999999, 167.96617864280424, 188.98059488972115, 91.93000000000025, 353.3099999999999, 363.22, 88.87732187481842, 161.2199999999998, 292.27, 3.5099999999999665, 171.15069112128765, 324.2599999999998, 186.84999999999957, 3.8799999999999617, 183.03999999999974, 18.889999999999965, -87.30126309480376, 358.74478997885296, 336.28137729954744, 297.3999999999998, 170.3986975566644, 304.1299999999999, 307.4399999999999, 307.49999999999994, 3.8799999999999613, 13.140938794606493, 287.8966833031958, 318.45042425067317, 176.03000000000003, 373.2839684778155, 150.04002538312417, 325.27999999999986, 279.0077610320391, 35.42865960002828, 305.0816076766607, 109.65000000000008, 6.989999999999959, 398.0229607336323, 351.4299999999997, 101.94188667620706, 185.07999999999987, 141.97000000000043, 153.1100000000001, 287.5057080687453, 175.76999999999998, 78.55640205691408, 155.60000000000014, 296.72103408010827, 265.1999999999997, 332.3199999999998, 341.8767850749507, 3.599999999999967, 146.41031548843313, 143.32, 172.13999999999993, 162.27999999999992, 316.2517340269862, -304.2501225993146, 185.08102270913582, 157.97000000000003, 269.229277184135, 127.16814453534107, 166.79999999999953, 303.35, -335.6408070463936, 139.48000000000044, 32.04, 173.05999999999992], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-80.77875305176639, 154.1379524244353, 142.85056272081684, -50.052504853880244, -84.50669940695705, 169.84913723584617, -19.208376959175776, -12.472154724095347, 179.71255148565018, 177.68090236896916, 1.2211286982361453, -208.8591672278929, -15.99172218648061, 105.37398433367512, -2.7276611392605465, 166.66674730558105, -181.71570544785789, -50.922233367361265, -0.9856460712182895, -18.111313549304118, -65.07736738629563, -107.59510777788553, 170.6911344879436, 159.302888724721, -48.46615750795159, -66.80386392628566, 155.0359241139936, 166.1498982700374, -130.4401723400286, -425.7664967524088, -43.23076913540667, -8.877989451599184, -10.582276747246322, -18.687499126537894, 1.1665952612785913, 136.23206263355934, -11.603309221038131, 16.7888249468468, 85.06820034939494, -0.6118799131393289, 148.1779097305519, -16.234566618250525, -77.77644663865986, 161.3328927404567, 185.14999999999986, -53.27584418015535, -25.79994980848507, -119.69833501652823, -515.2721565765952, -551.0737258731845, 179.21000000000004, -103.39546536793549, 116.77670503171022, 189.2238384777739, -31.43680850651815, 158.31840985200006, -66.98601232214189, -115.08364651167622, 168.86857780226728, 179.6383581121658, 124.37051105121955, -9.615392323924985, 51.99269261702527, 171.95738698709002, 183.19350175959732, 191.2111057355305, 160.98474375545055, -3.319059248684499, 31.31293555153355, 29.850941919264518, -170.20468040283603, -21.516519521436532, 145.10353525785686, 159.16089785427647, 175.12231075349723, 171.9861128248175, 76.78326594756597, -95.71688401373748, 2.0000000000000013, 119.48156474896096, -9.783517009123841, 165.98193631416143, -114.30685299437452, -6.98401912359347, 120.57849403794572, 2.0000000000000013, 80.95319930665897, 178.35937832391704, 179.9123324627337, -44.77780680371994, 1.035362814811421, -9.03392880332161, 2.0000000000000013, 151.17614563608237, -352.06134303315866, -26.783202157293832, -294.18897244217317, -409.2232710783713, 175.5779364127658, 166.9116297131081, 156.6467844033604, 139.05155679420665, 165.3499999999999, -64.57131411241471, -47.97007060650208, 126.38025925803086, -194.20048736784986, 184.03387353586848, 145.07740883264353, 94.60683888375803, 140.5926666205412, 121.48922731606919, -0.39715670349163434, -10.193619207695516, -50.70371148872361, -84.34473282995555, 88.13812337601681, -11.526169090343522, 177.0771361591593, 125.68889298393748, -14.956864688917953, 157.12621737517298, -106.79435811253818, 143.30426354376058, -191.13543896010344, -9.987897714391245, 172.5957023038083, 97.92932349275738, 120.53452460754994, 4.0046011158483985, -250.32998152118026, -214.05949680145898, 129.42017051100237, 142.9254590251498, -95.42620357210956, -51.43451591866504, 0.7482095130278629, -410.69885879831776, -194.81479359471564, 141.80029029474014, 174.4431531829643, 169.38035244200108, -92.79754034159545, 48.68074693336846, 181.27657746948543, -29.910459442086196, 75.2154393729687, -7.065546278603307, 103.22268505061172, -24.925660379442704, 75.73546187650261, 132.33320294477596, -45.25476436211873, 148.95141607103756, -221.24795963875573, -37.05935455786761, 62.52816332929583, -67.52006424055477, 151.28423187248856, 114.73462114780243, 134.39568015473702, 107.50697125564572, 109.8603809325428, 171.58704137772094, 174.8566427301695, 149.26412673413876, -58.908759658677006, -6.415621542407758, -0.009994348308114536, 96.36756415855368, 118.41622774493065, -12.472627306140668, 156.69454941874693, 0.022536260611007178, 144.43452080720039, 2.0000000000000013, 105.11164111445416, 176.91264323178137, -484.50272521030865, -460.14713782936747, 145.39068189695104, 0.09296206833304543, -2.5675690817621506, 85.03297124403005, 122.563858406211, 139.89276233700141, -72.63672884506798, 29.61999354476081, -79.99953689080614, 164.39130163150784, 83.71669263213569, 67.21149271821092, -465.48280287495237, -595.0203801421802, 118.72129701812834, 1.0757171648776191, -55.120727993629785, -38.45457873663368, -22.558319552761983, 153.84097073054505], "policy_predator_policy_reward": [55.08189655337725, 42.25890407395356, 12.657009899742114, 62.38493223332102, 88.33212411155868, 13.085438059553084, 93.19379586493349, 122.79913915846629, 7.3874485143497814, 3.469097631030847, 0.768871301763856, 261.01916722789286, 24.284845453732064, 34.51289239907376, 11.211802837016528, 0.9891109966629203, 213.71570544785803, 52.732233367360905, 4.71749326115292, 18.23946635936976, 66.79736738629651, 108.99510777788625, 5.944999986090992, 12.937111275279007, 114.97212535960801, 114.8519250545582, 19.438103863765825, 8.636073752203211, 593.5154553130867, 4.431398280508519, 127.4507691354066, 10.787989451599145, 21.14943139255903, 1.2464112157697447, 0.8234047387214102, 25.887937366440724, 13.53330922103809, 26.641175053153425, 59.852233346115945, 54.157047594748114, 9.109068405993938, 22.11758848170495, 76.82659040190244, 40.069016572728906, 3.265563379862415, 54.80584418015505, 130.8089684101578, 131.08998390911165, 4.940203648781722, 714.2073588936861, 0.0, 105.16546536793639, 61.273294968289804, 3.8061615222260885, 33.19680850651801, 6.951590147999973, 16.318687571407196, 281.75645769742766, 20.151422197732742, 9.24608824889752, 55.69948894878046, 11.555392323924943, 7.716173287928518, 80.50374710795624, 3.8964982404026456, 0.8588942644695223, 0.9867188041741466, 9.313775331864257, 6.823414935512986, 120.99330248341015, 4.9653499345760475, 278.685849989697, 26.09646474214315, 22.949102145723483, 10.314081904356224, 5.7974945173290955, 73.08211416323584, 34.72882577775466, 7.01158753360716, 32.726847717431916, 131.7835170091238, 4.288063685838651, 115.86685299437532, 8.934019123593428, 41.511505962054315, 7.060691121287883, 61.16680069334108, 3.7806216760830305, 5.21766753726622, 46.4978068037196, 0.9546371851885804, 10.92392880332157, 0.0, 29.863854363917657, 369.06134303315866, 28.673202157294128, 402.076711740724, 214.0342686850168, 11.472063587234151, 4.783160265745005, 2.328209896003586, 38.25482620597691, 194.26519193628667, 2.3561221761280553, 48.74618713001913, 43.24232177511685, 310.2404873678498, 4.056126464131456, 9.322591167356517, 58.433161116241955, 5.907333379458871, 39.5107726839308, 2.377156703491628, 12.093619207695475, 2.005954832156885, 146.1834282811284, 64.84268521404645, 146.44204380347603, 8.191829091066332, 7.492566016510192, 16.826864688917954, 17.033782624827058, 209.30698937138075, 127.4670736752126, 191.57543896010344, 159.58792309751536, 14.414297696191678, 40.34067650724261, 34.51014046288734, 119.9584948457536, 254.70864112120728, 245.1094968014589, 16.50261910675777, 16.233359033751007, 252.8820982676392, 3.628621223135466, 349.9642367820646, 66.97641250322529, 272.3578768322101, 178.67958720139782, 5.716846817035681, 1.8896475579987673, 91.22193346494912, 54.836746619485396, 1.8734225305146284, 31.840459442086498, 44.20456062703125, 29.615546278603553, 48.0473149493883, 26.76566037944299, 43.068047020970305, 36.36899622649625, 46.8547643621184, 25.218583928962513, 298.0325092756611, 38.83120697787623, 91.56183667070417, 69.0300642405548, 10.545289693608556, 20.156891366208832, 6.116129973385807, 17.181218616231273, 44.29961906745719, 6.572958622278907, 17.756015610642837, 0.0, 0.0, 68.92438120108443, 5.210309836740905, 44.84243584144639, 22.993772255069423, 14.382627306140627, 13.465450581253041, 1.9574637393889944, 15.84547919279969, 0.0, 11.95006250645024, 22.277387174300873, 627.1778132899476, 13.221927150412881, 24.62679391698771, 14.970584826864332, 73.57070368362821, 1.9338941541038772, 1.1554187779250824, 5.6172376629987655, 82.56550995144791, 87.61936988420048, 23.558127452436214, 58.85010780686256, 65.56330736786435, 86.85850728178907, 15.030144971878093, 709.8322309988614, 18.768702981871908, 0.9142828351223822, 7.682625882773185, 117.93268084748992, 25.44831955276228, 16.329029269454978]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8052886509736779, "mean_inference_ms": 2.4886445129748287, "mean_action_processing_ms": 0.3573854431733249, "mean_env_wait_ms": 0.28008564934360336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004198908805847168, "StateBufferConnector_ms": 0.0031851530075073242, "ViewRequirementAgentConnector_ms": 0.13433873653411865}, "num_episodes": 23, "episode_return_max": 398.0229607336323, "episode_return_min": -347.19831990731274, "episode_return_mean": 173.4935711402214, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.3888489846367, "num_env_steps_trained_throughput_per_sec": 267.3888489846367, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 15152.54, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15152.486, "sample_time_ms": 1857.974, "learn_time_ms": 13265.312, "learn_throughput": 301.538, "synch_weights_time_ms": 26.298}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 41, "trial_id": "61e09_00000", "date": "2024-08-16_16-17-00", "timestamp": 1723805220, "time_this_iter_s": 15.02986192703247, "time_total_s": 621.1709406375885, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b55f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 621.1709406375885, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 62.08636363636364, "ram_util_percent": 81.67272727272729}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.43089521930962, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 0.00010000000000000003, "total_loss": 2.094294613852072, "policy_loss": -0.006248450514653491, "vf_loss": 2.099598881886119, "vf_explained_var": 0.0431463637049236, "kl": 0.01258899573416513, "entropy": 0.8655470446934775, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.446560088288847, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.617328749510346, "policy_loss": -0.009540186165807344, "vf_loss": 6.623557214888315, "vf_explained_var": 0.20789003444727136, "kl": 0.016558672831511686, "entropy": 1.345550198529763, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 398.0229607336323, "episode_reward_min": -347.19831990731274, "episode_reward_mean": 178.9825932030856, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -595.0203801421802, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 191.2111057355305, "predator_policy": 714.2073588936861}, "policy_reward_mean": {"prey_policy": 23.611275916789182, "predator_policy": 65.88002068475369}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.35999999999998, 198.46560137711907, 163.16999999999996, 200.4520530764268, 189.94556337986188, 116.40066749425652, -347.19831990731274, 180.97999999999985, 371.0799999999999, 167.03000000000003, 116.00548643501656, 377.90444636106326, 182.00999999999974, 312.16999999999985, 379.1599999999999, 167.96617864280424, 188.98059488972115, 91.93000000000025, 353.3099999999999, 363.22, 88.87732187481842, 161.2199999999998, 292.27, 3.5099999999999665, 171.15069112128765, 324.2599999999998, 186.84999999999957, 3.8799999999999617, 183.03999999999974, 18.889999999999965, -87.30126309480376, 358.74478997885296, 336.28137729954744, 297.3999999999998, 170.3986975566644, 304.1299999999999, 307.4399999999999, 307.49999999999994, 3.8799999999999613, 13.140938794606493, 287.8966833031958, 318.45042425067317, 176.03000000000003, 373.2839684778155, 150.04002538312417, 325.27999999999986, 279.0077610320391, 35.42865960002828, 305.0816076766607, 109.65000000000008, 6.989999999999959, 398.0229607336323, 351.4299999999997, 101.94188667620706, 185.07999999999987, 141.97000000000043, 153.1100000000001, 287.5057080687453, 175.76999999999998, 78.55640205691408, 155.60000000000014, 296.72103408010827, 265.1999999999997, 332.3199999999998, 341.8767850749507, 3.599999999999967, 146.41031548843313, 143.32, 172.13999999999993, 162.27999999999992, 316.2517340269862, -304.2501225993146, 185.08102270913582, 157.97000000000003, 269.229277184135, 127.16814453534107, 166.79999999999953, 303.35, -335.6408070463936, 139.48000000000044, 32.04, 173.05999999999992, 3.1499999999999755, 84.5046598045429, 316.7299999999999, 277.05096657107106, 120.52000000000082, 89.11000000000008, 336.39999999999986, 364.17921744326065, 229.68999999999903, 329.2999999999999, 63.929999999999595, 20.349999999999994, 148.24075977682008, 284.7599999999995, 253.61000000000018, 109.27542072052262, 18.690000000000214, 94.33000000000028], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-11.603309221038131, 16.7888249468468, 85.06820034939494, -0.6118799131393289, 148.1779097305519, -16.234566618250525, -77.77644663865986, 161.3328927404567, 185.14999999999986, -53.27584418015535, -25.79994980848507, -119.69833501652823, -515.2721565765952, -551.0737258731845, 179.21000000000004, -103.39546536793549, 116.77670503171022, 189.2238384777739, -31.43680850651815, 158.31840985200006, -66.98601232214189, -115.08364651167622, 168.86857780226728, 179.6383581121658, 124.37051105121955, -9.615392323924985, 51.99269261702527, 171.95738698709002, 183.19350175959732, 191.2111057355305, 160.98474375545055, -3.319059248684499, 31.31293555153355, 29.850941919264518, -170.20468040283603, -21.516519521436532, 145.10353525785686, 159.16089785427647, 175.12231075349723, 171.9861128248175, 76.78326594756597, -95.71688401373748, 2.0000000000000013, 119.48156474896096, -9.783517009123841, 165.98193631416143, -114.30685299437452, -6.98401912359347, 120.57849403794572, 2.0000000000000013, 80.95319930665897, 178.35937832391704, 179.9123324627337, -44.77780680371994, 1.035362814811421, -9.03392880332161, 2.0000000000000013, 151.17614563608237, -352.06134303315866, -26.783202157293832, -294.18897244217317, -409.2232710783713, 175.5779364127658, 166.9116297131081, 156.6467844033604, 139.05155679420665, 165.3499999999999, -64.57131411241471, -47.97007060650208, 126.38025925803086, -194.20048736784986, 184.03387353586848, 145.07740883264353, 94.60683888375803, 140.5926666205412, 121.48922731606919, -0.39715670349163434, -10.193619207695516, -50.70371148872361, -84.34473282995555, 88.13812337601681, -11.526169090343522, 177.0771361591593, 125.68889298393748, -14.956864688917953, 157.12621737517298, -106.79435811253818, 143.30426354376058, -191.13543896010344, -9.987897714391245, 172.5957023038083, 97.92932349275738, 120.53452460754994, 4.0046011158483985, -250.32998152118026, -214.05949680145898, 129.42017051100237, 142.9254590251498, -95.42620357210956, -51.43451591866504, 0.7482095130278629, -410.69885879831776, -194.81479359471564, 141.80029029474014, 174.4431531829643, 169.38035244200108, -92.79754034159545, 48.68074693336846, 181.27657746948543, -29.910459442086196, 75.2154393729687, -7.065546278603307, 103.22268505061172, -24.925660379442704, 75.73546187650261, 132.33320294477596, -45.25476436211873, 148.95141607103756, -221.24795963875573, -37.05935455786761, 62.52816332929583, -67.52006424055477, 151.28423187248856, 114.73462114780243, 134.39568015473702, 107.50697125564572, 109.8603809325428, 171.58704137772094, 174.8566427301695, 149.26412673413876, -58.908759658677006, -6.415621542407758, -0.009994348308114536, 96.36756415855368, 118.41622774493065, -12.472627306140668, 156.69454941874693, 0.022536260611007178, 144.43452080720039, 2.0000000000000013, 105.11164111445416, 176.91264323178137, -484.50272521030865, -460.14713782936747, 145.39068189695104, 0.09296206833304543, -2.5675690817621506, 85.03297124403005, 122.563858406211, 139.89276233700141, -72.63672884506798, 29.61999354476081, -79.99953689080614, 164.39130163150784, 83.71669263213569, 67.21149271821092, -465.48280287495237, -595.0203801421802, 118.72129701812834, 1.0757171648776191, -55.120727993629785, -38.45457873663368, -22.558319552761983, 153.84097073054505, 2.0000000000000013, -330.27921311138255, 2.0000000000000013, 57.606349569034485, 184.58912285919587, 115.89697948277208, -34.890416501871286, 103.9189983098108, 56.920055960708176, -4.367649331402644, 86.30265492248444, -1.1254477011545427, 163.07590328512885, 142.57448857161694, 164.95471499404545, 169.31000000000003, 106.6559379628702, 119.57539932173933, 115.23465128577098, 153.88684768280473, -4.754705718134918, -10.330179793153494, 17.961886412434517, -326.4261261189024, 108.85313381497903, -12.746428817784668, 112.13995717489628, 126.21739018695726, 30.698392556707596, 111.49934999541826, -26.596165433314212, 6.0001537368660465, -86.5881056361753, -138.3334973883474, -5.33086231535003, 6.699291209352426], "policy_predator_policy_reward": [13.53330922103809, 26.641175053153425, 59.852233346115945, 54.157047594748114, 9.109068405993938, 22.11758848170495, 76.82659040190244, 40.069016572728906, 3.265563379862415, 54.80584418015505, 130.8089684101578, 131.08998390911165, 4.940203648781722, 714.2073588936861, 0.0, 105.16546536793639, 61.273294968289804, 3.8061615222260885, 33.19680850651801, 6.951590147999973, 16.318687571407196, 281.75645769742766, 20.151422197732742, 9.24608824889752, 55.69948894878046, 11.555392323924943, 7.716173287928518, 80.50374710795624, 3.8964982404026456, 0.8588942644695223, 0.9867188041741466, 9.313775331864257, 6.823414935512986, 120.99330248341015, 4.9653499345760475, 278.685849989697, 26.09646474214315, 22.949102145723483, 10.314081904356224, 5.7974945173290955, 73.08211416323584, 34.72882577775466, 7.01158753360716, 32.726847717431916, 131.7835170091238, 4.288063685838651, 115.86685299437532, 8.934019123593428, 41.511505962054315, 7.060691121287883, 61.16680069334108, 3.7806216760830305, 5.21766753726622, 46.4978068037196, 0.9546371851885804, 10.92392880332157, 0.0, 29.863854363917657, 369.06134303315866, 28.673202157294128, 402.076711740724, 214.0342686850168, 11.472063587234151, 4.783160265745005, 2.328209896003586, 38.25482620597691, 194.26519193628667, 2.3561221761280553, 48.74618713001913, 43.24232177511685, 310.2404873678498, 4.056126464131456, 9.322591167356517, 58.433161116241955, 5.907333379458871, 39.5107726839308, 2.377156703491628, 12.093619207695475, 2.005954832156885, 146.1834282811284, 64.84268521404645, 146.44204380347603, 8.191829091066332, 7.492566016510192, 16.826864688917954, 17.033782624827058, 209.30698937138075, 127.4670736752126, 191.57543896010344, 159.58792309751536, 14.414297696191678, 40.34067650724261, 34.51014046288734, 119.9584948457536, 254.70864112120728, 245.1094968014589, 16.50261910675777, 16.233359033751007, 252.8820982676392, 3.628621223135466, 349.9642367820646, 66.97641250322529, 272.3578768322101, 178.67958720139782, 5.716846817035681, 1.8896475579987673, 91.22193346494912, 54.836746619485396, 1.8734225305146284, 31.840459442086498, 44.20456062703125, 29.615546278603553, 48.0473149493883, 26.76566037944299, 43.068047020970305, 36.36899622649625, 46.8547643621184, 25.218583928962513, 298.0325092756611, 38.83120697787623, 91.56183667070417, 69.0300642405548, 10.545289693608556, 20.156891366208832, 6.116129973385807, 17.181218616231273, 44.29961906745719, 6.572958622278907, 17.756015610642837, 0.0, 0.0, 68.92438120108443, 5.210309836740905, 44.84243584144639, 22.993772255069423, 14.382627306140627, 13.465450581253041, 1.9574637393889944, 15.84547919279969, 0.0, 11.95006250645024, 22.277387174300873, 627.1778132899476, 13.221927150412881, 24.62679391698771, 14.970584826864332, 73.57070368362821, 1.9338941541038772, 1.1554187779250824, 5.6172376629987655, 82.56550995144791, 87.61936988420048, 23.558127452436214, 58.85010780686256, 65.56330736786435, 86.85850728178907, 15.030144971878093, 709.8322309988614, 18.768702981871908, 0.9142828351223822, 7.682625882773185, 117.93268084748992, 25.44831955276228, 16.329029269454978, 0.0, 331.4292131113824, 12.261035390943789, 12.637274844564349, 4.480877140804145, 11.763020517227899, 118.41518918437889, 89.60719557875315, 8.472884832389283, 59.49470853830503, 0.8273450775153991, 3.10544770115452, 12.064096714871066, 18.68551142838303, 3.8492174432606534, 26.06528500595456, 2.2440620371297406, 1.2146006782610157, 31.045348714229107, 29.13315231719526, 66.7847057181349, 12.230179793153454, 1.8381135875654868, 326.9761261189023, 23.776403242199656, 28.357651537426026, 40.98004282510373, 5.422609813042984, 68.69160744329231, 42.720650004581756, 13.530912100390434, 116.34052031658048, 200.4100230858231, 43.20157993870056, 26.88086231535003, 66.0807087906476]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8042374529714057, "mean_inference_ms": 2.4873266880559246, "mean_action_processing_ms": 0.3563493887332807, "mean_env_wait_ms": 0.28014547058870076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041942596435546875, "StateBufferConnector_ms": 0.003195047378540039, "ViewRequirementAgentConnector_ms": 0.12417614459991455}, "num_episodes": 18, "episode_return_max": 398.0229607336323, "episode_return_min": -347.19831990731274, "episode_return_mean": 178.9825932030856, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.7781612986006, "num_env_steps_trained_throughput_per_sec": 267.7781612986006, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 15064.664, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15064.61, "sample_time_ms": 1850.014, "learn_time_ms": 13185.608, "learn_throughput": 303.361, "synch_weights_time_ms": 25.639}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 42, "trial_id": "61e09_00000", "date": "2024-08-16_16-17-15", "timestamp": 1723805235, "time_this_iter_s": 14.994282007217407, "time_total_s": 636.1652226448059, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b23ae790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 636.1652226448059, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 61.709523809523816, "ram_util_percent": 82.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.282360978826644, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 0.00010000000000000003, "total_loss": 3.224723328736724, "policy_loss": -0.006627219124628162, "vf_loss": 3.230574830499276, "vf_explained_var": 0.08393953117744002, "kl": 0.01034294603472721, "entropy": 0.7077037452389954, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.109531516814358, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.684324687120145, "policy_loss": -0.007823856669064197, "vf_loss": 6.689547078067033, "vf_explained_var": 0.42658247585019105, "kl": 0.013007304276013373, "entropy": 1.3008151897677669, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 398.0229607336323, "episode_reward_min": -335.6408070463936, "episode_reward_mean": 180.3055364062744, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -595.0203801421802, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 184.58912285919587, "predator_policy": 709.8322309988614}, "policy_reward_mean": {"prey_policy": 25.670984184467716, "predator_policy": 64.48178401866953}, "custom_metrics": {}, "hist_stats": {"episode_reward": [353.3099999999999, 363.22, 88.87732187481842, 161.2199999999998, 292.27, 3.5099999999999665, 171.15069112128765, 324.2599999999998, 186.84999999999957, 3.8799999999999617, 183.03999999999974, 18.889999999999965, -87.30126309480376, 358.74478997885296, 336.28137729954744, 297.3999999999998, 170.3986975566644, 304.1299999999999, 307.4399999999999, 307.49999999999994, 3.8799999999999613, 13.140938794606493, 287.8966833031958, 318.45042425067317, 176.03000000000003, 373.2839684778155, 150.04002538312417, 325.27999999999986, 279.0077610320391, 35.42865960002828, 305.0816076766607, 109.65000000000008, 6.989999999999959, 398.0229607336323, 351.4299999999997, 101.94188667620706, 185.07999999999987, 141.97000000000043, 153.1100000000001, 287.5057080687453, 175.76999999999998, 78.55640205691408, 155.60000000000014, 296.72103408010827, 265.1999999999997, 332.3199999999998, 341.8767850749507, 3.599999999999967, 146.41031548843313, 143.32, 172.13999999999993, 162.27999999999992, 316.2517340269862, -304.2501225993146, 185.08102270913582, 157.97000000000003, 269.229277184135, 127.16814453534107, 166.79999999999953, 303.35, -335.6408070463936, 139.48000000000044, 32.04, 173.05999999999992, 3.1499999999999755, 84.5046598045429, 316.7299999999999, 277.05096657107106, 120.52000000000082, 89.11000000000008, 336.39999999999986, 364.17921744326065, 229.68999999999903, 329.2999999999999, 63.929999999999595, 20.349999999999994, 148.24075977682008, 284.7599999999995, 253.61000000000018, 109.27542072052262, 18.690000000000214, 94.33000000000028, 280.8899999999999, 246.90000000000006, 209.1205223580459, 265.47999999999985, 320.4799999999999, 315.14337419708005, 89.38002380942754, 78.33611652351689, 280.0054249862356, 182.08999999999975, 3.4199999999999715, 245.8267477300629, 132.8395322025684, 150.31000000000034, 276.19485026089717, 3.4799999999999693, 113.02000000000093, 41.19000000000008], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [145.10353525785686, 159.16089785427647, 175.12231075349723, 171.9861128248175, 76.78326594756597, -95.71688401373748, 2.0000000000000013, 119.48156474896096, -9.783517009123841, 165.98193631416143, -114.30685299437452, -6.98401912359347, 120.57849403794572, 2.0000000000000013, 80.95319930665897, 178.35937832391704, 179.9123324627337, -44.77780680371994, 1.035362814811421, -9.03392880332161, 2.0000000000000013, 151.17614563608237, -352.06134303315866, -26.783202157293832, -294.18897244217317, -409.2232710783713, 175.5779364127658, 166.9116297131081, 156.6467844033604, 139.05155679420665, 165.3499999999999, -64.57131411241471, -47.97007060650208, 126.38025925803086, -194.20048736784986, 184.03387353586848, 145.07740883264353, 94.60683888375803, 140.5926666205412, 121.48922731606919, -0.39715670349163434, -10.193619207695516, -50.70371148872361, -84.34473282995555, 88.13812337601681, -11.526169090343522, 177.0771361591593, 125.68889298393748, -14.956864688917953, 157.12621737517298, -106.79435811253818, 143.30426354376058, -191.13543896010344, -9.987897714391245, 172.5957023038083, 97.92932349275738, 120.53452460754994, 4.0046011158483985, -250.32998152118026, -214.05949680145898, 129.42017051100237, 142.9254590251498, -95.42620357210956, -51.43451591866504, 0.7482095130278629, -410.69885879831776, -194.81479359471564, 141.80029029474014, 174.4431531829643, 169.38035244200108, -92.79754034159545, 48.68074693336846, 181.27657746948543, -29.910459442086196, 75.2154393729687, -7.065546278603307, 103.22268505061172, -24.925660379442704, 75.73546187650261, 132.33320294477596, -45.25476436211873, 148.95141607103756, -221.24795963875573, -37.05935455786761, 62.52816332929583, -67.52006424055477, 151.28423187248856, 114.73462114780243, 134.39568015473702, 107.50697125564572, 109.8603809325428, 171.58704137772094, 174.8566427301695, 149.26412673413876, -58.908759658677006, -6.415621542407758, -0.009994348308114536, 96.36756415855368, 118.41622774493065, -12.472627306140668, 156.69454941874693, 0.022536260611007178, 144.43452080720039, 2.0000000000000013, 105.11164111445416, 176.91264323178137, -484.50272521030865, -460.14713782936747, 145.39068189695104, 0.09296206833304543, -2.5675690817621506, 85.03297124403005, 122.563858406211, 139.89276233700141, -72.63672884506798, 29.61999354476081, -79.99953689080614, 164.39130163150784, 83.71669263213569, 67.21149271821092, -465.48280287495237, -595.0203801421802, 118.72129701812834, 1.0757171648776191, -55.120727993629785, -38.45457873663368, -22.558319552761983, 153.84097073054505, 2.0000000000000013, -330.27921311138255, 2.0000000000000013, 57.606349569034485, 184.58912285919587, 115.89697948277208, -34.890416501871286, 103.9189983098108, 56.920055960708176, -4.367649331402644, 86.30265492248444, -1.1254477011545427, 163.07590328512885, 142.57448857161694, 164.95471499404545, 169.31000000000003, 106.6559379628702, 119.57539932173933, 115.23465128577098, 153.88684768280473, -4.754705718134918, -10.330179793153494, 17.961886412434517, -326.4261261189024, 108.85313381497903, -12.746428817784668, 112.13995717489628, 126.21739018695726, 30.698392556707596, 111.49934999541826, -26.596165433314212, 6.0001537368660465, -86.5881056361753, -138.3334973883474, -5.33086231535003, 6.699291209352426, 180.16183452265824, 49.691285649920324, -3.9791914738006966, 155.18778182517457, 83.31739774286946, 17.950167955110153, 159.5382902551546, -31.1862560870838, 106.75986687999408, 161.88386527990824, 95.1584276608883, 148.65641044121708, 37.56305713025011, -24.724216084596275, -212.37151010202174, 56.73824462303938, 154.25460267298786, -35.372764934847055, -4.015314154415665, 169.30922850222095, -67.99465870290817, -0.6462258738132429, -3.047255145062202, -77.59886143881522, 6.774631510474521, -1.1794357913653144, 2.0000000000000013, 123.03410719915442, 96.59585588900147, 102.47704052931837, -3.162657366015175, -92.2296136193182, 102.19125661621986, -255.76787175554165, -134.92695500274132, -8.575173448820108], "policy_predator_policy_reward": [26.09646474214315, 22.949102145723483, 10.314081904356224, 5.7974945173290955, 73.08211416323584, 34.72882577775466, 7.01158753360716, 32.726847717431916, 131.7835170091238, 4.288063685838651, 115.86685299437532, 8.934019123593428, 41.511505962054315, 7.060691121287883, 61.16680069334108, 3.7806216760830305, 5.21766753726622, 46.4978068037196, 0.9546371851885804, 10.92392880332157, 0.0, 29.863854363917657, 369.06134303315866, 28.673202157294128, 402.076711740724, 214.0342686850168, 11.472063587234151, 4.783160265745005, 2.328209896003586, 38.25482620597691, 194.26519193628667, 2.3561221761280553, 48.74618713001913, 43.24232177511685, 310.2404873678498, 4.056126464131456, 9.322591167356517, 58.433161116241955, 5.907333379458871, 39.5107726839308, 2.377156703491628, 12.093619207695475, 2.005954832156885, 146.1834282811284, 64.84268521404645, 146.44204380347603, 8.191829091066332, 7.492566016510192, 16.826864688917954, 17.033782624827058, 209.30698937138075, 127.4670736752126, 191.57543896010344, 159.58792309751536, 14.414297696191678, 40.34067650724261, 34.51014046288734, 119.9584948457536, 254.70864112120728, 245.1094968014589, 16.50261910675777, 16.233359033751007, 252.8820982676392, 3.628621223135466, 349.9642367820646, 66.97641250322529, 272.3578768322101, 178.67958720139782, 5.716846817035681, 1.8896475579987673, 91.22193346494912, 54.836746619485396, 1.8734225305146284, 31.840459442086498, 44.20456062703125, 29.615546278603553, 48.0473149493883, 26.76566037944299, 43.068047020970305, 36.36899622649625, 46.8547643621184, 25.218583928962513, 298.0325092756611, 38.83120697787623, 91.56183667070417, 69.0300642405548, 10.545289693608556, 20.156891366208832, 6.116129973385807, 17.181218616231273, 44.29961906745719, 6.572958622278907, 17.756015610642837, 0.0, 0.0, 68.92438120108443, 5.210309836740905, 44.84243584144639, 22.993772255069423, 14.382627306140627, 13.465450581253041, 1.9574637393889944, 15.84547919279969, 0.0, 11.95006250645024, 22.277387174300873, 627.1778132899476, 13.221927150412881, 24.62679391698771, 14.970584826864332, 73.57070368362821, 1.9338941541038772, 1.1554187779250824, 5.6172376629987655, 82.56550995144791, 87.61936988420048, 23.558127452436214, 58.85010780686256, 65.56330736786435, 86.85850728178907, 15.030144971878093, 709.8322309988614, 18.768702981871908, 0.9142828351223822, 7.682625882773185, 117.93268084748992, 25.44831955276228, 16.329029269454978, 0.0, 331.4292131113824, 12.261035390943789, 12.637274844564349, 4.480877140804145, 11.763020517227899, 118.41518918437889, 89.60719557875315, 8.472884832389283, 59.49470853830503, 0.8273450775153991, 3.10544770115452, 12.064096714871066, 18.68551142838303, 3.8492174432606534, 26.06528500595456, 2.2440620371297406, 1.2146006782610157, 31.045348714229107, 29.13315231719526, 66.7847057181349, 12.230179793153454, 1.8381135875654868, 326.9761261189023, 23.776403242199656, 28.357651537426026, 40.98004282510373, 5.422609813042984, 68.69160744329231, 42.720650004581756, 13.530912100390434, 116.34052031658048, 200.4100230858231, 43.20157993870056, 26.88086231535003, 66.0807087906476, 1.0181654773418112, 50.01871435007963, 15.172609749509062, 80.51879989911714, 107.09296579581653, 0.7599908642506334, 63.801872722658054, 73.32609310927138, 40.51013312000587, 11.326134720091657, 37.782911967027644, 33.54562412794704, 71.65936949434605, 4.881813269428141, 230.36889292270536, 3.6004890797936975, 100.10955607958897, 61.014031168505845, 5.965314154415624, 10.830771497779104, 57.59745583375024, 14.463428742970876, 161.42222543084614, 165.05063888309417, 56.251168947180915, 70.99316753627826, 0.0, 25.275892800845526, 19.243680120485475, 57.87827372209266, 58.72535417045668, 40.14691681487636, 9.648743383780479, 256.9478717555406, 174.20695500274118, 10.485173448820067]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8026365353145506, "mean_inference_ms": 2.484276298734613, "mean_action_processing_ms": 0.35482138620660036, "mean_env_wait_ms": 0.2793844110511119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004195094108581543, "StateBufferConnector_ms": 0.004475593566894531, "ViewRequirementAgentConnector_ms": 0.1122215986251831}, "num_episodes": 18, "episode_return_max": 398.0229607336323, "episode_return_min": -335.6408070463936, "episode_return_mean": 180.3055364062744, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 265.13658419756047, "num_env_steps_trained_throughput_per_sec": 265.13658419756047, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 15113.717, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15113.663, "sample_time_ms": 1864.637, "learn_time_ms": 13219.839, "learn_throughput": 302.576, "synch_weights_time_ms": 25.682}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 43, "trial_id": "61e09_00000", "date": "2024-08-16_16-17-30", "timestamp": 1723805250, "time_this_iter_s": 15.15950894355774, "time_total_s": 651.3247315883636, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2499a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 651.3247315883636, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 59.2, "ram_util_percent": 82.14285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9745292162769055, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 0.00010000000000000003, "total_loss": 2.9863822567399847, "policy_loss": -0.004150983702549071, "vf_loss": 2.989869394504204, "vf_explained_var": 0.06631659386019227, "kl": 0.00885129842329387, "entropy": 0.6159168091085222, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.698402931261315, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.811788288752238, "policy_loss": -0.006188309557795052, "vf_loss": 5.815473091034662, "vf_explained_var": 0.6192803537719465, "kl": 0.012517593651082471, "entropy": 1.310070081488796, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 398.0229607336323, "episode_reward_min": -335.6408070463936, "episode_reward_mean": 172.52672294593697, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -595.0203801421802, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.37661434514507, "predator_policy": 709.8322309988614}, "policy_reward_mean": {"prey_policy": 18.969470425680587, "predator_policy": 67.29389104728793}, "custom_metrics": {}, "hist_stats": {"episode_reward": [307.4399999999999, 307.49999999999994, 3.8799999999999613, 13.140938794606493, 287.8966833031958, 318.45042425067317, 176.03000000000003, 373.2839684778155, 150.04002538312417, 325.27999999999986, 279.0077610320391, 35.42865960002828, 305.0816076766607, 109.65000000000008, 6.989999999999959, 398.0229607336323, 351.4299999999997, 101.94188667620706, 185.07999999999987, 141.97000000000043, 153.1100000000001, 287.5057080687453, 175.76999999999998, 78.55640205691408, 155.60000000000014, 296.72103408010827, 265.1999999999997, 332.3199999999998, 341.8767850749507, 3.599999999999967, 146.41031548843313, 143.32, 172.13999999999993, 162.27999999999992, 316.2517340269862, -304.2501225993146, 185.08102270913582, 157.97000000000003, 269.229277184135, 127.16814453534107, 166.79999999999953, 303.35, -335.6408070463936, 139.48000000000044, 32.04, 173.05999999999992, 3.1499999999999755, 84.5046598045429, 316.7299999999999, 277.05096657107106, 120.52000000000082, 89.11000000000008, 336.39999999999986, 364.17921744326065, 229.68999999999903, 329.2999999999999, 63.929999999999595, 20.349999999999994, 148.24075977682008, 284.7599999999995, 253.61000000000018, 109.27542072052262, 18.690000000000214, 94.33000000000028, 280.8899999999999, 246.90000000000006, 209.1205223580459, 265.47999999999985, 320.4799999999999, 315.14337419708005, 89.38002380942754, 78.33611652351689, 280.0054249862356, 182.08999999999975, 3.4199999999999715, 245.8267477300629, 132.8395322025684, 150.31000000000034, 276.19485026089717, 3.4799999999999693, 113.02000000000093, 41.19000000000008, 158.64348563054568, 301.60999999999984, 372.12073111382495, 204.09999999999965, 1.9200000000000017, 123.07000000000025, 96.68686626709984, 164.77564741276154, 3.319999999999972, 167.25, 2.4199999999999897, 330.8519481772131, -98.31189580262034, 168.23000000000008, 362.4134859037964, 277.10999999999933, 2.2199999999999953, 113.82000000000046], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [145.07740883264353, 94.60683888375803, 140.5926666205412, 121.48922731606919, -0.39715670349163434, -10.193619207695516, -50.70371148872361, -84.34473282995555, 88.13812337601681, -11.526169090343522, 177.0771361591593, 125.68889298393748, -14.956864688917953, 157.12621737517298, -106.79435811253818, 143.30426354376058, -191.13543896010344, -9.987897714391245, 172.5957023038083, 97.92932349275738, 120.53452460754994, 4.0046011158483985, -250.32998152118026, -214.05949680145898, 129.42017051100237, 142.9254590251498, -95.42620357210956, -51.43451591866504, 0.7482095130278629, -410.69885879831776, -194.81479359471564, 141.80029029474014, 174.4431531829643, 169.38035244200108, -92.79754034159545, 48.68074693336846, 181.27657746948543, -29.910459442086196, 75.2154393729687, -7.065546278603307, 103.22268505061172, -24.925660379442704, 75.73546187650261, 132.33320294477596, -45.25476436211873, 148.95141607103756, -221.24795963875573, -37.05935455786761, 62.52816332929583, -67.52006424055477, 151.28423187248856, 114.73462114780243, 134.39568015473702, 107.50697125564572, 109.8603809325428, 171.58704137772094, 174.8566427301695, 149.26412673413876, -58.908759658677006, -6.415621542407758, -0.009994348308114536, 96.36756415855368, 118.41622774493065, -12.472627306140668, 156.69454941874693, 0.022536260611007178, 144.43452080720039, 2.0000000000000013, 105.11164111445416, 176.91264323178137, -484.50272521030865, -460.14713782936747, 145.39068189695104, 0.09296206833304543, -2.5675690817621506, 85.03297124403005, 122.563858406211, 139.89276233700141, -72.63672884506798, 29.61999354476081, -79.99953689080614, 164.39130163150784, 83.71669263213569, 67.21149271821092, -465.48280287495237, -595.0203801421802, 118.72129701812834, 1.0757171648776191, -55.120727993629785, -38.45457873663368, -22.558319552761983, 153.84097073054505, 2.0000000000000013, -330.27921311138255, 2.0000000000000013, 57.606349569034485, 184.58912285919587, 115.89697948277208, -34.890416501871286, 103.9189983098108, 56.920055960708176, -4.367649331402644, 86.30265492248444, -1.1254477011545427, 163.07590328512885, 142.57448857161694, 164.95471499404545, 169.31000000000003, 106.6559379628702, 119.57539932173933, 115.23465128577098, 153.88684768280473, -4.754705718134918, -10.330179793153494, 17.961886412434517, -326.4261261189024, 108.85313381497903, -12.746428817784668, 112.13995717489628, 126.21739018695726, 30.698392556707596, 111.49934999541826, -26.596165433314212, 6.0001537368660465, -86.5881056361753, -138.3334973883474, -5.33086231535003, 6.699291209352426, 180.16183452265824, 49.691285649920324, -3.9791914738006966, 155.18778182517457, 83.31739774286946, 17.950167955110153, 159.5382902551546, -31.1862560870838, 106.75986687999408, 161.88386527990824, 95.1584276608883, 148.65641044121708, 37.56305713025011, -24.724216084596275, -212.37151010202174, 56.73824462303938, 154.25460267298786, -35.372764934847055, -4.015314154415665, 169.30922850222095, -67.99465870290817, -0.6462258738132429, -3.047255145062202, -77.59886143881522, 6.774631510474521, -1.1794357913653144, 2.0000000000000013, 123.03410719915442, 96.59585588900147, 102.47704052931837, -3.162657366015175, -92.2296136193182, 102.19125661621986, -255.76787175554165, -134.92695500274132, -8.575173448820108, 8.31281314554792, -24.17748105682672, 183.17000000000002, 64.26092563330593, 167.65792489716426, 22.357768976466517, 15.291433831023557, 36.26365814292089, -317.38270056830277, -124.66964472091102, -88.8462466428887, 100.81245311275822, -70.36362748739059, -8.655803226958263, -306.235325610001, 147.86890302828988, -90.4842731506098, -1.2143196113991153, 161.07205568829755, -5.215901273506843, -182.33466690769276, -86.39726501171515, 157.74859222393002, 146.94053567704415, -329.47705835526136, -153.8355536577374, 161.16554291062798, -5.951063270036454, 185.70827550095265, 169.12484471745626, 67.19734081950088, 193.37661434514507, -256.6771998271155, -39.62313974985286, 62.12400912344806, -123.23026654810836], "policy_predator_policy_reward": [9.322591167356517, 58.433161116241955, 5.907333379458871, 39.5107726839308, 2.377156703491628, 12.093619207695475, 2.005954832156885, 146.1834282811284, 64.84268521404645, 146.44204380347603, 8.191829091066332, 7.492566016510192, 16.826864688917954, 17.033782624827058, 209.30698937138075, 127.4670736752126, 191.57543896010344, 159.58792309751536, 14.414297696191678, 40.34067650724261, 34.51014046288734, 119.9584948457536, 254.70864112120728, 245.1094968014589, 16.50261910675777, 16.233359033751007, 252.8820982676392, 3.628621223135466, 349.9642367820646, 66.97641250322529, 272.3578768322101, 178.67958720139782, 5.716846817035681, 1.8896475579987673, 91.22193346494912, 54.836746619485396, 1.8734225305146284, 31.840459442086498, 44.20456062703125, 29.615546278603553, 48.0473149493883, 26.76566037944299, 43.068047020970305, 36.36899622649625, 46.8547643621184, 25.218583928962513, 298.0325092756611, 38.83120697787623, 91.56183667070417, 69.0300642405548, 10.545289693608556, 20.156891366208832, 6.116129973385807, 17.181218616231273, 44.29961906745719, 6.572958622278907, 17.756015610642837, 0.0, 0.0, 68.92438120108443, 5.210309836740905, 44.84243584144639, 22.993772255069423, 14.382627306140627, 13.465450581253041, 1.9574637393889944, 15.84547919279969, 0.0, 11.95006250645024, 22.277387174300873, 627.1778132899476, 13.221927150412881, 24.62679391698771, 14.970584826864332, 73.57070368362821, 1.9338941541038772, 1.1554187779250824, 5.6172376629987655, 82.56550995144791, 87.61936988420048, 23.558127452436214, 58.85010780686256, 65.56330736786435, 86.85850728178907, 15.030144971878093, 709.8322309988614, 18.768702981871908, 0.9142828351223822, 7.682625882773185, 117.93268084748992, 25.44831955276228, 16.329029269454978, 0.0, 331.4292131113824, 12.261035390943789, 12.637274844564349, 4.480877140804145, 11.763020517227899, 118.41518918437889, 89.60719557875315, 8.472884832389283, 59.49470853830503, 0.8273450775153991, 3.10544770115452, 12.064096714871066, 18.68551142838303, 3.8492174432606534, 26.06528500595456, 2.2440620371297406, 1.2146006782610157, 31.045348714229107, 29.13315231719526, 66.7847057181349, 12.230179793153454, 1.8381135875654868, 326.9761261189023, 23.776403242199656, 28.357651537426026, 40.98004282510373, 5.422609813042984, 68.69160744329231, 42.720650004581756, 13.530912100390434, 116.34052031658048, 200.4100230858231, 43.20157993870056, 26.88086231535003, 66.0807087906476, 1.0181654773418112, 50.01871435007963, 15.172609749509062, 80.51879989911714, 107.09296579581653, 0.7599908642506334, 63.801872722658054, 73.32609310927138, 40.51013312000587, 11.326134720091657, 37.782911967027644, 33.54562412794704, 71.65936949434605, 4.881813269428141, 230.36889292270536, 3.6004890797936975, 100.10955607958897, 61.014031168505845, 5.965314154415624, 10.830771497779104, 57.59745583375024, 14.463428742970876, 161.42222543084614, 165.05063888309417, 56.251168947180915, 70.99316753627826, 0.0, 25.275892800845526, 19.243680120485475, 57.87827372209266, 58.72535417045668, 40.14691681487636, 9.648743383780479, 256.9478717555406, 174.20695500274118, 10.485173448820067, 168.49738009734926, 6.0107734444752685, 0.0, 54.17907436669407, 101.93345997232721, 80.17157726786675, 120.02259048233911, 32.522317543716376, 318.15270056830207, 125.8196447209116, 90.26624664288943, 20.837546887241874, 173.8187372561418, 1.8875597253078151, 306.82872732341195, 16.313342671060443, 91.83427315060983, 3.1843196113990917, 4.237944311702497, 7.155901273506801, 184.3073450328738, 86.84458688653433, 0.8949211029885072, 25.267899173250797, 5.968929573524409, 379.0317866368543, 5.134457089372129, 7.881063270036415, 7.580365685387494, 0.0, 14.88265918049951, 1.6533856548549295, 257.2271998271158, 41.293139749852564, 115.59276956965932, 59.33348785500065]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8011183375891742, "mean_inference_ms": 2.4810138271963296, "mean_action_processing_ms": 0.35348717271528474, "mean_env_wait_ms": 0.27864627207020565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004159808158874512, "StateBufferConnector_ms": 0.00482177734375, "ViewRequirementAgentConnector_ms": 0.1075664758682251}, "num_episodes": 18, "episode_return_max": 398.0229607336323, "episode_return_min": -335.6408070463936, "episode_return_mean": 172.52672294593697, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.92358026623555, "num_env_steps_trained_throughput_per_sec": 268.92358026623555, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 15116.198, "restore_workers_time_ms": 0.013, "training_step_time_ms": 15116.146, "sample_time_ms": 1871.68, "learn_time_ms": 13210.636, "learn_throughput": 302.786, "synch_weights_time_ms": 29.079}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 44, "trial_id": "61e09_00000", "date": "2024-08-16_16-17-45", "timestamp": 1723805265, "time_this_iter_s": 14.979517221450806, "time_total_s": 666.3042488098145, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24993a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 666.3042488098145, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 59.309090909090905, "ram_util_percent": 82.42727272727274}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4809099198018432, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 0.00010000000000000003, "total_loss": 4.0197625803569, "policy_loss": -0.006993414767372309, "vf_loss": 4.026104412003169, "vf_explained_var": 0.04256984096355539, "kl": 0.008687709512119467, "entropy": 0.7014090126153654, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7541556654783785, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.941265658979063, "policy_loss": -0.0035194990591013004, "vf_loss": 6.94229156958363, "vf_explained_var": 0.08121618798800877, "kl": 0.01246806145915543, "entropy": 1.2689908121628737, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 372.12073111382495, "episode_reward_min": -335.6408070463936, "episode_reward_mean": 165.95283177303244, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -595.0203801421802, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.37661434514507, "predator_policy": 709.8322309988614}, "policy_reward_mean": {"prey_policy": 14.769019418369227, "predator_policy": 68.20739646814704}, "custom_metrics": {}, "hist_stats": {"episode_reward": [175.76999999999998, 78.55640205691408, 155.60000000000014, 296.72103408010827, 265.1999999999997, 332.3199999999998, 341.8767850749507, 3.599999999999967, 146.41031548843313, 143.32, 172.13999999999993, 162.27999999999992, 316.2517340269862, -304.2501225993146, 185.08102270913582, 157.97000000000003, 269.229277184135, 127.16814453534107, 166.79999999999953, 303.35, -335.6408070463936, 139.48000000000044, 32.04, 173.05999999999992, 3.1499999999999755, 84.5046598045429, 316.7299999999999, 277.05096657107106, 120.52000000000082, 89.11000000000008, 336.39999999999986, 364.17921744326065, 229.68999999999903, 329.2999999999999, 63.929999999999595, 20.349999999999994, 148.24075977682008, 284.7599999999995, 253.61000000000018, 109.27542072052262, 18.690000000000214, 94.33000000000028, 280.8899999999999, 246.90000000000006, 209.1205223580459, 265.47999999999985, 320.4799999999999, 315.14337419708005, 89.38002380942754, 78.33611652351689, 280.0054249862356, 182.08999999999975, 3.4199999999999715, 245.8267477300629, 132.8395322025684, 150.31000000000034, 276.19485026089717, 3.4799999999999693, 113.02000000000093, 41.19000000000008, 158.64348563054568, 301.60999999999984, 372.12073111382495, 204.09999999999965, 1.9200000000000017, 123.07000000000025, 96.68686626709984, 164.77564741276154, 3.319999999999972, 167.25, 2.4199999999999897, 330.8519481772131, -98.31189580262034, 168.23000000000008, 362.4134859037964, 277.10999999999933, 2.2199999999999953, 113.82000000000046, 197.58588402146387, 183.84351501790024, 35.369999999999976, 307.3299999999999, 142.10000000000014, 200.8414654053422, 129.40092372027226, 175.71000000000004, -10.33568448196302, 170.67000000000002, 327.9398014029524, 77.32999999999998, 325.5300000000001, 186.85386957962115, 334.1781769269787, 187.3635223125164, 181.42614998094353, 351.24308249602336, 43.99999999999971, 2.109999999999986, 141.7100000000002, 268.5708003242244], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-45.25476436211873, 148.95141607103756, -221.24795963875573, -37.05935455786761, 62.52816332929583, -67.52006424055477, 151.28423187248856, 114.73462114780243, 134.39568015473702, 107.50697125564572, 109.8603809325428, 171.58704137772094, 174.8566427301695, 149.26412673413876, -58.908759658677006, -6.415621542407758, -0.009994348308114536, 96.36756415855368, 118.41622774493065, -12.472627306140668, 156.69454941874693, 0.022536260611007178, 144.43452080720039, 2.0000000000000013, 105.11164111445416, 176.91264323178137, -484.50272521030865, -460.14713782936747, 145.39068189695104, 0.09296206833304543, -2.5675690817621506, 85.03297124403005, 122.563858406211, 139.89276233700141, -72.63672884506798, 29.61999354476081, -79.99953689080614, 164.39130163150784, 83.71669263213569, 67.21149271821092, -465.48280287495237, -595.0203801421802, 118.72129701812834, 1.0757171648776191, -55.120727993629785, -38.45457873663368, -22.558319552761983, 153.84097073054505, 2.0000000000000013, -330.27921311138255, 2.0000000000000013, 57.606349569034485, 184.58912285919587, 115.89697948277208, -34.890416501871286, 103.9189983098108, 56.920055960708176, -4.367649331402644, 86.30265492248444, -1.1254477011545427, 163.07590328512885, 142.57448857161694, 164.95471499404545, 169.31000000000003, 106.6559379628702, 119.57539932173933, 115.23465128577098, 153.88684768280473, -4.754705718134918, -10.330179793153494, 17.961886412434517, -326.4261261189024, 108.85313381497903, -12.746428817784668, 112.13995717489628, 126.21739018695726, 30.698392556707596, 111.49934999541826, -26.596165433314212, 6.0001537368660465, -86.5881056361753, -138.3334973883474, -5.33086231535003, 6.699291209352426, 180.16183452265824, 49.691285649920324, -3.9791914738006966, 155.18778182517457, 83.31739774286946, 17.950167955110153, 159.5382902551546, -31.1862560870838, 106.75986687999408, 161.88386527990824, 95.1584276608883, 148.65641044121708, 37.56305713025011, -24.724216084596275, -212.37151010202174, 56.73824462303938, 154.25460267298786, -35.372764934847055, -4.015314154415665, 169.30922850222095, -67.99465870290817, -0.6462258738132429, -3.047255145062202, -77.59886143881522, 6.774631510474521, -1.1794357913653144, 2.0000000000000013, 123.03410719915442, 96.59585588900147, 102.47704052931837, -3.162657366015175, -92.2296136193182, 102.19125661621986, -255.76787175554165, -134.92695500274132, -8.575173448820108, 8.31281314554792, -24.17748105682672, 183.17000000000002, 64.26092563330593, 167.65792489716426, 22.357768976466517, 15.291433831023557, 36.26365814292089, -317.38270056830277, -124.66964472091102, -88.8462466428887, 100.81245311275822, -70.36362748739059, -8.655803226958263, -306.235325610001, 147.86890302828988, -90.4842731506098, -1.2143196113991153, 161.07205568829755, -5.215901273506843, -182.33466690769276, -86.39726501171515, 157.74859222393002, 146.94053567704415, -329.47705835526136, -153.8355536577374, 161.16554291062798, -5.951063270036454, 185.70827550095265, 169.12484471745626, 67.19734081950088, 193.37661434514507, -256.6771998271155, -39.62313974985286, 62.12400912344806, -123.23026654810836, 59.57399405800437, 27.2114112180295, -19.083916508454372, 160.08346001781644, -58.63529401653258, 17.410388054152747, 190.23241056029923, 28.965199997365843, 100.95028359374575, -38.524724526626954, -14.430426022723738, -219.67123391590863, 84.55093147930138, 2.0000000000000013, 8.344895432139957, 82.97928039046262, -379.6812881009883, -165.70861950185997, -115.4733476951484, 136.41297566490618, 15.853284493651486, 182.79030702776407, -241.12256633626478, 32.43057704298245, 134.65615152034175, 162.789643380593, 54.77310371532142, -164.64741883280777, 125.2585954003936, 165.62980181635163, 153.45739483875045, -0.6289169027177848, 86.12158967661807, -4.762042604676601, 161.93364957112857, 171.57231679722517, -12.086656962276786, -171.7848999959426, -446.7828708241712, -18.834195057160798, 140.60000000000002, -271.3923109254129, 152.26094861780962, -23.8383973144671], "policy_predator_policy_reward": [46.8547643621184, 25.218583928962513, 298.0325092756611, 38.83120697787623, 91.56183667070417, 69.0300642405548, 10.545289693608556, 20.156891366208832, 6.116129973385807, 17.181218616231273, 44.29961906745719, 6.572958622278907, 17.756015610642837, 0.0, 0.0, 68.92438120108443, 5.210309836740905, 44.84243584144639, 22.993772255069423, 14.382627306140627, 13.465450581253041, 1.9574637393889944, 15.84547919279969, 0.0, 11.95006250645024, 22.277387174300873, 627.1778132899476, 13.221927150412881, 24.62679391698771, 14.970584826864332, 73.57070368362821, 1.9338941541038772, 1.1554187779250824, 5.6172376629987655, 82.56550995144791, 87.61936988420048, 23.558127452436214, 58.85010780686256, 65.56330736786435, 86.85850728178907, 15.030144971878093, 709.8322309988614, 18.768702981871908, 0.9142828351223822, 7.682625882773185, 117.93268084748992, 25.44831955276228, 16.329029269454978, 0.0, 331.4292131113824, 12.261035390943789, 12.637274844564349, 4.480877140804145, 11.763020517227899, 118.41518918437889, 89.60719557875315, 8.472884832389283, 59.49470853830503, 0.8273450775153991, 3.10544770115452, 12.064096714871066, 18.68551142838303, 3.8492174432606534, 26.06528500595456, 2.2440620371297406, 1.2146006782610157, 31.045348714229107, 29.13315231719526, 66.7847057181349, 12.230179793153454, 1.8381135875654868, 326.9761261189023, 23.776403242199656, 28.357651537426026, 40.98004282510373, 5.422609813042984, 68.69160744329231, 42.720650004581756, 13.530912100390434, 116.34052031658048, 200.4100230858231, 43.20157993870056, 26.88086231535003, 66.0807087906476, 1.0181654773418112, 50.01871435007963, 15.172609749509062, 80.51879989911714, 107.09296579581653, 0.7599908642506334, 63.801872722658054, 73.32609310927138, 40.51013312000587, 11.326134720091657, 37.782911967027644, 33.54562412794704, 71.65936949434605, 4.881813269428141, 230.36889292270536, 3.6004890797936975, 100.10955607958897, 61.014031168505845, 5.965314154415624, 10.830771497779104, 57.59745583375024, 14.463428742970876, 161.42222543084614, 165.05063888309417, 56.251168947180915, 70.99316753627826, 0.0, 25.275892800845526, 19.243680120485475, 57.87827372209266, 58.72535417045668, 40.14691681487636, 9.648743383780479, 256.9478717555406, 174.20695500274118, 10.485173448820067, 168.49738009734926, 6.0107734444752685, 0.0, 54.17907436669407, 101.93345997232721, 80.17157726786675, 120.02259048233911, 32.522317543716376, 318.15270056830207, 125.8196447209116, 90.26624664288943, 20.837546887241874, 173.8187372561418, 1.8875597253078151, 306.82872732341195, 16.313342671060443, 91.83427315060983, 3.1843196113990917, 4.237944311702497, 7.155901273506801, 184.3073450328738, 86.84458688653433, 0.8949211029885072, 25.267899173250797, 5.968929573524409, 379.0317866368543, 5.134457089372129, 7.881063270036415, 7.580365685387494, 0.0, 14.88265918049951, 1.6533856548549295, 257.2271998271158, 41.293139749852564, 115.59276956965932, 59.33348785500065, 27.088814933995298, 83.71166381143446, 19.97995488508586, 22.864016623452287, 67.32529401653345, 9.269611945847217, 33.474405583191825, 54.65798385914301, 28.57971640625432, 51.09472452662664, 255.8288833436153, 179.1142420003597, 13.547633217685934, 29.302359023284406, 36.91510456786001, 47.47071960953735, 458.00058344404425, 77.0536396768406, 117.0333476951492, 32.69702433509388, 126.21589806446634, 3.080311817070517, 241.4425663362646, 44.579422957017606, 9.823848479658233, 18.260356619407005, 176.88464371051253, 119.84354098659503, 30.08140459960654, 13.208375110627445, 23.61260516124958, 10.92243921523455, 43.96621843798266, 56.10038447102098, 13.866720280158809, 3.87039584751079, 13.996656962276745, 213.8748999959425, 447.06287082417094, 20.664195057161084, 0.0, 272.5023109254119, 74.48949645456834, 65.65875256631354]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.800549862548516, "mean_inference_ms": 2.483327532052124, "mean_action_processing_ms": 0.35275327970446485, "mean_env_wait_ms": 0.27820096317895815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00400698184967041, "StateBufferConnector_ms": 0.004831552505493164, "ViewRequirementAgentConnector_ms": 0.10261976718902588}, "num_episodes": 22, "episode_return_max": 372.12073111382495, "episode_return_min": -335.6408070463936, "episode_return_mean": 165.95283177303244, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 265.5295431643364, "num_env_steps_trained_throughput_per_sec": 265.5295431643364, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 15182.306, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15182.249, "sample_time_ms": 1950.149, "learn_time_ms": 13198.156, "learn_throughput": 303.073, "synch_weights_time_ms": 29.078}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 45, "trial_id": "61e09_00000", "date": "2024-08-16_16-18-00", "timestamp": 1723805280, "time_this_iter_s": 15.11538314819336, "time_total_s": 681.4196319580078, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3000cbdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 681.4196319580078, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 57.857142857142854, "ram_util_percent": 82.08095238095237}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0603601828454035, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 0.00010000000000000003, "total_loss": 4.032698631034326, "policy_loss": -0.007974528178952082, "vf_loss": 4.039309463677583, "vf_explained_var": 0.026483903675483016, "kl": 0.018182481453423886, "entropy": 0.5426325024908812, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.528587384387929, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.95171954215519, "policy_loss": -0.004512462197561507, "vf_loss": 6.954468795483705, "vf_explained_var": 0.22797886350798227, "kl": 0.008816026773390459, "entropy": 1.2360505245980762, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 372.12073111382495, "episode_reward_min": -117.00067426587059, "episode_reward_mean": 169.53863964517038, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -458.8447562677739, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.37661434514507, "predator_policy": 465.914394270611}, "policy_reward_mean": {"prey_policy": 7.669485810606739, "predator_policy": 77.09983401197849}, "custom_metrics": {}, "hist_stats": {"episode_reward": [173.05999999999992, 3.1499999999999755, 84.5046598045429, 316.7299999999999, 277.05096657107106, 120.52000000000082, 89.11000000000008, 336.39999999999986, 364.17921744326065, 229.68999999999903, 329.2999999999999, 63.929999999999595, 20.349999999999994, 148.24075977682008, 284.7599999999995, 253.61000000000018, 109.27542072052262, 18.690000000000214, 94.33000000000028, 280.8899999999999, 246.90000000000006, 209.1205223580459, 265.47999999999985, 320.4799999999999, 315.14337419708005, 89.38002380942754, 78.33611652351689, 280.0054249862356, 182.08999999999975, 3.4199999999999715, 245.8267477300629, 132.8395322025684, 150.31000000000034, 276.19485026089717, 3.4799999999999693, 113.02000000000093, 41.19000000000008, 158.64348563054568, 301.60999999999984, 372.12073111382495, 204.09999999999965, 1.9200000000000017, 123.07000000000025, 96.68686626709984, 164.77564741276154, 3.319999999999972, 167.25, 2.4199999999999897, 330.8519481772131, -98.31189580262034, 168.23000000000008, 362.4134859037964, 277.10999999999933, 2.2199999999999953, 113.82000000000046, 197.58588402146387, 183.84351501790024, 35.369999999999976, 307.3299999999999, 142.10000000000014, 200.8414654053422, 129.40092372027226, 175.71000000000004, -10.33568448196302, 170.67000000000002, 327.9398014029524, 77.32999999999998, 325.5300000000001, 186.85386957962115, 334.1781769269787, 187.3635223125164, 181.42614998094353, 351.24308249602336, 43.99999999999971, 2.109999999999986, 141.7100000000002, 268.5708003242244, 3.509999999999966, 93.73027943471834, 11.741923135033748, 332.3460170313984, 202.10436638005757, 41.879999999999995, 190.3590356181825, 333.4612201445675, 227.9799999999998, 180.51000000000047, 272.50000000000006, 301.55999999999983, -117.00067426587059, 46.04999999999977, -36.49066246247728, 287.3930883791465, 19.970000000000187, 202.44000000000017, 171.96999999999966, 313.1451134932632, 122.44000000000021, 121.00486583606875, 367.2499999999998], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-22.558319552761983, 153.84097073054505, 2.0000000000000013, -330.27921311138255, 2.0000000000000013, 57.606349569034485, 184.58912285919587, 115.89697948277208, -34.890416501871286, 103.9189983098108, 56.920055960708176, -4.367649331402644, 86.30265492248444, -1.1254477011545427, 163.07590328512885, 142.57448857161694, 164.95471499404545, 169.31000000000003, 106.6559379628702, 119.57539932173933, 115.23465128577098, 153.88684768280473, -4.754705718134918, -10.330179793153494, 17.961886412434517, -326.4261261189024, 108.85313381497903, -12.746428817784668, 112.13995717489628, 126.21739018695726, 30.698392556707596, 111.49934999541826, -26.596165433314212, 6.0001537368660465, -86.5881056361753, -138.3334973883474, -5.33086231535003, 6.699291209352426, 180.16183452265824, 49.691285649920324, -3.9791914738006966, 155.18778182517457, 83.31739774286946, 17.950167955110153, 159.5382902551546, -31.1862560870838, 106.75986687999408, 161.88386527990824, 95.1584276608883, 148.65641044121708, 37.56305713025011, -24.724216084596275, -212.37151010202174, 56.73824462303938, 154.25460267298786, -35.372764934847055, -4.015314154415665, 169.30922850222095, -67.99465870290817, -0.6462258738132429, -3.047255145062202, -77.59886143881522, 6.774631510474521, -1.1794357913653144, 2.0000000000000013, 123.03410719915442, 96.59585588900147, 102.47704052931837, -3.162657366015175, -92.2296136193182, 102.19125661621986, -255.76787175554165, -134.92695500274132, -8.575173448820108, 8.31281314554792, -24.17748105682672, 183.17000000000002, 64.26092563330593, 167.65792489716426, 22.357768976466517, 15.291433831023557, 36.26365814292089, -317.38270056830277, -124.66964472091102, -88.8462466428887, 100.81245311275822, -70.36362748739059, -8.655803226958263, -306.235325610001, 147.86890302828988, -90.4842731506098, -1.2143196113991153, 161.07205568829755, -5.215901273506843, -182.33466690769276, -86.39726501171515, 157.74859222393002, 146.94053567704415, -329.47705835526136, -153.8355536577374, 161.16554291062798, -5.951063270036454, 185.70827550095265, 169.12484471745626, 67.19734081950088, 193.37661434514507, -256.6771998271155, -39.62313974985286, 62.12400912344806, -123.23026654810836, 59.57399405800437, 27.2114112180295, -19.083916508454372, 160.08346001781644, -58.63529401653258, 17.410388054152747, 190.23241056029923, 28.965199997365843, 100.95028359374575, -38.524724526626954, -14.430426022723738, -219.67123391590863, 84.55093147930138, 2.0000000000000013, 8.344895432139957, 82.97928039046262, -379.6812881009883, -165.70861950185997, -115.4733476951484, 136.41297566490618, 15.853284493651486, 182.79030702776407, -241.12256633626478, 32.43057704298245, 134.65615152034175, 162.789643380593, 54.77310371532142, -164.64741883280777, 125.2585954003936, 165.62980181635163, 153.45739483875045, -0.6289169027177848, 86.12158967661807, -4.762042604676601, 161.93364957112857, 171.57231679722517, -12.086656962276786, -171.7848999959426, -446.7828708241712, -18.834195057160798, 140.60000000000002, -271.3923109254129, 152.26094861780962, -23.8383973144671, -0.8084838106362735, -107.94172516669981, -192.04762844975437, 8.986790926768501, -174.92691493671683, -178.74983161102048, 155.41570735939064, 114.74915941631508, 2.0000000000000013, 35.11528899291446, 1.1272184165495742, -85.7409308822531, -79.9385606556356, 161.85127672557522, 118.91835831109708, 129.8270811077599, -77.03464348582216, 150.5000000000001, -119.03517966821309, 137.3932804124739, 160.55172060802755, -28.052243312908033, 124.23994234453681, 125.48323604488934, -203.11036002967356, -425.2414348861682, -8.022603958169151, -173.4764091151664, -148.3068883708039, -291.17241140445634, -108.48458875396835, 120.01873591309821, -458.8447562677739, -1.954825819385437, -23.79099132331207, 131.94549909337513, -28.730882949652855, 161.6116516711984, 143.5509195571867, 138.47826424133808, 112.53327745104544, -81.81080927262627, -329.14427942572075, -305.4296656792191, 177.2299999999998, 180.18027483418507], "policy_predator_policy_reward": [25.44831955276228, 16.329029269454978, 0.0, 331.4292131113824, 12.261035390943789, 12.637274844564349, 4.480877140804145, 11.763020517227899, 118.41518918437889, 89.60719557875315, 8.472884832389283, 59.49470853830503, 0.8273450775153991, 3.10544770115452, 12.064096714871066, 18.68551142838303, 3.8492174432606534, 26.06528500595456, 2.2440620371297406, 1.2146006782610157, 31.045348714229107, 29.13315231719526, 66.7847057181349, 12.230179793153454, 1.8381135875654868, 326.9761261189023, 23.776403242199656, 28.357651537426026, 40.98004282510373, 5.422609813042984, 68.69160744329231, 42.720650004581756, 13.530912100390434, 116.34052031658048, 200.4100230858231, 43.20157993870056, 26.88086231535003, 66.0807087906476, 1.0181654773418112, 50.01871435007963, 15.172609749509062, 80.51879989911714, 107.09296579581653, 0.7599908642506334, 63.801872722658054, 73.32609310927138, 40.51013312000587, 11.326134720091657, 37.782911967027644, 33.54562412794704, 71.65936949434605, 4.881813269428141, 230.36889292270536, 3.6004890797936975, 100.10955607958897, 61.014031168505845, 5.965314154415624, 10.830771497779104, 57.59745583375024, 14.463428742970876, 161.42222543084614, 165.05063888309417, 56.251168947180915, 70.99316753627826, 0.0, 25.275892800845526, 19.243680120485475, 57.87827372209266, 58.72535417045668, 40.14691681487636, 9.648743383780479, 256.9478717555406, 174.20695500274118, 10.485173448820067, 168.49738009734926, 6.0107734444752685, 0.0, 54.17907436669407, 101.93345997232721, 80.17157726786675, 120.02259048233911, 32.522317543716376, 318.15270056830207, 125.8196447209116, 90.26624664288943, 20.837546887241874, 173.8187372561418, 1.8875597253078151, 306.82872732341195, 16.313342671060443, 91.83427315060983, 3.1843196113990917, 4.237944311702497, 7.155901273506801, 184.3073450328738, 86.84458688653433, 0.8949211029885072, 25.267899173250797, 5.968929573524409, 379.0317866368543, 5.134457089372129, 7.881063270036415, 7.580365685387494, 0.0, 14.88265918049951, 1.6533856548549295, 257.2271998271158, 41.293139749852564, 115.59276956965932, 59.33348785500065, 27.088814933995298, 83.71166381143446, 19.97995488508586, 22.864016623452287, 67.32529401653345, 9.269611945847217, 33.474405583191825, 54.65798385914301, 28.57971640625432, 51.09472452662664, 255.8288833436153, 179.1142420003597, 13.547633217685934, 29.302359023284406, 36.91510456786001, 47.47071960953735, 458.00058344404425, 77.0536396768406, 117.0333476951492, 32.69702433509388, 126.21589806446634, 3.080311817070517, 241.4425663362646, 44.579422957017606, 9.823848479658233, 18.260356619407005, 176.88464371051253, 119.84354098659503, 30.08140459960654, 13.208375110627445, 23.61260516124958, 10.92243921523455, 43.96621843798266, 56.10038447102098, 13.866720280158809, 3.87039584751079, 13.996656962276745, 213.8748999959425, 447.06287082417094, 20.664195057161084, 0.0, 272.5023109254119, 74.48949645456834, 65.65875256631354, 2.778483810636258, 109.4817251667006, 259.0753889502709, 17.71572800743326, 37.53264807023729, 327.8860216125344, 55.96445670124845, 6.216693554444408, 67.48995870377955, 97.4991186833641, 125.60565778191197, 0.8880546837915496, 49.41337346415299, 59.03294608408955, 43.43487541472911, 41.28090531098176, 55.221632452483796, 99.29301103333835, 35.484742727262294, 126.6671565284768, 128.22304455048535, 11.777478154395302, 29.612112993036224, 22.224708617537708, 53.99868085544766, 457.3524397945228, 9.97260395816911, 217.57640911516648, 303.2204952123838, 99.76814210039882, 198.95031359396552, 76.90862762605114, 14.855187816548359, 465.914394270611, 13.95900416150414, 80.32648806843319, 30.440882949653115, 8.648348328801514, 0.0, 31.11592969473842, 35.09106514590384, 56.6264666756767, 397.571475445179, 358.00733549582833, 0.0, 9.839725165814919]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8021857483477842, "mean_inference_ms": 2.4932463037401527, "mean_action_processing_ms": 0.3532150419329171, "mean_env_wait_ms": 0.27922147832704897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00449526309967041, "StateBufferConnector_ms": 0.004985332489013672, "ViewRequirementAgentConnector_ms": 0.15062546730041504}, "num_episodes": 23, "episode_return_max": 372.12073111382495, "episode_return_min": -117.00067426587059, "episode_return_mean": 169.53863964517038, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 254.44557807957955, "num_env_steps_trained_throughput_per_sec": 254.44557807957955, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 15253.747, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15253.69, "sample_time_ms": 2064.937, "learn_time_ms": 13154.561, "learn_throughput": 304.077, "synch_weights_time_ms": 29.106}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 46, "trial_id": "61e09_00000", "date": "2024-08-16_16-18-16", "timestamp": 1723805296, "time_this_iter_s": 15.758340835571289, "time_total_s": 697.1779727935791, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3000cbf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 697.1779727935791, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 59.31739130434784, "ram_util_percent": 82.0217391304348}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9148477578289294, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 0.00010000000000000003, "total_loss": 3.8083898844542325, "policy_loss": -0.0065582649264898565, "vf_loss": 3.8142083385003307, "vf_explained_var": 0.0279624170096463, "kl": 0.009864045375099068, "entropy": 0.5669482101681371, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.356084108478808, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.509709479821422, "policy_loss": -0.0056243314941182105, "vf_loss": 6.512867498650122, "vf_explained_var": 0.025222715625056513, "kl": 0.012331640903946764, "entropy": 1.2775063177895924, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 372.12073111382495, "episode_reward_min": -183.5436626471811, "episode_reward_mean": 165.59923224409883, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -510.1084105523256, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.37661434514507, "predator_policy": 507.08476410385543}, "policy_reward_mean": {"prey_policy": -1.119172343888667, "predator_policy": 83.91878846593809}, "custom_metrics": {}, "hist_stats": {"episode_reward": [94.33000000000028, 280.8899999999999, 246.90000000000006, 209.1205223580459, 265.47999999999985, 320.4799999999999, 315.14337419708005, 89.38002380942754, 78.33611652351689, 280.0054249862356, 182.08999999999975, 3.4199999999999715, 245.8267477300629, 132.8395322025684, 150.31000000000034, 276.19485026089717, 3.4799999999999693, 113.02000000000093, 41.19000000000008, 158.64348563054568, 301.60999999999984, 372.12073111382495, 204.09999999999965, 1.9200000000000017, 123.07000000000025, 96.68686626709984, 164.77564741276154, 3.319999999999972, 167.25, 2.4199999999999897, 330.8519481772131, -98.31189580262034, 168.23000000000008, 362.4134859037964, 277.10999999999933, 2.2199999999999953, 113.82000000000046, 197.58588402146387, 183.84351501790024, 35.369999999999976, 307.3299999999999, 142.10000000000014, 200.8414654053422, 129.40092372027226, 175.71000000000004, -10.33568448196302, 170.67000000000002, 327.9398014029524, 77.32999999999998, 325.5300000000001, 186.85386957962115, 334.1781769269787, 187.3635223125164, 181.42614998094353, 351.24308249602336, 43.99999999999971, 2.109999999999986, 141.7100000000002, 268.5708003242244, 3.509999999999966, 93.73027943471834, 11.741923135033748, 332.3460170313984, 202.10436638005757, 41.879999999999995, 190.3590356181825, 333.4612201445675, 227.9799999999998, 180.51000000000047, 272.50000000000006, 301.55999999999983, -117.00067426587059, 46.04999999999977, -36.49066246247728, 287.3930883791465, 19.970000000000187, 202.44000000000017, 171.96999999999966, 313.1451134932632, 122.44000000000021, 121.00486583606875, 367.2499999999998, 49.11000000000004, 3.979999999999959, 245.25999999999948, 126.83000000000018, 303.3699999999998, 89.11000000000021, 86.09735995935495, 317.32487387286204, 194.97440171666344, -183.5436626471811, 81.91000618841963, 56.22541440452846, 281.52979168111864, 288.00000000000006, 294.45, 276.7220990332936, 190.6999999999997, 126.56000000000022], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-5.33086231535003, 6.699291209352426, 180.16183452265824, 49.691285649920324, -3.9791914738006966, 155.18778182517457, 83.31739774286946, 17.950167955110153, 159.5382902551546, -31.1862560870838, 106.75986687999408, 161.88386527990824, 95.1584276608883, 148.65641044121708, 37.56305713025011, -24.724216084596275, -212.37151010202174, 56.73824462303938, 154.25460267298786, -35.372764934847055, -4.015314154415665, 169.30922850222095, -67.99465870290817, -0.6462258738132429, -3.047255145062202, -77.59886143881522, 6.774631510474521, -1.1794357913653144, 2.0000000000000013, 123.03410719915442, 96.59585588900147, 102.47704052931837, -3.162657366015175, -92.2296136193182, 102.19125661621986, -255.76787175554165, -134.92695500274132, -8.575173448820108, 8.31281314554792, -24.17748105682672, 183.17000000000002, 64.26092563330593, 167.65792489716426, 22.357768976466517, 15.291433831023557, 36.26365814292089, -317.38270056830277, -124.66964472091102, -88.8462466428887, 100.81245311275822, -70.36362748739059, -8.655803226958263, -306.235325610001, 147.86890302828988, -90.4842731506098, -1.2143196113991153, 161.07205568829755, -5.215901273506843, -182.33466690769276, -86.39726501171515, 157.74859222393002, 146.94053567704415, -329.47705835526136, -153.8355536577374, 161.16554291062798, -5.951063270036454, 185.70827550095265, 169.12484471745626, 67.19734081950088, 193.37661434514507, -256.6771998271155, -39.62313974985286, 62.12400912344806, -123.23026654810836, 59.57399405800437, 27.2114112180295, -19.083916508454372, 160.08346001781644, -58.63529401653258, 17.410388054152747, 190.23241056029923, 28.965199997365843, 100.95028359374575, -38.524724526626954, -14.430426022723738, -219.67123391590863, 84.55093147930138, 2.0000000000000013, 8.344895432139957, 82.97928039046262, -379.6812881009883, -165.70861950185997, -115.4733476951484, 136.41297566490618, 15.853284493651486, 182.79030702776407, -241.12256633626478, 32.43057704298245, 134.65615152034175, 162.789643380593, 54.77310371532142, -164.64741883280777, 125.2585954003936, 165.62980181635163, 153.45739483875045, -0.6289169027177848, 86.12158967661807, -4.762042604676601, 161.93364957112857, 171.57231679722517, -12.086656962276786, -171.7848999959426, -446.7828708241712, -18.834195057160798, 140.60000000000002, -271.3923109254129, 152.26094861780962, -23.8383973144671, -0.8084838106362735, -107.94172516669981, -192.04762844975437, 8.986790926768501, -174.92691493671683, -178.74983161102048, 155.41570735939064, 114.74915941631508, 2.0000000000000013, 35.11528899291446, 1.1272184165495742, -85.7409308822531, -79.9385606556356, 161.85127672557522, 118.91835831109708, 129.8270811077599, -77.03464348582216, 150.5000000000001, -119.03517966821309, 137.3932804124739, 160.55172060802755, -28.052243312908033, 124.23994234453681, 125.48323604488934, -203.11036002967356, -425.2414348861682, -8.022603958169151, -173.4764091151664, -148.3068883708039, -291.17241140445634, -108.48458875396835, 120.01873591309821, -458.8447562677739, -1.954825819385437, -23.79099132331207, 131.94549909337513, -28.730882949652855, 161.6116516711984, 143.5509195571867, 138.47826424133808, 112.53327745104544, -81.81080927262627, -329.14427942572075, -305.4296656792191, 177.2299999999998, 180.18027483418507, -90.05371869006575, -128.9169017872865, 0.8564713865181844, 1.1493018533542994, 64.71958039867565, 87.95157165301983, -194.8651625624278, 37.27737958195559, 126.4430238281359, 95.69147324057553, -101.67629366194465, -1.1464027881461738, -167.2203994702062, -48.76466623083268, 51.48725762113067, 119.69672584087257, -28.07548014881649, 22.559863765924334, -233.0402361544087, -510.1084105523256, -26.759859930447394, -122.93818000665362, -49.87321012070777, -250.91181516456902, 68.3627429246308, 114.3458258438058, 185.92829484510568, 54.1977019577283, 186.90418013864235, 22.46535766279583, 125.95639916146159, 39.47363915581521, 176.97250286716047, -72.09197308595805, -3.5064226581892974, 102.49529209899688], "policy_predator_policy_reward": [26.88086231535003, 66.0807087906476, 1.0181654773418112, 50.01871435007963, 15.172609749509062, 80.51879989911714, 107.09296579581653, 0.7599908642506334, 63.801872722658054, 73.32609310927138, 40.51013312000587, 11.326134720091657, 37.782911967027644, 33.54562412794704, 71.65936949434605, 4.881813269428141, 230.36889292270536, 3.6004890797936975, 100.10955607958897, 61.014031168505845, 5.965314154415624, 10.830771497779104, 57.59745583375024, 14.463428742970876, 161.42222543084614, 165.05063888309417, 56.251168947180915, 70.99316753627826, 0.0, 25.275892800845526, 19.243680120485475, 57.87827372209266, 58.72535417045668, 40.14691681487636, 9.648743383780479, 256.9478717555406, 174.20695500274118, 10.485173448820067, 168.49738009734926, 6.0107734444752685, 0.0, 54.17907436669407, 101.93345997232721, 80.17157726786675, 120.02259048233911, 32.522317543716376, 318.15270056830207, 125.8196447209116, 90.26624664288943, 20.837546887241874, 173.8187372561418, 1.8875597253078151, 306.82872732341195, 16.313342671060443, 91.83427315060983, 3.1843196113990917, 4.237944311702497, 7.155901273506801, 184.3073450328738, 86.84458688653433, 0.8949211029885072, 25.267899173250797, 5.968929573524409, 379.0317866368543, 5.134457089372129, 7.881063270036415, 7.580365685387494, 0.0, 14.88265918049951, 1.6533856548549295, 257.2271998271158, 41.293139749852564, 115.59276956965932, 59.33348785500065, 27.088814933995298, 83.71166381143446, 19.97995488508586, 22.864016623452287, 67.32529401653345, 9.269611945847217, 33.474405583191825, 54.65798385914301, 28.57971640625432, 51.09472452662664, 255.8288833436153, 179.1142420003597, 13.547633217685934, 29.302359023284406, 36.91510456786001, 47.47071960953735, 458.00058344404425, 77.0536396768406, 117.0333476951492, 32.69702433509388, 126.21589806446634, 3.080311817070517, 241.4425663362646, 44.579422957017606, 9.823848479658233, 18.260356619407005, 176.88464371051253, 119.84354098659503, 30.08140459960654, 13.208375110627445, 23.61260516124958, 10.92243921523455, 43.96621843798266, 56.10038447102098, 13.866720280158809, 3.87039584751079, 13.996656962276745, 213.8748999959425, 447.06287082417094, 20.664195057161084, 0.0, 272.5023109254119, 74.48949645456834, 65.65875256631354, 2.778483810636258, 109.4817251667006, 259.0753889502709, 17.71572800743326, 37.53264807023729, 327.8860216125344, 55.96445670124845, 6.216693554444408, 67.48995870377955, 97.4991186833641, 125.60565778191197, 0.8880546837915496, 49.41337346415299, 59.03294608408955, 43.43487541472911, 41.28090531098176, 55.221632452483796, 99.29301103333835, 35.484742727262294, 126.6671565284768, 128.22304455048535, 11.777478154395302, 29.612112993036224, 22.224708617537708, 53.99868085544766, 457.3524397945228, 9.97260395816911, 217.57640911516648, 303.2204952123838, 99.76814210039882, 198.95031359396552, 76.90862762605114, 14.855187816548359, 465.914394270611, 13.95900416150414, 80.32648806843319, 30.440882949653115, 8.648348328801514, 0.0, 31.11592969473842, 35.09106514590384, 56.6264666756767, 397.571475445179, 358.00733549582833, 0.0, 9.839725165814919, 228.463429922633, 39.61719055471973, 1.133528613481817, 0.840698146645702, 5.540419601324209, 87.04842834698017, 272.437161945445, 11.980621035027054, 73.8226369719946, 7.412865959293876, 14.923998765992518, 177.00869768409837, 295.29402042221466, 6.788405238177688, 116.42162218937429, 29.71926822148457, 4.822658479970656, 195.6673596195849, 507.08476410385543, 52.520219955696845, 95.41872672883865, 136.18931939668178, 10.02742046905451, 346.9830192207499, 14.467445023925873, 84.35377788875644, 2.1717051548943154, 45.70229804227152, 74.46405265541273, 10.61640954314905, 69.84959681004462, 41.44246390597311, 12.037497132839535, 73.78197308595891, 24.981684149045677, 2.5894464101467407]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8066872227374791, "mean_inference_ms": 2.508799089281018, "mean_action_processing_ms": 0.3546789158960293, "mean_env_wait_ms": 0.2813114956281933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050618648529052734, "StateBufferConnector_ms": 0.005011916160583496, "ViewRequirementAgentConnector_ms": 0.21840012073516846}, "num_episodes": 18, "episode_return_max": 372.12073111382495, "episode_return_min": -183.5436626471811, "episode_return_mean": 165.59923224409883, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 242.28017876890183, "num_env_steps_trained_throughput_per_sec": 242.28017876890183, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 15371.602, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15371.545, "sample_time_ms": 2156.878, "learn_time_ms": 13185.35, "learn_throughput": 303.367, "synch_weights_time_ms": 24.517}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 47, "trial_id": "61e09_00000", "date": "2024-08-16_16-18-33", "timestamp": 1723805313, "time_this_iter_s": 16.56547474861145, "time_total_s": 713.7434475421906, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24d31f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 713.7434475421906, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 68.99565217391304, "ram_util_percent": 82.55652173913043}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8711707164686193, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 0.00010000000000000003, "total_loss": 3.841368466457993, "policy_loss": -0.007132103452803912, "vf_loss": 3.847402023638367, "vf_explained_var": 0.051966275708385246, "kl": 0.014647405234261394, "entropy": 0.5313560680422202, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9767593772007674, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.191252351942516, "policy_loss": -0.007833466469679796, "vf_loss": 7.196457062070332, "vf_explained_var": 0.041579005642542764, "kl": 0.013143810245474783, "entropy": 1.2700211128860555, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 372.12073111382495, "episode_reward_min": -235.07856184822072, "episode_reward_mean": 162.87834461587744, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -644.697923747826, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.37661434514507, "predator_policy": 586.9321026131128}, "policy_reward_mean": {"prey_policy": -19.95115682576375, "predator_policy": 101.3903291337025}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.19000000000008, 158.64348563054568, 301.60999999999984, 372.12073111382495, 204.09999999999965, 1.9200000000000017, 123.07000000000025, 96.68686626709984, 164.77564741276154, 3.319999999999972, 167.25, 2.4199999999999897, 330.8519481772131, -98.31189580262034, 168.23000000000008, 362.4134859037964, 277.10999999999933, 2.2199999999999953, 113.82000000000046, 197.58588402146387, 183.84351501790024, 35.369999999999976, 307.3299999999999, 142.10000000000014, 200.8414654053422, 129.40092372027226, 175.71000000000004, -10.33568448196302, 170.67000000000002, 327.9398014029524, 77.32999999999998, 325.5300000000001, 186.85386957962115, 334.1781769269787, 187.3635223125164, 181.42614998094353, 351.24308249602336, 43.99999999999971, 2.109999999999986, 141.7100000000002, 268.5708003242244, 3.509999999999966, 93.73027943471834, 11.741923135033748, 332.3460170313984, 202.10436638005757, 41.879999999999995, 190.3590356181825, 333.4612201445675, 227.9799999999998, 180.51000000000047, 272.50000000000006, 301.55999999999983, -117.00067426587059, 46.04999999999977, -36.49066246247728, 287.3930883791465, 19.970000000000187, 202.44000000000017, 171.96999999999966, 313.1451134932632, 122.44000000000021, 121.00486583606875, 367.2499999999998, 49.11000000000004, 3.979999999999959, 245.25999999999948, 126.83000000000018, 303.3699999999998, 89.11000000000021, 86.09735995935495, 317.32487387286204, 194.97440171666344, -183.5436626471811, 81.91000618841963, 56.22541440452846, 281.52979168111864, 288.00000000000006, 294.45, 276.7220990332936, 190.6999999999997, 126.56000000000022, 133.92136779469206, -10.367682192933549, -235.07856184822072, 239.19789879710177, 283.5924558061944, 168.91999999999996, 346.09412326476956, 16.236745212446007, 289.54886536189593, 115.51000000000035, 288.1655588760277, 371.22, 73.07704125453634, 19.671304780330328, 327.2599999999998, 145.9814733804306, 184.83723875842884, 257.36999999999966], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-134.92695500274132, -8.575173448820108, 8.31281314554792, -24.17748105682672, 183.17000000000002, 64.26092563330593, 167.65792489716426, 22.357768976466517, 15.291433831023557, 36.26365814292089, -317.38270056830277, -124.66964472091102, -88.8462466428887, 100.81245311275822, -70.36362748739059, -8.655803226958263, -306.235325610001, 147.86890302828988, -90.4842731506098, -1.2143196113991153, 161.07205568829755, -5.215901273506843, -182.33466690769276, -86.39726501171515, 157.74859222393002, 146.94053567704415, -329.47705835526136, -153.8355536577374, 161.16554291062798, -5.951063270036454, 185.70827550095265, 169.12484471745626, 67.19734081950088, 193.37661434514507, -256.6771998271155, -39.62313974985286, 62.12400912344806, -123.23026654810836, 59.57399405800437, 27.2114112180295, -19.083916508454372, 160.08346001781644, -58.63529401653258, 17.410388054152747, 190.23241056029923, 28.965199997365843, 100.95028359374575, -38.524724526626954, -14.430426022723738, -219.67123391590863, 84.55093147930138, 2.0000000000000013, 8.344895432139957, 82.97928039046262, -379.6812881009883, -165.70861950185997, -115.4733476951484, 136.41297566490618, 15.853284493651486, 182.79030702776407, -241.12256633626478, 32.43057704298245, 134.65615152034175, 162.789643380593, 54.77310371532142, -164.64741883280777, 125.2585954003936, 165.62980181635163, 153.45739483875045, -0.6289169027177848, 86.12158967661807, -4.762042604676601, 161.93364957112857, 171.57231679722517, -12.086656962276786, -171.7848999959426, -446.7828708241712, -18.834195057160798, 140.60000000000002, -271.3923109254129, 152.26094861780962, -23.8383973144671, -0.8084838106362735, -107.94172516669981, -192.04762844975437, 8.986790926768501, -174.92691493671683, -178.74983161102048, 155.41570735939064, 114.74915941631508, 2.0000000000000013, 35.11528899291446, 1.1272184165495742, -85.7409308822531, -79.9385606556356, 161.85127672557522, 118.91835831109708, 129.8270811077599, -77.03464348582216, 150.5000000000001, -119.03517966821309, 137.3932804124739, 160.55172060802755, -28.052243312908033, 124.23994234453681, 125.48323604488934, -203.11036002967356, -425.2414348861682, -8.022603958169151, -173.4764091151664, -148.3068883708039, -291.17241140445634, -108.48458875396835, 120.01873591309821, -458.8447562677739, -1.954825819385437, -23.79099132331207, 131.94549909337513, -28.730882949652855, 161.6116516711984, 143.5509195571867, 138.47826424133808, 112.53327745104544, -81.81080927262627, -329.14427942572075, -305.4296656792191, 177.2299999999998, 180.18027483418507, -90.05371869006575, -128.9169017872865, 0.8564713865181844, 1.1493018533542994, 64.71958039867565, 87.95157165301983, -194.8651625624278, 37.27737958195559, 126.4430238281359, 95.69147324057553, -101.67629366194465, -1.1464027881461738, -167.2203994702062, -48.76466623083268, 51.48725762113067, 119.69672584087257, -28.07548014881649, 22.559863765924334, -233.0402361544087, -510.1084105523256, -26.759859930447394, -122.93818000665362, -49.87321012070777, -250.91181516456902, 68.3627429246308, 114.3458258438058, 185.92829484510568, 54.1977019577283, 186.90418013864235, 22.46535766279583, 125.95639916146159, 39.47363915581521, 176.97250286716047, -72.09197308595805, -3.5064226581892974, 102.49529209899688, -335.6988594354899, -644.697923747826, -251.4005320296987, -235.62085243564164, -338.597518326564, -451.14616768996274, 49.26075211749432, 84.60981863729114, -510.93061641209937, -262.045118283488, -67.315795349245, 160.92730236966702, 148.00219732396755, 160.60103808365028, -65.55463111663214, -195.08924010585343, 110.12863364197433, 4.0144034643690105, -100.55089055969994, 17.328914757857177, 125.35238057270062, 40.436462888891434, 173.74832717313956, 188.53779797627948, -224.22716262182982, -240.43625508282764, -174.3531236265899, -104.96188693724706, 185.54542885089324, 35.54061770106953, -20.29270025253811, -106.70022354530948, 85.04618111923438, -45.09529896552375, 132.6799999999999, 103.89359272053194], "policy_predator_policy_reward": [174.20695500274118, 10.485173448820067, 168.49738009734926, 6.0107734444752685, 0.0, 54.17907436669407, 101.93345997232721, 80.17157726786675, 120.02259048233911, 32.522317543716376, 318.15270056830207, 125.8196447209116, 90.26624664288943, 20.837546887241874, 173.8187372561418, 1.8875597253078151, 306.82872732341195, 16.313342671060443, 91.83427315060983, 3.1843196113990917, 4.237944311702497, 7.155901273506801, 184.3073450328738, 86.84458688653433, 0.8949211029885072, 25.267899173250797, 5.968929573524409, 379.0317866368543, 5.134457089372129, 7.881063270036415, 7.580365685387494, 0.0, 14.88265918049951, 1.6533856548549295, 257.2271998271158, 41.293139749852564, 115.59276956965932, 59.33348785500065, 27.088814933995298, 83.71166381143446, 19.97995488508586, 22.864016623452287, 67.32529401653345, 9.269611945847217, 33.474405583191825, 54.65798385914301, 28.57971640625432, 51.09472452662664, 255.8288833436153, 179.1142420003597, 13.547633217685934, 29.302359023284406, 36.91510456786001, 47.47071960953735, 458.00058344404425, 77.0536396768406, 117.0333476951492, 32.69702433509388, 126.21589806446634, 3.080311817070517, 241.4425663362646, 44.579422957017606, 9.823848479658233, 18.260356619407005, 176.88464371051253, 119.84354098659503, 30.08140459960654, 13.208375110627445, 23.61260516124958, 10.92243921523455, 43.96621843798266, 56.10038447102098, 13.866720280158809, 3.87039584751079, 13.996656962276745, 213.8748999959425, 447.06287082417094, 20.664195057161084, 0.0, 272.5023109254119, 74.48949645456834, 65.65875256631354, 2.778483810636258, 109.4817251667006, 259.0753889502709, 17.71572800743326, 37.53264807023729, 327.8860216125344, 55.96445670124845, 6.216693554444408, 67.48995870377955, 97.4991186833641, 125.60565778191197, 0.8880546837915496, 49.41337346415299, 59.03294608408955, 43.43487541472911, 41.28090531098176, 55.221632452483796, 99.29301103333835, 35.484742727262294, 126.6671565284768, 128.22304455048535, 11.777478154395302, 29.612112993036224, 22.224708617537708, 53.99868085544766, 457.3524397945228, 9.97260395816911, 217.57640911516648, 303.2204952123838, 99.76814210039882, 198.95031359396552, 76.90862762605114, 14.855187816548359, 465.914394270611, 13.95900416150414, 80.32648806843319, 30.440882949653115, 8.648348328801514, 0.0, 31.11592969473842, 35.09106514590384, 56.6264666756767, 397.571475445179, 358.00733549582833, 0.0, 9.839725165814919, 228.463429922633, 39.61719055471973, 1.133528613481817, 0.840698146645702, 5.540419601324209, 87.04842834698017, 272.437161945445, 11.980621035027054, 73.8226369719946, 7.412865959293876, 14.923998765992518, 177.00869768409837, 295.29402042221466, 6.788405238177688, 116.42162218937429, 29.71926822148457, 4.822658479970656, 195.6673596195849, 507.08476410385543, 52.520219955696845, 95.41872672883865, 136.18931939668178, 10.02742046905451, 346.9830192207499, 14.467445023925873, 84.35377788875644, 2.1717051548943154, 45.70229804227152, 74.46405265541273, 10.61640954314905, 69.84959681004462, 41.44246390597311, 12.037497132839535, 73.78197308595891, 24.981684149045677, 2.5894464101467407, 586.9321026131128, 527.3860483648959, 348.72017459591024, 127.93352767649625, 53.75532365952486, 500.90980050878113, 13.50729098399159, 91.8200370583247, 515.8619317363034, 540.7062587654776, 68.94579534924577, 6.362697630333025, 12.910321733746308, 24.580566123405575, 255.11878093724482, 21.761835497686842, 106.42613804177208, 68.97969021378047, 101.65089055970047, 97.08108524214299, 49.13428237491086, 73.242433039525, 3.451672826860444, 5.482202023720509, 338.15781051771546, 199.5826484414781, 82.21127507057756, 216.77504027359012, 11.294797550219414, 94.87915589781778, 14.806327625255111, 258.16806955302343, 111.28122099330432, 33.60513561141406, 0.0, 20.79640727946825]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8164746266044415, "mean_inference_ms": 2.5371520893283264, "mean_action_processing_ms": 0.3581710872164426, "mean_env_wait_ms": 0.28487469280086203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011171698570251465, "StateBufferConnector_ms": 0.006048083305358887, "ViewRequirementAgentConnector_ms": 0.28359127044677734}, "num_episodes": 18, "episode_return_max": 372.12073111382495, "episode_return_min": -235.07856184822072, "episode_return_mean": 162.87834461587744, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 249.90252482161327, "num_env_steps_trained_throughput_per_sec": 249.90252482161327, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 15380.022, "restore_workers_time_ms": 0.016, "training_step_time_ms": 15379.965, "sample_time_ms": 2372.093, "learn_time_ms": 12980.166, "learn_throughput": 308.162, "synch_weights_time_ms": 23.135}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 48, "trial_id": "61e09_00000", "date": "2024-08-16_16-18-49", "timestamp": 1723805329, "time_this_iter_s": 16.037200927734375, "time_total_s": 729.7806484699249, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30000bca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 729.7806484699249, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 65.71304347826087, "ram_util_percent": 82.0391304347826}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5376000148278695, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 0.00010000000000000003, "total_loss": 4.735233339556942, "policy_loss": -0.009254168376336417, "vf_loss": 4.743388168269364, "vf_explained_var": 0.06151525769284163, "kl": 0.014657801670933454, "entropy": 0.4635992941086885, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5334864037377494, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.919800045629027, "policy_loss": -0.007255658755946175, "vf_loss": 7.924896556612045, "vf_explained_var": 0.07546829190203752, "kl": 0.010795761224061933, "entropy": 1.2749756038504303, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 371.22, "episode_reward_min": -235.07856184822072, "episode_reward_mean": 158.27434070896885, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -644.697923747826, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 190.23241056029923, "predator_policy": 586.9321026131128}, "policy_reward_mean": {"prey_policy": -34.03970539391005, "predator_policy": 113.17687574839448}, "custom_metrics": {}, "hist_stats": {"episode_reward": [307.3299999999999, 142.10000000000014, 200.8414654053422, 129.40092372027226, 175.71000000000004, -10.33568448196302, 170.67000000000002, 327.9398014029524, 77.32999999999998, 325.5300000000001, 186.85386957962115, 334.1781769269787, 187.3635223125164, 181.42614998094353, 351.24308249602336, 43.99999999999971, 2.109999999999986, 141.7100000000002, 268.5708003242244, 3.509999999999966, 93.73027943471834, 11.741923135033748, 332.3460170313984, 202.10436638005757, 41.879999999999995, 190.3590356181825, 333.4612201445675, 227.9799999999998, 180.51000000000047, 272.50000000000006, 301.55999999999983, -117.00067426587059, 46.04999999999977, -36.49066246247728, 287.3930883791465, 19.970000000000187, 202.44000000000017, 171.96999999999966, 313.1451134932632, 122.44000000000021, 121.00486583606875, 367.2499999999998, 49.11000000000004, 3.979999999999959, 245.25999999999948, 126.83000000000018, 303.3699999999998, 89.11000000000021, 86.09735995935495, 317.32487387286204, 194.97440171666344, -183.5436626471811, 81.91000618841963, 56.22541440452846, 281.52979168111864, 288.00000000000006, 294.45, 276.7220990332936, 190.6999999999997, 126.56000000000022, 133.92136779469206, -10.367682192933549, -235.07856184822072, 239.19789879710177, 283.5924558061944, 168.91999999999996, 346.09412326476956, 16.236745212446007, 289.54886536189593, 115.51000000000035, 288.1655588760277, 371.22, 73.07704125453634, 19.671304780330328, 327.2599999999998, 145.9814733804306, 184.83723875842884, 257.36999999999966, 159.29999999999967, 207.06, 63.4714155697358, 19.23043925299173, -214.85018282561424, 56.28675481159546, -38.83111126023059, 65.98999999999967, 99.21000000000004, 222.74254638613354, 2.5899999999999883, 240.1762856053535, 300.64812287295183, 124.40000000000057, 34.18999999999999, 8.749999999999996, 105.81663469680817, 340.98681619403123, 252.58582496463123, 258.6440656359275, 274.5599999999997, 166.88166514680967], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [190.23241056029923, 28.965199997365843, 100.95028359374575, -38.524724526626954, -14.430426022723738, -219.67123391590863, 84.55093147930138, 2.0000000000000013, 8.344895432139957, 82.97928039046262, -379.6812881009883, -165.70861950185997, -115.4733476951484, 136.41297566490618, 15.853284493651486, 182.79030702776407, -241.12256633626478, 32.43057704298245, 134.65615152034175, 162.789643380593, 54.77310371532142, -164.64741883280777, 125.2585954003936, 165.62980181635163, 153.45739483875045, -0.6289169027177848, 86.12158967661807, -4.762042604676601, 161.93364957112857, 171.57231679722517, -12.086656962276786, -171.7848999959426, -446.7828708241712, -18.834195057160798, 140.60000000000002, -271.3923109254129, 152.26094861780962, -23.8383973144671, -0.8084838106362735, -107.94172516669981, -192.04762844975437, 8.986790926768501, -174.92691493671683, -178.74983161102048, 155.41570735939064, 114.74915941631508, 2.0000000000000013, 35.11528899291446, 1.1272184165495742, -85.7409308822531, -79.9385606556356, 161.85127672557522, 118.91835831109708, 129.8270811077599, -77.03464348582216, 150.5000000000001, -119.03517966821309, 137.3932804124739, 160.55172060802755, -28.052243312908033, 124.23994234453681, 125.48323604488934, -203.11036002967356, -425.2414348861682, -8.022603958169151, -173.4764091151664, -148.3068883708039, -291.17241140445634, -108.48458875396835, 120.01873591309821, -458.8447562677739, -1.954825819385437, -23.79099132331207, 131.94549909337513, -28.730882949652855, 161.6116516711984, 143.5509195571867, 138.47826424133808, 112.53327745104544, -81.81080927262627, -329.14427942572075, -305.4296656792191, 177.2299999999998, 180.18027483418507, -90.05371869006575, -128.9169017872865, 0.8564713865181844, 1.1493018533542994, 64.71958039867565, 87.95157165301983, -194.8651625624278, 37.27737958195559, 126.4430238281359, 95.69147324057553, -101.67629366194465, -1.1464027881461738, -167.2203994702062, -48.76466623083268, 51.48725762113067, 119.69672584087257, -28.07548014881649, 22.559863765924334, -233.0402361544087, -510.1084105523256, -26.759859930447394, -122.93818000665362, -49.87321012070777, -250.91181516456902, 68.3627429246308, 114.3458258438058, 185.92829484510568, 54.1977019577283, 186.90418013864235, 22.46535766279583, 125.95639916146159, 39.47363915581521, 176.97250286716047, -72.09197308595805, -3.5064226581892974, 102.49529209899688, -335.6988594354899, -644.697923747826, -251.4005320296987, -235.62085243564164, -338.597518326564, -451.14616768996274, 49.26075211749432, 84.60981863729114, -510.93061641209937, -262.045118283488, -67.315795349245, 160.92730236966702, 148.00219732396755, 160.60103808365028, -65.55463111663214, -195.08924010585343, 110.12863364197433, 4.0144034643690105, -100.55089055969994, 17.328914757857177, 125.35238057270062, 40.436462888891434, 173.74832717313956, 188.53779797627948, -224.22716262182982, -240.43625508282764, -174.3531236265899, -104.96188693724706, 185.54542885089324, 35.54061770106953, -20.29270025253811, -106.70022354530948, 85.04618111923438, -45.09529896552375, 132.6799999999999, 103.89359272053194, 0.21846135285394291, 146.60089703538839, -89.74840341481992, 122.24039944988125, -85.39389635937479, 0.8741926832319831, -390.05198304146523, -28.811867265429743, -353.5832444331463, -398.60955914280515, -226.9894721415824, -83.9707264113307, -209.6601804189173, -128.03970045512258, -297.08590320458666, -126.16605107498859, 39.8297891793716, -198.58661316773788, 0.6122719068885036, 129.7641501044081, 0.9006357319978143, -209.80492139288768, 50.14001089865477, 151.8528945145608, -410.9129786387288, -51.98704064277709, -186.4514916822669, 36.823305516144146, -201.07301446311723, 2.0000000000000013, -308.02385467053523, -180.42700125334412, 3.835853982012253, -103.2808876547183, 20.078098716946755, 161.0408885390492, 29.465008779016284, 118.59903610626377, 53.57869541785032, 72.1455926326883, 80.81989694167373, -2.3932379014693765, 77.44512065976059, 33.21718452226882], "policy_predator_policy_reward": [33.474405583191825, 54.65798385914301, 28.57971640625432, 51.09472452662664, 255.8288833436153, 179.1142420003597, 13.547633217685934, 29.302359023284406, 36.91510456786001, 47.47071960953735, 458.00058344404425, 77.0536396768406, 117.0333476951492, 32.69702433509388, 126.21589806446634, 3.080311817070517, 241.4425663362646, 44.579422957017606, 9.823848479658233, 18.260356619407005, 176.88464371051253, 119.84354098659503, 30.08140459960654, 13.208375110627445, 23.61260516124958, 10.92243921523455, 43.96621843798266, 56.10038447102098, 13.866720280158809, 3.87039584751079, 13.996656962276745, 213.8748999959425, 447.06287082417094, 20.664195057161084, 0.0, 272.5023109254119, 74.48949645456834, 65.65875256631354, 2.778483810636258, 109.4817251667006, 259.0753889502709, 17.71572800743326, 37.53264807023729, 327.8860216125344, 55.96445670124845, 6.216693554444408, 67.48995870377955, 97.4991186833641, 125.60565778191197, 0.8880546837915496, 49.41337346415299, 59.03294608408955, 43.43487541472911, 41.28090531098176, 55.221632452483796, 99.29301103333835, 35.484742727262294, 126.6671565284768, 128.22304455048535, 11.777478154395302, 29.612112993036224, 22.224708617537708, 53.99868085544766, 457.3524397945228, 9.97260395816911, 217.57640911516648, 303.2204952123838, 99.76814210039882, 198.95031359396552, 76.90862762605114, 14.855187816548359, 465.914394270611, 13.95900416150414, 80.32648806843319, 30.440882949653115, 8.648348328801514, 0.0, 31.11592969473842, 35.09106514590384, 56.6264666756767, 397.571475445179, 358.00733549582833, 0.0, 9.839725165814919, 228.463429922633, 39.61719055471973, 1.133528613481817, 0.840698146645702, 5.540419601324209, 87.04842834698017, 272.437161945445, 11.980621035027054, 73.8226369719946, 7.412865959293876, 14.923998765992518, 177.00869768409837, 295.29402042221466, 6.788405238177688, 116.42162218937429, 29.71926822148457, 4.822658479970656, 195.6673596195849, 507.08476410385543, 52.520219955696845, 95.41872672883865, 136.18931939668178, 10.02742046905451, 346.9830192207499, 14.467445023925873, 84.35377788875644, 2.1717051548943154, 45.70229804227152, 74.46405265541273, 10.61640954314905, 69.84959681004462, 41.44246390597311, 12.037497132839535, 73.78197308595891, 24.981684149045677, 2.5894464101467407, 586.9321026131128, 527.3860483648959, 348.72017459591024, 127.93352767649625, 53.75532365952486, 500.90980050878113, 13.50729098399159, 91.8200370583247, 515.8619317363034, 540.7062587654776, 68.94579534924577, 6.362697630333025, 12.910321733746308, 24.580566123405575, 255.11878093724482, 21.761835497686842, 106.42613804177208, 68.97969021378047, 101.65089055970047, 97.08108524214299, 49.13428237491086, 73.242433039525, 3.451672826860444, 5.482202023720509, 338.15781051771546, 199.5826484414781, 82.21127507057756, 216.77504027359012, 11.294797550219414, 94.87915589781778, 14.806327625255111, 258.16806955302343, 111.28122099330432, 33.60513561141406, 0.0, 20.79640727946825, 3.319717088741328, 9.160924523016163, 24.77405028814545, 149.79395367679322, 7.791573197810796, 140.19954604806725, 424.074573217596, 14.019716342290213, 26.85075422769059, 510.49186652264626, 309.12858505201206, 58.118368312496614, 20.709297569189474, 278.15947204462003, 362.1459032045866, 127.09605107498906, 59.03021082062823, 198.9366131677377, 0.0, 92.36612437483736, 1.089364268002187, 210.40492139288773, 1.0327082193766626, 37.15067197276173, 425.033098066578, 338.5150440878802, 14.828068525858871, 259.200117640263, 12.141453928734437, 221.12156053438275, 308.1438546705351, 189.05700125334408, 201.8682931586383, 3.393375210875657, 95.10623665080416, 64.76159228723111, 61.47406764996036, 43.047712429392185, 34.319613506577824, 98.60016407881159, 153.143814084478, 42.98952687531764, 34.11505114217544, 22.104308822605088]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8304681924199119, "mean_inference_ms": 2.570713055778812, "mean_action_processing_ms": 0.3624768074687282, "mean_env_wait_ms": 0.2890917649109606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012032032012939453, "StateBufferConnector_ms": 0.006055355072021484, "ViewRequirementAgentConnector_ms": 0.29742228984832764}, "num_episodes": 22, "episode_return_max": 371.22, "episode_return_min": -235.07856184822072, "episode_return_mean": 158.27434070896885, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 264.5076152523057, "num_env_steps_trained_throughput_per_sec": 264.5076152523057, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 15396.261, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15396.204, "sample_time_ms": 2434.349, "learn_time_ms": 12934.63, "learn_throughput": 309.247, "synch_weights_time_ms": 22.736}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 49, "trial_id": "61e09_00000", "date": "2024-08-16_16-19-04", "timestamp": 1723805344, "time_this_iter_s": 15.191647052764893, "time_total_s": 744.9722955226898, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24af9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 744.9722955226898, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 64.4857142857143, "ram_util_percent": 81.47619047619048}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.013439814454664, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 0.00010000000000000003, "total_loss": 4.974405075254895, "policy_loss": -0.008402978095457588, "vf_loss": 4.982360619842691, "vf_explained_var": 0.11059428901268692, "kl": 0.005965764639206179, "entropy": 0.3196181833113312, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.430748108518187, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.685220229436481, "policy_loss": -0.007371846559363856, "vf_loss": 7.690440243009537, "vf_explained_var": -0.1137529834237679, "kl": 0.01075931028270849, "entropy": 1.2722224380604175, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 371.22, "episode_reward_min": -235.07856184822072, "episode_reward_mean": 139.1723094896796, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -644.697923747826, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 188.53779797627948, "predator_policy": 586.9321026131128}, "policy_reward_mean": {"prey_policy": -48.76208560893587, "predator_policy": 118.34824035377565}, "custom_metrics": {}, "hist_stats": {"episode_reward": [202.10436638005757, 41.879999999999995, 190.3590356181825, 333.4612201445675, 227.9799999999998, 180.51000000000047, 272.50000000000006, 301.55999999999983, -117.00067426587059, 46.04999999999977, -36.49066246247728, 287.3930883791465, 19.970000000000187, 202.44000000000017, 171.96999999999966, 313.1451134932632, 122.44000000000021, 121.00486583606875, 367.2499999999998, 49.11000000000004, 3.979999999999959, 245.25999999999948, 126.83000000000018, 303.3699999999998, 89.11000000000021, 86.09735995935495, 317.32487387286204, 194.97440171666344, -183.5436626471811, 81.91000618841963, 56.22541440452846, 281.52979168111864, 288.00000000000006, 294.45, 276.7220990332936, 190.6999999999997, 126.56000000000022, 133.92136779469206, -10.367682192933549, -235.07856184822072, 239.19789879710177, 283.5924558061944, 168.91999999999996, 346.09412326476956, 16.236745212446007, 289.54886536189593, 115.51000000000035, 288.1655588760277, 371.22, 73.07704125453634, 19.671304780330328, 327.2599999999998, 145.9814733804306, 184.83723875842884, 257.36999999999966, 159.29999999999967, 207.06, 63.4714155697358, 19.23043925299173, -214.85018282561424, 56.28675481159546, -38.83111126023059, 65.98999999999967, 99.21000000000004, 222.74254638613354, 2.5899999999999883, 240.1762856053535, 300.64812287295183, 124.40000000000057, 34.18999999999999, 8.749999999999996, 105.81663469680817, 340.98681619403123, 252.58582496463123, 258.6440656359275, 274.5599999999997, 166.88166514680967, 26.350000000000115, -39.31197107847762, 55.96999999999995, 18.260000000000044, 19.226259117665236, 38.348470656894825, 164.82175697250494, 139.08083269306576, 267.8563280974124, 122.01202895129714, 191.75999999999968, 182.33010210995116, 173.26934664779805, 63.20536884807799, 243.8699999999999, 95.66628402950339, 75.9899999999996, 27.330000000000226, 3.3099999999999734, 74.80673689138567, -25.173766325071796, 101.09000000000104, 55.029427727131534], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [2.0000000000000013, 35.11528899291446, 1.1272184165495742, -85.7409308822531, -79.9385606556356, 161.85127672557522, 118.91835831109708, 129.8270811077599, -77.03464348582216, 150.5000000000001, -119.03517966821309, 137.3932804124739, 160.55172060802755, -28.052243312908033, 124.23994234453681, 125.48323604488934, -203.11036002967356, -425.2414348861682, -8.022603958169151, -173.4764091151664, -148.3068883708039, -291.17241140445634, -108.48458875396835, 120.01873591309821, -458.8447562677739, -1.954825819385437, -23.79099132331207, 131.94549909337513, -28.730882949652855, 161.6116516711984, 143.5509195571867, 138.47826424133808, 112.53327745104544, -81.81080927262627, -329.14427942572075, -305.4296656792191, 177.2299999999998, 180.18027483418507, -90.05371869006575, -128.9169017872865, 0.8564713865181844, 1.1493018533542994, 64.71958039867565, 87.95157165301983, -194.8651625624278, 37.27737958195559, 126.4430238281359, 95.69147324057553, -101.67629366194465, -1.1464027881461738, -167.2203994702062, -48.76466623083268, 51.48725762113067, 119.69672584087257, -28.07548014881649, 22.559863765924334, -233.0402361544087, -510.1084105523256, -26.759859930447394, -122.93818000665362, -49.87321012070777, -250.91181516456902, 68.3627429246308, 114.3458258438058, 185.92829484510568, 54.1977019577283, 186.90418013864235, 22.46535766279583, 125.95639916146159, 39.47363915581521, 176.97250286716047, -72.09197308595805, -3.5064226581892974, 102.49529209899688, -335.6988594354899, -644.697923747826, -251.4005320296987, -235.62085243564164, -338.597518326564, -451.14616768996274, 49.26075211749432, 84.60981863729114, -510.93061641209937, -262.045118283488, -67.315795349245, 160.92730236966702, 148.00219732396755, 160.60103808365028, -65.55463111663214, -195.08924010585343, 110.12863364197433, 4.0144034643690105, -100.55089055969994, 17.328914757857177, 125.35238057270062, 40.436462888891434, 173.74832717313956, 188.53779797627948, -224.22716262182982, -240.43625508282764, -174.3531236265899, -104.96188693724706, 185.54542885089324, 35.54061770106953, -20.29270025253811, -106.70022354530948, 85.04618111923438, -45.09529896552375, 132.6799999999999, 103.89359272053194, 0.21846135285394291, 146.60089703538839, -89.74840341481992, 122.24039944988125, -85.39389635937479, 0.8741926832319831, -390.05198304146523, -28.811867265429743, -353.5832444331463, -398.60955914280515, -226.9894721415824, -83.9707264113307, -209.6601804189173, -128.03970045512258, -297.08590320458666, -126.16605107498859, 39.8297891793716, -198.58661316773788, 0.6122719068885036, 129.7641501044081, 0.9006357319978143, -209.80492139288768, 50.14001089865477, 151.8528945145608, -410.9129786387288, -51.98704064277709, -186.4514916822669, 36.823305516144146, -201.07301446311723, 2.0000000000000013, -308.02385467053523, -180.42700125334412, 3.835853982012253, -103.2808876547183, 20.078098716946755, 161.0408885390492, 29.465008779016284, 118.59903610626377, 53.57869541785032, 72.1455926326883, 80.81989694167373, -2.3932379014693765, 77.44512065976059, 33.21718452226882, 0.22524814055101422, -182.05461120421194, -191.42989892683417, -227.1728357258726, -68.55048133767846, 51.05740856167387, -18.647391268124313, -89.94232842417414, -48.075243783310555, -226.5358933860651, -133.77843298836717, -22.086654953603887, 12.909963360511568, -18.156080759346008, -141.8524302810434, 108.87908534781037, 72.29990970032941, 123.5295724360191, -178.08592261959964, -146.08369291079933, -170.14763881855583, 113.57825278587909, -49.306212213653254, -6.900510058377106, 27.64489819701778, 11.359601104543254, -163.43156089140427, -146.89845381614214, 134.13281429587252, -24.822518525308077, -216.7681557682204, -169.4886540333781, -40.85003882004026, 69.03459612919775, -153.65466271549678, -40.273213089498, -9.261913820565029, -97.9439490983296, -107.83848030249605, -167.4819901778855, -107.65999667080844, -454.5050114439646, -61.67842485715462, 70.22176370554659, -79.1695261759965, -68.94584767816696], "policy_predator_policy_reward": [67.48995870377955, 97.4991186833641, 125.60565778191197, 0.8880546837915496, 49.41337346415299, 59.03294608408955, 43.43487541472911, 41.28090531098176, 55.221632452483796, 99.29301103333835, 35.484742727262294, 126.6671565284768, 128.22304455048535, 11.777478154395302, 29.612112993036224, 22.224708617537708, 53.99868085544766, 457.3524397945228, 9.97260395816911, 217.57640911516648, 303.2204952123838, 99.76814210039882, 198.95031359396552, 76.90862762605114, 14.855187816548359, 465.914394270611, 13.95900416150414, 80.32648806843319, 30.440882949653115, 8.648348328801514, 0.0, 31.11592969473842, 35.09106514590384, 56.6264666756767, 397.571475445179, 358.00733549582833, 0.0, 9.839725165814919, 228.463429922633, 39.61719055471973, 1.133528613481817, 0.840698146645702, 5.540419601324209, 87.04842834698017, 272.437161945445, 11.980621035027054, 73.8226369719946, 7.412865959293876, 14.923998765992518, 177.00869768409837, 295.29402042221466, 6.788405238177688, 116.42162218937429, 29.71926822148457, 4.822658479970656, 195.6673596195849, 507.08476410385543, 52.520219955696845, 95.41872672883865, 136.18931939668178, 10.02742046905451, 346.9830192207499, 14.467445023925873, 84.35377788875644, 2.1717051548943154, 45.70229804227152, 74.46405265541273, 10.61640954314905, 69.84959681004462, 41.44246390597311, 12.037497132839535, 73.78197308595891, 24.981684149045677, 2.5894464101467407, 586.9321026131128, 527.3860483648959, 348.72017459591024, 127.93352767649625, 53.75532365952486, 500.90980050878113, 13.50729098399159, 91.8200370583247, 515.8619317363034, 540.7062587654776, 68.94579534924577, 6.362697630333025, 12.910321733746308, 24.580566123405575, 255.11878093724482, 21.761835497686842, 106.42613804177208, 68.97969021378047, 101.65089055970047, 97.08108524214299, 49.13428237491086, 73.242433039525, 3.451672826860444, 5.482202023720509, 338.15781051771546, 199.5826484414781, 82.21127507057756, 216.77504027359012, 11.294797550219414, 94.87915589781778, 14.806327625255111, 258.16806955302343, 111.28122099330432, 33.60513561141406, 0.0, 20.79640727946825, 3.319717088741328, 9.160924523016163, 24.77405028814545, 149.79395367679322, 7.791573197810796, 140.19954604806725, 424.074573217596, 14.019716342290213, 26.85075422769059, 510.49186652264626, 309.12858505201206, 58.118368312496614, 20.709297569189474, 278.15947204462003, 362.1459032045866, 127.09605107498906, 59.03021082062823, 198.9366131677377, 0.0, 92.36612437483736, 1.089364268002187, 210.40492139288773, 1.0327082193766626, 37.15067197276173, 425.033098066578, 338.5150440878802, 14.828068525858871, 259.200117640263, 12.141453928734437, 221.12156053438275, 308.1438546705351, 189.05700125334408, 201.8682931586383, 3.393375210875657, 95.10623665080416, 64.76159228723111, 61.47406764996036, 43.047712429392185, 34.319613506577824, 98.60016407881159, 153.143814084478, 42.98952687531764, 34.11505114217544, 22.104308822605088, 1.7547518594489873, 206.4246112042116, 32.74182491373219, 346.5489386604964, 4.246461914547573, 69.21661086145772, 32.31126551596545, 94.53845417633329, 260.25148760224465, 33.585908684795776, 1.8658265482381031, 192.34773205062848, 36.43973426265236, 133.6281401086869, 161.85160479624318, 10.202572830055608, 66.16942518742835, 5.857420773635869, 180.05810951949516, 266.1235349622011, 135.7872908324416, 112.54209520023511, 120.55559655649142, 117.98122782549028, 27.151893834396994, 107.11295351184029, 57.70399434864967, 315.8313892069743, 132.48393051733638, 2.0757737120993474, 302.05846607265187, 179.86462775844853, 42.61003882003991, 5.195403870802035, 179.24466271549625, 42.013213089497654, 11.191913820564988, 99.3239490983303, 249.45795988158991, 100.66924749017733, 510.30008138556957, 26.691160404131157, 92.54666115160808, 0.0, 8.895587132958356, 194.24921444833632]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8416618488371825, "mean_inference_ms": 2.6117115304034595, "mean_action_processing_ms": 0.3671087186766608, "mean_env_wait_ms": 0.29413480302731665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012679457664489746, "StateBufferConnector_ms": 0.006058335304260254, "ViewRequirementAgentConnector_ms": 0.2979060411453247}, "num_episodes": 23, "episode_return_max": 371.22, "episode_return_min": -235.07856184822072, "episode_return_mean": 139.1723094896796, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 286.94151731017365, "num_env_steps_trained_throughput_per_sec": 286.94151731017365, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 15222.133, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15222.077, "sample_time_ms": 2505.657, "learn_time_ms": 12689.0, "learn_throughput": 315.234, "synch_weights_time_ms": 23.179}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 50, "trial_id": "61e09_00000", "date": "2024-08-16_16-19-18", "timestamp": 1723805358, "time_this_iter_s": 13.948235034942627, "time_total_s": 758.9205305576324, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24b1550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 758.9205305576324, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 62.14000000000001, "ram_util_percent": 80.41999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.33639401292044, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 0.00010000000000000003, "total_loss": 2.950023109067685, "policy_loss": -0.006543451463606543, "vf_loss": 2.955443900224393, "vf_explained_var": 0.10447354931679984, "kl": 0.014968810596752284, "entropy": 0.4682509832754337, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.4428152813482535, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.012933352384618, "policy_loss": -0.00949901832321846, "vf_loss": 7.020288788073908, "vf_explained_var": 0.024587359661778444, "kl": 0.010717943533172104, "entropy": 1.210526609925366, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 371.22, "episode_reward_min": -235.07856184822072, "episode_reward_mean": 128.1223157164386, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -644.697923747826, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 188.53779797627948, "predator_policy": 586.9321026131128}, "policy_reward_mean": {"prey_policy": -47.39005359988865, "predator_policy": 111.45121145810793}, "custom_metrics": {}, "hist_stats": {"episode_reward": [367.2499999999998, 49.11000000000004, 3.979999999999959, 245.25999999999948, 126.83000000000018, 303.3699999999998, 89.11000000000021, 86.09735995935495, 317.32487387286204, 194.97440171666344, -183.5436626471811, 81.91000618841963, 56.22541440452846, 281.52979168111864, 288.00000000000006, 294.45, 276.7220990332936, 190.6999999999997, 126.56000000000022, 133.92136779469206, -10.367682192933549, -235.07856184822072, 239.19789879710177, 283.5924558061944, 168.91999999999996, 346.09412326476956, 16.236745212446007, 289.54886536189593, 115.51000000000035, 288.1655588760277, 371.22, 73.07704125453634, 19.671304780330328, 327.2599999999998, 145.9814733804306, 184.83723875842884, 257.36999999999966, 159.29999999999967, 207.06, 63.4714155697358, 19.23043925299173, -214.85018282561424, 56.28675481159546, -38.83111126023059, 65.98999999999967, 99.21000000000004, 222.74254638613354, 2.5899999999999883, 240.1762856053535, 300.64812287295183, 124.40000000000057, 34.18999999999999, 8.749999999999996, 105.81663469680817, 340.98681619403123, 252.58582496463123, 258.6440656359275, 274.5599999999997, 166.88166514680967, 26.350000000000115, -39.31197107847762, 55.96999999999995, 18.260000000000044, 19.226259117665236, 38.348470656894825, 164.82175697250494, 139.08083269306576, 267.8563280974124, 122.01202895129714, 191.75999999999968, 182.33010210995116, 173.26934664779805, 63.20536884807799, 243.8699999999999, 95.66628402950339, 75.9899999999996, 27.330000000000226, 3.3099999999999734, 74.80673689138567, -25.173766325071796, 101.09000000000104, 55.029427727131534, 131.16000000000008, 40.0366498393537, 202.67124636758723, 95.54000000000104, 39.490405196232814, -23.19871493014948, 167.48999999999995, 294.99999999999966, 3.859999999999962, 189.29999999999956, 318.62999999999965, 74.11000000000028, 24.068496875783158, 220.85999999999947, -33.160523801255074, -58.045518910426104, 94.6200000000009, -6.155064838288862], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [177.2299999999998, 180.18027483418507, -90.05371869006575, -128.9169017872865, 0.8564713865181844, 1.1493018533542994, 64.71958039867565, 87.95157165301983, -194.8651625624278, 37.27737958195559, 126.4430238281359, 95.69147324057553, -101.67629366194465, -1.1464027881461738, -167.2203994702062, -48.76466623083268, 51.48725762113067, 119.69672584087257, -28.07548014881649, 22.559863765924334, -233.0402361544087, -510.1084105523256, -26.759859930447394, -122.93818000665362, -49.87321012070777, -250.91181516456902, 68.3627429246308, 114.3458258438058, 185.92829484510568, 54.1977019577283, 186.90418013864235, 22.46535766279583, 125.95639916146159, 39.47363915581521, 176.97250286716047, -72.09197308595805, -3.5064226581892974, 102.49529209899688, -335.6988594354899, -644.697923747826, -251.4005320296987, -235.62085243564164, -338.597518326564, -451.14616768996274, 49.26075211749432, 84.60981863729114, -510.93061641209937, -262.045118283488, -67.315795349245, 160.92730236966702, 148.00219732396755, 160.60103808365028, -65.55463111663214, -195.08924010585343, 110.12863364197433, 4.0144034643690105, -100.55089055969994, 17.328914757857177, 125.35238057270062, 40.436462888891434, 173.74832717313956, 188.53779797627948, -224.22716262182982, -240.43625508282764, -174.3531236265899, -104.96188693724706, 185.54542885089324, 35.54061770106953, -20.29270025253811, -106.70022354530948, 85.04618111923438, -45.09529896552375, 132.6799999999999, 103.89359272053194, 0.21846135285394291, 146.60089703538839, -89.74840341481992, 122.24039944988125, -85.39389635937479, 0.8741926832319831, -390.05198304146523, -28.811867265429743, -353.5832444331463, -398.60955914280515, -226.9894721415824, -83.9707264113307, -209.6601804189173, -128.03970045512258, -297.08590320458666, -126.16605107498859, 39.8297891793716, -198.58661316773788, 0.6122719068885036, 129.7641501044081, 0.9006357319978143, -209.80492139288768, 50.14001089865477, 151.8528945145608, -410.9129786387288, -51.98704064277709, -186.4514916822669, 36.823305516144146, -201.07301446311723, 2.0000000000000013, -308.02385467053523, -180.42700125334412, 3.835853982012253, -103.2808876547183, 20.078098716946755, 161.0408885390492, 29.465008779016284, 118.59903610626377, 53.57869541785032, 72.1455926326883, 80.81989694167373, -2.3932379014693765, 77.44512065976059, 33.21718452226882, 0.22524814055101422, -182.05461120421194, -191.42989892683417, -227.1728357258726, -68.55048133767846, 51.05740856167387, -18.647391268124313, -89.94232842417414, -48.075243783310555, -226.5358933860651, -133.77843298836717, -22.086654953603887, 12.909963360511568, -18.156080759346008, -141.8524302810434, 108.87908534781037, 72.29990970032941, 123.5295724360191, -178.08592261959964, -146.08369291079933, -170.14763881855583, 113.57825278587909, -49.306212213653254, -6.900510058377106, 27.64489819701778, 11.359601104543254, -163.43156089140427, -146.89845381614214, 134.13281429587252, -24.822518525308077, -216.7681557682204, -169.4886540333781, -40.85003882004026, 69.03459612919775, -153.65466271549678, -40.273213089498, -9.261913820565029, -97.9439490983296, -107.83848030249605, -167.4819901778855, -107.65999667080844, -454.5050114439646, -61.67842485715462, 70.22176370554659, -79.1695261759965, -68.94584767816696, 23.484119597651183, -227.75550880992787, -31.167102482757556, -86.06627582965488, 75.18310517901436, 57.485197116359515, 73.98408276570802, -68.67616398551304, -23.095378746747055, -123.73919448096663, -41.488896698873, -84.18064545644022, -45.45222642898568, 66.455719158141, 159.41000000000008, 126.38923557484209, -12.975564945699988, 2.0000000000000013, 14.507068332402426, 3.897271320580371, 95.11162934253461, 174.19192080064857, 70.40733947244985, -36.53904095887392, -43.88212237171085, -248.17776116275905, -5.279970600130705, 75.62072704276791, -181.975822710056, -120.36590234282976, -232.75059516605305, -172.68228217673013, 0.9700070592822235, 47.45853278129229, -9.618724665431492, -18.45708808395281], "policy_predator_policy_reward": [0.0, 9.839725165814919, 228.463429922633, 39.61719055471973, 1.133528613481817, 0.840698146645702, 5.540419601324209, 87.04842834698017, 272.437161945445, 11.980621035027054, 73.8226369719946, 7.412865959293876, 14.923998765992518, 177.00869768409837, 295.29402042221466, 6.788405238177688, 116.42162218937429, 29.71926822148457, 4.822658479970656, 195.6673596195849, 507.08476410385543, 52.520219955696845, 95.41872672883865, 136.18931939668178, 10.02742046905451, 346.9830192207499, 14.467445023925873, 84.35377788875644, 2.1717051548943154, 45.70229804227152, 74.46405265541273, 10.61640954314905, 69.84959681004462, 41.44246390597311, 12.037497132839535, 73.78197308595891, 24.981684149045677, 2.5894464101467407, 586.9321026131128, 527.3860483648959, 348.72017459591024, 127.93352767649625, 53.75532365952486, 500.90980050878113, 13.50729098399159, 91.8200370583247, 515.8619317363034, 540.7062587654776, 68.94579534924577, 6.362697630333025, 12.910321733746308, 24.580566123405575, 255.11878093724482, 21.761835497686842, 106.42613804177208, 68.97969021378047, 101.65089055970047, 97.08108524214299, 49.13428237491086, 73.242433039525, 3.451672826860444, 5.482202023720509, 338.15781051771546, 199.5826484414781, 82.21127507057756, 216.77504027359012, 11.294797550219414, 94.87915589781778, 14.806327625255111, 258.16806955302343, 111.28122099330432, 33.60513561141406, 0.0, 20.79640727946825, 3.319717088741328, 9.160924523016163, 24.77405028814545, 149.79395367679322, 7.791573197810796, 140.19954604806725, 424.074573217596, 14.019716342290213, 26.85075422769059, 510.49186652264626, 309.12858505201206, 58.118368312496614, 20.709297569189474, 278.15947204462003, 362.1459032045866, 127.09605107498906, 59.03021082062823, 198.9366131677377, 0.0, 92.36612437483736, 1.089364268002187, 210.40492139288773, 1.0327082193766626, 37.15067197276173, 425.033098066578, 338.5150440878802, 14.828068525858871, 259.200117640263, 12.141453928734437, 221.12156053438275, 308.1438546705351, 189.05700125334408, 201.8682931586383, 3.393375210875657, 95.10623665080416, 64.76159228723111, 61.47406764996036, 43.047712429392185, 34.319613506577824, 98.60016407881159, 153.143814084478, 42.98952687531764, 34.11505114217544, 22.104308822605088, 1.7547518594489873, 206.4246112042116, 32.74182491373219, 346.5489386604964, 4.246461914547573, 69.21661086145772, 32.31126551596545, 94.53845417633329, 260.25148760224465, 33.585908684795776, 1.8658265482381031, 192.34773205062848, 36.43973426265236, 133.6281401086869, 161.85160479624318, 10.202572830055608, 66.16942518742835, 5.857420773635869, 180.05810951949516, 266.1235349622011, 135.7872908324416, 112.54209520023511, 120.55559655649142, 117.98122782549028, 27.151893834396994, 107.11295351184029, 57.70399434864967, 315.8313892069743, 132.48393051733638, 2.0757737120993474, 302.05846607265187, 179.86462775844853, 42.61003882003991, 5.195403870802035, 179.24466271549625, 42.013213089497654, 11.191913820564988, 99.3239490983303, 249.45795988158991, 100.66924749017733, 510.30008138556957, 26.691160404131157, 92.54666115160808, 0.0, 8.895587132958356, 194.24921444833632, 58.45150098515821, 276.9798882271184, 0.0, 157.27002815176618, 49.07606049151904, 20.92688358069423, 19.92591723429189, 70.30616398551388, 161.70237176587466, 24.622606658072147, 85.21914803219643, 17.25167919296727, 9.53738579330739, 136.94912147753732, 0.0, 9.200764425157924, 14.835564945699948, 0.0, 124.18621054829329, 46.70944979872376, 44.34837065746549, 4.978079199351313, 1.0536233278020655, 39.18807815862177, 298.913210521832, 17.21516988842099, 15.028284798731415, 135.4909587586314, 1.872200242616921, 267.3090010090143, 7.448706366272854, 339.93865206608365, 46.191460159425695, 0.0, 20.885625941704518, 1.035121969391259]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8501526036328881, "mean_inference_ms": 2.6317517067084646, "mean_action_processing_ms": 0.369642176926662, "mean_env_wait_ms": 0.29719797999030834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012356281280517578, "StateBufferConnector_ms": 0.0060062408447265625, "ViewRequirementAgentConnector_ms": 0.25943195819854736}, "num_episodes": 18, "episode_return_max": 371.22, "episode_return_min": -235.07856184822072, "episode_return_mean": 128.1223157164386, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.4093977316221, "num_env_steps_trained_throughput_per_sec": 294.4093977316221, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 15084.836, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15084.783, "sample_time_ms": 2531.035, "learn_time_ms": 12527.409, "learn_throughput": 319.3, "synch_weights_time_ms": 22.111}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 51, "trial_id": "61e09_00000", "date": "2024-08-16_16-19-31", "timestamp": 1723805371, "time_this_iter_s": 13.595418930053711, "time_total_s": 772.5159494876862, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2538c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 772.5159494876862, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 62.83157894736842, "ram_util_percent": 79.87894736842107}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.92986532982695, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 0.00010000000000000003, "total_loss": 3.369215532711574, "policy_loss": -0.010183512896826619, "vf_loss": 3.378440294126985, "vf_explained_var": 0.13042863241579167, "kl": 0.012783434603405862, "entropy": 0.3614232619761159, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.347321511765636, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.420412056029789, "policy_loss": -0.008808327306347785, "vf_loss": 7.426367177912798, "vf_explained_var": 0.14635731297195273, "kl": 0.01426600180428853, "entropy": 1.255355944772246, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 371.22, "episode_reward_min": -235.07856184822072, "episode_reward_mean": 127.07896768205897, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -644.697923747826, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.01, "predator_policy": 586.9321026131128}, "policy_reward_mean": {"prey_policy": -43.485746599355224, "predator_policy": 107.02523044038473}, "custom_metrics": {}, "hist_stats": {"episode_reward": [126.56000000000022, 133.92136779469206, -10.367682192933549, -235.07856184822072, 239.19789879710177, 283.5924558061944, 168.91999999999996, 346.09412326476956, 16.236745212446007, 289.54886536189593, 115.51000000000035, 288.1655588760277, 371.22, 73.07704125453634, 19.671304780330328, 327.2599999999998, 145.9814733804306, 184.83723875842884, 257.36999999999966, 159.29999999999967, 207.06, 63.4714155697358, 19.23043925299173, -214.85018282561424, 56.28675481159546, -38.83111126023059, 65.98999999999967, 99.21000000000004, 222.74254638613354, 2.5899999999999883, 240.1762856053535, 300.64812287295183, 124.40000000000057, 34.18999999999999, 8.749999999999996, 105.81663469680817, 340.98681619403123, 252.58582496463123, 258.6440656359275, 274.5599999999997, 166.88166514680967, 26.350000000000115, -39.31197107847762, 55.96999999999995, 18.260000000000044, 19.226259117665236, 38.348470656894825, 164.82175697250494, 139.08083269306576, 267.8563280974124, 122.01202895129714, 191.75999999999968, 182.33010210995116, 173.26934664779805, 63.20536884807799, 243.8699999999999, 95.66628402950339, 75.9899999999996, 27.330000000000226, 3.3099999999999734, 74.80673689138567, -25.173766325071796, 101.09000000000104, 55.029427727131534, 131.16000000000008, 40.0366498393537, 202.67124636758723, 95.54000000000104, 39.490405196232814, -23.19871493014948, 167.48999999999995, 294.99999999999966, 3.859999999999962, 189.29999999999956, 318.62999999999965, 74.11000000000028, 24.068496875783158, 220.85999999999947, -33.160523801255074, -58.045518910426104, 94.6200000000009, -6.155064838288862, 78.70618944739435, 76.29000000000002, 107.08000000000044, 287.4599999999998, 138.5009879929336, 297.7499999999994, 88.05540886644111, 106.45000000000033, 188.08999999999992, 110.00667664889566, 88.3373930249561, 151.26, 258.0262797263503, 208.84904965944804, 95.7131256661594, 298.34999999999997, 78.38081551958045, 307.65955421893796], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-3.5064226581892974, 102.49529209899688, -335.6988594354899, -644.697923747826, -251.4005320296987, -235.62085243564164, -338.597518326564, -451.14616768996274, 49.26075211749432, 84.60981863729114, -510.93061641209937, -262.045118283488, -67.315795349245, 160.92730236966702, 148.00219732396755, 160.60103808365028, -65.55463111663214, -195.08924010585343, 110.12863364197433, 4.0144034643690105, -100.55089055969994, 17.328914757857177, 125.35238057270062, 40.436462888891434, 173.74832717313956, 188.53779797627948, -224.22716262182982, -240.43625508282764, -174.3531236265899, -104.96188693724706, 185.54542885089324, 35.54061770106953, -20.29270025253811, -106.70022354530948, 85.04618111923438, -45.09529896552375, 132.6799999999999, 103.89359272053194, 0.21846135285394291, 146.60089703538839, -89.74840341481992, 122.24039944988125, -85.39389635937479, 0.8741926832319831, -390.05198304146523, -28.811867265429743, -353.5832444331463, -398.60955914280515, -226.9894721415824, -83.9707264113307, -209.6601804189173, -128.03970045512258, -297.08590320458666, -126.16605107498859, 39.8297891793716, -198.58661316773788, 0.6122719068885036, 129.7641501044081, 0.9006357319978143, -209.80492139288768, 50.14001089865477, 151.8528945145608, -410.9129786387288, -51.98704064277709, -186.4514916822669, 36.823305516144146, -201.07301446311723, 2.0000000000000013, -308.02385467053523, -180.42700125334412, 3.835853982012253, -103.2808876547183, 20.078098716946755, 161.0408885390492, 29.465008779016284, 118.59903610626377, 53.57869541785032, 72.1455926326883, 80.81989694167373, -2.3932379014693765, 77.44512065976059, 33.21718452226882, 0.22524814055101422, -182.05461120421194, -191.42989892683417, -227.1728357258726, -68.55048133767846, 51.05740856167387, -18.647391268124313, -89.94232842417414, -48.075243783310555, -226.5358933860651, -133.77843298836717, -22.086654953603887, 12.909963360511568, -18.156080759346008, -141.8524302810434, 108.87908534781037, 72.29990970032941, 123.5295724360191, -178.08592261959964, -146.08369291079933, -170.14763881855583, 113.57825278587909, -49.306212213653254, -6.900510058377106, 27.64489819701778, 11.359601104543254, -163.43156089140427, -146.89845381614214, 134.13281429587252, -24.822518525308077, -216.7681557682204, -169.4886540333781, -40.85003882004026, 69.03459612919775, -153.65466271549678, -40.273213089498, -9.261913820565029, -97.9439490983296, -107.83848030249605, -167.4819901778855, -107.65999667080844, -454.5050114439646, -61.67842485715462, 70.22176370554659, -79.1695261759965, -68.94584767816696, 23.484119597651183, -227.75550880992787, -31.167102482757556, -86.06627582965488, 75.18310517901436, 57.485197116359515, 73.98408276570802, -68.67616398551304, -23.095378746747055, -123.73919448096663, -41.488896698873, -84.18064545644022, -45.45222642898568, 66.455719158141, 159.41000000000008, 126.38923557484209, -12.975564945699988, 2.0000000000000013, 14.507068332402426, 3.897271320580371, 95.11162934253461, 174.19192080064857, 70.40733947244985, -36.53904095887392, -43.88212237171085, -248.17776116275905, -5.279970600130705, 75.62072704276791, -181.975822710056, -120.36590234282976, -232.75059516605305, -172.68228217673013, 0.9700070592822235, 47.45853278129229, -9.618724665431492, -18.45708808395281, -147.07704449013096, 42.8449894610819, 1.0455577246956205, -38.92366323788521, -33.58774198132039, -6.69001498543958, 10.880680003923745, 149.64818023941007, -118.68537478541315, 97.68758172853806, 131.94065463879056, 125.66898925269406, -86.02587897862719, -7.342574370038179, 52.215860512190936, -3.51587006333024, 68.82956516471812, 113.08712026222084, -0.52973339914583, 97.71646586365878, -22.991195383324968, -247.3120232256049, 125.87013964164417, 0.949570591832347, 6.621441741497741, 172.19758650199762, 138.43058438253053, -28.59671739246084, -171.16834695712117, 22.796313816003405, 30.751903818994673, 199.01, -169.47970470466888, -42.71000427586162, 130.70656449336002, 100.0043967039712], "policy_predator_policy_reward": [24.981684149045677, 2.5894464101467407, 586.9321026131128, 527.3860483648959, 348.72017459591024, 127.93352767649625, 53.75532365952486, 500.90980050878113, 13.50729098399159, 91.8200370583247, 515.8619317363034, 540.7062587654776, 68.94579534924577, 6.362697630333025, 12.910321733746308, 24.580566123405575, 255.11878093724482, 21.761835497686842, 106.42613804177208, 68.97969021378047, 101.65089055970047, 97.08108524214299, 49.13428237491086, 73.242433039525, 3.451672826860444, 5.482202023720509, 338.15781051771546, 199.5826484414781, 82.21127507057756, 216.77504027359012, 11.294797550219414, 94.87915589781778, 14.806327625255111, 258.16806955302343, 111.28122099330432, 33.60513561141406, 0.0, 20.79640727946825, 3.319717088741328, 9.160924523016163, 24.77405028814545, 149.79395367679322, 7.791573197810796, 140.19954604806725, 424.074573217596, 14.019716342290213, 26.85075422769059, 510.49186652264626, 309.12858505201206, 58.118368312496614, 20.709297569189474, 278.15947204462003, 362.1459032045866, 127.09605107498906, 59.03021082062823, 198.9366131677377, 0.0, 92.36612437483736, 1.089364268002187, 210.40492139288773, 1.0327082193766626, 37.15067197276173, 425.033098066578, 338.5150440878802, 14.828068525858871, 259.200117640263, 12.141453928734437, 221.12156053438275, 308.1438546705351, 189.05700125334408, 201.8682931586383, 3.393375210875657, 95.10623665080416, 64.76159228723111, 61.47406764996036, 43.047712429392185, 34.319613506577824, 98.60016407881159, 153.143814084478, 42.98952687531764, 34.11505114217544, 22.104308822605088, 1.7547518594489873, 206.4246112042116, 32.74182491373219, 346.5489386604964, 4.246461914547573, 69.21661086145772, 32.31126551596545, 94.53845417633329, 260.25148760224465, 33.585908684795776, 1.8658265482381031, 192.34773205062848, 36.43973426265236, 133.6281401086869, 161.85160479624318, 10.202572830055608, 66.16942518742835, 5.857420773635869, 180.05810951949516, 266.1235349622011, 135.7872908324416, 112.54209520023511, 120.55559655649142, 117.98122782549028, 27.151893834396994, 107.11295351184029, 57.70399434864967, 315.8313892069743, 132.48393051733638, 2.0757737120993474, 302.05846607265187, 179.86462775844853, 42.61003882003991, 5.195403870802035, 179.24466271549625, 42.013213089497654, 11.191913820564988, 99.3239490983303, 249.45795988158991, 100.66924749017733, 510.30008138556957, 26.691160404131157, 92.54666115160808, 0.0, 8.895587132958356, 194.24921444833632, 58.45150098515821, 276.9798882271184, 0.0, 157.27002815176618, 49.07606049151904, 20.92688358069423, 19.92591723429189, 70.30616398551388, 161.70237176587466, 24.622606658072147, 85.21914803219643, 17.25167919296727, 9.53738579330739, 136.94912147753732, 0.0, 9.200764425157924, 14.835564945699948, 0.0, 124.18621054829329, 46.70944979872376, 44.34837065746549, 4.978079199351313, 1.0536233278020655, 39.18807815862177, 298.913210521832, 17.21516988842099, 15.028284798731415, 135.4909587586314, 1.872200242616921, 267.3090010090143, 7.448706366272854, 339.93865206608365, 46.191460159425695, 0.0, 20.885625941704518, 1.035121969391259, 0.0, 182.938244476443, 0.944442275304381, 113.22366323788522, 56.03667234898154, 91.32108461777834, 74.60660562567125, 52.32453413099504, 27.590441701046863, 131.90833934876179, 27.259345361209512, 12.881010747306174, 30.35912021315297, 151.06474200195322, 12.625591452836447, 45.124418098302776, 4.420434835281916, 1.7528797377791627, 7.962030267268688, 4.857913917113416, 299.28350212497185, 59.35710950891366, 3.970262349953921, 20.47002741656957, 3.027210648977956, 76.18004083387744, 3.1848095585764984, 95.83037311080189, 233.33172063422484, 10.753438173051979, 6.334407282663855, 62.25368889834139, 71.28117907480635, 219.2893454253045, 51.39386045548761, 25.554732566119426]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.855473722833373, "mean_inference_ms": 2.6470465598445703, "mean_action_processing_ms": 0.3713992682646884, "mean_env_wait_ms": 0.29883166620847473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011869192123413086, "StateBufferConnector_ms": 0.006027579307556152, "ViewRequirementAgentConnector_ms": 0.1935443878173828}, "num_episodes": 18, "episode_return_max": 371.22, "episode_return_min": -235.07856184822072, "episode_return_mean": 127.07896768205897, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 284.02918543875586, "num_env_steps_trained_throughput_per_sec": 284.02918543875586, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 14999.367, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14999.315, "sample_time_ms": 2535.884, "learn_time_ms": 12437.595, "learn_throughput": 321.606, "synch_weights_time_ms": 21.732}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 52, "trial_id": "61e09_00000", "date": "2024-08-16_16-19-46", "timestamp": 1723805386, "time_this_iter_s": 14.131782054901123, "time_total_s": 786.6477315425873, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b55f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 786.6477315425873, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 65.105, "ram_util_percent": 80.685}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.3675445523211565, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 0.00010000000000000003, "total_loss": 3.6445991176776786, "policy_loss": -0.004326731039866529, "vf_loss": 3.6484037544361496, "vf_explained_var": 0.07809047323686105, "kl": 0.006961333806943176, "entropy": 0.4334191602216196, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.170916649967275, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.58432164419265, "policy_loss": -0.003885326486588431, "vf_loss": 6.585778448569081, "vf_explained_var": 0.07677337256058184, "kl": 0.012142606783620025, "entropy": 1.2514195128723427, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "env_runners": {"episode_reward_max": 340.98681619403123, "episode_reward_min": -214.85018282561424, "episode_reward_mean": 124.64836315496595, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -480.7377714310004, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.01, "predator_policy": 510.49186652264626}, "policy_reward_mean": {"prey_policy": -33.30405843432521, "predator_policy": 95.62824001180816}, "custom_metrics": {}, "hist_stats": {"episode_reward": [257.36999999999966, 159.29999999999967, 207.06, 63.4714155697358, 19.23043925299173, -214.85018282561424, 56.28675481159546, -38.83111126023059, 65.98999999999967, 99.21000000000004, 222.74254638613354, 2.5899999999999883, 240.1762856053535, 300.64812287295183, 124.40000000000057, 34.18999999999999, 8.749999999999996, 105.81663469680817, 340.98681619403123, 252.58582496463123, 258.6440656359275, 274.5599999999997, 166.88166514680967, 26.350000000000115, -39.31197107847762, 55.96999999999995, 18.260000000000044, 19.226259117665236, 38.348470656894825, 164.82175697250494, 139.08083269306576, 267.8563280974124, 122.01202895129714, 191.75999999999968, 182.33010210995116, 173.26934664779805, 63.20536884807799, 243.8699999999999, 95.66628402950339, 75.9899999999996, 27.330000000000226, 3.3099999999999734, 74.80673689138567, -25.173766325071796, 101.09000000000104, 55.029427727131534, 131.16000000000008, 40.0366498393537, 202.67124636758723, 95.54000000000104, 39.490405196232814, -23.19871493014948, 167.48999999999995, 294.99999999999966, 3.859999999999962, 189.29999999999956, 318.62999999999965, 74.11000000000028, 24.068496875783158, 220.85999999999947, -33.160523801255074, -58.045518910426104, 94.6200000000009, -6.155064838288862, 78.70618944739435, 76.29000000000002, 107.08000000000044, 287.4599999999998, 138.5009879929336, 297.7499999999994, 88.05540886644111, 106.45000000000033, 188.08999999999992, 110.00667664889566, 88.3373930249561, 151.26, 258.0262797263503, 208.84904965944804, 95.7131256661594, 298.34999999999997, 78.38081551958045, 307.65955421893796, 196.65603778891764, 75.58000000000028, 121.8548428329321, 170.38972490253838, 84.01759791730679, 148.04824660433724, 217.64346244143866, -19.544469397171984, 301.58, 134.29000000000013, 310.42999999999984, 251.4500000000002, 31.05000000000032, 1.9999999999999976, 51.16780159298404, 237.82986342787834, 171.63426842523415, 155.20999999999987], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [132.6799999999999, 103.89359272053194, 0.21846135285394291, 146.60089703538839, -89.74840341481992, 122.24039944988125, -85.39389635937479, 0.8741926832319831, -390.05198304146523, -28.811867265429743, -353.5832444331463, -398.60955914280515, -226.9894721415824, -83.9707264113307, -209.6601804189173, -128.03970045512258, -297.08590320458666, -126.16605107498859, 39.8297891793716, -198.58661316773788, 0.6122719068885036, 129.7641501044081, 0.9006357319978143, -209.80492139288768, 50.14001089865477, 151.8528945145608, -410.9129786387288, -51.98704064277709, -186.4514916822669, 36.823305516144146, -201.07301446311723, 2.0000000000000013, -308.02385467053523, -180.42700125334412, 3.835853982012253, -103.2808876547183, 20.078098716946755, 161.0408885390492, 29.465008779016284, 118.59903610626377, 53.57869541785032, 72.1455926326883, 80.81989694167373, -2.3932379014693765, 77.44512065976059, 33.21718452226882, 0.22524814055101422, -182.05461120421194, -191.42989892683417, -227.1728357258726, -68.55048133767846, 51.05740856167387, -18.647391268124313, -89.94232842417414, -48.075243783310555, -226.5358933860651, -133.77843298836717, -22.086654953603887, 12.909963360511568, -18.156080759346008, -141.8524302810434, 108.87908534781037, 72.29990970032941, 123.5295724360191, -178.08592261959964, -146.08369291079933, -170.14763881855583, 113.57825278587909, -49.306212213653254, -6.900510058377106, 27.64489819701778, 11.359601104543254, -163.43156089140427, -146.89845381614214, 134.13281429587252, -24.822518525308077, -216.7681557682204, -169.4886540333781, -40.85003882004026, 69.03459612919775, -153.65466271549678, -40.273213089498, -9.261913820565029, -97.9439490983296, -107.83848030249605, -167.4819901778855, -107.65999667080844, -454.5050114439646, -61.67842485715462, 70.22176370554659, -79.1695261759965, -68.94584767816696, 23.484119597651183, -227.75550880992787, -31.167102482757556, -86.06627582965488, 75.18310517901436, 57.485197116359515, 73.98408276570802, -68.67616398551304, -23.095378746747055, -123.73919448096663, -41.488896698873, -84.18064545644022, -45.45222642898568, 66.455719158141, 159.41000000000008, 126.38923557484209, -12.975564945699988, 2.0000000000000013, 14.507068332402426, 3.897271320580371, 95.11162934253461, 174.19192080064857, 70.40733947244985, -36.53904095887392, -43.88212237171085, -248.17776116275905, -5.279970600130705, 75.62072704276791, -181.975822710056, -120.36590234282976, -232.75059516605305, -172.68228217673013, 0.9700070592822235, 47.45853278129229, -9.618724665431492, -18.45708808395281, -147.07704449013096, 42.8449894610819, 1.0455577246956205, -38.92366323788521, -33.58774198132039, -6.69001498543958, 10.880680003923745, 149.64818023941007, -118.68537478541315, 97.68758172853806, 131.94065463879056, 125.66898925269406, -86.02587897862719, -7.342574370038179, 52.215860512190936, -3.51587006333024, 68.82956516471812, 113.08712026222084, -0.52973339914583, 97.71646586365878, -22.991195383324968, -247.3120232256049, 125.87013964164417, 0.949570591832347, 6.621441741497741, 172.19758650199762, 138.43058438253053, -28.59671739246084, -171.16834695712117, 22.796313816003405, 30.751903818994673, 199.01, -169.47970470466888, -42.71000427586162, 130.70656449336002, 100.0043967039712, -47.49829020840971, 29.025062251094724, -2.976969364074602, 3.013415569045274, 59.72854959538448, -38.74717133631311, 137.72363214163323, -0.9876966278022881, -29.155132954454483, -22.125296147629218, -13.339888179513403, 1.123500175760043, 93.64976191258548, -10.315718650932503, -200.3968025497696, -419.8370676951908, 96.76380513368065, 159.41000000000003, 0.926329042115467, 87.07600932856958, 97.27412437833215, 94.93918556822283, -24.050608149935414, 124.98916572911943, -265.64273306745366, 2.0000000000000013, 1.092058440101001, -480.7377714310004, -168.1446120899938, -61.79617192537643, 115.67677016121564, -45.92580384142339, -58.5997814267735, -13.084914281739096, 134.62391797822568, -5.9808948760770075], "policy_predator_policy_reward": [0.0, 20.79640727946825, 3.319717088741328, 9.160924523016163, 24.77405028814545, 149.79395367679322, 7.791573197810796, 140.19954604806725, 424.074573217596, 14.019716342290213, 26.85075422769059, 510.49186652264626, 309.12858505201206, 58.118368312496614, 20.709297569189474, 278.15947204462003, 362.1459032045866, 127.09605107498906, 59.03021082062823, 198.9366131677377, 0.0, 92.36612437483736, 1.089364268002187, 210.40492139288773, 1.0327082193766626, 37.15067197276173, 425.033098066578, 338.5150440878802, 14.828068525858871, 259.200117640263, 12.141453928734437, 221.12156053438275, 308.1438546705351, 189.05700125334408, 201.8682931586383, 3.393375210875657, 95.10623665080416, 64.76159228723111, 61.47406764996036, 43.047712429392185, 34.319613506577824, 98.60016407881159, 153.143814084478, 42.98952687531764, 34.11505114217544, 22.104308822605088, 1.7547518594489873, 206.4246112042116, 32.74182491373219, 346.5489386604964, 4.246461914547573, 69.21661086145772, 32.31126551596545, 94.53845417633329, 260.25148760224465, 33.585908684795776, 1.8658265482381031, 192.34773205062848, 36.43973426265236, 133.6281401086869, 161.85160479624318, 10.202572830055608, 66.16942518742835, 5.857420773635869, 180.05810951949516, 266.1235349622011, 135.7872908324416, 112.54209520023511, 120.55559655649142, 117.98122782549028, 27.151893834396994, 107.11295351184029, 57.70399434864967, 315.8313892069743, 132.48393051733638, 2.0757737120993474, 302.05846607265187, 179.86462775844853, 42.61003882003991, 5.195403870802035, 179.24466271549625, 42.013213089497654, 11.191913820564988, 99.3239490983303, 249.45795988158991, 100.66924749017733, 510.30008138556957, 26.691160404131157, 92.54666115160808, 0.0, 8.895587132958356, 194.24921444833632, 58.45150098515821, 276.9798882271184, 0.0, 157.27002815176618, 49.07606049151904, 20.92688358069423, 19.92591723429189, 70.30616398551388, 161.70237176587466, 24.622606658072147, 85.21914803219643, 17.25167919296727, 9.53738579330739, 136.94912147753732, 0.0, 9.200764425157924, 14.835564945699948, 0.0, 124.18621054829329, 46.70944979872376, 44.34837065746549, 4.978079199351313, 1.0536233278020655, 39.18807815862177, 298.913210521832, 17.21516988842099, 15.028284798731415, 135.4909587586314, 1.872200242616921, 267.3090010090143, 7.448706366272854, 339.93865206608365, 46.191460159425695, 0.0, 20.885625941704518, 1.035121969391259, 0.0, 182.938244476443, 0.944442275304381, 113.22366323788522, 56.03667234898154, 91.32108461777834, 74.60660562567125, 52.32453413099504, 27.590441701046863, 131.90833934876179, 27.259345361209512, 12.881010747306174, 30.35912021315297, 151.06474200195322, 12.625591452836447, 45.124418098302776, 4.420434835281916, 1.7528797377791627, 7.962030267268688, 4.857913917113416, 299.28350212497185, 59.35710950891366, 3.970262349953921, 20.47002741656957, 3.027210648977956, 76.18004083387744, 3.1848095585764984, 95.83037311080189, 233.33172063422484, 10.753438173051979, 6.334407282663855, 62.25368889834139, 71.28117907480635, 219.2893454253045, 51.39386045548761, 25.554732566119426, 47.091630666164285, 168.0376350800687, 4.94696936407456, 70.5965844309547, 14.249967873162278, 86.62349670069831, 16.888655081331702, 16.76513430737605, 14.203325844489244, 121.09470117490103, 158.53374059423592, 1.7308940138544613, 1.2027087635020641, 133.10671041628407, 447.1331653048189, 153.55623554296912, 10.001448602066425, 35.40474626425292, 1.0636709578845345, 45.223990671430435, 71.18268698439245, 47.03400306905255, 31.92563067651881, 118.58581174429722, 200.234903132166, 94.45782993528759, 0.8979415598990004, 480.7477714310004, 80.49204838636281, 200.61653722199145, 46.267501358529834, 121.81139574955637, 61.33139494170895, 181.98756919203774, 3.4224016626791975, 23.14457523517221]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8553545039517685, "mean_inference_ms": 2.6492446306580626, "mean_action_processing_ms": 0.37113240249515156, "mean_env_wait_ms": 0.2989945785034848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005846381187438965, "StateBufferConnector_ms": 0.005060434341430664, "ViewRequirementAgentConnector_ms": 0.12827682495117188}, "num_episodes": 18, "episode_return_max": 340.98681619403123, "episode_return_min": -214.85018282561424, "episode_return_mean": 124.64836315496595, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 286.77339404138127, "num_env_steps_trained_throughput_per_sec": 286.77339404138127, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 14885.54, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14885.489, "sample_time_ms": 2528.854, "learn_time_ms": 12331.881, "learn_throughput": 324.363, "synch_weights_time_ms": 20.842}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "training_iteration": 53, "trial_id": "61e09_00000", "date": "2024-08-16_16-20-00", "timestamp": 1723805400, "time_this_iter_s": 13.959016799926758, "time_total_s": 800.606748342514, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2499430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 800.606748342514, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 61.330000000000005, "ram_util_percent": 80.11499999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.089431606146394, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 0.00010000000000000003, "total_loss": 2.4069958358845382, "policy_loss": -0.005603222902149711, "vf_loss": 2.4121407559939794, "vf_explained_var": 0.12400632172665269, "kl": 0.006110638954382849, "entropy": 0.45348497365832957, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.489331153208616, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.887144501499398, "policy_loss": -0.005919900354707525, "vf_loss": 6.890784344345174, "vf_explained_var": 0.2414467403182277, "kl": 0.011400285930838359, "entropy": 1.2320463119991243, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 339.2872359029797, "episode_reward_min": -58.045518910426104, "episode_reward_mean": 148.4412531127499, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -480.7377714310004, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.01, "predator_policy": 510.30008138556957}, "policy_reward_mean": {"prey_policy": -5.222926256624282, "predator_policy": 79.44355281299923}, "custom_metrics": {}, "hist_stats": {"episode_reward": [166.88166514680967, 26.350000000000115, -39.31197107847762, 55.96999999999995, 18.260000000000044, 19.226259117665236, 38.348470656894825, 164.82175697250494, 139.08083269306576, 267.8563280974124, 122.01202895129714, 191.75999999999968, 182.33010210995116, 173.26934664779805, 63.20536884807799, 243.8699999999999, 95.66628402950339, 75.9899999999996, 27.330000000000226, 3.3099999999999734, 74.80673689138567, -25.173766325071796, 101.09000000000104, 55.029427727131534, 131.16000000000008, 40.0366498393537, 202.67124636758723, 95.54000000000104, 39.490405196232814, -23.19871493014948, 167.48999999999995, 294.99999999999966, 3.859999999999962, 189.29999999999956, 318.62999999999965, 74.11000000000028, 24.068496875783158, 220.85999999999947, -33.160523801255074, -58.045518910426104, 94.6200000000009, -6.155064838288862, 78.70618944739435, 76.29000000000002, 107.08000000000044, 287.4599999999998, 138.5009879929336, 297.7499999999994, 88.05540886644111, 106.45000000000033, 188.08999999999992, 110.00667664889566, 88.3373930249561, 151.26, 258.0262797263503, 208.84904965944804, 95.7131256661594, 298.34999999999997, 78.38081551958045, 307.65955421893796, 196.65603778891764, 75.58000000000028, 121.8548428329321, 170.38972490253838, 84.01759791730679, 148.04824660433724, 217.64346244143866, -19.544469397171984, 301.58, 134.29000000000013, 310.42999999999984, 251.4500000000002, 31.05000000000032, 1.9999999999999976, 51.16780159298404, 237.82986342787834, 171.63426842523415, 155.20999999999987, 227.09999999999985, 256.91134759026386, 335.9296658125193, 178.02999999999963, 3.982823670878848, 296.10480479457243, 339.2872359029797, 329.4099999999998, 312.85293770517853, 13.606016794278462, 196.93291739943982, 246.92903973833808, 290.81000000000006, 288.54999999999984, 236.7479274830164, 296.5424323404778, 71.33811380201278, 219.7799999999999, 328.13010498813077, 277.7874545509656, 150.423785109659, 322.42999999999984], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [77.44512065976059, 33.21718452226882, 0.22524814055101422, -182.05461120421194, -191.42989892683417, -227.1728357258726, -68.55048133767846, 51.05740856167387, -18.647391268124313, -89.94232842417414, -48.075243783310555, -226.5358933860651, -133.77843298836717, -22.086654953603887, 12.909963360511568, -18.156080759346008, -141.8524302810434, 108.87908534781037, 72.29990970032941, 123.5295724360191, -178.08592261959964, -146.08369291079933, -170.14763881855583, 113.57825278587909, -49.306212213653254, -6.900510058377106, 27.64489819701778, 11.359601104543254, -163.43156089140427, -146.89845381614214, 134.13281429587252, -24.822518525308077, -216.7681557682204, -169.4886540333781, -40.85003882004026, 69.03459612919775, -153.65466271549678, -40.273213089498, -9.261913820565029, -97.9439490983296, -107.83848030249605, -167.4819901778855, -107.65999667080844, -454.5050114439646, -61.67842485715462, 70.22176370554659, -79.1695261759965, -68.94584767816696, 23.484119597651183, -227.75550880992787, -31.167102482757556, -86.06627582965488, 75.18310517901436, 57.485197116359515, 73.98408276570802, -68.67616398551304, -23.095378746747055, -123.73919448096663, -41.488896698873, -84.18064545644022, -45.45222642898568, 66.455719158141, 159.41000000000008, 126.38923557484209, -12.975564945699988, 2.0000000000000013, 14.507068332402426, 3.897271320580371, 95.11162934253461, 174.19192080064857, 70.40733947244985, -36.53904095887392, -43.88212237171085, -248.17776116275905, -5.279970600130705, 75.62072704276791, -181.975822710056, -120.36590234282976, -232.75059516605305, -172.68228217673013, 0.9700070592822235, 47.45853278129229, -9.618724665431492, -18.45708808395281, -147.07704449013096, 42.8449894610819, 1.0455577246956205, -38.92366323788521, -33.58774198132039, -6.69001498543958, 10.880680003923745, 149.64818023941007, -118.68537478541315, 97.68758172853806, 131.94065463879056, 125.66898925269406, -86.02587897862719, -7.342574370038179, 52.215860512190936, -3.51587006333024, 68.82956516471812, 113.08712026222084, -0.52973339914583, 97.71646586365878, -22.991195383324968, -247.3120232256049, 125.87013964164417, 0.949570591832347, 6.621441741497741, 172.19758650199762, 138.43058438253053, -28.59671739246084, -171.16834695712117, 22.796313816003405, 30.751903818994673, 199.01, -169.47970470466888, -42.71000427586162, 130.70656449336002, 100.0043967039712, -47.49829020840971, 29.025062251094724, -2.976969364074602, 3.013415569045274, 59.72854959538448, -38.74717133631311, 137.72363214163323, -0.9876966278022881, -29.155132954454483, -22.125296147629218, -13.339888179513403, 1.123500175760043, 93.64976191258548, -10.315718650932503, -200.3968025497696, -419.8370676951908, 96.76380513368065, 159.41000000000003, 0.926329042115467, 87.07600932856958, 97.27412437833215, 94.93918556822283, -24.050608149935414, 124.98916572911943, -265.64273306745366, 2.0000000000000013, 1.092058440101001, -480.7377714310004, -168.1446120899938, -61.79617192537643, 115.67677016121564, -45.92580384142339, -58.5997814267735, -13.084914281739096, 134.62391797822568, -5.9808948760770075, 48.087694168894664, 98.5446959368702, 73.2776310978885, 65.9986438127809, 182.81023788404326, 128.84690460371002, -30.293582627356056, 152.23102327124388, -1.9280364665357386, -16.53847675563098, 113.00507027348404, 101.45471110812792, 151.66547799209445, 166.66111665941938, 176.23465306510826, 105.93715006760671, 101.86486236903642, 45.47400110307505, -154.77172735577582, -148.5569233690035, 105.67469659036709, -116.20483628057292, 97.32835124917841, -23.602030275069836, 166.62528953576407, 87.73341171814867, 15.638329791168061, 143.59049548323173, 94.20231698068838, 32.537759459803205, 135.40185662368202, 131.86340415667644, -88.5345738151091, -40.44463630480037, 29.904304555179646, 12.665452353191881, 122.80141884157344, 114.8830155630946, 56.50090057768085, 111.85141081629017, 107.86522540851723, -104.58252459641916, 58.22602542057842, 191.23788822652455], "policy_predator_policy_reward": [34.11505114217544, 22.104308822605088, 1.7547518594489873, 206.4246112042116, 32.74182491373219, 346.5489386604964, 4.246461914547573, 69.21661086145772, 32.31126551596545, 94.53845417633329, 260.25148760224465, 33.585908684795776, 1.8658265482381031, 192.34773205062848, 36.43973426265236, 133.6281401086869, 161.85160479624318, 10.202572830055608, 66.16942518742835, 5.857420773635869, 180.05810951949516, 266.1235349622011, 135.7872908324416, 112.54209520023511, 120.55559655649142, 117.98122782549028, 27.151893834396994, 107.11295351184029, 57.70399434864967, 315.8313892069743, 132.48393051733638, 2.0757737120993474, 302.05846607265187, 179.86462775844853, 42.61003882003991, 5.195403870802035, 179.24466271549625, 42.013213089497654, 11.191913820564988, 99.3239490983303, 249.45795988158991, 100.66924749017733, 510.30008138556957, 26.691160404131157, 92.54666115160808, 0.0, 8.895587132958356, 194.24921444833632, 58.45150098515821, 276.9798882271184, 0.0, 157.27002815176618, 49.07606049151904, 20.92688358069423, 19.92591723429189, 70.30616398551388, 161.70237176587466, 24.622606658072147, 85.21914803219643, 17.25167919296727, 9.53738579330739, 136.94912147753732, 0.0, 9.200764425157924, 14.835564945699948, 0.0, 124.18621054829329, 46.70944979872376, 44.34837065746549, 4.978079199351313, 1.0536233278020655, 39.18807815862177, 298.913210521832, 17.21516988842099, 15.028284798731415, 135.4909587586314, 1.872200242616921, 267.3090010090143, 7.448706366272854, 339.93865206608365, 46.191460159425695, 0.0, 20.885625941704518, 1.035121969391259, 0.0, 182.938244476443, 0.944442275304381, 113.22366323788522, 56.03667234898154, 91.32108461777834, 74.60660562567125, 52.32453413099504, 27.590441701046863, 131.90833934876179, 27.259345361209512, 12.881010747306174, 30.35912021315297, 151.06474200195322, 12.625591452836447, 45.124418098302776, 4.420434835281916, 1.7528797377791627, 7.962030267268688, 4.857913917113416, 299.28350212497185, 59.35710950891366, 3.970262349953921, 20.47002741656957, 3.027210648977956, 76.18004083387744, 3.1848095585764984, 95.83037311080189, 233.33172063422484, 10.753438173051979, 6.334407282663855, 62.25368889834139, 71.28117907480635, 219.2893454253045, 51.39386045548761, 25.554732566119426, 47.091630666164285, 168.0376350800687, 4.94696936407456, 70.5965844309547, 14.249967873162278, 86.62349670069831, 16.888655081331702, 16.76513430737605, 14.203325844489244, 121.09470117490103, 158.53374059423592, 1.7308940138544613, 1.2027087635020641, 133.10671041628407, 447.1331653048189, 153.55623554296912, 10.001448602066425, 35.40474626425292, 1.0636709578845345, 45.223990671430435, 71.18268698439245, 47.03400306905255, 31.92563067651881, 118.58581174429722, 200.234903132166, 94.45782993528759, 0.8979415598990004, 480.7477714310004, 80.49204838636281, 200.61653722199145, 46.267501358529834, 121.81139574955637, 61.33139494170895, 181.98756919203774, 3.4224016626791975, 23.14457523517221, 31.307838915470363, 49.15977097876486, 94.28125647272392, 23.35381620687089, 20.4930953962901, 3.7794279284763563, 32.21358262735628, 23.87897672875602, 3.8880364665356986, 18.561300426510154, 3.6897160073740136, 77.95530740558638, 6.680342373812362, 14.280298877653454, 2.945346934891666, 44.29284993239333, 92.53146081065573, 72.9826134224114, 90.36041706143169, 226.5742504576258, 15.348277902369901, 192.1147791872756, 163.10358942781136, 10.099129336418402, 24.915987086191375, 11.535311659895893, 3.491023641935592, 125.83015108366463, 109.09446455393875, 0.913386488586307, 26.51084882715973, 2.7663227329597295, 16.839130908650596, 183.4781930132718, 75.03840271956335, 102.17184037206526, 57.69509787400669, 32.75057270945607, 48.826204710211776, 60.60893844678332, 16.637806693906313, 130.50327760365445, 4.110167782209254, 68.85591857068783]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8538536552499164, "mean_inference_ms": 2.648307715520844, "mean_action_processing_ms": 0.37025661212172806, "mean_env_wait_ms": 0.2987257613561924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005161404609680176, "StateBufferConnector_ms": 0.004677295684814453, "ViewRequirementAgentConnector_ms": 0.12084507942199707}, "num_episodes": 22, "episode_return_max": 339.2872359029797, "episode_return_min": -58.045518910426104, "episode_return_mean": 148.4412531127499, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 283.75437399698046, "num_env_steps_trained_throughput_per_sec": 283.75437399698046, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 14807.798, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14807.749, "sample_time_ms": 2525.097, "learn_time_ms": 12262.784, "learn_throughput": 326.19, "synch_weights_time_ms": 17.207}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 54, "trial_id": "61e09_00000", "date": "2024-08-16_16-20-14", "timestamp": 1723805414, "time_this_iter_s": 14.102535009384155, "time_total_s": 814.7092833518982, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2499d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 814.7092833518982, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 62.245000000000005, "ram_util_percent": 80.075}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6798827503408704, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 0.00010000000000000003, "total_loss": 3.0058689586699954, "policy_loss": -0.00440137708884856, "vf_loss": 3.0098479654423143, "vf_explained_var": 0.063341144783787, "kl": 0.005631708080931102, "entropy": 0.34821663065246805, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.774495318705443, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.891669530464859, "policy_loss": 0.007763941285801588, "vf_loss": 5.87971421499101, "vf_explained_var": 0.04125283029344347, "kl": 0.020956813712236694, "entropy": 1.2033884458440953, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 363.56832629798856, "episode_reward_min": -298.8654625680222, "episode_reward_mean": 173.9155545952058, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -704.8711194311261, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.01, "predator_policy": 760.6616804176691}, "policy_reward_mean": {"prey_policy": 9.159884852195926, "predator_policy": 77.797892445407}, "custom_metrics": {}, "hist_stats": {"episode_reward": [55.029427727131534, 131.16000000000008, 40.0366498393537, 202.67124636758723, 95.54000000000104, 39.490405196232814, -23.19871493014948, 167.48999999999995, 294.99999999999966, 3.859999999999962, 189.29999999999956, 318.62999999999965, 74.11000000000028, 24.068496875783158, 220.85999999999947, -33.160523801255074, -58.045518910426104, 94.6200000000009, -6.155064838288862, 78.70618944739435, 76.29000000000002, 107.08000000000044, 287.4599999999998, 138.5009879929336, 297.7499999999994, 88.05540886644111, 106.45000000000033, 188.08999999999992, 110.00667664889566, 88.3373930249561, 151.26, 258.0262797263503, 208.84904965944804, 95.7131256661594, 298.34999999999997, 78.38081551958045, 307.65955421893796, 196.65603778891764, 75.58000000000028, 121.8548428329321, 170.38972490253838, 84.01759791730679, 148.04824660433724, 217.64346244143866, -19.544469397171984, 301.58, 134.29000000000013, 310.42999999999984, 251.4500000000002, 31.05000000000032, 1.9999999999999976, 51.16780159298404, 237.82986342787834, 171.63426842523415, 155.20999999999987, 227.09999999999985, 256.91134759026386, 335.9296658125193, 178.02999999999963, 3.982823670878848, 296.10480479457243, 339.2872359029797, 329.4099999999998, 312.85293770517853, 13.606016794278462, 196.93291739943982, 246.92903973833808, 290.81000000000006, 288.54999999999984, 236.7479274830164, 296.5424323404778, 71.33811380201278, 219.7799999999999, 328.13010498813077, 277.7874545509656, 150.423785109659, 322.42999999999984, 3.8899999999999615, 323.37328897972446, 321.36296183647653, 223.8640898671831, 238.5368725455267, 225.74999999999994, 160.0599999999999, -298.8654625680222, 172.3298338087954, 322.7142605186773, 178.18999999999988, 58.92323761248244, 49.48838424695675, 319.2, 152.1899999999997, 177.99218581694288, 363.56832629798856, 305.0707393060882, 266.78, 331.97366395451235, 350.38042145586564, 212.22728863820402, 275.37949868700434], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-79.1695261759965, -68.94584767816696, 23.484119597651183, -227.75550880992787, -31.167102482757556, -86.06627582965488, 75.18310517901436, 57.485197116359515, 73.98408276570802, -68.67616398551304, -23.095378746747055, -123.73919448096663, -41.488896698873, -84.18064545644022, -45.45222642898568, 66.455719158141, 159.41000000000008, 126.38923557484209, -12.975564945699988, 2.0000000000000013, 14.507068332402426, 3.897271320580371, 95.11162934253461, 174.19192080064857, 70.40733947244985, -36.53904095887392, -43.88212237171085, -248.17776116275905, -5.279970600130705, 75.62072704276791, -181.975822710056, -120.36590234282976, -232.75059516605305, -172.68228217673013, 0.9700070592822235, 47.45853278129229, -9.618724665431492, -18.45708808395281, -147.07704449013096, 42.8449894610819, 1.0455577246956205, -38.92366323788521, -33.58774198132039, -6.69001498543958, 10.880680003923745, 149.64818023941007, -118.68537478541315, 97.68758172853806, 131.94065463879056, 125.66898925269406, -86.02587897862719, -7.342574370038179, 52.215860512190936, -3.51587006333024, 68.82956516471812, 113.08712026222084, -0.52973339914583, 97.71646586365878, -22.991195383324968, -247.3120232256049, 125.87013964164417, 0.949570591832347, 6.621441741497741, 172.19758650199762, 138.43058438253053, -28.59671739246084, -171.16834695712117, 22.796313816003405, 30.751903818994673, 199.01, -169.47970470466888, -42.71000427586162, 130.70656449336002, 100.0043967039712, -47.49829020840971, 29.025062251094724, -2.976969364074602, 3.013415569045274, 59.72854959538448, -38.74717133631311, 137.72363214163323, -0.9876966278022881, -29.155132954454483, -22.125296147629218, -13.339888179513403, 1.123500175760043, 93.64976191258548, -10.315718650932503, -200.3968025497696, -419.8370676951908, 96.76380513368065, 159.41000000000003, 0.926329042115467, 87.07600932856958, 97.27412437833215, 94.93918556822283, -24.050608149935414, 124.98916572911943, -265.64273306745366, 2.0000000000000013, 1.092058440101001, -480.7377714310004, -168.1446120899938, -61.79617192537643, 115.67677016121564, -45.92580384142339, -58.5997814267735, -13.084914281739096, 134.62391797822568, -5.9808948760770075, 48.087694168894664, 98.5446959368702, 73.2776310978885, 65.9986438127809, 182.81023788404326, 128.84690460371002, -30.293582627356056, 152.23102327124388, -1.9280364665357386, -16.53847675563098, 113.00507027348404, 101.45471110812792, 151.66547799209445, 166.66111665941938, 176.23465306510826, 105.93715006760671, 101.86486236903642, 45.47400110307505, -154.77172735577582, -148.5569233690035, 105.67469659036709, -116.20483628057292, 97.32835124917841, -23.602030275069836, 166.62528953576407, 87.73341171814867, 15.638329791168061, 143.59049548323173, 94.20231698068838, 32.537759459803205, 135.40185662368202, 131.86340415667644, -88.5345738151091, -40.44463630480037, 29.904304555179646, 12.665452353191881, 122.80141884157344, 114.8830155630946, 56.50090057768085, 111.85141081629017, 107.86522540851723, -104.58252459641916, 58.22602542057842, 191.23788822652455, -0.38305417755113647, -16.59094806990431, 144.13322996981782, 109.54507866507656, 112.85019312322413, 169.16296183647654, 0.6194719032969275, -53.37152792295452, 36.6459372475817, 52.97331055434642, 60.54429886551298, 45.70551693022896, 111.57716288375356, 1.1113826403151474, -704.8711194311261, -449.0919872793537, -62.4498729604136, -112.84364833117681, 184.26761492807043, 99.24838298819161, 174.73204821991146, -3.267841524480059, -125.45401749884769, -146.45328426786557, -30.989386155391486, -163.91558305480223, 62.82021787708295, 161.5995329178724, 120.37374293715489, -4.08363568500163, 90.34418107517482, -12.367886507173724, -262.1714658061369, -474.4748702454833, 54.65996722044952, 121.37942699223588, -43.70107987075947, 178.70813190184745, -18.935174459707195, 20.279477997759514, 169.45119042591, 108.34811917554285, 16.237207032690094, 42.17841957173432, -23.745465612415387, 160.39999999999998], "policy_predator_policy_reward": [8.895587132958356, 194.24921444833632, 58.45150098515821, 276.9798882271184, 0.0, 157.27002815176618, 49.07606049151904, 20.92688358069423, 19.92591723429189, 70.30616398551388, 161.70237176587466, 24.622606658072147, 85.21914803219643, 17.25167919296727, 9.53738579330739, 136.94912147753732, 0.0, 9.200764425157924, 14.835564945699948, 0.0, 124.18621054829329, 46.70944979872376, 44.34837065746549, 4.978079199351313, 1.0536233278020655, 39.18807815862177, 298.913210521832, 17.21516988842099, 15.028284798731415, 135.4909587586314, 1.872200242616921, 267.3090010090143, 7.448706366272854, 339.93865206608365, 46.191460159425695, 0.0, 20.885625941704518, 1.035121969391259, 0.0, 182.938244476443, 0.944442275304381, 113.22366323788522, 56.03667234898154, 91.32108461777834, 74.60660562567125, 52.32453413099504, 27.590441701046863, 131.90833934876179, 27.259345361209512, 12.881010747306174, 30.35912021315297, 151.06474200195322, 12.625591452836447, 45.124418098302776, 4.420434835281916, 1.7528797377791627, 7.962030267268688, 4.857913917113416, 299.28350212497185, 59.35710950891366, 3.970262349953921, 20.47002741656957, 3.027210648977956, 76.18004083387744, 3.1848095585764984, 95.83037311080189, 233.33172063422484, 10.753438173051979, 6.334407282663855, 62.25368889834139, 71.28117907480635, 219.2893454253045, 51.39386045548761, 25.554732566119426, 47.091630666164285, 168.0376350800687, 4.94696936407456, 70.5965844309547, 14.249967873162278, 86.62349670069831, 16.888655081331702, 16.76513430737605, 14.203325844489244, 121.09470117490103, 158.53374059423592, 1.7308940138544613, 1.2027087635020641, 133.10671041628407, 447.1331653048189, 153.55623554296912, 10.001448602066425, 35.40474626425292, 1.0636709578845345, 45.223990671430435, 71.18268698439245, 47.03400306905255, 31.92563067651881, 118.58581174429722, 200.234903132166, 94.45782993528759, 0.8979415598990004, 480.7477714310004, 80.49204838636281, 200.61653722199145, 46.267501358529834, 121.81139574955637, 61.33139494170895, 181.98756919203774, 3.4224016626791975, 23.14457523517221, 31.307838915470363, 49.15977097876486, 94.28125647272392, 23.35381620687089, 20.4930953962901, 3.7794279284763563, 32.21358262735628, 23.87897672875602, 3.8880364665356986, 18.561300426510154, 3.6897160073740136, 77.95530740558638, 6.680342373812362, 14.280298877653454, 2.945346934891666, 44.29284993239333, 92.53146081065573, 72.9826134224114, 90.36041706143169, 226.5742504576258, 15.348277902369901, 192.1147791872756, 163.10358942781136, 10.099129336418402, 24.915987086191375, 11.535311659895893, 3.491023641935592, 125.83015108366463, 109.09446455393875, 0.913386488586307, 26.51084882715973, 2.7663227329597295, 16.839130908650596, 183.4781930132718, 75.03840271956335, 102.17184037206526, 57.69509787400669, 32.75057270945607, 48.826204710211776, 60.60893844678332, 16.637806693906313, 130.50327760365445, 4.110167782209254, 68.85591857068783, 2.3630541775511302, 18.50094806990461, 57.287534100886745, 12.407446243943415, 0.0, 39.349806876775915, 148.16905055959973, 128.44709532724235, 74.16132784213805, 74.75629690146154, 119.50018420425803, 0.0, 46.49283711624645, 0.8786173596848539, 760.6616804176691, 94.43596372478919, 274.48388829801297, 73.13946680237298, 23.27332691802113, 15.924935684394477, 1.487951780088567, 5.237841524480017, 172.25300215132864, 158.5775372278672, 2.6267867896284436, 241.76656666752214, 53.43630483790276, 41.3439443671419, 29.866257062845246, 6.033635685001588, 61.689170685690094, 38.32672056325176, 532.5740676051176, 567.6405947444907, 65.69445609482743, 63.33688899857574, 23.959932449344645, 107.81301551956747, 154.43763758303228, 176.19172283342783, 41.47180014292027, 31.109311711492573, 12.752067238168742, 141.05959479561093, 50.135767911301684, 88.58919638811807]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8510703737404619, "mean_inference_ms": 2.6420389298553517, "mean_action_processing_ms": 0.36896441277525427, "mean_env_wait_ms": 0.2980917997209206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005701899528503418, "StateBufferConnector_ms": 0.004758358001708984, "ViewRequirementAgentConnector_ms": 0.12673866748809814}, "num_episodes": 23, "episode_return_max": 363.56832629798856, "episode_return_min": -298.8654625680222, "episode_return_mean": 173.9155545952058, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.56805506241733, "num_env_steps_trained_throughput_per_sec": 288.56805506241733, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 14687.528, "restore_workers_time_ms": 0.013, "training_step_time_ms": 14687.484, "sample_time_ms": 2444.74, "learn_time_ms": 12223.389, "learn_throughput": 327.241, "synch_weights_time_ms": 16.902}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 55, "trial_id": "61e09_00000", "date": "2024-08-16_16-20-28", "timestamp": 1723805428, "time_this_iter_s": 13.874671936035156, "time_total_s": 828.5839552879333, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3000cb1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 828.5839552879333, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 61.25999999999999, "ram_util_percent": 80.14499999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.352320799058077, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 0.00010000000000000003, "total_loss": 3.743812905417548, "policy_loss": -0.0041856766914919255, "vf_loss": 3.7475051527931575, "vf_explained_var": 0.09911853655305489, "kl": 0.00657915212835024, "entropy": 0.31643052152382634, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.013763055914924, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 6.14164644725739, "policy_loss": -0.004884070289942126, "vf_loss": 6.144274565530202, "vf_explained_var": 0.05198346392187492, "kl": 0.007519857365332238, "entropy": 1.1692900637470225, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 363.56832629798856, "episode_reward_min": -298.8654625680222, "episode_reward_mean": 183.50919240048356, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -704.8711194311261, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.01, "predator_policy": 760.6616804176691}, "policy_reward_mean": {"prey_policy": 11.865374233699304, "predator_policy": 79.8892219665425}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.155064838288862, 78.70618944739435, 76.29000000000002, 107.08000000000044, 287.4599999999998, 138.5009879929336, 297.7499999999994, 88.05540886644111, 106.45000000000033, 188.08999999999992, 110.00667664889566, 88.3373930249561, 151.26, 258.0262797263503, 208.84904965944804, 95.7131256661594, 298.34999999999997, 78.38081551958045, 307.65955421893796, 196.65603778891764, 75.58000000000028, 121.8548428329321, 170.38972490253838, 84.01759791730679, 148.04824660433724, 217.64346244143866, -19.544469397171984, 301.58, 134.29000000000013, 310.42999999999984, 251.4500000000002, 31.05000000000032, 1.9999999999999976, 51.16780159298404, 237.82986342787834, 171.63426842523415, 155.20999999999987, 227.09999999999985, 256.91134759026386, 335.9296658125193, 178.02999999999963, 3.982823670878848, 296.10480479457243, 339.2872359029797, 329.4099999999998, 312.85293770517853, 13.606016794278462, 196.93291739943982, 246.92903973833808, 290.81000000000006, 288.54999999999984, 236.7479274830164, 296.5424323404778, 71.33811380201278, 219.7799999999999, 328.13010498813077, 277.7874545509656, 150.423785109659, 322.42999999999984, 3.8899999999999615, 323.37328897972446, 321.36296183647653, 223.8640898671831, 238.5368725455267, 225.74999999999994, 160.0599999999999, -298.8654625680222, 172.3298338087954, 322.7142605186773, 178.18999999999988, 58.92323761248244, 49.48838424695675, 319.2, 152.1899999999997, 177.99218581694288, 363.56832629798856, 305.0707393060882, 266.78, 331.97366395451235, 350.38042145586564, 212.22728863820402, 275.37949868700434, 65.60000000000008, 167.2899999999998, 52.44000000000013, 118.88478471634792, 187.0499999999996, -27.476212458371894, 348.9512403812424, 66.49999999999979, 116.36000000000023, 152.72063193413874, 143.74206044504388, 155.16000000000003, 150.89128856072716, 249.3091573847888, 141.69783896298838, 270.5359967246083, 264.4699999999999, 172.6984622405214], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-9.618724665431492, -18.45708808395281, -147.07704449013096, 42.8449894610819, 1.0455577246956205, -38.92366323788521, -33.58774198132039, -6.69001498543958, 10.880680003923745, 149.64818023941007, -118.68537478541315, 97.68758172853806, 131.94065463879056, 125.66898925269406, -86.02587897862719, -7.342574370038179, 52.215860512190936, -3.51587006333024, 68.82956516471812, 113.08712026222084, -0.52973339914583, 97.71646586365878, -22.991195383324968, -247.3120232256049, 125.87013964164417, 0.949570591832347, 6.621441741497741, 172.19758650199762, 138.43058438253053, -28.59671739246084, -171.16834695712117, 22.796313816003405, 30.751903818994673, 199.01, -169.47970470466888, -42.71000427586162, 130.70656449336002, 100.0043967039712, -47.49829020840971, 29.025062251094724, -2.976969364074602, 3.013415569045274, 59.72854959538448, -38.74717133631311, 137.72363214163323, -0.9876966278022881, -29.155132954454483, -22.125296147629218, -13.339888179513403, 1.123500175760043, 93.64976191258548, -10.315718650932503, -200.3968025497696, -419.8370676951908, 96.76380513368065, 159.41000000000003, 0.926329042115467, 87.07600932856958, 97.27412437833215, 94.93918556822283, -24.050608149935414, 124.98916572911943, -265.64273306745366, 2.0000000000000013, 1.092058440101001, -480.7377714310004, -168.1446120899938, -61.79617192537643, 115.67677016121564, -45.92580384142339, -58.5997814267735, -13.084914281739096, 134.62391797822568, -5.9808948760770075, 48.087694168894664, 98.5446959368702, 73.2776310978885, 65.9986438127809, 182.81023788404326, 128.84690460371002, -30.293582627356056, 152.23102327124388, -1.9280364665357386, -16.53847675563098, 113.00507027348404, 101.45471110812792, 151.66547799209445, 166.66111665941938, 176.23465306510826, 105.93715006760671, 101.86486236903642, 45.47400110307505, -154.77172735577582, -148.5569233690035, 105.67469659036709, -116.20483628057292, 97.32835124917841, -23.602030275069836, 166.62528953576407, 87.73341171814867, 15.638329791168061, 143.59049548323173, 94.20231698068838, 32.537759459803205, 135.40185662368202, 131.86340415667644, -88.5345738151091, -40.44463630480037, 29.904304555179646, 12.665452353191881, 122.80141884157344, 114.8830155630946, 56.50090057768085, 111.85141081629017, 107.86522540851723, -104.58252459641916, 58.22602542057842, 191.23788822652455, -0.38305417755113647, -16.59094806990431, 144.13322996981782, 109.54507866507656, 112.85019312322413, 169.16296183647654, 0.6194719032969275, -53.37152792295452, 36.6459372475817, 52.97331055434642, 60.54429886551298, 45.70551693022896, 111.57716288375356, 1.1113826403151474, -704.8711194311261, -449.0919872793537, -62.4498729604136, -112.84364833117681, 184.26761492807043, 99.24838298819161, 174.73204821991146, -3.267841524480059, -125.45401749884769, -146.45328426786557, -30.989386155391486, -163.91558305480223, 62.82021787708295, 161.5995329178724, 120.37374293715489, -4.08363568500163, 90.34418107517482, -12.367886507173724, -262.1714658061369, -474.4748702454833, 54.65996722044952, 121.37942699223588, -43.70107987075947, 178.70813190184745, -18.935174459707195, 20.279477997759514, 169.45119042591, 108.34811917554285, 16.237207032690094, 42.17841957173432, -23.745465612415387, 160.39999999999998, -1.90962383221405, -46.40627371894145, 158.68585994866027, 2.0000000000000013, -332.7177181757816, -13.227650403147443, -63.33023443530169, -139.2052255172761, 181.39510245913272, -5.695055814329107, -247.04037571470252, -120.15692578569315, 164.17408815678755, 65.57606608928248, -445.10603270110687, 28.897985869466858, 0.9676586196393774, 25.807417850035343, -132.6765157362089, 5.396031006139339, 66.88995903651106, -87.88327694466521, -6.14038965421766, 117.24891787258105, -40.690381477137464, 93.57230021214657, 93.03564669935695, 26.274930456125958, -1.795300050666114, -12.946488032536971, 152.77908843326128, 9.613715573939093, -43.52670071472221, 131.54710304650044, 0.13922546901893046, 89.74107454554107], "policy_predator_policy_reward": [20.885625941704518, 1.035121969391259, 0.0, 182.938244476443, 0.944442275304381, 113.22366323788522, 56.03667234898154, 91.32108461777834, 74.60660562567125, 52.32453413099504, 27.590441701046863, 131.90833934876179, 27.259345361209512, 12.881010747306174, 30.35912021315297, 151.06474200195322, 12.625591452836447, 45.124418098302776, 4.420434835281916, 1.7528797377791627, 7.962030267268688, 4.857913917113416, 299.28350212497185, 59.35710950891366, 3.970262349953921, 20.47002741656957, 3.027210648977956, 76.18004083387744, 3.1848095585764984, 95.83037311080189, 233.33172063422484, 10.753438173051979, 6.334407282663855, 62.25368889834139, 71.28117907480635, 219.2893454253045, 51.39386045548761, 25.554732566119426, 47.091630666164285, 168.0376350800687, 4.94696936407456, 70.5965844309547, 14.249967873162278, 86.62349670069831, 16.888655081331702, 16.76513430737605, 14.203325844489244, 121.09470117490103, 158.53374059423592, 1.7308940138544613, 1.2027087635020641, 133.10671041628407, 447.1331653048189, 153.55623554296912, 10.001448602066425, 35.40474626425292, 1.0636709578845345, 45.223990671430435, 71.18268698439245, 47.03400306905255, 31.92563067651881, 118.58581174429722, 200.234903132166, 94.45782993528759, 0.8979415598990004, 480.7477714310004, 80.49204838636281, 200.61653722199145, 46.267501358529834, 121.81139574955637, 61.33139494170895, 181.98756919203774, 3.4224016626791975, 23.14457523517221, 31.307838915470363, 49.15977097876486, 94.28125647272392, 23.35381620687089, 20.4930953962901, 3.7794279284763563, 32.21358262735628, 23.87897672875602, 3.8880364665356986, 18.561300426510154, 3.6897160073740136, 77.95530740558638, 6.680342373812362, 14.280298877653454, 2.945346934891666, 44.29284993239333, 92.53146081065573, 72.9826134224114, 90.36041706143169, 226.5742504576258, 15.348277902369901, 192.1147791872756, 163.10358942781136, 10.099129336418402, 24.915987086191375, 11.535311659895893, 3.491023641935592, 125.83015108366463, 109.09446455393875, 0.913386488586307, 26.51084882715973, 2.7663227329597295, 16.839130908650596, 183.4781930132718, 75.03840271956335, 102.17184037206526, 57.69509787400669, 32.75057270945607, 48.826204710211776, 60.60893844678332, 16.637806693906313, 130.50327760365445, 4.110167782209254, 68.85591857068783, 2.3630541775511302, 18.50094806990461, 57.287534100886745, 12.407446243943415, 0.0, 39.349806876775915, 148.16905055959973, 128.44709532724235, 74.16132784213805, 74.75629690146154, 119.50018420425803, 0.0, 46.49283711624645, 0.8786173596848539, 760.6616804176691, 94.43596372478919, 274.48388829801297, 73.13946680237298, 23.27332691802113, 15.924935684394477, 1.487951780088567, 5.237841524480017, 172.25300215132864, 158.5775372278672, 2.6267867896284436, 241.76656666752214, 53.43630483790276, 41.3439443671419, 29.866257062845246, 6.033635685001588, 61.689170685690094, 38.32672056325176, 532.5740676051176, 567.6405947444907, 65.69445609482743, 63.33688899857574, 23.959932449344645, 107.81301551956747, 154.43763758303228, 176.19172283342783, 41.47180014292027, 31.109311711492573, 12.752067238168742, 141.05959479561093, 50.135767911301684, 88.58919638811807, 107.21023451036821, 6.705663040787251, 6.604140051339739, 0.0, 339.88771817578146, 58.49765040314719, 13.068722275029476, 308.35152239389606, 0.0, 11.349953355196398, 112.02923915507704, 227.69184988694667, 30.23758554489747, 88.96350059027482, 465.16603270110693, 17.542014130533197, 55.72623915663844, 33.858684373686756, 181.89409630798784, 98.10702035622043, 161.91561555544126, 2.8197627977570745, 8.100389654217619, 35.951082127418964, 15.067497522257932, 82.94187230345975, 4.880912992275094, 125.11766723703086, 8.799985045211002, 147.6396420009803, 2.1962913581114902, 105.94690135929648, 42.75171204834561, 133.6978856198761, 8.539236771502528, 74.27892545445891]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8483927946559953, "mean_inference_ms": 2.6367037251986964, "mean_action_processing_ms": 0.3679332261836316, "mean_env_wait_ms": 0.29734142992087953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005744218826293945, "StateBufferConnector_ms": 0.004693865776062012, "ViewRequirementAgentConnector_ms": 0.13019728660583496}, "num_episodes": 18, "episode_return_max": 363.56832629798856, "episode_return_min": -298.8654625680222, "episode_return_mean": 183.50919240048356, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 276.37013089647985, "num_env_steps_trained_throughput_per_sec": 276.37013089647985, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 14562.819, "restore_workers_time_ms": 0.013, "training_step_time_ms": 14562.769, "sample_time_ms": 2335.581, "learn_time_ms": 12207.222, "learn_throughput": 327.675, "synch_weights_time_ms": 17.606}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 56, "trial_id": "61e09_00000", "date": "2024-08-16_16-20-42", "timestamp": 1723805442, "time_this_iter_s": 14.507850885391235, "time_total_s": 843.0918061733246, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30001e160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 843.0918061733246, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 62.919999999999995, "ram_util_percent": 80.49500000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1631749635020263, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 0.00010000000000000003, "total_loss": 2.476667400327309, "policy_loss": -0.005107161456167146, "vf_loss": 2.481068261022921, "vf_explained_var": 0.1602509238101818, "kl": 0.009417279742804416, "entropy": 0.4125951032789927, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.745407613433858, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 5.855299667580418, "policy_loss": -0.010049240229400022, "vf_loss": 5.862644273011142, "vf_explained_var": 0.47706061270501876, "kl": 0.009015515857586042, "entropy": 1.2439703557226394, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 363.56832629798856, "episode_reward_min": -298.8654625680222, "episode_reward_mean": 195.9107538988258, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -704.8711194311261, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 191.23788822652455, "predator_policy": 760.6616804176691}, "policy_reward_mean": {"prey_policy": 19.967637293461593, "predator_policy": 77.98773965595136}, "custom_metrics": {}, "hist_stats": {"episode_reward": [307.65955421893796, 196.65603778891764, 75.58000000000028, 121.8548428329321, 170.38972490253838, 84.01759791730679, 148.04824660433724, 217.64346244143866, -19.544469397171984, 301.58, 134.29000000000013, 310.42999999999984, 251.4500000000002, 31.05000000000032, 1.9999999999999976, 51.16780159298404, 237.82986342787834, 171.63426842523415, 155.20999999999987, 227.09999999999985, 256.91134759026386, 335.9296658125193, 178.02999999999963, 3.982823670878848, 296.10480479457243, 339.2872359029797, 329.4099999999998, 312.85293770517853, 13.606016794278462, 196.93291739943982, 246.92903973833808, 290.81000000000006, 288.54999999999984, 236.7479274830164, 296.5424323404778, 71.33811380201278, 219.7799999999999, 328.13010498813077, 277.7874545509656, 150.423785109659, 322.42999999999984, 3.8899999999999615, 323.37328897972446, 321.36296183647653, 223.8640898671831, 238.5368725455267, 225.74999999999994, 160.0599999999999, -298.8654625680222, 172.3298338087954, 322.7142605186773, 178.18999999999988, 58.92323761248244, 49.48838424695675, 319.2, 152.1899999999997, 177.99218581694288, 363.56832629798856, 305.0707393060882, 266.78, 331.97366395451235, 350.38042145586564, 212.22728863820402, 275.37949868700434, 65.60000000000008, 167.2899999999998, 52.44000000000013, 118.88478471634792, 187.0499999999996, -27.476212458371894, 348.9512403812424, 66.49999999999979, 116.36000000000023, 152.72063193413874, 143.74206044504388, 155.16000000000003, 150.89128856072716, 249.3091573847888, 141.69783896298838, 270.5359967246083, 264.4699999999999, 172.6984622405214, 133.11000000000035, 338.0460046731068, 171.48000000000002, 275.2201450932447, 287.1166697769214, 217.54000000000002, 3.8399999999999617, 240.22075714128192, 3.889999999999961, 315.8478034801452, 260.5975070975857, 317.57999999999987, 185.61, 292.6999999999996, 264.0399999999999, 304.4599999999999, 182.6081242858104, 97.40000000000018], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [130.70656449336002, 100.0043967039712, -47.49829020840971, 29.025062251094724, -2.976969364074602, 3.013415569045274, 59.72854959538448, -38.74717133631311, 137.72363214163323, -0.9876966278022881, -29.155132954454483, -22.125296147629218, -13.339888179513403, 1.123500175760043, 93.64976191258548, -10.315718650932503, -200.3968025497696, -419.8370676951908, 96.76380513368065, 159.41000000000003, 0.926329042115467, 87.07600932856958, 97.27412437833215, 94.93918556822283, -24.050608149935414, 124.98916572911943, -265.64273306745366, 2.0000000000000013, 1.092058440101001, -480.7377714310004, -168.1446120899938, -61.79617192537643, 115.67677016121564, -45.92580384142339, -58.5997814267735, -13.084914281739096, 134.62391797822568, -5.9808948760770075, 48.087694168894664, 98.5446959368702, 73.2776310978885, 65.9986438127809, 182.81023788404326, 128.84690460371002, -30.293582627356056, 152.23102327124388, -1.9280364665357386, -16.53847675563098, 113.00507027348404, 101.45471110812792, 151.66547799209445, 166.66111665941938, 176.23465306510826, 105.93715006760671, 101.86486236903642, 45.47400110307505, -154.77172735577582, -148.5569233690035, 105.67469659036709, -116.20483628057292, 97.32835124917841, -23.602030275069836, 166.62528953576407, 87.73341171814867, 15.638329791168061, 143.59049548323173, 94.20231698068838, 32.537759459803205, 135.40185662368202, 131.86340415667644, -88.5345738151091, -40.44463630480037, 29.904304555179646, 12.665452353191881, 122.80141884157344, 114.8830155630946, 56.50090057768085, 111.85141081629017, 107.86522540851723, -104.58252459641916, 58.22602542057842, 191.23788822652455, -0.38305417755113647, -16.59094806990431, 144.13322996981782, 109.54507866507656, 112.85019312322413, 169.16296183647654, 0.6194719032969275, -53.37152792295452, 36.6459372475817, 52.97331055434642, 60.54429886551298, 45.70551693022896, 111.57716288375356, 1.1113826403151474, -704.8711194311261, -449.0919872793537, -62.4498729604136, -112.84364833117681, 184.26761492807043, 99.24838298819161, 174.73204821991146, -3.267841524480059, -125.45401749884769, -146.45328426786557, -30.989386155391486, -163.91558305480223, 62.82021787708295, 161.5995329178724, 120.37374293715489, -4.08363568500163, 90.34418107517482, -12.367886507173724, -262.1714658061369, -474.4748702454833, 54.65996722044952, 121.37942699223588, -43.70107987075947, 178.70813190184745, -18.935174459707195, 20.279477997759514, 169.45119042591, 108.34811917554285, 16.237207032690094, 42.17841957173432, -23.745465612415387, 160.39999999999998, -1.90962383221405, -46.40627371894145, 158.68585994866027, 2.0000000000000013, -332.7177181757816, -13.227650403147443, -63.33023443530169, -139.2052255172761, 181.39510245913272, -5.695055814329107, -247.04037571470252, -120.15692578569315, 164.17408815678755, 65.57606608928248, -445.10603270110687, 28.897985869466858, 0.9676586196393774, 25.807417850035343, -132.6765157362089, 5.396031006139339, 66.88995903651106, -87.88327694466521, -6.14038965421766, 117.24891787258105, -40.690381477137464, 93.57230021214657, 93.03564669935695, 26.274930456125958, -1.795300050666114, -12.946488032536971, 152.77908843326128, 9.613715573939093, -43.52670071472221, 131.54710304650044, 0.13922546901893046, 89.74107454554107, -10.795851930095903, 51.85308803692678, 167.8141477810318, 139.4189870339644, 23.2774987094283, -50.722874104295826, 56.67767308878475, 117.13964595897636, 120.34237049419875, -164.58580619050178, 75.59615671951788, -58.72782193580973, -12.481085441359182, -7.401246751393703, 67.74547305321049, 134.0494441861428, -1.4906896913553072, -14.786647849537534, 104.9657863818939, 99.54359910399171, 95.26710373075042, 58.57748537131885, 83.25916320769394, 191.08999999999992, 34.8066660430803, 59.563126787509376, 161.38999999999987, 29.408997486335167, 100.64185623697358, 123.48952050694427, 108.04980600089377, 135.44397394061022, -16.708519127333673, 65.18805133399644, -44.48860236246969, 33.52362050910174], "policy_predator_policy_reward": [51.39386045548761, 25.554732566119426, 47.091630666164285, 168.0376350800687, 4.94696936407456, 70.5965844309547, 14.249967873162278, 86.62349670069831, 16.888655081331702, 16.76513430737605, 14.203325844489244, 121.09470117490103, 158.53374059423592, 1.7308940138544613, 1.2027087635020641, 133.10671041628407, 447.1331653048189, 153.55623554296912, 10.001448602066425, 35.40474626425292, 1.0636709578845345, 45.223990671430435, 71.18268698439245, 47.03400306905255, 31.92563067651881, 118.58581174429722, 200.234903132166, 94.45782993528759, 0.8979415598990004, 480.7477714310004, 80.49204838636281, 200.61653722199145, 46.267501358529834, 121.81139574955637, 61.33139494170895, 181.98756919203774, 3.4224016626791975, 23.14457523517221, 31.307838915470363, 49.15977097876486, 94.28125647272392, 23.35381620687089, 20.4930953962901, 3.7794279284763563, 32.21358262735628, 23.87897672875602, 3.8880364665356986, 18.561300426510154, 3.6897160073740136, 77.95530740558638, 6.680342373812362, 14.280298877653454, 2.945346934891666, 44.29284993239333, 92.53146081065573, 72.9826134224114, 90.36041706143169, 226.5742504576258, 15.348277902369901, 192.1147791872756, 163.10358942781136, 10.099129336418402, 24.915987086191375, 11.535311659895893, 3.491023641935592, 125.83015108366463, 109.09446455393875, 0.913386488586307, 26.51084882715973, 2.7663227329597295, 16.839130908650596, 183.4781930132718, 75.03840271956335, 102.17184037206526, 57.69509787400669, 32.75057270945607, 48.826204710211776, 60.60893844678332, 16.637806693906313, 130.50327760365445, 4.110167782209254, 68.85591857068783, 2.3630541775511302, 18.50094806990461, 57.287534100886745, 12.407446243943415, 0.0, 39.349806876775915, 148.16905055959973, 128.44709532724235, 74.16132784213805, 74.75629690146154, 119.50018420425803, 0.0, 46.49283711624645, 0.8786173596848539, 760.6616804176691, 94.43596372478919, 274.48388829801297, 73.13946680237298, 23.27332691802113, 15.924935684394477, 1.487951780088567, 5.237841524480017, 172.25300215132864, 158.5775372278672, 2.6267867896284436, 241.76656666752214, 53.43630483790276, 41.3439443671419, 29.866257062845246, 6.033635685001588, 61.689170685690094, 38.32672056325176, 532.5740676051176, 567.6405947444907, 65.69445609482743, 63.33688899857574, 23.959932449344645, 107.81301551956747, 154.43763758303228, 176.19172283342783, 41.47180014292027, 31.109311711492573, 12.752067238168742, 141.05959479561093, 50.135767911301684, 88.58919638811807, 107.21023451036821, 6.705663040787251, 6.604140051339739, 0.0, 339.88771817578146, 58.49765040314719, 13.068722275029476, 308.35152239389606, 0.0, 11.349953355196398, 112.02923915507704, 227.69184988694667, 30.23758554489747, 88.96350059027482, 465.16603270110693, 17.542014130533197, 55.72623915663844, 33.858684373686756, 181.89409630798784, 98.10702035622043, 161.91561555544126, 2.8197627977570745, 8.100389654217619, 35.951082127418964, 15.067497522257932, 82.94187230345975, 4.880912992275094, 125.11766723703086, 8.799985045211002, 147.6396420009803, 2.1962913581114902, 105.94690135929648, 42.75171204834561, 133.6978856198761, 8.539236771502528, 74.27892545445891, 69.2874986600916, 22.765265233077493, 3.4146899632165084, 27.39817989489419, 100.72407363157791, 98.20130176328973, 22.44023174296812, 78.96259430251581, 252.54620902692375, 78.8138964463007, 178.99634298321413, 21.67532223307798, 14.411085441359141, 9.311246751393671, 34.99833406009924, 3.427505841829299, 3.4506896913552767, 16.71664784953762, 71.35932710208209, 39.9790908921776, 55.49689966999468, 51.25601832552188, 19.776027750560296, 23.45480904174582, 56.71323382496871, 34.52697334444165, 0.0, 101.90100251366492, 9.848981501967032, 30.059641754115226, 38.09019399910625, 22.876026059389844, 127.065156740058, 7.0634353390893745, 46.31860236246933, 62.04637949089817]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.84620254820463, "mean_inference_ms": 2.6316455833755743, "mean_action_processing_ms": 0.36688271346778734, "mean_env_wait_ms": 0.29665448214612966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005857944488525391, "StateBufferConnector_ms": 0.004703879356384277, "ViewRequirementAgentConnector_ms": 0.13387823104858398}, "num_episodes": 18, "episode_return_max": 363.56832629798856, "episode_return_min": -298.8654625680222, "episode_return_mean": 195.9107538988258, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.1562223904653, "num_env_steps_trained_throughput_per_sec": 288.1562223904653, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 14299.974, "restore_workers_time_ms": 0.013, "training_step_time_ms": 14299.924, "sample_time_ms": 2159.062, "learn_time_ms": 12121.84, "learn_throughput": 329.983, "synch_weights_time_ms": 17.181}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 57, "trial_id": "61e09_00000", "date": "2024-08-16_16-20-56", "timestamp": 1723805456, "time_this_iter_s": 13.90947699546814, "time_total_s": 857.0012831687927, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30001e310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 857.0012831687927, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 61.93999999999998, "ram_util_percent": 80.42999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6297115592256426, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 0.00010000000000000003, "total_loss": 2.6149942094056065, "policy_loss": -0.002367131213938433, "vf_loss": 2.6170374487442944, "vf_explained_var": 0.0821050661581534, "kl": 0.004318620616512314, "entropy": 0.2982253129520113, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.737010221443479, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 5.115496379736239, "policy_loss": -0.0037376045754484873, "vf_loss": 5.117297775152499, "vf_explained_var": 0.1368677850753542, "kl": 0.006454007297983288, "entropy": 1.2122159068546599, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 364.2299999999999, "episode_reward_min": -298.8654625680222, "episode_reward_mean": 200.34883742481466, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -704.8711194311261, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 191.23788822652455, "predator_policy": 760.6616804176691}, "policy_reward_mean": {"prey_policy": 17.74630153144905, "predator_policy": 82.42811718095834}, "custom_metrics": {}, "hist_stats": {"episode_reward": [178.02999999999963, 3.982823670878848, 296.10480479457243, 339.2872359029797, 329.4099999999998, 312.85293770517853, 13.606016794278462, 196.93291739943982, 246.92903973833808, 290.81000000000006, 288.54999999999984, 236.7479274830164, 296.5424323404778, 71.33811380201278, 219.7799999999999, 328.13010498813077, 277.7874545509656, 150.423785109659, 322.42999999999984, 3.8899999999999615, 323.37328897972446, 321.36296183647653, 223.8640898671831, 238.5368725455267, 225.74999999999994, 160.0599999999999, -298.8654625680222, 172.3298338087954, 322.7142605186773, 178.18999999999988, 58.92323761248244, 49.48838424695675, 319.2, 152.1899999999997, 177.99218581694288, 363.56832629798856, 305.0707393060882, 266.78, 331.97366395451235, 350.38042145586564, 212.22728863820402, 275.37949868700434, 65.60000000000008, 167.2899999999998, 52.44000000000013, 118.88478471634792, 187.0499999999996, -27.476212458371894, 348.9512403812424, 66.49999999999979, 116.36000000000023, 152.72063193413874, 143.74206044504388, 155.16000000000003, 150.89128856072716, 249.3091573847888, 141.69783896298838, 270.5359967246083, 264.4699999999999, 172.6984622405214, 133.11000000000035, 338.0460046731068, 171.48000000000002, 275.2201450932447, 287.1166697769214, 217.54000000000002, 3.8399999999999617, 240.22075714128192, 3.889999999999961, 315.8478034801452, 260.5975070975857, 317.57999999999987, 185.61, 292.6999999999996, 264.0399999999999, 304.4599999999999, 182.6081242858104, 97.40000000000018, 239.9599999999999, 335.26, -82.75091348968301, 121.22000000000045, 330.6489254399162, 169.0158125082889, 228.2199999999998, 364.2299999999999, 272.38, 18.367332528718904, 117.06000000000024, -1.9694123908571401, 349.36125255793763, 172.7040734405312, -119.24913118081699, 153.8639048658526, 363.04035143476204, 311.5499999999999, 17.07999999999994, 185.08410104235554, 308.38999999999993, 359.23], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-30.293582627356056, 152.23102327124388, -1.9280364665357386, -16.53847675563098, 113.00507027348404, 101.45471110812792, 151.66547799209445, 166.66111665941938, 176.23465306510826, 105.93715006760671, 101.86486236903642, 45.47400110307505, -154.77172735577582, -148.5569233690035, 105.67469659036709, -116.20483628057292, 97.32835124917841, -23.602030275069836, 166.62528953576407, 87.73341171814867, 15.638329791168061, 143.59049548323173, 94.20231698068838, 32.537759459803205, 135.40185662368202, 131.86340415667644, -88.5345738151091, -40.44463630480037, 29.904304555179646, 12.665452353191881, 122.80141884157344, 114.8830155630946, 56.50090057768085, 111.85141081629017, 107.86522540851723, -104.58252459641916, 58.22602542057842, 191.23788822652455, -0.38305417755113647, -16.59094806990431, 144.13322996981782, 109.54507866507656, 112.85019312322413, 169.16296183647654, 0.6194719032969275, -53.37152792295452, 36.6459372475817, 52.97331055434642, 60.54429886551298, 45.70551693022896, 111.57716288375356, 1.1113826403151474, -704.8711194311261, -449.0919872793537, -62.4498729604136, -112.84364833117681, 184.26761492807043, 99.24838298819161, 174.73204821991146, -3.267841524480059, -125.45401749884769, -146.45328426786557, -30.989386155391486, -163.91558305480223, 62.82021787708295, 161.5995329178724, 120.37374293715489, -4.08363568500163, 90.34418107517482, -12.367886507173724, -262.1714658061369, -474.4748702454833, 54.65996722044952, 121.37942699223588, -43.70107987075947, 178.70813190184745, -18.935174459707195, 20.279477997759514, 169.45119042591, 108.34811917554285, 16.237207032690094, 42.17841957173432, -23.745465612415387, 160.39999999999998, -1.90962383221405, -46.40627371894145, 158.68585994866027, 2.0000000000000013, -332.7177181757816, -13.227650403147443, -63.33023443530169, -139.2052255172761, 181.39510245913272, -5.695055814329107, -247.04037571470252, -120.15692578569315, 164.17408815678755, 65.57606608928248, -445.10603270110687, 28.897985869466858, 0.9676586196393774, 25.807417850035343, -132.6765157362089, 5.396031006139339, 66.88995903651106, -87.88327694466521, -6.14038965421766, 117.24891787258105, -40.690381477137464, 93.57230021214657, 93.03564669935695, 26.274930456125958, -1.795300050666114, -12.946488032536971, 152.77908843326128, 9.613715573939093, -43.52670071472221, 131.54710304650044, 0.13922546901893046, 89.74107454554107, -10.795851930095903, 51.85308803692678, 167.8141477810318, 139.4189870339644, 23.2774987094283, -50.722874104295826, 56.67767308878475, 117.13964595897636, 120.34237049419875, -164.58580619050178, 75.59615671951788, -58.72782193580973, -12.481085441359182, -7.401246751393703, 67.74547305321049, 134.0494441861428, -1.4906896913553072, -14.786647849537534, 104.9657863818939, 99.54359910399171, 95.26710373075042, 58.57748537131885, 83.25916320769394, 191.08999999999992, 34.8066660430803, 59.563126787509376, 161.38999999999987, 29.408997486335167, 100.64185623697358, 123.48952050694427, 108.04980600089377, 135.44397394061022, -16.708519127333673, 65.18805133399644, -44.48860236246969, 33.52362050910174, -5.06532727559599, 96.94190548631303, 176.11428071866544, 112.43680736959206, -293.21665682332986, -700.8671219924454, -71.08981463594257, 35.59794554778783, 157.7104599899863, 143.44540915879008, 127.39762012423826, -0.2608411994716735, 77.67711196872246, 70.5985760520135, 176.4200087380682, 175.95218795390554, 55.436858850276565, 93.51257891887161, -121.49769354498488, -275.16549493680776, -11.60347505105158, -3.1873610716174525, -121.56863573838862, -599.9417284461988, 59.0442224484063, 187.13000000000005, 71.90171264937236, -10.041306633120497, -192.7947498670667, -300.94529944966945, 107.56010689470111, -9.298274215688416, 64.2706709528542, 179.27848865669156, 68.74874375662505, 165.34999999999988, -600.8190294915704, -4.105007130925952, 107.6690592257724, -14.844118192317566, 26.837584307150784, 176.57676384808846, 150.016390883277, 186.38802009625672], "policy_predator_policy_reward": [32.21358262735628, 23.87897672875602, 3.8880364665356986, 18.561300426510154, 3.6897160073740136, 77.95530740558638, 6.680342373812362, 14.280298877653454, 2.945346934891666, 44.29284993239333, 92.53146081065573, 72.9826134224114, 90.36041706143169, 226.5742504576258, 15.348277902369901, 192.1147791872756, 163.10358942781136, 10.099129336418402, 24.915987086191375, 11.535311659895893, 3.491023641935592, 125.83015108366463, 109.09446455393875, 0.913386488586307, 26.51084882715973, 2.7663227329597295, 16.839130908650596, 183.4781930132718, 75.03840271956335, 102.17184037206526, 57.69509787400669, 32.75057270945607, 48.826204710211776, 60.60893844678332, 16.637806693906313, 130.50327760365445, 4.110167782209254, 68.85591857068783, 2.3630541775511302, 18.50094806990461, 57.287534100886745, 12.407446243943415, 0.0, 39.349806876775915, 148.16905055959973, 128.44709532724235, 74.16132784213805, 74.75629690146154, 119.50018420425803, 0.0, 46.49283711624645, 0.8786173596848539, 760.6616804176691, 94.43596372478919, 274.48388829801297, 73.13946680237298, 23.27332691802113, 15.924935684394477, 1.487951780088567, 5.237841524480017, 172.25300215132864, 158.5775372278672, 2.6267867896284436, 241.76656666752214, 53.43630483790276, 41.3439443671419, 29.866257062845246, 6.033635685001588, 61.689170685690094, 38.32672056325176, 532.5740676051176, 567.6405947444907, 65.69445609482743, 63.33688899857574, 23.959932449344645, 107.81301551956747, 154.43763758303228, 176.19172283342783, 41.47180014292027, 31.109311711492573, 12.752067238168742, 141.05959479561093, 50.135767911301684, 88.58919638811807, 107.21023451036821, 6.705663040787251, 6.604140051339739, 0.0, 339.88771817578146, 58.49765040314719, 13.068722275029476, 308.35152239389606, 0.0, 11.349953355196398, 112.02923915507704, 227.69184988694667, 30.23758554489747, 88.96350059027482, 465.16603270110693, 17.542014130533197, 55.72623915663844, 33.858684373686756, 181.89409630798784, 98.10702035622043, 161.91561555544126, 2.8197627977570745, 8.100389654217619, 35.951082127418964, 15.067497522257932, 82.94187230345975, 4.880912992275094, 125.11766723703086, 8.799985045211002, 147.6396420009803, 2.1962913581114902, 105.94690135929648, 42.75171204834561, 133.6978856198761, 8.539236771502528, 74.27892545445891, 69.2874986600916, 22.765265233077493, 3.4146899632165084, 27.39817989489419, 100.72407363157791, 98.20130176328973, 22.44023174296812, 78.96259430251581, 252.54620902692375, 78.8138964463007, 178.99634298321413, 21.67532223307798, 14.411085441359141, 9.311246751393671, 34.99833406009924, 3.427505841829299, 3.4506896913552767, 16.71664784953762, 71.35932710208209, 39.9790908921776, 55.49689966999468, 51.25601832552188, 19.776027750560296, 23.45480904174582, 56.71323382496871, 34.52697334444165, 0.0, 101.90100251366492, 9.848981501967032, 30.059641754115226, 38.09019399910625, 22.876026059389844, 127.065156740058, 7.0634353390893745, 46.31860236246933, 62.04637949089817, 3.8326117884377613, 144.25081000084515, 8.965719281334572, 37.74319263040796, 208.54962319542847, 702.7832421306634, 94.91189634767473, 61.799972740481, 21.815643686052443, 7.677412605087458, 16.533485056860652, 25.345548526662014, 75.80423007283, 4.140081906434016, 8.834837859061158, 3.0229654489650617, 25.505463184789477, 97.92509904606247, 90.79858379360873, 324.23193721690274, 78.81862997032958, 53.032206152339455, 10.997784997122158, 708.5431667966077, 37.580387118891295, 65.60664299064018, 90.8059034239719, 20.037764000307583, 326.6546565931216, 47.83626154279734, 10.067687854270957, 45.534384332568905, 72.66352373523861, 46.827668089977905, 69.7547179058594, 7.696538337515599, 615.9590294915703, 6.045007130925911, 43.038544058896285, 49.220615950004806, 2.3315383640835785, 102.64411348067719, 22.82558902046625, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8446835178139669, "mean_inference_ms": 2.6237842774671596, "mean_action_processing_ms": 0.3655050123648745, "mean_env_wait_ms": 0.2955085695756975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005797863006591797, "StateBufferConnector_ms": 0.0033916234970092773, "ViewRequirementAgentConnector_ms": 0.15355730056762695}, "num_episodes": 22, "episode_return_max": 364.2299999999999, "episode_return_min": -298.8654625680222, "episode_return_mean": 200.34883742481466, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 293.2748709341477, "num_env_steps_trained_throughput_per_sec": 293.2748709341477, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 14063.258, "restore_workers_time_ms": 0.013, "training_step_time_ms": 14063.202, "sample_time_ms": 1865.671, "learn_time_ms": 12177.775, "learn_throughput": 328.467, "synch_weights_time_ms": 17.916}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 58, "trial_id": "61e09_00000", "date": "2024-08-16_16-21-10", "timestamp": 1723805470, "time_this_iter_s": 13.665853261947632, "time_total_s": 870.6671364307404, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3000cb3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 870.6671364307404, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 63.66315789473685, "ram_util_percent": 80.44736842105263}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3313416418575104, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 0.00010000000000000003, "total_loss": 3.2994942877027724, "policy_loss": -0.004959225367197876, "vf_loss": 3.3032852667349357, "vf_explained_var": 0.11688856293284704, "kl": 0.031153226575843167, "entropy": 0.23655833812065857, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5528947661478054, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 6.321648726639924, "policy_loss": -0.007707744997694457, "vf_loss": 6.326843463806879, "vf_explained_var": 0.013843628180720819, "kl": 0.008376690598378856, "entropy": 1.2293057902149422, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "env_runners": {"episode_reward_max": 375.0576407928446, "episode_reward_min": -298.8654625680222, "episode_reward_mean": 191.181567910999, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -704.8711194311261, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 191.23788822652455, "predator_policy": 760.6616804176691}, "policy_reward_mean": {"prey_policy": 7.046584070585394, "predator_policy": 88.54419988491414}, "custom_metrics": {}, "hist_stats": {"episode_reward": [322.42999999999984, 3.8899999999999615, 323.37328897972446, 321.36296183647653, 223.8640898671831, 238.5368725455267, 225.74999999999994, 160.0599999999999, -298.8654625680222, 172.3298338087954, 322.7142605186773, 178.18999999999988, 58.92323761248244, 49.48838424695675, 319.2, 152.1899999999997, 177.99218581694288, 363.56832629798856, 305.0707393060882, 266.78, 331.97366395451235, 350.38042145586564, 212.22728863820402, 275.37949868700434, 65.60000000000008, 167.2899999999998, 52.44000000000013, 118.88478471634792, 187.0499999999996, -27.476212458371894, 348.9512403812424, 66.49999999999979, 116.36000000000023, 152.72063193413874, 143.74206044504388, 155.16000000000003, 150.89128856072716, 249.3091573847888, 141.69783896298838, 270.5359967246083, 264.4699999999999, 172.6984622405214, 133.11000000000035, 338.0460046731068, 171.48000000000002, 275.2201450932447, 287.1166697769214, 217.54000000000002, 3.8399999999999617, 240.22075714128192, 3.889999999999961, 315.8478034801452, 260.5975070975857, 317.57999999999987, 185.61, 292.6999999999996, 264.0399999999999, 304.4599999999999, 182.6081242858104, 97.40000000000018, 239.9599999999999, 335.26, -82.75091348968301, 121.22000000000045, 330.6489254399162, 169.0158125082889, 228.2199999999998, 364.2299999999999, 272.38, 18.367332528718904, 117.06000000000024, -1.9694123908571401, 349.36125255793763, 172.7040734405312, -119.24913118081699, 153.8639048658526, 363.04035143476204, 311.5499999999999, 17.07999999999994, 185.08410104235554, 308.38999999999993, 359.23, -280.0883818661753, 9.470581003300248, 328.41213471224927, -186.8694644426219, -125.14765168137585, 291.60999999999984, 278.88159535369033, 302.6874527058107, 310.5487461998616, 269.90999999999985, 3.8899999999999615, 314.68071088856897, 309.4399999999998, 325.2879726584697, 375.0576407928446, 290.82999999999976, 223.30730657373556, 118.61000000000023], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [58.22602542057842, 191.23788822652455, -0.38305417755113647, -16.59094806990431, 144.13322996981782, 109.54507866507656, 112.85019312322413, 169.16296183647654, 0.6194719032969275, -53.37152792295452, 36.6459372475817, 52.97331055434642, 60.54429886551298, 45.70551693022896, 111.57716288375356, 1.1113826403151474, -704.8711194311261, -449.0919872793537, -62.4498729604136, -112.84364833117681, 184.26761492807043, 99.24838298819161, 174.73204821991146, -3.267841524480059, -125.45401749884769, -146.45328426786557, -30.989386155391486, -163.91558305480223, 62.82021787708295, 161.5995329178724, 120.37374293715489, -4.08363568500163, 90.34418107517482, -12.367886507173724, -262.1714658061369, -474.4748702454833, 54.65996722044952, 121.37942699223588, -43.70107987075947, 178.70813190184745, -18.935174459707195, 20.279477997759514, 169.45119042591, 108.34811917554285, 16.237207032690094, 42.17841957173432, -23.745465612415387, 160.39999999999998, -1.90962383221405, -46.40627371894145, 158.68585994866027, 2.0000000000000013, -332.7177181757816, -13.227650403147443, -63.33023443530169, -139.2052255172761, 181.39510245913272, -5.695055814329107, -247.04037571470252, -120.15692578569315, 164.17408815678755, 65.57606608928248, -445.10603270110687, 28.897985869466858, 0.9676586196393774, 25.807417850035343, -132.6765157362089, 5.396031006139339, 66.88995903651106, -87.88327694466521, -6.14038965421766, 117.24891787258105, -40.690381477137464, 93.57230021214657, 93.03564669935695, 26.274930456125958, -1.795300050666114, -12.946488032536971, 152.77908843326128, 9.613715573939093, -43.52670071472221, 131.54710304650044, 0.13922546901893046, 89.74107454554107, -10.795851930095903, 51.85308803692678, 167.8141477810318, 139.4189870339644, 23.2774987094283, -50.722874104295826, 56.67767308878475, 117.13964595897636, 120.34237049419875, -164.58580619050178, 75.59615671951788, -58.72782193580973, -12.481085441359182, -7.401246751393703, 67.74547305321049, 134.0494441861428, -1.4906896913553072, -14.786647849537534, 104.9657863818939, 99.54359910399171, 95.26710373075042, 58.57748537131885, 83.25916320769394, 191.08999999999992, 34.8066660430803, 59.563126787509376, 161.38999999999987, 29.408997486335167, 100.64185623697358, 123.48952050694427, 108.04980600089377, 135.44397394061022, -16.708519127333673, 65.18805133399644, -44.48860236246969, 33.52362050910174, -5.06532727559599, 96.94190548631303, 176.11428071866544, 112.43680736959206, -293.21665682332986, -700.8671219924454, -71.08981463594257, 35.59794554778783, 157.7104599899863, 143.44540915879008, 127.39762012423826, -0.2608411994716735, 77.67711196872246, 70.5985760520135, 176.4200087380682, 175.95218795390554, 55.436858850276565, 93.51257891887161, -121.49769354498488, -275.16549493680776, -11.60347505105158, -3.1873610716174525, -121.56863573838862, -599.9417284461988, 59.0442224484063, 187.13000000000005, 71.90171264937236, -10.041306633120497, -192.7947498670667, -300.94529944966945, 107.56010689470111, -9.298274215688416, 64.2706709528542, 179.27848865669156, 68.74874375662505, 165.34999999999988, -600.8190294915704, -4.105007130925952, 107.6690592257724, -14.844118192317566, 26.837584307150784, 176.57676384808846, 150.016390883277, 186.38802009625672, -600.1777785354209, -504.2504116073806, -170.79902079755922, -167.538057357008, 110.14082691438689, 161.06026407410553, -418.2843066885483, -265.7285690390382, -256.56481549685486, -331.6469905456619, 63.90464488057701, 106.48197277413811, 104.81077135726632, 77.87387945600335, 96.11528014995393, 119.19661473458777, 130.95876554973006, 130.3849834488075, 54.51194516249462, 170.33700200008627, 2.0000000000000013, -9.24812575361272, 136.27330401945045, 75.64623582177755, 62.18528990683, 169.87670728338853, -34.842702157501385, 158.34040973942336, 178.27595358210905, 166.58447532047308, 142.50800489598555, 101.30083340920525, 104.41536813854461, -141.0758541189339, 106.91395982325147, -13.745994750628162], "policy_predator_policy_reward": [4.110167782209254, 68.85591857068783, 2.3630541775511302, 18.50094806990461, 57.287534100886745, 12.407446243943415, 0.0, 39.349806876775915, 148.16905055959973, 128.44709532724235, 74.16132784213805, 74.75629690146154, 119.50018420425803, 0.0, 46.49283711624645, 0.8786173596848539, 760.6616804176691, 94.43596372478919, 274.48388829801297, 73.13946680237298, 23.27332691802113, 15.924935684394477, 1.487951780088567, 5.237841524480017, 172.25300215132864, 158.5775372278672, 2.6267867896284436, 241.76656666752214, 53.43630483790276, 41.3439443671419, 29.866257062845246, 6.033635685001588, 61.689170685690094, 38.32672056325176, 532.5740676051176, 567.6405947444907, 65.69445609482743, 63.33688899857574, 23.959932449344645, 107.81301551956747, 154.43763758303228, 176.19172283342783, 41.47180014292027, 31.109311711492573, 12.752067238168742, 141.05959479561093, 50.135767911301684, 88.58919638811807, 107.21023451036821, 6.705663040787251, 6.604140051339739, 0.0, 339.88771817578146, 58.49765040314719, 13.068722275029476, 308.35152239389606, 0.0, 11.349953355196398, 112.02923915507704, 227.69184988694667, 30.23758554489747, 88.96350059027482, 465.16603270110693, 17.542014130533197, 55.72623915663844, 33.858684373686756, 181.89409630798784, 98.10702035622043, 161.91561555544126, 2.8197627977570745, 8.100389654217619, 35.951082127418964, 15.067497522257932, 82.94187230345975, 4.880912992275094, 125.11766723703086, 8.799985045211002, 147.6396420009803, 2.1962913581114902, 105.94690135929648, 42.75171204834561, 133.6978856198761, 8.539236771502528, 74.27892545445891, 69.2874986600916, 22.765265233077493, 3.4146899632165084, 27.39817989489419, 100.72407363157791, 98.20130176328973, 22.44023174296812, 78.96259430251581, 252.54620902692375, 78.8138964463007, 178.99634298321413, 21.67532223307798, 14.411085441359141, 9.311246751393671, 34.99833406009924, 3.427505841829299, 3.4506896913552767, 16.71664784953762, 71.35932710208209, 39.9790908921776, 55.49689966999468, 51.25601832552188, 19.776027750560296, 23.45480904174582, 56.71323382496871, 34.52697334444165, 0.0, 101.90100251366492, 9.848981501967032, 30.059641754115226, 38.09019399910625, 22.876026059389844, 127.065156740058, 7.0634353390893745, 46.31860236246933, 62.04637949089817, 3.8326117884377613, 144.25081000084515, 8.965719281334572, 37.74319263040796, 208.54962319542847, 702.7832421306634, 94.91189634767473, 61.799972740481, 21.815643686052443, 7.677412605087458, 16.533485056860652, 25.345548526662014, 75.80423007283, 4.140081906434016, 8.834837859061158, 3.0229654489650617, 25.505463184789477, 97.92509904606247, 90.79858379360873, 324.23193721690274, 78.81862997032958, 53.032206152339455, 10.997784997122158, 708.5431667966077, 37.580387118891295, 65.60664299064018, 90.8059034239719, 20.037764000307583, 326.6546565931216, 47.83626154279734, 10.067687854270957, 45.534384332568905, 72.66352373523861, 46.827668089977905, 69.7547179058594, 7.696538337515599, 615.9590294915703, 6.045007130925911, 43.038544058896285, 49.220615950004806, 2.3315383640835785, 102.64411348067719, 22.82558902046625, 0.0, 701.6138000519161, 122.7260082247103, 20.47795487112976, 327.3297042867379, 47.00917308561309, 10.201870638143664, 456.6571588462334, 40.48625243873192, 416.5211139040066, 46.5430404571342, 82.29535511942302, 38.92802722586197, 87.45246373933361, 8.74448080108709, 19.656361299835545, 67.71919652143359, 35.50799881458312, 13.696998386741342, 17.273608282328706, 27.787444555090566, 0.0, 11.13812575361268, 74.49256185131294, 28.268609196028194, 42.72648945987291, 34.651513349908534, 68.58345136749267, 133.2068137090551, 18.241609944232483, 11.955601946030129, 26.711995104014484, 20.30916659079478, 143.39542176486938, 116.57237078925546, 9.816040176748517, 15.625994750628122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8415142638059359, "mean_inference_ms": 2.622061590367171, "mean_action_processing_ms": 0.3647107274568484, "mean_env_wait_ms": 0.2953902545479952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005692243576049805, "StateBufferConnector_ms": 0.003443479537963867, "ViewRequirementAgentConnector_ms": 0.1543489694595337}, "num_episodes": 18, "episode_return_max": 375.0576407928446, "episode_return_min": -298.8654625680222, "episode_return_mean": 191.181567910999, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.4894668449579, "num_env_steps_trained_throughput_per_sec": 292.4894668449579, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 13918.585, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13918.527, "sample_time_ms": 1821.221, "learn_time_ms": 12076.561, "learn_throughput": 331.22, "synch_weights_time_ms": 18.941}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "training_iteration": 59, "trial_id": "61e09_00000", "date": "2024-08-16_16-21-24", "timestamp": 1723805484, "time_this_iter_s": 13.725531816482544, "time_total_s": 884.3926682472229, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2499d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 884.3926682472229, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 66.48421052631579, "ram_util_percent": 80.4421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6010062381704016, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 2.6814835204649223, "policy_loss": -0.00797354060153738, "vf_loss": 2.6891500008169307, "vf_explained_var": 0.10058673109327043, "kl": 0.005458857660061199, "entropy": 0.3374849120618174, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.626312783407786, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 5.713207538544186, "policy_loss": -0.010786859049503666, "vf_loss": 5.720841696653417, "vf_explained_var": 0.6022655494314022, "kl": 0.010508973342973424, "entropy": 1.1780295184049656, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 375.0576407928446, "episode_reward_min": -280.0883818661753, "episode_reward_mean": 193.8176238265141, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -700.8671219924454, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 191.08999999999997, "predator_policy": 708.5431667966077}, "policy_reward_mean": {"prey_policy": 15.580900773727477, "predator_policy": 81.32791113952962}, "custom_metrics": {}, "hist_stats": {"episode_reward": [275.37949868700434, 65.60000000000008, 167.2899999999998, 52.44000000000013, 118.88478471634792, 187.0499999999996, -27.476212458371894, 348.9512403812424, 66.49999999999979, 116.36000000000023, 152.72063193413874, 143.74206044504388, 155.16000000000003, 150.89128856072716, 249.3091573847888, 141.69783896298838, 270.5359967246083, 264.4699999999999, 172.6984622405214, 133.11000000000035, 338.0460046731068, 171.48000000000002, 275.2201450932447, 287.1166697769214, 217.54000000000002, 3.8399999999999617, 240.22075714128192, 3.889999999999961, 315.8478034801452, 260.5975070975857, 317.57999999999987, 185.61, 292.6999999999996, 264.0399999999999, 304.4599999999999, 182.6081242858104, 97.40000000000018, 239.9599999999999, 335.26, -82.75091348968301, 121.22000000000045, 330.6489254399162, 169.0158125082889, 228.2199999999998, 364.2299999999999, 272.38, 18.367332528718904, 117.06000000000024, -1.9694123908571401, 349.36125255793763, 172.7040734405312, -119.24913118081699, 153.8639048658526, 363.04035143476204, 311.5499999999999, 17.07999999999994, 185.08410104235554, 308.38999999999993, 359.23, -280.0883818661753, 9.470581003300248, 328.41213471224927, -186.8694644426219, -125.14765168137585, 291.60999999999984, 278.88159535369033, 302.6874527058107, 310.5487461998616, 269.90999999999985, 3.8899999999999615, 314.68071088856897, 309.4399999999998, 325.2879726584697, 375.0576407928446, 290.82999999999976, 223.30730657373556, 118.61000000000023, 158.23000000000025, 291.2195968194083, 115.02024303154184, 238.54999999999995, 155.92000000000007, 329.5199999999998, 174.7484592113627, 266.33000000000004, -69.83501864357584, 307.6396766992919, 78.44000000000015, 152.1800000000002, 342.44999999999993, 254.92999999999984, 161.3422098340667, 287.0185056933674, 173.93158057677357, 123.1300000000002, 286.55999999999983, 337.09999999999997, 341.8692058279055, 358.63004290638287, 180.11118191239098], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-23.745465612415387, 160.39999999999998, -1.90962383221405, -46.40627371894145, 158.68585994866027, 2.0000000000000013, -332.7177181757816, -13.227650403147443, -63.33023443530169, -139.2052255172761, 181.39510245913272, -5.695055814329107, -247.04037571470252, -120.15692578569315, 164.17408815678755, 65.57606608928248, -445.10603270110687, 28.897985869466858, 0.9676586196393774, 25.807417850035343, -132.6765157362089, 5.396031006139339, 66.88995903651106, -87.88327694466521, -6.14038965421766, 117.24891787258105, -40.690381477137464, 93.57230021214657, 93.03564669935695, 26.274930456125958, -1.795300050666114, -12.946488032536971, 152.77908843326128, 9.613715573939093, -43.52670071472221, 131.54710304650044, 0.13922546901893046, 89.74107454554107, -10.795851930095903, 51.85308803692678, 167.8141477810318, 139.4189870339644, 23.2774987094283, -50.722874104295826, 56.67767308878475, 117.13964595897636, 120.34237049419875, -164.58580619050178, 75.59615671951788, -58.72782193580973, -12.481085441359182, -7.401246751393703, 67.74547305321049, 134.0494441861428, -1.4906896913553072, -14.786647849537534, 104.9657863818939, 99.54359910399171, 95.26710373075042, 58.57748537131885, 83.25916320769394, 191.08999999999992, 34.8066660430803, 59.563126787509376, 161.38999999999987, 29.408997486335167, 100.64185623697358, 123.48952050694427, 108.04980600089377, 135.44397394061022, -16.708519127333673, 65.18805133399644, -44.48860236246969, 33.52362050910174, -5.06532727559599, 96.94190548631303, 176.11428071866544, 112.43680736959206, -293.21665682332986, -700.8671219924454, -71.08981463594257, 35.59794554778783, 157.7104599899863, 143.44540915879008, 127.39762012423826, -0.2608411994716735, 77.67711196872246, 70.5985760520135, 176.4200087380682, 175.95218795390554, 55.436858850276565, 93.51257891887161, -121.49769354498488, -275.16549493680776, -11.60347505105158, -3.1873610716174525, -121.56863573838862, -599.9417284461988, 59.0442224484063, 187.13000000000005, 71.90171264937236, -10.041306633120497, -192.7947498670667, -300.94529944966945, 107.56010689470111, -9.298274215688416, 64.2706709528542, 179.27848865669156, 68.74874375662505, 165.34999999999988, -600.8190294915704, -4.105007130925952, 107.6690592257724, -14.844118192317566, 26.837584307150784, 176.57676384808846, 150.016390883277, 186.38802009625672, -600.1777785354209, -504.2504116073806, -170.79902079755922, -167.538057357008, 110.14082691438689, 161.06026407410553, -418.2843066885483, -265.7285690390382, -256.56481549685486, -331.6469905456619, 63.90464488057701, 106.48197277413811, 104.81077135726632, 77.87387945600335, 96.11528014995393, 119.19661473458777, 130.95876554973006, 130.3849834488075, 54.51194516249462, 170.33700200008627, 2.0000000000000013, -9.24812575361272, 136.27330401945045, 75.64623582177755, 62.18528990683, 169.87670728338853, -34.842702157501385, 158.34040973942336, 178.27595358210905, 166.58447532047308, 142.50800489598555, 101.30083340920525, 104.41536813854461, -141.0758541189339, 106.91395982325147, -13.745994750628162, -5.761334240100802, 135.8568915802618, 190.16578723848863, -12.218107044413742, 1.164607278372252, 8.769476989138667, -48.58906879908679, 66.41867414654757, 114.0831691411706, -37.6128517071171, 135.94278676461784, 154.52755584868015, 8.241495759464199, -68.59410735133012, -2.344643842789104, 120.66816866653892, -456.5882965515474, -240.74061077230243, 102.73720950883187, 86.09082705407658, -14.989965588699786, -18.371652884130807, 2.0000000000000013, 91.98691909425744, 167.19255319528787, 160.33976953467385, 138.13615609179544, 3.844626499416499, 60.19361371770644, -19.595109559948302, 61.18814424071249, 49.88764643650845, -9.118444526901758, -18.318197299139875, 1.2167570422134801, -11.65020220669831, 71.92065787051166, 113.81911770709287, 191.08999999999997, 76.52044334179301, 144.04710053532696, 80.07684110547044, 167.66758314193368, 145.496932360105, -142.47938374287284, -23.912458865267517], "policy_predator_policy_reward": [50.135767911301684, 88.58919638811807, 107.21023451036821, 6.705663040787251, 6.604140051339739, 0.0, 339.88771817578146, 58.49765040314719, 13.068722275029476, 308.35152239389606, 0.0, 11.349953355196398, 112.02923915507704, 227.69184988694667, 30.23758554489747, 88.96350059027482, 465.16603270110693, 17.542014130533197, 55.72623915663844, 33.858684373686756, 181.89409630798784, 98.10702035622043, 161.91561555544126, 2.8197627977570745, 8.100389654217619, 35.951082127418964, 15.067497522257932, 82.94187230345975, 4.880912992275094, 125.11766723703086, 8.799985045211002, 147.6396420009803, 2.1962913581114902, 105.94690135929648, 42.75171204834561, 133.6978856198761, 8.539236771502528, 74.27892545445891, 69.2874986600916, 22.765265233077493, 3.4146899632165084, 27.39817989489419, 100.72407363157791, 98.20130176328973, 22.44023174296812, 78.96259430251581, 252.54620902692375, 78.8138964463007, 178.99634298321413, 21.67532223307798, 14.411085441359141, 9.311246751393671, 34.99833406009924, 3.427505841829299, 3.4506896913552767, 16.71664784953762, 71.35932710208209, 39.9790908921776, 55.49689966999468, 51.25601832552188, 19.776027750560296, 23.45480904174582, 56.71323382496871, 34.52697334444165, 0.0, 101.90100251366492, 9.848981501967032, 30.059641754115226, 38.09019399910625, 22.876026059389844, 127.065156740058, 7.0634353390893745, 46.31860236246933, 62.04637949089817, 3.8326117884377613, 144.25081000084515, 8.965719281334572, 37.74319263040796, 208.54962319542847, 702.7832421306634, 94.91189634767473, 61.799972740481, 21.815643686052443, 7.677412605087458, 16.533485056860652, 25.345548526662014, 75.80423007283, 4.140081906434016, 8.834837859061158, 3.0229654489650617, 25.505463184789477, 97.92509904606247, 90.79858379360873, 324.23193721690274, 78.81862997032958, 53.032206152339455, 10.997784997122158, 708.5431667966077, 37.580387118891295, 65.60664299064018, 90.8059034239719, 20.037764000307583, 326.6546565931216, 47.83626154279734, 10.067687854270957, 45.534384332568905, 72.66352373523861, 46.827668089977905, 69.7547179058594, 7.696538337515599, 615.9590294915703, 6.045007130925911, 43.038544058896285, 49.220615950004806, 2.3315383640835785, 102.64411348067719, 22.82558902046625, 0.0, 701.6138000519161, 122.7260082247103, 20.47795487112976, 327.3297042867379, 47.00917308561309, 10.201870638143664, 456.6571588462334, 40.48625243873192, 416.5211139040066, 46.5430404571342, 82.29535511942302, 38.92802722586197, 87.45246373933361, 8.74448080108709, 19.656361299835545, 67.71919652143359, 35.50799881458312, 13.696998386741342, 17.273608282328706, 27.787444555090566, 0.0, 11.13812575361268, 74.49256185131294, 28.268609196028194, 42.72648945987291, 34.651513349908534, 68.58345136749267, 133.2068137090551, 18.241609944232483, 11.955601946030129, 26.711995104014484, 20.30916659079478, 143.39542176486938, 116.57237078925546, 9.816040176748517, 15.625994750628122, 7.7113342401007605, 20.423108419738234, 83.52984267165783, 29.742073953675902, 43.159350872011565, 61.92680789201908, 44.23969521049588, 176.48069944204335, 40.07683085882944, 39.37285170711675, 9.5072132353822, 29.542444151319874, 162.08783341210585, 73.0132373911228, 65.13595810896386, 82.87051706728641, 84.77984246577489, 542.7140462144994, 40.55167751284401, 78.25996262353941, 93.76354784134118, 18.03807063148964, 4.612602527207647, 53.58047837853491, 13.888650157214688, 1.0290271128236215, 35.04384390820463, 77.90537350058372, 4.721607867319011, 116.02209780898944, 107.42600116797436, 68.51671384817216, 119.6005621099776, 81.76766029283755, 74.70738858401992, 58.856056580465015, 24.3616510365109, 76.45857338588472, 50.957398607485366, 18.532158050721616, 55.24023118547707, 62.505033001630984, 38.28866248746313, 7.176864916881131, 102.66231565530614, 243.8407088652253]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8407228768655437, "mean_inference_ms": 2.6203527004658476, "mean_action_processing_ms": 0.3639351212363263, "mean_env_wait_ms": 0.2949620717705289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0053092241287231445, "StateBufferConnector_ms": 0.005571126937866211, "ViewRequirementAgentConnector_ms": 0.1806415319442749}, "num_episodes": 23, "episode_return_max": 375.0576407928446, "episode_return_min": -280.0883818661753, "episode_return_mean": 193.8176238265141, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 283.24778326051296, "num_env_steps_trained_throughput_per_sec": 283.24778326051296, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 13936.765, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13936.693, "sample_time_ms": 1815.266, "learn_time_ms": 12098.602, "learn_throughput": 330.617, "synch_weights_time_ms": 20.301}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 60, "trial_id": "61e09_00000", "date": "2024-08-16_16-21-38", "timestamp": 1723805498, "time_this_iter_s": 14.170464992523193, "time_total_s": 898.5631332397461, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b249b9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 898.5631332397461, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 62.10952380952381, "ram_util_percent": 80.43809523809526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1388311742632475, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 0.00010000000000000003, "total_loss": 2.336364718341323, "policy_loss": -0.008533676412626708, "vf_loss": 2.3427498925930608, "vf_explained_var": 0.10021745792772405, "kl": 0.03819565023862448, "entropy": 0.4478024002026629, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6217139888062047, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 4.8792646459801485, "policy_loss": -0.00482656561890272, "vf_loss": 4.881859007966582, "vf_explained_var": 0.031188958094864296, "kl": 0.007440676003022115, "entropy": 1.2334167681673847, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "env_runners": {"episode_reward_max": 381.14999999999986, "episode_reward_min": -280.0883818661753, "episode_reward_mean": 210.44138843048586, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -700.8671219924454, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 708.5431667966077}, "policy_reward_mean": {"prey_policy": 24.298757473327623, "predator_policy": 80.92193674191535}, "custom_metrics": {}, "hist_stats": {"episode_reward": [172.6984622405214, 133.11000000000035, 338.0460046731068, 171.48000000000002, 275.2201450932447, 287.1166697769214, 217.54000000000002, 3.8399999999999617, 240.22075714128192, 3.889999999999961, 315.8478034801452, 260.5975070975857, 317.57999999999987, 185.61, 292.6999999999996, 264.0399999999999, 304.4599999999999, 182.6081242858104, 97.40000000000018, 239.9599999999999, 335.26, -82.75091348968301, 121.22000000000045, 330.6489254399162, 169.0158125082889, 228.2199999999998, 364.2299999999999, 272.38, 18.367332528718904, 117.06000000000024, -1.9694123908571401, 349.36125255793763, 172.7040734405312, -119.24913118081699, 153.8639048658526, 363.04035143476204, 311.5499999999999, 17.07999999999994, 185.08410104235554, 308.38999999999993, 359.23, -280.0883818661753, 9.470581003300248, 328.41213471224927, -186.8694644426219, -125.14765168137585, 291.60999999999984, 278.88159535369033, 302.6874527058107, 310.5487461998616, 269.90999999999985, 3.8899999999999615, 314.68071088856897, 309.4399999999998, 325.2879726584697, 375.0576407928446, 290.82999999999976, 223.30730657373556, 118.61000000000023, 158.23000000000025, 291.2195968194083, 115.02024303154184, 238.54999999999995, 155.92000000000007, 329.5199999999998, 174.7484592113627, 266.33000000000004, -69.83501864357584, 307.6396766992919, 78.44000000000015, 152.1800000000002, 342.44999999999993, 254.92999999999984, 161.3422098340667, 287.0185056933674, 173.93158057677357, 123.1300000000002, 286.55999999999983, 337.09999999999997, 341.8692058279055, 358.63004290638287, 180.11118191239098, 147.58816165220543, 381.14999999999986, 342.9790391755316, 110.25223942365574, 166.24801051626554, 366.1499999999999, 278.6836961143776, 162.17999999999975, 1.9799999999999962, 306.18999999999994, 304.28, 277.80701060816705, 265.52458824548665, 298.6899999999999, 319.38, 125.52000000000031, 365.01, 342.27], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.13922546901893046, 89.74107454554107, -10.795851930095903, 51.85308803692678, 167.8141477810318, 139.4189870339644, 23.2774987094283, -50.722874104295826, 56.67767308878475, 117.13964595897636, 120.34237049419875, -164.58580619050178, 75.59615671951788, -58.72782193580973, -12.481085441359182, -7.401246751393703, 67.74547305321049, 134.0494441861428, -1.4906896913553072, -14.786647849537534, 104.9657863818939, 99.54359910399171, 95.26710373075042, 58.57748537131885, 83.25916320769394, 191.08999999999992, 34.8066660430803, 59.563126787509376, 161.38999999999987, 29.408997486335167, 100.64185623697358, 123.48952050694427, 108.04980600089377, 135.44397394061022, -16.708519127333673, 65.18805133399644, -44.48860236246969, 33.52362050910174, -5.06532727559599, 96.94190548631303, 176.11428071866544, 112.43680736959206, -293.21665682332986, -700.8671219924454, -71.08981463594257, 35.59794554778783, 157.7104599899863, 143.44540915879008, 127.39762012423826, -0.2608411994716735, 77.67711196872246, 70.5985760520135, 176.4200087380682, 175.95218795390554, 55.436858850276565, 93.51257891887161, -121.49769354498488, -275.16549493680776, -11.60347505105158, -3.1873610716174525, -121.56863573838862, -599.9417284461988, 59.0442224484063, 187.13000000000005, 71.90171264937236, -10.041306633120497, -192.7947498670667, -300.94529944966945, 107.56010689470111, -9.298274215688416, 64.2706709528542, 179.27848865669156, 68.74874375662505, 165.34999999999988, -600.8190294915704, -4.105007130925952, 107.6690592257724, -14.844118192317566, 26.837584307150784, 176.57676384808846, 150.016390883277, 186.38802009625672, -600.1777785354209, -504.2504116073806, -170.79902079755922, -167.538057357008, 110.14082691438689, 161.06026407410553, -418.2843066885483, -265.7285690390382, -256.56481549685486, -331.6469905456619, 63.90464488057701, 106.48197277413811, 104.81077135726632, 77.87387945600335, 96.11528014995393, 119.19661473458777, 130.95876554973006, 130.3849834488075, 54.51194516249462, 170.33700200008627, 2.0000000000000013, -9.24812575361272, 136.27330401945045, 75.64623582177755, 62.18528990683, 169.87670728338853, -34.842702157501385, 158.34040973942336, 178.27595358210905, 166.58447532047308, 142.50800489598555, 101.30083340920525, 104.41536813854461, -141.0758541189339, 106.91395982325147, -13.745994750628162, -5.761334240100802, 135.8568915802618, 190.16578723848863, -12.218107044413742, 1.164607278372252, 8.769476989138667, -48.58906879908679, 66.41867414654757, 114.0831691411706, -37.6128517071171, 135.94278676461784, 154.52755584868015, 8.241495759464199, -68.59410735133012, -2.344643842789104, 120.66816866653892, -456.5882965515474, -240.74061077230243, 102.73720950883187, 86.09082705407658, -14.989965588699786, -18.371652884130807, 2.0000000000000013, 91.98691909425744, 167.19255319528787, 160.33976953467385, 138.13615609179544, 3.844626499416499, 60.19361371770644, -19.595109559948302, 61.18814424071249, 49.88764643650845, -9.118444526901758, -18.318197299139875, 1.2167570422134801, -11.65020220669831, 71.92065787051166, 113.81911770709287, 191.08999999999997, 76.52044334179301, 144.04710053532696, 80.07684110547044, 167.66758314193368, 145.496932360105, -142.47938374287284, -23.912458865267517, -75.55485177321682, -64.09242678956325, 180.80585904177968, 196.02601505683575, 152.56263951537883, 120.32615494992496, -612.7433189423568, -555.0798553155358, -2.23852663082831, 138.61787577125273, 164.7035304570848, 179.3351847035259, 83.05616831659484, 131.34093455952652, 126.61648037893298, -2.6219969066123383, -417.3714892842506, -0.07617431184168295, 58.48095874691953, 94.92808482264509, 117.36826174905426, 89.59374324622779, 124.53123944965506, 17.034115039626514, 75.24588595406854, 32.42569090751074, 51.674322614012674, 171.14788552245003, 194.03776066233618, 49.66885385069311, -17.78351578613723, 85.01120405148016, 200.0, 109.22936288463615, 153.02381849326244, 114.40370192345945], "policy_predator_policy_reward": [8.539236771502528, 74.27892545445891, 69.2874986600916, 22.765265233077493, 3.4146899632165084, 27.39817989489419, 100.72407363157791, 98.20130176328973, 22.44023174296812, 78.96259430251581, 252.54620902692375, 78.8138964463007, 178.99634298321413, 21.67532223307798, 14.411085441359141, 9.311246751393671, 34.99833406009924, 3.427505841829299, 3.4506896913552767, 16.71664784953762, 71.35932710208209, 39.9790908921776, 55.49689966999468, 51.25601832552188, 19.776027750560296, 23.45480904174582, 56.71323382496871, 34.52697334444165, 0.0, 101.90100251366492, 9.848981501967032, 30.059641754115226, 38.09019399910625, 22.876026059389844, 127.065156740058, 7.0634353390893745, 46.31860236246933, 62.04637949089817, 3.8326117884377613, 144.25081000084515, 8.965719281334572, 37.74319263040796, 208.54962319542847, 702.7832421306634, 94.91189634767473, 61.799972740481, 21.815643686052443, 7.677412605087458, 16.533485056860652, 25.345548526662014, 75.80423007283, 4.140081906434016, 8.834837859061158, 3.0229654489650617, 25.505463184789477, 97.92509904606247, 90.79858379360873, 324.23193721690274, 78.81862997032958, 53.032206152339455, 10.997784997122158, 708.5431667966077, 37.580387118891295, 65.60664299064018, 90.8059034239719, 20.037764000307583, 326.6546565931216, 47.83626154279734, 10.067687854270957, 45.534384332568905, 72.66352373523861, 46.827668089977905, 69.7547179058594, 7.696538337515599, 615.9590294915703, 6.045007130925911, 43.038544058896285, 49.220615950004806, 2.3315383640835785, 102.64411348067719, 22.82558902046625, 0.0, 701.6138000519161, 122.7260082247103, 20.47795487112976, 327.3297042867379, 47.00917308561309, 10.201870638143664, 456.6571588462334, 40.48625243873192, 416.5211139040066, 46.5430404571342, 82.29535511942302, 38.92802722586197, 87.45246373933361, 8.74448080108709, 19.656361299835545, 67.71919652143359, 35.50799881458312, 13.696998386741342, 17.273608282328706, 27.787444555090566, 0.0, 11.13812575361268, 74.49256185131294, 28.268609196028194, 42.72648945987291, 34.651513349908534, 68.58345136749267, 133.2068137090551, 18.241609944232483, 11.955601946030129, 26.711995104014484, 20.30916659079478, 143.39542176486938, 116.57237078925546, 9.816040176748517, 15.625994750628122, 7.7113342401007605, 20.423108419738234, 83.52984267165783, 29.742073953675902, 43.159350872011565, 61.92680789201908, 44.23969521049588, 176.48069944204335, 40.07683085882944, 39.37285170711675, 9.5072132353822, 29.542444151319874, 162.08783341210585, 73.0132373911228, 65.13595810896386, 82.87051706728641, 84.77984246577489, 542.7140462144994, 40.55167751284401, 78.25996262353941, 93.76354784134118, 18.03807063148964, 4.612602527207647, 53.58047837853491, 13.888650157214688, 1.0290271128236215, 35.04384390820463, 77.90537350058372, 4.721607867319011, 116.02209780898944, 107.42600116797436, 68.51671384817216, 119.6005621099776, 81.76766029283755, 74.70738858401992, 58.856056580465015, 24.3616510365109, 76.45857338588472, 50.957398607485366, 18.532158050721616, 55.24023118547707, 62.505033001630984, 38.28866248746313, 7.176864916881131, 102.66231565530614, 243.8407088652253, 33.166372606348894, 254.06906760863677, 2.3441409582201738, 1.9739849431642615, 26.1531936069904, 43.937051103237636, 688.2927279965857, 589.7826856849636, 23.830650859575506, 6.038010516265613, 15.376469542915176, 6.734815296474047, 7.846263331741944, 56.44032990651443, 33.593519621067074, 4.591996906612296, 417.3714892842506, 2.0561743118416835, 74.70106172605692, 78.07989470437852, 28.91173825094576, 68.40625675377221, 80.94483414119748, 55.29682197768821, 54.54451571129313, 103.30849567261423, 49.848089402564305, 26.019702460972884, 33.87558291353312, 41.79780257343752, 31.034338580738694, 27.257973153918773, 51.839578731156664, 3.941058384207187, 17.16618150673759, 57.67629807654053]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8419171583912987, "mean_inference_ms": 2.6246123930397993, "mean_action_processing_ms": 0.36398373352086, "mean_env_wait_ms": 0.29531332058775156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005311846733093262, "StateBufferConnector_ms": 0.005605936050415039, "ViewRequirementAgentConnector_ms": 0.18381917476654053}, "num_episodes": 18, "episode_return_max": 381.14999999999986, "episode_return_min": -280.0883818661753, "episode_return_mean": 210.44138843048586, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 271.9123271423144, "num_env_steps_trained_throughput_per_sec": 271.9123271423144, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 14049.175, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14049.102, "sample_time_ms": 1927.92, "learn_time_ms": 12097.576, "learn_throughput": 330.645, "synch_weights_time_ms": 21.191}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "training_iteration": 61, "trial_id": "61e09_00000", "date": "2024-08-16_16-21-53", "timestamp": 1723805513, "time_this_iter_s": 14.802442073822021, "time_total_s": 913.3655753135681, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30001eb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 913.3655753135681, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 62.404999999999994, "ram_util_percent": 80.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3850167110483484, "cur_kl_coeff": 0.084375, "cur_lr": 0.00010000000000000003, "total_loss": 5.310956828808658, "policy_loss": -0.006412295078139299, "vf_loss": 5.316066058981356, "vf_explained_var": 0.1082171202021301, "kl": 0.015443887264991175, "entropy": 0.7154060258436455, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1998224297843914, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 7.355541313766802, "policy_loss": -0.005714662290528101, "vf_loss": 7.359311950017536, "vf_explained_var": -0.1477409418297823, "kl": 0.0064800374306985525, "entropy": 1.2097860733037273, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 384.5982875698452, "episode_reward_min": -349.98441631407417, "episode_reward_mean": 177.46228105984792, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -700.8671219924454, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 844.7501817486889}, "policy_reward_mean": {"prey_policy": -17.892760864603083, "predator_policy": 106.6239013945271}, "custom_metrics": {}, "hist_stats": {"episode_reward": [97.40000000000018, 239.9599999999999, 335.26, -82.75091348968301, 121.22000000000045, 330.6489254399162, 169.0158125082889, 228.2199999999998, 364.2299999999999, 272.38, 18.367332528718904, 117.06000000000024, -1.9694123908571401, 349.36125255793763, 172.7040734405312, -119.24913118081699, 153.8639048658526, 363.04035143476204, 311.5499999999999, 17.07999999999994, 185.08410104235554, 308.38999999999993, 359.23, -280.0883818661753, 9.470581003300248, 328.41213471224927, -186.8694644426219, -125.14765168137585, 291.60999999999984, 278.88159535369033, 302.6874527058107, 310.5487461998616, 269.90999999999985, 3.8899999999999615, 314.68071088856897, 309.4399999999998, 325.2879726584697, 375.0576407928446, 290.82999999999976, 223.30730657373556, 118.61000000000023, 158.23000000000025, 291.2195968194083, 115.02024303154184, 238.54999999999995, 155.92000000000007, 329.5199999999998, 174.7484592113627, 266.33000000000004, -69.83501864357584, 307.6396766992919, 78.44000000000015, 152.1800000000002, 342.44999999999993, 254.92999999999984, 161.3422098340667, 287.0185056933674, 173.93158057677357, 123.1300000000002, 286.55999999999983, 337.09999999999997, 341.8692058279055, 358.63004290638287, 180.11118191239098, 147.58816165220543, 381.14999999999986, 342.9790391755316, 110.25223942365574, 166.24801051626554, 366.1499999999999, 278.6836961143776, 162.17999999999975, 1.9799999999999962, 306.18999999999994, 304.28, 277.80701060816705, 265.52458824548665, 298.6899999999999, 319.38, 125.52000000000031, 365.01, 342.27, 332.2660314063502, -173.09183275766463, -269.6612077253085, -70.02402154947508, 384.5982875698452, 3.8899999999999606, -106.32140241110139, -172.307081290231, 185.06999999999965, -79.97674450198681, 317.37090504236863, 147.97581015922572, 131.85135433833875, 128.0400000000005, 220.6431467086926, 228.2660071623758, -349.98441631407417, -189.91009911253062], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-44.48860236246969, 33.52362050910174, -5.06532727559599, 96.94190548631303, 176.11428071866544, 112.43680736959206, -293.21665682332986, -700.8671219924454, -71.08981463594257, 35.59794554778783, 157.7104599899863, 143.44540915879008, 127.39762012423826, -0.2608411994716735, 77.67711196872246, 70.5985760520135, 176.4200087380682, 175.95218795390554, 55.436858850276565, 93.51257891887161, -121.49769354498488, -275.16549493680776, -11.60347505105158, -3.1873610716174525, -121.56863573838862, -599.9417284461988, 59.0442224484063, 187.13000000000005, 71.90171264937236, -10.041306633120497, -192.7947498670667, -300.94529944966945, 107.56010689470111, -9.298274215688416, 64.2706709528542, 179.27848865669156, 68.74874375662505, 165.34999999999988, -600.8190294915704, -4.105007130925952, 107.6690592257724, -14.844118192317566, 26.837584307150784, 176.57676384808846, 150.016390883277, 186.38802009625672, -600.1777785354209, -504.2504116073806, -170.79902079755922, -167.538057357008, 110.14082691438689, 161.06026407410553, -418.2843066885483, -265.7285690390382, -256.56481549685486, -331.6469905456619, 63.90464488057701, 106.48197277413811, 104.81077135726632, 77.87387945600335, 96.11528014995393, 119.19661473458777, 130.95876554973006, 130.3849834488075, 54.51194516249462, 170.33700200008627, 2.0000000000000013, -9.24812575361272, 136.27330401945045, 75.64623582177755, 62.18528990683, 169.87670728338853, -34.842702157501385, 158.34040973942336, 178.27595358210905, 166.58447532047308, 142.50800489598555, 101.30083340920525, 104.41536813854461, -141.0758541189339, 106.91395982325147, -13.745994750628162, -5.761334240100802, 135.8568915802618, 190.16578723848863, -12.218107044413742, 1.164607278372252, 8.769476989138667, -48.58906879908679, 66.41867414654757, 114.0831691411706, -37.6128517071171, 135.94278676461784, 154.52755584868015, 8.241495759464199, -68.59410735133012, -2.344643842789104, 120.66816866653892, -456.5882965515474, -240.74061077230243, 102.73720950883187, 86.09082705407658, -14.989965588699786, -18.371652884130807, 2.0000000000000013, 91.98691909425744, 167.19255319528787, 160.33976953467385, 138.13615609179544, 3.844626499416499, 60.19361371770644, -19.595109559948302, 61.18814424071249, 49.88764643650845, -9.118444526901758, -18.318197299139875, 1.2167570422134801, -11.65020220669831, 71.92065787051166, 113.81911770709287, 191.08999999999997, 76.52044334179301, 144.04710053532696, 80.07684110547044, 167.66758314193368, 145.496932360105, -142.47938374287284, -23.912458865267517, -75.55485177321682, -64.09242678956325, 180.80585904177968, 196.02601505683575, 152.56263951537883, 120.32615494992496, -612.7433189423568, -555.0798553155358, -2.23852663082831, 138.61787577125273, 164.7035304570848, 179.3351847035259, 83.05616831659484, 131.34093455952652, 126.61648037893298, -2.6219969066123383, -417.3714892842506, -0.07617431184168295, 58.48095874691953, 94.92808482264509, 117.36826174905426, 89.59374324622779, 124.53123944965506, 17.034115039626514, 75.24588595406854, 32.42569090751074, 51.674322614012674, 171.14788552245003, 194.03776066233618, 49.66885385069311, -17.78351578613723, 85.01120405148016, 200.0, 109.22936288463615, 153.02381849326244, 114.40370192345945, 115.8904742843403, 143.90424535851506, -360.9581870975366, -343.4648243948764, -513.1175696393715, -561.2545418743877, -257.2833433848295, -288.129326157243, 125.93500142280007, 180.42491254135865, -24.950366912207805, -4.048766489110939, -238.05788424695106, -530.9634054519764, -425.04171332355315, -301.70095094140873, 174.13951269287764, 0.8489942242218437, -303.0679371285265, -337.06106785483513, 136.11299707093562, 119.17148663612892, -152.3441286963401, 26.527736435754104, -70.5703977498584, -191.34160606373257, -6.2565066835059735, 9.857225333849888, 60.441583694797174, -34.559992423624784, 26.157640730654165, -5.049804698396066, -520.3358097473323, -644.6381595267882, -691.5498681738401, -595.189941165091], "policy_predator_policy_reward": [46.31860236246933, 62.04637949089817, 3.8326117884377613, 144.25081000084515, 8.965719281334572, 37.74319263040796, 208.54962319542847, 702.7832421306634, 94.91189634767473, 61.799972740481, 21.815643686052443, 7.677412605087458, 16.533485056860652, 25.345548526662014, 75.80423007283, 4.140081906434016, 8.834837859061158, 3.0229654489650617, 25.505463184789477, 97.92509904606247, 90.79858379360873, 324.23193721690274, 78.81862997032958, 53.032206152339455, 10.997784997122158, 708.5431667966077, 37.580387118891295, 65.60664299064018, 90.8059034239719, 20.037764000307583, 326.6546565931216, 47.83626154279734, 10.067687854270957, 45.534384332568905, 72.66352373523861, 46.827668089977905, 69.7547179058594, 7.696538337515599, 615.9590294915703, 6.045007130925911, 43.038544058896285, 49.220615950004806, 2.3315383640835785, 102.64411348067719, 22.82558902046625, 0.0, 701.6138000519161, 122.7260082247103, 20.47795487112976, 327.3297042867379, 47.00917308561309, 10.201870638143664, 456.6571588462334, 40.48625243873192, 416.5211139040066, 46.5430404571342, 82.29535511942302, 38.92802722586197, 87.45246373933361, 8.74448080108709, 19.656361299835545, 67.71919652143359, 35.50799881458312, 13.696998386741342, 17.273608282328706, 27.787444555090566, 0.0, 11.13812575361268, 74.49256185131294, 28.268609196028194, 42.72648945987291, 34.651513349908534, 68.58345136749267, 133.2068137090551, 18.241609944232483, 11.955601946030129, 26.711995104014484, 20.30916659079478, 143.39542176486938, 116.57237078925546, 9.816040176748517, 15.625994750628122, 7.7113342401007605, 20.423108419738234, 83.52984267165783, 29.742073953675902, 43.159350872011565, 61.92680789201908, 44.23969521049588, 176.48069944204335, 40.07683085882944, 39.37285170711675, 9.5072132353822, 29.542444151319874, 162.08783341210585, 73.0132373911228, 65.13595810896386, 82.87051706728641, 84.77984246577489, 542.7140462144994, 40.55167751284401, 78.25996262353941, 93.76354784134118, 18.03807063148964, 4.612602527207647, 53.58047837853491, 13.888650157214688, 1.0290271128236215, 35.04384390820463, 77.90537350058372, 4.721607867319011, 116.02209780898944, 107.42600116797436, 68.51671384817216, 119.6005621099776, 81.76766029283755, 74.70738858401992, 58.856056580465015, 24.3616510365109, 76.45857338588472, 50.957398607485366, 18.532158050721616, 55.24023118547707, 62.505033001630984, 38.28866248746313, 7.176864916881131, 102.66231565530614, 243.8407088652253, 33.166372606348894, 254.06906760863677, 2.3441409582201738, 1.9739849431642615, 26.1531936069904, 43.937051103237636, 688.2927279965857, 589.7826856849636, 23.830650859575506, 6.038010516265613, 15.376469542915176, 6.734815296474047, 7.846263331741944, 56.44032990651443, 33.593519621067074, 4.591996906612296, 417.3714892842506, 2.0561743118416835, 74.70106172605692, 78.07989470437852, 28.91173825094576, 68.40625675377221, 80.94483414119748, 55.29682197768821, 54.54451571129313, 103.30849567261423, 49.848089402564305, 26.019702460972884, 33.87558291353312, 41.79780257343752, 31.034338580738694, 27.257973153918773, 51.839578731156664, 3.941058384207187, 17.16618150673759, 57.67629807654053, 0.0, 72.47131176349501, 0.0, 531.3311787347485, 799.2724230914808, 5.438480696970528, 1.2943863408118907, 474.09426165178576, 32.599466521863484, 45.63890708382299, 26.880366912208107, 6.008766489110897, 601.6559941232667, 61.04389316455955, 512.9724797297141, 41.463103245016946, 0.0, 10.081493082900485, 120.82891933208668, 439.3233411492879, 22.990342054708538, 39.096079280595745, 272.89479252445824, 0.8974098953532517, 92.45244513050744, 301.31091302142204, 111.59331935165933, 12.845961997996708, 8.755325856802132, 186.00622958071796, 107.00242949006395, 100.1557416400537, 810.106280378488, 4.883272581559367, 252.0795284777117, 844.7501817486889]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8432903646531001, "mean_inference_ms": 2.6302611453427813, "mean_action_processing_ms": 0.36452092261811603, "mean_env_wait_ms": 0.29605899869345537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005124330520629883, "StateBufferConnector_ms": 0.0055315494537353516, "ViewRequirementAgentConnector_ms": 0.18801963329315186}, "num_episodes": 18, "episode_return_max": 384.5982875698452, "episode_return_min": -349.98441631407417, "episode_return_mean": 177.46228105984792, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 291.49993856288296, "num_env_steps_trained_throughput_per_sec": 291.49993856288296, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 14013.083, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14013.009, "sample_time_ms": 1968.082, "learn_time_ms": 12021.054, "learn_throughput": 332.75, "synch_weights_time_ms": 21.767}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 62, "trial_id": "61e09_00000", "date": "2024-08-16_16-22-06", "timestamp": 1723805526, "time_this_iter_s": 13.76203727722168, "time_total_s": 927.1276125907898, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30001e430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 927.1276125907898, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 66.195, "ram_util_percent": 80.285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5843856410374717, "cur_kl_coeff": 0.084375, "cur_lr": 0.00010000000000000003, "total_loss": 7.468589624021419, "policy_loss": -0.00998876654375443, "vf_loss": 7.477299041848965, "vf_explained_var": 0.10847081087884448, "kl": 0.015162800747242026, "entropy": 0.6194958699601038, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1083858108709728, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 7.825323310226359, "policy_loss": -0.005631347211501585, "vf_loss": 7.828741936708885, "vf_explained_var": -0.23845330136162893, "kl": 0.0073757563818073425, "entropy": 1.1855617585005584, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 384.5982875698452, "episode_reward_min": -427.89005377148635, "episode_reward_mean": 163.47732299601228, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -836.5392572545938, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1029.8942846859104}, "policy_reward_mean": {"prey_policy": -45.721896862534614, "predator_policy": 127.46055836054079}, "custom_metrics": {}, "hist_stats": {"episode_reward": [359.23, -280.0883818661753, 9.470581003300248, 328.41213471224927, -186.8694644426219, -125.14765168137585, 291.60999999999984, 278.88159535369033, 302.6874527058107, 310.5487461998616, 269.90999999999985, 3.8899999999999615, 314.68071088856897, 309.4399999999998, 325.2879726584697, 375.0576407928446, 290.82999999999976, 223.30730657373556, 118.61000000000023, 158.23000000000025, 291.2195968194083, 115.02024303154184, 238.54999999999995, 155.92000000000007, 329.5199999999998, 174.7484592113627, 266.33000000000004, -69.83501864357584, 307.6396766992919, 78.44000000000015, 152.1800000000002, 342.44999999999993, 254.92999999999984, 161.3422098340667, 287.0185056933674, 173.93158057677357, 123.1300000000002, 286.55999999999983, 337.09999999999997, 341.8692058279055, 358.63004290638287, 180.11118191239098, 147.58816165220543, 381.14999999999986, 342.9790391755316, 110.25223942365574, 166.24801051626554, 366.1499999999999, 278.6836961143776, 162.17999999999975, 1.9799999999999962, 306.18999999999994, 304.28, 277.80701060816705, 265.52458824548665, 298.6899999999999, 319.38, 125.52000000000031, 365.01, 342.27, 332.2660314063502, -173.09183275766463, -269.6612077253085, -70.02402154947508, 384.5982875698452, 3.8899999999999606, -106.32140241110139, -172.307081290231, 185.06999999999965, -79.97674450198681, 317.37090504236863, 147.97581015922572, 131.85135433833875, 128.0400000000005, 220.6431467086926, 228.2660071623758, -349.98441631407417, -189.91009911253062, 179.96999999999974, 292.10999999999996, 156.22427523878687, 266.719385125735, 236.31427609729326, 78.5644645147307, 153.14999999999992, 14.149999999999961, 39.62689928034103, 62.088247307326256, 293.59255528881636, 254.16115479148084, -427.89005377148635, 22.13309260511526, 194.03447689881506, 3.0604912927574635, -97.71841568990236, 272.9703258513373, -1.330870422995241, 111.35000000000028, 293.4899999999999, 155.6001859652879], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [150.016390883277, 186.38802009625672, -600.1777785354209, -504.2504116073806, -170.79902079755922, -167.538057357008, 110.14082691438689, 161.06026407410553, -418.2843066885483, -265.7285690390382, -256.56481549685486, -331.6469905456619, 63.90464488057701, 106.48197277413811, 104.81077135726632, 77.87387945600335, 96.11528014995393, 119.19661473458777, 130.95876554973006, 130.3849834488075, 54.51194516249462, 170.33700200008627, 2.0000000000000013, -9.24812575361272, 136.27330401945045, 75.64623582177755, 62.18528990683, 169.87670728338853, -34.842702157501385, 158.34040973942336, 178.27595358210905, 166.58447532047308, 142.50800489598555, 101.30083340920525, 104.41536813854461, -141.0758541189339, 106.91395982325147, -13.745994750628162, -5.761334240100802, 135.8568915802618, 190.16578723848863, -12.218107044413742, 1.164607278372252, 8.769476989138667, -48.58906879908679, 66.41867414654757, 114.0831691411706, -37.6128517071171, 135.94278676461784, 154.52755584868015, 8.241495759464199, -68.59410735133012, -2.344643842789104, 120.66816866653892, -456.5882965515474, -240.74061077230243, 102.73720950883187, 86.09082705407658, -14.989965588699786, -18.371652884130807, 2.0000000000000013, 91.98691909425744, 167.19255319528787, 160.33976953467385, 138.13615609179544, 3.844626499416499, 60.19361371770644, -19.595109559948302, 61.18814424071249, 49.88764643650845, -9.118444526901758, -18.318197299139875, 1.2167570422134801, -11.65020220669831, 71.92065787051166, 113.81911770709287, 191.08999999999997, 76.52044334179301, 144.04710053532696, 80.07684110547044, 167.66758314193368, 145.496932360105, -142.47938374287284, -23.912458865267517, -75.55485177321682, -64.09242678956325, 180.80585904177968, 196.02601505683575, 152.56263951537883, 120.32615494992496, -612.7433189423568, -555.0798553155358, -2.23852663082831, 138.61787577125273, 164.7035304570848, 179.3351847035259, 83.05616831659484, 131.34093455952652, 126.61648037893298, -2.6219969066123383, -417.3714892842506, -0.07617431184168295, 58.48095874691953, 94.92808482264509, 117.36826174905426, 89.59374324622779, 124.53123944965506, 17.034115039626514, 75.24588595406854, 32.42569090751074, 51.674322614012674, 171.14788552245003, 194.03776066233618, 49.66885385069311, -17.78351578613723, 85.01120405148016, 200.0, 109.22936288463615, 153.02381849326244, 114.40370192345945, 115.8904742843403, 143.90424535851506, -360.9581870975366, -343.4648243948764, -513.1175696393715, -561.2545418743877, -257.2833433848295, -288.129326157243, 125.93500142280007, 180.42491254135865, -24.950366912207805, -4.048766489110939, -238.05788424695106, -530.9634054519764, -425.04171332355315, -301.70095094140873, 174.13951269287764, 0.8489942242218437, -303.0679371285265, -337.06106785483513, 136.11299707093562, 119.17148663612892, -152.3441286963401, 26.527736435754104, -70.5703977498584, -191.34160606373257, -6.2565066835059735, 9.857225333849888, 60.441583694797174, -34.559992423624784, 26.157640730654165, -5.049804698396066, -520.3358097473323, -644.6381595267882, -691.5498681738401, -595.189941165091, 157.73829939677853, -1.946566050357331, 172.63136617919028, -60.209100116823365, -68.2244902333013, -116.52082947146386, 54.041545739407226, 54.057474191710654, -88.33268332389959, 117.09023428800491, -150.37954185130562, -198.005696830429, 88.01649249668012, -19.303355864881528, 0.19607690687928886, -396.1302006106763, -16.2433995045927, -352.14058852923733, -325.7039212937881, -237.44660837848343, 9.794299206055152, 11.2584147974029, 84.81364681393603, 3.635062039062582, -836.5392572545938, -681.6708756340674, -390.1539556683526, -415.06453671912925, -171.1065212809782, 120.53985770611084, -455.960256995081, -226.45549420262677, -489.9426775512382, -410.90217420514375, -421.41959593036273, 1.109088849126351, -478.1253866378706, -220.10895464513297, 52.82028599204167, 2.0000000000000013, 60.71715148079791, 132.70100170489064, -83.15263214921846, -11.4660103740125], "policy_predator_policy_reward": [22.82558902046625, 0.0, 701.6138000519161, 122.7260082247103, 20.47795487112976, 327.3297042867379, 47.00917308561309, 10.201870638143664, 456.6571588462334, 40.48625243873192, 416.5211139040066, 46.5430404571342, 82.29535511942302, 38.92802722586197, 87.45246373933361, 8.74448080108709, 19.656361299835545, 67.71919652143359, 35.50799881458312, 13.696998386741342, 17.273608282328706, 27.787444555090566, 0.0, 11.13812575361268, 74.49256185131294, 28.268609196028194, 42.72648945987291, 34.651513349908534, 68.58345136749267, 133.2068137090551, 18.241609944232483, 11.955601946030129, 26.711995104014484, 20.30916659079478, 143.39542176486938, 116.57237078925546, 9.816040176748517, 15.625994750628122, 7.7113342401007605, 20.423108419738234, 83.52984267165783, 29.742073953675902, 43.159350872011565, 61.92680789201908, 44.23969521049588, 176.48069944204335, 40.07683085882944, 39.37285170711675, 9.5072132353822, 29.542444151319874, 162.08783341210585, 73.0132373911228, 65.13595810896386, 82.87051706728641, 84.77984246577489, 542.7140462144994, 40.55167751284401, 78.25996262353941, 93.76354784134118, 18.03807063148964, 4.612602527207647, 53.58047837853491, 13.888650157214688, 1.0290271128236215, 35.04384390820463, 77.90537350058372, 4.721607867319011, 116.02209780898944, 107.42600116797436, 68.51671384817216, 119.6005621099776, 81.76766029283755, 74.70738858401992, 58.856056580465015, 24.3616510365109, 76.45857338588472, 50.957398607485366, 18.532158050721616, 55.24023118547707, 62.505033001630984, 38.28866248746313, 7.176864916881131, 102.66231565530614, 243.8407088652253, 33.166372606348894, 254.06906760863677, 2.3441409582201738, 1.9739849431642615, 26.1531936069904, 43.937051103237636, 688.2927279965857, 589.7826856849636, 23.830650859575506, 6.038010516265613, 15.376469542915176, 6.734815296474047, 7.846263331741944, 56.44032990651443, 33.593519621067074, 4.591996906612296, 417.3714892842506, 2.0561743118416835, 74.70106172605692, 78.07989470437852, 28.91173825094576, 68.40625675377221, 80.94483414119748, 55.29682197768821, 54.54451571129313, 103.30849567261423, 49.848089402564305, 26.019702460972884, 33.87558291353312, 41.79780257343752, 31.034338580738694, 27.257973153918773, 51.839578731156664, 3.941058384207187, 17.16618150673759, 57.67629807654053, 0.0, 72.47131176349501, 0.0, 531.3311787347485, 799.2724230914808, 5.438480696970528, 1.2943863408118907, 474.09426165178576, 32.599466521863484, 45.63890708382299, 26.880366912208107, 6.008766489110897, 601.6559941232667, 61.04389316455955, 512.9724797297141, 41.463103245016946, 0.0, 10.081493082900485, 120.82891933208668, 439.3233411492879, 22.990342054708538, 39.096079280595745, 272.89479252445824, 0.8974098953532517, 92.45244513050744, 301.31091302142204, 111.59331935165933, 12.845961997996708, 8.755325856802132, 186.00622958071796, 107.00242949006395, 100.1557416400537, 810.106280378488, 4.883272581559367, 252.0795284777117, 844.7501817486889, 19.467553234875787, 4.710713418703036, 175.0447239966235, 4.643009941009508, 64.63271998774292, 276.33687495580915, 118.55463036662506, 40.06573482799202, 101.47495698808187, 106.08176814510594, 95.35774858345698, 331.5919546130083, 5.3569868874317415, 79.07987648077004, 399.88714898087477, 10.196974722922254, 280.45543712339713, 127.55545019077425, 464.99362415802, 160.24515282157716, 73.81553132373523, 198.72430996162316, 114.21885941255378, 51.493586525928784, 60.42579443126396, 1029.8942846859104, 227.3436371698544, 600.0079478227416, 28.001849858999407, 216.5992906146832, 373.41680506120235, 312.05943742926246, 296.34265495667034, 506.78378110980935, 241.35485968173984, 451.92597325083455, 538.0260575814668, 158.87741327854127, 9.406355020757326, 47.123358987201016, 58.14620336079003, 41.92564345352146, 145.9164523456161, 104.30237614290276]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8452532467029628, "mean_inference_ms": 2.637543331541454, "mean_action_processing_ms": 0.36511043911584506, "mean_env_wait_ms": 0.2970375185327818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005226731300354004, "StateBufferConnector_ms": 0.005546212196350098, "ViewRequirementAgentConnector_ms": 0.17455554008483887}, "num_episodes": 22, "episode_return_max": 384.5982875698452, "episode_return_min": -427.89005377148635, "episode_return_mean": 163.47732299601228, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 289.9733695287524, "num_env_steps_trained_throughput_per_sec": 289.9733695287524, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 13997.69, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13997.615, "sample_time_ms": 1972.38, "learn_time_ms": 12001.541, "learn_throughput": 333.291, "synch_weights_time_ms": 21.51}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 63, "trial_id": "61e09_00000", "date": "2024-08-16_16-22-20", "timestamp": 1723805540, "time_this_iter_s": 13.803452968597412, "time_total_s": 940.9310655593872, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x300237f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 940.9310655593872, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 60.265, "ram_util_percent": 80.31}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7524735106362237, "cur_kl_coeff": 0.084375, "cur_lr": 0.00010000000000000003, "total_loss": 7.159286223265229, "policy_loss": -0.01275535429157711, "vf_loss": 7.170175167618606, "vf_explained_var": 0.08160081105257468, "kl": 0.02212040585644903, "entropy": 0.6238758957732922, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5480272440367906, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 8.506986898089211, "policy_loss": -0.003831242886741483, "vf_loss": 8.50842047368408, "vf_explained_var": -0.06320545395846089, "kl": 0.00799228104257347, "entropy": 1.2190259485017685, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 384.5982875698452, "episode_reward_min": -427.89005377148635, "episode_reward_mean": 142.8611284741931, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -836.5392572545938, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1029.8942846859104}, "policy_reward_mean": {"prey_policy": -90.51190610168052, "predator_policy": 161.9424703387771}, "custom_metrics": {}, "hist_stats": {"episode_reward": [155.92000000000007, 329.5199999999998, 174.7484592113627, 266.33000000000004, -69.83501864357584, 307.6396766992919, 78.44000000000015, 152.1800000000002, 342.44999999999993, 254.92999999999984, 161.3422098340667, 287.0185056933674, 173.93158057677357, 123.1300000000002, 286.55999999999983, 337.09999999999997, 341.8692058279055, 358.63004290638287, 180.11118191239098, 147.58816165220543, 381.14999999999986, 342.9790391755316, 110.25223942365574, 166.24801051626554, 366.1499999999999, 278.6836961143776, 162.17999999999975, 1.9799999999999962, 306.18999999999994, 304.28, 277.80701060816705, 265.52458824548665, 298.6899999999999, 319.38, 125.52000000000031, 365.01, 342.27, 332.2660314063502, -173.09183275766463, -269.6612077253085, -70.02402154947508, 384.5982875698452, 3.8899999999999606, -106.32140241110139, -172.307081290231, 185.06999999999965, -79.97674450198681, 317.37090504236863, 147.97581015922572, 131.85135433833875, 128.0400000000005, 220.6431467086926, 228.2660071623758, -349.98441631407417, -189.91009911253062, 179.96999999999974, 292.10999999999996, 156.22427523878687, 266.719385125735, 236.31427609729326, 78.5644645147307, 153.14999999999992, 14.149999999999961, 39.62689928034103, 62.088247307326256, 293.59255528881636, 254.16115479148084, -427.89005377148635, 22.13309260511526, 194.03447689881506, 3.0604912927574635, -97.71841568990236, 272.9703258513373, -1.330870422995241, 111.35000000000028, 293.4899999999999, 155.6001859652879, 188.11024053669183, 305.65999999999997, -54.886728490658136, 31.172639533946136, 283.1417995043802, 189.89869461620174, -25.945047010195005, 163.52862226067768, -63.21087617343336, 267.50810138873044, 77.66100794916612, 239.88987616331255, -186.82323151964914, 98.74189128924412, 159.90133327963628, 51.10757478576041, -11.811927180506702, 51.72085092336422, 338.7757984772948, -71.59117480580765, 0.8067106851278067, 256.8308614454885, -29.037987091382835], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [114.0831691411706, -37.6128517071171, 135.94278676461784, 154.52755584868015, 8.241495759464199, -68.59410735133012, -2.344643842789104, 120.66816866653892, -456.5882965515474, -240.74061077230243, 102.73720950883187, 86.09082705407658, -14.989965588699786, -18.371652884130807, 2.0000000000000013, 91.98691909425744, 167.19255319528787, 160.33976953467385, 138.13615609179544, 3.844626499416499, 60.19361371770644, -19.595109559948302, 61.18814424071249, 49.88764643650845, -9.118444526901758, -18.318197299139875, 1.2167570422134801, -11.65020220669831, 71.92065787051166, 113.81911770709287, 191.08999999999997, 76.52044334179301, 144.04710053532696, 80.07684110547044, 167.66758314193368, 145.496932360105, -142.47938374287284, -23.912458865267517, -75.55485177321682, -64.09242678956325, 180.80585904177968, 196.02601505683575, 152.56263951537883, 120.32615494992496, -612.7433189423568, -555.0798553155358, -2.23852663082831, 138.61787577125273, 164.7035304570848, 179.3351847035259, 83.05616831659484, 131.34093455952652, 126.61648037893298, -2.6219969066123383, -417.3714892842506, -0.07617431184168295, 58.48095874691953, 94.92808482264509, 117.36826174905426, 89.59374324622779, 124.53123944965506, 17.034115039626514, 75.24588595406854, 32.42569090751074, 51.674322614012674, 171.14788552245003, 194.03776066233618, 49.66885385069311, -17.78351578613723, 85.01120405148016, 200.0, 109.22936288463615, 153.02381849326244, 114.40370192345945, 115.8904742843403, 143.90424535851506, -360.9581870975366, -343.4648243948764, -513.1175696393715, -561.2545418743877, -257.2833433848295, -288.129326157243, 125.93500142280007, 180.42491254135865, -24.950366912207805, -4.048766489110939, -238.05788424695106, -530.9634054519764, -425.04171332355315, -301.70095094140873, 174.13951269287764, 0.8489942242218437, -303.0679371285265, -337.06106785483513, 136.11299707093562, 119.17148663612892, -152.3441286963401, 26.527736435754104, -70.5703977498584, -191.34160606373257, -6.2565066835059735, 9.857225333849888, 60.441583694797174, -34.559992423624784, 26.157640730654165, -5.049804698396066, -520.3358097473323, -644.6381595267882, -691.5498681738401, -595.189941165091, 157.73829939677853, -1.946566050357331, 172.63136617919028, -60.209100116823365, -68.2244902333013, -116.52082947146386, 54.041545739407226, 54.057474191710654, -88.33268332389959, 117.09023428800491, -150.37954185130562, -198.005696830429, 88.01649249668012, -19.303355864881528, 0.19607690687928886, -396.1302006106763, -16.2433995045927, -352.14058852923733, -325.7039212937881, -237.44660837848343, 9.794299206055152, 11.2584147974029, 84.81364681393603, 3.635062039062582, -836.5392572545938, -681.6708756340674, -390.1539556683526, -415.06453671912925, -171.1065212809782, 120.53985770611084, -455.960256995081, -226.45549420262677, -489.9426775512382, -410.90217420514375, -421.41959593036273, 1.109088849126351, -478.1253866378706, -220.10895464513297, 52.82028599204167, 2.0000000000000013, 60.71715148079791, 132.70100170489064, -83.15263214921846, -11.4660103740125, -27.29787501042419, -59.67450733569982, 116.20394479074152, 140.66614864380736, -598.2870868868498, -440.2601209548726, -158.8184597620038, -152.5225901397267, 151.4608056002278, 126.74688312295946, -181.11964241557425, -130.44039718945916, -282.43792739241076, -453.57341174504575, -59.35941009093645, -2.3389486279944096, -424.70099346603513, -339.51720103454136, -159.3130005437831, -122.61977492892028, -286.04645800081596, -424.92317886374343, -167.33389809899361, -295.54458929771306, -629.3881547202641, -505.33406352149393, -104.57284256599829, -281.7134010577995, 81.92847764204525, -0.3148770415653639, -128.51814123174864, -127.48621538241387, -356.3542136741665, -287.7476001975554, -106.97666902973016, -149.66641211420034, 96.72031335080223, 175.05108269053613, -233.1890370607051, -224.68706891218048, -358.9589975731176, -212.96767039588917, 42.20035644501689, 35.4514022198824, -615.1664891038563, -346.8537332438057], "policy_predator_policy_reward": [40.07683085882944, 39.37285170711675, 9.5072132353822, 29.542444151319874, 162.08783341210585, 73.0132373911228, 65.13595810896386, 82.87051706728641, 84.77984246577489, 542.7140462144994, 40.55167751284401, 78.25996262353941, 93.76354784134118, 18.03807063148964, 4.612602527207647, 53.58047837853491, 13.888650157214688, 1.0290271128236215, 35.04384390820463, 77.90537350058372, 4.721607867319011, 116.02209780898944, 107.42600116797436, 68.51671384817216, 119.6005621099776, 81.76766029283755, 74.70738858401992, 58.856056580465015, 24.3616510365109, 76.45857338588472, 50.957398607485366, 18.532158050721616, 55.24023118547707, 62.505033001630984, 38.28866248746313, 7.176864916881131, 102.66231565530614, 243.8407088652253, 33.166372606348894, 254.06906760863677, 2.3441409582201738, 1.9739849431642615, 26.1531936069904, 43.937051103237636, 688.2927279965857, 589.7826856849636, 23.830650859575506, 6.038010516265613, 15.376469542915176, 6.734815296474047, 7.846263331741944, 56.44032990651443, 33.593519621067074, 4.591996906612296, 417.3714892842506, 2.0561743118416835, 74.70106172605692, 78.07989470437852, 28.91173825094576, 68.40625675377221, 80.94483414119748, 55.29682197768821, 54.54451571129313, 103.30849567261423, 49.848089402564305, 26.019702460972884, 33.87558291353312, 41.79780257343752, 31.034338580738694, 27.257973153918773, 51.839578731156664, 3.941058384207187, 17.16618150673759, 57.67629807654053, 0.0, 72.47131176349501, 0.0, 531.3311787347485, 799.2724230914808, 5.438480696970528, 1.2943863408118907, 474.09426165178576, 32.599466521863484, 45.63890708382299, 26.880366912208107, 6.008766489110897, 601.6559941232667, 61.04389316455955, 512.9724797297141, 41.463103245016946, 0.0, 10.081493082900485, 120.82891933208668, 439.3233411492879, 22.990342054708538, 39.096079280595745, 272.89479252445824, 0.8974098953532517, 92.45244513050744, 301.31091302142204, 111.59331935165933, 12.845961997996708, 8.755325856802132, 186.00622958071796, 107.00242949006395, 100.1557416400537, 810.106280378488, 4.883272581559367, 252.0795284777117, 844.7501817486889, 19.467553234875787, 4.710713418703036, 175.0447239966235, 4.643009941009508, 64.63271998774292, 276.33687495580915, 118.55463036662506, 40.06573482799202, 101.47495698808187, 106.08176814510594, 95.35774858345698, 331.5919546130083, 5.3569868874317415, 79.07987648077004, 399.88714898087477, 10.196974722922254, 280.45543712339713, 127.55545019077425, 464.99362415802, 160.24515282157716, 73.81553132373523, 198.72430996162316, 114.21885941255378, 51.493586525928784, 60.42579443126396, 1029.8942846859104, 227.3436371698544, 600.0079478227416, 28.001849858999407, 216.5992906146832, 373.41680506120235, 312.05943742926246, 296.34265495667034, 506.78378110980935, 241.35485968173984, 451.92597325083455, 538.0260575814668, 158.87741327854127, 9.406355020757326, 47.123358987201016, 58.14620336079003, 41.92564345352146, 145.9164523456161, 104.30237614290276, 160.48011796885388, 114.60250491396198, 18.606249560401142, 30.18365700504998, 272.7074767362193, 710.9530026148448, 335.4194489005209, 7.0942405351558655, 3.9231168770406075, 1.010993904152629, 227.28757002832813, 274.17116419290716, 22.23710735159306, 687.8291847756682, 100.98451965873544, 124.24246132087289, 187.96856965743117, 513.0387486697122, 355.4588775656417, 193.98199929579238, 464.6098954162789, 324.02074939744654, 325.7809829812514, 376.9873805787672, 859.6679895970217, 88.2309971250868, 161.1852835813058, 323.8428513317358, 35.00632400828925, 43.28140867086719, 303.95546336349935, 3.1564680364234308, 365.33109437991277, 266.95879231130243, 198.6183616672034, 109.745570400091, 23.262899349072605, 43.74150308688383, 381.76993446218705, 4.5149967048910495, 89.14396859099651, 483.5894100631379, 117.28311757056548, 61.89598521002385, 374.42543233424766, 558.5568029220316]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8466894208080384, "mean_inference_ms": 2.647073373566314, "mean_action_processing_ms": 0.36610911547413116, "mean_env_wait_ms": 0.29769779985532746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005957841873168945, "StateBufferConnector_ms": 0.005448341369628906, "ViewRequirementAgentConnector_ms": 0.17580032348632812}, "num_episodes": 23, "episode_return_max": 384.5982875698452, "episode_return_min": -427.89005377148635, "episode_return_mean": 142.8611284741931, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.6862266661353, "num_env_steps_trained_throughput_per_sec": 288.6862266661353, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 13973.608, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13973.532, "sample_time_ms": 1977.934, "learn_time_ms": 11971.323, "learn_throughput": 334.132, "synch_weights_time_ms": 21.983}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 64, "trial_id": "61e09_00000", "date": "2024-08-16_16-22-34", "timestamp": 1723805554, "time_this_iter_s": 13.949270009994507, "time_total_s": 954.8803355693817, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30001eca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 954.8803355693817, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 63.26315789473684, "ram_util_percent": 80.82105263157895}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.601846909144568, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 0.00010000000000000003, "total_loss": 6.619031325345317, "policy_loss": -0.010801510568387886, "vf_loss": 6.627936777740559, "vf_explained_var": 0.11933629361409989, "kl": 0.014981239301668543, "entropy": 0.6826242513284482, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5305188057914614, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 7.3704683916909355, "policy_loss": -0.006552714547856893, "vf_loss": 7.374265566578618, "vf_explained_var": -0.22517964865164783, "kl": 0.009185117151232432, "entropy": 1.1582649556417315, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 384.5982875698452, "episode_reward_min": -427.89005377148635, "episode_reward_mean": 126.02193540530249, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -836.5392572545938, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1029.8942846859104}, "policy_reward_mean": {"prey_policy": -129.48623729063664, "predator_policy": 192.49720499328794}, "custom_metrics": {}, "hist_stats": {"episode_reward": [180.11118191239098, 147.58816165220543, 381.14999999999986, 342.9790391755316, 110.25223942365574, 166.24801051626554, 366.1499999999999, 278.6836961143776, 162.17999999999975, 1.9799999999999962, 306.18999999999994, 304.28, 277.80701060816705, 265.52458824548665, 298.6899999999999, 319.38, 125.52000000000031, 365.01, 342.27, 332.2660314063502, -173.09183275766463, -269.6612077253085, -70.02402154947508, 384.5982875698452, 3.8899999999999606, -106.32140241110139, -172.307081290231, 185.06999999999965, -79.97674450198681, 317.37090504236863, 147.97581015922572, 131.85135433833875, 128.0400000000005, 220.6431467086926, 228.2660071623758, -349.98441631407417, -189.91009911253062, 179.96999999999974, 292.10999999999996, 156.22427523878687, 266.719385125735, 236.31427609729326, 78.5644645147307, 153.14999999999992, 14.149999999999961, 39.62689928034103, 62.088247307326256, 293.59255528881636, 254.16115479148084, -427.89005377148635, 22.13309260511526, 194.03447689881506, 3.0604912927574635, -97.71841568990236, 272.9703258513373, -1.330870422995241, 111.35000000000028, 293.4899999999999, 155.6001859652879, 188.11024053669183, 305.65999999999997, -54.886728490658136, 31.172639533946136, 283.1417995043802, 189.89869461620174, -25.945047010195005, 163.52862226067768, -63.21087617343336, 267.50810138873044, 77.66100794916612, 239.88987616331255, -186.82323151964914, 98.74189128924412, 159.90133327963628, 51.10757478576041, -11.811927180506702, 51.72085092336422, 338.7757984772948, -71.59117480580765, 0.8067106851278067, 256.8308614454885, -29.037987091382835, -19.54931830892922, -52.0474811289274, 307.62652223710086, 244.77878593300076, 267.74848551026287, 354.36, -65.44981465842496, 192.78514587133432, 291.74999999999983, -114.53677189684039, 254.52605086026102, 222.42951420732246, -94.06847561013004, 105.74375177161333, -5.076092728643913, 287.02604239398363, -45.87930985367578, 245.81832061720957], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-142.47938374287284, -23.912458865267517, -75.55485177321682, -64.09242678956325, 180.80585904177968, 196.02601505683575, 152.56263951537883, 120.32615494992496, -612.7433189423568, -555.0798553155358, -2.23852663082831, 138.61787577125273, 164.7035304570848, 179.3351847035259, 83.05616831659484, 131.34093455952652, 126.61648037893298, -2.6219969066123383, -417.3714892842506, -0.07617431184168295, 58.48095874691953, 94.92808482264509, 117.36826174905426, 89.59374324622779, 124.53123944965506, 17.034115039626514, 75.24588595406854, 32.42569090751074, 51.674322614012674, 171.14788552245003, 194.03776066233618, 49.66885385069311, -17.78351578613723, 85.01120405148016, 200.0, 109.22936288463615, 153.02381849326244, 114.40370192345945, 115.8904742843403, 143.90424535851506, -360.9581870975366, -343.4648243948764, -513.1175696393715, -561.2545418743877, -257.2833433848295, -288.129326157243, 125.93500142280007, 180.42491254135865, -24.950366912207805, -4.048766489110939, -238.05788424695106, -530.9634054519764, -425.04171332355315, -301.70095094140873, 174.13951269287764, 0.8489942242218437, -303.0679371285265, -337.06106785483513, 136.11299707093562, 119.17148663612892, -152.3441286963401, 26.527736435754104, -70.5703977498584, -191.34160606373257, -6.2565066835059735, 9.857225333849888, 60.441583694797174, -34.559992423624784, 26.157640730654165, -5.049804698396066, -520.3358097473323, -644.6381595267882, -691.5498681738401, -595.189941165091, 157.73829939677853, -1.946566050357331, 172.63136617919028, -60.209100116823365, -68.2244902333013, -116.52082947146386, 54.041545739407226, 54.057474191710654, -88.33268332389959, 117.09023428800491, -150.37954185130562, -198.005696830429, 88.01649249668012, -19.303355864881528, 0.19607690687928886, -396.1302006106763, -16.2433995045927, -352.14058852923733, -325.7039212937881, -237.44660837848343, 9.794299206055152, 11.2584147974029, 84.81364681393603, 3.635062039062582, -836.5392572545938, -681.6708756340674, -390.1539556683526, -415.06453671912925, -171.1065212809782, 120.53985770611084, -455.960256995081, -226.45549420262677, -489.9426775512382, -410.90217420514375, -421.41959593036273, 1.109088849126351, -478.1253866378706, -220.10895464513297, 52.82028599204167, 2.0000000000000013, 60.71715148079791, 132.70100170489064, -83.15263214921846, -11.4660103740125, -27.29787501042419, -59.67450733569982, 116.20394479074152, 140.66614864380736, -598.2870868868498, -440.2601209548726, -158.8184597620038, -152.5225901397267, 151.4608056002278, 126.74688312295946, -181.11964241557425, -130.44039718945916, -282.43792739241076, -453.57341174504575, -59.35941009093645, -2.3389486279944096, -424.70099346603513, -339.51720103454136, -159.3130005437831, -122.61977492892028, -286.04645800081596, -424.92317886374343, -167.33389809899361, -295.54458929771306, -629.3881547202641, -505.33406352149393, -104.57284256599829, -281.7134010577995, 81.92847764204525, -0.3148770415653639, -128.51814123174864, -127.48621538241387, -356.3542136741665, -287.7476001975554, -106.97666902973016, -149.66641211420034, 96.72031335080223, 175.05108269053613, -233.1890370607051, -224.68706891218048, -358.9589975731176, -212.96767039588917, 42.20035644501689, 35.4514022198824, -615.1664891038563, -346.8537332438057, -260.86585891296005, -309.11556717988003, -287.5082356817126, -194.11068866222593, -451.35137238785944, -3.555677049583032, -4.780332302663918, -215.6135667718419, 82.2935698071245, 116.67439417093964, 180.21524014192494, 153.7039292302149, -173.61782787505805, -453.632035976257, -221.01410771685724, -181.91538398281511, 154.47577630354843, 76.51264877432479, -288.63100526809524, -305.584153267347, -382.31281734035144, -13.710828594777261, -356.8401722210437, -4.272375189088275, -465.683920640378, -471.73841023572606, -101.51574720748324, -75.29273094642107, -418.0948350146015, -450.21496957261553, 120.54208361279376, 94.99088428679943, -230.33217612930085, -388.53185630617656, 2.0000000000000013, -515.4461193181943], "policy_predator_policy_reward": [102.66231565530614, 243.8407088652253, 33.166372606348894, 254.06906760863677, 2.3441409582201738, 1.9739849431642615, 26.1531936069904, 43.937051103237636, 688.2927279965857, 589.7826856849636, 23.830650859575506, 6.038010516265613, 15.376469542915176, 6.734815296474047, 7.846263331741944, 56.44032990651443, 33.593519621067074, 4.591996906612296, 417.3714892842506, 2.0561743118416835, 74.70106172605692, 78.07989470437852, 28.91173825094576, 68.40625675377221, 80.94483414119748, 55.29682197768821, 54.54451571129313, 103.30849567261423, 49.848089402564305, 26.019702460972884, 33.87558291353312, 41.79780257343752, 31.034338580738694, 27.257973153918773, 51.839578731156664, 3.941058384207187, 17.16618150673759, 57.67629807654053, 0.0, 72.47131176349501, 0.0, 531.3311787347485, 799.2724230914808, 5.438480696970528, 1.2943863408118907, 474.09426165178576, 32.599466521863484, 45.63890708382299, 26.880366912208107, 6.008766489110897, 601.6559941232667, 61.04389316455955, 512.9724797297141, 41.463103245016946, 0.0, 10.081493082900485, 120.82891933208668, 439.3233411492879, 22.990342054708538, 39.096079280595745, 272.89479252445824, 0.8974098953532517, 92.45244513050744, 301.31091302142204, 111.59331935165933, 12.845961997996708, 8.755325856802132, 186.00622958071796, 107.00242949006395, 100.1557416400537, 810.106280378488, 4.883272581559367, 252.0795284777117, 844.7501817486889, 19.467553234875787, 4.710713418703036, 175.0447239966235, 4.643009941009508, 64.63271998774292, 276.33687495580915, 118.55463036662506, 40.06573482799202, 101.47495698808187, 106.08176814510594, 95.35774858345698, 331.5919546130083, 5.3569868874317415, 79.07987648077004, 399.88714898087477, 10.196974722922254, 280.45543712339713, 127.55545019077425, 464.99362415802, 160.24515282157716, 73.81553132373523, 198.72430996162316, 114.21885941255378, 51.493586525928784, 60.42579443126396, 1029.8942846859104, 227.3436371698544, 600.0079478227416, 28.001849858999407, 216.5992906146832, 373.41680506120235, 312.05943742926246, 296.34265495667034, 506.78378110980935, 241.35485968173984, 451.92597325083455, 538.0260575814668, 158.87741327854127, 9.406355020757326, 47.123358987201016, 58.14620336079003, 41.92564345352146, 145.9164523456161, 104.30237614290276, 160.48011796885388, 114.60250491396198, 18.606249560401142, 30.18365700504998, 272.7074767362193, 710.9530026148448, 335.4194489005209, 7.0942405351558655, 3.9231168770406075, 1.010993904152629, 227.28757002832813, 274.17116419290716, 22.23710735159306, 687.8291847756682, 100.98451965873544, 124.24246132087289, 187.96856965743117, 513.0387486697122, 355.4588775656417, 193.98199929579238, 464.6098954162789, 324.02074939744654, 325.7809829812514, 376.9873805787672, 859.6679895970217, 88.2309971250868, 161.1852835813058, 323.8428513317358, 35.00632400828925, 43.28140867086719, 303.95546336349935, 3.1564680364234308, 365.33109437991277, 266.95879231130243, 198.6183616672034, 109.745570400091, 23.262899349072605, 43.74150308688383, 381.76993446218705, 4.5149967048910495, 89.14396859099651, 483.5894100631379, 117.28311757056548, 61.89598521002385, 374.42543233424766, 558.5568029220316, 427.29339036456577, 123.13871741934528, 15.785886555038168, 413.78555665997345, 369.766499915189, 392.7670717593543, 269.0724251681924, 196.1002598393143, 10.744480537087707, 58.03604099511122, 6.87475985807509, 13.5660707697851, 12.666647725541347, 549.1334014673486, 305.9521106196007, 289.7625269514064, 46.448642456031955, 14.312932466094841, 0.8691607684400732, 478.8092258701617, 266.64161364371444, 383.9080831516756, 375.8701722210437, 207.67188939641113, 604.2832077382822, 239.0706475276919, 277.1312772093583, 5.420952716159075, 484.6673916041258, 378.56632025444753, 37.87951652091937, 33.61355797347107, 79.04164777656777, 493.9430748052336, 409.8303746468416, 349.4340652885626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8476718417105644, "mean_inference_ms": 2.64798145334369, "mean_action_processing_ms": 0.3662759969403627, "mean_env_wait_ms": 0.29863269738712434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005651116371154785, "StateBufferConnector_ms": 0.0032765865325927734, "ViewRequirementAgentConnector_ms": 0.14871788024902344}, "num_episodes": 18, "episode_return_max": 384.5982875698452, "episode_return_min": -427.89005377148635, "episode_return_mean": 126.02193540530249, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 285.51807069395636, "num_env_steps_trained_throughput_per_sec": 285.51807069395636, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 13988.416, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13988.338, "sample_time_ms": 2028.897, "learn_time_ms": 11933.654, "learn_throughput": 335.187, "synch_weights_time_ms": 23.429}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 65, "trial_id": "61e09_00000", "date": "2024-08-16_16-22-48", "timestamp": 1723805568, "time_this_iter_s": 14.122005939483643, "time_total_s": 969.0023415088654, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30001e310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 969.0023415088654, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 62.725, "ram_util_percent": 82.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.110190783827393, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 0.00010000000000000003, "total_loss": 7.558158141847641, "policy_loss": -0.0074723786001818044, "vf_loss": 7.564014846811849, "vf_explained_var": 0.11521731315466462, "kl": 0.012765884918187012, "entropy": 0.48362077234914064, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8586585302201528, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 8.138963105186583, "policy_loss": -0.006540887036838781, "vf_loss": 8.142986551415984, "vf_explained_var": -0.410752831186567, "kl": 0.008391422407791697, "entropy": 1.1082769285434138, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 384.5982875698452, "episode_reward_min": -427.89005377148635, "episode_reward_mean": 92.70741746762354, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -836.5392572545938, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 180.42491254135865, "predator_policy": 1029.8942846859104}, "policy_reward_mean": {"prey_policy": -173.02777331043436, "predator_policy": 219.38148204424616}, "custom_metrics": {}, "hist_stats": {"episode_reward": [342.27, 332.2660314063502, -173.09183275766463, -269.6612077253085, -70.02402154947508, 384.5982875698452, 3.8899999999999606, -106.32140241110139, -172.307081290231, 185.06999999999965, -79.97674450198681, 317.37090504236863, 147.97581015922572, 131.85135433833875, 128.0400000000005, 220.6431467086926, 228.2660071623758, -349.98441631407417, -189.91009911253062, 179.96999999999974, 292.10999999999996, 156.22427523878687, 266.719385125735, 236.31427609729326, 78.5644645147307, 153.14999999999992, 14.149999999999961, 39.62689928034103, 62.088247307326256, 293.59255528881636, 254.16115479148084, -427.89005377148635, 22.13309260511526, 194.03447689881506, 3.0604912927574635, -97.71841568990236, 272.9703258513373, -1.330870422995241, 111.35000000000028, 293.4899999999999, 155.6001859652879, 188.11024053669183, 305.65999999999997, -54.886728490658136, 31.172639533946136, 283.1417995043802, 189.89869461620174, -25.945047010195005, 163.52862226067768, -63.21087617343336, 267.50810138873044, 77.66100794916612, 239.88987616331255, -186.82323151964914, 98.74189128924412, 159.90133327963628, 51.10757478576041, -11.811927180506702, 51.72085092336422, 338.7757984772948, -71.59117480580765, 0.8067106851278067, 256.8308614454885, -29.037987091382835, -19.54931830892922, -52.0474811289274, 307.62652223710086, 244.77878593300076, 267.74848551026287, 354.36, -65.44981465842496, 192.78514587133432, 291.74999999999983, -114.53677189684039, 254.52605086026102, 222.42951420732246, -94.06847561013004, 105.74375177161333, -5.076092728643913, 287.02604239398363, -45.87930985367578, 245.81832061720957, -8.102125791139741, 7.456274427007411, 101.53686104454471, -58.37154669747507, 234.36353086247857, -84.13250056068846, -128.8019857701177, 7.468523736261141, -56.9509325470587, 159.057557668095, 25.26138974679493, 85.92407506938143, -11.074743677348422, 56.09263372267887, 295.19970163292174, 87.18551374534402, 91.96388062305282, 264.1960266454499], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [153.02381849326244, 114.40370192345945, 115.8904742843403, 143.90424535851506, -360.9581870975366, -343.4648243948764, -513.1175696393715, -561.2545418743877, -257.2833433848295, -288.129326157243, 125.93500142280007, 180.42491254135865, -24.950366912207805, -4.048766489110939, -238.05788424695106, -530.9634054519764, -425.04171332355315, -301.70095094140873, 174.13951269287764, 0.8489942242218437, -303.0679371285265, -337.06106785483513, 136.11299707093562, 119.17148663612892, -152.3441286963401, 26.527736435754104, -70.5703977498584, -191.34160606373257, -6.2565066835059735, 9.857225333849888, 60.441583694797174, -34.559992423624784, 26.157640730654165, -5.049804698396066, -520.3358097473323, -644.6381595267882, -691.5498681738401, -595.189941165091, 157.73829939677853, -1.946566050357331, 172.63136617919028, -60.209100116823365, -68.2244902333013, -116.52082947146386, 54.041545739407226, 54.057474191710654, -88.33268332389959, 117.09023428800491, -150.37954185130562, -198.005696830429, 88.01649249668012, -19.303355864881528, 0.19607690687928886, -396.1302006106763, -16.2433995045927, -352.14058852923733, -325.7039212937881, -237.44660837848343, 9.794299206055152, 11.2584147974029, 84.81364681393603, 3.635062039062582, -836.5392572545938, -681.6708756340674, -390.1539556683526, -415.06453671912925, -171.1065212809782, 120.53985770611084, -455.960256995081, -226.45549420262677, -489.9426775512382, -410.90217420514375, -421.41959593036273, 1.109088849126351, -478.1253866378706, -220.10895464513297, 52.82028599204167, 2.0000000000000013, 60.71715148079791, 132.70100170489064, -83.15263214921846, -11.4660103740125, -27.29787501042419, -59.67450733569982, 116.20394479074152, 140.66614864380736, -598.2870868868498, -440.2601209548726, -158.8184597620038, -152.5225901397267, 151.4608056002278, 126.74688312295946, -181.11964241557425, -130.44039718945916, -282.43792739241076, -453.57341174504575, -59.35941009093645, -2.3389486279944096, -424.70099346603513, -339.51720103454136, -159.3130005437831, -122.61977492892028, -286.04645800081596, -424.92317886374343, -167.33389809899361, -295.54458929771306, -629.3881547202641, -505.33406352149393, -104.57284256599829, -281.7134010577995, 81.92847764204525, -0.3148770415653639, -128.51814123174864, -127.48621538241387, -356.3542136741665, -287.7476001975554, -106.97666902973016, -149.66641211420034, 96.72031335080223, 175.05108269053613, -233.1890370607051, -224.68706891218048, -358.9589975731176, -212.96767039588917, 42.20035644501689, 35.4514022198824, -615.1664891038563, -346.8537332438057, -260.86585891296005, -309.11556717988003, -287.5082356817126, -194.11068866222593, -451.35137238785944, -3.555677049583032, -4.780332302663918, -215.6135667718419, 82.2935698071245, 116.67439417093964, 180.21524014192494, 153.7039292302149, -173.61782787505805, -453.632035976257, -221.01410771685724, -181.91538398281511, 154.47577630354843, 76.51264877432479, -288.63100526809524, -305.584153267347, -382.31281734035144, -13.710828594777261, -356.8401722210437, -4.272375189088275, -465.683920640378, -471.73841023572606, -101.51574720748324, -75.29273094642107, -418.0948350146015, -450.21496957261553, 120.54208361279376, 94.99088428679943, -230.33217612930085, -388.53185630617656, 2.0000000000000013, -515.4461193181943, -269.5718227481601, -216.367172936336, -393.76487821420386, -403.15851824400175, -296.35723711219134, -6.080801966996276, -325.1599453808371, -187.12753253819076, -10.231062667003155, -358.1987916323518, -310.17851389772653, -256.7484843959367, -375.7445933619733, -240.2033964205194, 0.9988529982622347, -8.628280797050575, -261.55127357635064, -145.15075801065234, -0.5907326199224514, -341.72770780729866, -293.02448140010375, -462.6868367237528, -9.038722328355707, -4.2370064074175104, -163.38916940027002, -393.5737152942323, -298.49794010527, -16.224961677842945, -62.923186970891706, -81.59990503091845, -265.0963127423454, -123.23092435505161, -527.6170537027488, -284.59311735469424, -217.06364956548566, -70.1533556670524], "policy_predator_policy_reward": [17.16618150673759, 57.67629807654053, 0.0, 72.47131176349501, 0.0, 531.3311787347485, 799.2724230914808, 5.438480696970528, 1.2943863408118907, 474.09426165178576, 32.599466521863484, 45.63890708382299, 26.880366912208107, 6.008766489110897, 601.6559941232667, 61.04389316455955, 512.9724797297141, 41.463103245016946, 0.0, 10.081493082900485, 120.82891933208668, 439.3233411492879, 22.990342054708538, 39.096079280595745, 272.89479252445824, 0.8974098953532517, 92.45244513050744, 301.31091302142204, 111.59331935165933, 12.845961997996708, 8.755325856802132, 186.00622958071796, 107.00242949006395, 100.1557416400537, 810.106280378488, 4.883272581559367, 252.0795284777117, 844.7501817486889, 19.467553234875787, 4.710713418703036, 175.0447239966235, 4.643009941009508, 64.63271998774292, 276.33687495580915, 118.55463036662506, 40.06573482799202, 101.47495698808187, 106.08176814510594, 95.35774858345698, 331.5919546130083, 5.3569868874317415, 79.07987648077004, 399.88714898087477, 10.196974722922254, 280.45543712339713, 127.55545019077425, 464.99362415802, 160.24515282157716, 73.81553132373523, 198.72430996162316, 114.21885941255378, 51.493586525928784, 60.42579443126396, 1029.8942846859104, 227.3436371698544, 600.0079478227416, 28.001849858999407, 216.5992906146832, 373.41680506120235, 312.05943742926246, 296.34265495667034, 506.78378110980935, 241.35485968173984, 451.92597325083455, 538.0260575814668, 158.87741327854127, 9.406355020757326, 47.123358987201016, 58.14620336079003, 41.92564345352146, 145.9164523456161, 104.30237614290276, 160.48011796885388, 114.60250491396198, 18.606249560401142, 30.18365700504998, 272.7074767362193, 710.9530026148448, 335.4194489005209, 7.0942405351558655, 3.9231168770406075, 1.010993904152629, 227.28757002832813, 274.17116419290716, 22.23710735159306, 687.8291847756682, 100.98451965873544, 124.24246132087289, 187.96856965743117, 513.0387486697122, 355.4588775656417, 193.98199929579238, 464.6098954162789, 324.02074939744654, 325.7809829812514, 376.9873805787672, 859.6679895970217, 88.2309971250868, 161.1852835813058, 323.8428513317358, 35.00632400828925, 43.28140867086719, 303.95546336349935, 3.1564680364234308, 365.33109437991277, 266.95879231130243, 198.6183616672034, 109.745570400091, 23.262899349072605, 43.74150308688383, 381.76993446218705, 4.5149967048910495, 89.14396859099651, 483.5894100631379, 117.28311757056548, 61.89598521002385, 374.42543233424766, 558.5568029220316, 427.29339036456577, 123.13871741934528, 15.785886555038168, 413.78555665997345, 369.766499915189, 392.7670717593543, 269.0724251681924, 196.1002598393143, 10.744480537087707, 58.03604099511122, 6.87475985807509, 13.5660707697851, 12.666647725541347, 549.1334014673486, 305.9521106196007, 289.7625269514064, 46.448642456031955, 14.312932466094841, 0.8691607684400732, 478.8092258701617, 266.64161364371444, 383.9080831516756, 375.8701722210437, 207.67188939641113, 604.2832077382822, 239.0706475276919, 277.1312772093583, 5.420952716159075, 484.6673916041258, 378.56632025444753, 37.87951652091937, 33.61355797347107, 79.04164777656777, 493.9430748052336, 409.8303746468416, 349.4340652885626, 466.94118292713375, 10.895686966223074, 417.8937304206756, 386.48594046453775, 228.17725784692058, 175.79764227681198, 447.56224355781626, 6.353687663736207, 254.32151213249927, 348.4718730293342, 37.18290676058752, 445.6115909723869, 461.16640727141004, 25.97959674096562, 10.568280797050534, 4.529670737998991, 7.009679871063476, 342.7414191688808, 190.84405388743568, 310.5319442078803, 473.1634023120615, 307.8093055585896, 82.37088322807575, 16.828920577078684, 497.90368202995944, 47.98445898719416, 251.226016132364, 119.58951937342844, 235.48993153130417, 204.2328621034279, 345.38196019710625, 130.13079064563462, 611.0011828762745, 293.17286880422097, 315.8032473866869, 235.60978449130113]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8478224625043707, "mean_inference_ms": 2.6503711964547527, "mean_action_processing_ms": 0.3664581953503092, "mean_env_wait_ms": 0.2989002732104402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005658984184265137, "StateBufferConnector_ms": 0.003262758255004883, "ViewRequirementAgentConnector_ms": 0.1739668846130371}, "num_episodes": 18, "episode_return_max": 384.5982875698452, "episode_return_min": -427.89005377148635, "episode_return_mean": 92.70741746762354, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 278.60014900440797, "num_env_steps_trained_throughput_per_sec": 278.60014900440797, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 13976.829, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13976.758, "sample_time_ms": 2116.081, "learn_time_ms": 11835.465, "learn_throughput": 337.967, "synch_weights_time_ms": 22.987}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 66, "trial_id": "61e09_00000", "date": "2024-08-16_16-23-03", "timestamp": 1723805583, "time_this_iter_s": 14.479403018951416, "time_total_s": 983.4817445278168, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24990d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 983.4817445278168, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 61.900000000000006, "ram_util_percent": 81.55238095238096}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.798780056723842, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 0.00010000000000000003, "total_loss": 7.298630379873609, "policy_loss": -0.00901519994198458, "vf_loss": 7.306500128085021, "vf_explained_var": 0.11853030002306378, "kl": 0.00905052405955843, "entropy": 0.4850018174559982, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1843233896941734, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 7.044687015291244, "policy_loss": -0.005854487172254021, "vf_loss": 7.048624089659837, "vf_explained_var": -0.6006300896563858, "kl": 0.00639137861221721, "entropy": 1.0375771611771256, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "env_runners": {"episode_reward_max": 354.36, "episode_reward_min": -427.89005377148635, "episode_reward_mean": 84.0288681372063, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -836.5392572545938, "predator_policy": 0.782898321879674}, "policy_reward_max": {"prey_policy": 180.21524014192494, "predator_policy": 1029.8942846859104}, "policy_reward_mean": {"prey_policy": -194.75233599586355, "predator_policy": 236.7667700644667}, "custom_metrics": {}, "hist_stats": {"episode_reward": [266.719385125735, 236.31427609729326, 78.5644645147307, 153.14999999999992, 14.149999999999961, 39.62689928034103, 62.088247307326256, 293.59255528881636, 254.16115479148084, -427.89005377148635, 22.13309260511526, 194.03447689881506, 3.0604912927574635, -97.71841568990236, 272.9703258513373, -1.330870422995241, 111.35000000000028, 293.4899999999999, 155.6001859652879, 188.11024053669183, 305.65999999999997, -54.886728490658136, 31.172639533946136, 283.1417995043802, 189.89869461620174, -25.945047010195005, 163.52862226067768, -63.21087617343336, 267.50810138873044, 77.66100794916612, 239.88987616331255, -186.82323151964914, 98.74189128924412, 159.90133327963628, 51.10757478576041, -11.811927180506702, 51.72085092336422, 338.7757984772948, -71.59117480580765, 0.8067106851278067, 256.8308614454885, -29.037987091382835, -19.54931830892922, -52.0474811289274, 307.62652223710086, 244.77878593300076, 267.74848551026287, 354.36, -65.44981465842496, 192.78514587133432, 291.74999999999983, -114.53677189684039, 254.52605086026102, 222.42951420732246, -94.06847561013004, 105.74375177161333, -5.076092728643913, 287.02604239398363, -45.87930985367578, 245.81832061720957, -8.102125791139741, 7.456274427007411, 101.53686104454471, -58.37154669747507, 234.36353086247857, -84.13250056068846, -128.8019857701177, 7.468523736261141, -56.9509325470587, 159.057557668095, 25.26138974679493, 85.92407506938143, -11.074743677348422, 56.09263372267887, 295.19970163292174, 87.18551374534402, 91.96388062305282, 264.1960266454499, 174.98455021724027, -94.48132535139, 245.97355703005314, -76.54866417023634, 136.00471421411402, -98.25215567324047, -73.05833327701781, -43.40157553008394, 24.751205188699988, -206.82355110272118, 79.70755212086819, 84.57555890224126, -14.250121723585725, 3.91999999999996, 130.76554103361252, 35.21690878654734, -77.10914511959092, 259.4257680992012, 141.26275201838013, 171.6869919952417, -68.25614873644533, 35.31999999999994], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [54.041545739407226, 54.057474191710654, -88.33268332389959, 117.09023428800491, -150.37954185130562, -198.005696830429, 88.01649249668012, -19.303355864881528, 0.19607690687928886, -396.1302006106763, -16.2433995045927, -352.14058852923733, -325.7039212937881, -237.44660837848343, 9.794299206055152, 11.2584147974029, 84.81364681393603, 3.635062039062582, -836.5392572545938, -681.6708756340674, -390.1539556683526, -415.06453671912925, -171.1065212809782, 120.53985770611084, -455.960256995081, -226.45549420262677, -489.9426775512382, -410.90217420514375, -421.41959593036273, 1.109088849126351, -478.1253866378706, -220.10895464513297, 52.82028599204167, 2.0000000000000013, 60.71715148079791, 132.70100170489064, -83.15263214921846, -11.4660103740125, -27.29787501042419, -59.67450733569982, 116.20394479074152, 140.66614864380736, -598.2870868868498, -440.2601209548726, -158.8184597620038, -152.5225901397267, 151.4608056002278, 126.74688312295946, -181.11964241557425, -130.44039718945916, -282.43792739241076, -453.57341174504575, -59.35941009093645, -2.3389486279944096, -424.70099346603513, -339.51720103454136, -159.3130005437831, -122.61977492892028, -286.04645800081596, -424.92317886374343, -167.33389809899361, -295.54458929771306, -629.3881547202641, -505.33406352149393, -104.57284256599829, -281.7134010577995, 81.92847764204525, -0.3148770415653639, -128.51814123174864, -127.48621538241387, -356.3542136741665, -287.7476001975554, -106.97666902973016, -149.66641211420034, 96.72031335080223, 175.05108269053613, -233.1890370607051, -224.68706891218048, -358.9589975731176, -212.96767039588917, 42.20035644501689, 35.4514022198824, -615.1664891038563, -346.8537332438057, -260.86585891296005, -309.11556717988003, -287.5082356817126, -194.11068866222593, -451.35137238785944, -3.555677049583032, -4.780332302663918, -215.6135667718419, 82.2935698071245, 116.67439417093964, 180.21524014192494, 153.7039292302149, -173.61782787505805, -453.632035976257, -221.01410771685724, -181.91538398281511, 154.47577630354843, 76.51264877432479, -288.63100526809524, -305.584153267347, -382.31281734035144, -13.710828594777261, -356.8401722210437, -4.272375189088275, -465.683920640378, -471.73841023572606, -101.51574720748324, -75.29273094642107, -418.0948350146015, -450.21496957261553, 120.54208361279376, 94.99088428679943, -230.33217612930085, -388.53185630617656, 2.0000000000000013, -515.4461193181943, -269.5718227481601, -216.367172936336, -393.76487821420386, -403.15851824400175, -296.35723711219134, -6.080801966996276, -325.1599453808371, -187.12753253819076, -10.231062667003155, -358.1987916323518, -310.17851389772653, -256.7484843959367, -375.7445933619733, -240.2033964205194, 0.9988529982622347, -8.628280797050575, -261.55127357635064, -145.15075801065234, -0.5907326199224514, -341.72770780729866, -293.02448140010375, -462.6868367237528, -9.038722328355707, -4.2370064074175104, -163.38916940027002, -393.5737152942323, -298.49794010527, -16.224961677842945, -62.923186970891706, -81.59990503091845, -265.0963127423454, -123.23092435505161, -527.6170537027488, -284.59311735469424, -217.06364956548566, -70.1533556670524, -340.89587186152767, -3.5760374714546668, -345.7065911220836, -250.33858245967875, -138.79057859846304, 176.29741063972367, -224.60666680306852, -345.93853556763634, -336.5137901223031, -1.103791114417867, -455.0958353086633, -423.8342553168505, -193.52471795287556, -328.0723019667439, -291.12516580522765, -288.7165383210541, -305.31660196562325, -198.39679036207025, -532.240302355273, -273.93535225622486, -306.34293190430213, -466.9491358873102, -320.1438543381618, -423.09372068807073, -132.93079404486443, -258.5384593133535, 1.1278472786302731, -10.893523200857826, 51.03316865364205, -114.09047986758512, -14.84017198108409, -274.33812310924105, -425.5840359030785, -376.1705535249781, -7.048445115594726, -307.29000256894693, -146.59354943346648, -310.6843884215172, -336.4199862155866, -237.78976679455056, -252.6300745257879, -306.76118264279864, -195.5910432663119, -1.54652345748621], "policy_predator_policy_reward": [118.55463036662506, 40.06573482799202, 101.47495698808187, 106.08176814510594, 95.35774858345698, 331.5919546130083, 5.3569868874317415, 79.07987648077004, 399.88714898087477, 10.196974722922254, 280.45543712339713, 127.55545019077425, 464.99362415802, 160.24515282157716, 73.81553132373523, 198.72430996162316, 114.21885941255378, 51.493586525928784, 60.42579443126396, 1029.8942846859104, 227.3436371698544, 600.0079478227416, 28.001849858999407, 216.5992906146832, 373.41680506120235, 312.05943742926246, 296.34265495667034, 506.78378110980935, 241.35485968173984, 451.92597325083455, 538.0260575814668, 158.87741327854127, 9.406355020757326, 47.123358987201016, 58.14620336079003, 41.92564345352146, 145.9164523456161, 104.30237614290276, 160.48011796885388, 114.60250491396198, 18.606249560401142, 30.18365700504998, 272.7074767362193, 710.9530026148448, 335.4194489005209, 7.0942405351558655, 3.9231168770406075, 1.010993904152629, 227.28757002832813, 274.17116419290716, 22.23710735159306, 687.8291847756682, 100.98451965873544, 124.24246132087289, 187.96856965743117, 513.0387486697122, 355.4588775656417, 193.98199929579238, 464.6098954162789, 324.02074939744654, 325.7809829812514, 376.9873805787672, 859.6679895970217, 88.2309971250868, 161.1852835813058, 323.8428513317358, 35.00632400828925, 43.28140867086719, 303.95546336349935, 3.1564680364234308, 365.33109437991277, 266.95879231130243, 198.6183616672034, 109.745570400091, 23.262899349072605, 43.74150308688383, 381.76993446218705, 4.5149967048910495, 89.14396859099651, 483.5894100631379, 117.28311757056548, 61.89598521002385, 374.42543233424766, 558.5568029220316, 427.29339036456577, 123.13871741934528, 15.785886555038168, 413.78555665997345, 369.766499915189, 392.7670717593543, 269.0724251681924, 196.1002598393143, 10.744480537087707, 58.03604099511122, 6.87475985807509, 13.5660707697851, 12.666647725541347, 549.1334014673486, 305.9521106196007, 289.7625269514064, 46.448642456031955, 14.312932466094841, 0.8691607684400732, 478.8092258701617, 266.64161364371444, 383.9080831516756, 375.8701722210437, 207.67188939641113, 604.2832077382822, 239.0706475276919, 277.1312772093583, 5.420952716159075, 484.6673916041258, 378.56632025444753, 37.87951652091937, 33.61355797347107, 79.04164777656777, 493.9430748052336, 409.8303746468416, 349.4340652885626, 466.94118292713375, 10.895686966223074, 417.8937304206756, 386.48594046453775, 228.17725784692058, 175.79764227681198, 447.56224355781626, 6.353687663736207, 254.32151213249927, 348.4718730293342, 37.18290676058752, 445.6115909723869, 461.16640727141004, 25.97959674096562, 10.568280797050534, 4.529670737998991, 7.009679871063476, 342.7414191688808, 190.84405388743568, 310.5319442078803, 473.1634023120615, 307.8093055585896, 82.37088322807575, 16.828920577078684, 497.90368202995944, 47.98445898719416, 251.226016132364, 119.58951937342844, 235.48993153130417, 204.2328621034279, 345.38196019710625, 130.13079064563462, 611.0011828762745, 293.17286880422097, 315.8032473866869, 235.60978449130113, 341.14587186152744, 178.3105876886955, 490.43446129637704, 11.129386933994232, 102.67593146014951, 105.79079352864258, 181.87308257197165, 312.1234556284971, 287.65670200497203, 185.9655934458628, 221.79338496430023, 558.8845499879717, 443.2019822499075, 5.33670439269414, 165.09273971349603, 371.3473888827013, 330.14083675238885, 198.32376076400436, 598.5692051868969, 0.782898321879674, 529.6195401165144, 323.3800797959659, 560.1692503212812, 267.64388360719215, 367.74776136324755, 9.471370271384497, 0.8621527213697282, 12.823523200857785, 179.6943205750791, 14.128531672476527, 115.61568661900083, 208.77951725787145, 272.604332840106, 452.0411114683595, 266.6347940516593, 307.12942173208404, 231.50384354733634, 367.0368463260274, 383.29679941897786, 362.5999455864012, 406.2304309419781, 84.90467749016298, 13.36401571134409, 219.09355101245407]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8498948020557962, "mean_inference_ms": 2.6539219006805537, "mean_action_processing_ms": 0.36673288509538327, "mean_env_wait_ms": 0.29889367658852317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005817413330078125, "StateBufferConnector_ms": 0.003450632095336914, "ViewRequirementAgentConnector_ms": 0.26643574237823486}, "num_episodes": 22, "episode_return_max": 354.36, "episode_return_min": -427.89005377148635, "episode_return_mean": 84.0288681372063, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 282.4981459035223, "num_env_steps_trained_throughput_per_sec": 282.4981459035223, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 14004.632, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14004.558, "sample_time_ms": 2202.406, "learn_time_ms": 11776.401, "learn_throughput": 339.662, "synch_weights_time_ms": 23.498}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "training_iteration": 67, "trial_id": "61e09_00000", "date": "2024-08-16_16-23-17", "timestamp": 1723805597, "time_this_iter_s": 14.208927869796753, "time_total_s": 997.6906723976135, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2549670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 997.6906723976135, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 62.86999999999998, "ram_util_percent": 81.495}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6431583924899025, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 0.00010000000000000003, "total_loss": 7.091491310432475, "policy_loss": -0.006164833052187331, "vf_loss": 7.096285400945674, "vf_explained_var": 0.08504861315722188, "kl": 0.010830586651962787, "entropy": 0.49718001771856235, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7051591000228963, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 6.189202650766524, "policy_loss": -0.010062235063582501, "vf_loss": 6.194804749917732, "vf_explained_var": -0.9200392002781863, "kl": 0.014867143742211588, "entropy": 0.9353451472426217, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "env_runners": {"episode_reward_max": 354.36, "episode_reward_min": -206.82355110272118, "episode_reward_mean": 79.4985392853303, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -629.3881547202641, "predator_policy": 0.782898321879674}, "policy_reward_max": {"prey_policy": 180.21524014192494, "predator_policy": 859.6679895970217}, "policy_reward_mean": {"prey_policy": -187.9768378512905, "predator_policy": 227.72610749395565}, "custom_metrics": {}, "hist_stats": {"episode_reward": [155.6001859652879, 188.11024053669183, 305.65999999999997, -54.886728490658136, 31.172639533946136, 283.1417995043802, 189.89869461620174, -25.945047010195005, 163.52862226067768, -63.21087617343336, 267.50810138873044, 77.66100794916612, 239.88987616331255, -186.82323151964914, 98.74189128924412, 159.90133327963628, 51.10757478576041, -11.811927180506702, 51.72085092336422, 338.7757984772948, -71.59117480580765, 0.8067106851278067, 256.8308614454885, -29.037987091382835, -19.54931830892922, -52.0474811289274, 307.62652223710086, 244.77878593300076, 267.74848551026287, 354.36, -65.44981465842496, 192.78514587133432, 291.74999999999983, -114.53677189684039, 254.52605086026102, 222.42951420732246, -94.06847561013004, 105.74375177161333, -5.076092728643913, 287.02604239398363, -45.87930985367578, 245.81832061720957, -8.102125791139741, 7.456274427007411, 101.53686104454471, -58.37154669747507, 234.36353086247857, -84.13250056068846, -128.8019857701177, 7.468523736261141, -56.9509325470587, 159.057557668095, 25.26138974679493, 85.92407506938143, -11.074743677348422, 56.09263372267887, 295.19970163292174, 87.18551374534402, 91.96388062305282, 264.1960266454499, 174.98455021724027, -94.48132535139, 245.97355703005314, -76.54866417023634, 136.00471421411402, -98.25215567324047, -73.05833327701781, -43.40157553008394, 24.751205188699988, -206.82355110272118, 79.70755212086819, 84.57555890224126, -14.250121723585725, 3.91999999999996, 130.76554103361252, 35.21690878654734, -77.10914511959092, 259.4257680992012, 141.26275201838013, 171.6869919952417, -68.25614873644533, 35.31999999999994, 36.67000000000011, 3.8450959208877, 91.0691469786184, 169.76694326682946, -22.46046362086097, 114.25664374994146, 13.571772053519997, 193.4092852798868, 280.85171469069405, 181.83026791930496, 3.9699999999999593, 3.600221752361497, 49.322252407770314, 3.9199999999999604, -0.6152799780546188, 41.919680773238355, 3.8599999999999617, 146.64586278762826], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-83.15263214921846, -11.4660103740125, -27.29787501042419, -59.67450733569982, 116.20394479074152, 140.66614864380736, -598.2870868868498, -440.2601209548726, -158.8184597620038, -152.5225901397267, 151.4608056002278, 126.74688312295946, -181.11964241557425, -130.44039718945916, -282.43792739241076, -453.57341174504575, -59.35941009093645, -2.3389486279944096, -424.70099346603513, -339.51720103454136, -159.3130005437831, -122.61977492892028, -286.04645800081596, -424.92317886374343, -167.33389809899361, -295.54458929771306, -629.3881547202641, -505.33406352149393, -104.57284256599829, -281.7134010577995, 81.92847764204525, -0.3148770415653639, -128.51814123174864, -127.48621538241387, -356.3542136741665, -287.7476001975554, -106.97666902973016, -149.66641211420034, 96.72031335080223, 175.05108269053613, -233.1890370607051, -224.68706891218048, -358.9589975731176, -212.96767039588917, 42.20035644501689, 35.4514022198824, -615.1664891038563, -346.8537332438057, -260.86585891296005, -309.11556717988003, -287.5082356817126, -194.11068866222593, -451.35137238785944, -3.555677049583032, -4.780332302663918, -215.6135667718419, 82.2935698071245, 116.67439417093964, 180.21524014192494, 153.7039292302149, -173.61782787505805, -453.632035976257, -221.01410771685724, -181.91538398281511, 154.47577630354843, 76.51264877432479, -288.63100526809524, -305.584153267347, -382.31281734035144, -13.710828594777261, -356.8401722210437, -4.272375189088275, -465.683920640378, -471.73841023572606, -101.51574720748324, -75.29273094642107, -418.0948350146015, -450.21496957261553, 120.54208361279376, 94.99088428679943, -230.33217612930085, -388.53185630617656, 2.0000000000000013, -515.4461193181943, -269.5718227481601, -216.367172936336, -393.76487821420386, -403.15851824400175, -296.35723711219134, -6.080801966996276, -325.1599453808371, -187.12753253819076, -10.231062667003155, -358.1987916323518, -310.17851389772653, -256.7484843959367, -375.7445933619733, -240.2033964205194, 0.9988529982622347, -8.628280797050575, -261.55127357635064, -145.15075801065234, -0.5907326199224514, -341.72770780729866, -293.02448140010375, -462.6868367237528, -9.038722328355707, -4.2370064074175104, -163.38916940027002, -393.5737152942323, -298.49794010527, -16.224961677842945, -62.923186970891706, -81.59990503091845, -265.0963127423454, -123.23092435505161, -527.6170537027488, -284.59311735469424, -217.06364956548566, -70.1533556670524, -340.89587186152767, -3.5760374714546668, -345.7065911220836, -250.33858245967875, -138.79057859846304, 176.29741063972367, -224.60666680306852, -345.93853556763634, -336.5137901223031, -1.103791114417867, -455.0958353086633, -423.8342553168505, -193.52471795287556, -328.0723019667439, -291.12516580522765, -288.7165383210541, -305.31660196562325, -198.39679036207025, -532.240302355273, -273.93535225622486, -306.34293190430213, -466.9491358873102, -320.1438543381618, -423.09372068807073, -132.93079404486443, -258.5384593133535, 1.1278472786302731, -10.893523200857826, 51.03316865364205, -114.09047986758512, -14.84017198108409, -274.33812310924105, -425.5840359030785, -376.1705535249781, -7.048445115594726, -307.29000256894693, -146.59354943346648, -310.6843884215172, -336.4199862155866, -237.78976679455056, -252.6300745257879, -306.76118264279864, -195.5910432663119, -1.54652345748621, -2.1296931792455016, -313.7446996508487, -295.8316148298791, -385.20126561932165, -125.86763662077772, -190.79362775043748, -263.1202886533897, -4.15502208335673, -142.17634065614885, -354.3734650421037, -408.21118087259146, -325.88425341626953, -109.3820526327904, -118.71831935908145, -123.88849376575747, -84.76566399221632, -11.127088784626807, -255.1486536169892, -88.38317020576288, 0.6940908121022326, -0.4287749998832351, 1.1112114828647845, -3.1604105123330104, -10.93665947262606, -62.10457937150664, -172.66588709235117, 0.5113306716679372, -6.196192568427195, -188.96661056585765, -191.49953748237462, -267.43362298646366, 0.8832174263842149, -13.014440305781184, 0.8716759033437592, -6.088548537305202, -311.91915345501656], "policy_predator_policy_reward": [145.9164523456161, 104.30237614290276, 160.48011796885388, 114.60250491396198, 18.606249560401142, 30.18365700504998, 272.7074767362193, 710.9530026148448, 335.4194489005209, 7.0942405351558655, 3.9231168770406075, 1.010993904152629, 227.28757002832813, 274.17116419290716, 22.23710735159306, 687.8291847756682, 100.98451965873544, 124.24246132087289, 187.96856965743117, 513.0387486697122, 355.4588775656417, 193.98199929579238, 464.6098954162789, 324.02074939744654, 325.7809829812514, 376.9873805787672, 859.6679895970217, 88.2309971250868, 161.1852835813058, 323.8428513317358, 35.00632400828925, 43.28140867086719, 303.95546336349935, 3.1564680364234308, 365.33109437991277, 266.95879231130243, 198.6183616672034, 109.745570400091, 23.262899349072605, 43.74150308688383, 381.76993446218705, 4.5149967048910495, 89.14396859099651, 483.5894100631379, 117.28311757056548, 61.89598521002385, 374.42543233424766, 558.5568029220316, 427.29339036456577, 123.13871741934528, 15.785886555038168, 413.78555665997345, 369.766499915189, 392.7670717593543, 269.0724251681924, 196.1002598393143, 10.744480537087707, 58.03604099511122, 6.87475985807509, 13.5660707697851, 12.666647725541347, 549.1334014673486, 305.9521106196007, 289.7625269514064, 46.448642456031955, 14.312932466094841, 0.8691607684400732, 478.8092258701617, 266.64161364371444, 383.9080831516756, 375.8701722210437, 207.67188939641113, 604.2832077382822, 239.0706475276919, 277.1312772093583, 5.420952716159075, 484.6673916041258, 378.56632025444753, 37.87951652091937, 33.61355797347107, 79.04164777656777, 493.9430748052336, 409.8303746468416, 349.4340652885626, 466.94118292713375, 10.895686966223074, 417.8937304206756, 386.48594046453775, 228.17725784692058, 175.79764227681198, 447.56224355781626, 6.353687663736207, 254.32151213249927, 348.4718730293342, 37.18290676058752, 445.6115909723869, 461.16640727141004, 25.97959674096562, 10.568280797050534, 4.529670737998991, 7.009679871063476, 342.7414191688808, 190.84405388743568, 310.5319442078803, 473.1634023120615, 307.8093055585896, 82.37088322807575, 16.828920577078684, 497.90368202995944, 47.98445898719416, 251.226016132364, 119.58951937342844, 235.48993153130417, 204.2328621034279, 345.38196019710625, 130.13079064563462, 611.0011828762745, 293.17286880422097, 315.8032473866869, 235.60978449130113, 341.14587186152744, 178.3105876886955, 490.43446129637704, 11.129386933994232, 102.67593146014951, 105.79079352864258, 181.87308257197165, 312.1234556284971, 287.65670200497203, 185.9655934458628, 221.79338496430023, 558.8845499879717, 443.2019822499075, 5.33670439269414, 165.09273971349603, 371.3473888827013, 330.14083675238885, 198.32376076400436, 598.5692051868969, 0.782898321879674, 529.6195401165144, 323.3800797959659, 560.1692503212812, 267.64388360719215, 367.74776136324755, 9.471370271384497, 0.8621527213697282, 12.823523200857785, 179.6943205750791, 14.128531672476527, 115.61568661900083, 208.77951725787145, 272.604332840106, 452.0411114683595, 266.6347940516593, 307.12942173208404, 231.50384354733634, 367.0368463260274, 383.29679941897786, 362.5999455864012, 406.2304309419781, 84.90467749016298, 13.36401571134409, 219.09355101245407, 315.5249428917102, 37.01944993838359, 355.1697123692763, 329.7082640008118, 7.022126892195531, 400.7082844576379, 238.7352295164355, 198.3070244871403, 443.55997351644334, 30.529368560948203, 382.00823451680435, 466.34384352199805, 228.89794938707425, 12.774194658317539, 195.49591253861618, 206.5675304992443, 292.9099276247642, 254.21752946754665, 147.02174133687924, 122.49760597608675, 2.408774999883228, 0.8787885171352169, 13.186578729340054, 4.510713007980466, 280.65441301291577, 3.438305858712524, 1.4786693283320642, 8.126192568427154, 359.47727172051674, 20.373596349661256, 27.610685779060613, 280.85940055425715, 5.31212026193159, 10.690644140505796, 212.23097554522838, 252.42258923472144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8510530290148588, "mean_inference_ms": 2.6636190201992127, "mean_action_processing_ms": 0.36764005039795405, "mean_env_wait_ms": 0.29972043808565796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006000161170959473, "StateBufferConnector_ms": 0.0034477710723876953, "ViewRequirementAgentConnector_ms": 0.30933475494384766}, "num_episodes": 18, "episode_return_max": 354.36, "episode_return_min": -206.82355110272118, "episode_return_mean": 79.4985392853303, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 276.5619660864589, "num_env_steps_trained_throughput_per_sec": 276.5619660864589, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 14087.054, "restore_workers_time_ms": 0.016, "training_step_time_ms": 14086.983, "sample_time_ms": 2310.237, "learn_time_ms": 11751.344, "learn_throughput": 340.387, "synch_weights_time_ms": 23.035}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "training_iteration": 68, "trial_id": "61e09_00000", "date": "2024-08-16_16-23-32", "timestamp": 1723805612, "time_this_iter_s": 14.50796103477478, "time_total_s": 1012.1986334323883, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24c08b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1012.1986334323883, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 64.55999999999999, "ram_util_percent": 81.59}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.191438846834122, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 0.00010000000000000003, "total_loss": 7.395962648038511, "policy_loss": -0.006072179393143092, "vf_loss": 7.4010179279973265, "vf_explained_var": 0.12907139624237385, "kl": 0.008034777492166486, "entropy": 0.4724267672451716, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9623286888239875, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 7.999085039562649, "policy_loss": -0.011411266384902533, "vf_loss": 8.007114307464116, "vf_explained_var": -0.3585575760356964, "kl": 0.011273297413393654, "entropy": 1.0706386236602037, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 354.36, "episode_reward_min": -206.82355110272118, "episode_reward_mean": 78.0589180828507, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -615.1664891038563, "predator_policy": 0.782898321879674}, "policy_reward_max": {"prey_policy": 180.21524014192494, "predator_policy": 611.0011828762745}, "policy_reward_mean": {"prey_policy": -183.02853823113674, "predator_policy": 222.05799727256206}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29.037987091382835, -19.54931830892922, -52.0474811289274, 307.62652223710086, 244.77878593300076, 267.74848551026287, 354.36, -65.44981465842496, 192.78514587133432, 291.74999999999983, -114.53677189684039, 254.52605086026102, 222.42951420732246, -94.06847561013004, 105.74375177161333, -5.076092728643913, 287.02604239398363, -45.87930985367578, 245.81832061720957, -8.102125791139741, 7.456274427007411, 101.53686104454471, -58.37154669747507, 234.36353086247857, -84.13250056068846, -128.8019857701177, 7.468523736261141, -56.9509325470587, 159.057557668095, 25.26138974679493, 85.92407506938143, -11.074743677348422, 56.09263372267887, 295.19970163292174, 87.18551374534402, 91.96388062305282, 264.1960266454499, 174.98455021724027, -94.48132535139, 245.97355703005314, -76.54866417023634, 136.00471421411402, -98.25215567324047, -73.05833327701781, -43.40157553008394, 24.751205188699988, -206.82355110272118, 79.70755212086819, 84.57555890224126, -14.250121723585725, 3.91999999999996, 130.76554103361252, 35.21690878654734, -77.10914511959092, 259.4257680992012, 141.26275201838013, 171.6869919952417, -68.25614873644533, 35.31999999999994, 36.67000000000011, 3.8450959208877, 91.0691469786184, 169.76694326682946, -22.46046362086097, 114.25664374994146, 13.571772053519997, 193.4092852798868, 280.85171469069405, 181.83026791930496, 3.9699999999999593, 3.600221752361497, 49.322252407770314, 3.9199999999999604, -0.6152799780546188, 41.919680773238355, 3.8599999999999617, 146.64586278762826, 47.94826211092641, 143.75313748272018, 186.36863908973822, 186.67771034071725, 217.19977699180382, 308.27861135494845, 143.10463401506206, 145.59487867085105, 3.93999999999996, 165.24448896046763, -31.902624260340232, 40.611932512892245, 131.4270822943392, 218.33259022058368, -54.795253543071695, 17.262965931283166, 40.108477218694645, 53.3599999999999, 27.353173626341963, 18.920000000000073, 3.8799999999999613, 55.274058397684, 233.8825419604585], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-615.1664891038563, -346.8537332438057, -260.86585891296005, -309.11556717988003, -287.5082356817126, -194.11068866222593, -451.35137238785944, -3.555677049583032, -4.780332302663918, -215.6135667718419, 82.2935698071245, 116.67439417093964, 180.21524014192494, 153.7039292302149, -173.61782787505805, -453.632035976257, -221.01410771685724, -181.91538398281511, 154.47577630354843, 76.51264877432479, -288.63100526809524, -305.584153267347, -382.31281734035144, -13.710828594777261, -356.8401722210437, -4.272375189088275, -465.683920640378, -471.73841023572606, -101.51574720748324, -75.29273094642107, -418.0948350146015, -450.21496957261553, 120.54208361279376, 94.99088428679943, -230.33217612930085, -388.53185630617656, 2.0000000000000013, -515.4461193181943, -269.5718227481601, -216.367172936336, -393.76487821420386, -403.15851824400175, -296.35723711219134, -6.080801966996276, -325.1599453808371, -187.12753253819076, -10.231062667003155, -358.1987916323518, -310.17851389772653, -256.7484843959367, -375.7445933619733, -240.2033964205194, 0.9988529982622347, -8.628280797050575, -261.55127357635064, -145.15075801065234, -0.5907326199224514, -341.72770780729866, -293.02448140010375, -462.6868367237528, -9.038722328355707, -4.2370064074175104, -163.38916940027002, -393.5737152942323, -298.49794010527, -16.224961677842945, -62.923186970891706, -81.59990503091845, -265.0963127423454, -123.23092435505161, -527.6170537027488, -284.59311735469424, -217.06364956548566, -70.1533556670524, -340.89587186152767, -3.5760374714546668, -345.7065911220836, -250.33858245967875, -138.79057859846304, 176.29741063972367, -224.60666680306852, -345.93853556763634, -336.5137901223031, -1.103791114417867, -455.0958353086633, -423.8342553168505, -193.52471795287556, -328.0723019667439, -291.12516580522765, -288.7165383210541, -305.31660196562325, -198.39679036207025, -532.240302355273, -273.93535225622486, -306.34293190430213, -466.9491358873102, -320.1438543381618, -423.09372068807073, -132.93079404486443, -258.5384593133535, 1.1278472786302731, -10.893523200857826, 51.03316865364205, -114.09047986758512, -14.84017198108409, -274.33812310924105, -425.5840359030785, -376.1705535249781, -7.048445115594726, -307.29000256894693, -146.59354943346648, -310.6843884215172, -336.4199862155866, -237.78976679455056, -252.6300745257879, -306.76118264279864, -195.5910432663119, -1.54652345748621, -2.1296931792455016, -313.7446996508487, -295.8316148298791, -385.20126561932165, -125.86763662077772, -190.79362775043748, -263.1202886533897, -4.15502208335673, -142.17634065614885, -354.3734650421037, -408.21118087259146, -325.88425341626953, -109.3820526327904, -118.71831935908145, -123.88849376575747, -84.76566399221632, -11.127088784626807, -255.1486536169892, -88.38317020576288, 0.6940908121022326, -0.4287749998832351, 1.1112114828647845, -3.1604105123330104, -10.93665947262606, -62.10457937150664, -172.66588709235117, 0.5113306716679372, -6.196192568427195, -188.96661056585765, -191.49953748237462, -267.43362298646366, 0.8832174263842149, -13.014440305781184, 0.8716759033437592, -6.088548537305202, -311.91915345501656, -84.54704683094955, -205.91232136472587, -42.45872789731395, -61.916746252066005, 0.9709694606169634, -57.22994711608155, -120.58954463416583, -47.14977168714396, -468.4365072023633, 2.0000000000000013, -293.0603959986651, -198.7968312458932, -210.3155336477057, -141.1334365698824, 41.81071502130639, -3.1130251402781495, 0.06258160846381493, -2.3559434315986154, -86.1180450874819, -60.37945121412236, -341.5745182082533, -197.62395219037688, -228.37619439758362, -469.97372735239856, -175.05456566153177, -7.839773918905941, -47.68247190504772, -243.48828808105142, -428.5888803882913, -328.4168483256532, -32.412868877125575, -274.3962090387243, -122.4126725083124, -156.40432061885005, -1.379753939395867, -172.59968191111633, -49.84872688748048, -223.73224204648372, -371.2150186520894, -16.674926497086204, -11.385476918605166, -7.973800354454742, -230.0711357124271, -27.629664351083136, -127.98185041199932, -279.1275618664534], "policy_predator_policy_reward": [374.42543233424766, 558.5568029220316, 427.29339036456577, 123.13871741934528, 15.785886555038168, 413.78555665997345, 369.766499915189, 392.7670717593543, 269.0724251681924, 196.1002598393143, 10.744480537087707, 58.03604099511122, 6.87475985807509, 13.5660707697851, 12.666647725541347, 549.1334014673486, 305.9521106196007, 289.7625269514064, 46.448642456031955, 14.312932466094841, 0.8691607684400732, 478.8092258701617, 266.64161364371444, 383.9080831516756, 375.8701722210437, 207.67188939641113, 604.2832077382822, 239.0706475276919, 277.1312772093583, 5.420952716159075, 484.6673916041258, 378.56632025444753, 37.87951652091937, 33.61355797347107, 79.04164777656777, 493.9430748052336, 409.8303746468416, 349.4340652885626, 466.94118292713375, 10.895686966223074, 417.8937304206756, 386.48594046453775, 228.17725784692058, 175.79764227681198, 447.56224355781626, 6.353687663736207, 254.32151213249927, 348.4718730293342, 37.18290676058752, 445.6115909723869, 461.16640727141004, 25.97959674096562, 10.568280797050534, 4.529670737998991, 7.009679871063476, 342.7414191688808, 190.84405388743568, 310.5319442078803, 473.1634023120615, 307.8093055585896, 82.37088322807575, 16.828920577078684, 497.90368202995944, 47.98445898719416, 251.226016132364, 119.58951937342844, 235.48993153130417, 204.2328621034279, 345.38196019710625, 130.13079064563462, 611.0011828762745, 293.17286880422097, 315.8032473866869, 235.60978449130113, 341.14587186152744, 178.3105876886955, 490.43446129637704, 11.129386933994232, 102.67593146014951, 105.79079352864258, 181.87308257197165, 312.1234556284971, 287.65670200497203, 185.9655934458628, 221.79338496430023, 558.8845499879717, 443.2019822499075, 5.33670439269414, 165.09273971349603, 371.3473888827013, 330.14083675238885, 198.32376076400436, 598.5692051868969, 0.782898321879674, 529.6195401165144, 323.3800797959659, 560.1692503212812, 267.64388360719215, 367.74776136324755, 9.471370271384497, 0.8621527213697282, 12.823523200857785, 179.6943205750791, 14.128531672476527, 115.61568661900083, 208.77951725787145, 272.604332840106, 452.0411114683595, 266.6347940516593, 307.12942173208404, 231.50384354733634, 367.0368463260274, 383.29679941897786, 362.5999455864012, 406.2304309419781, 84.90467749016298, 13.36401571134409, 219.09355101245407, 315.5249428917102, 37.01944993838359, 355.1697123692763, 329.7082640008118, 7.022126892195531, 400.7082844576379, 238.7352295164355, 198.3070244871403, 443.55997351644334, 30.529368560948203, 382.00823451680435, 466.34384352199805, 228.89794938707425, 12.774194658317539, 195.49591253861618, 206.5675304992443, 292.9099276247642, 254.21752946754665, 147.02174133687924, 122.49760597608675, 2.408774999883228, 0.8787885171352169, 13.186578729340054, 4.510713007980466, 280.65441301291577, 3.438305858712524, 1.4786693283320642, 8.126192568427154, 359.47727172051674, 20.373596349661256, 27.610685779060613, 280.85940055425715, 5.31212026193159, 10.690644140505796, 212.23097554522838, 252.42258923472144, 6.380445543726882, 332.0271847628748, 10.777506356334955, 237.3511052757652, 177.6881293345258, 64.93948741067719, 146.4266278447642, 207.99039881726299, 430.28557050987587, 253.35071368429166, 428.2990753375963, 371.83676326191, 321.27219485198736, 173.28140938066264, 54.11934797368423, 52.777840816138564, 1.9174183915361867, 4.315943431598574, 3.953934389606475, 307.78805087246565, 332.0967751981247, 175.19907094016486, 406.76757920506793, 332.19427505780715, 205.96839108357773, 108.35303079119863, 223.7110374359786, 285.7923127707042, 427.51490907619365, 274.6955660946787, 17.44204952873984, 306.6299943183933, 35.269448496670584, 283.6560218491865, 197.98912337132046, 29.35031247919172, 0.9395933844091894, 299.99454917589713, 388.2850186520894, 18.524926497086494, 13.305476918605125, 9.9338003544547, 184.81245111372718, 128.16240734746725, 357.3477898570815, 283.6441643818291]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8541642402954622, "mean_inference_ms": 2.6742699444601303, "mean_action_processing_ms": 0.3684796910675242, "mean_env_wait_ms": 0.3003452232835895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006509065628051758, "StateBufferConnector_ms": 0.004137516021728516, "ViewRequirementAgentConnector_ms": 0.31400907039642334}, "num_episodes": 23, "episode_return_max": 354.36, "episode_return_min": -206.82355110272118, "episode_return_mean": 78.0589180828507, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 278.38884146532894, "num_env_steps_trained_throughput_per_sec": 278.38884146532894, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 14156.323, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14156.229, "sample_time_ms": 2305.904, "learn_time_ms": 11825.086, "learn_throughput": 338.264, "synch_weights_time_ms": 22.822}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 69, "trial_id": "61e09_00000", "date": "2024-08-16_16-23-46", "timestamp": 1723805626, "time_this_iter_s": 14.421687841415405, "time_total_s": 1026.6203212738037, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24c0af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1026.6203212738037, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 65.11904761904762, "ram_util_percent": 82.13333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8880849090833514, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 0.00010000000000000003, "total_loss": 7.14866249599154, "policy_loss": -0.004600704847662537, "vf_loss": 7.152442568319815, "vf_explained_var": 0.09966147652378789, "kl": 0.0064841251538496816, "entropy": 0.44001221891748843, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3729021570354543, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 6.5192833966048305, "policy_loss": -0.009557431892900871, "vf_loss": 6.5247270069425065, "vf_explained_var": -0.36240428194167124, "kl": 0.013712726544665163, "entropy": 1.0032249081071722, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 308.27861135494845, "episode_reward_min": -206.82355110272118, "episode_reward_mean": 78.73528056915877, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -532.240302355273, "predator_policy": 0.782898321879674}, "policy_reward_max": {"prey_policy": 176.29741063972367, "predator_policy": 611.0011828762745}, "policy_reward_mean": {"prey_policy": -159.4449771411917, "predator_policy": 198.8126174257711}, "custom_metrics": {}, "hist_stats": {"episode_reward": [245.81832061720957, -8.102125791139741, 7.456274427007411, 101.53686104454471, -58.37154669747507, 234.36353086247857, -84.13250056068846, -128.8019857701177, 7.468523736261141, -56.9509325470587, 159.057557668095, 25.26138974679493, 85.92407506938143, -11.074743677348422, 56.09263372267887, 295.19970163292174, 87.18551374534402, 91.96388062305282, 264.1960266454499, 174.98455021724027, -94.48132535139, 245.97355703005314, -76.54866417023634, 136.00471421411402, -98.25215567324047, -73.05833327701781, -43.40157553008394, 24.751205188699988, -206.82355110272118, 79.70755212086819, 84.57555890224126, -14.250121723585725, 3.91999999999996, 130.76554103361252, 35.21690878654734, -77.10914511959092, 259.4257680992012, 141.26275201838013, 171.6869919952417, -68.25614873644533, 35.31999999999994, 36.67000000000011, 3.8450959208877, 91.0691469786184, 169.76694326682946, -22.46046362086097, 114.25664374994146, 13.571772053519997, 193.4092852798868, 280.85171469069405, 181.83026791930496, 3.9699999999999593, 3.600221752361497, 49.322252407770314, 3.9199999999999604, -0.6152799780546188, 41.919680773238355, 3.8599999999999617, 146.64586278762826, 47.94826211092641, 143.75313748272018, 186.36863908973822, 186.67771034071725, 217.19977699180382, 308.27861135494845, 143.10463401506206, 145.59487867085105, 3.93999999999996, 165.24448896046763, -31.902624260340232, 40.611932512892245, 131.4270822943392, 218.33259022058368, -54.795253543071695, 17.262965931283166, 40.108477218694645, 53.3599999999999, 27.353173626341963, 18.920000000000073, 3.8799999999999613, 55.274058397684, 233.8825419604585, 3.9199999999999604, 168.91193768286146, 83.18141752445699, 66.37488579078403, 278.84513375194496, 134.1700000000004, 138.1201755835904, 134.40000000000077, 137.24784935864125, 98.41000000000021, 85.68835215792227, 127.72763334878374, 86.76414216623468, 191.64675893697714, 139.2444147472777, -3.8641423168197235, 6.1985619924190605, 293.77817541365636], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [2.0000000000000013, -515.4461193181943, -269.5718227481601, -216.367172936336, -393.76487821420386, -403.15851824400175, -296.35723711219134, -6.080801966996276, -325.1599453808371, -187.12753253819076, -10.231062667003155, -358.1987916323518, -310.17851389772653, -256.7484843959367, -375.7445933619733, -240.2033964205194, 0.9988529982622347, -8.628280797050575, -261.55127357635064, -145.15075801065234, -0.5907326199224514, -341.72770780729866, -293.02448140010375, -462.6868367237528, -9.038722328355707, -4.2370064074175104, -163.38916940027002, -393.5737152942323, -298.49794010527, -16.224961677842945, -62.923186970891706, -81.59990503091845, -265.0963127423454, -123.23092435505161, -527.6170537027488, -284.59311735469424, -217.06364956548566, -70.1533556670524, -340.89587186152767, -3.5760374714546668, -345.7065911220836, -250.33858245967875, -138.79057859846304, 176.29741063972367, -224.60666680306852, -345.93853556763634, -336.5137901223031, -1.103791114417867, -455.0958353086633, -423.8342553168505, -193.52471795287556, -328.0723019667439, -291.12516580522765, -288.7165383210541, -305.31660196562325, -198.39679036207025, -532.240302355273, -273.93535225622486, -306.34293190430213, -466.9491358873102, -320.1438543381618, -423.09372068807073, -132.93079404486443, -258.5384593133535, 1.1278472786302731, -10.893523200857826, 51.03316865364205, -114.09047986758512, -14.84017198108409, -274.33812310924105, -425.5840359030785, -376.1705535249781, -7.048445115594726, -307.29000256894693, -146.59354943346648, -310.6843884215172, -336.4199862155866, -237.78976679455056, -252.6300745257879, -306.76118264279864, -195.5910432663119, -1.54652345748621, -2.1296931792455016, -313.7446996508487, -295.8316148298791, -385.20126561932165, -125.86763662077772, -190.79362775043748, -263.1202886533897, -4.15502208335673, -142.17634065614885, -354.3734650421037, -408.21118087259146, -325.88425341626953, -109.3820526327904, -118.71831935908145, -123.88849376575747, -84.76566399221632, -11.127088784626807, -255.1486536169892, -88.38317020576288, 0.6940908121022326, -0.4287749998832351, 1.1112114828647845, -3.1604105123330104, -10.93665947262606, -62.10457937150664, -172.66588709235117, 0.5113306716679372, -6.196192568427195, -188.96661056585765, -191.49953748237462, -267.43362298646366, 0.8832174263842149, -13.014440305781184, 0.8716759033437592, -6.088548537305202, -311.91915345501656, -84.54704683094955, -205.91232136472587, -42.45872789731395, -61.916746252066005, 0.9709694606169634, -57.22994711608155, -120.58954463416583, -47.14977168714396, -468.4365072023633, 2.0000000000000013, -293.0603959986651, -198.7968312458932, -210.3155336477057, -141.1334365698824, 41.81071502130639, -3.1130251402781495, 0.06258160846381493, -2.3559434315986154, -86.1180450874819, -60.37945121412236, -341.5745182082533, -197.62395219037688, -228.37619439758362, -469.97372735239856, -175.05456566153177, -7.839773918905941, -47.68247190504772, -243.48828808105142, -428.5888803882913, -328.4168483256532, -32.412868877125575, -274.3962090387243, -122.4126725083124, -156.40432061885005, -1.379753939395867, -172.59968191111633, -49.84872688748048, -223.73224204648372, -371.2150186520894, -16.674926497086204, -11.385476918605166, -7.973800354454742, -230.0711357124271, -27.629664351083136, -127.98185041199932, -279.1275618664534, 0.9366601715248598, -7.858977265259037, -213.55326064565782, -10.473013767888022, -18.08258475393901, -59.65806446082909, 9.466177860236556, -186.53626366371424, 18.181363425007927, -6.293515567888115, 57.93275116784353, -2.6606116434970737, 50.80685335359152, -2.659715302342674, -14.792114803325157, 114.06236379750128, -262.60358016242316, -8.940380155005462, 1.2201075965533157, 17.81542256663436, -21.63760319583594, -137.09816208311534, -150.78140604699905, 45.092074376139735, -213.96622383183905, -17.77271060988236, -14.82362545417746, -184.86235357735563, -85.45312456053215, -76.70210453197429, -8.79962028366267, -15.994695538582546, -105.7332034087602, -265.4408168809364, -180.592467942673, -17.47970464104698], "policy_predator_policy_reward": [409.8303746468416, 349.4340652885626, 466.94118292713375, 10.895686966223074, 417.8937304206756, 386.48594046453775, 228.17725784692058, 175.79764227681198, 447.56224355781626, 6.353687663736207, 254.32151213249927, 348.4718730293342, 37.18290676058752, 445.6115909723869, 461.16640727141004, 25.97959674096562, 10.568280797050534, 4.529670737998991, 7.009679871063476, 342.7414191688808, 190.84405388743568, 310.5319442078803, 473.1634023120615, 307.8093055585896, 82.37088322807575, 16.828920577078684, 497.90368202995944, 47.98445898719416, 251.226016132364, 119.58951937342844, 235.48993153130417, 204.2328621034279, 345.38196019710625, 130.13079064563462, 611.0011828762745, 293.17286880422097, 315.8032473866869, 235.60978449130113, 341.14587186152744, 178.3105876886955, 490.43446129637704, 11.129386933994232, 102.67593146014951, 105.79079352864258, 181.87308257197165, 312.1234556284971, 287.65670200497203, 185.9655934458628, 221.79338496430023, 558.8845499879717, 443.2019822499075, 5.33670439269414, 165.09273971349603, 371.3473888827013, 330.14083675238885, 198.32376076400436, 598.5692051868969, 0.782898321879674, 529.6195401165144, 323.3800797959659, 560.1692503212812, 267.64388360719215, 367.74776136324755, 9.471370271384497, 0.8621527213697282, 12.823523200857785, 179.6943205750791, 14.128531672476527, 115.61568661900083, 208.77951725787145, 272.604332840106, 452.0411114683595, 266.6347940516593, 307.12942173208404, 231.50384354733634, 367.0368463260274, 383.29679941897786, 362.5999455864012, 406.2304309419781, 84.90467749016298, 13.36401571134409, 219.09355101245407, 315.5249428917102, 37.01944993838359, 355.1697123692763, 329.7082640008118, 7.022126892195531, 400.7082844576379, 238.7352295164355, 198.3070244871403, 443.55997351644334, 30.529368560948203, 382.00823451680435, 466.34384352199805, 228.89794938707425, 12.774194658317539, 195.49591253861618, 206.5675304992443, 292.9099276247642, 254.21752946754665, 147.02174133687924, 122.49760597608675, 2.408774999883228, 0.8787885171352169, 13.186578729340054, 4.510713007980466, 280.65441301291577, 3.438305858712524, 1.4786693283320642, 8.126192568427154, 359.47727172051674, 20.373596349661256, 27.610685779060613, 280.85940055425715, 5.31212026193159, 10.690644140505796, 212.23097554522838, 252.42258923472144, 6.380445543726882, 332.0271847628748, 10.777506356334955, 237.3511052757652, 177.6881293345258, 64.93948741067719, 146.4266278447642, 207.99039881726299, 430.28557050987587, 253.35071368429166, 428.2990753375963, 371.83676326191, 321.27219485198736, 173.28140938066264, 54.11934797368423, 52.777840816138564, 1.9174183915361867, 4.315943431598574, 3.953934389606475, 307.78805087246565, 332.0967751981247, 175.19907094016486, 406.76757920506793, 332.19427505780715, 205.96839108357773, 108.35303079119863, 223.7110374359786, 285.7923127707042, 427.51490907619365, 274.6955660946787, 17.44204952873984, 306.6299943183933, 35.269448496670584, 283.6560218491865, 197.98912337132046, 29.35031247919172, 0.9395933844091894, 299.99454917589713, 388.2850186520894, 18.524926497086494, 13.305476918605125, 9.9338003544547, 184.81245111372718, 128.16240734746725, 357.3477898570815, 283.6441643818291, 1.0533398284751416, 9.788977265258996, 212.47095762762115, 180.46725446878597, 15.65134668383984, 145.2707200553849, 1.8636426219567033, 241.58132897230513, 145.6891712185136, 121.26811467631202, 34.82584845723868, 44.072012018414775, 55.6160259914476, 34.357011540893474, 28.933701264997342, 6.196049740826876, 250.61183767153508, 158.17997200453456, 25.171658403974202, 54.20281143283813, 116.83444960310806, 127.58966783376542, 222.618545405836, 10.798419613806484, 304.7856247391746, 13.71745186878126, 219.12211190432365, 172.21062606418656, 154.7190579448361, 146.68058589494814, 1.2463987815733353, 19.683774723852494, 42.37135238904104, 335.0012298930744, 260.2408324055375, 231.60951559183906]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8562766265090233, "mean_inference_ms": 2.6809737373521716, "mean_action_processing_ms": 0.36894947765120617, "mean_env_wait_ms": 0.30071584245639416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006515383720397949, "StateBufferConnector_ms": 0.0041234493255615234, "ViewRequirementAgentConnector_ms": 0.30851924419403076}, "num_episodes": 18, "episode_return_max": 308.27861135494845, "episode_return_min": -206.82355110272118, "episode_return_mean": 78.73528056915877, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.8436012867139, "num_env_steps_trained_throughput_per_sec": 288.8436012867139, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 14128.964, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14128.884, "sample_time_ms": 2247.872, "learn_time_ms": 11856.845, "learn_throughput": 337.358, "synch_weights_time_ms": 22.294}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 70, "trial_id": "61e09_00000", "date": "2024-08-16_16-24-00", "timestamp": 1723805640, "time_this_iter_s": 13.89492416381836, "time_total_s": 1040.515245437622, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b25389d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1040.515245437622, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 65.40526315789474, "ram_util_percent": 81.64210526315792}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.768166627423473, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 0.00010000000000000003, "total_loss": 7.323136312242538, "policy_loss": -0.005059003101035992, "vf_loss": 7.327778406244106, "vf_explained_var": 0.12565976712438795, "kl": 0.0032941584562738995, "entropy": 0.39044908160570435, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0047547070437637, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 6.792879648057241, "policy_loss": -0.010984481990869556, "vf_loss": 6.800245602168734, "vf_explained_var": 0.16459138065418868, "kl": 0.012061817896584318, "entropy": 1.0309939554759435, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "env_runners": {"episode_reward_max": 308.27861135494845, "episode_reward_min": -206.82355110272118, "episode_reward_mean": 106.45639901057243, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -532.240302355273, "predator_policy": 0.782898321879674}, "policy_reward_max": {"prey_policy": 176.29741063972367, "predator_policy": 598.5692051868969}, "policy_reward_mean": {"prey_policy": -126.04820467473404, "predator_policy": 179.27640418002025}, "custom_metrics": {}, "hist_stats": {"episode_reward": [264.1960266454499, 174.98455021724027, -94.48132535139, 245.97355703005314, -76.54866417023634, 136.00471421411402, -98.25215567324047, -73.05833327701781, -43.40157553008394, 24.751205188699988, -206.82355110272118, 79.70755212086819, 84.57555890224126, -14.250121723585725, 3.91999999999996, 130.76554103361252, 35.21690878654734, -77.10914511959092, 259.4257680992012, 141.26275201838013, 171.6869919952417, -68.25614873644533, 35.31999999999994, 36.67000000000011, 3.8450959208877, 91.0691469786184, 169.76694326682946, -22.46046362086097, 114.25664374994146, 13.571772053519997, 193.4092852798868, 280.85171469069405, 181.83026791930496, 3.9699999999999593, 3.600221752361497, 49.322252407770314, 3.9199999999999604, -0.6152799780546188, 41.919680773238355, 3.8599999999999617, 146.64586278762826, 47.94826211092641, 143.75313748272018, 186.36863908973822, 186.67771034071725, 217.19977699180382, 308.27861135494845, 143.10463401506206, 145.59487867085105, 3.93999999999996, 165.24448896046763, -31.902624260340232, 40.611932512892245, 131.4270822943392, 218.33259022058368, -54.795253543071695, 17.262965931283166, 40.108477218694645, 53.3599999999999, 27.353173626341963, 18.920000000000073, 3.8799999999999613, 55.274058397684, 233.8825419604585, 3.9199999999999604, 168.91193768286146, 83.18141752445699, 66.37488579078403, 278.84513375194496, 134.1700000000004, 138.1201755835904, 134.40000000000077, 137.24784935864125, 98.41000000000021, 85.68835215792227, 127.72763334878374, 86.76414216623468, 191.64675893697714, 139.2444147472777, -3.8641423168197235, 6.1985619924190605, 293.77817541365636, 110.66245924255504, 201.1118395624916, 247.1247017122188, 264.9999999999998, 298.6308325252686, 271.513625235263, 231.7333388030672, 260.51743364546184, 87.4500000000002, 237.55965655397728, 233.67000000000004, 219.40891998645785, 262.44167155017834, 194.45349840559962, 160.3925695375357, 226.2899931853537, 141.49714721509514, 172.5485848327806], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-217.06364956548566, -70.1533556670524, -340.89587186152767, -3.5760374714546668, -345.7065911220836, -250.33858245967875, -138.79057859846304, 176.29741063972367, -224.60666680306852, -345.93853556763634, -336.5137901223031, -1.103791114417867, -455.0958353086633, -423.8342553168505, -193.52471795287556, -328.0723019667439, -291.12516580522765, -288.7165383210541, -305.31660196562325, -198.39679036207025, -532.240302355273, -273.93535225622486, -306.34293190430213, -466.9491358873102, -320.1438543381618, -423.09372068807073, -132.93079404486443, -258.5384593133535, 1.1278472786302731, -10.893523200857826, 51.03316865364205, -114.09047986758512, -14.84017198108409, -274.33812310924105, -425.5840359030785, -376.1705535249781, -7.048445115594726, -307.29000256894693, -146.59354943346648, -310.6843884215172, -336.4199862155866, -237.78976679455056, -252.6300745257879, -306.76118264279864, -195.5910432663119, -1.54652345748621, -2.1296931792455016, -313.7446996508487, -295.8316148298791, -385.20126561932165, -125.86763662077772, -190.79362775043748, -263.1202886533897, -4.15502208335673, -142.17634065614885, -354.3734650421037, -408.21118087259146, -325.88425341626953, -109.3820526327904, -118.71831935908145, -123.88849376575747, -84.76566399221632, -11.127088784626807, -255.1486536169892, -88.38317020576288, 0.6940908121022326, -0.4287749998832351, 1.1112114828647845, -3.1604105123330104, -10.93665947262606, -62.10457937150664, -172.66588709235117, 0.5113306716679372, -6.196192568427195, -188.96661056585765, -191.49953748237462, -267.43362298646366, 0.8832174263842149, -13.014440305781184, 0.8716759033437592, -6.088548537305202, -311.91915345501656, -84.54704683094955, -205.91232136472587, -42.45872789731395, -61.916746252066005, 0.9709694606169634, -57.22994711608155, -120.58954463416583, -47.14977168714396, -468.4365072023633, 2.0000000000000013, -293.0603959986651, -198.7968312458932, -210.3155336477057, -141.1334365698824, 41.81071502130639, -3.1130251402781495, 0.06258160846381493, -2.3559434315986154, -86.1180450874819, -60.37945121412236, -341.5745182082533, -197.62395219037688, -228.37619439758362, -469.97372735239856, -175.05456566153177, -7.839773918905941, -47.68247190504772, -243.48828808105142, -428.5888803882913, -328.4168483256532, -32.412868877125575, -274.3962090387243, -122.4126725083124, -156.40432061885005, -1.379753939395867, -172.59968191111633, -49.84872688748048, -223.73224204648372, -371.2150186520894, -16.674926497086204, -11.385476918605166, -7.973800354454742, -230.0711357124271, -27.629664351083136, -127.98185041199932, -279.1275618664534, 0.9366601715248598, -7.858977265259037, -213.55326064565782, -10.473013767888022, -18.08258475393901, -59.65806446082909, 9.466177860236556, -186.53626366371424, 18.181363425007927, -6.293515567888115, 57.93275116784353, -2.6606116434970737, 50.80685335359152, -2.659715302342674, -14.792114803325157, 114.06236379750128, -262.60358016242316, -8.940380155005462, 1.2201075965533157, 17.81542256663436, -21.63760319583594, -137.09816208311534, -150.78140604699905, 45.092074376139735, -213.96622383183905, -17.77271060988236, -14.82362545417746, -184.86235357735563, -85.45312456053215, -76.70210453197429, -8.79962028366267, -15.994695538582546, -105.7332034087602, -265.4408168809364, -180.592467942673, -17.47970464104698, 0.7884636296656291, -134.63027018702917, -80.4568912842105, -55.404061835142116, 15.661052938251943, -180.11160201142536, 52.33920884213188, 132.58647686889273, -47.44194191045652, -186.40574554544702, 87.0825697737389, 128.37015391234112, -241.33559968379217, -1.5767830296427745, 15.874227745726678, -7.800423966357286, -0.42981083576408574, -76.5071586451984, 69.62883553929404, 41.27299780664222, 96.74688716958832, -10.482474552797935, -117.07665297771545, -52.342948182164875, -50.42079288112498, -225.06421097374437, -36.102975072206206, 73.72576131585981, -142.25379612854292, -187.85810033739008, 31.97201496137813, 30.69682366687036, -131.3074333337448, -23.97523913384283, -3.3830896814290163, -9.745082831209524], "policy_predator_policy_reward": [315.8032473866869, 235.60978449130113, 341.14587186152744, 178.3105876886955, 490.43446129637704, 11.129386933994232, 102.67593146014951, 105.79079352864258, 181.87308257197165, 312.1234556284971, 287.65670200497203, 185.9655934458628, 221.79338496430023, 558.8845499879717, 443.2019822499075, 5.33670439269414, 165.09273971349603, 371.3473888827013, 330.14083675238885, 198.32376076400436, 598.5692051868969, 0.782898321879674, 529.6195401165144, 323.3800797959659, 560.1692503212812, 267.64388360719215, 367.74776136324755, 9.471370271384497, 0.8621527213697282, 12.823523200857785, 179.6943205750791, 14.128531672476527, 115.61568661900083, 208.77951725787145, 272.604332840106, 452.0411114683595, 266.6347940516593, 307.12942173208404, 231.50384354733634, 367.0368463260274, 383.29679941897786, 362.5999455864012, 406.2304309419781, 84.90467749016298, 13.36401571134409, 219.09355101245407, 315.5249428917102, 37.01944993838359, 355.1697123692763, 329.7082640008118, 7.022126892195531, 400.7082844576379, 238.7352295164355, 198.3070244871403, 443.55997351644334, 30.529368560948203, 382.00823451680435, 466.34384352199805, 228.89794938707425, 12.774194658317539, 195.49591253861618, 206.5675304992443, 292.9099276247642, 254.21752946754665, 147.02174133687924, 122.49760597608675, 2.408774999883228, 0.8787885171352169, 13.186578729340054, 4.510713007980466, 280.65441301291577, 3.438305858712524, 1.4786693283320642, 8.126192568427154, 359.47727172051674, 20.373596349661256, 27.610685779060613, 280.85940055425715, 5.31212026193159, 10.690644140505796, 212.23097554522838, 252.42258923472144, 6.380445543726882, 332.0271847628748, 10.777506356334955, 237.3511052757652, 177.6881293345258, 64.93948741067719, 146.4266278447642, 207.99039881726299, 430.28557050987587, 253.35071368429166, 428.2990753375963, 371.83676326191, 321.27219485198736, 173.28140938066264, 54.11934797368423, 52.777840816138564, 1.9174183915361867, 4.315943431598574, 3.953934389606475, 307.78805087246565, 332.0967751981247, 175.19907094016486, 406.76757920506793, 332.19427505780715, 205.96839108357773, 108.35303079119863, 223.7110374359786, 285.7923127707042, 427.51490907619365, 274.6955660946787, 17.44204952873984, 306.6299943183933, 35.269448496670584, 283.6560218491865, 197.98912337132046, 29.35031247919172, 0.9395933844091894, 299.99454917589713, 388.2850186520894, 18.524926497086494, 13.305476918605125, 9.9338003544547, 184.81245111372718, 128.16240734746725, 357.3477898570815, 283.6441643818291, 1.0533398284751416, 9.788977265258996, 212.47095762762115, 180.46725446878597, 15.65134668383984, 145.2707200553849, 1.8636426219567033, 241.58132897230513, 145.6891712185136, 121.26811467631202, 34.82584845723868, 44.072012018414775, 55.6160259914476, 34.357011540893474, 28.933701264997342, 6.196049740826876, 250.61183767153508, 158.17997200453456, 25.171658403974202, 54.20281143283813, 116.83444960310806, 127.58966783376542, 222.618545405836, 10.798419613806484, 304.7856247391746, 13.71745186878126, 219.12211190432365, 172.21062606418656, 154.7190579448361, 146.68058589494814, 1.2463987815733353, 19.683774723852494, 42.37135238904104, 335.0012298930744, 260.2408324055375, 231.60951559183906, 36.46713132645735, 208.03713447346107, 189.586512569157, 147.38628011268736, 221.1762482098603, 190.39900257553208, 37.818123374128675, 42.25619091484672, 282.2052028429169, 250.27331713825527, 11.608392301808463, 44.452509247374635, 273.3455996837923, 201.30012183271052, 109.2687728661555, 143.1748569999369, 2.4098108357640786, 161.97715864519864, 92.53432747527555, 34.12349573276596, 113.37039468985687, 34.035192693352634, 151.99565328514947, 236.83286786118907, 257.081312087354, 280.84536331769397, 87.48647347780582, 69.34423868414024, 136.6939315158622, 353.81053448760633, 158.85464303072453, 4.7665115263806515, 142.2980178927376, 154.48180178994528, 100.31567819514514, 85.36107915027416]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8572480343127783, "mean_inference_ms": 2.684638327607787, "mean_action_processing_ms": 0.36901228298577615, "mean_env_wait_ms": 0.3009334380272522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007275700569152832, "StateBufferConnector_ms": 0.00416874885559082, "ViewRequirementAgentConnector_ms": 0.271480917930603}, "num_episodes": 18, "episode_return_max": 308.27861135494845, "episode_return_min": -206.82355110272118, "episode_return_mean": 106.45639901057243, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 279.93555808573865, "num_env_steps_trained_throughput_per_sec": 279.93555808573865, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 1136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 14086.802, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14086.721, "sample_time_ms": 2110.661, "learn_time_ms": 11951.934, "learn_throughput": 334.674, "synch_weights_time_ms": 22.067}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "done": false, "training_iteration": 71, "trial_id": "61e09_00000", "date": "2024-08-16_16-24-15", "timestamp": 1723805655, "time_this_iter_s": 14.345009803771973, "time_total_s": 1054.860255241394, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30000bee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1054.860255241394, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 62.838095238095235, "ram_util_percent": 81.52857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8313596292147563, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 0.00010000000000000003, "total_loss": 6.950853753216053, "policy_loss": -0.008973098470627393, "vf_loss": 6.958997218066423, "vf_explained_var": 0.14446385499661563, "kl": 0.013110310306589833, "entropy": 0.38220323193325567, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.644130062804651, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 6.586920813908653, "policy_loss": -0.008627782764760826, "vf_loss": 6.592422242391677, "vf_explained_var": 0.12856045595552557, "kl": 0.010421153669799591, "entropy": 1.089308643845654, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 356.48624822446595, "episode_reward_min": -54.795253543071695, "episode_reward_mean": 146.41933392982446, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -469.97372735239856, "predator_policy": 0.8787885171352169}, "policy_reward_max": {"prey_policy": 187.0216198354963, "predator_policy": 466.34384352199805}, "policy_reward_mean": {"prey_policy": -70.29901249838692, "predator_policy": 143.50867946329913}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.31999999999994, 36.67000000000011, 3.8450959208877, 91.0691469786184, 169.76694326682946, -22.46046362086097, 114.25664374994146, 13.571772053519997, 193.4092852798868, 280.85171469069405, 181.83026791930496, 3.9699999999999593, 3.600221752361497, 49.322252407770314, 3.9199999999999604, -0.6152799780546188, 41.919680773238355, 3.8599999999999617, 146.64586278762826, 47.94826211092641, 143.75313748272018, 186.36863908973822, 186.67771034071725, 217.19977699180382, 308.27861135494845, 143.10463401506206, 145.59487867085105, 3.93999999999996, 165.24448896046763, -31.902624260340232, 40.611932512892245, 131.4270822943392, 218.33259022058368, -54.795253543071695, 17.262965931283166, 40.108477218694645, 53.3599999999999, 27.353173626341963, 18.920000000000073, 3.8799999999999613, 55.274058397684, 233.8825419604585, 3.9199999999999604, 168.91193768286146, 83.18141752445699, 66.37488579078403, 278.84513375194496, 134.1700000000004, 138.1201755835904, 134.40000000000077, 137.24784935864125, 98.41000000000021, 85.68835215792227, 127.72763334878374, 86.76414216623468, 191.64675893697714, 139.2444147472777, -3.8641423168197235, 6.1985619924190605, 293.77817541365636, 110.66245924255504, 201.1118395624916, 247.1247017122188, 264.9999999999998, 298.6308325252686, 271.513625235263, 231.7333388030672, 260.51743364546184, 87.4500000000002, 237.55965655397728, 233.67000000000004, 219.40891998645785, 262.44167155017834, 194.45349840559962, 160.3925695375357, 226.2899931853537, 141.49714721509514, 172.5485848327806, 155.06000000000006, 356.48624822446595, 210.71063432334728, 350.406229993737, 229.42637546514445, 303.3844723803811, 190.86704793575223, 203.69, 308.8072394964439, 185.49147728281685, 305.0710016412703, 249.90503147619933, 8.251150497646476, 196.90999999999968, 226.68245881238346, 247.18954836362332, 144.1592440608554, 158.72181299202379, 144.32503447790376, 275.76000000000005, 258.7085900685503, 286.5699999999999], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-195.5910432663119, -1.54652345748621, -2.1296931792455016, -313.7446996508487, -295.8316148298791, -385.20126561932165, -125.86763662077772, -190.79362775043748, -263.1202886533897, -4.15502208335673, -142.17634065614885, -354.3734650421037, -408.21118087259146, -325.88425341626953, -109.3820526327904, -118.71831935908145, -123.88849376575747, -84.76566399221632, -11.127088784626807, -255.1486536169892, -88.38317020576288, 0.6940908121022326, -0.4287749998832351, 1.1112114828647845, -3.1604105123330104, -10.93665947262606, -62.10457937150664, -172.66588709235117, 0.5113306716679372, -6.196192568427195, -188.96661056585765, -191.49953748237462, -267.43362298646366, 0.8832174263842149, -13.014440305781184, 0.8716759033437592, -6.088548537305202, -311.91915345501656, -84.54704683094955, -205.91232136472587, -42.45872789731395, -61.916746252066005, 0.9709694606169634, -57.22994711608155, -120.58954463416583, -47.14977168714396, -468.4365072023633, 2.0000000000000013, -293.0603959986651, -198.7968312458932, -210.3155336477057, -141.1334365698824, 41.81071502130639, -3.1130251402781495, 0.06258160846381493, -2.3559434315986154, -86.1180450874819, -60.37945121412236, -341.5745182082533, -197.62395219037688, -228.37619439758362, -469.97372735239856, -175.05456566153177, -7.839773918905941, -47.68247190504772, -243.48828808105142, -428.5888803882913, -328.4168483256532, -32.412868877125575, -274.3962090387243, -122.4126725083124, -156.40432061885005, -1.379753939395867, -172.59968191111633, -49.84872688748048, -223.73224204648372, -371.2150186520894, -16.674926497086204, -11.385476918605166, -7.973800354454742, -230.0711357124271, -27.629664351083136, -127.98185041199932, -279.1275618664534, 0.9366601715248598, -7.858977265259037, -213.55326064565782, -10.473013767888022, -18.08258475393901, -59.65806446082909, 9.466177860236556, -186.53626366371424, 18.181363425007927, -6.293515567888115, 57.93275116784353, -2.6606116434970737, 50.80685335359152, -2.659715302342674, -14.792114803325157, 114.06236379750128, -262.60358016242316, -8.940380155005462, 1.2201075965533157, 17.81542256663436, -21.63760319583594, -137.09816208311534, -150.78140604699905, 45.092074376139735, -213.96622383183905, -17.77271060988236, -14.82362545417746, -184.86235357735563, -85.45312456053215, -76.70210453197429, -8.79962028366267, -15.994695538582546, -105.7332034087602, -265.4408168809364, -180.592467942673, -17.47970464104698, 0.7884636296656291, -134.63027018702917, -80.4568912842105, -55.404061835142116, 15.661052938251943, -180.11160201142536, 52.33920884213188, 132.58647686889273, -47.44194191045652, -186.40574554544702, 87.0825697737389, 128.37015391234112, -241.33559968379217, -1.5767830296427745, 15.874227745726678, -7.800423966357286, -0.42981083576408574, -76.5071586451984, 69.62883553929404, 41.27299780664222, 96.74688716958832, -10.482474552797935, -117.07665297771545, -52.342948182164875, -50.42079288112498, -225.06421097374437, -36.102975072206206, 73.72576131585981, -142.25379612854292, -187.85810033739008, 31.97201496137813, 30.69682366687036, -131.3074333337448, -23.97523913384283, -3.3830896814290163, -9.745082831209524, -5.171346299212049, 90.11695319908321, -10.979232285434666, 162.2194615140885, -200.59334375463007, 2.0000000000000013, 59.44550208097614, -28.534721441999977, 33.275164493908946, -138.47727724238158, 106.03231147405927, 69.72653568165182, 166.6134333209097, -9.63408546662076, -123.08127777914505, 125.6275538176994, 106.09884787571201, 36.418117886474796, -66.02419660751052, -58.80418971393336, 76.60730348513395, 143.66780210156568, 73.52360413211042, 78.68754989228965, -55.45712210176743, -1.0343337076719934, -10.35503487261661, 187.0216198354963, -96.29325360752082, 46.86436886915067, -47.394462411815255, 51.2474168431889, -17.696164443161756, -15.521396854430208, -84.94537316508237, -290.2452289067247, 0.9378114343866523, 68.92786259795821, 122.76443724104308, 93.95648377096154, -69.3374228276537, 22.159438348942768, 114.83488673583878, 75.02336725319432], "policy_predator_policy_reward": [13.36401571134409, 219.09355101245407, 315.5249428917102, 37.01944993838359, 355.1697123692763, 329.7082640008118, 7.022126892195531, 400.7082844576379, 238.7352295164355, 198.3070244871403, 443.55997351644334, 30.529368560948203, 382.00823451680435, 466.34384352199805, 228.89794938707425, 12.774194658317539, 195.49591253861618, 206.5675304992443, 292.9099276247642, 254.21752946754665, 147.02174133687924, 122.49760597608675, 2.408774999883228, 0.8787885171352169, 13.186578729340054, 4.510713007980466, 280.65441301291577, 3.438305858712524, 1.4786693283320642, 8.126192568427154, 359.47727172051674, 20.373596349661256, 27.610685779060613, 280.85940055425715, 5.31212026193159, 10.690644140505796, 212.23097554522838, 252.42258923472144, 6.380445543726882, 332.0271847628748, 10.777506356334955, 237.3511052757652, 177.6881293345258, 64.93948741067719, 146.4266278447642, 207.99039881726299, 430.28557050987587, 253.35071368429166, 428.2990753375963, 371.83676326191, 321.27219485198736, 173.28140938066264, 54.11934797368423, 52.777840816138564, 1.9174183915361867, 4.315943431598574, 3.953934389606475, 307.78805087246565, 332.0967751981247, 175.19907094016486, 406.76757920506793, 332.19427505780715, 205.96839108357773, 108.35303079119863, 223.7110374359786, 285.7923127707042, 427.51490907619365, 274.6955660946787, 17.44204952873984, 306.6299943183933, 35.269448496670584, 283.6560218491865, 197.98912337132046, 29.35031247919172, 0.9395933844091894, 299.99454917589713, 388.2850186520894, 18.524926497086494, 13.305476918605125, 9.9338003544547, 184.81245111372718, 128.16240734746725, 357.3477898570815, 283.6441643818291, 1.0533398284751416, 9.788977265258996, 212.47095762762115, 180.46725446878597, 15.65134668383984, 145.2707200553849, 1.8636426219567033, 241.58132897230513, 145.6891712185136, 121.26811467631202, 34.82584845723868, 44.072012018414775, 55.6160259914476, 34.357011540893474, 28.933701264997342, 6.196049740826876, 250.61183767153508, 158.17997200453456, 25.171658403974202, 54.20281143283813, 116.83444960310806, 127.58966783376542, 222.618545405836, 10.798419613806484, 304.7856247391746, 13.71745186878126, 219.12211190432365, 172.21062606418656, 154.7190579448361, 146.68058589494814, 1.2463987815733353, 19.683774723852494, 42.37135238904104, 335.0012298930744, 260.2408324055375, 231.60951559183906, 36.46713132645735, 208.03713447346107, 189.586512569157, 147.38628011268736, 221.1762482098603, 190.39900257553208, 37.818123374128675, 42.25619091484672, 282.2052028429169, 250.27331713825527, 11.608392301808463, 44.452509247374635, 273.3455996837923, 201.30012183271052, 109.2687728661555, 143.1748569999369, 2.4098108357640786, 161.97715864519864, 92.53432747527555, 34.12349573276596, 113.37039468985687, 34.035192693352634, 151.99565328514947, 236.83286786118907, 257.081312087354, 280.84536331769397, 87.48647347780582, 69.34423868414024, 136.6939315158622, 353.81053448760633, 158.85464303072453, 4.7665115263806515, 142.2980178927376, 154.48180178994528, 100.31567819514514, 85.36107915027416, 7.131346299212007, 62.98304680091677, 77.98495004045976, 127.26106895535234, 228.33110438194564, 180.9728736960319, 168.60500189093207, 150.89044746382896, 162.79854195327516, 171.82994626034184, 126.43952978732699, 1.1860954373430599, 9.600915204695555, 24.286784876767957, 193.17127777914516, 7.972446182300597, 56.932879047647305, 109.35739468660987, 131.9813097156649, 178.33855388859587, 79.69726749380321, 5.098628560767564, 91.46102043305788, 6.232857018741555, 53.39949351546986, 11.343112791615784, 12.26503487261657, 7.978380164503706, 238.76419267261932, 37.34715087813453, 140.64099775028524, 102.6955961819645, 83.77048620889586, 93.60631914955162, 253.88383368729274, 280.02858137653817, 27.397059228558923, 47.06230121699986, 19.685562758956983, 39.35351622903848, 112.14756880265547, 193.73900574460583, 24.61511326416129, 72.09663274680564]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8571567262131978, "mean_inference_ms": 2.6847241087135147, "mean_action_processing_ms": 0.36853787118849285, "mean_env_wait_ms": 0.3008252427785149, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007952570915222168, "StateBufferConnector_ms": 0.004118204116821289, "ViewRequirementAgentConnector_ms": 0.17163169384002686}, "num_episodes": 22, "episode_return_max": 356.48624822446595, "episode_return_min": -54.795253543071695, "episode_return_mean": 146.41933392982446, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 293.55740857918136, "num_env_steps_trained_throughput_per_sec": 293.55740857918136, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 14077.184, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14077.101, "sample_time_ms": 2066.082, "learn_time_ms": 11986.789, "learn_throughput": 333.701, "synch_weights_time_ms": 22.199}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 72, "trial_id": "61e09_00000", "date": "2024-08-16_16-24-28", "timestamp": 1723805668, "time_this_iter_s": 13.666505813598633, "time_total_s": 1068.5267610549927, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b55940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1068.5267610549927, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 61.699999999999996, "ram_util_percent": 81.22105263157894}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.72437243240851, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 0.00010000000000000003, "total_loss": 4.965809263501849, "policy_loss": -0.014542022916838211, "vf_loss": 4.978977716536749, "vf_explained_var": 0.27259351888661665, "kl": 0.021705776214894973, "entropy": 0.5334744644070428, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.48506557808982, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 4.738479251836343, "policy_loss": -0.013460306954575042, "vf_loss": 4.7486997007692935, "vf_explained_var": 0.624895397222862, "kl": 0.010799558115809542, "entropy": 1.0117699920185028, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "env_runners": {"episode_reward_max": 356.48624822446595, "episode_reward_min": -54.795253543071695, "episode_reward_mean": 179.27308640694437, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -469.97372735239856, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 187.0216198354963, "predator_policy": 430.28557050987587}, "policy_reward_mean": {"prey_policy": -31.098786429109804, "predator_policy": 120.73532963258202}, "custom_metrics": {}, "hist_stats": {"episode_reward": [217.19977699180382, 308.27861135494845, 143.10463401506206, 145.59487867085105, 3.93999999999996, 165.24448896046763, -31.902624260340232, 40.611932512892245, 131.4270822943392, 218.33259022058368, -54.795253543071695, 17.262965931283166, 40.108477218694645, 53.3599999999999, 27.353173626341963, 18.920000000000073, 3.8799999999999613, 55.274058397684, 233.8825419604585, 3.9199999999999604, 168.91193768286146, 83.18141752445699, 66.37488579078403, 278.84513375194496, 134.1700000000004, 138.1201755835904, 134.40000000000077, 137.24784935864125, 98.41000000000021, 85.68835215792227, 127.72763334878374, 86.76414216623468, 191.64675893697714, 139.2444147472777, -3.8641423168197235, 6.1985619924190605, 293.77817541365636, 110.66245924255504, 201.1118395624916, 247.1247017122188, 264.9999999999998, 298.6308325252686, 271.513625235263, 231.7333388030672, 260.51743364546184, 87.4500000000002, 237.55965655397728, 233.67000000000004, 219.40891998645785, 262.44167155017834, 194.45349840559962, 160.3925695375357, 226.2899931853537, 141.49714721509514, 172.5485848327806, 155.06000000000006, 356.48624822446595, 210.71063432334728, 350.406229993737, 229.42637546514445, 303.3844723803811, 190.86704793575223, 203.69, 308.8072394964439, 185.49147728281685, 305.0710016412703, 249.90503147619933, 8.251150497646476, 196.90999999999968, 226.68245881238346, 247.18954836362332, 144.1592440608554, 158.72181299202379, 144.32503447790376, 275.76000000000005, 258.7085900685503, 286.5699999999999, 144.0910148416291, 291.4899999999999, 141.79936245984499, 245.98374235491553, 340.57214117720895, 284.11278926745524, 159.3, 265.5198540619025, 133.24307509715, 174.12999999999988, 175.93999999999983, 289.56953393020973, 209.67039970187548, 315.23665993929296, 210.3160124726344, 148.2600000000001, 288.7599999999997, 213.67845998958103, 166.03999999999996, 291.6, 306.6387418204838, 66.4543536036776, 338.47], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-468.4365072023633, 2.0000000000000013, -293.0603959986651, -198.7968312458932, -210.3155336477057, -141.1334365698824, 41.81071502130639, -3.1130251402781495, 0.06258160846381493, -2.3559434315986154, -86.1180450874819, -60.37945121412236, -341.5745182082533, -197.62395219037688, -228.37619439758362, -469.97372735239856, -175.05456566153177, -7.839773918905941, -47.68247190504772, -243.48828808105142, -428.5888803882913, -328.4168483256532, -32.412868877125575, -274.3962090387243, -122.4126725083124, -156.40432061885005, -1.379753939395867, -172.59968191111633, -49.84872688748048, -223.73224204648372, -371.2150186520894, -16.674926497086204, -11.385476918605166, -7.973800354454742, -230.0711357124271, -27.629664351083136, -127.98185041199932, -279.1275618664534, 0.9366601715248598, -7.858977265259037, -213.55326064565782, -10.473013767888022, -18.08258475393901, -59.65806446082909, 9.466177860236556, -186.53626366371424, 18.181363425007927, -6.293515567888115, 57.93275116784353, -2.6606116434970737, 50.80685335359152, -2.659715302342674, -14.792114803325157, 114.06236379750128, -262.60358016242316, -8.940380155005462, 1.2201075965533157, 17.81542256663436, -21.63760319583594, -137.09816208311534, -150.78140604699905, 45.092074376139735, -213.96622383183905, -17.77271060988236, -14.82362545417746, -184.86235357735563, -85.45312456053215, -76.70210453197429, -8.79962028366267, -15.994695538582546, -105.7332034087602, -265.4408168809364, -180.592467942673, -17.47970464104698, 0.7884636296656291, -134.63027018702917, -80.4568912842105, -55.404061835142116, 15.661052938251943, -180.11160201142536, 52.33920884213188, 132.58647686889273, -47.44194191045652, -186.40574554544702, 87.0825697737389, 128.37015391234112, -241.33559968379217, -1.5767830296427745, 15.874227745726678, -7.800423966357286, -0.42981083576408574, -76.5071586451984, 69.62883553929404, 41.27299780664222, 96.74688716958832, -10.482474552797935, -117.07665297771545, -52.342948182164875, -50.42079288112498, -225.06421097374437, -36.102975072206206, 73.72576131585981, -142.25379612854292, -187.85810033739008, 31.97201496137813, 30.69682366687036, -131.3074333337448, -23.97523913384283, -3.3830896814290163, -9.745082831209524, -5.171346299212049, 90.11695319908321, -10.979232285434666, 162.2194615140885, -200.59334375463007, 2.0000000000000013, 59.44550208097614, -28.534721441999977, 33.275164493908946, -138.47727724238158, 106.03231147405927, 69.72653568165182, 166.6134333209097, -9.63408546662076, -123.08127777914505, 125.6275538176994, 106.09884787571201, 36.418117886474796, -66.02419660751052, -58.80418971393336, 76.60730348513395, 143.66780210156568, 73.52360413211042, 78.68754989228965, -55.45712210176743, -1.0343337076719934, -10.35503487261661, 187.0216198354963, -96.29325360752082, 46.86436886915067, -47.394462411815255, 51.2474168431889, -17.696164443161756, -15.521396854430208, -84.94537316508237, -290.2452289067247, 0.9378114343866523, 68.92786259795821, 122.76443724104308, 93.95648377096154, -69.3374228276537, 22.159438348942768, 114.83488673583878, 75.02336725319432, -18.15383498716858, -17.718024380128085, 90.00126849844662, 137.15520933761374, 30.529840302594287, -60.235070606881486, 65.30173576774418, 63.80357658203544, 87.34403737593223, 10.944492104934527, 39.04775331964931, 68.86455146356809, 130.61191925675968, 2.0000000000000013, 107.90635914330159, 3.471210795129455, -2.2877272022794894, 94.90682093171192, 2.0000000000000013, 150.4319543907155, 126.70122375228729, -5.519886014099812, 55.1995083086554, 11.519010203230513, 101.42305058544261, 0.4164421781874121, 113.3748838676253, 112.86187511402507, -12.022606244704841, -174.9884694948223, -9.415807953271326, 108.49606096161892, 120.78432056650011, 122.78648454514213, -112.14298243664689, -22.38332125660925, 0.9327197932287575, 127.26471103575727, 99.4247559268121, 117.7094639937071, 139.79771028443182, 32.38152453702671, -4.70145796934795, -167.10730451452818, 142.03840306211453, 180.0727040991923], "policy_predator_policy_reward": [430.28557050987587, 253.35071368429166, 428.2990753375963, 371.83676326191, 321.27219485198736, 173.28140938066264, 54.11934797368423, 52.777840816138564, 1.9174183915361867, 4.315943431598574, 3.953934389606475, 307.78805087246565, 332.0967751981247, 175.19907094016486, 406.76757920506793, 332.19427505780715, 205.96839108357773, 108.35303079119863, 223.7110374359786, 285.7923127707042, 427.51490907619365, 274.6955660946787, 17.44204952873984, 306.6299943183933, 35.269448496670584, 283.6560218491865, 197.98912337132046, 29.35031247919172, 0.9395933844091894, 299.99454917589713, 388.2850186520894, 18.524926497086494, 13.305476918605125, 9.9338003544547, 184.81245111372718, 128.16240734746725, 357.3477898570815, 283.6441643818291, 1.0533398284751416, 9.788977265258996, 212.47095762762115, 180.46725446878597, 15.65134668383984, 145.2707200553849, 1.8636426219567033, 241.58132897230513, 145.6891712185136, 121.26811467631202, 34.82584845723868, 44.072012018414775, 55.6160259914476, 34.357011540893474, 28.933701264997342, 6.196049740826876, 250.61183767153508, 158.17997200453456, 25.171658403974202, 54.20281143283813, 116.83444960310806, 127.58966783376542, 222.618545405836, 10.798419613806484, 304.7856247391746, 13.71745186878126, 219.12211190432365, 172.21062606418656, 154.7190579448361, 146.68058589494814, 1.2463987815733353, 19.683774723852494, 42.37135238904104, 335.0012298930744, 260.2408324055375, 231.60951559183906, 36.46713132645735, 208.03713447346107, 189.586512569157, 147.38628011268736, 221.1762482098603, 190.39900257553208, 37.818123374128675, 42.25619091484672, 282.2052028429169, 250.27331713825527, 11.608392301808463, 44.452509247374635, 273.3455996837923, 201.30012183271052, 109.2687728661555, 143.1748569999369, 2.4098108357640786, 161.97715864519864, 92.53432747527555, 34.12349573276596, 113.37039468985687, 34.035192693352634, 151.99565328514947, 236.83286786118907, 257.081312087354, 280.84536331769397, 87.48647347780582, 69.34423868414024, 136.6939315158622, 353.81053448760633, 158.85464303072453, 4.7665115263806515, 142.2980178927376, 154.48180178994528, 100.31567819514514, 85.36107915027416, 7.131346299212007, 62.98304680091677, 77.98495004045976, 127.26106895535234, 228.33110438194564, 180.9728736960319, 168.60500189093207, 150.89044746382896, 162.79854195327516, 171.82994626034184, 126.43952978732699, 1.1860954373430599, 9.600915204695555, 24.286784876767957, 193.17127777914516, 7.972446182300597, 56.932879047647305, 109.35739468660987, 131.9813097156649, 178.33855388859587, 79.69726749380321, 5.098628560767564, 91.46102043305788, 6.232857018741555, 53.39949351546986, 11.343112791615784, 12.26503487261657, 7.978380164503706, 238.76419267261932, 37.34715087813453, 140.64099775028524, 102.6955961819645, 83.77048620889586, 93.60631914955162, 253.88383368729274, 280.02858137653817, 27.397059228558923, 47.06230121699986, 19.685562758956983, 39.35351622903848, 112.14756880265547, 193.73900574460583, 24.61511326416129, 72.09663274680564, 62.1384827663291, 117.82439144259685, 53.27802194623086, 11.055500217708714, 83.49839754446865, 88.0061952196628, 63.96826423225583, 52.91016577287997, 132.23367524659602, 110.0499364497463, 72.97175089024513, 103.22873359399276, 26.688080743240388, 0.0, 39.50585336824912, 114.63643075522258, 15.870867699609262, 24.75311366810789, 17.165760166828488, 4.532285442456002, 47.30877624771272, 7.4498860140997705, 110.16234331051027, 112.68867210781342, 74.97486952892865, 32.85603740931726, 55.746629659696346, 33.25327129794624, 172.76593653620287, 224.56115167595883, 27.220522357444633, 21.959224634207718, 13.61078275769623, 31.578412130661683, 197.9775713104432, 150.2271923723939, 10.657708325809157, 27.184860845204813, 53.400567567825966, 21.065212511654945, 102.99308561431265, 31.466421384712767, 191.1935826815276, 47.069533406026, 6.51002926853882, 9.848863570154329]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8551940344917525, "mean_inference_ms": 2.6844248411425173, "mean_action_processing_ms": 0.3677652185379368, "mean_env_wait_ms": 0.3000065045891689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009401917457580566, "StateBufferConnector_ms": 0.004145622253417969, "ViewRequirementAgentConnector_ms": 0.13320088386535645}, "num_episodes": 23, "episode_return_max": 356.48624822446595, "episode_return_min": -54.795253543071695, "episode_return_mean": 179.27308640694437, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 273.54517928440674, "num_env_steps_trained_throughput_per_sec": 273.54517928440674, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 1168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 14160.029, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14159.944, "sample_time_ms": 2078.12, "learn_time_ms": 12056.283, "learn_throughput": 331.777, "synch_weights_time_ms": 23.419}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "done": false, "training_iteration": 73, "trial_id": "61e09_00000", "date": "2024-08-16_16-24-43", "timestamp": 1723805683, "time_this_iter_s": 14.65339708328247, "time_total_s": 1083.1801581382751, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x300237d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1083.1801581382751, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 62.976190476190474, "ram_util_percent": 81.63809523809525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.735354810417014, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 0.00010000000000000003, "total_loss": 4.6335940975360765, "policy_loss": -0.013849550583547662, "vf_loss": 4.645340348425366, "vf_explained_var": 0.18428159252045648, "kl": 0.02215821171602002, "entropy": 0.5231730769708673, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.611601728673965, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 3.502056968149054, "policy_loss": -0.009459417712475573, "vf_loss": 3.5091707642116243, "vf_explained_var": 0.4803129459499682, "kl": 0.007818755260006945, "entropy": 1.0569656796240934, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "env_runners": {"episode_reward_max": 358.3993907270517, "episode_reward_min": -3.8641423168197235, "episode_reward_mean": 207.53714365732856, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -290.2452289067247, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 187.0216198354963, "predator_policy": 357.3477898570815}, "policy_reward_mean": {"prey_policy": 8.642093846962998, "predator_policy": 95.12647798170129}, "custom_metrics": {}, "hist_stats": {"episode_reward": [233.8825419604585, 3.9199999999999604, 168.91193768286146, 83.18141752445699, 66.37488579078403, 278.84513375194496, 134.1700000000004, 138.1201755835904, 134.40000000000077, 137.24784935864125, 98.41000000000021, 85.68835215792227, 127.72763334878374, 86.76414216623468, 191.64675893697714, 139.2444147472777, -3.8641423168197235, 6.1985619924190605, 293.77817541365636, 110.66245924255504, 201.1118395624916, 247.1247017122188, 264.9999999999998, 298.6308325252686, 271.513625235263, 231.7333388030672, 260.51743364546184, 87.4500000000002, 237.55965655397728, 233.67000000000004, 219.40891998645785, 262.44167155017834, 194.45349840559962, 160.3925695375357, 226.2899931853537, 141.49714721509514, 172.5485848327806, 155.06000000000006, 356.48624822446595, 210.71063432334728, 350.406229993737, 229.42637546514445, 303.3844723803811, 190.86704793575223, 203.69, 308.8072394964439, 185.49147728281685, 305.0710016412703, 249.90503147619933, 8.251150497646476, 196.90999999999968, 226.68245881238346, 247.18954836362332, 144.1592440608554, 158.72181299202379, 144.32503447790376, 275.76000000000005, 258.7085900685503, 286.5699999999999, 144.0910148416291, 291.4899999999999, 141.79936245984499, 245.98374235491553, 340.57214117720895, 284.11278926745524, 159.3, 265.5198540619025, 133.24307509715, 174.12999999999988, 175.93999999999983, 289.56953393020973, 209.67039970187548, 315.23665993929296, 210.3160124726344, 148.2600000000001, 288.7599999999997, 213.67845998958103, 166.03999999999996, 291.6, 306.6387418204838, 66.4543536036776, 338.47, 315.22788638251984, 338.57403371307555, 358.3993907270517, 305.62027534957735, 168.06065633847106, 345.683337272432, 290.9195722437836, 298.0602705859585, 192.94017345832378, 87.35000000000036, 170.90029011768237, 76.72060855669707, 317.9803475793897, 172.4189245727305, 176.9799999999998, 352.28999999999996, 193.06998366982918, 168.404766862434], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-127.98185041199932, -279.1275618664534, 0.9366601715248598, -7.858977265259037, -213.55326064565782, -10.473013767888022, -18.08258475393901, -59.65806446082909, 9.466177860236556, -186.53626366371424, 18.181363425007927, -6.293515567888115, 57.93275116784353, -2.6606116434970737, 50.80685335359152, -2.659715302342674, -14.792114803325157, 114.06236379750128, -262.60358016242316, -8.940380155005462, 1.2201075965533157, 17.81542256663436, -21.63760319583594, -137.09816208311534, -150.78140604699905, 45.092074376139735, -213.96622383183905, -17.77271060988236, -14.82362545417746, -184.86235357735563, -85.45312456053215, -76.70210453197429, -8.79962028366267, -15.994695538582546, -105.7332034087602, -265.4408168809364, -180.592467942673, -17.47970464104698, 0.7884636296656291, -134.63027018702917, -80.4568912842105, -55.404061835142116, 15.661052938251943, -180.11160201142536, 52.33920884213188, 132.58647686889273, -47.44194191045652, -186.40574554544702, 87.0825697737389, 128.37015391234112, -241.33559968379217, -1.5767830296427745, 15.874227745726678, -7.800423966357286, -0.42981083576408574, -76.5071586451984, 69.62883553929404, 41.27299780664222, 96.74688716958832, -10.482474552797935, -117.07665297771545, -52.342948182164875, -50.42079288112498, -225.06421097374437, -36.102975072206206, 73.72576131585981, -142.25379612854292, -187.85810033739008, 31.97201496137813, 30.69682366687036, -131.3074333337448, -23.97523913384283, -3.3830896814290163, -9.745082831209524, -5.171346299212049, 90.11695319908321, -10.979232285434666, 162.2194615140885, -200.59334375463007, 2.0000000000000013, 59.44550208097614, -28.534721441999977, 33.275164493908946, -138.47727724238158, 106.03231147405927, 69.72653568165182, 166.6134333209097, -9.63408546662076, -123.08127777914505, 125.6275538176994, 106.09884787571201, 36.418117886474796, -66.02419660751052, -58.80418971393336, 76.60730348513395, 143.66780210156568, 73.52360413211042, 78.68754989228965, -55.45712210176743, -1.0343337076719934, -10.35503487261661, 187.0216198354963, -96.29325360752082, 46.86436886915067, -47.394462411815255, 51.2474168431889, -17.696164443161756, -15.521396854430208, -84.94537316508237, -290.2452289067247, 0.9378114343866523, 68.92786259795821, 122.76443724104308, 93.95648377096154, -69.3374228276537, 22.159438348942768, 114.83488673583878, 75.02336725319432, -18.15383498716858, -17.718024380128085, 90.00126849844662, 137.15520933761374, 30.529840302594287, -60.235070606881486, 65.30173576774418, 63.80357658203544, 87.34403737593223, 10.944492104934527, 39.04775331964931, 68.86455146356809, 130.61191925675968, 2.0000000000000013, 107.90635914330159, 3.471210795129455, -2.2877272022794894, 94.90682093171192, 2.0000000000000013, 150.4319543907155, 126.70122375228729, -5.519886014099812, 55.1995083086554, 11.519010203230513, 101.42305058544261, 0.4164421781874121, 113.3748838676253, 112.86187511402507, -12.022606244704841, -174.9884694948223, -9.415807953271326, 108.49606096161892, 120.78432056650011, 122.78648454514213, -112.14298243664689, -22.38332125660925, 0.9327197932287575, 127.26471103575727, 99.4247559268121, 117.7094639937071, 139.79771028443182, 32.38152453702671, -4.70145796934795, -167.10730451452818, 142.03840306211453, 180.0727040991923, 100.85767861142303, 140.8268174145179, 155.28809012531198, 111.50373784101751, 140.69037932026004, 146.4338496158393, 84.89850292503385, 73.97941588279075, -10.741612234664206, 165.43378026809134, 90.231485153316, 173.44533609184055, 66.62076270801168, 63.37706049617414, 154.0911578554937, 38.52109160795099, 2.0000000000000013, 101.23649390611425, -1.4962473116814679, -13.17041380138831, 1.054161335864795, 74.10053530186788, -190.21990533551542, -23.632777862100163, 119.77982942062464, 116.18648251625487, 88.48374834274664, -14.965503706336737, -2.115004425708766, 85.75534863058334, 166.92600747161993, 149.72927814587007, 106.719699716165, -228.94135492894856, 140.28311643864959, -11.586563973077855], "policy_predator_policy_reward": [357.3477898570815, 283.6441643818291, 1.0533398284751416, 9.788977265258996, 212.47095762762115, 180.46725446878597, 15.65134668383984, 145.2707200553849, 1.8636426219567033, 241.58132897230513, 145.6891712185136, 121.26811467631202, 34.82584845723868, 44.072012018414775, 55.6160259914476, 34.357011540893474, 28.933701264997342, 6.196049740826876, 250.61183767153508, 158.17997200453456, 25.171658403974202, 54.20281143283813, 116.83444960310806, 127.58966783376542, 222.618545405836, 10.798419613806484, 304.7856247391746, 13.71745186878126, 219.12211190432365, 172.21062606418656, 154.7190579448361, 146.68058589494814, 1.2463987815733353, 19.683774723852494, 42.37135238904104, 335.0012298930744, 260.2408324055375, 231.60951559183906, 36.46713132645735, 208.03713447346107, 189.586512569157, 147.38628011268736, 221.1762482098603, 190.39900257553208, 37.818123374128675, 42.25619091484672, 282.2052028429169, 250.27331713825527, 11.608392301808463, 44.452509247374635, 273.3455996837923, 201.30012183271052, 109.2687728661555, 143.1748569999369, 2.4098108357640786, 161.97715864519864, 92.53432747527555, 34.12349573276596, 113.37039468985687, 34.035192693352634, 151.99565328514947, 236.83286786118907, 257.081312087354, 280.84536331769397, 87.48647347780582, 69.34423868414024, 136.6939315158622, 353.81053448760633, 158.85464303072453, 4.7665115263806515, 142.2980178927376, 154.48180178994528, 100.31567819514514, 85.36107915027416, 7.131346299212007, 62.98304680091677, 77.98495004045976, 127.26106895535234, 228.33110438194564, 180.9728736960319, 168.60500189093207, 150.89044746382896, 162.79854195327516, 171.82994626034184, 126.43952978732699, 1.1860954373430599, 9.600915204695555, 24.286784876767957, 193.17127777914516, 7.972446182300597, 56.932879047647305, 109.35739468660987, 131.9813097156649, 178.33855388859587, 79.69726749380321, 5.098628560767564, 91.46102043305788, 6.232857018741555, 53.39949351546986, 11.343112791615784, 12.26503487261657, 7.978380164503706, 238.76419267261932, 37.34715087813453, 140.64099775028524, 102.6955961819645, 83.77048620889586, 93.60631914955162, 253.88383368729274, 280.02858137653817, 27.397059228558923, 47.06230121699986, 19.685562758956983, 39.35351622903848, 112.14756880265547, 193.73900574460583, 24.61511326416129, 72.09663274680564, 62.1384827663291, 117.82439144259685, 53.27802194623086, 11.055500217708714, 83.49839754446865, 88.0061952196628, 63.96826423225583, 52.91016577287997, 132.23367524659602, 110.0499364497463, 72.97175089024513, 103.22873359399276, 26.688080743240388, 0.0, 39.50585336824912, 114.63643075522258, 15.870867699609262, 24.75311366810789, 17.165760166828488, 4.532285442456002, 47.30877624771272, 7.4498860140997705, 110.16234331051027, 112.68867210781342, 74.97486952892865, 32.85603740931726, 55.746629659696346, 33.25327129794624, 172.76593653620287, 224.56115167595883, 27.220522357444633, 21.959224634207718, 13.61078275769623, 31.578412130661683, 197.9775713104432, 150.2271923723939, 10.657708325809157, 27.184860845204813, 53.400567567825966, 21.065212511654945, 102.99308561431265, 31.466421384712767, 191.1935826815276, 47.069533406026, 6.51002926853882, 9.848863570154329, 41.64627630421867, 31.8971140523601, 8.230449281399991, 63.5517564653461, 43.951232225712275, 27.323929565240064, 76.6202656329436, 70.12209090880923, 0.0, 13.368488305043957, 78.768514846684, 3.238001180591469, 74.15517205275344, 86.76657698684437, 61.18729956051329, 44.26072156200055, 49.98815504149188, 39.71552451071794, 82.55743446280226, 19.459226650267503, 41.67725669366554, 54.068336786284036, 86.63284537638475, 203.9404463779278, 30.450170579375374, 51.56386506313496, 38.4338247184906, 60.46685521783021, 4.075004425708726, 89.26465136941667, 2.3639925283800545, 33.270721854129945, 20.1761012524652, 295.1155376301476, 23.41892059633754, 16.289293800524803]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.854020095767155, "mean_inference_ms": 2.678356790168816, "mean_action_processing_ms": 0.36674007940234005, "mean_env_wait_ms": 0.299722571955645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008296370506286621, "StateBufferConnector_ms": 0.0035483837127685547, "ViewRequirementAgentConnector_ms": 0.1403350830078125}, "num_episodes": 18, "episode_return_max": 358.3993907270517, "episode_return_min": -3.8641423168197235, "episode_return_mean": 207.53714365732856, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.77934663317774, "num_env_steps_trained_throughput_per_sec": 292.77934663317774, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 1184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 14140.657, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14140.573, "sample_time_ms": 2081.138, "learn_time_ms": 12033.949, "learn_throughput": 332.393, "synch_weights_time_ms": 23.192}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "training_iteration": 74, "trial_id": "61e09_00000", "date": "2024-08-16_16-24-57", "timestamp": 1723805697, "time_this_iter_s": 13.727874040603638, "time_total_s": 1096.9080321788788, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3002555e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1096.9080321788788, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 65.24736842105264, "ram_util_percent": 81.75263157894737}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.843858644949696, "cur_kl_coeff": 0.14238281249999993, "cur_lr": 0.00010000000000000003, "total_loss": 3.5182711717312927, "policy_loss": -0.008484369020406453, "vf_loss": 3.525975368641041, "vf_explained_var": 0.12331260843251748, "kl": 0.00547939472284085, "entropy": 0.493051176711365, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5283357708857803, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 2.3279154650748723, "policy_loss": -0.007836407083012755, "vf_loss": 2.3337866615366054, "vf_explained_var": 0.7394121115485196, "kl": 0.00655071491815446, "entropy": 1.103382295969302, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 363.7541985382144, "episode_reward_min": 3.9599999999999596, "episode_reward_mean": 229.58664177018738, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -290.2452289067247, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 187.0216198354963, "predator_policy": 353.81053448760633}, "policy_reward_mean": {"prey_policy": 32.08360738060803, "predator_policy": 82.70971350448568}, "custom_metrics": {}, "hist_stats": {"episode_reward": [293.77817541365636, 110.66245924255504, 201.1118395624916, 247.1247017122188, 264.9999999999998, 298.6308325252686, 271.513625235263, 231.7333388030672, 260.51743364546184, 87.4500000000002, 237.55965655397728, 233.67000000000004, 219.40891998645785, 262.44167155017834, 194.45349840559962, 160.3925695375357, 226.2899931853537, 141.49714721509514, 172.5485848327806, 155.06000000000006, 356.48624822446595, 210.71063432334728, 350.406229993737, 229.42637546514445, 303.3844723803811, 190.86704793575223, 203.69, 308.8072394964439, 185.49147728281685, 305.0710016412703, 249.90503147619933, 8.251150497646476, 196.90999999999968, 226.68245881238346, 247.18954836362332, 144.1592440608554, 158.72181299202379, 144.32503447790376, 275.76000000000005, 258.7085900685503, 286.5699999999999, 144.0910148416291, 291.4899999999999, 141.79936245984499, 245.98374235491553, 340.57214117720895, 284.11278926745524, 159.3, 265.5198540619025, 133.24307509715, 174.12999999999988, 175.93999999999983, 289.56953393020973, 209.67039970187548, 315.23665993929296, 210.3160124726344, 148.2600000000001, 288.7599999999997, 213.67845998958103, 166.03999999999996, 291.6, 306.6387418204838, 66.4543536036776, 338.47, 315.22788638251984, 338.57403371307555, 358.3993907270517, 305.62027534957735, 168.06065633847106, 345.683337272432, 290.9195722437836, 298.0602705859585, 192.94017345832378, 87.35000000000036, 170.90029011768237, 76.72060855669707, 317.9803475793897, 172.4189245727305, 176.9799999999998, 352.28999999999996, 193.06998366982918, 168.404766862434, 122.9700000000002, 363.7541985382144, 303.1061270048335, 348.7721696212046, 183.9199999999998, 241.5729664138641, 347.33000000000004, 314.53000000000003, 154.90000000000003, 311.178401466883, 181.98999999999978, 285.4, 192.0050475939189, 235.71000890149682, 3.9599999999999596, 271.40000000000003, 139.89462043658756, 313.4259339944116], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-180.592467942673, -17.47970464104698, 0.7884636296656291, -134.63027018702917, -80.4568912842105, -55.404061835142116, 15.661052938251943, -180.11160201142536, 52.33920884213188, 132.58647686889273, -47.44194191045652, -186.40574554544702, 87.0825697737389, 128.37015391234112, -241.33559968379217, -1.5767830296427745, 15.874227745726678, -7.800423966357286, -0.42981083576408574, -76.5071586451984, 69.62883553929404, 41.27299780664222, 96.74688716958832, -10.482474552797935, -117.07665297771545, -52.342948182164875, -50.42079288112498, -225.06421097374437, -36.102975072206206, 73.72576131585981, -142.25379612854292, -187.85810033739008, 31.97201496137813, 30.69682366687036, -131.3074333337448, -23.97523913384283, -3.3830896814290163, -9.745082831209524, -5.171346299212049, 90.11695319908321, -10.979232285434666, 162.2194615140885, -200.59334375463007, 2.0000000000000013, 59.44550208097614, -28.534721441999977, 33.275164493908946, -138.47727724238158, 106.03231147405927, 69.72653568165182, 166.6134333209097, -9.63408546662076, -123.08127777914505, 125.6275538176994, 106.09884787571201, 36.418117886474796, -66.02419660751052, -58.80418971393336, 76.60730348513395, 143.66780210156568, 73.52360413211042, 78.68754989228965, -55.45712210176743, -1.0343337076719934, -10.35503487261661, 187.0216198354963, -96.29325360752082, 46.86436886915067, -47.394462411815255, 51.2474168431889, -17.696164443161756, -15.521396854430208, -84.94537316508237, -290.2452289067247, 0.9378114343866523, 68.92786259795821, 122.76443724104308, 93.95648377096154, -69.3374228276537, 22.159438348942768, 114.83488673583878, 75.02336725319432, -18.15383498716858, -17.718024380128085, 90.00126849844662, 137.15520933761374, 30.529840302594287, -60.235070606881486, 65.30173576774418, 63.80357658203544, 87.34403737593223, 10.944492104934527, 39.04775331964931, 68.86455146356809, 130.61191925675968, 2.0000000000000013, 107.90635914330159, 3.471210795129455, -2.2877272022794894, 94.90682093171192, 2.0000000000000013, 150.4319543907155, 126.70122375228729, -5.519886014099812, 55.1995083086554, 11.519010203230513, 101.42305058544261, 0.4164421781874121, 113.3748838676253, 112.86187511402507, -12.022606244704841, -174.9884694948223, -9.415807953271326, 108.49606096161892, 120.78432056650011, 122.78648454514213, -112.14298243664689, -22.38332125660925, 0.9327197932287575, 127.26471103575727, 99.4247559268121, 117.7094639937071, 139.79771028443182, 32.38152453702671, -4.70145796934795, -167.10730451452818, 142.03840306211453, 180.0727040991923, 100.85767861142303, 140.8268174145179, 155.28809012531198, 111.50373784101751, 140.69037932026004, 146.4338496158393, 84.89850292503385, 73.97941588279075, -10.741612234664206, 165.43378026809134, 90.231485153316, 173.44533609184055, 66.62076270801168, 63.37706049617414, 154.0911578554937, 38.52109160795099, 2.0000000000000013, 101.23649390611425, -1.4962473116814679, -13.17041380138831, 1.054161335864795, 74.10053530186788, -190.21990533551542, -23.632777862100163, 119.77982942062464, 116.18648251625487, 88.48374834274664, -14.965503706336737, -2.115004425708766, 85.75534863058334, 166.92600747161993, 149.72927814587007, 106.719699716165, -228.94135492894856, 140.28311643864959, -11.586563973077855, -87.88211539720078, -2.9232859637800246, 160.49324443915418, 162.65628216634573, 123.35843278561843, 149.4258754821695, 171.76040676201927, 142.48660866760534, 160.9815479718003, -5.3844136664066164, 162.373588779927, -99.55635359183415, 152.76765595831773, 148.76666521666033, 137.210497508345, 122.63944343071054, -8.09301231509062, 84.39709716810466, 102.52497351244625, 139.38052602899648, 103.1021518854235, 0.923518706626343, 131.06107599921546, 45.2022651586807, 0.9729501104514559, 2.1054564735670454, -29.932591112248513, 28.15805902725296, -4.321295017354446, 2.0000000000000013, 36.81826461296356, 116.09608903290153, 2.0000000000000013, -46.76837834672011, 122.24798795732657, 76.48011713817073], "policy_predator_policy_reward": [260.2408324055375, 231.60951559183906, 36.46713132645735, 208.03713447346107, 189.586512569157, 147.38628011268736, 221.1762482098603, 190.39900257553208, 37.818123374128675, 42.25619091484672, 282.2052028429169, 250.27331713825527, 11.608392301808463, 44.452509247374635, 273.3455996837923, 201.30012183271052, 109.2687728661555, 143.1748569999369, 2.4098108357640786, 161.97715864519864, 92.53432747527555, 34.12349573276596, 113.37039468985687, 34.035192693352634, 151.99565328514947, 236.83286786118907, 257.081312087354, 280.84536331769397, 87.48647347780582, 69.34423868414024, 136.6939315158622, 353.81053448760633, 158.85464303072453, 4.7665115263806515, 142.2980178927376, 154.48180178994528, 100.31567819514514, 85.36107915027416, 7.131346299212007, 62.98304680091677, 77.98495004045976, 127.26106895535234, 228.33110438194564, 180.9728736960319, 168.60500189093207, 150.89044746382896, 162.79854195327516, 171.82994626034184, 126.43952978732699, 1.1860954373430599, 9.600915204695555, 24.286784876767957, 193.17127777914516, 7.972446182300597, 56.932879047647305, 109.35739468660987, 131.9813097156649, 178.33855388859587, 79.69726749380321, 5.098628560767564, 91.46102043305788, 6.232857018741555, 53.39949351546986, 11.343112791615784, 12.26503487261657, 7.978380164503706, 238.76419267261932, 37.34715087813453, 140.64099775028524, 102.6955961819645, 83.77048620889586, 93.60631914955162, 253.88383368729274, 280.02858137653817, 27.397059228558923, 47.06230121699986, 19.685562758956983, 39.35351622903848, 112.14756880265547, 193.73900574460583, 24.61511326416129, 72.09663274680564, 62.1384827663291, 117.82439144259685, 53.27802194623086, 11.055500217708714, 83.49839754446865, 88.0061952196628, 63.96826423225583, 52.91016577287997, 132.23367524659602, 110.0499364497463, 72.97175089024513, 103.22873359399276, 26.688080743240388, 0.0, 39.50585336824912, 114.63643075522258, 15.870867699609262, 24.75311366810789, 17.165760166828488, 4.532285442456002, 47.30877624771272, 7.4498860140997705, 110.16234331051027, 112.68867210781342, 74.97486952892865, 32.85603740931726, 55.746629659696346, 33.25327129794624, 172.76593653620287, 224.56115167595883, 27.220522357444633, 21.959224634207718, 13.61078275769623, 31.578412130661683, 197.9775713104432, 150.2271923723939, 10.657708325809157, 27.184860845204813, 53.400567567825966, 21.065212511654945, 102.99308561431265, 31.466421384712767, 191.1935826815276, 47.069533406026, 6.51002926853882, 9.848863570154329, 41.64627630421867, 31.8971140523601, 8.230449281399991, 63.5517564653461, 43.951232225712275, 27.323929565240064, 76.6202656329436, 70.12209090880923, 0.0, 13.368488305043957, 78.768514846684, 3.238001180591469, 74.15517205275344, 86.76657698684437, 61.18729956051329, 44.26072156200055, 49.98815504149188, 39.71552451071794, 82.55743446280226, 19.459226650267503, 41.67725669366554, 54.068336786284036, 86.63284537638475, 203.9404463779278, 30.450170579375374, 51.56386506313496, 38.4338247184906, 60.46685521783021, 4.075004425708726, 89.26465136941667, 2.3639925283800545, 33.270721854129945, 20.1761012524652, 295.1155376301476, 23.41892059633754, 16.289293800524803, 29.23018737147145, 184.5452139895093, 19.260954099060186, 21.343717833654264, 11.833994170465127, 18.48782456658051, 5.861762859185341, 28.66339133239469, 5.096544780094798, 23.226320914511497, 35.872263495834744, 142.8834677299361, 7.562344041682254, 38.23333478333967, 5.319502491654989, 49.36055656928946, 51.05172414479514, 27.544191002190768, 24.45282458069071, 44.82007734474954, 76.8978481145765, 1.0664812933736585, 20.328924000784586, 88.8077348413193, 64.63203435214, 124.2946066577607, 165.7756433050134, 71.70889768147913, 6.281295017354404, 0.0, 56.628433698909, 61.85721265522589, 174.77860283014687, 9.884395953160649, 25.144363492344734, 89.55346540656956]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8529331473796293, "mean_inference_ms": 2.6769880635840537, "mean_action_processing_ms": 0.3661621885070589, "mean_env_wait_ms": 0.29942074370074545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007718324661254883, "StateBufferConnector_ms": 0.0035043954849243164, "ViewRequirementAgentConnector_ms": 0.1443880796432495}, "num_episodes": 18, "episode_return_max": 363.7541985382144, "episode_return_min": 3.9599999999999596, "episode_return_mean": 229.58664177018738, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 289.03586031414557, "num_env_steps_trained_throughput_per_sec": 289.03586031414557, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 14123.606, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14123.52, "sample_time_ms": 2087.656, "learn_time_ms": 12011.043, "learn_throughput": 333.027, "synch_weights_time_ms": 22.332}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 75, "trial_id": "61e09_00000", "date": "2024-08-16_16-25-11", "timestamp": 1723805711, "time_this_iter_s": 13.89044189453125, "time_total_s": 1110.79847407341, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x300255dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1110.79847407341, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 63.15, "ram_util_percent": 81.69}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.443146639778501, "cur_kl_coeff": 0.14238281249999993, "cur_lr": 0.00010000000000000003, "total_loss": 2.5471174908693506, "policy_loss": -0.005516159357798715, "vf_loss": 2.5518573914886153, "vf_explained_var": 0.08678276043720347, "kl": 0.005451884071722965, "entropy": 0.48889130500573963, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.240569483224677, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 2.6723439147863437, "policy_loss": -0.009366298236923597, "vf_loss": 2.679814569849186, "vf_explained_var": 0.6070247571935099, "kl": 0.0063188333675482065, "entropy": 1.0494748405678562, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "env_runners": {"episode_reward_max": 363.7541985382144, "episode_reward_min": 3.9599999999999596, "episode_reward_mean": 230.0068304074453, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -317.9073720498567, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 187.0216198354963, "predator_policy": 352.9673720498567}, "policy_reward_mean": {"prey_policy": 52.27888504629054, "predator_policy": 62.72453015743213}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.406229993737, 229.42637546514445, 303.3844723803811, 190.86704793575223, 203.69, 308.8072394964439, 185.49147728281685, 305.0710016412703, 249.90503147619933, 8.251150497646476, 196.90999999999968, 226.68245881238346, 247.18954836362332, 144.1592440608554, 158.72181299202379, 144.32503447790376, 275.76000000000005, 258.7085900685503, 286.5699999999999, 144.0910148416291, 291.4899999999999, 141.79936245984499, 245.98374235491553, 340.57214117720895, 284.11278926745524, 159.3, 265.5198540619025, 133.24307509715, 174.12999999999988, 175.93999999999983, 289.56953393020973, 209.67039970187548, 315.23665993929296, 210.3160124726344, 148.2600000000001, 288.7599999999997, 213.67845998958103, 166.03999999999996, 291.6, 306.6387418204838, 66.4543536036776, 338.47, 315.22788638251984, 338.57403371307555, 358.3993907270517, 305.62027534957735, 168.06065633847106, 345.683337272432, 290.9195722437836, 298.0602705859585, 192.94017345832378, 87.35000000000036, 170.90029011768237, 76.72060855669707, 317.9803475793897, 172.4189245727305, 176.9799999999998, 352.28999999999996, 193.06998366982918, 168.404766862434, 122.9700000000002, 363.7541985382144, 303.1061270048335, 348.7721696212046, 183.9199999999998, 241.5729664138641, 347.33000000000004, 314.53000000000003, 154.90000000000003, 311.178401466883, 181.98999999999978, 285.4, 192.0050475939189, 235.71000890149682, 3.9599999999999596, 271.40000000000003, 139.89462043658756, 313.4259339944116, 186.3396296169687, 319.9711701548964, 158.05, 264.75484279273354, 174.82658684722514, 173.91999999999985, 324.53000000000003, 133.62220042917616, 321.45, 317.42874425496257, 220.76933046605765, 140.15000000000015, 200.39974014638995, 163.20999999999998, 6.912048315463487, 158.65383092784623, 316.60337230767533, 161.99999999999997, 173.5862190356296, 333.4690561145668, 327.15999999999997, 302.2534222709746], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [59.44550208097614, -28.534721441999977, 33.275164493908946, -138.47727724238158, 106.03231147405927, 69.72653568165182, 166.6134333209097, -9.63408546662076, -123.08127777914505, 125.6275538176994, 106.09884787571201, 36.418117886474796, -66.02419660751052, -58.80418971393336, 76.60730348513395, 143.66780210156568, 73.52360413211042, 78.68754989228965, -55.45712210176743, -1.0343337076719934, -10.35503487261661, 187.0216198354963, -96.29325360752082, 46.86436886915067, -47.394462411815255, 51.2474168431889, -17.696164443161756, -15.521396854430208, -84.94537316508237, -290.2452289067247, 0.9378114343866523, 68.92786259795821, 122.76443724104308, 93.95648377096154, -69.3374228276537, 22.159438348942768, 114.83488673583878, 75.02336725319432, -18.15383498716858, -17.718024380128085, 90.00126849844662, 137.15520933761374, 30.529840302594287, -60.235070606881486, 65.30173576774418, 63.80357658203544, 87.34403737593223, 10.944492104934527, 39.04775331964931, 68.86455146356809, 130.61191925675968, 2.0000000000000013, 107.90635914330159, 3.471210795129455, -2.2877272022794894, 94.90682093171192, 2.0000000000000013, 150.4319543907155, 126.70122375228729, -5.519886014099812, 55.1995083086554, 11.519010203230513, 101.42305058544261, 0.4164421781874121, 113.3748838676253, 112.86187511402507, -12.022606244704841, -174.9884694948223, -9.415807953271326, 108.49606096161892, 120.78432056650011, 122.78648454514213, -112.14298243664689, -22.38332125660925, 0.9327197932287575, 127.26471103575727, 99.4247559268121, 117.7094639937071, 139.79771028443182, 32.38152453702671, -4.70145796934795, -167.10730451452818, 142.03840306211453, 180.0727040991923, 100.85767861142303, 140.8268174145179, 155.28809012531198, 111.50373784101751, 140.69037932026004, 146.4338496158393, 84.89850292503385, 73.97941588279075, -10.741612234664206, 165.43378026809134, 90.231485153316, 173.44533609184055, 66.62076270801168, 63.37706049617414, 154.0911578554937, 38.52109160795099, 2.0000000000000013, 101.23649390611425, -1.4962473116814679, -13.17041380138831, 1.054161335864795, 74.10053530186788, -190.21990533551542, -23.632777862100163, 119.77982942062464, 116.18648251625487, 88.48374834274664, -14.965503706336737, -2.115004425708766, 85.75534863058334, 166.92600747161993, 149.72927814587007, 106.719699716165, -228.94135492894856, 140.28311643864959, -11.586563973077855, -87.88211539720078, -2.9232859637800246, 160.49324443915418, 162.65628216634573, 123.35843278561843, 149.4258754821695, 171.76040676201927, 142.48660866760534, 160.9815479718003, -5.3844136664066164, 162.373588779927, -99.55635359183415, 152.76765595831773, 148.76666521666033, 137.210497508345, 122.63944343071054, -8.09301231509062, 84.39709716810466, 102.52497351244625, 139.38052602899648, 103.1021518854235, 0.923518706626343, 131.06107599921546, 45.2022651586807, 0.9729501104514559, 2.1054564735670454, -29.932591112248513, 28.15805902725296, -4.321295017354446, 2.0000000000000013, 36.81826461296356, 116.09608903290153, 2.0000000000000013, -46.76837834672011, 122.24798795732657, 76.48011713817073, -5.494449079083688, 143.73485146411497, 98.429093823979, 129.65572411780985, 102.56083025923434, -3.5437519700378477, 64.50179159193556, 73.97984338040723, 0.8440572032610952, 75.40554830079606, -8.368945503726223, 90.50448563269458, 134.63438240703985, 143.15608505890657, 33.21406051171158, -97.16662055576397, 153.64602825927236, 84.40758135854892, 151.35046433983752, 92.42861728821478, 26.09268921450642, -14.297349894601973, 98.32650099978102, -9.386558507539101, 93.93740792502933, 0.9301186332229615, 141.13384105908125, -0.10366604308121423, 2.0000000000000013, -10.758008459177846, 86.85293491615286, -317.9073720498567, 130.53231844290607, 121.78599443434675, 83.50063067209476, 2.0000000000000013, -1.327109681087617, 59.6498767341758, 139.30547258930838, 43.570745711649224, 92.48919648081278, 161.09009635355048, 131.70606520658743, 134.20473944966574], "policy_predator_policy_reward": [168.60500189093207, 150.89044746382896, 162.79854195327516, 171.82994626034184, 126.43952978732699, 1.1860954373430599, 9.600915204695555, 24.286784876767957, 193.17127777914516, 7.972446182300597, 56.932879047647305, 109.35739468660987, 131.9813097156649, 178.33855388859587, 79.69726749380321, 5.098628560767564, 91.46102043305788, 6.232857018741555, 53.39949351546986, 11.343112791615784, 12.26503487261657, 7.978380164503706, 238.76419267261932, 37.34715087813453, 140.64099775028524, 102.6955961819645, 83.77048620889586, 93.60631914955162, 253.88383368729274, 280.02858137653817, 27.397059228558923, 47.06230121699986, 19.685562758956983, 39.35351622903848, 112.14756880265547, 193.73900574460583, 24.61511326416129, 72.09663274680564, 62.1384827663291, 117.82439144259685, 53.27802194623086, 11.055500217708714, 83.49839754446865, 88.0061952196628, 63.96826423225583, 52.91016577287997, 132.23367524659602, 110.0499364497463, 72.97175089024513, 103.22873359399276, 26.688080743240388, 0.0, 39.50585336824912, 114.63643075522258, 15.870867699609262, 24.75311366810789, 17.165760166828488, 4.532285442456002, 47.30877624771272, 7.4498860140997705, 110.16234331051027, 112.68867210781342, 74.97486952892865, 32.85603740931726, 55.746629659696346, 33.25327129794624, 172.76593653620287, 224.56115167595883, 27.220522357444633, 21.959224634207718, 13.61078275769623, 31.578412130661683, 197.9775713104432, 150.2271923723939, 10.657708325809157, 27.184860845204813, 53.400567567825966, 21.065212511654945, 102.99308561431265, 31.466421384712767, 191.1935826815276, 47.069533406026, 6.51002926853882, 9.848863570154329, 41.64627630421867, 31.8971140523601, 8.230449281399991, 63.5517564653461, 43.951232225712275, 27.323929565240064, 76.6202656329436, 70.12209090880923, 0.0, 13.368488305043957, 78.768514846684, 3.238001180591469, 74.15517205275344, 86.76657698684437, 61.18729956051329, 44.26072156200055, 49.98815504149188, 39.71552451071794, 82.55743446280226, 19.459226650267503, 41.67725669366554, 54.068336786284036, 86.63284537638475, 203.9404463779278, 30.450170579375374, 51.56386506313496, 38.4338247184906, 60.46685521783021, 4.075004425708726, 89.26465136941667, 2.3639925283800545, 33.270721854129945, 20.1761012524652, 295.1155376301476, 23.41892059633754, 16.289293800524803, 29.23018737147145, 184.5452139895093, 19.260954099060186, 21.343717833654264, 11.833994170465127, 18.48782456658051, 5.861762859185341, 28.66339133239469, 5.096544780094798, 23.226320914511497, 35.872263495834744, 142.8834677299361, 7.562344041682254, 38.23333478333967, 5.319502491654989, 49.36055656928946, 51.05172414479514, 27.544191002190768, 24.45282458069071, 44.82007734474954, 76.8978481145765, 1.0664812933736585, 20.328924000784586, 88.8077348413193, 64.63203435214, 124.2946066577607, 165.7756433050134, 71.70889768147913, 6.281295017354404, 0.0, 56.628433698909, 61.85721265522589, 174.77860283014687, 9.884395953160649, 25.144363492344734, 89.55346540656956, 32.010811136041916, 16.088416095895656, 84.01841999856723, 7.867932214540339, 53.52916974076567, 5.503751970037806, 123.51947227598296, 2.7537355444077933, 21.354015202782936, 77.22296614038522, 10.288945503726183, 81.49551436730542, 44.36561759296014, 2.373914941093429, 88.82840382657128, 108.74635664665807, 0.8039717407276462, 82.59241864145108, 33.92525029268056, 39.72441233422957, 129.11927662844107, 79.85471451771264, 16.375935156361212, 34.83412235139684, 64.36827642893473, 41.16393715920333, 4.645132854577472, 17.534692129422492, 2.972048315463571, 12.698008459177805, 36.740896011693394, 352.9673720498567, 49.051908628821074, 15.233150801601441, 76.49936932790524, 0.0, 66.77599736301008, 48.487454619531434, 58.95613285973462, 91.63670495387457, 21.96003520744873, 51.620671958188055, 33.77552115568968, 2.567096459031851]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8534677169795983, "mean_inference_ms": 2.6759176043271253, "mean_action_processing_ms": 0.3658645330440154, "mean_env_wait_ms": 0.2991460551848691, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006761789321899414, "StateBufferConnector_ms": 0.006389141082763672, "ViewRequirementAgentConnector_ms": 0.18137919902801514}, "num_episodes": 22, "episode_return_max": 363.7541985382144, "episode_return_min": 3.9599999999999596, "episode_return_mean": 230.0068304074453, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.1450512489914, "num_env_steps_trained_throughput_per_sec": 294.1450512489914, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 1216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1216000, "timers": {"training_iteration_time_ms": 14047.73, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14047.641, "sample_time_ms": 2075.218, "learn_time_ms": 11947.901, "learn_throughput": 334.787, "synch_weights_time_ms": 21.732}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "done": false, "training_iteration": 76, "trial_id": "61e09_00000", "date": "2024-08-16_16-25-24", "timestamp": 1723805724, "time_this_iter_s": 13.670744895935059, "time_total_s": 1124.469218969345, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3002375e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1124.469218969345, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 62.73157894736844, "ram_util_percent": 81.48421052631578}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.7497795887094325, "cur_kl_coeff": 0.14238281249999993, "cur_lr": 0.00010000000000000003, "total_loss": 2.682525698154692, "policy_loss": -0.010584853389965636, "vf_loss": 2.6924025340055033, "vf_explained_var": 0.11622671879157818, "kl": 0.0049726778119223, "entropy": 0.36835156400052327, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8195817274391337, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 2.4220116637371203, "policy_loss": -0.0057898206660947785, "vf_loss": 2.426008422917159, "vf_explained_var": 0.4064812953194613, "kl": 0.0059768783913222295, "entropy": 1.1916032621469448, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "env_runners": {"episode_reward_max": 363.7541985382144, "episode_reward_min": 3.9599999999999596, "episode_reward_mean": 240.7970146205732, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -317.9073720498567, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 180.0727040991923, "predator_policy": 352.9673720498567}, "policy_reward_mean": {"prey_policy": 65.82551503454309, "predator_policy": 54.57299227574353}, "custom_metrics": {}, "hist_stats": {"episode_reward": [286.5699999999999, 144.0910148416291, 291.4899999999999, 141.79936245984499, 245.98374235491553, 340.57214117720895, 284.11278926745524, 159.3, 265.5198540619025, 133.24307509715, 174.12999999999988, 175.93999999999983, 289.56953393020973, 209.67039970187548, 315.23665993929296, 210.3160124726344, 148.2600000000001, 288.7599999999997, 213.67845998958103, 166.03999999999996, 291.6, 306.6387418204838, 66.4543536036776, 338.47, 315.22788638251984, 338.57403371307555, 358.3993907270517, 305.62027534957735, 168.06065633847106, 345.683337272432, 290.9195722437836, 298.0602705859585, 192.94017345832378, 87.35000000000036, 170.90029011768237, 76.72060855669707, 317.9803475793897, 172.4189245727305, 176.9799999999998, 352.28999999999996, 193.06998366982918, 168.404766862434, 122.9700000000002, 363.7541985382144, 303.1061270048335, 348.7721696212046, 183.9199999999998, 241.5729664138641, 347.33000000000004, 314.53000000000003, 154.90000000000003, 311.178401466883, 181.98999999999978, 285.4, 192.0050475939189, 235.71000890149682, 3.9599999999999596, 271.40000000000003, 139.89462043658756, 313.4259339944116, 186.3396296169687, 319.9711701548964, 158.05, 264.75484279273354, 174.82658684722514, 173.91999999999985, 324.53000000000003, 133.62220042917616, 321.45, 317.42874425496257, 220.76933046605765, 140.15000000000015, 200.39974014638995, 163.20999999999998, 6.912048315463487, 158.65383092784623, 316.60337230767533, 161.99999999999997, 173.5862190356296, 333.4690561145668, 327.15999999999997, 302.2534222709746, 360.09000000000003, 317.59000000000003, 246.33014844003753, 336.09285024430534, 361.176720428164, 152.45000000000005, 207.67787312670615, 203.31338271100566, 185.84239068370107, 325.526086188922, 279.84000000000003, 328.447691160296, 305.51, 333.60498703029793, 176.05999999999983, 345.36, 312.58000000000004, 289.28300624408615], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [114.83488673583878, 75.02336725319432, -18.15383498716858, -17.718024380128085, 90.00126849844662, 137.15520933761374, 30.529840302594287, -60.235070606881486, 65.30173576774418, 63.80357658203544, 87.34403737593223, 10.944492104934527, 39.04775331964931, 68.86455146356809, 130.61191925675968, 2.0000000000000013, 107.90635914330159, 3.471210795129455, -2.2877272022794894, 94.90682093171192, 2.0000000000000013, 150.4319543907155, 126.70122375228729, -5.519886014099812, 55.1995083086554, 11.519010203230513, 101.42305058544261, 0.4164421781874121, 113.3748838676253, 112.86187511402507, -12.022606244704841, -174.9884694948223, -9.415807953271326, 108.49606096161892, 120.78432056650011, 122.78648454514213, -112.14298243664689, -22.38332125660925, 0.9327197932287575, 127.26471103575727, 99.4247559268121, 117.7094639937071, 139.79771028443182, 32.38152453702671, -4.70145796934795, -167.10730451452818, 142.03840306211453, 180.0727040991923, 100.85767861142303, 140.8268174145179, 155.28809012531198, 111.50373784101751, 140.69037932026004, 146.4338496158393, 84.89850292503385, 73.97941588279075, -10.741612234664206, 165.43378026809134, 90.231485153316, 173.44533609184055, 66.62076270801168, 63.37706049617414, 154.0911578554937, 38.52109160795099, 2.0000000000000013, 101.23649390611425, -1.4962473116814679, -13.17041380138831, 1.054161335864795, 74.10053530186788, -190.21990533551542, -23.632777862100163, 119.77982942062464, 116.18648251625487, 88.48374834274664, -14.965503706336737, -2.115004425708766, 85.75534863058334, 166.92600747161993, 149.72927814587007, 106.719699716165, -228.94135492894856, 140.28311643864959, -11.586563973077855, -87.88211539720078, -2.9232859637800246, 160.49324443915418, 162.65628216634573, 123.35843278561843, 149.4258754821695, 171.76040676201927, 142.48660866760534, 160.9815479718003, -5.3844136664066164, 162.373588779927, -99.55635359183415, 152.76765595831773, 148.76666521666033, 137.210497508345, 122.63944343071054, -8.09301231509062, 84.39709716810466, 102.52497351244625, 139.38052602899648, 103.1021518854235, 0.923518706626343, 131.06107599921546, 45.2022651586807, 0.9729501104514559, 2.1054564735670454, -29.932591112248513, 28.15805902725296, -4.321295017354446, 2.0000000000000013, 36.81826461296356, 116.09608903290153, 2.0000000000000013, -46.76837834672011, 122.24798795732657, 76.48011713817073, -5.494449079083688, 143.73485146411497, 98.429093823979, 129.65572411780985, 102.56083025923434, -3.5437519700378477, 64.50179159193556, 73.97984338040723, 0.8440572032610952, 75.40554830079606, -8.368945503726223, 90.50448563269458, 134.63438240703985, 143.15608505890657, 33.21406051171158, -97.16662055576397, 153.64602825927236, 84.40758135854892, 151.35046433983752, 92.42861728821478, 26.09268921450642, -14.297349894601973, 98.32650099978102, -9.386558507539101, 93.93740792502933, 0.9301186332229615, 141.13384105908125, -0.10366604308121423, 2.0000000000000013, -10.758008459177846, 86.85293491615286, -317.9073720498567, 130.53231844290607, 121.78599443434675, 83.50063067209476, 2.0000000000000013, -1.327109681087617, 59.6498767341758, 139.30547258930838, 43.570745711649224, 92.48919648081278, 161.09009635355048, 131.70606520658743, 134.20473944966574, 157.7056435777714, 145.87319493213352, 154.46, 135.86376912151857, 39.379955751957496, -46.719936930677164, 85.32537753635883, 171.51275304600637, 152.80638147116412, 44.79561869264156, -0.9253643340137576, 148.6859927151125, -92.41446408566188, -61.58790834862718, -1.1482829236766765, 27.907396700624165, 0.9655580741526982, 122.48897617881399, 170.07246147923308, 140.3275481589709, 122.33145065154012, 38.43857453311176, 153.054387734719, 22.155440285385936, 129.0794690816514, 102.70454751041525, 106.38750647418804, 179.9744361763669, 156.89049169293077, -2.6599992487858772, 176.33210553374437, 131.00481256779761, 145.93809407666004, 129.52711669605895, 83.0808889635594, 96.47962814094771], "policy_predator_policy_reward": [24.61511326416129, 72.09663274680564, 62.1384827663291, 117.82439144259685, 53.27802194623086, 11.055500217708714, 83.49839754446865, 88.0061952196628, 63.96826423225583, 52.91016577287997, 132.23367524659602, 110.0499364497463, 72.97175089024513, 103.22873359399276, 26.688080743240388, 0.0, 39.50585336824912, 114.63643075522258, 15.870867699609262, 24.75311366810789, 17.165760166828488, 4.532285442456002, 47.30877624771272, 7.4498860140997705, 110.16234331051027, 112.68867210781342, 74.97486952892865, 32.85603740931726, 55.746629659696346, 33.25327129794624, 172.76593653620287, 224.56115167595883, 27.220522357444633, 21.959224634207718, 13.61078275769623, 31.578412130661683, 197.9775713104432, 150.2271923723939, 10.657708325809157, 27.184860845204813, 53.400567567825966, 21.065212511654945, 102.99308561431265, 31.466421384712767, 191.1935826815276, 47.069533406026, 6.51002926853882, 9.848863570154329, 41.64627630421867, 31.8971140523601, 8.230449281399991, 63.5517564653461, 43.951232225712275, 27.323929565240064, 76.6202656329436, 70.12209090880923, 0.0, 13.368488305043957, 78.768514846684, 3.238001180591469, 74.15517205275344, 86.76657698684437, 61.18729956051329, 44.26072156200055, 49.98815504149188, 39.71552451071794, 82.55743446280226, 19.459226650267503, 41.67725669366554, 54.068336786284036, 86.63284537638475, 203.9404463779278, 30.450170579375374, 51.56386506313496, 38.4338247184906, 60.46685521783021, 4.075004425708726, 89.26465136941667, 2.3639925283800545, 33.270721854129945, 20.1761012524652, 295.1155376301476, 23.41892059633754, 16.289293800524803, 29.23018737147145, 184.5452139895093, 19.260954099060186, 21.343717833654264, 11.833994170465127, 18.48782456658051, 5.861762859185341, 28.66339133239469, 5.096544780094798, 23.226320914511497, 35.872263495834744, 142.8834677299361, 7.562344041682254, 38.23333478333967, 5.319502491654989, 49.36055656928946, 51.05172414479514, 27.544191002190768, 24.45282458069071, 44.82007734474954, 76.8978481145765, 1.0664812933736585, 20.328924000784586, 88.8077348413193, 64.63203435214, 124.2946066577607, 165.7756433050134, 71.70889768147913, 6.281295017354404, 0.0, 56.628433698909, 61.85721265522589, 174.77860283014687, 9.884395953160649, 25.144363492344734, 89.55346540656956, 32.010811136041916, 16.088416095895656, 84.01841999856723, 7.867932214540339, 53.52916974076567, 5.503751970037806, 123.51947227598296, 2.7537355444077933, 21.354015202782936, 77.22296614038522, 10.288945503726183, 81.49551436730542, 44.36561759296014, 2.373914941093429, 88.82840382657128, 108.74635664665807, 0.8039717407276462, 82.59241864145108, 33.92525029268056, 39.72441233422957, 129.11927662844107, 79.85471451771264, 16.375935156361212, 34.83412235139684, 64.36827642893473, 41.16393715920333, 4.645132854577472, 17.534692129422492, 2.972048315463571, 12.698008459177805, 36.740896011693394, 352.9673720498567, 49.051908628821074, 15.233150801601441, 76.49936932790524, 0.0, 66.77599736301008, 48.487454619531434, 58.95613285973462, 91.63670495387457, 21.96003520744873, 51.620671958188055, 33.77552115568968, 2.567096459031851, 28.08085605925108, 28.43030543084402, 11.022052010771166, 16.24417886771027, 155.98755007574752, 97.68257954300974, 18.74576164051602, 60.50895802142417, 96.3786820602265, 67.19603820413178, 3.6386069732070907, 1.0507646456941628, 256.8016993095239, 104.87854625147143, 51.255337032809756, 125.29893190124882, 41.63001828540314, 20.757838145331498, 0.0, 15.12607655071801, 7.328549348459858, 111.74142546688823, 19.393303425577027, 133.84455971461406, 65.08650600657715, 8.639477401356231, 16.50189798754898, 30.74114639219397, 17.209508307069253, 4.6199992487858355, 13.667894466255625, 24.355187432202456, 18.11161174820553, 19.003177479075482, 12.768027619939323, 96.95446151963971]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8543297726639707, "mean_inference_ms": 2.682694598077721, "mean_action_processing_ms": 0.3663617429562688, "mean_env_wait_ms": 0.29977307877359843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006510734558105469, "StateBufferConnector_ms": 0.0063381195068359375, "ViewRequirementAgentConnector_ms": 0.2196948528289795}, "num_episodes": 18, "episode_return_max": 363.7541985382144, "episode_return_min": 3.9599999999999596, "episode_return_mean": 240.7970146205732, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 280.4182622628635, "num_env_steps_trained_throughput_per_sec": 280.4182622628635, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 1232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1232000, "timers": {"training_iteration_time_ms": 14058.232, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14058.146, "sample_time_ms": 2117.029, "learn_time_ms": 11917.43, "learn_throughput": 335.643, "synch_weights_time_ms": 21.057}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "done": false, "training_iteration": 77, "trial_id": "61e09_00000", "date": "2024-08-16_16-25-39", "timestamp": 1723805739, "time_this_iter_s": 14.375229835510254, "time_total_s": 1138.8444488048553, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30001eaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1138.8444488048553, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 62.43999999999998, "ram_util_percent": 81.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.299128582742479, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 0.00010000000000000003, "total_loss": 3.3932193334771212, "policy_loss": -0.010551931550874123, "vf_loss": 3.4027739500873304, "vf_explained_var": 0.09724552830060323, "kl": 0.014008757885367418, "entropy": 0.6086109848564895, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0826609100298907, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 4.989668353777083, "policy_loss": -0.007207399129956251, "vf_loss": 4.994794691807378, "vf_explained_var": -0.0023040036991159754, "kl": 0.0069368999428432885, "entropy": 1.254349357047409, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 363.7541985382144, "episode_reward_min": -307.87385763359583, "episode_reward_mean": 227.24290214501096, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -649.5869728090469, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 180.0727040991923, "predator_policy": 714.8283967143599}, "policy_reward_mean": {"prey_policy": 44.287061293879084, "predator_policy": 69.33438977862643}, "custom_metrics": {}, "hist_stats": {"episode_reward": [338.47, 315.22788638251984, 338.57403371307555, 358.3993907270517, 305.62027534957735, 168.06065633847106, 345.683337272432, 290.9195722437836, 298.0602705859585, 192.94017345832378, 87.35000000000036, 170.90029011768237, 76.72060855669707, 317.9803475793897, 172.4189245727305, 176.9799999999998, 352.28999999999996, 193.06998366982918, 168.404766862434, 122.9700000000002, 363.7541985382144, 303.1061270048335, 348.7721696212046, 183.9199999999998, 241.5729664138641, 347.33000000000004, 314.53000000000003, 154.90000000000003, 311.178401466883, 181.98999999999978, 285.4, 192.0050475939189, 235.71000890149682, 3.9599999999999596, 271.40000000000003, 139.89462043658756, 313.4259339944116, 186.3396296169687, 319.9711701548964, 158.05, 264.75484279273354, 174.82658684722514, 173.91999999999985, 324.53000000000003, 133.62220042917616, 321.45, 317.42874425496257, 220.76933046605765, 140.15000000000015, 200.39974014638995, 163.20999999999998, 6.912048315463487, 158.65383092784623, 316.60337230767533, 161.99999999999997, 173.5862190356296, 333.4690561145668, 327.15999999999997, 302.2534222709746, 360.09000000000003, 317.59000000000003, 246.33014844003753, 336.09285024430534, 361.176720428164, 152.45000000000005, 207.67787312670615, 203.31338271100566, 185.84239068370107, 325.526086188922, 279.84000000000003, 328.447691160296, 305.51, 333.60498703029793, 176.05999999999983, 345.36, 312.58000000000004, 289.28300624408615, 168.77693116603973, 304.5552313555737, 237.45189194778905, 314.01360749168884, 310.65000000000003, 307.65, 249.76800633480372, 82.03558118628082, 102.73384524603159, 192.87111043879122, -307.87385763359583, 347.09181432254803, -245.10138676829166, -134.5212875050747, 141.4356951006741, 76.04964173245097, 313.18641758305006, 166.15000000000003, 346.37, 268.2682784718313, 330.07, -77.50466744846791, 299.43804013951893], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [142.03840306211453, 180.0727040991923, 100.85767861142303, 140.8268174145179, 155.28809012531198, 111.50373784101751, 140.69037932026004, 146.4338496158393, 84.89850292503385, 73.97941588279075, -10.741612234664206, 165.43378026809134, 90.231485153316, 173.44533609184055, 66.62076270801168, 63.37706049617414, 154.0911578554937, 38.52109160795099, 2.0000000000000013, 101.23649390611425, -1.4962473116814679, -13.17041380138831, 1.054161335864795, 74.10053530186788, -190.21990533551542, -23.632777862100163, 119.77982942062464, 116.18648251625487, 88.48374834274664, -14.965503706336737, -2.115004425708766, 85.75534863058334, 166.92600747161993, 149.72927814587007, 106.719699716165, -228.94135492894856, 140.28311643864959, -11.586563973077855, -87.88211539720078, -2.9232859637800246, 160.49324443915418, 162.65628216634573, 123.35843278561843, 149.4258754821695, 171.76040676201927, 142.48660866760534, 160.9815479718003, -5.3844136664066164, 162.373588779927, -99.55635359183415, 152.76765595831773, 148.76666521666033, 137.210497508345, 122.63944343071054, -8.09301231509062, 84.39709716810466, 102.52497351244625, 139.38052602899648, 103.1021518854235, 0.923518706626343, 131.06107599921546, 45.2022651586807, 0.9729501104514559, 2.1054564735670454, -29.932591112248513, 28.15805902725296, -4.321295017354446, 2.0000000000000013, 36.81826461296356, 116.09608903290153, 2.0000000000000013, -46.76837834672011, 122.24798795732657, 76.48011713817073, -5.494449079083688, 143.73485146411497, 98.429093823979, 129.65572411780985, 102.56083025923434, -3.5437519700378477, 64.50179159193556, 73.97984338040723, 0.8440572032610952, 75.40554830079606, -8.368945503726223, 90.50448563269458, 134.63438240703985, 143.15608505890657, 33.21406051171158, -97.16662055576397, 153.64602825927236, 84.40758135854892, 151.35046433983752, 92.42861728821478, 26.09268921450642, -14.297349894601973, 98.32650099978102, -9.386558507539101, 93.93740792502933, 0.9301186332229615, 141.13384105908125, -0.10366604308121423, 2.0000000000000013, -10.758008459177846, 86.85293491615286, -317.9073720498567, 130.53231844290607, 121.78599443434675, 83.50063067209476, 2.0000000000000013, -1.327109681087617, 59.6498767341758, 139.30547258930838, 43.570745711649224, 92.48919648081278, 161.09009635355048, 131.70606520658743, 134.20473944966574, 157.7056435777714, 145.87319493213352, 154.46, 135.86376912151857, 39.379955751957496, -46.719936930677164, 85.32537753635883, 171.51275304600637, 152.80638147116412, 44.79561869264156, -0.9253643340137576, 148.6859927151125, -92.41446408566188, -61.58790834862718, -1.1482829236766765, 27.907396700624165, 0.9655580741526982, 122.48897617881399, 170.07246147923308, 140.3275481589709, 122.33145065154012, 38.43857453311176, 153.054387734719, 22.155440285385936, 129.0794690816514, 102.70454751041525, 106.38750647418804, 179.9744361763669, 156.89049169293077, -2.6599992487858772, 176.33210553374437, 131.00481256779761, 145.93809407666004, 129.52711669605895, 83.0808889635594, 96.47962814094771, -5.418669187766362, 109.51176978957022, -51.01009649693222, -0.7593099353532011, -69.6524057073899, 105.34163356099964, 130.9588973081731, 130.0543175349086, 144.60611178884903, 127.5482419002368, 71.65534798758877, 135.6637163869307, -4.21169355589929, -44.38482885926791, -112.89198017960624, -116.8773613646604, -174.87389753900544, -55.833155328618105, -102.3163188410634, -132.01655047581622, -610.6901411548247, -649.5869728090469, 87.66480578345852, 163.70369177051174, -347.8850600238198, -406.66705472478884, -243.99915975126282, -374.7708170624902, 0.8046940497262461, -174.64736317023784, -200.9869670582205, -119.63285926257745, 144.35084064330587, 76.79341475714727, 147.63927704660193, -1.1357792102407054, 159.34487977947205, 137.68962443287543, 98.70510644682327, 72.41074984327118, 111.98914820592003, 130.5638972743797, -280.0273413654146, -408.7322597367985, 17.692879621385657, 135.20048460852558], "policy_predator_policy_reward": [6.51002926853882, 9.848863570154329, 41.64627630421867, 31.8971140523601, 8.230449281399991, 63.5517564653461, 43.951232225712275, 27.323929565240064, 76.6202656329436, 70.12209090880923, 0.0, 13.368488305043957, 78.768514846684, 3.238001180591469, 74.15517205275344, 86.76657698684437, 61.18729956051329, 44.26072156200055, 49.98815504149188, 39.71552451071794, 82.55743446280226, 19.459226650267503, 41.67725669366554, 54.068336786284036, 86.63284537638475, 203.9404463779278, 30.450170579375374, 51.56386506313496, 38.4338247184906, 60.46685521783021, 4.075004425708726, 89.26465136941667, 2.3639925283800545, 33.270721854129945, 20.1761012524652, 295.1155376301476, 23.41892059633754, 16.289293800524803, 29.23018737147145, 184.5452139895093, 19.260954099060186, 21.343717833654264, 11.833994170465127, 18.48782456658051, 5.861762859185341, 28.66339133239469, 5.096544780094798, 23.226320914511497, 35.872263495834744, 142.8834677299361, 7.562344041682254, 38.23333478333967, 5.319502491654989, 49.36055656928946, 51.05172414479514, 27.544191002190768, 24.45282458069071, 44.82007734474954, 76.8978481145765, 1.0664812933736585, 20.328924000784586, 88.8077348413193, 64.63203435214, 124.2946066577607, 165.7756433050134, 71.70889768147913, 6.281295017354404, 0.0, 56.628433698909, 61.85721265522589, 174.77860283014687, 9.884395953160649, 25.144363492344734, 89.55346540656956, 32.010811136041916, 16.088416095895656, 84.01841999856723, 7.867932214540339, 53.52916974076567, 5.503751970037806, 123.51947227598296, 2.7537355444077933, 21.354015202782936, 77.22296614038522, 10.288945503726183, 81.49551436730542, 44.36561759296014, 2.373914941093429, 88.82840382657128, 108.74635664665807, 0.8039717407276462, 82.59241864145108, 33.92525029268056, 39.72441233422957, 129.11927662844107, 79.85471451771264, 16.375935156361212, 34.83412235139684, 64.36827642893473, 41.16393715920333, 4.645132854577472, 17.534692129422492, 2.972048315463571, 12.698008459177805, 36.740896011693394, 352.9673720498567, 49.051908628821074, 15.233150801601441, 76.49936932790524, 0.0, 66.77599736301008, 48.487454619531434, 58.95613285973462, 91.63670495387457, 21.96003520744873, 51.620671958188055, 33.77552115568968, 2.567096459031851, 28.08085605925108, 28.43030543084402, 11.022052010771166, 16.24417886771027, 155.98755007574752, 97.68257954300974, 18.74576164051602, 60.50895802142417, 96.3786820602265, 67.19603820413178, 3.6386069732070907, 1.0507646456941628, 256.8016993095239, 104.87854625147143, 51.255337032809756, 125.29893190124882, 41.63001828540314, 20.757838145331498, 0.0, 15.12607655071801, 7.328549348459858, 111.74142546688823, 19.393303425577027, 133.84455971461406, 65.08650600657715, 8.639477401356231, 16.50189798754898, 30.74114639219397, 17.209508307069253, 4.6199992487858355, 13.667894466255625, 24.355187432202456, 18.11161174820553, 19.003177479075482, 12.768027619939323, 96.95446151963971, 41.747784527668315, 22.936046036567557, 185.58551417216674, 170.73912361569242, 139.20029007630106, 62.5623740178784, 8.869510889035796, 44.13088175957141, 25.513888211150988, 12.981758099763193, 90.50465201241123, 9.826283613069284, 140.12751090769208, 158.23701784227964, 300.9825635229224, 10.822359207625142, 17.028817305214922, 316.4120808084405, 180.1463062673858, 247.05767348828473, 714.8283967143599, 237.57485961591536, 22.15180117773371, 73.57151559084397, 0.7416756983268291, 508.7090522819895, 13.69800265660154, 470.55068665207716, 283.43554066744315, 31.842823553742296, 346.2985316452606, 50.37093640798823, 40.94159094565791, 51.10057123693899, 13.405733477171605, 6.2407686864672005, 28.655120220527944, 20.68037556712462, 15.303067738323602, 81.84935444341329, 25.723545565643796, 61.79340895405649, 232.1111633724877, 379.1437702812573, 136.94290192286593, 9.601773986741739]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8575217571035069, "mean_inference_ms": 2.6928471822073563, "mean_action_processing_ms": 0.36716417843154553, "mean_env_wait_ms": 0.3007169088587894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047577619552612305, "StateBufferConnector_ms": 0.006354093551635742, "ViewRequirementAgentConnector_ms": 0.22724759578704834}, "num_episodes": 23, "episode_return_max": 363.7541985382144, "episode_return_min": -307.87385763359583, "episode_return_mean": 227.24290214501096, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 273.35312240863084, "num_env_steps_trained_throughput_per_sec": 273.35312240863084, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 14075.21, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14075.128, "sample_time_ms": 2121.297, "learn_time_ms": 11930.735, "learn_throughput": 335.269, "synch_weights_time_ms": 20.588}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 78, "trial_id": "61e09_00000", "date": "2024-08-16_16-25-53", "timestamp": 1723805753, "time_this_iter_s": 14.649593114852905, "time_total_s": 1153.4940419197083, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2538280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1153.4940419197083, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 61.69047619047618, "ram_util_percent": 81.73809523809524}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8754784522548555, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 0.00010000000000000003, "total_loss": 3.888381710506621, "policy_loss": -0.008793859662261433, "vf_loss": 3.8962243177272655, "vf_explained_var": 0.11578491976652196, "kl": 0.013361917566219007, "entropy": 0.500656575027597, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6099219964925573, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 4.685681650373671, "policy_loss": -0.004223233830459692, "vf_loss": 4.688184495073147, "vf_explained_var": -0.020001536355447515, "kl": 0.005734625298362363, "entropy": 1.2007275579467653, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "env_runners": {"episode_reward_max": 363.7541985382144, "episode_reward_min": -307.87385763359583, "episode_reward_mean": 216.0382086434454, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -750.5259438688273, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 181.52961794054815, "predator_policy": 812.646804288777}, "policy_reward_mean": {"prey_policy": 20.254262526098415, "predator_policy": 87.76484179562429}, "custom_metrics": {}, "hist_stats": {"episode_reward": [168.404766862434, 122.9700000000002, 363.7541985382144, 303.1061270048335, 348.7721696212046, 183.9199999999998, 241.5729664138641, 347.33000000000004, 314.53000000000003, 154.90000000000003, 311.178401466883, 181.98999999999978, 285.4, 192.0050475939189, 235.71000890149682, 3.9599999999999596, 271.40000000000003, 139.89462043658756, 313.4259339944116, 186.3396296169687, 319.9711701548964, 158.05, 264.75484279273354, 174.82658684722514, 173.91999999999985, 324.53000000000003, 133.62220042917616, 321.45, 317.42874425496257, 220.76933046605765, 140.15000000000015, 200.39974014638995, 163.20999999999998, 6.912048315463487, 158.65383092784623, 316.60337230767533, 161.99999999999997, 173.5862190356296, 333.4690561145668, 327.15999999999997, 302.2534222709746, 360.09000000000003, 317.59000000000003, 246.33014844003753, 336.09285024430534, 361.176720428164, 152.45000000000005, 207.67787312670615, 203.31338271100566, 185.84239068370107, 325.526086188922, 279.84000000000003, 328.447691160296, 305.51, 333.60498703029793, 176.05999999999983, 345.36, 312.58000000000004, 289.28300624408615, 168.77693116603973, 304.5552313555737, 237.45189194778905, 314.01360749168884, 310.65000000000003, 307.65, 249.76800633480372, 82.03558118628082, 102.73384524603159, 192.87111043879122, -307.87385763359583, 347.09181432254803, -245.10138676829166, -134.5212875050747, 141.4356951006741, 76.04964173245097, 313.18641758305006, 166.15000000000003, 346.37, 268.2682784718313, 330.07, -77.50466744846791, 299.43804013951893, -108.43753335970935, 232.75397833954497, 329.4, 305.00607520361024, 308.8671315504348, 288.74901657440125, 93.37141678733292, 331.4, 340.2271859069864, 84.05000000000005, -284.59158747725115, 251.8599999999999, 295.2473222721197, 51.00000000000007, 296.74, 127.74377156700406, 185.12999999999977, 250.67962304648185], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [140.28311643864959, -11.586563973077855, -87.88211539720078, -2.9232859637800246, 160.49324443915418, 162.65628216634573, 123.35843278561843, 149.4258754821695, 171.76040676201927, 142.48660866760534, 160.9815479718003, -5.3844136664066164, 162.373588779927, -99.55635359183415, 152.76765595831773, 148.76666521666033, 137.210497508345, 122.63944343071054, -8.09301231509062, 84.39709716810466, 102.52497351244625, 139.38052602899648, 103.1021518854235, 0.923518706626343, 131.06107599921546, 45.2022651586807, 0.9729501104514559, 2.1054564735670454, -29.932591112248513, 28.15805902725296, -4.321295017354446, 2.0000000000000013, 36.81826461296356, 116.09608903290153, 2.0000000000000013, -46.76837834672011, 122.24798795732657, 76.48011713817073, -5.494449079083688, 143.73485146411497, 98.429093823979, 129.65572411780985, 102.56083025923434, -3.5437519700378477, 64.50179159193556, 73.97984338040723, 0.8440572032610952, 75.40554830079606, -8.368945503726223, 90.50448563269458, 134.63438240703985, 143.15608505890657, 33.21406051171158, -97.16662055576397, 153.64602825927236, 84.40758135854892, 151.35046433983752, 92.42861728821478, 26.09268921450642, -14.297349894601973, 98.32650099978102, -9.386558507539101, 93.93740792502933, 0.9301186332229615, 141.13384105908125, -0.10366604308121423, 2.0000000000000013, -10.758008459177846, 86.85293491615286, -317.9073720498567, 130.53231844290607, 121.78599443434675, 83.50063067209476, 2.0000000000000013, -1.327109681087617, 59.6498767341758, 139.30547258930838, 43.570745711649224, 92.48919648081278, 161.09009635355048, 131.70606520658743, 134.20473944966574, 157.7056435777714, 145.87319493213352, 154.46, 135.86376912151857, 39.379955751957496, -46.719936930677164, 85.32537753635883, 171.51275304600637, 152.80638147116412, 44.79561869264156, -0.9253643340137576, 148.6859927151125, -92.41446408566188, -61.58790834862718, -1.1482829236766765, 27.907396700624165, 0.9655580741526982, 122.48897617881399, 170.07246147923308, 140.3275481589709, 122.33145065154012, 38.43857453311176, 153.054387734719, 22.155440285385936, 129.0794690816514, 102.70454751041525, 106.38750647418804, 179.9744361763669, 156.89049169293077, -2.6599992487858772, 176.33210553374437, 131.00481256779761, 145.93809407666004, 129.52711669605895, 83.0808889635594, 96.47962814094771, -5.418669187766362, 109.51176978957022, -51.01009649693222, -0.7593099353532011, -69.6524057073899, 105.34163356099964, 130.9588973081731, 130.0543175349086, 144.60611178884903, 127.5482419002368, 71.65534798758877, 135.6637163869307, -4.21169355589929, -44.38482885926791, -112.89198017960624, -116.8773613646604, -174.87389753900544, -55.833155328618105, -102.3163188410634, -132.01655047581622, -610.6901411548247, -649.5869728090469, 87.66480578345852, 163.70369177051174, -347.8850600238198, -406.66705472478884, -243.99915975126282, -374.7708170624902, 0.8046940497262461, -174.64736317023784, -200.9869670582205, -119.63285926257745, 144.35084064330587, 76.79341475714727, 147.63927704660193, -1.1357792102407054, 159.34487977947205, 137.68962443287543, 98.70510644682327, 72.41074984327118, 111.98914820592003, 130.5638972743797, -280.0273413654146, -408.7322597367985, 17.692879621385657, 135.20048460852558, -310.4553734010963, -521.0054063730776, 2.0000000000000013, -350.7018692866951, 143.55995445630438, 133.11872953835075, -128.49713641316453, 144.25211723773845, 102.46961068809426, 26.453097388147086, -82.92166034756124, 115.96122238168766, -59.86776851757537, -364.9321864268624, 152.1351791379335, 147.587797057785, 131.55385909031173, -20.88500665725077, -215.62425422307064, 0.90532546693614, -405.618060172749, -750.5259438688273, 49.333821059331456, 106.45068261678426, -372.4616195629826, -0.3802185375524876, -8.967769078833168, -179.29122153244668, 117.45380055965848, 125.50186874481678, -0.23206663078362966, -68.63116446259438, -1.0225992008350122, 181.52961794054815, -155.310851021681, 65.50475705482327], "policy_predator_policy_reward": [23.41892059633754, 16.289293800524803, 29.23018737147145, 184.5452139895093, 19.260954099060186, 21.343717833654264, 11.833994170465127, 18.48782456658051, 5.861762859185341, 28.66339133239469, 5.096544780094798, 23.226320914511497, 35.872263495834744, 142.8834677299361, 7.562344041682254, 38.23333478333967, 5.319502491654989, 49.36055656928946, 51.05172414479514, 27.544191002190768, 24.45282458069071, 44.82007734474954, 76.8978481145765, 1.0664812933736585, 20.328924000784586, 88.8077348413193, 64.63203435214, 124.2946066577607, 165.7756433050134, 71.70889768147913, 6.281295017354404, 0.0, 56.628433698909, 61.85721265522589, 174.77860283014687, 9.884395953160649, 25.144363492344734, 89.55346540656956, 32.010811136041916, 16.088416095895656, 84.01841999856723, 7.867932214540339, 53.52916974076567, 5.503751970037806, 123.51947227598296, 2.7537355444077933, 21.354015202782936, 77.22296614038522, 10.288945503726183, 81.49551436730542, 44.36561759296014, 2.373914941093429, 88.82840382657128, 108.74635664665807, 0.8039717407276462, 82.59241864145108, 33.92525029268056, 39.72441233422957, 129.11927662844107, 79.85471451771264, 16.375935156361212, 34.83412235139684, 64.36827642893473, 41.16393715920333, 4.645132854577472, 17.534692129422492, 2.972048315463571, 12.698008459177805, 36.740896011693394, 352.9673720498567, 49.051908628821074, 15.233150801601441, 76.49936932790524, 0.0, 66.77599736301008, 48.487454619531434, 58.95613285973462, 91.63670495387457, 21.96003520744873, 51.620671958188055, 33.77552115568968, 2.567096459031851, 28.08085605925108, 28.43030543084402, 11.022052010771166, 16.24417886771027, 155.98755007574752, 97.68257954300974, 18.74576164051602, 60.50895802142417, 96.3786820602265, 67.19603820413178, 3.6386069732070907, 1.0507646456941628, 256.8016993095239, 104.87854625147143, 51.255337032809756, 125.29893190124882, 41.63001828540314, 20.757838145331498, 0.0, 15.12607655071801, 7.328549348459858, 111.74142546688823, 19.393303425577027, 133.84455971461406, 65.08650600657715, 8.639477401356231, 16.50189798754898, 30.74114639219397, 17.209508307069253, 4.6199992487858355, 13.667894466255625, 24.355187432202456, 18.11161174820553, 19.003177479075482, 12.768027619939323, 96.95446151963971, 41.747784527668315, 22.936046036567557, 185.58551417216674, 170.73912361569242, 139.20029007630106, 62.5623740178784, 8.869510889035796, 44.13088175957141, 25.513888211150988, 12.981758099763193, 90.50465201241123, 9.826283613069284, 140.12751090769208, 158.23701784227964, 300.9825635229224, 10.822359207625142, 17.028817305214922, 316.4120808084405, 180.1463062673858, 247.05767348828473, 714.8283967143599, 237.57485961591536, 22.15180117773371, 73.57151559084397, 0.7416756983268291, 508.7090522819895, 13.69800265660154, 470.55068665207716, 283.43554066744315, 31.842823553742296, 346.2985316452606, 50.37093640798823, 40.94159094565791, 51.10057123693899, 13.405733477171605, 6.2407686864672005, 28.655120220527944, 20.68037556712462, 15.303067738323602, 81.84935444341329, 25.723545565643796, 61.79340895405649, 232.1111633724877, 379.1437702812573, 136.94290192286593, 9.601773986741739, 147.14830836998064, 575.8749380444842, 296.9288522082328, 284.5269954180083, 23.650045543695644, 29.071270461649277, 269.70397720766135, 19.547117171374943, 51.3219148396501, 128.62250863454338, 196.08303224738177, 59.62642229289303, 432.81057714270037, 85.3607945890705, 18.964820862066514, 12.71220294221498, 118.72215265005273, 110.83618082387264, 297.68425422307064, 1.0846745330638614, 58.905612275547945, 812.646804288777, 65.99617894066856, 30.079317383215866, 369.6024456661951, 298.4867147064609, 202.41612728740887, 36.842863323871015, 36.766199440341495, 17.018131255183288, 3.2775572241202178, 193.32944543626158, 4.622981260286832, 0.0, 196.0818322357357, 144.40388477760393]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8597533647813307, "mean_inference_ms": 2.699473760588361, "mean_action_processing_ms": 0.3677110800096123, "mean_env_wait_ms": 0.3013842490391627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004763245582580566, "StateBufferConnector_ms": 0.006505489349365234, "ViewRequirementAgentConnector_ms": 0.20878708362579346}, "num_episodes": 18, "episode_return_max": 363.7541985382144, "episode_return_min": -307.87385763359583, "episode_return_mean": 216.0382086434454, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 347.92293078523556, "num_env_steps_trained_throughput_per_sec": 347.92293078523556, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 1264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1264000, "timers": {"training_iteration_time_ms": 13788.051, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13787.993, "sample_time_ms": 2088.794, "learn_time_ms": 11676.916, "learn_throughput": 342.556, "synch_weights_time_ms": 19.908}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "done": false, "training_iteration": 79, "trial_id": "61e09_00000", "date": "2024-08-16_16-26-05", "timestamp": 1723805765, "time_this_iter_s": 11.50377106666565, "time_total_s": 1164.997812986374, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24c0af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1164.997812986374, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 47.262499999999996, "ram_util_percent": 72.73750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7053104950637414, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 0.00010000000000000003, "total_loss": 4.37568569940234, "policy_loss": -0.008987557940263912, "vf_loss": 4.383980683170298, "vf_explained_var": 0.10112043433088475, "kl": 0.009728471157358119, "entropy": 0.6293005267621348, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.086989594641186, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 5.565255466213933, "policy_loss": -0.0051188940995387615, "vf_loss": 5.567996362655882, "vf_explained_var": -0.08964277647790454, "kl": 0.007926625271248046, "entropy": 1.232851058906979, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 361.176720428164, "episode_reward_min": -307.87385763359583, "episode_reward_mean": 188.5054742475698, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -750.5259438688273, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.24474115352143, "predator_policy": 812.646804288777}, "policy_reward_mean": {"prey_policy": -21.229627994112672, "predator_policy": 115.48236511789757}, "custom_metrics": {}, "hist_stats": {"episode_reward": [264.75484279273354, 174.82658684722514, 173.91999999999985, 324.53000000000003, 133.62220042917616, 321.45, 317.42874425496257, 220.76933046605765, 140.15000000000015, 200.39974014638995, 163.20999999999998, 6.912048315463487, 158.65383092784623, 316.60337230767533, 161.99999999999997, 173.5862190356296, 333.4690561145668, 327.15999999999997, 302.2534222709746, 360.09000000000003, 317.59000000000003, 246.33014844003753, 336.09285024430534, 361.176720428164, 152.45000000000005, 207.67787312670615, 203.31338271100566, 185.84239068370107, 325.526086188922, 279.84000000000003, 328.447691160296, 305.51, 333.60498703029793, 176.05999999999983, 345.36, 312.58000000000004, 289.28300624408615, 168.77693116603973, 304.5552313555737, 237.45189194778905, 314.01360749168884, 310.65000000000003, 307.65, 249.76800633480372, 82.03558118628082, 102.73384524603159, 192.87111043879122, -307.87385763359583, 347.09181432254803, -245.10138676829166, -134.5212875050747, 141.4356951006741, 76.04964173245097, 313.18641758305006, 166.15000000000003, 346.37, 268.2682784718313, 330.07, -77.50466744846791, 299.43804013951893, -108.43753335970935, 232.75397833954497, 329.4, 305.00607520361024, 308.8671315504348, 288.74901657440125, 93.37141678733292, 331.4, 340.2271859069864, 84.05000000000005, -284.59158747725115, 251.8599999999999, 295.2473222721197, 51.00000000000007, 296.74, 127.74377156700406, 185.12999999999977, 250.67962304648185, 296.4177006586466, 177.04999999999984, 304.82000000000005, 20.49545463735277, -93.85223820519423, 292.47547268315054, -117.53743362896998, 2.1299999999999946, -239.53812398240618, -169.88833262465465, 1.9499999999999795, 275.94000000000005, 342.0165017386736, 308.59000000000003, 290.45, 110.63000000000021, 290.21000000000004, -84.95833946781116, -100.9279532482676, 40.48810950410784, 329.40000000000015, 118.95078295352907], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [64.50179159193556, 73.97984338040723, 0.8440572032610952, 75.40554830079606, -8.368945503726223, 90.50448563269458, 134.63438240703985, 143.15608505890657, 33.21406051171158, -97.16662055576397, 153.64602825927236, 84.40758135854892, 151.35046433983752, 92.42861728821478, 26.09268921450642, -14.297349894601973, 98.32650099978102, -9.386558507539101, 93.93740792502933, 0.9301186332229615, 141.13384105908125, -0.10366604308121423, 2.0000000000000013, -10.758008459177846, 86.85293491615286, -317.9073720498567, 130.53231844290607, 121.78599443434675, 83.50063067209476, 2.0000000000000013, -1.327109681087617, 59.6498767341758, 139.30547258930838, 43.570745711649224, 92.48919648081278, 161.09009635355048, 131.70606520658743, 134.20473944966574, 157.7056435777714, 145.87319493213352, 154.46, 135.86376912151857, 39.379955751957496, -46.719936930677164, 85.32537753635883, 171.51275304600637, 152.80638147116412, 44.79561869264156, -0.9253643340137576, 148.6859927151125, -92.41446408566188, -61.58790834862718, -1.1482829236766765, 27.907396700624165, 0.9655580741526982, 122.48897617881399, 170.07246147923308, 140.3275481589709, 122.33145065154012, 38.43857453311176, 153.054387734719, 22.155440285385936, 129.0794690816514, 102.70454751041525, 106.38750647418804, 179.9744361763669, 156.89049169293077, -2.6599992487858772, 176.33210553374437, 131.00481256779761, 145.93809407666004, 129.52711669605895, 83.0808889635594, 96.47962814094771, -5.418669187766362, 109.51176978957022, -51.01009649693222, -0.7593099353532011, -69.6524057073899, 105.34163356099964, 130.9588973081731, 130.0543175349086, 144.60611178884903, 127.5482419002368, 71.65534798758877, 135.6637163869307, -4.21169355589929, -44.38482885926791, -112.89198017960624, -116.8773613646604, -174.87389753900544, -55.833155328618105, -102.3163188410634, -132.01655047581622, -610.6901411548247, -649.5869728090469, 87.66480578345852, 163.70369177051174, -347.8850600238198, -406.66705472478884, -243.99915975126282, -374.7708170624902, 0.8046940497262461, -174.64736317023784, -200.9869670582205, -119.63285926257745, 144.35084064330587, 76.79341475714727, 147.63927704660193, -1.1357792102407054, 159.34487977947205, 137.68962443287543, 98.70510644682327, 72.41074984327118, 111.98914820592003, 130.5638972743797, -280.0273413654146, -408.7322597367985, 17.692879621385657, 135.20048460852558, -310.4553734010963, -521.0054063730776, 2.0000000000000013, -350.7018692866951, 143.55995445630438, 133.11872953835075, -128.49713641316453, 144.25211723773845, 102.46961068809426, 26.453097388147086, -82.92166034756124, 115.96122238168766, -59.86776851757537, -364.9321864268624, 152.1351791379335, 147.587797057785, 131.55385909031173, -20.88500665725077, -215.62425422307064, 0.90532546693614, -405.618060172749, -750.5259438688273, 49.333821059331456, 106.45068261678426, -372.4616195629826, -0.3802185375524876, -8.967769078833168, -179.29122153244668, 117.45380055965848, 125.50186874481678, -0.23206663078362966, -68.63116446259438, -1.0225992008350122, 181.52961794054815, -155.310851021681, 65.50475705482327, 94.86360958883661, 116.52082615080508, -0.24996543000445648, 151.8389009279577, 164.1911766432491, 104.10368219635546, -490.5145572994806, -1.875598333378446, -175.2554107955255, -365.2074946131551, 91.17041157411008, 68.42564096060674, -494.3969589834682, -182.78508329805203, -15.971306301051234, -494.8176601252944, -547.6180164851908, -439.9122575226197, -540.4607312937263, -308.8337433858219, -724.4640744591209, -3.0600038258694404, 198.24474115352143, 16.56018451430458, 93.38407220446925, 129.0345665562386, 86.2044427312857, 153.8532614486495, 149.56151127115143, 46.69179274697944, 77.9976967644412, -5.056710582051046, -43.759653458162745, 180.38604434911935, -497.83566163307074, -192.74654403635085, -241.181783257211, -614.222343873007, -387.93985546561964, -21.869472174214053, 178.264972115026, 81.83117039182294, -0.081414909601723, -592.2223191383441], "policy_predator_policy_reward": [123.51947227598296, 2.7537355444077933, 21.354015202782936, 77.22296614038522, 10.288945503726183, 81.49551436730542, 44.36561759296014, 2.373914941093429, 88.82840382657128, 108.74635664665807, 0.8039717407276462, 82.59241864145108, 33.92525029268056, 39.72441233422957, 129.11927662844107, 79.85471451771264, 16.375935156361212, 34.83412235139684, 64.36827642893473, 41.16393715920333, 4.645132854577472, 17.534692129422492, 2.972048315463571, 12.698008459177805, 36.740896011693394, 352.9673720498567, 49.051908628821074, 15.233150801601441, 76.49936932790524, 0.0, 66.77599736301008, 48.487454619531434, 58.95613285973462, 91.63670495387457, 21.96003520744873, 51.620671958188055, 33.77552115568968, 2.567096459031851, 28.08085605925108, 28.43030543084402, 11.022052010771166, 16.24417886771027, 155.98755007574752, 97.68257954300974, 18.74576164051602, 60.50895802142417, 96.3786820602265, 67.19603820413178, 3.6386069732070907, 1.0507646456941628, 256.8016993095239, 104.87854625147143, 51.255337032809756, 125.29893190124882, 41.63001828540314, 20.757838145331498, 0.0, 15.12607655071801, 7.328549348459858, 111.74142546688823, 19.393303425577027, 133.84455971461406, 65.08650600657715, 8.639477401356231, 16.50189798754898, 30.74114639219397, 17.209508307069253, 4.6199992487858355, 13.667894466255625, 24.355187432202456, 18.11161174820553, 19.003177479075482, 12.768027619939323, 96.95446151963971, 41.747784527668315, 22.936046036567557, 185.58551417216674, 170.73912361569242, 139.20029007630106, 62.5623740178784, 8.869510889035796, 44.13088175957141, 25.513888211150988, 12.981758099763193, 90.50465201241123, 9.826283613069284, 140.12751090769208, 158.23701784227964, 300.9825635229224, 10.822359207625142, 17.028817305214922, 316.4120808084405, 180.1463062673858, 247.05767348828473, 714.8283967143599, 237.57485961591536, 22.15180117773371, 73.57151559084397, 0.7416756983268291, 508.7090522819895, 13.69800265660154, 470.55068665207716, 283.43554066744315, 31.842823553742296, 346.2985316452606, 50.37093640798823, 40.94159094565791, 51.10057123693899, 13.405733477171605, 6.2407686864672005, 28.655120220527944, 20.68037556712462, 15.303067738323602, 81.84935444341329, 25.723545565643796, 61.79340895405649, 232.1111633724877, 379.1437702812573, 136.94290192286593, 9.601773986741739, 147.14830836998064, 575.8749380444842, 296.9288522082328, 284.5269954180083, 23.650045543695644, 29.071270461649277, 269.70397720766135, 19.547117171374943, 51.3219148396501, 128.62250863454338, 196.08303224738177, 59.62642229289303, 432.81057714270037, 85.3607945890705, 18.964820862066514, 12.71220294221498, 118.72215265005273, 110.83618082387264, 297.68425422307064, 1.0846745330638614, 58.905612275547945, 812.646804288777, 65.99617894066856, 30.079317383215866, 369.6024456661951, 298.4867147064609, 202.41612728740887, 36.842863323871015, 36.766199440341495, 17.018131255183288, 3.2775572241202178, 193.32944543626158, 4.622981260286832, 0.0, 196.0818322357357, 144.40388477760393, 37.878853593261425, 47.154411325743474, 12.081334754399556, 13.379729747647191, 36.52514116039536, 0.0, 82.53140765930158, 430.35420261091, 426.94057313683703, 19.6700940666495, 99.20131514889026, 33.67810499954342, 526.4071551852408, 33.23745346730922, 17.881306301051527, 495.03766012529445, 730.7465138196993, 17.245636205704717, 40.390140633951354, 639.0160014209422, 724.4640744591209, 5.010003825869399, 0.7552588464785644, 60.37981548569523, 74.55139568697166, 45.04646729099406, 24.71251506488895, 43.81978075517579, 0.0, 94.19669598186913, 30.6923032355589, 6.996710582051005, 152.78965345816277, 0.793955650880657, 574.6891855806799, 30.934680620930436, 31.01752705046562, 723.4586468314849, 439.27560746963127, 11.021829674310174, 5.255082129349027, 64.04877536380195, 146.7556864248474, 564.498830576627]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8623688467613451, "mean_inference_ms": 2.701938686016186, "mean_action_processing_ms": 0.3678560719515439, "mean_env_wait_ms": 0.30152856497817443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004857182502746582, "StateBufferConnector_ms": 0.006519794464111328, "ViewRequirementAgentConnector_ms": 0.2003251314163208}, "num_episodes": 22, "episode_return_max": 361.176720428164, "episode_return_min": -307.87385763359583, "episode_return_mean": 188.5054742475698, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 366.7289232931969, "num_env_steps_trained_throughput_per_sec": 366.7289232931969, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 13493.942, "restore_workers_time_ms": 0.013, "training_step_time_ms": 13493.885, "sample_time_ms": 2042.506, "learn_time_ms": 11430.148, "learn_throughput": 349.952, "synch_weights_time_ms": 19.042}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 80, "trial_id": "61e09_00000", "date": "2024-08-16_16-26-16", "timestamp": 1723805776, "time_this_iter_s": 10.912841081619263, "time_total_s": 1175.9106540679932, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24c0b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1175.9106540679932, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 45.287499999999994, "ram_util_percent": 73.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.329651426196729, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 0.00010000000000000003, "total_loss": 6.243185843614043, "policy_loss": -0.011328494180949828, "vf_loss": 6.252561204900187, "vf_explained_var": 0.11920383168906762, "kl": 0.0274349071492131, "entropy": 0.7173262777467253, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4154066922488036, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 7.303906394817211, "policy_loss": -0.007855869391095387, "vf_loss": 7.309323567183561, "vf_explained_var": -0.28404594426432617, "kl": 0.008129043899037552, "entropy": 1.1755767805866464, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 361.176720428164, "episode_reward_min": -307.87385763359583, "episode_reward_mean": 152.35239528375746, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -750.5259438688273, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.24474115352143, "predator_policy": 860.8250488146792}, "policy_reward_mean": {"prey_policy": -91.86796081371713, "predator_policy": 168.04415845559583}, "custom_metrics": {}, "hist_stats": {"episode_reward": [302.2534222709746, 360.09000000000003, 317.59000000000003, 246.33014844003753, 336.09285024430534, 361.176720428164, 152.45000000000005, 207.67787312670615, 203.31338271100566, 185.84239068370107, 325.526086188922, 279.84000000000003, 328.447691160296, 305.51, 333.60498703029793, 176.05999999999983, 345.36, 312.58000000000004, 289.28300624408615, 168.77693116603973, 304.5552313555737, 237.45189194778905, 314.01360749168884, 310.65000000000003, 307.65, 249.76800633480372, 82.03558118628082, 102.73384524603159, 192.87111043879122, -307.87385763359583, 347.09181432254803, -245.10138676829166, -134.5212875050747, 141.4356951006741, 76.04964173245097, 313.18641758305006, 166.15000000000003, 346.37, 268.2682784718313, 330.07, -77.50466744846791, 299.43804013951893, -108.43753335970935, 232.75397833954497, 329.4, 305.00607520361024, 308.8671315504348, 288.74901657440125, 93.37141678733292, 331.4, 340.2271859069864, 84.05000000000005, -284.59158747725115, 251.8599999999999, 295.2473222721197, 51.00000000000007, 296.74, 127.74377156700406, 185.12999999999977, 250.67962304648185, 296.4177006586466, 177.04999999999984, 304.82000000000005, 20.49545463735277, -93.85223820519423, 292.47547268315054, -117.53743362896998, 2.1299999999999946, -239.53812398240618, -169.88833262465465, 1.9499999999999795, 275.94000000000005, 342.0165017386736, 308.59000000000003, 290.45, 110.63000000000021, 290.21000000000004, -84.95833946781116, -100.9279532482676, 40.48810950410784, 329.40000000000015, 118.95078295352907, 346.25, 180.38683744708538, 217.834743290113, -283.4216946870321, 165.81957937633274, -77.7401734405803, 50.248096408681114, 2.009999999999981, 210.95028434669658, 53.73486722180403, 167.32713855626724, 2.45999999999999, -279.1065676612883, 3.2299999999999924, -228.64655591564636, -120.34535801055448, -115.443121675385, 2.5899999999999865], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [131.70606520658743, 134.20473944966574, 157.7056435777714, 145.87319493213352, 154.46, 135.86376912151857, 39.379955751957496, -46.719936930677164, 85.32537753635883, 171.51275304600637, 152.80638147116412, 44.79561869264156, -0.9253643340137576, 148.6859927151125, -92.41446408566188, -61.58790834862718, -1.1482829236766765, 27.907396700624165, 0.9655580741526982, 122.48897617881399, 170.07246147923308, 140.3275481589709, 122.33145065154012, 38.43857453311176, 153.054387734719, 22.155440285385936, 129.0794690816514, 102.70454751041525, 106.38750647418804, 179.9744361763669, 156.89049169293077, -2.6599992487858772, 176.33210553374437, 131.00481256779761, 145.93809407666004, 129.52711669605895, 83.0808889635594, 96.47962814094771, -5.418669187766362, 109.51176978957022, -51.01009649693222, -0.7593099353532011, -69.6524057073899, 105.34163356099964, 130.9588973081731, 130.0543175349086, 144.60611178884903, 127.5482419002368, 71.65534798758877, 135.6637163869307, -4.21169355589929, -44.38482885926791, -112.89198017960624, -116.8773613646604, -174.87389753900544, -55.833155328618105, -102.3163188410634, -132.01655047581622, -610.6901411548247, -649.5869728090469, 87.66480578345852, 163.70369177051174, -347.8850600238198, -406.66705472478884, -243.99915975126282, -374.7708170624902, 0.8046940497262461, -174.64736317023784, -200.9869670582205, -119.63285926257745, 144.35084064330587, 76.79341475714727, 147.63927704660193, -1.1357792102407054, 159.34487977947205, 137.68962443287543, 98.70510644682327, 72.41074984327118, 111.98914820592003, 130.5638972743797, -280.0273413654146, -408.7322597367985, 17.692879621385657, 135.20048460852558, -310.4553734010963, -521.0054063730776, 2.0000000000000013, -350.7018692866951, 143.55995445630438, 133.11872953835075, -128.49713641316453, 144.25211723773845, 102.46961068809426, 26.453097388147086, -82.92166034756124, 115.96122238168766, -59.86776851757537, -364.9321864268624, 152.1351791379335, 147.587797057785, 131.55385909031173, -20.88500665725077, -215.62425422307064, 0.90532546693614, -405.618060172749, -750.5259438688273, 49.333821059331456, 106.45068261678426, -372.4616195629826, -0.3802185375524876, -8.967769078833168, -179.29122153244668, 117.45380055965848, 125.50186874481678, -0.23206663078362966, -68.63116446259438, -1.0225992008350122, 181.52961794054815, -155.310851021681, 65.50475705482327, 94.86360958883661, 116.52082615080508, -0.24996543000445648, 151.8389009279577, 164.1911766432491, 104.10368219635546, -490.5145572994806, -1.875598333378446, -175.2554107955255, -365.2074946131551, 91.17041157411008, 68.42564096060674, -494.3969589834682, -182.78508329805203, -15.971306301051234, -494.8176601252944, -547.6180164851908, -439.9122575226197, -540.4607312937263, -308.8337433858219, -724.4640744591209, -3.0600038258694404, 198.24474115352143, 16.56018451430458, 93.38407220446925, 129.0345665562386, 86.2044427312857, 153.8532614486495, 149.56151127115143, 46.69179274697944, 77.9976967644412, -5.056710582051046, -43.759653458162745, 180.38604434911935, -497.83566163307074, -192.74654403635085, -241.181783257211, -614.222343873007, -387.93985546561964, -21.869472174214053, 178.264972115026, 81.83117039182294, -0.081414909601723, -592.2223191383441, 159.8696393273374, 158.9900943947145, -4.579173797409014, -196.22437011231452, -202.53099569399635, -384.0990529573087, -450.21809928804464, -683.3067368407999, -729.5080409956763, -666.9340872274727, -166.59076534078494, -321.08191691645936, -467.2046986242599, -288.3650784212666, -685.4285224786221, -2.6167886772423907, 2.0000000000000013, -313.34869728737004, -491.26796173505477, 0.28355548209784337, -638.4788589976624, -651.7155922254557, -1.5840109665456645, -277.02258906035246, -465.67560712761093, -624.5124212083599, -2.8737736569035945, -438.044259432029, -383.79046385123365, -395.6124623485299, -174.58485536205262, -645.0312122671986, -643.7435334260442, -644.766475093212, -5.997430024049365, -480.1161828793087], "policy_predator_policy_reward": [33.77552115568968, 2.567096459031851, 28.08085605925108, 28.43030543084402, 11.022052010771166, 16.24417886771027, 155.98755007574752, 97.68257954300974, 18.74576164051602, 60.50895802142417, 96.3786820602265, 67.19603820413178, 3.6386069732070907, 1.0507646456941628, 256.8016993095239, 104.87854625147143, 51.255337032809756, 125.29893190124882, 41.63001828540314, 20.757838145331498, 0.0, 15.12607655071801, 7.328549348459858, 111.74142546688823, 19.393303425577027, 133.84455971461406, 65.08650600657715, 8.639477401356231, 16.50189798754898, 30.74114639219397, 17.209508307069253, 4.6199992487858355, 13.667894466255625, 24.355187432202456, 18.11161174820553, 19.003177479075482, 12.768027619939323, 96.95446151963971, 41.747784527668315, 22.936046036567557, 185.58551417216674, 170.73912361569242, 139.20029007630106, 62.5623740178784, 8.869510889035796, 44.13088175957141, 25.513888211150988, 12.981758099763193, 90.50465201241123, 9.826283613069284, 140.12751090769208, 158.23701784227964, 300.9825635229224, 10.822359207625142, 17.028817305214922, 316.4120808084405, 180.1463062673858, 247.05767348828473, 714.8283967143599, 237.57485961591536, 22.15180117773371, 73.57151559084397, 0.7416756983268291, 508.7090522819895, 13.69800265660154, 470.55068665207716, 283.43554066744315, 31.842823553742296, 346.2985316452606, 50.37093640798823, 40.94159094565791, 51.10057123693899, 13.405733477171605, 6.2407686864672005, 28.655120220527944, 20.68037556712462, 15.303067738323602, 81.84935444341329, 25.723545565643796, 61.79340895405649, 232.1111633724877, 379.1437702812573, 136.94290192286593, 9.601773986741739, 147.14830836998064, 575.8749380444842, 296.9288522082328, 284.5269954180083, 23.650045543695644, 29.071270461649277, 269.70397720766135, 19.547117171374943, 51.3219148396501, 128.62250863454338, 196.08303224738177, 59.62642229289303, 432.81057714270037, 85.3607945890705, 18.964820862066514, 12.71220294221498, 118.72215265005273, 110.83618082387264, 297.68425422307064, 1.0846745330638614, 58.905612275547945, 812.646804288777, 65.99617894066856, 30.079317383215866, 369.6024456661951, 298.4867147064609, 202.41612728740887, 36.842863323871015, 36.766199440341495, 17.018131255183288, 3.2775572241202178, 193.32944543626158, 4.622981260286832, 0.0, 196.0818322357357, 144.40388477760393, 37.878853593261425, 47.154411325743474, 12.081334754399556, 13.379729747647191, 36.52514116039536, 0.0, 82.53140765930158, 430.35420261091, 426.94057313683703, 19.6700940666495, 99.20131514889026, 33.67810499954342, 526.4071551852408, 33.23745346730922, 17.881306301051527, 495.03766012529445, 730.7465138196993, 17.245636205704717, 40.390140633951354, 639.0160014209422, 724.4640744591209, 5.010003825869399, 0.7552588464785644, 60.37981548569523, 74.55139568697166, 45.04646729099406, 24.71251506488895, 43.81978075517579, 0.0, 94.19669598186913, 30.6923032355589, 6.996710582051005, 152.78965345816277, 0.793955650880657, 574.6891855806799, 30.934680620930436, 31.01752705046562, 723.4586468314849, 439.27560746963127, 11.021829674310174, 5.255082129349027, 64.04877536380195, 146.7556864248474, 564.498830576627, 26.440612359302825, 0.9496539186452739, 95.55953582557385, 285.63084553123537, 453.4403928589692, 351.02439908244753, 36.68456352085606, 813.4185779209545, 704.443653236431, 857.8180543630508, 36.45244188391339, 373.48006693275033, 256.601927575173, 549.2159458790345, 685.4785224786222, 4.576788677242349, 245.34029275203923, 276.9586888820276, 382.93977439800676, 161.77949907675452, 809.3543691453184, 648.1672206340675, 3.554010966545632, 277.51258906035247, 53.31506025553937, 757.7664004191445, 416.21459308846147, 27.933440000471172, 536.2235414675722, 14.532828816544013, 26.447864665160196, 672.822844953536, 312.24183802919185, 860.8250488146792, 478.95293999700056, 9.750672906357499]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8617738723966006, "mean_inference_ms": 2.7050588848383166, "mean_action_processing_ms": 0.36763643319760886, "mean_env_wait_ms": 0.30171718146148513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047463178634643555, "StateBufferConnector_ms": 0.006578326225280762, "ViewRequirementAgentConnector_ms": 0.17133867740631104}, "num_episodes": 18, "episode_return_max": 361.176720428164, "episode_return_min": -307.87385763359583, "episode_return_mean": 152.35239528375746, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 363.4067284029211, "num_env_steps_trained_throughput_per_sec": 363.4067284029211, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 13165.736, "restore_workers_time_ms": 0.013, "training_step_time_ms": 13165.681, "sample_time_ms": 2017.612, "learn_time_ms": 11127.614, "learn_throughput": 359.466, "synch_weights_time_ms": 18.498}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 81, "trial_id": "61e09_00000", "date": "2024-08-16_16-26-27", "timestamp": 1723805787, "time_this_iter_s": 11.01314091682434, "time_total_s": 1186.9237949848175, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x300039ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1186.9237949848175, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 46.193749999999994, "ram_util_percent": 73.56875000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8333259677760814, "cur_kl_coeff": 0.10678710937499997, "cur_lr": 0.00010000000000000003, "total_loss": 8.966721866496655, "policy_loss": -0.007892884422714512, "vf_loss": 8.973279892704474, "vf_explained_var": 0.029024417059762136, "kl": 0.012500246975681853, "entropy": 0.6918017692351467, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.582534252351554, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 7.339362705826129, "policy_loss": -0.009533580165928004, "vf_loss": 7.34601482991819, "vf_explained_var": -0.352620257839324, "kl": 0.009604799063077289, "entropy": 1.170595762275514, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "env_runners": {"episode_reward_max": 571.1015033535745, "episode_reward_min": -307.87385763359583, "episode_reward_mean": 105.87183664726734, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -867.7620715353576, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.24474115352143, "predator_policy": 917.086915767358}, "policy_reward_mean": {"prey_policy": -182.11145455491373, "predator_policy": 235.0473728785474}, "custom_metrics": {}, "hist_stats": {"episode_reward": [310.65000000000003, 307.65, 249.76800633480372, 82.03558118628082, 102.73384524603159, 192.87111043879122, -307.87385763359583, 347.09181432254803, -245.10138676829166, -134.5212875050747, 141.4356951006741, 76.04964173245097, 313.18641758305006, 166.15000000000003, 346.37, 268.2682784718313, 330.07, -77.50466744846791, 299.43804013951893, -108.43753335970935, 232.75397833954497, 329.4, 305.00607520361024, 308.8671315504348, 288.74901657440125, 93.37141678733292, 331.4, 340.2271859069864, 84.05000000000005, -284.59158747725115, 251.8599999999999, 295.2473222721197, 51.00000000000007, 296.74, 127.74377156700406, 185.12999999999977, 250.67962304648185, 296.4177006586466, 177.04999999999984, 304.82000000000005, 20.49545463735277, -93.85223820519423, 292.47547268315054, -117.53743362896998, 2.1299999999999946, -239.53812398240618, -169.88833262465465, 1.9499999999999795, 275.94000000000005, 342.0165017386736, 308.59000000000003, 290.45, 110.63000000000021, 290.21000000000004, -84.95833946781116, -100.9279532482676, 40.48810950410784, 329.40000000000015, 118.95078295352907, 346.25, 180.38683744708538, 217.834743290113, -283.4216946870321, 165.81957937633274, -77.7401734405803, 50.248096408681114, 2.009999999999981, 210.95028434669658, 53.73486722180403, 167.32713855626724, 2.45999999999999, -279.1065676612883, 3.2299999999999924, -228.64655591564636, -120.34535801055448, -115.443121675385, 2.5899999999999865, 571.1015033535745, 15.198265196520726, -93.94409166166872, -156.17203492070897, 2.2799999999999887, 385.61014884401794, -119.87269750979799, 345.1382092028207, -119.33745300672138, 3.8999999999999613, -261.13712997528927, -149.97714088167672, 473.7429379020775, 99.32909536337903, -1.727611685580083, -252.47283420839887, 8.195608023682228, 326.2999999999998, 220.67033791122498, 223.04541643475173, 5.999999999999963, 7.531467467500544, 212.3683609908676], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [144.60611178884903, 127.5482419002368, 71.65534798758877, 135.6637163869307, -4.21169355589929, -44.38482885926791, -112.89198017960624, -116.8773613646604, -174.87389753900544, -55.833155328618105, -102.3163188410634, -132.01655047581622, -610.6901411548247, -649.5869728090469, 87.66480578345852, 163.70369177051174, -347.8850600238198, -406.66705472478884, -243.99915975126282, -374.7708170624902, 0.8046940497262461, -174.64736317023784, -200.9869670582205, -119.63285926257745, 144.35084064330587, 76.79341475714727, 147.63927704660193, -1.1357792102407054, 159.34487977947205, 137.68962443287543, 98.70510644682327, 72.41074984327118, 111.98914820592003, 130.5638972743797, -280.0273413654146, -408.7322597367985, 17.692879621385657, 135.20048460852558, -310.4553734010963, -521.0054063730776, 2.0000000000000013, -350.7018692866951, 143.55995445630438, 133.11872953835075, -128.49713641316453, 144.25211723773845, 102.46961068809426, 26.453097388147086, -82.92166034756124, 115.96122238168766, -59.86776851757537, -364.9321864268624, 152.1351791379335, 147.587797057785, 131.55385909031173, -20.88500665725077, -215.62425422307064, 0.90532546693614, -405.618060172749, -750.5259438688273, 49.333821059331456, 106.45068261678426, -372.4616195629826, -0.3802185375524876, -8.967769078833168, -179.29122153244668, 117.45380055965848, 125.50186874481678, -0.23206663078362966, -68.63116446259438, -1.0225992008350122, 181.52961794054815, -155.310851021681, 65.50475705482327, 94.86360958883661, 116.52082615080508, -0.24996543000445648, 151.8389009279577, 164.1911766432491, 104.10368219635546, -490.5145572994806, -1.875598333378446, -175.2554107955255, -365.2074946131551, 91.17041157411008, 68.42564096060674, -494.3969589834682, -182.78508329805203, -15.971306301051234, -494.8176601252944, -547.6180164851908, -439.9122575226197, -540.4607312937263, -308.8337433858219, -724.4640744591209, -3.0600038258694404, 198.24474115352143, 16.56018451430458, 93.38407220446925, 129.0345665562386, 86.2044427312857, 153.8532614486495, 149.56151127115143, 46.69179274697944, 77.9976967644412, -5.056710582051046, -43.759653458162745, 180.38604434911935, -497.83566163307074, -192.74654403635085, -241.181783257211, -614.222343873007, -387.93985546561964, -21.869472174214053, 178.264972115026, 81.83117039182294, -0.081414909601723, -592.2223191383441, 159.8696393273374, 158.9900943947145, -4.579173797409014, -196.22437011231452, -202.53099569399635, -384.0990529573087, -450.21809928804464, -683.3067368407999, -729.5080409956763, -666.9340872274727, -166.59076534078494, -321.08191691645936, -467.2046986242599, -288.3650784212666, -685.4285224786221, -2.6167886772423907, 2.0000000000000013, -313.34869728737004, -491.26796173505477, 0.28355548209784337, -638.4788589976624, -651.7155922254557, -1.5840109665456645, -277.02258906035246, -465.67560712761093, -624.5124212083599, -2.8737736569035945, -438.044259432029, -383.79046385123365, -395.6124623485299, -174.58485536205262, -645.0312122671986, -643.7435334260442, -644.766475093212, -5.997430024049365, -480.1161828793087, -3.6709141394225107, -824.629713203318, -309.8273871400984, -1.2316248044433238, -510.1672494599829, -455.75679195636553, -435.66302583761137, -482.1639556693462, -37.397226777785626, -503.204600905856, -867.7620715353576, -502.787404202527, -687.2373773627659, -262.9121523541274, -492.67529680119964, -6.919630106112409, -601.6445003479985, -243.68629444412488, -11.356415843711952, -2.5091441985523977, -560.7566848352349, -474.89732231021964, -539.5043503915078, -468.08323130782355, -546.0418572817924, -423.7075422361109, -121.58049931947068, -29.190862672974177, -608.0129449664335, -19.593604175255408, -654.2304668262285, -660.1980568105907, -0.6363701720595636, -15.516228161618384, 94.34180109531499, 139.19662799277108, 0.563326793916144, -23.313479408732803, -643.0067738450463, -780.1877344752753, -445.05964526545245, 2.0000000000000013, 0.9008291943589991, -172.47100741162404, 47.95696224405028, -23.43629338902155], "policy_predator_policy_reward": [25.513888211150988, 12.981758099763193, 90.50465201241123, 9.826283613069284, 140.12751090769208, 158.23701784227964, 300.9825635229224, 10.822359207625142, 17.028817305214922, 316.4120808084405, 180.1463062673858, 247.05767348828473, 714.8283967143599, 237.57485961591536, 22.15180117773371, 73.57151559084397, 0.7416756983268291, 508.7090522819895, 13.69800265660154, 470.55068665207716, 283.43554066744315, 31.842823553742296, 346.2985316452606, 50.37093640798823, 40.94159094565791, 51.10057123693899, 13.405733477171605, 6.2407686864672005, 28.655120220527944, 20.68037556712462, 15.303067738323602, 81.84935444341329, 25.723545565643796, 61.79340895405649, 232.1111633724877, 379.1437702812573, 136.94290192286593, 9.601773986741739, 147.14830836998064, 575.8749380444842, 296.9288522082328, 284.5269954180083, 23.650045543695644, 29.071270461649277, 269.70397720766135, 19.547117171374943, 51.3219148396501, 128.62250863454338, 196.08303224738177, 59.62642229289303, 432.81057714270037, 85.3607945890705, 18.964820862066514, 12.71220294221498, 118.72215265005273, 110.83618082387264, 297.68425422307064, 1.0846745330638614, 58.905612275547945, 812.646804288777, 65.99617894066856, 30.079317383215866, 369.6024456661951, 298.4867147064609, 202.41612728740887, 36.842863323871015, 36.766199440341495, 17.018131255183288, 3.2775572241202178, 193.32944543626158, 4.622981260286832, 0.0, 196.0818322357357, 144.40388477760393, 37.878853593261425, 47.154411325743474, 12.081334754399556, 13.379729747647191, 36.52514116039536, 0.0, 82.53140765930158, 430.35420261091, 426.94057313683703, 19.6700940666495, 99.20131514889026, 33.67810499954342, 526.4071551852408, 33.23745346730922, 17.881306301051527, 495.03766012529445, 730.7465138196993, 17.245636205704717, 40.390140633951354, 639.0160014209422, 724.4640744591209, 5.010003825869399, 0.7552588464785644, 60.37981548569523, 74.55139568697166, 45.04646729099406, 24.71251506488895, 43.81978075517579, 0.0, 94.19669598186913, 30.6923032355589, 6.996710582051005, 152.78965345816277, 0.793955650880657, 574.6891855806799, 30.934680620930436, 31.01752705046562, 723.4586468314849, 439.27560746963127, 11.021829674310174, 5.255082129349027, 64.04877536380195, 146.7556864248474, 564.498830576627, 26.440612359302825, 0.9496539186452739, 95.55953582557385, 285.63084553123537, 453.4403928589692, 351.02439908244753, 36.68456352085606, 813.4185779209545, 704.443653236431, 857.8180543630508, 36.45244188391339, 373.48006693275033, 256.601927575173, 549.2159458790345, 685.4785224786222, 4.576788677242349, 245.34029275203923, 276.9586888820276, 382.93977439800676, 161.77949907675452, 809.3543691453184, 648.1672206340675, 3.554010966545632, 277.51258906035247, 53.31506025553937, 757.7664004191445, 416.21459308846147, 27.933440000471172, 536.2235414675722, 14.532828816544013, 26.447864665160196, 672.822844953536, 312.24183802919185, 860.8250488146792, 478.95293999700056, 9.750672906357499, 718.2391225881424, 681.1630081081742, 322.04738714009807, 4.20989000096407, 735.8781503578447, 136.10179939683348, 109.38392557522675, 652.2710210110218, 39.19722677778527, 503.68460090585575, 877.8788186612577, 878.2808059206452, 780.5102215237778, 49.76661068331813, 477.6026894262395, 367.1304466838941, 667.1509752848139, 58.8423665005883, 13.28641584371191, 4.479144198552356, 630.8082215586978, 143.70865561146593, 856.6606205538266, 0.9498202638281886, 691.3874794765828, 752.1048579433975, 228.1106730697869, 21.989784286037025, 13.909987597438016, 611.9689498586712, 196.69501748416556, 865.2606719442555, 8.908974620789559, 15.439231736570907, 65.75819890468506, 27.003372007228837, 93.25944309568233, 150.1610474303601, 729.1530089877158, 917.086915767358, 449.05964526545245, 0.0, 5.560638273141569, 173.54100741162412, 58.18796495716284, 129.659727178676]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8593034171587769, "mean_inference_ms": 2.7033768116244574, "mean_action_processing_ms": 0.36694098233011796, "mean_env_wait_ms": 0.30070502570263663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004437804222106934, "StateBufferConnector_ms": 0.0036507844924926758, "ViewRequirementAgentConnector_ms": 0.12884175777435303}, "num_episodes": 23, "episode_return_max": 571.1015033535745, "episode_return_min": -307.87385763359583, "episode_return_mean": 105.87183664726734, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 343.00101807246784, "num_env_steps_trained_throughput_per_sec": 343.00101807246784, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 1312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1312000, "timers": {"training_iteration_time_ms": 12969.317, "restore_workers_time_ms": 0.013, "training_step_time_ms": 12969.266, "sample_time_ms": 1999.449, "learn_time_ms": 10950.086, "learn_throughput": 365.294, "synch_weights_time_ms": 17.729}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "done": false, "training_iteration": 82, "trial_id": "61e09_00000", "date": "2024-08-16_16-26-39", "timestamp": 1723805799, "time_this_iter_s": 11.667805194854736, "time_total_s": 1198.5916001796722, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24c0b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1198.5916001796722, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 48.41875, "ram_util_percent": 74.05625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.32098388391197, "cur_kl_coeff": 0.10678710937499997, "cur_lr": 0.00010000000000000003, "total_loss": 7.891820131029402, "policy_loss": -0.006504317241469546, "vf_loss": 7.897267562876303, "vf_explained_var": 0.06314520851644889, "kl": 0.009897104097155598, "entropy": 0.727152125892185, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.473476968965833, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 6.939473352735004, "policy_loss": -0.006224894885924798, "vf_loss": 6.942758331853876, "vf_explained_var": -0.33022071539409575, "kl": 0.009799736155596704, "entropy": 1.123201638334012, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "env_runners": {"episode_reward_max": 571.1015033535745, "episode_reward_min": -284.59158747725115, "episode_reward_mean": 102.4686302468768, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -867.7620715353576, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.24474115352143, "predator_policy": 917.086915767358}, "policy_reward_mean": {"prey_policy": -200.07258351998803, "predator_policy": 251.3068986434264}, "custom_metrics": {}, "hist_stats": {"episode_reward": [299.43804013951893, -108.43753335970935, 232.75397833954497, 329.4, 305.00607520361024, 308.8671315504348, 288.74901657440125, 93.37141678733292, 331.4, 340.2271859069864, 84.05000000000005, -284.59158747725115, 251.8599999999999, 295.2473222721197, 51.00000000000007, 296.74, 127.74377156700406, 185.12999999999977, 250.67962304648185, 296.4177006586466, 177.04999999999984, 304.82000000000005, 20.49545463735277, -93.85223820519423, 292.47547268315054, -117.53743362896998, 2.1299999999999946, -239.53812398240618, -169.88833262465465, 1.9499999999999795, 275.94000000000005, 342.0165017386736, 308.59000000000003, 290.45, 110.63000000000021, 290.21000000000004, -84.95833946781116, -100.9279532482676, 40.48810950410784, 329.40000000000015, 118.95078295352907, 346.25, 180.38683744708538, 217.834743290113, -283.4216946870321, 165.81957937633274, -77.7401734405803, 50.248096408681114, 2.009999999999981, 210.95028434669658, 53.73486722180403, 167.32713855626724, 2.45999999999999, -279.1065676612883, 3.2299999999999924, -228.64655591564636, -120.34535801055448, -115.443121675385, 2.5899999999999865, 571.1015033535745, 15.198265196520726, -93.94409166166872, -156.17203492070897, 2.2799999999999887, 385.61014884401794, -119.87269750979799, 345.1382092028207, -119.33745300672138, 3.8999999999999613, -261.13712997528927, -149.97714088167672, 473.7429379020775, 99.32909536337903, -1.727611685580083, -252.47283420839887, 8.195608023682228, 326.2999999999998, 220.67033791122498, 223.04541643475173, 5.999999999999963, 7.531467467500544, 212.3683609908676, 196.91061002167208, 271.43284983907387, 290.3908817410384, -15.056407121528084, 105.81678389257596, 3.9599999999999596, 214.5542482682027, 190.60921256006128, 182.50261663288944, 104.90000000000016, 228.80999999999997, 79.42313403738893, -145.73355566776397, 2.6999999999999864, 213.68308000777063, -80.99569116317484, 229.33865868232598, 55.76212929144581], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [17.692879621385657, 135.20048460852558, -310.4553734010963, -521.0054063730776, 2.0000000000000013, -350.7018692866951, 143.55995445630438, 133.11872953835075, -128.49713641316453, 144.25211723773845, 102.46961068809426, 26.453097388147086, -82.92166034756124, 115.96122238168766, -59.86776851757537, -364.9321864268624, 152.1351791379335, 147.587797057785, 131.55385909031173, -20.88500665725077, -215.62425422307064, 0.90532546693614, -405.618060172749, -750.5259438688273, 49.333821059331456, 106.45068261678426, -372.4616195629826, -0.3802185375524876, -8.967769078833168, -179.29122153244668, 117.45380055965848, 125.50186874481678, -0.23206663078362966, -68.63116446259438, -1.0225992008350122, 181.52961794054815, -155.310851021681, 65.50475705482327, 94.86360958883661, 116.52082615080508, -0.24996543000445648, 151.8389009279577, 164.1911766432491, 104.10368219635546, -490.5145572994806, -1.875598333378446, -175.2554107955255, -365.2074946131551, 91.17041157411008, 68.42564096060674, -494.3969589834682, -182.78508329805203, -15.971306301051234, -494.8176601252944, -547.6180164851908, -439.9122575226197, -540.4607312937263, -308.8337433858219, -724.4640744591209, -3.0600038258694404, 198.24474115352143, 16.56018451430458, 93.38407220446925, 129.0345665562386, 86.2044427312857, 153.8532614486495, 149.56151127115143, 46.69179274697944, 77.9976967644412, -5.056710582051046, -43.759653458162745, 180.38604434911935, -497.83566163307074, -192.74654403635085, -241.181783257211, -614.222343873007, -387.93985546561964, -21.869472174214053, 178.264972115026, 81.83117039182294, -0.081414909601723, -592.2223191383441, 159.8696393273374, 158.9900943947145, -4.579173797409014, -196.22437011231452, -202.53099569399635, -384.0990529573087, -450.21809928804464, -683.3067368407999, -729.5080409956763, -666.9340872274727, -166.59076534078494, -321.08191691645936, -467.2046986242599, -288.3650784212666, -685.4285224786221, -2.6167886772423907, 2.0000000000000013, -313.34869728737004, -491.26796173505477, 0.28355548209784337, -638.4788589976624, -651.7155922254557, -1.5840109665456645, -277.02258906035246, -465.67560712761093, -624.5124212083599, -2.8737736569035945, -438.044259432029, -383.79046385123365, -395.6124623485299, -174.58485536205262, -645.0312122671986, -643.7435334260442, -644.766475093212, -5.997430024049365, -480.1161828793087, -3.6709141394225107, -824.629713203318, -309.8273871400984, -1.2316248044433238, -510.1672494599829, -455.75679195636553, -435.66302583761137, -482.1639556693462, -37.397226777785626, -503.204600905856, -867.7620715353576, -502.787404202527, -687.2373773627659, -262.9121523541274, -492.67529680119964, -6.919630106112409, -601.6445003479985, -243.68629444412488, -11.356415843711952, -2.5091441985523977, -560.7566848352349, -474.89732231021964, -539.5043503915078, -468.08323130782355, -546.0418572817924, -423.7075422361109, -121.58049931947068, -29.190862672974177, -608.0129449664335, -19.593604175255408, -654.2304668262285, -660.1980568105907, -0.6363701720595636, -15.516228161618384, 94.34180109531499, 139.19662799277108, 0.563326793916144, -23.313479408732803, -643.0067738450463, -780.1877344752753, -445.05964526545245, 2.0000000000000013, 0.9008291943589991, -172.47100741162404, 47.95696224405028, -23.43629338902155, -728.6105131012484, -337.22944607811587, -314.7221128314859, -10.913475439389918, -690.7385172902036, -489.6066982530483, -269.473561866439, -366.2923982656236, -368.5465220824756, -29.65918778850454, -4.244930224961441, 2.0000000000000013, -575.1046886182146, -201.8003698947224, -17.954859351566732, 79.37825378856583, 48.88159269423086, -60.43039606131802, 102.97999999999999, -13.878761840642849, -33.23849193059301, 95.58067091772904, 2.0000000000000013, -214.80500384776968, -514.4881895501785, -442.73282288819144, -4.003082910063391, -167.69070022350965, 79.74591471579967, 78.67623965997615, -245.66282819551398, -429.40393234685644, -50.29788702800321, -104.73165453022249, -148.24144572885365, 2.0000000000000013], "policy_predator_policy_reward": [136.94290192286593, 9.601773986741739, 147.14830836998064, 575.8749380444842, 296.9288522082328, 284.5269954180083, 23.650045543695644, 29.071270461649277, 269.70397720766135, 19.547117171374943, 51.3219148396501, 128.62250863454338, 196.08303224738177, 59.62642229289303, 432.81057714270037, 85.3607945890705, 18.964820862066514, 12.71220294221498, 118.72215265005273, 110.83618082387264, 297.68425422307064, 1.0846745330638614, 58.905612275547945, 812.646804288777, 65.99617894066856, 30.079317383215866, 369.6024456661951, 298.4867147064609, 202.41612728740887, 36.842863323871015, 36.766199440341495, 17.018131255183288, 3.2775572241202178, 193.32944543626158, 4.622981260286832, 0.0, 196.0818322357357, 144.40388477760393, 37.878853593261425, 47.154411325743474, 12.081334754399556, 13.379729747647191, 36.52514116039536, 0.0, 82.53140765930158, 430.35420261091, 426.94057313683703, 19.6700940666495, 99.20131514889026, 33.67810499954342, 526.4071551852408, 33.23745346730922, 17.881306301051527, 495.03766012529445, 730.7465138196993, 17.245636205704717, 40.390140633951354, 639.0160014209422, 724.4640744591209, 5.010003825869399, 0.7552588464785644, 60.37981548569523, 74.55139568697166, 45.04646729099406, 24.71251506488895, 43.81978075517579, 0.0, 94.19669598186913, 30.6923032355589, 6.996710582051005, 152.78965345816277, 0.793955650880657, 574.6891855806799, 30.934680620930436, 31.01752705046562, 723.4586468314849, 439.27560746963127, 11.021829674310174, 5.255082129349027, 64.04877536380195, 146.7556864248474, 564.498830576627, 26.440612359302825, 0.9496539186452739, 95.55953582557385, 285.63084553123537, 453.4403928589692, 351.02439908244753, 36.68456352085606, 813.4185779209545, 704.443653236431, 857.8180543630508, 36.45244188391339, 373.48006693275033, 256.601927575173, 549.2159458790345, 685.4785224786222, 4.576788677242349, 245.34029275203923, 276.9586888820276, 382.93977439800676, 161.77949907675452, 809.3543691453184, 648.1672206340675, 3.554010966545632, 277.51258906035247, 53.31506025553937, 757.7664004191445, 416.21459308846147, 27.933440000471172, 536.2235414675722, 14.532828816544013, 26.447864665160196, 672.822844953536, 312.24183802919185, 860.8250488146792, 478.95293999700056, 9.750672906357499, 718.2391225881424, 681.1630081081742, 322.04738714009807, 4.20989000096407, 735.8781503578447, 136.10179939683348, 109.38392557522675, 652.2710210110218, 39.19722677778527, 503.68460090585575, 877.8788186612577, 878.2808059206452, 780.5102215237778, 49.76661068331813, 477.6026894262395, 367.1304466838941, 667.1509752848139, 58.8423665005883, 13.28641584371191, 4.479144198552356, 630.8082215586978, 143.70865561146593, 856.6606205538266, 0.9498202638281886, 691.3874794765828, 752.1048579433975, 228.1106730697869, 21.989784286037025, 13.909987597438016, 611.9689498586712, 196.69501748416556, 865.2606719442555, 8.908974620789559, 15.439231736570907, 65.75819890468506, 27.003372007228837, 93.25944309568233, 150.1610474303601, 729.1530089877158, 917.086915767358, 449.05964526545245, 0.0, 5.560638273141569, 173.54100741162412, 58.18796495716284, 129.659727178676, 512.8809434542042, 749.869625746832, 302.9455028924359, 294.1229352175145, 750.2326254171475, 720.503471867141, 315.2276300107241, 305.48192299981025, 389.9528345590799, 114.0696592044761, 6.204930224961399, 0.0, 494.12278976533986, 497.33651701580004, 57.638202860898495, 71.54761526216396, 36.35107801349756, 157.70034198647963, 0.0, 15.798761840642808, 149.2484919305929, 17.21932908227108, 119.49197044882109, 172.73616743633752, 64.6977212574219, 746.7897355131834, 166.49435213391783, 7.899430999655065, 23.261558002267147, 31.999367629727914, 298.03954933555815, 296.0315200436373, 188.44841033403225, 195.91978990651958, 151.1559921960474, 50.84758282425139]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8568004002697913, "mean_inference_ms": 2.6918841131359676, "mean_action_processing_ms": 0.36539253757145096, "mean_env_wait_ms": 0.2998736463851296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004339098930358887, "StateBufferConnector_ms": 0.0035915374755859375, "ViewRequirementAgentConnector_ms": 0.12102103233337402}, "num_episodes": 18, "episode_return_max": 571.1015033535745, "episode_return_min": -284.59158747725115, "episode_return_mean": 102.4686302468768, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 353.5464677396848, "num_env_steps_trained_throughput_per_sec": 353.5464677396848, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 1328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1328000, "timers": {"training_iteration_time_ms": 12638.429, "restore_workers_time_ms": 0.013, "training_step_time_ms": 12638.38, "sample_time_ms": 1960.041, "learn_time_ms": 10658.674, "learn_throughput": 375.281, "synch_weights_time_ms": 17.871}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "done": false, "training_iteration": 83, "trial_id": "61e09_00000", "date": "2024-08-16_16-26-50", "timestamp": 1723805810, "time_this_iter_s": 11.324440002441406, "time_total_s": 1209.9160401821136, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24c0dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1209.9160401821136, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 40.625, "ram_util_percent": 74.30000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.078623886556222, "cur_kl_coeff": 0.10678710937499997, "cur_lr": 0.00010000000000000003, "total_loss": 6.337781728260101, "policy_loss": -0.0039244728449919315, "vf_loss": 6.340365388658312, "vf_explained_var": 0.0833063631461411, "kl": 0.012555809827482176, "entropy": 0.7119571755172084, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.68621768490978, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 6.209729902580301, "policy_loss": -0.0074808980695528805, "vf_loss": 6.214818501094031, "vf_explained_var": -0.05849095053142971, "kl": 0.00797435465537544, "entropy": 1.0562691753818876, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 571.1015033535745, "episode_reward_min": -283.4216946870321, "episode_reward_mean": 85.11685854771224, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -867.7620715353576, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.24474115352143, "predator_policy": 917.086915767358}, "policy_reward_mean": {"prey_policy": -198.3761925501953, "predator_policy": 240.93462182405142}, "custom_metrics": {}, "hist_stats": {"episode_reward": [250.67962304648185, 296.4177006586466, 177.04999999999984, 304.82000000000005, 20.49545463735277, -93.85223820519423, 292.47547268315054, -117.53743362896998, 2.1299999999999946, -239.53812398240618, -169.88833262465465, 1.9499999999999795, 275.94000000000005, 342.0165017386736, 308.59000000000003, 290.45, 110.63000000000021, 290.21000000000004, -84.95833946781116, -100.9279532482676, 40.48810950410784, 329.40000000000015, 118.95078295352907, 346.25, 180.38683744708538, 217.834743290113, -283.4216946870321, 165.81957937633274, -77.7401734405803, 50.248096408681114, 2.009999999999981, 210.95028434669658, 53.73486722180403, 167.32713855626724, 2.45999999999999, -279.1065676612883, 3.2299999999999924, -228.64655591564636, -120.34535801055448, -115.443121675385, 2.5899999999999865, 571.1015033535745, 15.198265196520726, -93.94409166166872, -156.17203492070897, 2.2799999999999887, 385.61014884401794, -119.87269750979799, 345.1382092028207, -119.33745300672138, 3.8999999999999613, -261.13712997528927, -149.97714088167672, 473.7429379020775, 99.32909536337903, -1.727611685580083, -252.47283420839887, 8.195608023682228, 326.2999999999998, 220.67033791122498, 223.04541643475173, 5.999999999999963, 7.531467467500544, 212.3683609908676, 196.91061002167208, 271.43284983907387, 290.3908817410384, -15.056407121528084, 105.81678389257596, 3.9599999999999596, 214.5542482682027, 190.60921256006128, 182.50261663288944, 104.90000000000016, 228.80999999999997, 79.42313403738893, -145.73355566776397, 2.6999999999999864, 213.68308000777063, -80.99569116317484, 229.33865868232598, 55.76212929144581, 5.339999999999932, 4.219999999999954, 194.4899999999998, 43.56999999999958, -215.89725752318338, 274.70849954742664, 64.73728685103013, 45.289999999999466, 99.47998404617712, 180.020827203703, 108.84973366358554, 160.30999999999983, 320.8692204535099, 224.62000000000012, -2.0905973419243242, 7.789999999999922, 163.32999999999956, 13.139950687216793], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-155.310851021681, 65.50475705482327, 94.86360958883661, 116.52082615080508, -0.24996543000445648, 151.8389009279577, 164.1911766432491, 104.10368219635546, -490.5145572994806, -1.875598333378446, -175.2554107955255, -365.2074946131551, 91.17041157411008, 68.42564096060674, -494.3969589834682, -182.78508329805203, -15.971306301051234, -494.8176601252944, -547.6180164851908, -439.9122575226197, -540.4607312937263, -308.8337433858219, -724.4640744591209, -3.0600038258694404, 198.24474115352143, 16.56018451430458, 93.38407220446925, 129.0345665562386, 86.2044427312857, 153.8532614486495, 149.56151127115143, 46.69179274697944, 77.9976967644412, -5.056710582051046, -43.759653458162745, 180.38604434911935, -497.83566163307074, -192.74654403635085, -241.181783257211, -614.222343873007, -387.93985546561964, -21.869472174214053, 178.264972115026, 81.83117039182294, -0.081414909601723, -592.2223191383441, 159.8696393273374, 158.9900943947145, -4.579173797409014, -196.22437011231452, -202.53099569399635, -384.0990529573087, -450.21809928804464, -683.3067368407999, -729.5080409956763, -666.9340872274727, -166.59076534078494, -321.08191691645936, -467.2046986242599, -288.3650784212666, -685.4285224786221, -2.6167886772423907, 2.0000000000000013, -313.34869728737004, -491.26796173505477, 0.28355548209784337, -638.4788589976624, -651.7155922254557, -1.5840109665456645, -277.02258906035246, -465.67560712761093, -624.5124212083599, -2.8737736569035945, -438.044259432029, -383.79046385123365, -395.6124623485299, -174.58485536205262, -645.0312122671986, -643.7435334260442, -644.766475093212, -5.997430024049365, -480.1161828793087, -3.6709141394225107, -824.629713203318, -309.8273871400984, -1.2316248044433238, -510.1672494599829, -455.75679195636553, -435.66302583761137, -482.1639556693462, -37.397226777785626, -503.204600905856, -867.7620715353576, -502.787404202527, -687.2373773627659, -262.9121523541274, -492.67529680119964, -6.919630106112409, -601.6445003479985, -243.68629444412488, -11.356415843711952, -2.5091441985523977, -560.7566848352349, -474.89732231021964, -539.5043503915078, -468.08323130782355, -546.0418572817924, -423.7075422361109, -121.58049931947068, -29.190862672974177, -608.0129449664335, -19.593604175255408, -654.2304668262285, -660.1980568105907, -0.6363701720595636, -15.516228161618384, 94.34180109531499, 139.19662799277108, 0.563326793916144, -23.313479408732803, -643.0067738450463, -780.1877344752753, -445.05964526545245, 2.0000000000000013, 0.9008291943589991, -172.47100741162404, 47.95696224405028, -23.43629338902155, -728.6105131012484, -337.22944607811587, -314.7221128314859, -10.913475439389918, -690.7385172902036, -489.6066982530483, -269.473561866439, -366.2923982656236, -368.5465220824756, -29.65918778850454, -4.244930224961441, 2.0000000000000013, -575.1046886182146, -201.8003698947224, -17.954859351566732, 79.37825378856583, 48.88159269423086, -60.43039606131802, 102.97999999999999, -13.878761840642849, -33.23849193059301, 95.58067091772904, 2.0000000000000013, -214.80500384776968, -514.4881895501785, -442.73282288819144, -4.003082910063391, -167.69070022350965, 79.74591471579967, 78.67623965997615, -245.66282819551398, -429.40393234685644, -50.29788702800321, -104.73165453022249, -148.24144572885365, 2.0000000000000013, -7.91198829196248, -92.6969426672236, -7.63681634034541, -83.59054590791908, 75.55471823432731, 29.806758217024, -0.7715018849926116, -109.54190126407633, -418.6475952081317, -503.82871719041475, -321.7157056166606, -28.837027140195975, -11.103465579742537, -64.61253284382492, 12.000138660423488, -3.6632544014393282, -13.215873217360675, -221.24102807100985, 41.582195120430306, 46.31873949773027, -1.381772655260423, 89.33155243566344, 92.2146139416493, 56.7574857775405, 8.399135752360841, 107.90252016656348, 87.47351143224297, 111.7518341360594, -235.30318180408403, -161.0751880145448, -1.8332231898472535, -26.775546099634003, 41.55721152367071, 115.85000000000005, -87.6052406501139, -183.0944499979787], "policy_predator_policy_reward": [196.0818322357357, 144.40388477760393, 37.878853593261425, 47.154411325743474, 12.081334754399556, 13.379729747647191, 36.52514116039536, 0.0, 82.53140765930158, 430.35420261091, 426.94057313683703, 19.6700940666495, 99.20131514889026, 33.67810499954342, 526.4071551852408, 33.23745346730922, 17.881306301051527, 495.03766012529445, 730.7465138196993, 17.245636205704717, 40.390140633951354, 639.0160014209422, 724.4640744591209, 5.010003825869399, 0.7552588464785644, 60.37981548569523, 74.55139568697166, 45.04646729099406, 24.71251506488895, 43.81978075517579, 0.0, 94.19669598186913, 30.6923032355589, 6.996710582051005, 152.78965345816277, 0.793955650880657, 574.6891855806799, 30.934680620930436, 31.01752705046562, 723.4586468314849, 439.27560746963127, 11.021829674310174, 5.255082129349027, 64.04877536380195, 146.7556864248474, 564.498830576627, 26.440612359302825, 0.9496539186452739, 95.55953582557385, 285.63084553123537, 453.4403928589692, 351.02439908244753, 36.68456352085606, 813.4185779209545, 704.443653236431, 857.8180543630508, 36.45244188391339, 373.48006693275033, 256.601927575173, 549.2159458790345, 685.4785224786222, 4.576788677242349, 245.34029275203923, 276.9586888820276, 382.93977439800676, 161.77949907675452, 809.3543691453184, 648.1672206340675, 3.554010966545632, 277.51258906035247, 53.31506025553937, 757.7664004191445, 416.21459308846147, 27.933440000471172, 536.2235414675722, 14.532828816544013, 26.447864665160196, 672.822844953536, 312.24183802919185, 860.8250488146792, 478.95293999700056, 9.750672906357499, 718.2391225881424, 681.1630081081742, 322.04738714009807, 4.20989000096407, 735.8781503578447, 136.10179939683348, 109.38392557522675, 652.2710210110218, 39.19722677778527, 503.68460090585575, 877.8788186612577, 878.2808059206452, 780.5102215237778, 49.76661068331813, 477.6026894262395, 367.1304466838941, 667.1509752848139, 58.8423665005883, 13.28641584371191, 4.479144198552356, 630.8082215586978, 143.70865561146593, 856.6606205538266, 0.9498202638281886, 691.3874794765828, 752.1048579433975, 228.1106730697869, 21.989784286037025, 13.909987597438016, 611.9689498586712, 196.69501748416556, 865.2606719442555, 8.908974620789559, 15.439231736570907, 65.75819890468506, 27.003372007228837, 93.25944309568233, 150.1610474303601, 729.1530089877158, 917.086915767358, 449.05964526545245, 0.0, 5.560638273141569, 173.54100741162412, 58.18796495716284, 129.659727178676, 512.8809434542042, 749.869625746832, 302.9455028924359, 294.1229352175145, 750.2326254171475, 720.503471867141, 315.2276300107241, 305.48192299981025, 389.9528345590799, 114.0696592044761, 6.204930224961399, 0.0, 494.12278976533986, 497.33651701580004, 57.638202860898495, 71.54761526216396, 36.35107801349756, 157.70034198647963, 0.0, 15.798761840642808, 149.2484919305929, 17.21932908227108, 119.49197044882109, 172.73616743633752, 64.6977212574219, 746.7897355131834, 166.49435213391783, 7.899430999655065, 23.261558002267147, 31.999367629727914, 298.03954933555815, 296.0315200436373, 188.44841033403225, 195.91978990651958, 151.1559921960474, 50.84758282425139, 52.55011717945363, 53.39881377973213, 93.03911660202373, 2.408245646241015, 3.6352817656726266, 85.49324178297604, 146.52126650141784, 7.362136647651, 63.29398068530142, 643.285074190063, 309.1640603149041, 316.0971719893799, 63.895748496418285, 76.55753677817938, 8.834943969498212, 28.118171771517567, 208.492880794622, 125.44400453992509, 46.616721546941214, 45.503171038601636, 4.4747789966845595, 16.425174886497764, 0.0, 11.3379002808101, 94.48786803670568, 110.07969649788045, 16.43648856775716, 8.958165863940588, 120.12940596372798, 274.15836651297445, 3.8032231898472153, 32.595546099634284, 0.0, 5.922788476329184, 43.294344295614245, 240.54529703969445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8540126069534978, "mean_inference_ms": 2.684348742818922, "mean_action_processing_ms": 0.3642809193089285, "mean_env_wait_ms": 0.29880653536589236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004243373870849609, "StateBufferConnector_ms": 0.003348112106323242, "ViewRequirementAgentConnector_ms": 0.12184178829193115}, "num_episodes": 18, "episode_return_max": 571.1015033535745, "episode_return_min": -283.4216946870321, "episode_return_mean": 85.11685854771224, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 359.8233501779909, "num_env_steps_trained_throughput_per_sec": 359.8233501779909, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 12383.869, "restore_workers_time_ms": 0.013, "training_step_time_ms": 12383.821, "sample_time_ms": 1937.895, "learn_time_ms": 10426.561, "learn_throughput": 383.636, "synch_weights_time_ms": 17.863}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 84, "trial_id": "61e09_00000", "date": "2024-08-16_16-27-01", "timestamp": 1723805821, "time_this_iter_s": 11.136661052703857, "time_total_s": 1221.0527012348175, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b55f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1221.0527012348175, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 43.8, "ram_util_percent": 74.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.076170759352427, "cur_kl_coeff": 0.10678710937499997, "cur_lr": 0.00010000000000000003, "total_loss": 5.705708688150638, "policy_loss": -0.00643300714966639, "vf_loss": 5.711196302484583, "vf_explained_var": 0.03950723166818972, "kl": 0.008853100252358378, "entropy": 0.7072990259165486, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9859155588364474, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 6.806448877425421, "policy_loss": -0.01142120371577601, "vf_loss": 6.814761917679398, "vf_explained_var": -0.5511429589892191, "kl": 0.010360513659296557, "entropy": 1.0997976341575542, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 571.1015033535745, "episode_reward_min": -283.4216946870321, "episode_reward_mean": 73.63130507619172, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -867.7620715353576, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 159.8696393273374, "predator_policy": 917.086915767358}, "policy_reward_mean": {"prey_policy": -198.31587554436243, "predator_policy": 235.13152808245823}, "custom_metrics": {}, "hist_stats": {"episode_reward": [118.95078295352907, 346.25, 180.38683744708538, 217.834743290113, -283.4216946870321, 165.81957937633274, -77.7401734405803, 50.248096408681114, 2.009999999999981, 210.95028434669658, 53.73486722180403, 167.32713855626724, 2.45999999999999, -279.1065676612883, 3.2299999999999924, -228.64655591564636, -120.34535801055448, -115.443121675385, 2.5899999999999865, 571.1015033535745, 15.198265196520726, -93.94409166166872, -156.17203492070897, 2.2799999999999887, 385.61014884401794, -119.87269750979799, 345.1382092028207, -119.33745300672138, 3.8999999999999613, -261.13712997528927, -149.97714088167672, 473.7429379020775, 99.32909536337903, -1.727611685580083, -252.47283420839887, 8.195608023682228, 326.2999999999998, 220.67033791122498, 223.04541643475173, 5.999999999999963, 7.531467467500544, 212.3683609908676, 196.91061002167208, 271.43284983907387, 290.3908817410384, -15.056407121528084, 105.81678389257596, 3.9599999999999596, 214.5542482682027, 190.60921256006128, 182.50261663288944, 104.90000000000016, 228.80999999999997, 79.42313403738893, -145.73355566776397, 2.6999999999999864, 213.68308000777063, -80.99569116317484, 229.33865868232598, 55.76212929144581, 5.339999999999932, 4.219999999999954, 194.4899999999998, 43.56999999999958, -215.89725752318338, 274.70849954742664, 64.73728685103013, 45.289999999999466, 99.47998404617712, 180.020827203703, 108.84973366358554, 160.30999999999983, 320.8692204535099, 224.62000000000012, -2.0905973419243242, 7.789999999999922, 163.32999999999956, 13.139950687216793, 3.89999999999996, 9.408509002726351, -21.030857265065645, 245.03999999999985, 2.449999999999992, 10.82999999999994, 133.4241439045257, -169.37074996168377, 299.03375466118956, 110.77000000000064, 106.43000000000067, -46.22935674035593, 98.0712676915294, -35.116726764883936, 11.595918931668363, -46.794482935101, 67.98031857907124, -112.91324774819324, 285.94999999999976, 373.15789311489647, 116.42000000000003, -64.52129051126848], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-0.081414909601723, -592.2223191383441, 159.8696393273374, 158.9900943947145, -4.579173797409014, -196.22437011231452, -202.53099569399635, -384.0990529573087, -450.21809928804464, -683.3067368407999, -729.5080409956763, -666.9340872274727, -166.59076534078494, -321.08191691645936, -467.2046986242599, -288.3650784212666, -685.4285224786221, -2.6167886772423907, 2.0000000000000013, -313.34869728737004, -491.26796173505477, 0.28355548209784337, -638.4788589976624, -651.7155922254557, -1.5840109665456645, -277.02258906035246, -465.67560712761093, -624.5124212083599, -2.8737736569035945, -438.044259432029, -383.79046385123365, -395.6124623485299, -174.58485536205262, -645.0312122671986, -643.7435334260442, -644.766475093212, -5.997430024049365, -480.1161828793087, -3.6709141394225107, -824.629713203318, -309.8273871400984, -1.2316248044433238, -510.1672494599829, -455.75679195636553, -435.66302583761137, -482.1639556693462, -37.397226777785626, -503.204600905856, -867.7620715353576, -502.787404202527, -687.2373773627659, -262.9121523541274, -492.67529680119964, -6.919630106112409, -601.6445003479985, -243.68629444412488, -11.356415843711952, -2.5091441985523977, -560.7566848352349, -474.89732231021964, -539.5043503915078, -468.08323130782355, -546.0418572817924, -423.7075422361109, -121.58049931947068, -29.190862672974177, -608.0129449664335, -19.593604175255408, -654.2304668262285, -660.1980568105907, -0.6363701720595636, -15.516228161618384, 94.34180109531499, 139.19662799277108, 0.563326793916144, -23.313479408732803, -643.0067738450463, -780.1877344752753, -445.05964526545245, 2.0000000000000013, 0.9008291943589991, -172.47100741162404, 47.95696224405028, -23.43629338902155, -728.6105131012484, -337.22944607811587, -314.7221128314859, -10.913475439389918, -690.7385172902036, -489.6066982530483, -269.473561866439, -366.2923982656236, -368.5465220824756, -29.65918778850454, -4.244930224961441, 2.0000000000000013, -575.1046886182146, -201.8003698947224, -17.954859351566732, 79.37825378856583, 48.88159269423086, -60.43039606131802, 102.97999999999999, -13.878761840642849, -33.23849193059301, 95.58067091772904, 2.0000000000000013, -214.80500384776968, -514.4881895501785, -442.73282288819144, -4.003082910063391, -167.69070022350965, 79.74591471579967, 78.67623965997615, -245.66282819551398, -429.40393234685644, -50.29788702800321, -104.73165453022249, -148.24144572885365, 2.0000000000000013, -7.91198829196248, -92.6969426672236, -7.63681634034541, -83.59054590791908, 75.55471823432731, 29.806758217024, -0.7715018849926116, -109.54190126407633, -418.6475952081317, -503.82871719041475, -321.7157056166606, -28.837027140195975, -11.103465579742537, -64.61253284382492, 12.000138660423488, -3.6632544014393282, -13.215873217360675, -221.24102807100985, 41.582195120430306, 46.31873949773027, -1.381772655260423, 89.33155243566344, 92.2146139416493, 56.7574857775405, 8.399135752360841, 107.90252016656348, 87.47351143224297, 111.7518341360594, -235.30318180408403, -161.0751880145448, -1.8332231898472535, -26.775546099634003, 41.55721152367071, 115.85000000000005, -87.6052406501139, -183.0944499979787, -12.430404863372017, 0.17644777751065205, -93.16117612007078, -53.48647468266344, -189.15530673823955, -309.104534299347, 78.46849822780909, 29.32305622716166, -238.76600703993137, -6.512042221594772, 0.02990363429682847, -120.84137542705133, 7.328779147759313, -4.736343803161425, -498.25419132341824, -361.9825468500747, -367.1662944309332, -3.8664947714364057, 70.68066614005537, 2.0000000000000013, 34.191059198030544, 13.441357834523815, -121.43962576384428, -189.4694190309374, -240.563218706576, 2.0000000000000013, -120.35804281052505, -107.5778873159862, -201.32615993141295, -55.94784813543528, -270.5229382094745, -252.26354042847365, -51.4342302935364, -126.22937573636425, -169.39353105102046, -204.3447661137101, 115.02113776406759, 133.64932851819538, -20.210696885393073, -427.8822601387214, 61.814944189127075, -46.66747312226754, -157.59680117836103, -210.0830463780019], "policy_predator_policy_reward": [146.7556864248474, 564.498830576627, 26.440612359302825, 0.9496539186452739, 95.55953582557385, 285.63084553123537, 453.4403928589692, 351.02439908244753, 36.68456352085606, 813.4185779209545, 704.443653236431, 857.8180543630508, 36.45244188391339, 373.48006693275033, 256.601927575173, 549.2159458790345, 685.4785224786222, 4.576788677242349, 245.34029275203923, 276.9586888820276, 382.93977439800676, 161.77949907675452, 809.3543691453184, 648.1672206340675, 3.554010966545632, 277.51258906035247, 53.31506025553937, 757.7664004191445, 416.21459308846147, 27.933440000471172, 536.2235414675722, 14.532828816544013, 26.447864665160196, 672.822844953536, 312.24183802919185, 860.8250488146792, 478.95293999700056, 9.750672906357499, 718.2391225881424, 681.1630081081742, 322.04738714009807, 4.20989000096407, 735.8781503578447, 136.10179939683348, 109.38392557522675, 652.2710210110218, 39.19722677778527, 503.68460090585575, 877.8788186612577, 878.2808059206452, 780.5102215237778, 49.76661068331813, 477.6026894262395, 367.1304466838941, 667.1509752848139, 58.8423665005883, 13.28641584371191, 4.479144198552356, 630.8082215586978, 143.70865561146593, 856.6606205538266, 0.9498202638281886, 691.3874794765828, 752.1048579433975, 228.1106730697869, 21.989784286037025, 13.909987597438016, 611.9689498586712, 196.69501748416556, 865.2606719442555, 8.908974620789559, 15.439231736570907, 65.75819890468506, 27.003372007228837, 93.25944309568233, 150.1610474303601, 729.1530089877158, 917.086915767358, 449.05964526545245, 0.0, 5.560638273141569, 173.54100741162412, 58.18796495716284, 129.659727178676, 512.8809434542042, 749.869625746832, 302.9455028924359, 294.1229352175145, 750.2326254171475, 720.503471867141, 315.2276300107241, 305.48192299981025, 389.9528345590799, 114.0696592044761, 6.204930224961399, 0.0, 494.12278976533986, 497.33651701580004, 57.638202860898495, 71.54761526216396, 36.35107801349756, 157.70034198647963, 0.0, 15.798761840642808, 149.2484919305929, 17.21932908227108, 119.49197044882109, 172.73616743633752, 64.6977212574219, 746.7897355131834, 166.49435213391783, 7.899430999655065, 23.261558002267147, 31.999367629727914, 298.03954933555815, 296.0315200436373, 188.44841033403225, 195.91978990651958, 151.1559921960474, 50.84758282425139, 52.55011717945363, 53.39881377973213, 93.03911660202373, 2.408245646241015, 3.6352817656726266, 85.49324178297604, 146.52126650141784, 7.362136647651, 63.29398068530142, 643.285074190063, 309.1640603149041, 316.0971719893799, 63.895748496418285, 76.55753677817938, 8.834943969498212, 28.118171771517567, 208.492880794622, 125.44400453992509, 46.616721546941214, 45.503171038601636, 4.4747789966845595, 16.425174886497764, 0.0, 11.3379002808101, 94.48786803670568, 110.07969649788045, 16.43648856775716, 8.958165863940588, 120.12940596372798, 274.15836651297445, 3.8032231898472153, 32.595546099634284, 0.0, 5.922788476329184, 43.294344295614245, 240.54529703969445, 14.350404863371976, 1.8035522224893494, 151.5990280634522, 4.457131742008797, 388.3866596890244, 88.84232408349557, 19.49150177219098, 117.75694377283834, 239.29600703993145, 8.432042221594731, 130.73833814726393, 0.9031336454906327, 86.70404688956607, 44.12766167036254, 101.31785631339801, 589.5481318984109, 339.16456487341657, 330.901978990143, 34.82272820027549, 3.266605659669086, 44.59894080196954, 14.19864216547615, 13.103420382038705, 251.57626767238705, 187.60217197387846, 149.032314424226, 32.179259314391714, 160.63994404723644, 229.33835308591333, 39.53157391260237, 413.3761143567867, 62.61588134605992, 62.52781830610286, 183.11610630286924, 1.0145703284043415, 259.810479088133, 37.279533717737166, 0.0, 411.84404802778596, 409.4068021112263, 45.078546123829696, 56.193982809310505, 33.736725270025765, 269.42183177506803]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8518307804779135, "mean_inference_ms": 2.679499634905472, "mean_action_processing_ms": 0.36355001662935665, "mean_env_wait_ms": 0.2980620646113403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004331231117248535, "StateBufferConnector_ms": 0.003304719924926758, "ViewRequirementAgentConnector_ms": 0.15541446208953857}, "num_episodes": 22, "episode_return_max": 571.1015033535745, "episode_return_min": -283.4216946870321, "episode_return_mean": 73.63130507619172, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 340.7600547345773, "num_env_steps_trained_throughput_per_sec": 340.7600547345773, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 12173.803, "restore_workers_time_ms": 0.013, "training_step_time_ms": 12173.759, "sample_time_ms": 1956.96, "learn_time_ms": 10198.657, "learn_throughput": 392.209, "synch_weights_time_ms": 16.907}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 85, "trial_id": "61e09_00000", "date": "2024-08-16_16-27-13", "timestamp": 1723805833, "time_this_iter_s": 11.744926929473877, "time_total_s": 1232.7976281642914, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x300255790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1232.7976281642914, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 43.81764705882353, "ram_util_percent": 74.28823529411765}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7312455697034403, "cur_kl_coeff": 0.10678710937499997, "cur_lr": 0.00010000000000000003, "total_loss": 4.997932958224463, "policy_loss": -0.006984067425654127, "vf_loss": 5.003905327610238, "vf_explained_var": 0.05924850885199491, "kl": 0.009473935429536768, "entropy": 0.7473627054817462, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6948299251220846, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 7.9191493516245846, "policy_loss": -0.009179557603291142, "vf_loss": 7.925157201857794, "vf_explained_var": -0.214052426594275, "kl": 0.010572357813968272, "entropy": 1.1579753636683106, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "env_runners": {"episode_reward_max": 571.1015033535745, "episode_reward_min": -261.13712997528927, "episode_reward_mean": 82.67222714181118, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -867.7620715353576, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 139.19662799277108, "predator_policy": 917.086915767358}, "policy_reward_mean": {"prey_policy": -146.19127551344533, "predator_policy": 187.52738908435086}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.5899999999999865, 571.1015033535745, 15.198265196520726, -93.94409166166872, -156.17203492070897, 2.2799999999999887, 385.61014884401794, -119.87269750979799, 345.1382092028207, -119.33745300672138, 3.8999999999999613, -261.13712997528927, -149.97714088167672, 473.7429379020775, 99.32909536337903, -1.727611685580083, -252.47283420839887, 8.195608023682228, 326.2999999999998, 220.67033791122498, 223.04541643475173, 5.999999999999963, 7.531467467500544, 212.3683609908676, 196.91061002167208, 271.43284983907387, 290.3908817410384, -15.056407121528084, 105.81678389257596, 3.9599999999999596, 214.5542482682027, 190.60921256006128, 182.50261663288944, 104.90000000000016, 228.80999999999997, 79.42313403738893, -145.73355566776397, 2.6999999999999864, 213.68308000777063, -80.99569116317484, 229.33865868232598, 55.76212929144581, 5.339999999999932, 4.219999999999954, 194.4899999999998, 43.56999999999958, -215.89725752318338, 274.70849954742664, 64.73728685103013, 45.289999999999466, 99.47998404617712, 180.020827203703, 108.84973366358554, 160.30999999999983, 320.8692204535099, 224.62000000000012, -2.0905973419243242, 7.789999999999922, 163.32999999999956, 13.139950687216793, 3.89999999999996, 9.408509002726351, -21.030857265065645, 245.03999999999985, 2.449999999999992, 10.82999999999994, 133.4241439045257, -169.37074996168377, 299.03375466118956, 110.77000000000064, 106.43000000000067, -46.22935674035593, 98.0712676915294, -35.116726764883936, 11.595918931668363, -46.794482935101, 67.98031857907124, -112.91324774819324, 285.94999999999976, 373.15789311489647, 116.42000000000003, -64.52129051126848, -5.7517327981239585, 187.69926032341598, 61.349999999999554, 172.1089664499919, 89.09430310289912, 79.75935648081943, 26.5005983655218, -1.949423986628928, 34.51, 146.22466326993398, 37.50999999999953, 121.56000000000027, 3.469999999999972, 348.4499000645593, 12.259999999999984, -4.006868189661205, 3.989999999999959, 5.812041689241813], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-5.997430024049365, -480.1161828793087, -3.6709141394225107, -824.629713203318, -309.8273871400984, -1.2316248044433238, -510.1672494599829, -455.75679195636553, -435.66302583761137, -482.1639556693462, -37.397226777785626, -503.204600905856, -867.7620715353576, -502.787404202527, -687.2373773627659, -262.9121523541274, -492.67529680119964, -6.919630106112409, -601.6445003479985, -243.68629444412488, -11.356415843711952, -2.5091441985523977, -560.7566848352349, -474.89732231021964, -539.5043503915078, -468.08323130782355, -546.0418572817924, -423.7075422361109, -121.58049931947068, -29.190862672974177, -608.0129449664335, -19.593604175255408, -654.2304668262285, -660.1980568105907, -0.6363701720595636, -15.516228161618384, 94.34180109531499, 139.19662799277108, 0.563326793916144, -23.313479408732803, -643.0067738450463, -780.1877344752753, -445.05964526545245, 2.0000000000000013, 0.9008291943589991, -172.47100741162404, 47.95696224405028, -23.43629338902155, -728.6105131012484, -337.22944607811587, -314.7221128314859, -10.913475439389918, -690.7385172902036, -489.6066982530483, -269.473561866439, -366.2923982656236, -368.5465220824756, -29.65918778850454, -4.244930224961441, 2.0000000000000013, -575.1046886182146, -201.8003698947224, -17.954859351566732, 79.37825378856583, 48.88159269423086, -60.43039606131802, 102.97999999999999, -13.878761840642849, -33.23849193059301, 95.58067091772904, 2.0000000000000013, -214.80500384776968, -514.4881895501785, -442.73282288819144, -4.003082910063391, -167.69070022350965, 79.74591471579967, 78.67623965997615, -245.66282819551398, -429.40393234685644, -50.29788702800321, -104.73165453022249, -148.24144572885365, 2.0000000000000013, -7.91198829196248, -92.6969426672236, -7.63681634034541, -83.59054590791908, 75.55471823432731, 29.806758217024, -0.7715018849926116, -109.54190126407633, -418.6475952081317, -503.82871719041475, -321.7157056166606, -28.837027140195975, -11.103465579742537, -64.61253284382492, 12.000138660423488, -3.6632544014393282, -13.215873217360675, -221.24102807100985, 41.582195120430306, 46.31873949773027, -1.381772655260423, 89.33155243566344, 92.2146139416493, 56.7574857775405, 8.399135752360841, 107.90252016656348, 87.47351143224297, 111.7518341360594, -235.30318180408403, -161.0751880145448, -1.8332231898472535, -26.775546099634003, 41.55721152367071, 115.85000000000005, -87.6052406501139, -183.0944499979787, -12.430404863372017, 0.17644777751065205, -93.16117612007078, -53.48647468266344, -189.15530673823955, -309.104534299347, 78.46849822780909, 29.32305622716166, -238.76600703993137, -6.512042221594772, 0.02990363429682847, -120.84137542705133, 7.328779147759313, -4.736343803161425, -498.25419132341824, -361.9825468500747, -367.1662944309332, -3.8664947714364057, 70.68066614005537, 2.0000000000000013, 34.191059198030544, 13.441357834523815, -121.43962576384428, -189.4694190309374, -240.563218706576, 2.0000000000000013, -120.35804281052505, -107.5778873159862, -201.32615993141295, -55.94784813543528, -270.5229382094745, -252.26354042847365, -51.4342302935364, -126.22937573636425, -169.39353105102046, -204.3447661137101, 115.02113776406759, 133.64932851819538, -20.210696885393073, -427.8822601387214, 61.814944189127075, -46.66747312226754, -157.59680117836103, -210.0830463780019, -146.8166668924315, -280.5400457085885, 47.15635112106374, -36.06237193258894, 0.47369897999338745, 53.47199187412625, -1.4098580220855474, -188.417178975791, -7.382873406095964, 30.03943864021807, -102.6660262732746, -137.87614962326035, 7.892214497359944, -237.15799390680098, -25.35116401233658, -234.826662227652, 20.246712824982726, -25.184950739607856, -137.9329726891047, -107.9413059072219, -7.656612724135888, 25.52048212341577, 4.487426450696876, 76.59571320594783, -58.02939744774141, 0.9664175759932389, 106.41422962548086, 3.1106257456346373, -12.65758940027582, -199.37068811761546, -166.1643317630253, -29.755912495285443, 2.0000000000000013, 0.7878140007423694, -42.091733230541664, -80.85217124784121], "policy_predator_policy_reward": [478.95293999700056, 9.750672906357499, 718.2391225881424, 681.1630081081742, 322.04738714009807, 4.20989000096407, 735.8781503578447, 136.10179939683348, 109.38392557522675, 652.2710210110218, 39.19722677778527, 503.68460090585575, 877.8788186612577, 878.2808059206452, 780.5102215237778, 49.76661068331813, 477.6026894262395, 367.1304466838941, 667.1509752848139, 58.8423665005883, 13.28641584371191, 4.479144198552356, 630.8082215586978, 143.70865561146593, 856.6606205538266, 0.9498202638281886, 691.3874794765828, 752.1048579433975, 228.1106730697869, 21.989784286037025, 13.909987597438016, 611.9689498586712, 196.69501748416556, 865.2606719442555, 8.908974620789559, 15.439231736570907, 65.75819890468506, 27.003372007228837, 93.25944309568233, 150.1610474303601, 729.1530089877158, 917.086915767358, 449.05964526545245, 0.0, 5.560638273141569, 173.54100741162412, 58.18796495716284, 129.659727178676, 512.8809434542042, 749.869625746832, 302.9455028924359, 294.1229352175145, 750.2326254171475, 720.503471867141, 315.2276300107241, 305.48192299981025, 389.9528345590799, 114.0696592044761, 6.204930224961399, 0.0, 494.12278976533986, 497.33651701580004, 57.638202860898495, 71.54761526216396, 36.35107801349756, 157.70034198647963, 0.0, 15.798761840642808, 149.2484919305929, 17.21932908227108, 119.49197044882109, 172.73616743633752, 64.6977212574219, 746.7897355131834, 166.49435213391783, 7.899430999655065, 23.261558002267147, 31.999367629727914, 298.03954933555815, 296.0315200436373, 188.44841033403225, 195.91978990651958, 151.1559921960474, 50.84758282425139, 52.55011717945363, 53.39881377973213, 93.03911660202373, 2.408245646241015, 3.6352817656726266, 85.49324178297604, 146.52126650141784, 7.362136647651, 63.29398068530142, 643.285074190063, 309.1640603149041, 316.0971719893799, 63.895748496418285, 76.55753677817938, 8.834943969498212, 28.118171771517567, 208.492880794622, 125.44400453992509, 46.616721546941214, 45.503171038601636, 4.4747789966845595, 16.425174886497764, 0.0, 11.3379002808101, 94.48786803670568, 110.07969649788045, 16.43648856775716, 8.958165863940588, 120.12940596372798, 274.15836651297445, 3.8032231898472153, 32.595546099634284, 0.0, 5.922788476329184, 43.294344295614245, 240.54529703969445, 14.350404863371976, 1.8035522224893494, 151.5990280634522, 4.457131742008797, 388.3866596890244, 88.84232408349557, 19.49150177219098, 117.75694377283834, 239.29600703993145, 8.432042221594731, 130.73833814726393, 0.9031336454906327, 86.70404688956607, 44.12766167036254, 101.31785631339801, 589.5481318984109, 339.16456487341657, 330.901978990143, 34.82272820027549, 3.266605659669086, 44.59894080196954, 14.19864216547615, 13.103420382038705, 251.57626767238705, 187.60217197387846, 149.032314424226, 32.179259314391714, 160.63994404723644, 229.33835308591333, 39.53157391260237, 413.3761143567867, 62.61588134605992, 62.52781830610286, 183.11610630286924, 1.0145703284043415, 259.810479088133, 37.279533717737166, 0.0, 411.84404802778596, 409.4068021112263, 45.078546123829696, 56.193982809310505, 33.736725270025765, 269.42183177506803, 269.49662781331085, 152.108351989585, 138.90889726823218, 37.6963838667095, 1.516301020006614, 5.888008125873542, 180.32746980805194, 181.6085336398169, 14.875835851390312, 51.561902017386544, 166.08895026562945, 154.21258211172483, 26.930681797049765, 228.83569597791245, 5.832544589429302, 252.39585766392977, 7.143995236621174, 32.304242678004286, 187.21500171698256, 204.88394014927883, 9.596612724135847, 10.04951787658441, 26.073978779161077, 14.402881564193969, 59.50939744774132, 1.0235824240067626, 135.16135493073745, 103.76368976270672, 14.547589400275779, 209.74068811761512, 191.91337606864838, 0.0, 0.0, 1.202185999257632, 5.7839907422606425, 122.97195542536397]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8504375727736823, "mean_inference_ms": 2.676638248930408, "mean_action_processing_ms": 0.36310532997445477, "mean_env_wait_ms": 0.29761629769426234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004473328590393066, "StateBufferConnector_ms": 0.00329434871673584, "ViewRequirementAgentConnector_ms": 0.15619266033172607}, "num_episodes": 18, "episode_return_max": 571.1015033535745, "episode_return_min": -261.13712997528927, "episode_return_mean": 82.67222714181118, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 361.77343683035605, "num_env_steps_trained_throughput_per_sec": 361.77343683035605, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1376000, "timers": {"training_iteration_time_ms": 11919.594, "restore_workers_time_ms": 0.013, "training_step_time_ms": 11919.554, "sample_time_ms": 1909.784, "learn_time_ms": 9991.689, "learn_throughput": 400.333, "synch_weights_time_ms": 17.136}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "done": false, "training_iteration": 86, "trial_id": "61e09_00000", "date": "2024-08-16_16-27-24", "timestamp": 1723805844, "time_this_iter_s": 11.06361198425293, "time_total_s": 1243.8612401485443, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30000bee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1243.8612401485443, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 48.760000000000005, "ram_util_percent": 73.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9203778876198663, "cur_kl_coeff": 0.10678710937499997, "cur_lr": 0.00010000000000000003, "total_loss": 4.929090304980202, "policy_loss": -0.008884275631323733, "vf_loss": 4.936750061675985, "vf_explained_var": 0.07390691660068653, "kl": 0.011466925817498972, "entropy": 0.7971738750972445, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3811345421763326, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 6.926433360891998, "policy_loss": -0.008782586214507107, "vf_loss": 6.93313633348576, "vf_explained_var": -0.3166469229907586, "kl": 0.006932116728106366, "entropy": 1.050788956155222, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 373.15789311489647, "episode_reward_min": -215.89725752318338, "episode_reward_mean": 84.73292280159049, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -728.6105131012484, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 133.64932851819538, "predator_policy": 750.2326254171475}, "policy_reward_mean": {"prey_policy": -86.46800307459753, "predator_policy": 128.83446447539274}, "custom_metrics": {}, "hist_stats": {"episode_reward": [212.3683609908676, 196.91061002167208, 271.43284983907387, 290.3908817410384, -15.056407121528084, 105.81678389257596, 3.9599999999999596, 214.5542482682027, 190.60921256006128, 182.50261663288944, 104.90000000000016, 228.80999999999997, 79.42313403738893, -145.73355566776397, 2.6999999999999864, 213.68308000777063, -80.99569116317484, 229.33865868232598, 55.76212929144581, 5.339999999999932, 4.219999999999954, 194.4899999999998, 43.56999999999958, -215.89725752318338, 274.70849954742664, 64.73728685103013, 45.289999999999466, 99.47998404617712, 180.020827203703, 108.84973366358554, 160.30999999999983, 320.8692204535099, 224.62000000000012, -2.0905973419243242, 7.789999999999922, 163.32999999999956, 13.139950687216793, 3.89999999999996, 9.408509002726351, -21.030857265065645, 245.03999999999985, 2.449999999999992, 10.82999999999994, 133.4241439045257, -169.37074996168377, 299.03375466118956, 110.77000000000064, 106.43000000000067, -46.22935674035593, 98.0712676915294, -35.116726764883936, 11.595918931668363, -46.794482935101, 67.98031857907124, -112.91324774819324, 285.94999999999976, 373.15789311489647, 116.42000000000003, -64.52129051126848, -5.7517327981239585, 187.69926032341598, 61.349999999999554, 172.1089664499919, 89.09430310289912, 79.75935648081943, 26.5005983655218, -1.949423986628928, 34.51, 146.22466326993398, 37.50999999999953, 121.56000000000027, 3.469999999999972, 348.4499000645593, 12.259999999999984, -4.006868189661205, 3.989999999999959, 5.812041689241813, 64.29000000000002, 12.197262715344955, 142.33120353860875, 90.51433734064895, 3.9299999999999606, 114.4000000000004, 6.134378107495232, 217.62999999999963, -14.187351322260003, 115.73962055381747, 2.849999999999983, 45.99806466651542, 91.71599316147956, 3.159999999999977, 164.36619397228176, -19.96310541298839, 75.01785437206573, 130.92000000000058, -8.851817637994762, 136.60550941483166, 220.61999999999955, -44.992702011902, 191.63612036969317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [47.95696224405028, -23.43629338902155, -728.6105131012484, -337.22944607811587, -314.7221128314859, -10.913475439389918, -690.7385172902036, -489.6066982530483, -269.473561866439, -366.2923982656236, -368.5465220824756, -29.65918778850454, -4.244930224961441, 2.0000000000000013, -575.1046886182146, -201.8003698947224, -17.954859351566732, 79.37825378856583, 48.88159269423086, -60.43039606131802, 102.97999999999999, -13.878761840642849, -33.23849193059301, 95.58067091772904, 2.0000000000000013, -214.80500384776968, -514.4881895501785, -442.73282288819144, -4.003082910063391, -167.69070022350965, 79.74591471579967, 78.67623965997615, -245.66282819551398, -429.40393234685644, -50.29788702800321, -104.73165453022249, -148.24144572885365, 2.0000000000000013, -7.91198829196248, -92.6969426672236, -7.63681634034541, -83.59054590791908, 75.55471823432731, 29.806758217024, -0.7715018849926116, -109.54190126407633, -418.6475952081317, -503.82871719041475, -321.7157056166606, -28.837027140195975, -11.103465579742537, -64.61253284382492, 12.000138660423488, -3.6632544014393282, -13.215873217360675, -221.24102807100985, 41.582195120430306, 46.31873949773027, -1.381772655260423, 89.33155243566344, 92.2146139416493, 56.7574857775405, 8.399135752360841, 107.90252016656348, 87.47351143224297, 111.7518341360594, -235.30318180408403, -161.0751880145448, -1.8332231898472535, -26.775546099634003, 41.55721152367071, 115.85000000000005, -87.6052406501139, -183.0944499979787, -12.430404863372017, 0.17644777751065205, -93.16117612007078, -53.48647468266344, -189.15530673823955, -309.104534299347, 78.46849822780909, 29.32305622716166, -238.76600703993137, -6.512042221594772, 0.02990363429682847, -120.84137542705133, 7.328779147759313, -4.736343803161425, -498.25419132341824, -361.9825468500747, -367.1662944309332, -3.8664947714364057, 70.68066614005537, 2.0000000000000013, 34.191059198030544, 13.441357834523815, -121.43962576384428, -189.4694190309374, -240.563218706576, 2.0000000000000013, -120.35804281052505, -107.5778873159862, -201.32615993141295, -55.94784813543528, -270.5229382094745, -252.26354042847365, -51.4342302935364, -126.22937573636425, -169.39353105102046, -204.3447661137101, 115.02113776406759, 133.64932851819538, -20.210696885393073, -427.8822601387214, 61.814944189127075, -46.66747312226754, -157.59680117836103, -210.0830463780019, -146.8166668924315, -280.5400457085885, 47.15635112106374, -36.06237193258894, 0.47369897999338745, 53.47199187412625, -1.4098580220855474, -188.417178975791, -7.382873406095964, 30.03943864021807, -102.6660262732746, -137.87614962326035, 7.892214497359944, -237.15799390680098, -25.35116401233658, -234.826662227652, 20.246712824982726, -25.184950739607856, -137.9329726891047, -107.9413059072219, -7.656612724135888, 25.52048212341577, 4.487426450696876, 76.59571320594783, -58.02939744774141, 0.9664175759932389, 106.41422962548086, 3.1106257456346373, -12.65758940027582, -199.37068811761546, -166.1643317630253, -29.755912495285443, 2.0000000000000013, 0.7878140007423694, -42.091733230541664, -80.85217124784121, 2.0000000000000013, 28.554064329653222, -73.74344955617077, -105.65670597680364, -33.32350205070128, 127.45336826964083, -101.02074479075297, -197.80387257950088, -4.8257898403230755, -0.46892941702073676, 67.51157772667926, -13.378307288629596, -151.60949306833658, -5.08465733883251, 113.53860466816947, 62.34057980083506, -93.70642377449093, -141.58253070313975, -126.29347969872558, -8.99853518002195, -15.93741236298388, -132.46330564132475, -55.43021021902295, -10.131940538640732, -405.7938306560577, -87.8936400002633, -99.37665451007305, -11.601976354623448, -253.80658414631935, -207.3067519132326, -152.59692988789953, -89.18411945434438, -6.655962331067354, -110.89710541966969, -112.75262972968767, 33.09455815761143, -84.6719562694798, -98.52552858158272, -177.49290001318826, -1.0002884909865797, 95.83428631838258, 103.07712100610352, -84.80661339001844, -282.14686122509863, 77.96745184921312, 92.95003125112832], "policy_predator_policy_reward": [58.18796495716284, 129.659727178676, 512.8809434542042, 749.869625746832, 302.9455028924359, 294.1229352175145, 750.2326254171475, 720.503471867141, 315.2276300107241, 305.48192299981025, 389.9528345590799, 114.0696592044761, 6.204930224961399, 0.0, 494.12278976533986, 497.33651701580004, 57.638202860898495, 71.54761526216396, 36.35107801349756, 157.70034198647963, 0.0, 15.798761840642808, 149.2484919305929, 17.21932908227108, 119.49197044882109, 172.73616743633752, 64.6977212574219, 746.7897355131834, 166.49435213391783, 7.899430999655065, 23.261558002267147, 31.999367629727914, 298.03954933555815, 296.0315200436373, 188.44841033403225, 195.91978990651958, 151.1559921960474, 50.84758282425139, 52.55011717945363, 53.39881377973213, 93.03911660202373, 2.408245646241015, 3.6352817656726266, 85.49324178297604, 146.52126650141784, 7.362136647651, 63.29398068530142, 643.285074190063, 309.1640603149041, 316.0971719893799, 63.895748496418285, 76.55753677817938, 8.834943969498212, 28.118171771517567, 208.492880794622, 125.44400453992509, 46.616721546941214, 45.503171038601636, 4.4747789966845595, 16.425174886497764, 0.0, 11.3379002808101, 94.48786803670568, 110.07969649788045, 16.43648856775716, 8.958165863940588, 120.12940596372798, 274.15836651297445, 3.8032231898472153, 32.595546099634284, 0.0, 5.922788476329184, 43.294344295614245, 240.54529703969445, 14.350404863371976, 1.8035522224893494, 151.5990280634522, 4.457131742008797, 388.3866596890244, 88.84232408349557, 19.49150177219098, 117.75694377283834, 239.29600703993145, 8.432042221594731, 130.73833814726393, 0.9031336454906327, 86.70404688956607, 44.12766167036254, 101.31785631339801, 589.5481318984109, 339.16456487341657, 330.901978990143, 34.82272820027549, 3.266605659669086, 44.59894080196954, 14.19864216547615, 13.103420382038705, 251.57626767238705, 187.60217197387846, 149.032314424226, 32.179259314391714, 160.63994404723644, 229.33835308591333, 39.53157391260237, 413.3761143567867, 62.61588134605992, 62.52781830610286, 183.11610630286924, 1.0145703284043415, 259.810479088133, 37.279533717737166, 0.0, 411.84404802778596, 409.4068021112263, 45.078546123829696, 56.193982809310505, 33.736725270025765, 269.42183177506803, 269.49662781331085, 152.108351989585, 138.90889726823218, 37.6963838667095, 1.516301020006614, 5.888008125873542, 180.32746980805194, 181.6085336398169, 14.875835851390312, 51.561902017386544, 166.08895026562945, 154.21258211172483, 26.930681797049765, 228.83569597791245, 5.832544589429302, 252.39585766392977, 7.143995236621174, 32.304242678004286, 187.21500171698256, 204.88394014927883, 9.596612724135847, 10.04951787658441, 26.073978779161077, 14.402881564193969, 59.50939744774132, 1.0235824240067626, 135.16135493073745, 103.76368976270672, 14.547589400275779, 209.74068811761512, 191.91337606864838, 0.0, 0.0, 1.202185999257632, 5.7839907422606425, 122.97195542536397, 0.0, 33.73593567034689, 38.87670237606745, 152.72071587225227, 21.223904880018612, 26.97743243964985, 176.0729937434186, 213.26596096748395, 6.775789840323034, 2.4489294170207287, 35.13842227332075, 25.12830728862987, 47.16926140764218, 115.65926710702271, 3.2713953318305857, 38.47942019916485, 26.72510826597748, 194.37649488939303, 126.0446752424373, 124.98696019012745, 17.827412362984163, 133.423305641325, 111.56021542417876, 0.0, 290.01777429986436, 295.3856895179361, 100.59665451007315, 13.541976354623406, 308.28848253560807, 317.19104749622454, 17.465114251493922, 204.35282967776195, 101.75235467576812, 90.81856744703424, 198.1826297296873, 12.395441842388516, 124.3933219966648, 49.9523452164035, 173.61777031278558, 141.4809276062192, 10.290255287576377, 11.418337387937763, 10.113254500006741, 311.84751810320756, 8.93168844164214, 11.786948827710324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8487636001935325, "mean_inference_ms": 2.6734998776293066, "mean_action_processing_ms": 0.3625913680223829, "mean_env_wait_ms": 0.29710111314786136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004367351531982422, "StateBufferConnector_ms": 0.003237009048461914, "ViewRequirementAgentConnector_ms": 0.1435689926147461}, "num_episodes": 23, "episode_return_max": 373.15789311489647, "episode_return_min": -215.89725752318338, "episode_return_mean": 84.73292280159049, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 347.8818092109424, "num_env_steps_trained_throughput_per_sec": 347.8818092109424, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 11642.969, "restore_workers_time_ms": 0.013, "training_step_time_ms": 11642.93, "sample_time_ms": 1757.559, "learn_time_ms": 9867.175, "learn_throughput": 405.385, "synch_weights_time_ms": 17.288}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 87, "trial_id": "61e09_00000", "date": "2024-08-16_16-27-36", "timestamp": 1723805856, "time_this_iter_s": 11.507036209106445, "time_total_s": 1255.3682763576508, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3000a6ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1255.3682763576508, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 50.194117647058825, "ram_util_percent": 72.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.553332415869627, "cur_kl_coeff": 0.10678710937499997, "cur_lr": 0.00010000000000000003, "total_loss": 4.947187971816492, "policy_loss": -0.005954624601102695, "vf_loss": 4.95199371078027, "vf_explained_var": 0.08110094985003194, "kl": 0.010758733646446543, "entropy": 0.6935624924286333, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.408447498871536, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 6.771492067215934, "policy_loss": -0.005439927021199197, "vf_loss": 6.774528881355568, "vf_explained_var": -0.38213479096296604, "kl": 0.008010301205425863, "entropy": 1.0656765125415943, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "env_runners": {"episode_reward_max": 373.15789311489647, "episode_reward_min": -215.89725752318338, "episode_reward_mean": 73.29682290901538, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -503.82871719041475, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 133.64932851819538, "predator_policy": 643.285074190063}, "policy_reward_mean": {"prey_policy": -65.65580938693998, "predator_policy": 102.30422084144764}, "custom_metrics": {}, "hist_stats": {"episode_reward": [55.76212929144581, 5.339999999999932, 4.219999999999954, 194.4899999999998, 43.56999999999958, -215.89725752318338, 274.70849954742664, 64.73728685103013, 45.289999999999466, 99.47998404617712, 180.020827203703, 108.84973366358554, 160.30999999999983, 320.8692204535099, 224.62000000000012, -2.0905973419243242, 7.789999999999922, 163.32999999999956, 13.139950687216793, 3.89999999999996, 9.408509002726351, -21.030857265065645, 245.03999999999985, 2.449999999999992, 10.82999999999994, 133.4241439045257, -169.37074996168377, 299.03375466118956, 110.77000000000064, 106.43000000000067, -46.22935674035593, 98.0712676915294, -35.116726764883936, 11.595918931668363, -46.794482935101, 67.98031857907124, -112.91324774819324, 285.94999999999976, 373.15789311489647, 116.42000000000003, -64.52129051126848, -5.7517327981239585, 187.69926032341598, 61.349999999999554, 172.1089664499919, 89.09430310289912, 79.75935648081943, 26.5005983655218, -1.949423986628928, 34.51, 146.22466326993398, 37.50999999999953, 121.56000000000027, 3.469999999999972, 348.4499000645593, 12.259999999999984, -4.006868189661205, 3.989999999999959, 5.812041689241813, 64.29000000000002, 12.197262715344955, 142.33120353860875, 90.51433734064895, 3.9299999999999606, 114.4000000000004, 6.134378107495232, 217.62999999999963, -14.187351322260003, 115.73962055381747, 2.849999999999983, 45.99806466651542, 91.71599316147956, 3.159999999999977, 164.36619397228176, -19.96310541298839, 75.01785437206573, 130.92000000000058, -8.851817637994762, 136.60550941483166, 220.61999999999955, -44.992702011902, 191.63612036969317, 120.4300000000005, 113.25445479084921, 9.709999999999924, 81.14930560265424, 80.92000000000016, 8.084850276016459, 3.02999999999998, 44.44999999999962, 130.07455874799672, -48.29338260611756, 48.66126719619786, 116.18471700478389, 156.62669312814876, 4.0399999999999565, 114.83000000000023, 2.6799999999999877, 8.599999999999948, 147.57232932335984], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-148.24144572885365, 2.0000000000000013, -7.91198829196248, -92.6969426672236, -7.63681634034541, -83.59054590791908, 75.55471823432731, 29.806758217024, -0.7715018849926116, -109.54190126407633, -418.6475952081317, -503.82871719041475, -321.7157056166606, -28.837027140195975, -11.103465579742537, -64.61253284382492, 12.000138660423488, -3.6632544014393282, -13.215873217360675, -221.24102807100985, 41.582195120430306, 46.31873949773027, -1.381772655260423, 89.33155243566344, 92.2146139416493, 56.7574857775405, 8.399135752360841, 107.90252016656348, 87.47351143224297, 111.7518341360594, -235.30318180408403, -161.0751880145448, -1.8332231898472535, -26.775546099634003, 41.55721152367071, 115.85000000000005, -87.6052406501139, -183.0944499979787, -12.430404863372017, 0.17644777751065205, -93.16117612007078, -53.48647468266344, -189.15530673823955, -309.104534299347, 78.46849822780909, 29.32305622716166, -238.76600703993137, -6.512042221594772, 0.02990363429682847, -120.84137542705133, 7.328779147759313, -4.736343803161425, -498.25419132341824, -361.9825468500747, -367.1662944309332, -3.8664947714364057, 70.68066614005537, 2.0000000000000013, 34.191059198030544, 13.441357834523815, -121.43962576384428, -189.4694190309374, -240.563218706576, 2.0000000000000013, -120.35804281052505, -107.5778873159862, -201.32615993141295, -55.94784813543528, -270.5229382094745, -252.26354042847365, -51.4342302935364, -126.22937573636425, -169.39353105102046, -204.3447661137101, 115.02113776406759, 133.64932851819538, -20.210696885393073, -427.8822601387214, 61.814944189127075, -46.66747312226754, -157.59680117836103, -210.0830463780019, -146.8166668924315, -280.5400457085885, 47.15635112106374, -36.06237193258894, 0.47369897999338745, 53.47199187412625, -1.4098580220855474, -188.417178975791, -7.382873406095964, 30.03943864021807, -102.6660262732746, -137.87614962326035, 7.892214497359944, -237.15799390680098, -25.35116401233658, -234.826662227652, 20.246712824982726, -25.184950739607856, -137.9329726891047, -107.9413059072219, -7.656612724135888, 25.52048212341577, 4.487426450696876, 76.59571320594783, -58.02939744774141, 0.9664175759932389, 106.41422962548086, 3.1106257456346373, -12.65758940027582, -199.37068811761546, -166.1643317630253, -29.755912495285443, 2.0000000000000013, 0.7878140007423694, -42.091733230541664, -80.85217124784121, 2.0000000000000013, 28.554064329653222, -73.74344955617077, -105.65670597680364, -33.32350205070128, 127.45336826964083, -101.02074479075297, -197.80387257950088, -4.8257898403230755, -0.46892941702073676, 67.51157772667926, -13.378307288629596, -151.60949306833658, -5.08465733883251, 113.53860466816947, 62.34057980083506, -93.70642377449093, -141.58253070313975, -126.29347969872558, -8.99853518002195, -15.93741236298388, -132.46330564132475, -55.43021021902295, -10.131940538640732, -405.7938306560577, -87.8936400002633, -99.37665451007305, -11.601976354623448, -253.80658414631935, -207.3067519132326, -152.59692988789953, -89.18411945434438, -6.655962331067354, -110.89710541966969, -112.75262972968767, 33.09455815761143, -84.6719562694798, -98.52552858158272, -177.49290001318826, -1.0002884909865797, 95.83428631838258, 103.07712100610352, -84.80661339001844, -282.14686122509863, 77.96745184921312, 92.95003125112832, 43.788862490514916, 27.83553149457223, -123.578939708886, -124.00486245780797, -21.066095000855924, 0.903720926400042, 29.786676851822747, -4.233442223030134, -19.32776669649088, 45.965902094011845, -16.46633548747067, 2.0000000000000013, -2.954449249125746, -117.73849799689233, -105.32552149836057, -4.693729222356173, 35.490369167889, -28.699360407617405, -143.38512991614618, -134.11515454146146, 4.799417144988174, -73.51034438911843, -105.72703226536659, -65.4318128952401, -375.6860965251915, -254.9937657952198, -112.94519874394257, -22.533456074722736, 111.9089441426176, -2.4514819829970786, -3.2542818717619904, -154.50158577678573, -184.97253389435696, -1.6688469135880784, -103.58886431112967, -5.683792742915291], "policy_predator_policy_reward": [151.1559921960474, 50.84758282425139, 52.55011717945363, 53.39881377973213, 93.03911660202373, 2.408245646241015, 3.6352817656726266, 85.49324178297604, 146.52126650141784, 7.362136647651, 63.29398068530142, 643.285074190063, 309.1640603149041, 316.0971719893799, 63.895748496418285, 76.55753677817938, 8.834943969498212, 28.118171771517567, 208.492880794622, 125.44400453992509, 46.616721546941214, 45.503171038601636, 4.4747789966845595, 16.425174886497764, 0.0, 11.3379002808101, 94.48786803670568, 110.07969649788045, 16.43648856775716, 8.958165863940588, 120.12940596372798, 274.15836651297445, 3.8032231898472153, 32.595546099634284, 0.0, 5.922788476329184, 43.294344295614245, 240.54529703969445, 14.350404863371976, 1.8035522224893494, 151.5990280634522, 4.457131742008797, 388.3866596890244, 88.84232408349557, 19.49150177219098, 117.75694377283834, 239.29600703993145, 8.432042221594731, 130.73833814726393, 0.9031336454906327, 86.70404688956607, 44.12766167036254, 101.31785631339801, 589.5481318984109, 339.16456487341657, 330.901978990143, 34.82272820027549, 3.266605659669086, 44.59894080196954, 14.19864216547615, 13.103420382038705, 251.57626767238705, 187.60217197387846, 149.032314424226, 32.179259314391714, 160.63994404723644, 229.33835308591333, 39.53157391260237, 413.3761143567867, 62.61588134605992, 62.52781830610286, 183.11610630286924, 1.0145703284043415, 259.810479088133, 37.279533717737166, 0.0, 411.84404802778596, 409.4068021112263, 45.078546123829696, 56.193982809310505, 33.736725270025765, 269.42183177506803, 269.49662781331085, 152.108351989585, 138.90889726823218, 37.6963838667095, 1.516301020006614, 5.888008125873542, 180.32746980805194, 181.6085336398169, 14.875835851390312, 51.561902017386544, 166.08895026562945, 154.21258211172483, 26.930681797049765, 228.83569597791245, 5.832544589429302, 252.39585766392977, 7.143995236621174, 32.304242678004286, 187.21500171698256, 204.88394014927883, 9.596612724135847, 10.04951787658441, 26.073978779161077, 14.402881564193969, 59.50939744774132, 1.0235824240067626, 135.16135493073745, 103.76368976270672, 14.547589400275779, 209.74068811761512, 191.91337606864838, 0.0, 0.0, 1.202185999257632, 5.7839907422606425, 122.97195542536397, 0.0, 33.73593567034689, 38.87670237606745, 152.72071587225227, 21.223904880018612, 26.97743243964985, 176.0729937434186, 213.26596096748395, 6.775789840323034, 2.4489294170207287, 35.13842227332075, 25.12830728862987, 47.16926140764218, 115.65926710702271, 3.2713953318305857, 38.47942019916485, 26.72510826597748, 194.37649488939303, 126.0446752424373, 124.98696019012745, 17.827412362984163, 133.423305641325, 111.56021542417876, 0.0, 290.01777429986436, 295.3856895179361, 100.59665451007315, 13.541976354623406, 308.28848253560807, 317.19104749622454, 17.465114251493922, 204.35282967776195, 101.75235467576812, 90.81856744703424, 198.1826297296873, 12.395441842388516, 124.3933219966648, 49.9523452164035, 173.61777031278558, 141.4809276062192, 10.290255287576377, 11.418337387937763, 10.113254500006741, 311.84751810320756, 8.93168844164214, 11.786948827710324, 5.681137509485096, 43.124468505427906, 177.16376445337002, 183.67449250417263, 28.786095000856193, 1.0862790735999595, 10.971149125673584, 44.62492184818793, 21.157766696491166, 33.12409790598809, 18.14450417897428, 4.406681584513228, 4.924449249125704, 118.79849799689269, 40.8044886912397, 113.66476202947717, 38.0315451991589, 85.2520047885655, 22.82289527593608, 206.38400657555422, 34.11850064736085, 83.25369379296717, 107.2944937043741, 180.04906846101574, 398.7639722350823, 388.54258321347805, 14.946821221832401, 124.57183359683333, 0.961055857382407, 4.411481982997037, 5.224281871761948, 155.21158577678588, 77.75230907363557, 117.48907173430958, 132.37632991144994, 124.46865646595563]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8476614180309892, "mean_inference_ms": 2.6716388564694147, "mean_action_processing_ms": 0.36226079143815254, "mean_env_wait_ms": 0.2968003598094371, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004336833953857422, "StateBufferConnector_ms": 0.0032154321670532227, "ViewRequirementAgentConnector_ms": 0.1374971866607666}, "num_episodes": 18, "episode_return_max": 373.15789311489647, "episode_return_min": -215.89725752318338, "episode_return_mean": 73.29682290901538, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 337.5238637082626, "num_env_steps_trained_throughput_per_sec": 337.5238637082626, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1408000, "timers": {"training_iteration_time_ms": 11364.761, "restore_workers_time_ms": 0.013, "training_step_time_ms": 11364.723, "sample_time_ms": 1640.634, "learn_time_ms": 9706.189, "learn_throughput": 412.108, "synch_weights_time_ms": 17.113}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "done": false, "training_iteration": 88, "trial_id": "61e09_00000", "date": "2024-08-16_16-27-48", "timestamp": 1723805868, "time_this_iter_s": 11.855027914047241, "time_total_s": 1267.223304271698, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x300255670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1267.223304271698, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 49.14375, "ram_util_percent": 72.98124999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8707899247527755, "cur_kl_coeff": 0.10678710937499997, "cur_lr": 0.00010000000000000003, "total_loss": 3.8787363550650378, "policy_loss": -0.006697226054941811, "vf_loss": 3.8844581741504567, "vf_explained_var": 0.07552503590230589, "kl": 0.009134213510011565, "entropy": 0.7231148954737123, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9107165729242657, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 8.08850995775253, "policy_loss": -0.008246388502921613, "vf_loss": 8.094189901200552, "vf_explained_var": -0.04930354299999419, "kl": 0.00855478232593185, "entropy": 1.2145360951070432, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "env_runners": {"episode_reward_max": 373.15789311489647, "episode_reward_min": -169.37074996168377, "episode_reward_mean": 75.59787697952484, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -498.25419132341824, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 133.64932851819538, "predator_policy": 589.5481318984109}, "policy_reward_mean": {"prey_policy": -58.541063978743125, "predator_policy": 96.34000246850556}, "custom_metrics": {}, "hist_stats": {"episode_reward": [245.03999999999985, 2.449999999999992, 10.82999999999994, 133.4241439045257, -169.37074996168377, 299.03375466118956, 110.77000000000064, 106.43000000000067, -46.22935674035593, 98.0712676915294, -35.116726764883936, 11.595918931668363, -46.794482935101, 67.98031857907124, -112.91324774819324, 285.94999999999976, 373.15789311489647, 116.42000000000003, -64.52129051126848, -5.7517327981239585, 187.69926032341598, 61.349999999999554, 172.1089664499919, 89.09430310289912, 79.75935648081943, 26.5005983655218, -1.949423986628928, 34.51, 146.22466326993398, 37.50999999999953, 121.56000000000027, 3.469999999999972, 348.4499000645593, 12.259999999999984, -4.006868189661205, 3.989999999999959, 5.812041689241813, 64.29000000000002, 12.197262715344955, 142.33120353860875, 90.51433734064895, 3.9299999999999606, 114.4000000000004, 6.134378107495232, 217.62999999999963, -14.187351322260003, 115.73962055381747, 2.849999999999983, 45.99806466651542, 91.71599316147956, 3.159999999999977, 164.36619397228176, -19.96310541298839, 75.01785437206573, 130.92000000000058, -8.851817637994762, 136.60550941483166, 220.61999999999955, -44.992702011902, 191.63612036969317, 120.4300000000005, 113.25445479084921, 9.709999999999924, 81.14930560265424, 80.92000000000016, 8.084850276016459, 3.02999999999998, 44.44999999999962, 130.07455874799672, -48.29338260611756, 48.66126719619786, 116.18471700478389, 156.62669312814876, 4.0399999999999565, 114.83000000000023, 2.6799999999999877, 8.599999999999948, 147.57232932335984, 21.460981836794097, 143.3299999999997, 226.47999999999934, -30.21660125160031, 201.35764060162282, 75.24000000000083, 162.12999999999968, 106.51577457792774, 11.403772569080212, 132.47999999999996, 27.94624932863554, 162.13999999999885, -10.471484225300319, -41.02932976539656, 46.07086834538761, 171.1272669749547, 190.24899632644392, 19.750000000000377, 125.68000000000086, -27.367304623501077, 135.84066253963488, 120.80534243291001], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [78.46849822780909, 29.32305622716166, -238.76600703993137, -6.512042221594772, 0.02990363429682847, -120.84137542705133, 7.328779147759313, -4.736343803161425, -498.25419132341824, -361.9825468500747, -367.1662944309332, -3.8664947714364057, 70.68066614005537, 2.0000000000000013, 34.191059198030544, 13.441357834523815, -121.43962576384428, -189.4694190309374, -240.563218706576, 2.0000000000000013, -120.35804281052505, -107.5778873159862, -201.32615993141295, -55.94784813543528, -270.5229382094745, -252.26354042847365, -51.4342302935364, -126.22937573636425, -169.39353105102046, -204.3447661137101, 115.02113776406759, 133.64932851819538, -20.210696885393073, -427.8822601387214, 61.814944189127075, -46.66747312226754, -157.59680117836103, -210.0830463780019, -146.8166668924315, -280.5400457085885, 47.15635112106374, -36.06237193258894, 0.47369897999338745, 53.47199187412625, -1.4098580220855474, -188.417178975791, -7.382873406095964, 30.03943864021807, -102.6660262732746, -137.87614962326035, 7.892214497359944, -237.15799390680098, -25.35116401233658, -234.826662227652, 20.246712824982726, -25.184950739607856, -137.9329726891047, -107.9413059072219, -7.656612724135888, 25.52048212341577, 4.487426450696876, 76.59571320594783, -58.02939744774141, 0.9664175759932389, 106.41422962548086, 3.1106257456346373, -12.65758940027582, -199.37068811761546, -166.1643317630253, -29.755912495285443, 2.0000000000000013, 0.7878140007423694, -42.091733230541664, -80.85217124784121, 2.0000000000000013, 28.554064329653222, -73.74344955617077, -105.65670597680364, -33.32350205070128, 127.45336826964083, -101.02074479075297, -197.80387257950088, -4.8257898403230755, -0.46892941702073676, 67.51157772667926, -13.378307288629596, -151.60949306833658, -5.08465733883251, 113.53860466816947, 62.34057980083506, -93.70642377449093, -141.58253070313975, -126.29347969872558, -8.99853518002195, -15.93741236298388, -132.46330564132475, -55.43021021902295, -10.131940538640732, -405.7938306560577, -87.8936400002633, -99.37665451007305, -11.601976354623448, -253.80658414631935, -207.3067519132326, -152.59692988789953, -89.18411945434438, -6.655962331067354, -110.89710541966969, -112.75262972968767, 33.09455815761143, -84.6719562694798, -98.52552858158272, -177.49290001318826, -1.0002884909865797, 95.83428631838258, 103.07712100610352, -84.80661339001844, -282.14686122509863, 77.96745184921312, 92.95003125112832, 43.788862490514916, 27.83553149457223, -123.578939708886, -124.00486245780797, -21.066095000855924, 0.903720926400042, 29.786676851822747, -4.233442223030134, -19.32776669649088, 45.965902094011845, -16.46633548747067, 2.0000000000000013, -2.954449249125746, -117.73849799689233, -105.32552149836057, -4.693729222356173, 35.490369167889, -28.699360407617405, -143.38512991614618, -134.11515454146146, 4.799417144988174, -73.51034438911843, -105.72703226536659, -65.4318128952401, -375.6860965251915, -254.9937657952198, -112.94519874394257, -22.533456074722736, 111.9089441426176, -2.4514819829970786, -3.2542818717619904, -154.50158577678573, -184.97253389435696, -1.6688469135880784, -103.58886431112967, -5.683792742915291, -63.458609556377205, -97.52504871928792, 35.4623660864773, 74.50054560188309, 104.0733214863966, 94.95855945419116, -218.43902540293124, -98.81621709990982, 60.218946572762015, 39.968490262119836, 73.2800000000004, -13.656429057768534, -9.023823179188838, 112.88000000000017, 0.139560211506567, 38.91715842520429, -162.5989277134663, -62.56789247172847, 121.27697735734814, -25.71256980869443, -12.743020710438437, -79.81170536014307, 110.01170608747303, 19.041853415072886, -56.99340000395242, -88.4237821171449, -145.18169745072302, -156.27934986795856, -39.96904564199406, -37.93567442393085, -235.98241985460163, -45.15107474393317, 34.91045622745655, 82.83852903391478, -125.97626823076756, -11.211925252888912, 117.2153589424359, -6.608628778938039, -72.95000546441145, -150.39083037450834, 31.294083083596327, 17.831800547001134, -147.90121518791491, -53.548022477980716], "policy_predator_policy_reward": [19.49150177219098, 117.75694377283834, 239.29600703993145, 8.432042221594731, 130.73833814726393, 0.9031336454906327, 86.70404688956607, 44.12766167036254, 101.31785631339801, 589.5481318984109, 339.16456487341657, 330.901978990143, 34.82272820027549, 3.266605659669086, 44.59894080196954, 14.19864216547615, 13.103420382038705, 251.57626767238705, 187.60217197387846, 149.032314424226, 32.179259314391714, 160.63994404723644, 229.33835308591333, 39.53157391260237, 413.3761143567867, 62.61588134605992, 62.52781830610286, 183.11610630286924, 1.0145703284043415, 259.810479088133, 37.279533717737166, 0.0, 411.84404802778596, 409.4068021112263, 45.078546123829696, 56.193982809310505, 33.736725270025765, 269.42183177506803, 269.49662781331085, 152.108351989585, 138.90889726823218, 37.6963838667095, 1.516301020006614, 5.888008125873542, 180.32746980805194, 181.6085336398169, 14.875835851390312, 51.561902017386544, 166.08895026562945, 154.21258211172483, 26.930681797049765, 228.83569597791245, 5.832544589429302, 252.39585766392977, 7.143995236621174, 32.304242678004286, 187.21500171698256, 204.88394014927883, 9.596612724135847, 10.04951787658441, 26.073978779161077, 14.402881564193969, 59.50939744774132, 1.0235824240067626, 135.16135493073745, 103.76368976270672, 14.547589400275779, 209.74068811761512, 191.91337606864838, 0.0, 0.0, 1.202185999257632, 5.7839907422606425, 122.97195542536397, 0.0, 33.73593567034689, 38.87670237606745, 152.72071587225227, 21.223904880018612, 26.97743243964985, 176.0729937434186, 213.26596096748395, 6.775789840323034, 2.4489294170207287, 35.13842227332075, 25.12830728862987, 47.16926140764218, 115.65926710702271, 3.2713953318305857, 38.47942019916485, 26.72510826597748, 194.37649488939303, 126.0446752424373, 124.98696019012745, 17.827412362984163, 133.423305641325, 111.56021542417876, 0.0, 290.01777429986436, 295.3856895179361, 100.59665451007315, 13.541976354623406, 308.28848253560807, 317.19104749622454, 17.465114251493922, 204.35282967776195, 101.75235467576812, 90.81856744703424, 198.1826297296873, 12.395441842388516, 124.3933219966648, 49.9523452164035, 173.61777031278558, 141.4809276062192, 10.290255287576377, 11.418337387937763, 10.113254500006741, 311.84751810320756, 8.93168844164214, 11.786948827710324, 5.681137509485096, 43.124468505427906, 177.16376445337002, 183.67449250417263, 28.786095000856193, 1.0862790735999595, 10.971149125673584, 44.62492184818793, 21.157766696491166, 33.12409790598809, 18.14450417897428, 4.406681584513228, 4.924449249125704, 118.79849799689269, 40.8044886912397, 113.66476202947717, 38.0315451991589, 85.2520047885655, 22.82289527593608, 206.38400657555422, 34.11850064736085, 83.25369379296717, 107.2944937043741, 180.04906846101574, 398.7639722350823, 388.54258321347805, 14.946821221832401, 124.57183359683333, 0.961055857382407, 4.411481982997037, 5.224281871761948, 155.21158577678588, 77.75230907363557, 117.48907173430958, 132.37632991144994, 124.46865646595563, 0.9999837677095733, 181.4446563447499, 19.857633913522744, 13.509454398117027, 20.007120367277665, 7.440998692134773, 275.6906187297538, 11.348022521486893, 53.33707595048888, 47.83312781625274, 0.0, 15.616429057768492, 48.45744460001486, 9.816378579173849, 31.687244108962574, 35.77181183225333, 231.96573865047503, 4.604854103800143, 9.333022642651974, 27.582569808694718, 64.89283314145948, 55.60814225775702, 11.658293912527304, 21.428146584927266, 20.356536674832242, 114.58916122096497, 79.3066453831666, 181.1250721701186, 102.39048898076554, 21.585099430547462, 205.19978365515234, 247.06097791833696, 16.320767254662428, 56.1792438104103, 29.35346455840833, 127.58472892524836, 6.504641057564419, 8.568628778937997, 100.52429133385647, 95.4492398815628, 83.35760924287615, 3.357169666160852, 173.9008771939704, 148.35370290483516]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8469802149557725, "mean_inference_ms": 2.6666923414700334, "mean_action_processing_ms": 0.36174466590776805, "mean_env_wait_ms": 0.29627853900858553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012457013130187988, "StateBufferConnector_ms": 0.0033059120178222656, "ViewRequirementAgentConnector_ms": 0.12484490871429443}, "num_episodes": 22, "episode_return_max": 373.15789311489647, "episode_return_min": -169.37074996168377, "episode_return_mean": 75.59787697952484, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 365.42339004993477, "num_env_steps_trained_throughput_per_sec": 365.42339004993477, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 1424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1424000, "timers": {"training_iteration_time_ms": 11309.701, "restore_workers_time_ms": 0.013, "training_step_time_ms": 11309.664, "sample_time_ms": 1640.904, "learn_time_ms": 9650.977, "learn_throughput": 414.466, "synch_weights_time_ms": 16.944}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "done": false, "training_iteration": 89, "trial_id": "61e09_00000", "date": "2024-08-16_16-27-58", "timestamp": 1723805878, "time_this_iter_s": 10.953632116317749, "time_total_s": 1278.1769363880157, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x300255310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1278.1769363880157, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 47.73125, "ram_util_percent": 72.98125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7531110625103037, "cur_kl_coeff": 0.10678710937499997, "cur_lr": 0.00010000000000000003, "total_loss": 3.9657271236338945, "policy_loss": -0.010829515192810465, "vf_loss": 3.975501537953735, "vf_explained_var": 0.11868710066906359, "kl": 0.009880464177114402, "entropy": 0.6134819377667059, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4663379395449603, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 7.0921704708583775, "policy_loss": -0.007807045227912052, "vf_loss": 7.097632801217377, "vf_explained_var": -0.14618738498637285, "kl": 0.00781578136903119, "entropy": 1.1333032832574592, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 348.4499000645593, "episode_reward_min": -64.52129051126848, "episode_reward_mean": 75.43912813496107, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -405.7938306560577, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 127.45336826964083, "predator_policy": 398.7639722350823}, "policy_reward_mean": {"prey_policy": -42.225102384650036, "predator_policy": 79.94466645213058}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-64.52129051126848, -5.7517327981239585, 187.69926032341598, 61.349999999999554, 172.1089664499919, 89.09430310289912, 79.75935648081943, 26.5005983655218, -1.949423986628928, 34.51, 146.22466326993398, 37.50999999999953, 121.56000000000027, 3.469999999999972, 348.4499000645593, 12.259999999999984, -4.006868189661205, 3.989999999999959, 5.812041689241813, 64.29000000000002, 12.197262715344955, 142.33120353860875, 90.51433734064895, 3.9299999999999606, 114.4000000000004, 6.134378107495232, 217.62999999999963, -14.187351322260003, 115.73962055381747, 2.849999999999983, 45.99806466651542, 91.71599316147956, 3.159999999999977, 164.36619397228176, -19.96310541298839, 75.01785437206573, 130.92000000000058, -8.851817637994762, 136.60550941483166, 220.61999999999955, -44.992702011902, 191.63612036969317, 120.4300000000005, 113.25445479084921, 9.709999999999924, 81.14930560265424, 80.92000000000016, 8.084850276016459, 3.02999999999998, 44.44999999999962, 130.07455874799672, -48.29338260611756, 48.66126719619786, 116.18471700478389, 156.62669312814876, 4.0399999999999565, 114.83000000000023, 2.6799999999999877, 8.599999999999948, 147.57232932335984, 21.460981836794097, 143.3299999999997, 226.47999999999934, -30.21660125160031, 201.35764060162282, 75.24000000000083, 162.12999999999968, 106.51577457792774, 11.403772569080212, 132.47999999999996, 27.94624932863554, 162.13999999999885, -10.471484225300319, -41.02932976539656, 46.07086834538761, 171.1272669749547, 190.24899632644392, 19.750000000000377, 125.68000000000086, -27.367304623501077, 135.84066253963488, 120.80534243291001, 5.309999999999941, 74.12000000000062, 154.82999999999998, 22.244348051090814, 222.9503039960339, 17.165455128894024, 3.6099999999999666, 4.889835774536181, -10.542249900090962, 200.5544412906509, 126.73000000000086, 71.43654838281724, 112.86222946575961, 48.769999999999605, 93.91000000000115, 31.250262144656393, 126.66626325118553, 128.0964106907511], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-157.59680117836103, -210.0830463780019, -146.8166668924315, -280.5400457085885, 47.15635112106374, -36.06237193258894, 0.47369897999338745, 53.47199187412625, -1.4098580220855474, -188.417178975791, -7.382873406095964, 30.03943864021807, -102.6660262732746, -137.87614962326035, 7.892214497359944, -237.15799390680098, -25.35116401233658, -234.826662227652, 20.246712824982726, -25.184950739607856, -137.9329726891047, -107.9413059072219, -7.656612724135888, 25.52048212341577, 4.487426450696876, 76.59571320594783, -58.02939744774141, 0.9664175759932389, 106.41422962548086, 3.1106257456346373, -12.65758940027582, -199.37068811761546, -166.1643317630253, -29.755912495285443, 2.0000000000000013, 0.7878140007423694, -42.091733230541664, -80.85217124784121, 2.0000000000000013, 28.554064329653222, -73.74344955617077, -105.65670597680364, -33.32350205070128, 127.45336826964083, -101.02074479075297, -197.80387257950088, -4.8257898403230755, -0.46892941702073676, 67.51157772667926, -13.378307288629596, -151.60949306833658, -5.08465733883251, 113.53860466816947, 62.34057980083506, -93.70642377449093, -141.58253070313975, -126.29347969872558, -8.99853518002195, -15.93741236298388, -132.46330564132475, -55.43021021902295, -10.131940538640732, -405.7938306560577, -87.8936400002633, -99.37665451007305, -11.601976354623448, -253.80658414631935, -207.3067519132326, -152.59692988789953, -89.18411945434438, -6.655962331067354, -110.89710541966969, -112.75262972968767, 33.09455815761143, -84.6719562694798, -98.52552858158272, -177.49290001318826, -1.0002884909865797, 95.83428631838258, 103.07712100610352, -84.80661339001844, -282.14686122509863, 77.96745184921312, 92.95003125112832, 43.788862490514916, 27.83553149457223, -123.578939708886, -124.00486245780797, -21.066095000855924, 0.903720926400042, 29.786676851822747, -4.233442223030134, -19.32776669649088, 45.965902094011845, -16.46633548747067, 2.0000000000000013, -2.954449249125746, -117.73849799689233, -105.32552149836057, -4.693729222356173, 35.490369167889, -28.699360407617405, -143.38512991614618, -134.11515454146146, 4.799417144988174, -73.51034438911843, -105.72703226536659, -65.4318128952401, -375.6860965251915, -254.9937657952198, -112.94519874394257, -22.533456074722736, 111.9089441426176, -2.4514819829970786, -3.2542818717619904, -154.50158577678573, -184.97253389435696, -1.6688469135880784, -103.58886431112967, -5.683792742915291, -63.458609556377205, -97.52504871928792, 35.4623660864773, 74.50054560188309, 104.0733214863966, 94.95855945419116, -218.43902540293124, -98.81621709990982, 60.218946572762015, 39.968490262119836, 73.2800000000004, -13.656429057768534, -9.023823179188838, 112.88000000000017, 0.139560211506567, 38.91715842520429, -162.5989277134663, -62.56789247172847, 121.27697735734814, -25.71256980869443, -12.743020710438437, -79.81170536014307, 110.01170608747303, 19.041853415072886, -56.99340000395242, -88.4237821171449, -145.18169745072302, -156.27934986795856, -39.96904564199406, -37.93567442393085, -235.98241985460163, -45.15107474393317, 34.91045622745655, 82.83852903391478, -125.97626823076756, -11.211925252888912, 117.2153589424359, -6.608628778938039, -72.95000546441145, -150.39083037450834, 31.294083083596327, 17.831800547001134, -147.90121518791491, -53.548022477980716, -5.572972034590595, -84.34715599042907, -3.780735111078269, 48.29050756528376, 34.64076556501197, -0.27232977774256706, -142.11621412036982, -102.15797362934566, 92.70435411763334, 106.25547679834219, -106.86161064512456, -1.5258438722004177, 2.0000000000000013, -52.335545032595576, 1.1167073305892163, -1.6719484200134633, -78.39648103759635, -65.7146806954628, 5.184599074216964, 34.8205004296519, 124.76000000000029, -1.4085616682496398, -78.31061687767479, -8.467414377544836, 31.126543217146395, 18.282282372847213, -1.2778025588480466, -31.996296331004, -7.347065259578361, 58.70829655931678, -57.87504225724409, -70.5727652570242, -13.12922922920234, 21.199155334708212, 29.625476677571243, -90.19164070103488], "policy_predator_policy_reward": [33.736725270025765, 269.42183177506803, 269.49662781331085, 152.108351989585, 138.90889726823218, 37.6963838667095, 1.516301020006614, 5.888008125873542, 180.32746980805194, 181.6085336398169, 14.875835851390312, 51.561902017386544, 166.08895026562945, 154.21258211172483, 26.930681797049765, 228.83569597791245, 5.832544589429302, 252.39585766392977, 7.143995236621174, 32.304242678004286, 187.21500171698256, 204.88394014927883, 9.596612724135847, 10.04951787658441, 26.073978779161077, 14.402881564193969, 59.50939744774132, 1.0235824240067626, 135.16135493073745, 103.76368976270672, 14.547589400275779, 209.74068811761512, 191.91337606864838, 0.0, 0.0, 1.202185999257632, 5.7839907422606425, 122.97195542536397, 0.0, 33.73593567034689, 38.87670237606745, 152.72071587225227, 21.223904880018612, 26.97743243964985, 176.0729937434186, 213.26596096748395, 6.775789840323034, 2.4489294170207287, 35.13842227332075, 25.12830728862987, 47.16926140764218, 115.65926710702271, 3.2713953318305857, 38.47942019916485, 26.72510826597748, 194.37649488939303, 126.0446752424373, 124.98696019012745, 17.827412362984163, 133.423305641325, 111.56021542417876, 0.0, 290.01777429986436, 295.3856895179361, 100.59665451007315, 13.541976354623406, 308.28848253560807, 317.19104749622454, 17.465114251493922, 204.35282967776195, 101.75235467576812, 90.81856744703424, 198.1826297296873, 12.395441842388516, 124.3933219966648, 49.9523452164035, 173.61777031278558, 141.4809276062192, 10.290255287576377, 11.418337387937763, 10.113254500006741, 311.84751810320756, 8.93168844164214, 11.786948827710324, 5.681137509485096, 43.124468505427906, 177.16376445337002, 183.67449250417263, 28.786095000856193, 1.0862790735999595, 10.971149125673584, 44.62492184818793, 21.157766696491166, 33.12409790598809, 18.14450417897428, 4.406681584513228, 4.924449249125704, 118.79849799689269, 40.8044886912397, 113.66476202947717, 38.0315451991589, 85.2520047885655, 22.82289527593608, 206.38400657555422, 34.11850064736085, 83.25369379296717, 107.2944937043741, 180.04906846101574, 398.7639722350823, 388.54258321347805, 14.946821221832401, 124.57183359683333, 0.961055857382407, 4.411481982997037, 5.224281871761948, 155.21158577678588, 77.75230907363557, 117.48907173430958, 132.37632991144994, 124.46865646595563, 0.9999837677095733, 181.4446563447499, 19.857633913522744, 13.509454398117027, 20.007120367277665, 7.440998692134773, 275.6906187297538, 11.348022521486893, 53.33707595048888, 47.83312781625274, 0.0, 15.616429057768492, 48.45744460001486, 9.816378579173849, 31.687244108962574, 35.77181183225333, 231.96573865047503, 4.604854103800143, 9.333022642651974, 27.582569808694718, 64.89283314145948, 55.60814225775702, 11.658293912527304, 21.428146584927266, 20.356536674832242, 114.58916122096497, 79.3066453831666, 181.1250721701186, 102.39048898076554, 21.585099430547462, 205.19978365515234, 247.06097791833696, 16.320767254662428, 56.1792438104103, 29.35346455840833, 127.58472892524836, 6.504641057564419, 8.568628778937997, 100.52429133385647, 95.4492398815628, 83.35760924287615, 3.357169666160852, 173.9008771939704, 148.35370290483516, 7.5329720345905535, 87.69715599042958, 5.740735111078227, 23.869492434716086, 16.47698737342005, 103.98457683931068, 66.66138604362533, 199.85714975718162, 14.085645882366865, 9.90482719769258, 118.26456264918107, 7.288346997037936, 0.0, 53.94554503259531, 3.6419484200134287, 1.803128443947026, 126.25556894359534, 7.313342889373384, 91.31917552217737, 69.23016626460495, 0.0, 3.378561668249611, 80.54230732924546, 77.67227230879173, 0.9865723304470366, 62.466831545318385, 81.0613883285311, 0.9827105613209742, 38.90706525957837, 3.6417034406830036, 45.00036662590734, 114.69770303301746, 114.53045357402837, 4.065883571651266, 83.53850001291617, 105.12407470129806]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8442396289124906, "mean_inference_ms": 2.6637739931832227, "mean_action_processing_ms": 0.3608821651138701, "mean_env_wait_ms": 0.2958056813771255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012295961380004883, "StateBufferConnector_ms": 0.0033025741577148438, "ViewRequirementAgentConnector_ms": 0.10136699676513672}, "num_episodes": 18, "episode_return_max": 348.4499000645593, "episode_return_min": -64.52129051126848, "episode_return_mean": 75.43912813496107, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.7029310666509, "num_env_steps_trained_throughput_per_sec": 319.7029310666509, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 11470.139, "restore_workers_time_ms": 0.013, "training_step_time_ms": 11470.102, "sample_time_ms": 1654.693, "learn_time_ms": 9797.714, "learn_throughput": 408.258, "synch_weights_time_ms": 16.772}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 90, "trial_id": "61e09_00000", "date": "2024-08-16_16-28-11", "timestamp": 1723805891, "time_this_iter_s": 12.517114877700806, "time_total_s": 1290.6940512657166, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2549670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1290.6940512657166, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 53.333333333333336, "ram_util_percent": 74.53888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3022523357754663, "cur_kl_coeff": 0.10678710937499997, "cur_lr": 0.00010000000000000003, "total_loss": 4.879417821843788, "policy_loss": -0.006596825574524701, "vf_loss": 4.885122250627588, "vf_explained_var": 0.05431010820878246, "kl": 0.00835677855854342, "entropy": 0.6527360305899665, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6425784429545125, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 7.2365457613001425, "policy_loss": -0.011585456801075785, "vf_loss": 7.2444664059492645, "vf_explained_var": -0.15062623843944892, "kl": 0.012216037522831805, "entropy": 1.092810156389519, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "env_runners": {"episode_reward_max": 226.47999999999934, "episode_reward_min": -48.29338260611756, "episode_reward_mean": 69.5732722600553, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -405.7938306560577, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 124.76000000000029, "predator_policy": 398.7639722350823}, "policy_reward_mean": {"prey_policy": -37.8640509728385, "predator_policy": 72.65068710286617}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.9299999999999606, 114.4000000000004, 6.134378107495232, 217.62999999999963, -14.187351322260003, 115.73962055381747, 2.849999999999983, 45.99806466651542, 91.71599316147956, 3.159999999999977, 164.36619397228176, -19.96310541298839, 75.01785437206573, 130.92000000000058, -8.851817637994762, 136.60550941483166, 220.61999999999955, -44.992702011902, 191.63612036969317, 120.4300000000005, 113.25445479084921, 9.709999999999924, 81.14930560265424, 80.92000000000016, 8.084850276016459, 3.02999999999998, 44.44999999999962, 130.07455874799672, -48.29338260611756, 48.66126719619786, 116.18471700478389, 156.62669312814876, 4.0399999999999565, 114.83000000000023, 2.6799999999999877, 8.599999999999948, 147.57232932335984, 21.460981836794097, 143.3299999999997, 226.47999999999934, -30.21660125160031, 201.35764060162282, 75.24000000000083, 162.12999999999968, 106.51577457792774, 11.403772569080212, 132.47999999999996, 27.94624932863554, 162.13999999999885, -10.471484225300319, -41.02932976539656, 46.07086834538761, 171.1272669749547, 190.24899632644392, 19.750000000000377, 125.68000000000086, -27.367304623501077, 135.84066253963488, 120.80534243291001, 5.309999999999941, 74.12000000000062, 154.82999999999998, 22.244348051090814, 222.9503039960339, 17.165455128894024, 3.6099999999999666, 4.889835774536181, -10.542249900090962, 200.5544412906509, 126.73000000000086, 71.43654838281724, 112.86222946575961, 48.769999999999605, 93.91000000000115, 31.250262144656393, 126.66626325118553, 128.0964106907511, 13.929999999999954, 147.92310050378092, -1.3195527218455745, 40.38163937011967, 43.755368013996176, 33.220000000000034, 2.7799999999999856, 3.8999999999999613, 48.76499511386248, 18.140000000000114, 75.49079756995212, 98.63000000000079, 30.60000000000035, 45.986523550230956, 109.02683922257782, 3.93999999999996, 67.19476313034832, 4.8296700675658855, 7.964690734996886, 39.95999999999951, -5.000483546695859, 75.87711473893091, 70.84152461690692], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-4.8257898403230755, -0.46892941702073676, 67.51157772667926, -13.378307288629596, -151.60949306833658, -5.08465733883251, 113.53860466816947, 62.34057980083506, -93.70642377449093, -141.58253070313975, -126.29347969872558, -8.99853518002195, -15.93741236298388, -132.46330564132475, -55.43021021902295, -10.131940538640732, -405.7938306560577, -87.8936400002633, -99.37665451007305, -11.601976354623448, -253.80658414631935, -207.3067519132326, -152.59692988789953, -89.18411945434438, -6.655962331067354, -110.89710541966969, -112.75262972968767, 33.09455815761143, -84.6719562694798, -98.52552858158272, -177.49290001318826, -1.0002884909865797, 95.83428631838258, 103.07712100610352, -84.80661339001844, -282.14686122509863, 77.96745184921312, 92.95003125112832, 43.788862490514916, 27.83553149457223, -123.578939708886, -124.00486245780797, -21.066095000855924, 0.903720926400042, 29.786676851822747, -4.233442223030134, -19.32776669649088, 45.965902094011845, -16.46633548747067, 2.0000000000000013, -2.954449249125746, -117.73849799689233, -105.32552149836057, -4.693729222356173, 35.490369167889, -28.699360407617405, -143.38512991614618, -134.11515454146146, 4.799417144988174, -73.51034438911843, -105.72703226536659, -65.4318128952401, -375.6860965251915, -254.9937657952198, -112.94519874394257, -22.533456074722736, 111.9089441426176, -2.4514819829970786, -3.2542818717619904, -154.50158577678573, -184.97253389435696, -1.6688469135880784, -103.58886431112967, -5.683792742915291, -63.458609556377205, -97.52504871928792, 35.4623660864773, 74.50054560188309, 104.0733214863966, 94.95855945419116, -218.43902540293124, -98.81621709990982, 60.218946572762015, 39.968490262119836, 73.2800000000004, -13.656429057768534, -9.023823179188838, 112.88000000000017, 0.139560211506567, 38.91715842520429, -162.5989277134663, -62.56789247172847, 121.27697735734814, -25.71256980869443, -12.743020710438437, -79.81170536014307, 110.01170608747303, 19.041853415072886, -56.99340000395242, -88.4237821171449, -145.18169745072302, -156.27934986795856, -39.96904564199406, -37.93567442393085, -235.98241985460163, -45.15107474393317, 34.91045622745655, 82.83852903391478, -125.97626823076756, -11.211925252888912, 117.2153589424359, -6.608628778938039, -72.95000546441145, -150.39083037450834, 31.294083083596327, 17.831800547001134, -147.90121518791491, -53.548022477980716, -5.572972034590595, -84.34715599042907, -3.780735111078269, 48.29050756528376, 34.64076556501197, -0.27232977774256706, -142.11621412036982, -102.15797362934566, 92.70435411763334, 106.25547679834219, -106.86161064512456, -1.5258438722004177, 2.0000000000000013, -52.335545032595576, 1.1167073305892163, -1.6719484200134633, -78.39648103759635, -65.7146806954628, 5.184599074216964, 34.8205004296519, 124.76000000000029, -1.4085616682496398, -78.31061687767479, -8.467414377544836, 31.126543217146395, 18.282282372847213, -1.2778025588480466, -31.996296331004, -7.347065259578361, 58.70829655931678, -57.87504225724409, -70.5727652570242, -13.12922922920234, 21.199155334708212, 29.625476677571243, -90.19164070103488, -1.8468071435042814, -125.07863279602854, 44.66807912637824, -28.789756622870122, -72.09641335921475, -68.41861938953843, -8.6223233798784, -66.5687704589184, -108.47592417543004, -102.93190036003341, 14.804877903238708, -35.78163216654036, -0.3010651470104553, -154.32810256067185, -5.180290162539592, -8.499863638697844, -96.7399004965295, 15.395963775526864, -126.78553388687891, -7.39446283679418, -54.16600982367192, 13.335291374395299, 3.602759450173556, -0.9042069630191358, -57.486845417658415, -70.20807509112603, -58.83448617834743, -0.5513979582439219, 81.54027107515627, 0.40614919777336705, -1.5984765436618387, -0.12304746266637114, -10.871367035253567, -83.00110137401805, -35.40817579368484, -28.24458148631766, -17.144054804164586, -42.88231485606143, -5.26728611747116, -54.1109617480232, -57.988260976534875, -99.1621043676555, -85.77785540419032, -60.62039857787147, -34.84194656115849, -32.71238640710036], "policy_predator_policy_reward": [6.775789840323034, 2.4489294170207287, 35.13842227332075, 25.12830728862987, 47.16926140764218, 115.65926710702271, 3.2713953318305857, 38.47942019916485, 26.72510826597748, 194.37649488939303, 126.0446752424373, 124.98696019012745, 17.827412362984163, 133.423305641325, 111.56021542417876, 0.0, 290.01777429986436, 295.3856895179361, 100.59665451007315, 13.541976354623406, 308.28848253560807, 317.19104749622454, 17.465114251493922, 204.35282967776195, 101.75235467576812, 90.81856744703424, 198.1826297296873, 12.395441842388516, 124.3933219966648, 49.9523452164035, 173.61777031278558, 141.4809276062192, 10.290255287576377, 11.418337387937763, 10.113254500006741, 311.84751810320756, 8.93168844164214, 11.786948827710324, 5.681137509485096, 43.124468505427906, 177.16376445337002, 183.67449250417263, 28.786095000856193, 1.0862790735999595, 10.971149125673584, 44.62492184818793, 21.157766696491166, 33.12409790598809, 18.14450417897428, 4.406681584513228, 4.924449249125704, 118.79849799689269, 40.8044886912397, 113.66476202947717, 38.0315451991589, 85.2520047885655, 22.82289527593608, 206.38400657555422, 34.11850064736085, 83.25369379296717, 107.2944937043741, 180.04906846101574, 398.7639722350823, 388.54258321347805, 14.946821221832401, 124.57183359683333, 0.961055857382407, 4.411481982997037, 5.224281871761948, 155.21158577678588, 77.75230907363557, 117.48907173430958, 132.37632991144994, 124.46865646595563, 0.9999837677095733, 181.4446563447499, 19.857633913522744, 13.509454398117027, 20.007120367277665, 7.440998692134773, 275.6906187297538, 11.348022521486893, 53.33707595048888, 47.83312781625274, 0.0, 15.616429057768492, 48.45744460001486, 9.816378579173849, 31.687244108962574, 35.77181183225333, 231.96573865047503, 4.604854103800143, 9.333022642651974, 27.582569808694718, 64.89283314145948, 55.60814225775702, 11.658293912527304, 21.428146584927266, 20.356536674832242, 114.58916122096497, 79.3066453831666, 181.1250721701186, 102.39048898076554, 21.585099430547462, 205.19978365515234, 247.06097791833696, 16.320767254662428, 56.1792438104103, 29.35346455840833, 127.58472892524836, 6.504641057564419, 8.568628778937997, 100.52429133385647, 95.4492398815628, 83.35760924287615, 3.357169666160852, 173.9008771939704, 148.35370290483516, 7.5329720345905535, 87.69715599042958, 5.740735111078227, 23.869492434716086, 16.47698737342005, 103.98457683931068, 66.66138604362533, 199.85714975718162, 14.085645882366865, 9.90482719769258, 118.26456264918107, 7.288346997037936, 0.0, 53.94554503259531, 3.6419484200134287, 1.803128443947026, 126.25556894359534, 7.313342889373384, 91.31917552217737, 69.23016626460495, 0.0, 3.378561668249611, 80.54230732924546, 77.67227230879173, 0.9865723304470366, 62.466831545318385, 81.0613883285311, 0.9827105613209742, 38.90706525957837, 3.6417034406830036, 45.00036662590734, 114.69770303301746, 114.53045357402837, 4.065883571651266, 83.53850001291617, 105.12407470129806, 72.630585110363, 68.2248548291702, 95.01901344405994, 37.02576455621285, 101.05620436130815, 38.139275665599975, 2.7270127173370264, 112.84572049157988, 7.415365954964008, 247.74782659449605, 5.351221049173486, 48.84553321412788, 2.281065147010451, 155.12810256067155, 7.14029016253955, 10.439863638697803, 115.26337936092658, 14.845552473939216, 142.97553388687862, 9.344462836794138, 38.59596868895126, 77.72554733027827, 93.05724054982649, 2.8742069630191183, 59.08881913498408, 99.20610137379998, 99.6744861783475, 5.697921508475331, 15.402576293155544, 11.677842656491832, 3.558476543661806, 2.1030474626663707, 80.1671705622022, 80.90006097741785, 6.549506793960346, 61.93292055360824, 0.0, 67.991060395223, 73.21688703209034, 26.121360833404058, 4.638751267609198, 147.51113052988603, 105.77469255942576, 116.50067616156682, 45.45260999460973, 92.94324759055674]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.841143259041783, "mean_inference_ms": 2.6600777962303703, "mean_action_processing_ms": 0.35997729054835637, "mean_env_wait_ms": 0.29460598137793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012590646743774414, "StateBufferConnector_ms": 0.0032716989517211914, "ViewRequirementAgentConnector_ms": 0.10161972045898438}, "num_episodes": 23, "episode_return_max": 226.47999999999934, "episode_return_min": -48.29338260611756, "episode_return_mean": 69.5732722600553, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 347.89726833968047, "num_env_steps_trained_throughput_per_sec": 347.89726833968047, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 1456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1456000, "timers": {"training_iteration_time_ms": 11519.208, "restore_workers_time_ms": 0.012, "training_step_time_ms": 11519.171, "sample_time_ms": 1652.545, "learn_time_ms": 9848.569, "learn_throughput": 406.15, "synch_weights_time_ms": 17.046}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "done": false, "training_iteration": 91, "trial_id": "61e09_00000", "date": "2024-08-16_16-28-23", "timestamp": 1723805903, "time_this_iter_s": 11.505730867385864, "time_total_s": 1302.1997821331024, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x300039820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1302.1997821331024, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 46.85, "ram_util_percent": 75.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.432367555426542, "cur_kl_coeff": 0.10678710937499997, "cur_lr": 0.00010000000000000003, "total_loss": 4.8912372719043145, "policy_loss": -0.009239559272112, "vf_loss": 4.899609296410172, "vf_explained_var": 0.060322387918593394, "kl": 0.008123946146557474, "entropy": 0.5909706765066379, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.18925497960792, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 7.379311931448639, "policy_loss": -0.015419952251095936, "vf_loss": 7.390857190177554, "vf_explained_var": 0.015437910891083814, "kl": 0.012915595052982214, "entropy": 1.1230507392416555, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "env_runners": {"episode_reward_max": 226.47999999999934, "episode_reward_min": -48.29338260611756, "episode_reward_mean": 65.9932198881171, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -375.6860965251915, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 124.76000000000029, "predator_policy": 398.7639722350823}, "policy_reward_mean": {"prey_policy": -31.089060365341055, "predator_policy": 64.08567030939963}, "custom_metrics": {}, "hist_stats": {"episode_reward": [191.63612036969317, 120.4300000000005, 113.25445479084921, 9.709999999999924, 81.14930560265424, 80.92000000000016, 8.084850276016459, 3.02999999999998, 44.44999999999962, 130.07455874799672, -48.29338260611756, 48.66126719619786, 116.18471700478389, 156.62669312814876, 4.0399999999999565, 114.83000000000023, 2.6799999999999877, 8.599999999999948, 147.57232932335984, 21.460981836794097, 143.3299999999997, 226.47999999999934, -30.21660125160031, 201.35764060162282, 75.24000000000083, 162.12999999999968, 106.51577457792774, 11.403772569080212, 132.47999999999996, 27.94624932863554, 162.13999999999885, -10.471484225300319, -41.02932976539656, 46.07086834538761, 171.1272669749547, 190.24899632644392, 19.750000000000377, 125.68000000000086, -27.367304623501077, 135.84066253963488, 120.80534243291001, 5.309999999999941, 74.12000000000062, 154.82999999999998, 22.244348051090814, 222.9503039960339, 17.165455128894024, 3.6099999999999666, 4.889835774536181, -10.542249900090962, 200.5544412906509, 126.73000000000086, 71.43654838281724, 112.86222946575961, 48.769999999999605, 93.91000000000115, 31.250262144656393, 126.66626325118553, 128.0964106907511, 13.929999999999954, 147.92310050378092, -1.3195527218455745, 40.38163937011967, 43.755368013996176, 33.220000000000034, 2.7799999999999856, 3.8999999999999613, 48.76499511386248, 18.140000000000114, 75.49079756995212, 98.63000000000079, 30.60000000000035, 45.986523550230956, 109.02683922257782, 3.93999999999996, 67.19476313034832, 4.8296700675658855, 7.964690734996886, 39.95999999999951, -5.000483546695859, 75.87711473893091, 70.84152461690692, 97.53976993633992, 98.80808966112484, 38.17233868205229, 89.62569832563683, 82.81236588651228, 72.90000000000035, 44.44819911454053, 10.019728367540603, 0.7682268166310704, 24.691484645122472, 9.882979867221858, 6.423754117671315, 115.6400000000007, 3.160931720733585, 52.68567830728834, 18.440000000000357, 63.768155221101765, 53.30000000000011], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [77.96745184921312, 92.95003125112832, 43.788862490514916, 27.83553149457223, -123.578939708886, -124.00486245780797, -21.066095000855924, 0.903720926400042, 29.786676851822747, -4.233442223030134, -19.32776669649088, 45.965902094011845, -16.46633548747067, 2.0000000000000013, -2.954449249125746, -117.73849799689233, -105.32552149836057, -4.693729222356173, 35.490369167889, -28.699360407617405, -143.38512991614618, -134.11515454146146, 4.799417144988174, -73.51034438911843, -105.72703226536659, -65.4318128952401, -375.6860965251915, -254.9937657952198, -112.94519874394257, -22.533456074722736, 111.9089441426176, -2.4514819829970786, -3.2542818717619904, -154.50158577678573, -184.97253389435696, -1.6688469135880784, -103.58886431112967, -5.683792742915291, -63.458609556377205, -97.52504871928792, 35.4623660864773, 74.50054560188309, 104.0733214863966, 94.95855945419116, -218.43902540293124, -98.81621709990982, 60.218946572762015, 39.968490262119836, 73.2800000000004, -13.656429057768534, -9.023823179188838, 112.88000000000017, 0.139560211506567, 38.91715842520429, -162.5989277134663, -62.56789247172847, 121.27697735734814, -25.71256980869443, -12.743020710438437, -79.81170536014307, 110.01170608747303, 19.041853415072886, -56.99340000395242, -88.4237821171449, -145.18169745072302, -156.27934986795856, -39.96904564199406, -37.93567442393085, -235.98241985460163, -45.15107474393317, 34.91045622745655, 82.83852903391478, -125.97626823076756, -11.211925252888912, 117.2153589424359, -6.608628778938039, -72.95000546441145, -150.39083037450834, 31.294083083596327, 17.831800547001134, -147.90121518791491, -53.548022477980716, -5.572972034590595, -84.34715599042907, -3.780735111078269, 48.29050756528376, 34.64076556501197, -0.27232977774256706, -142.11621412036982, -102.15797362934566, 92.70435411763334, 106.25547679834219, -106.86161064512456, -1.5258438722004177, 2.0000000000000013, -52.335545032595576, 1.1167073305892163, -1.6719484200134633, -78.39648103759635, -65.7146806954628, 5.184599074216964, 34.8205004296519, 124.76000000000029, -1.4085616682496398, -78.31061687767479, -8.467414377544836, 31.126543217146395, 18.282282372847213, -1.2778025588480466, -31.996296331004, -7.347065259578361, 58.70829655931678, -57.87504225724409, -70.5727652570242, -13.12922922920234, 21.199155334708212, 29.625476677571243, -90.19164070103488, -1.8468071435042814, -125.07863279602854, 44.66807912637824, -28.789756622870122, -72.09641335921475, -68.41861938953843, -8.6223233798784, -66.5687704589184, -108.47592417543004, -102.93190036003341, 14.804877903238708, -35.78163216654036, -0.3010651470104553, -154.32810256067185, -5.180290162539592, -8.499863638697844, -96.7399004965295, 15.395963775526864, -126.78553388687891, -7.39446283679418, -54.16600982367192, 13.335291374395299, 3.602759450173556, -0.9042069630191358, -57.486845417658415, -70.20807509112603, -58.83448617834743, -0.5513979582439219, 81.54027107515627, 0.40614919777336705, -1.5984765436618387, -0.12304746266637114, -10.871367035253567, -83.00110137401805, -35.40817579368484, -28.24458148631766, -17.144054804164586, -42.88231485606143, -5.26728611747116, -54.1109617480232, -57.988260976534875, -99.1621043676555, -85.77785540419032, -60.62039857787147, -34.84194656115849, -32.71238640710036, 1.0171491356697007, -76.3273759005757, 24.28185952338771, 16.247351349195604, 8.237485027285446, -33.86917004696489, -105.85289150798224, -67.85728748205148, -78.55068402883296, -78.81613103658194, -2.8826810937411356, 8.752392810646379, -27.6373291103852, 0.012813177369972084, -26.6113636184524, -22.907727648098735, -55.982686564440144, -145.55109422632555, -44.72330587029697, -167.3558959353322, -38.829773910408996, -68.98194850844483, -54.348093462002055, -13.259790304372121, 51.8757223612213, 35.30589402200013, 1.1709317207336087, 1.0063671856071976, -95.2668256717204, -5.941209552437945, -31.984922948088382, -3.1764708217479334, -21.196150491232245, -93.80897545411649, -13.766390320815123, 31.55171093451427], "policy_predator_policy_reward": [8.93168844164214, 11.786948827710324, 5.681137509485096, 43.124468505427906, 177.16376445337002, 183.67449250417263, 28.786095000856193, 1.0862790735999595, 10.971149125673584, 44.62492184818793, 21.157766696491166, 33.12409790598809, 18.14450417897428, 4.406681584513228, 4.924449249125704, 118.79849799689269, 40.8044886912397, 113.66476202947717, 38.0315451991589, 85.2520047885655, 22.82289527593608, 206.38400657555422, 34.11850064736085, 83.25369379296717, 107.2944937043741, 180.04906846101574, 398.7639722350823, 388.54258321347805, 14.946821221832401, 124.57183359683333, 0.961055857382407, 4.411481982997037, 5.224281871761948, 155.21158577678588, 77.75230907363557, 117.48907173430958, 132.37632991144994, 124.46865646595563, 0.9999837677095733, 181.4446563447499, 19.857633913522744, 13.509454398117027, 20.007120367277665, 7.440998692134773, 275.6906187297538, 11.348022521486893, 53.33707595048888, 47.83312781625274, 0.0, 15.616429057768492, 48.45744460001486, 9.816378579173849, 31.687244108962574, 35.77181183225333, 231.96573865047503, 4.604854103800143, 9.333022642651974, 27.582569808694718, 64.89283314145948, 55.60814225775702, 11.658293912527304, 21.428146584927266, 20.356536674832242, 114.58916122096497, 79.3066453831666, 181.1250721701186, 102.39048898076554, 21.585099430547462, 205.19978365515234, 247.06097791833696, 16.320767254662428, 56.1792438104103, 29.35346455840833, 127.58472892524836, 6.504641057564419, 8.568628778937997, 100.52429133385647, 95.4492398815628, 83.35760924287615, 3.357169666160852, 173.9008771939704, 148.35370290483516, 7.5329720345905535, 87.69715599042958, 5.740735111078227, 23.869492434716086, 16.47698737342005, 103.98457683931068, 66.66138604362533, 199.85714975718162, 14.085645882366865, 9.90482719769258, 118.26456264918107, 7.288346997037936, 0.0, 53.94554503259531, 3.6419484200134287, 1.803128443947026, 126.25556894359534, 7.313342889373384, 91.31917552217737, 69.23016626460495, 0.0, 3.378561668249611, 80.54230732924546, 77.67227230879173, 0.9865723304470366, 62.466831545318385, 81.0613883285311, 0.9827105613209742, 38.90706525957837, 3.6417034406830036, 45.00036662590734, 114.69770303301746, 114.53045357402837, 4.065883571651266, 83.53850001291617, 105.12407470129806, 72.630585110363, 68.2248548291702, 95.01901344405994, 37.02576455621285, 101.05620436130815, 38.139275665599975, 2.7270127173370264, 112.84572049157988, 7.415365954964008, 247.74782659449605, 5.351221049173486, 48.84553321412788, 2.281065147010451, 155.12810256067155, 7.14029016253955, 10.439863638697803, 115.26337936092658, 14.845552473939216, 142.97553388687862, 9.344462836794138, 38.59596868895126, 77.72554733027827, 93.05724054982649, 2.8742069630191183, 59.08881913498408, 99.20610137379998, 99.6744861783475, 5.697921508475331, 15.402576293155544, 11.677842656491832, 3.558476543661806, 2.1030474626663707, 80.1671705622022, 80.90006097741785, 6.549506793960346, 61.93292055360824, 0.0, 67.991060395223, 73.21688703209034, 26.121360833404058, 4.638751267609198, 147.51113052988603, 105.77469255942576, 116.50067616156682, 45.45260999460973, 92.94324759055674, 68.78376374216013, 104.06623295908476, 21.103617993177885, 37.17526079536339, 19.422948440216242, 44.38107526151601, 110.17306347807343, 153.16281383759684, 128.0299147368405, 112.14926621508657, 4.852681093741094, 62.17760718935358, 32.63512475845572, 39.43759028909975, 34.34795994683227, 25.190859687259486, 5.427822023343439, 196.87418558405244, 137.3338521096292, 99.43683434112104, 31.399661440905685, 86.29504084517032, 71.84445877753637, 2.1871791065090527, 17.304277638778622, 11.154105977999961, 0.9836328143928038, 0.0, 77.72323835561552, 76.17047517583104, 39.437449267973605, 14.163944501862904, 101.0658300082887, 77.7074511581628, 15.706390320815082, 19.808289065485766]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.839353425715216, "mean_inference_ms": 2.6504045677651424, "mean_action_processing_ms": 0.358695920126177, "mean_env_wait_ms": 0.293975353780175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012978434562683105, "StateBufferConnector_ms": 0.003184795379638672, "ViewRequirementAgentConnector_ms": 0.09814679622650146}, "num_episodes": 18, "episode_return_max": 226.47999999999934, "episode_return_min": -48.29338260611756, "episode_return_mean": 65.9932198881171, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 353.3246182313156, "num_env_steps_trained_throughput_per_sec": 353.3246182313156, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1472000, "timers": {"training_iteration_time_ms": 11485.134, "restore_workers_time_ms": 0.012, "training_step_time_ms": 11485.099, "sample_time_ms": 1647.105, "learn_time_ms": 9820.028, "learn_throughput": 407.331, "synch_weights_time_ms": 16.977}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "done": false, "training_iteration": 92, "trial_id": "61e09_00000", "date": "2024-08-16_16-28-34", "timestamp": 1723805914, "time_this_iter_s": 11.32563304901123, "time_total_s": 1313.5254151821136, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3000bd040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1313.5254151821136, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 45.26875, "ram_util_percent": 75.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.277254356845977, "cur_kl_coeff": 0.10678710937499997, "cur_lr": 0.00010000000000000003, "total_loss": 4.683421712451511, "policy_loss": -0.00812068106803708, "vf_loss": 4.690690842507378, "vf_explained_var": 0.05976494702081832, "kl": 0.007974302483097304, "entropy": 0.5815963214036649, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6204637424024955, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 6.283782260632389, "policy_loss": -0.00760682974264479, "vf_loss": 6.288733092565385, "vf_explained_var": 0.143108233730629, "kl": 0.008853367853303455, "entropy": 1.0342696103784772, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 226.47999999999934, "episode_reward_min": -41.02932976539656, "episode_reward_mean": 66.37291462782224, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -249.3822209434583, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 124.76000000000029, "predator_policy": 275.6906187297538}, "policy_reward_mean": {"prey_policy": -26.14088139586306, "predator_policy": 59.327338709774175}, "custom_metrics": {}, "hist_stats": {"episode_reward": [147.57232932335984, 21.460981836794097, 143.3299999999997, 226.47999999999934, -30.21660125160031, 201.35764060162282, 75.24000000000083, 162.12999999999968, 106.51577457792774, 11.403772569080212, 132.47999999999996, 27.94624932863554, 162.13999999999885, -10.471484225300319, -41.02932976539656, 46.07086834538761, 171.1272669749547, 190.24899632644392, 19.750000000000377, 125.68000000000086, -27.367304623501077, 135.84066253963488, 120.80534243291001, 5.309999999999941, 74.12000000000062, 154.82999999999998, 22.244348051090814, 222.9503039960339, 17.165455128894024, 3.6099999999999666, 4.889835774536181, -10.542249900090962, 200.5544412906509, 126.73000000000086, 71.43654838281724, 112.86222946575961, 48.769999999999605, 93.91000000000115, 31.250262144656393, 126.66626325118553, 128.0964106907511, 13.929999999999954, 147.92310050378092, -1.3195527218455745, 40.38163937011967, 43.755368013996176, 33.220000000000034, 2.7799999999999856, 3.8999999999999613, 48.76499511386248, 18.140000000000114, 75.49079756995212, 98.63000000000079, 30.60000000000035, 45.986523550230956, 109.02683922257782, 3.93999999999996, 67.19476313034832, 4.8296700675658855, 7.964690734996886, 39.95999999999951, -5.000483546695859, 75.87711473893091, 70.84152461690692, 97.53976993633992, 98.80808966112484, 38.17233868205229, 89.62569832563683, 82.81236588651228, 72.90000000000035, 44.44819911454053, 10.019728367540603, 0.7682268166310704, 24.691484645122472, 9.882979867221858, 6.423754117671315, 115.6400000000007, 3.160931720733585, 52.68567830728834, 18.440000000000357, 63.768155221101765, 53.30000000000011, 3.8299999999999623, 110.02000000000027, 70.01862720968704, 95.06020450342704, 109.81000000000077, 103.36023562522226, 22.490000000000325, 95.26947189030804, 29.090390422206127, 3.6099999999999675, 8.823822283085624, 143.1008764409732, 79.11978422171744, 66.05000000000038, 134.01643705687658, 6.509999999999925, 7.09999999999995, 136.75820882723247], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-103.58886431112967, -5.683792742915291, -63.458609556377205, -97.52504871928792, 35.4623660864773, 74.50054560188309, 104.0733214863966, 94.95855945419116, -218.43902540293124, -98.81621709990982, 60.218946572762015, 39.968490262119836, 73.2800000000004, -13.656429057768534, -9.023823179188838, 112.88000000000017, 0.139560211506567, 38.91715842520429, -162.5989277134663, -62.56789247172847, 121.27697735734814, -25.71256980869443, -12.743020710438437, -79.81170536014307, 110.01170608747303, 19.041853415072886, -56.99340000395242, -88.4237821171449, -145.18169745072302, -156.27934986795856, -39.96904564199406, -37.93567442393085, -235.98241985460163, -45.15107474393317, 34.91045622745655, 82.83852903391478, -125.97626823076756, -11.211925252888912, 117.2153589424359, -6.608628778938039, -72.95000546441145, -150.39083037450834, 31.294083083596327, 17.831800547001134, -147.90121518791491, -53.548022477980716, -5.572972034590595, -84.34715599042907, -3.780735111078269, 48.29050756528376, 34.64076556501197, -0.27232977774256706, -142.11621412036982, -102.15797362934566, 92.70435411763334, 106.25547679834219, -106.86161064512456, -1.5258438722004177, 2.0000000000000013, -52.335545032595576, 1.1167073305892163, -1.6719484200134633, -78.39648103759635, -65.7146806954628, 5.184599074216964, 34.8205004296519, 124.76000000000029, -1.4085616682496398, -78.31061687767479, -8.467414377544836, 31.126543217146395, 18.282282372847213, -1.2778025588480466, -31.996296331004, -7.347065259578361, 58.70829655931678, -57.87504225724409, -70.5727652570242, -13.12922922920234, 21.199155334708212, 29.625476677571243, -90.19164070103488, -1.8468071435042814, -125.07863279602854, 44.66807912637824, -28.789756622870122, -72.09641335921475, -68.41861938953843, -8.6223233798784, -66.5687704589184, -108.47592417543004, -102.93190036003341, 14.804877903238708, -35.78163216654036, -0.3010651470104553, -154.32810256067185, -5.180290162539592, -8.499863638697844, -96.7399004965295, 15.395963775526864, -126.78553388687891, -7.39446283679418, -54.16600982367192, 13.335291374395299, 3.602759450173556, -0.9042069630191358, -57.486845417658415, -70.20807509112603, -58.83448617834743, -0.5513979582439219, 81.54027107515627, 0.40614919777336705, -1.5984765436618387, -0.12304746266637114, -10.871367035253567, -83.00110137401805, -35.40817579368484, -28.24458148631766, -17.144054804164586, -42.88231485606143, -5.26728611747116, -54.1109617480232, -57.988260976534875, -99.1621043676555, -85.77785540419032, -60.62039857787147, -34.84194656115849, -32.71238640710036, 1.0171491356697007, -76.3273759005757, 24.28185952338771, 16.247351349195604, 8.237485027285446, -33.86917004696489, -105.85289150798224, -67.85728748205148, -78.55068402883296, -78.81613103658194, -2.8826810937411356, 8.752392810646379, -27.6373291103852, 0.012813177369972084, -26.6113636184524, -22.907727648098735, -55.982686564440144, -145.55109422632555, -44.72330587029697, -167.3558959353322, -38.829773910408996, -68.98194850844483, -54.348093462002055, -13.259790304372121, 51.8757223612213, 35.30589402200013, 1.1709317207336087, 1.0063671856071976, -95.2668256717204, -5.941209552437945, -31.984922948088382, -3.1764708217479334, -21.196150491232245, -93.80897545411649, -13.766390320815123, 31.55171093451427, -12.56132931457488, -1.9945721181681237, -40.61167955957616, 25.412709391480256, -110.6813187806403, 23.544189090820787, -0.6772816884427015, 46.97217588795552, 0.805169279229237, 84.02881771994697, -48.930108545797864, 20.977900547363888, -126.19696952394649, -76.94763334993674, -1.7169721014998902, -21.390451369878686, -8.552638662131791, -2.989193829497717, -32.98339006182163, -4.755298920928372, -60.37387278365263, -37.7830106999984, 101.37651708819467, -0.771660187297946, -45.31842680818609, -1.0416228671133068, 19.860300761390636, -0.7584813074559278, 73.94596182902839, -73.67006883202357, -86.76937914836003, -5.10914424744498, -3.891298920980674, -249.3822209434583, 63.41274385630935, -144.71148110494215], "policy_predator_policy_reward": [132.37632991144994, 124.46865646595563, 0.9999837677095733, 181.4446563447499, 19.857633913522744, 13.509454398117027, 20.007120367277665, 7.440998692134773, 275.6906187297538, 11.348022521486893, 53.33707595048888, 47.83312781625274, 0.0, 15.616429057768492, 48.45744460001486, 9.816378579173849, 31.687244108962574, 35.77181183225333, 231.96573865047503, 4.604854103800143, 9.333022642651974, 27.582569808694718, 64.89283314145948, 55.60814225775702, 11.658293912527304, 21.428146584927266, 20.356536674832242, 114.58916122096497, 79.3066453831666, 181.1250721701186, 102.39048898076554, 21.585099430547462, 205.19978365515234, 247.06097791833696, 16.320767254662428, 56.1792438104103, 29.35346455840833, 127.58472892524836, 6.504641057564419, 8.568628778937997, 100.52429133385647, 95.4492398815628, 83.35760924287615, 3.357169666160852, 173.9008771939704, 148.35370290483516, 7.5329720345905535, 87.69715599042958, 5.740735111078227, 23.869492434716086, 16.47698737342005, 103.98457683931068, 66.66138604362533, 199.85714975718162, 14.085645882366865, 9.90482719769258, 118.26456264918107, 7.288346997037936, 0.0, 53.94554503259531, 3.6419484200134287, 1.803128443947026, 126.25556894359534, 7.313342889373384, 91.31917552217737, 69.23016626460495, 0.0, 3.378561668249611, 80.54230732924546, 77.67227230879173, 0.9865723304470366, 62.466831545318385, 81.0613883285311, 0.9827105613209742, 38.90706525957837, 3.6417034406830036, 45.00036662590734, 114.69770303301746, 114.53045357402837, 4.065883571651266, 83.53850001291617, 105.12407470129806, 72.630585110363, 68.2248548291702, 95.01901344405994, 37.02576455621285, 101.05620436130815, 38.139275665599975, 2.7270127173370264, 112.84572049157988, 7.415365954964008, 247.74782659449605, 5.351221049173486, 48.84553321412788, 2.281065147010451, 155.12810256067155, 7.14029016253955, 10.439863638697803, 115.26337936092658, 14.845552473939216, 142.97553388687862, 9.344462836794138, 38.59596868895126, 77.72554733027827, 93.05724054982649, 2.8742069630191183, 59.08881913498408, 99.20610137379998, 99.6744861783475, 5.697921508475331, 15.402576293155544, 11.677842656491832, 3.558476543661806, 2.1030474626663707, 80.1671705622022, 80.90006097741785, 6.549506793960346, 61.93292055360824, 0.0, 67.991060395223, 73.21688703209034, 26.121360833404058, 4.638751267609198, 147.51113052988603, 105.77469255942576, 116.50067616156682, 45.45260999460973, 92.94324759055674, 68.78376374216013, 104.06623295908476, 21.103617993177885, 37.17526079536339, 19.422948440216242, 44.38107526151601, 110.17306347807343, 153.16281383759684, 128.0299147368405, 112.14926621508657, 4.852681093741094, 62.17760718935358, 32.63512475845572, 39.43759028909975, 34.34795994683227, 25.190859687259486, 5.427822023343439, 196.87418558405244, 137.3338521096292, 99.43683434112104, 31.399661440905685, 86.29504084517032, 71.84445877753637, 2.1871791065090527, 17.304277638778622, 11.154105977999961, 0.9836328143928038, 0.0, 77.72323835561552, 76.17047517583104, 39.437449267973605, 14.163944501862904, 101.0658300082887, 77.7074511581628, 15.706390320815082, 19.808289065485766, 14.421329314574843, 3.964572118168082, 45.24167955957613, 79.97729060851981, 141.5454714536192, 15.610285445888065, 36.393370103267976, 12.371940200645946, 3.5945066828567067, 21.38150631796719, 51.61791416589061, 79.69452945776521, 142.2569695239471, 83.3776333499375, 24.36804116015391, 94.00885420153207, 13.331613968790464, 27.300608945044733, 34.64339006182166, 6.70529892092833, 101.04035661495936, 5.94034915177699, 29.56160063014788, 12.934418909928707, 62.59845037082394, 62.881383526193105, 44.2096992386094, 2.7384813074559133, 56.82494443383735, 76.91559962603436, 91.31937914836043, 7.069144247444938, 5.851298920980632, 254.52222094345726, 110.75670897790893, 107.30023709795488]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8372221670294349, "mean_inference_ms": 2.6446103418174376, "mean_action_processing_ms": 0.3577273203582017, "mean_env_wait_ms": 0.29313949973869874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01365804672241211, "StateBufferConnector_ms": 0.0032671689987182617, "ViewRequirementAgentConnector_ms": 0.09951317310333252}, "num_episodes": 18, "episode_return_max": 226.47999999999934, "episode_return_min": -41.02932976539656, "episode_return_mean": 66.37291462782224, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 336.8506132039805, "num_env_steps_trained_throughput_per_sec": 336.8506132039805, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 11541.211, "restore_workers_time_ms": 0.012, "training_step_time_ms": 11541.175, "sample_time_ms": 1673.869, "learn_time_ms": 9850.234, "learn_throughput": 406.082, "synch_weights_time_ms": 15.985}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 93, "trial_id": "61e09_00000", "date": "2024-08-16_16-28-46", "timestamp": 1723805926, "time_this_iter_s": 11.896330118179321, "time_total_s": 1325.421745300293, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3000bde50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1325.421745300293, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 54.75294117647059, "ram_util_percent": 74.96470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.78895377261298, "cur_kl_coeff": 0.10678710937499997, "cur_lr": 0.00010000000000000003, "total_loss": 4.164628797864157, "policy_loss": -0.008258013228057987, "vf_loss": 4.172010235054783, "vf_explained_var": 0.06747775863087367, "kl": 0.008208563145623559, "entropy": 0.5794005463520686, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.720927969173149, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 7.052384777926894, "policy_loss": -0.014832984074881232, "vf_loss": 7.063854496062748, "vf_explained_var": 0.3716110596581111, "kl": 0.01121086889981829, "entropy": 1.1340554004623777, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "env_runners": {"episode_reward_max": 280.0595372040129, "episode_reward_min": -10.542249900090962, "episode_reward_mean": 67.25485403693918, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -249.3822209434583, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 126.14443839547022, "predator_policy": 254.52222094345726}, "policy_reward_mean": {"prey_policy": -22.39337876293378, "predator_policy": 56.02080578140334}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.80534243291001, 5.309999999999941, 74.12000000000062, 154.82999999999998, 22.244348051090814, 222.9503039960339, 17.165455128894024, 3.6099999999999666, 4.889835774536181, -10.542249900090962, 200.5544412906509, 126.73000000000086, 71.43654838281724, 112.86222946575961, 48.769999999999605, 93.91000000000115, 31.250262144656393, 126.66626325118553, 128.0964106907511, 13.929999999999954, 147.92310050378092, -1.3195527218455745, 40.38163937011967, 43.755368013996176, 33.220000000000034, 2.7799999999999856, 3.8999999999999613, 48.76499511386248, 18.140000000000114, 75.49079756995212, 98.63000000000079, 30.60000000000035, 45.986523550230956, 109.02683922257782, 3.93999999999996, 67.19476313034832, 4.8296700675658855, 7.964690734996886, 39.95999999999951, -5.000483546695859, 75.87711473893091, 70.84152461690692, 97.53976993633992, 98.80808966112484, 38.17233868205229, 89.62569832563683, 82.81236588651228, 72.90000000000035, 44.44819911454053, 10.019728367540603, 0.7682268166310704, 24.691484645122472, 9.882979867221858, 6.423754117671315, 115.6400000000007, 3.160931720733585, 52.68567830728834, 18.440000000000357, 63.768155221101765, 53.30000000000011, 3.8299999999999623, 110.02000000000027, 70.01862720968704, 95.06020450342704, 109.81000000000077, 103.36023562522226, 22.490000000000325, 95.26947189030804, 29.090390422206127, 3.6099999999999675, 8.823822283085624, 143.1008764409732, 79.11978422171744, 66.05000000000038, 134.01643705687658, 6.509999999999925, 7.09999999999995, 136.75820882723247, 21.01646231750562, 90.11430243015243, 111.42000000000056, 87.20083209017407, 249.419999999999, 159.41781145084377, 45.41000000000003, 125.4001455270128, 82.96000000000097, 280.0595372040129, 24.988866671843713, 75.76404242535374, 118.53000000000084, 48.42138006065136, 161.3339966558332, 41.19999999999942, 58.51999999999959, 108.62001068166282, 142.09050281642726, 7.82587313826118, 31.32000000000048, 14.849999999999955], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-147.90121518791491, -53.548022477980716, -5.572972034590595, -84.34715599042907, -3.780735111078269, 48.29050756528376, 34.64076556501197, -0.27232977774256706, -142.11621412036982, -102.15797362934566, 92.70435411763334, 106.25547679834219, -106.86161064512456, -1.5258438722004177, 2.0000000000000013, -52.335545032595576, 1.1167073305892163, -1.6719484200134633, -78.39648103759635, -65.7146806954628, 5.184599074216964, 34.8205004296519, 124.76000000000029, -1.4085616682496398, -78.31061687767479, -8.467414377544836, 31.126543217146395, 18.282282372847213, -1.2778025588480466, -31.996296331004, -7.347065259578361, 58.70829655931678, -57.87504225724409, -70.5727652570242, -13.12922922920234, 21.199155334708212, 29.625476677571243, -90.19164070103488, -1.8468071435042814, -125.07863279602854, 44.66807912637824, -28.789756622870122, -72.09641335921475, -68.41861938953843, -8.6223233798784, -66.5687704589184, -108.47592417543004, -102.93190036003341, 14.804877903238708, -35.78163216654036, -0.3010651470104553, -154.32810256067185, -5.180290162539592, -8.499863638697844, -96.7399004965295, 15.395963775526864, -126.78553388687891, -7.39446283679418, -54.16600982367192, 13.335291374395299, 3.602759450173556, -0.9042069630191358, -57.486845417658415, -70.20807509112603, -58.83448617834743, -0.5513979582439219, 81.54027107515627, 0.40614919777336705, -1.5984765436618387, -0.12304746266637114, -10.871367035253567, -83.00110137401805, -35.40817579368484, -28.24458148631766, -17.144054804164586, -42.88231485606143, -5.26728611747116, -54.1109617480232, -57.988260976534875, -99.1621043676555, -85.77785540419032, -60.62039857787147, -34.84194656115849, -32.71238640710036, 1.0171491356697007, -76.3273759005757, 24.28185952338771, 16.247351349195604, 8.237485027285446, -33.86917004696489, -105.85289150798224, -67.85728748205148, -78.55068402883296, -78.81613103658194, -2.8826810937411356, 8.752392810646379, -27.6373291103852, 0.012813177369972084, -26.6113636184524, -22.907727648098735, -55.982686564440144, -145.55109422632555, -44.72330587029697, -167.3558959353322, -38.829773910408996, -68.98194850844483, -54.348093462002055, -13.259790304372121, 51.8757223612213, 35.30589402200013, 1.1709317207336087, 1.0063671856071976, -95.2668256717204, -5.941209552437945, -31.984922948088382, -3.1764708217479334, -21.196150491232245, -93.80897545411649, -13.766390320815123, 31.55171093451427, -12.56132931457488, -1.9945721181681237, -40.61167955957616, 25.412709391480256, -110.6813187806403, 23.544189090820787, -0.6772816884427015, 46.97217588795552, 0.805169279229237, 84.02881771994697, -48.930108545797864, 20.977900547363888, -126.19696952394649, -76.94763334993674, -1.7169721014998902, -21.390451369878686, -8.552638662131791, -2.989193829497717, -32.98339006182163, -4.755298920928372, -60.37387278365263, -37.7830106999984, 101.37651708819467, -0.771660187297946, -45.31842680818609, -1.0416228671133068, 19.860300761390636, -0.7584813074559278, 73.94596182902839, -73.67006883202357, -86.76937914836003, -5.10914424744498, -3.891298920980674, -249.3822209434583, 63.41274385630935, -144.71148110494215, -11.931126751482385, -26.804147979501053, -106.12403555802298, -49.67600530359155, 21.080196030862105, -0.6935469778039789, 50.07818529550336, -96.36995937193427, 114.40180263442932, 126.14443839547022, 125.44737022781563, 1.0999084972530564, 21.651879606995333, -5.54767723580073, -6.468801836586273, 44.815686045037225, 57.86496172031795, 0.9810738528094921, 44.73931042932755, -146.06793183662066, -25.36308114307069, -15.146579909246373, 0.8868733764897011, -138.04952299080915, 97.89483932051932, -22.065456021945373, -64.70597836877324, -26.28861229277751, 73.99342574336553, -24.923509826349918, 34.461852608032004, -42.82248139054984, -27.24709654864718, -44.6625216948751, 40.90246151464953, -3.2616216446684927, 68.53595063272978, 0.20460048962421254, -181.94270394630985, -53.80857657611817, -8.958596108389392, -12.969119815181479, -4.535914251211629, 12.88999999999998], "policy_predator_policy_reward": [173.9008771939704, 148.35370290483516, 7.5329720345905535, 87.69715599042958, 5.740735111078227, 23.869492434716086, 16.47698737342005, 103.98457683931068, 66.66138604362533, 199.85714975718162, 14.085645882366865, 9.90482719769258, 118.26456264918107, 7.288346997037936, 0.0, 53.94554503259531, 3.6419484200134287, 1.803128443947026, 126.25556894359534, 7.313342889373384, 91.31917552217737, 69.23016626460495, 0.0, 3.378561668249611, 80.54230732924546, 77.67227230879173, 0.9865723304470366, 62.466831545318385, 81.0613883285311, 0.9827105613209742, 38.90706525957837, 3.6417034406830036, 45.00036662590734, 114.69770303301746, 114.53045357402837, 4.065883571651266, 83.53850001291617, 105.12407470129806, 72.630585110363, 68.2248548291702, 95.01901344405994, 37.02576455621285, 101.05620436130815, 38.139275665599975, 2.7270127173370264, 112.84572049157988, 7.415365954964008, 247.74782659449605, 5.351221049173486, 48.84553321412788, 2.281065147010451, 155.12810256067155, 7.14029016253955, 10.439863638697803, 115.26337936092658, 14.845552473939216, 142.97553388687862, 9.344462836794138, 38.59596868895126, 77.72554733027827, 93.05724054982649, 2.8742069630191183, 59.08881913498408, 99.20610137379998, 99.6744861783475, 5.697921508475331, 15.402576293155544, 11.677842656491832, 3.558476543661806, 2.1030474626663707, 80.1671705622022, 80.90006097741785, 6.549506793960346, 61.93292055360824, 0.0, 67.991060395223, 73.21688703209034, 26.121360833404058, 4.638751267609198, 147.51113052988603, 105.77469255942576, 116.50067616156682, 45.45260999460973, 92.94324759055674, 68.78376374216013, 104.06623295908476, 21.103617993177885, 37.17526079536339, 19.422948440216242, 44.38107526151601, 110.17306347807343, 153.16281383759684, 128.0299147368405, 112.14926621508657, 4.852681093741094, 62.17760718935358, 32.63512475845572, 39.43759028909975, 34.34795994683227, 25.190859687259486, 5.427822023343439, 196.87418558405244, 137.3338521096292, 99.43683434112104, 31.399661440905685, 86.29504084517032, 71.84445877753637, 2.1871791065090527, 17.304277638778622, 11.154105977999961, 0.9836328143928038, 0.0, 77.72323835561552, 76.17047517583104, 39.437449267973605, 14.163944501862904, 101.0658300082887, 77.7074511581628, 15.706390320815082, 19.808289065485766, 14.421329314574843, 3.964572118168082, 45.24167955957613, 79.97729060851981, 141.5454714536192, 15.610285445888065, 36.393370103267976, 12.371940200645946, 3.5945066828567067, 21.38150631796719, 51.61791416589061, 79.69452945776521, 142.2569695239471, 83.3776333499375, 24.36804116015391, 94.00885420153207, 13.331613968790464, 27.300608945044733, 34.64339006182166, 6.70529892092833, 101.04035661495936, 5.94034915177699, 29.56160063014788, 12.934418909928707, 62.59845037082394, 62.881383526193105, 44.2096992386094, 2.7384813074559133, 56.82494443383735, 76.91559962603436, 91.31937914836043, 7.069144247444938, 5.851298920980632, 254.52222094345726, 110.75670897790893, 107.30023709795488, 30.097098729967737, 29.65463831852143, 201.70081059317957, 44.21353269858716, 80.28810997465358, 10.745240972288292, 2.0932978785769456, 131.39930828802792, 3.3981973655710007, 5.475561604530041, 26.93262977218447, 5.937902953590851, 21.79812039300471, 7.5076772358006885, 87.05326131856144, 0.0, 2.409543134125199, 21.704421292747714, 159.53286810089375, 221.8552905104128, 37.802234408703605, 27.696293315456685, 7.367169048863939, 205.55952299080866, 11.91516067948091, 30.785456021945635, 65.48724025885889, 73.92873046334348, 70.13043814422198, 42.13364259459613, 0.0, 49.56062878251736, 109.84055877316742, 20.589059470354968, 56.63104458752435, 14.348126224157179, 35.10059003576668, 38.24936165830651, 159.4752582088561, 84.10189545183187, 10.90859610838935, 42.339119815181455, 6.4959142512115875, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8346396066043821, "mean_inference_ms": 2.6373590636525863, "mean_action_processing_ms": 0.35652782351925977, "mean_env_wait_ms": 0.29207278313890134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005892395973205566, "StateBufferConnector_ms": 0.00310516357421875, "ViewRequirementAgentConnector_ms": 0.09506738185882568}, "num_episodes": 22, "episode_return_max": 280.0595372040129, "episode_return_min": -10.542249900090962, "episode_return_mean": 67.25485403693918, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 29.437670769454627, "num_env_steps_trained_throughput_per_sec": 29.437670769454627, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1504000, "timers": {"training_iteration_time_ms": 24017.586, "restore_workers_time_ms": 0.012, "training_step_time_ms": 24017.551, "sample_time_ms": 1654.006, "learn_time_ms": 22346.673, "learn_throughput": 178.998, "synch_weights_time_ms": 15.709}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "done": false, "training_iteration": 94, "trial_id": "61e09_00000", "date": "2024-08-16_16-31-02", "timestamp": 1723806062, "time_this_iter_s": 135.88686203956604, "time_total_s": 1461.308607339859, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3000398b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1461.308607339859, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 53.653333333333336, "ram_util_percent": 76.31333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.218842326017914, "cur_kl_coeff": 0.10678710937499997, "cur_lr": 0.00010000000000000003, "total_loss": 2.3683930895946643, "policy_loss": -0.010578837564643768, "vf_loss": 2.3779453209468295, "vf_explained_var": 0.11640818664636561, "kl": 0.009613623886260548, "entropy": 0.5512687896294569, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.489975183161478, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 6.836966867295523, "policy_loss": -0.0177167498581752, "vf_loss": 6.84994030301533, "vf_explained_var": 0.7823536587139917, "kl": 0.01581104930285441, "entropy": 1.255327897286289, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 319.3244848257347, "episode_reward_min": -5.000483546695859, "episode_reward_mean": 90.79427760963766, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -249.3822209434583, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 183.18456931177263, "predator_policy": 254.52222094345726}, "policy_reward_mean": {"prey_policy": -6.56028054224841, "predator_policy": 51.95741934706722}, "custom_metrics": {}, "hist_stats": {"episode_reward": [128.0964106907511, 13.929999999999954, 147.92310050378092, -1.3195527218455745, 40.38163937011967, 43.755368013996176, 33.220000000000034, 2.7799999999999856, 3.8999999999999613, 48.76499511386248, 18.140000000000114, 75.49079756995212, 98.63000000000079, 30.60000000000035, 45.986523550230956, 109.02683922257782, 3.93999999999996, 67.19476313034832, 4.8296700675658855, 7.964690734996886, 39.95999999999951, -5.000483546695859, 75.87711473893091, 70.84152461690692, 97.53976993633992, 98.80808966112484, 38.17233868205229, 89.62569832563683, 82.81236588651228, 72.90000000000035, 44.44819911454053, 10.019728367540603, 0.7682268166310704, 24.691484645122472, 9.882979867221858, 6.423754117671315, 115.6400000000007, 3.160931720733585, 52.68567830728834, 18.440000000000357, 63.768155221101765, 53.30000000000011, 3.8299999999999623, 110.02000000000027, 70.01862720968704, 95.06020450342704, 109.81000000000077, 103.36023562522226, 22.490000000000325, 95.26947189030804, 29.090390422206127, 3.6099999999999675, 8.823822283085624, 143.1008764409732, 79.11978422171744, 66.05000000000038, 134.01643705687658, 6.509999999999925, 7.09999999999995, 136.75820882723247, 21.01646231750562, 90.11430243015243, 111.42000000000056, 87.20083209017407, 249.419999999999, 159.41781145084377, 45.41000000000003, 125.4001455270128, 82.96000000000097, 280.0595372040129, 24.988866671843713, 75.76404242535374, 118.53000000000084, 48.42138006065136, 161.3339966558332, 41.19999999999942, 58.51999999999959, 108.62001068166282, 142.09050281642726, 7.82587313826118, 31.32000000000048, 14.849999999999955, 147.11848890692835, 159.89234019962487, 272.268461258613, 152.2400000000001, 297.92693074143244, 151.23000000000005, 261.2282827122287, 187.03999999999957, 261.8299999999999, 156.37000000000018, 135.19000000000028, 294.16068470445805, 53.370571319985025, 270.3558336017585, 132.20905901753156, 295.6699999999998, 234.0799999999998, 319.3244848257347], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [29.625476677571243, -90.19164070103488, -1.8468071435042814, -125.07863279602854, 44.66807912637824, -28.789756622870122, -72.09641335921475, -68.41861938953843, -8.6223233798784, -66.5687704589184, -108.47592417543004, -102.93190036003341, 14.804877903238708, -35.78163216654036, -0.3010651470104553, -154.32810256067185, -5.180290162539592, -8.499863638697844, -96.7399004965295, 15.395963775526864, -126.78553388687891, -7.39446283679418, -54.16600982367192, 13.335291374395299, 3.602759450173556, -0.9042069630191358, -57.486845417658415, -70.20807509112603, -58.83448617834743, -0.5513979582439219, 81.54027107515627, 0.40614919777336705, -1.5984765436618387, -0.12304746266637114, -10.871367035253567, -83.00110137401805, -35.40817579368484, -28.24458148631766, -17.144054804164586, -42.88231485606143, -5.26728611747116, -54.1109617480232, -57.988260976534875, -99.1621043676555, -85.77785540419032, -60.62039857787147, -34.84194656115849, -32.71238640710036, 1.0171491356697007, -76.3273759005757, 24.28185952338771, 16.247351349195604, 8.237485027285446, -33.86917004696489, -105.85289150798224, -67.85728748205148, -78.55068402883296, -78.81613103658194, -2.8826810937411356, 8.752392810646379, -27.6373291103852, 0.012813177369972084, -26.6113636184524, -22.907727648098735, -55.982686564440144, -145.55109422632555, -44.72330587029697, -167.3558959353322, -38.829773910408996, -68.98194850844483, -54.348093462002055, -13.259790304372121, 51.8757223612213, 35.30589402200013, 1.1709317207336087, 1.0063671856071976, -95.2668256717204, -5.941209552437945, -31.984922948088382, -3.1764708217479334, -21.196150491232245, -93.80897545411649, -13.766390320815123, 31.55171093451427, -12.56132931457488, -1.9945721181681237, -40.61167955957616, 25.412709391480256, -110.6813187806403, 23.544189090820787, -0.6772816884427015, 46.97217588795552, 0.805169279229237, 84.02881771994697, -48.930108545797864, 20.977900547363888, -126.19696952394649, -76.94763334993674, -1.7169721014998902, -21.390451369878686, -8.552638662131791, -2.989193829497717, -32.98339006182163, -4.755298920928372, -60.37387278365263, -37.7830106999984, 101.37651708819467, -0.771660187297946, -45.31842680818609, -1.0416228671133068, 19.860300761390636, -0.7584813074559278, 73.94596182902839, -73.67006883202357, -86.76937914836003, -5.10914424744498, -3.891298920980674, -249.3822209434583, 63.41274385630935, -144.71148110494215, -11.931126751482385, -26.804147979501053, -106.12403555802298, -49.67600530359155, 21.080196030862105, -0.6935469778039789, 50.07818529550336, -96.36995937193427, 114.40180263442932, 126.14443839547022, 125.44737022781563, 1.0999084972530564, 21.651879606995333, -5.54767723580073, -6.468801836586273, 44.815686045037225, 57.86496172031795, 0.9810738528094921, 44.73931042932755, -146.06793183662066, -25.36308114307069, -15.146579909246373, 0.8868733764897011, -138.04952299080915, 97.89483932051932, -22.065456021945373, -64.70597836877324, -26.28861229277751, 73.99342574336553, -24.923509826349918, 34.461852608032004, -42.82248139054984, -27.24709654864718, -44.6625216948751, 40.90246151464953, -3.2616216446684927, 68.53595063272978, 0.20460048962421254, -181.94270394630985, -53.80857657611817, -8.958596108389392, -12.969119815181479, -4.535914251211629, 12.88999999999998, 75.1597998174868, -59.0636348675528, 108.09357346586155, -37.92240669451295, 99.90562716296863, 121.62836621252818, 93.09218729735692, -6.401431121731656, 152.60244879887074, 109.65286139829752, 106.23744237530288, 0.9402289393527218, 102.83811553786231, 106.74938461939604, -16.71458309400484, 183.18456931177263, 73.23208826591163, 130.67284347701684, -7.6388019357471215, 149.46492317041475, 110.43143244293783, -32.36343967163511, 65.64280247045119, 78.45735384975278, -24.974467158251255, 19.602891885675387, 66.87596429873399, 95.30288751775826, 38.17513925420708, 2.0000000000000013, 124.32459644544952, 121.68799068516152, 167.18684021285117, 12.749291055975162, 129.58910159347707, 168.7193236336115], "policy_predator_policy_reward": [83.53850001291617, 105.12407470129806, 72.630585110363, 68.2248548291702, 95.01901344405994, 37.02576455621285, 101.05620436130815, 38.139275665599975, 2.7270127173370264, 112.84572049157988, 7.415365954964008, 247.74782659449605, 5.351221049173486, 48.84553321412788, 2.281065147010451, 155.12810256067155, 7.14029016253955, 10.439863638697803, 115.26337936092658, 14.845552473939216, 142.97553388687862, 9.344462836794138, 38.59596868895126, 77.72554733027827, 93.05724054982649, 2.8742069630191183, 59.08881913498408, 99.20610137379998, 99.6744861783475, 5.697921508475331, 15.402576293155544, 11.677842656491832, 3.558476543661806, 2.1030474626663707, 80.1671705622022, 80.90006097741785, 6.549506793960346, 61.93292055360824, 0.0, 67.991060395223, 73.21688703209034, 26.121360833404058, 4.638751267609198, 147.51113052988603, 105.77469255942576, 116.50067616156682, 45.45260999460973, 92.94324759055674, 68.78376374216013, 104.06623295908476, 21.103617993177885, 37.17526079536339, 19.422948440216242, 44.38107526151601, 110.17306347807343, 153.16281383759684, 128.0299147368405, 112.14926621508657, 4.852681093741094, 62.17760718935358, 32.63512475845572, 39.43759028909975, 34.34795994683227, 25.190859687259486, 5.427822023343439, 196.87418558405244, 137.3338521096292, 99.43683434112104, 31.399661440905685, 86.29504084517032, 71.84445877753637, 2.1871791065090527, 17.304277638778622, 11.154105977999961, 0.9836328143928038, 0.0, 77.72323835561552, 76.17047517583104, 39.437449267973605, 14.163944501862904, 101.0658300082887, 77.7074511581628, 15.706390320815082, 19.808289065485766, 14.421329314574843, 3.964572118168082, 45.24167955957613, 79.97729060851981, 141.5454714536192, 15.610285445888065, 36.393370103267976, 12.371940200645946, 3.5945066828567067, 21.38150631796719, 51.61791416589061, 79.69452945776521, 142.2569695239471, 83.3776333499375, 24.36804116015391, 94.00885420153207, 13.331613968790464, 27.300608945044733, 34.64339006182166, 6.70529892092833, 101.04035661495936, 5.94034915177699, 29.56160063014788, 12.934418909928707, 62.59845037082394, 62.881383526193105, 44.2096992386094, 2.7384813074559133, 56.82494443383735, 76.91559962603436, 91.31937914836043, 7.069144247444938, 5.851298920980632, 254.52222094345726, 110.75670897790893, 107.30023709795488, 30.097098729967737, 29.65463831852143, 201.70081059317957, 44.21353269858716, 80.28810997465358, 10.745240972288292, 2.0932978785769456, 131.39930828802792, 3.3981973655710007, 5.475561604530041, 26.93262977218447, 5.937902953590851, 21.79812039300471, 7.5076772358006885, 87.05326131856144, 0.0, 2.409543134125199, 21.704421292747714, 159.53286810089375, 221.8552905104128, 37.802234408703605, 27.696293315456685, 7.367169048863939, 205.55952299080866, 11.91516067948091, 30.785456021945635, 65.48724025885889, 73.92873046334348, 70.13043814422198, 42.13364259459613, 0.0, 49.56062878251736, 109.84055877316742, 20.589059470354968, 56.63104458752435, 14.348126224157179, 35.10059003576668, 38.24936165830651, 159.4752582088561, 84.10189545183187, 10.90859610838935, 42.339119815181455, 6.4959142512115875, 0.0, 60.05484646709964, 70.96747748989452, 38.35708849326971, 51.36408493500694, 48.05135195637577, 2.68311592674071, 57.19781270264307, 8.351431121731615, 3.4286816400187687, 32.24293890424573, 42.24463147823528, 1.8076972071091393, 51.64078255497097, 0.0, 19.57290367254312, 0.9971101096893062, 45.12791173408837, 12.797156522983189, 9.57880193574708, 4.965076829585305, 15.781033196948455, 41.34097403174904, 68.17879264660384, 81.88173573765044, 38.72897037158501, 20.013176220976177, 31.368507537686966, 76.80847424757948, 55.36976646561626, 36.66415329770804, 2.5197285237454228, 47.13768434564367, 43.082925491304735, 11.060943239869, 0.7687276098569703, 20.247331988789636]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8325720892916408, "mean_inference_ms": 2.631413046370451, "mean_action_processing_ms": 0.3555756018489201, "mean_env_wait_ms": 0.29122185943313184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006446480751037598, "StateBufferConnector_ms": 0.003179192543029785, "ViewRequirementAgentConnector_ms": 0.09718573093414307}, "num_episodes": 18, "episode_return_max": 319.3244848257347, "episode_return_min": -5.000483546695859, "episode_return_mean": 90.79427760963766, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 370.18149956990703, "num_env_steps_trained_throughput_per_sec": 370.18149956990703, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 23924.291, "restore_workers_time_ms": 0.012, "training_step_time_ms": 23924.256, "sample_time_ms": 1549.92, "learn_time_ms": 22357.334, "learn_throughput": 178.912, "synch_weights_time_ms": 15.807}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 95, "trial_id": "61e09_00000", "date": "2024-08-16_16-31-13", "timestamp": 1723806073, "time_this_iter_s": 10.814337015151978, "time_total_s": 1472.122944355011, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x300039b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1472.122944355011, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 54.287499999999994, "ram_util_percent": 76.32499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.194456594393998, "cur_kl_coeff": 0.10678710937499997, "cur_lr": 0.00010000000000000003, "total_loss": 1.5193091289391594, "policy_loss": -0.009555155131719494, "vf_loss": 1.5282985640265954, "vf_explained_var": 0.13093768124857907, "kl": 0.005297666410532576, "entropy": 0.5834333141644795, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.458114865721849, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 6.805318454207566, "policy_loss": -0.013219248590172913, "vf_loss": 6.813696368283065, "vf_explained_var": 0.7254151869703223, "kl": 0.016137767826229714, "entropy": 1.226298879189466, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 386.09765456586393, "episode_reward_min": 0.7682268166310704, "episode_reward_mean": 139.23519533349597, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -249.3822209434583, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 184.84037864351978, "predator_policy": 254.52222094345726}, "policy_reward_mean": {"prey_policy": 23.044208882684188, "predator_policy": 46.57338878406379}, "custom_metrics": {}, "hist_stats": {"episode_reward": [70.84152461690692, 97.53976993633992, 98.80808966112484, 38.17233868205229, 89.62569832563683, 82.81236588651228, 72.90000000000035, 44.44819911454053, 10.019728367540603, 0.7682268166310704, 24.691484645122472, 9.882979867221858, 6.423754117671315, 115.6400000000007, 3.160931720733585, 52.68567830728834, 18.440000000000357, 63.768155221101765, 53.30000000000011, 3.8299999999999623, 110.02000000000027, 70.01862720968704, 95.06020450342704, 109.81000000000077, 103.36023562522226, 22.490000000000325, 95.26947189030804, 29.090390422206127, 3.6099999999999675, 8.823822283085624, 143.1008764409732, 79.11978422171744, 66.05000000000038, 134.01643705687658, 6.509999999999925, 7.09999999999995, 136.75820882723247, 21.01646231750562, 90.11430243015243, 111.42000000000056, 87.20083209017407, 249.419999999999, 159.41781145084377, 45.41000000000003, 125.4001455270128, 82.96000000000097, 280.0595372040129, 24.988866671843713, 75.76404242535374, 118.53000000000084, 48.42138006065136, 161.3339966558332, 41.19999999999942, 58.51999999999959, 108.62001068166282, 142.09050281642726, 7.82587313826118, 31.32000000000048, 14.849999999999955, 147.11848890692835, 159.89234019962487, 272.268461258613, 152.2400000000001, 297.92693074143244, 151.23000000000005, 261.2282827122287, 187.03999999999957, 261.8299999999999, 156.37000000000018, 135.19000000000028, 294.16068470445805, 53.370571319985025, 270.3558336017585, 132.20905901753156, 295.6699999999998, 234.0799999999998, 319.3244848257347, 148.27, 175.93999999999988, 128.57328427200412, 371.5981006730252, 328.25664966966036, 300.6378562020904, 281.1299999999999, 386.09765456586393, 234.4999999999988, 310.7776128723351, 121.25000000000038, 302.9786048630144, 270.826155160839, 343.41307163675754, 294.91999999999956, 210.55041120845635, 327.17616799942766, 160.34999999999997, 161.04000000000008, 306.28518578159844, 298.41458308500836, 229.39137364425233, 185.78693719007043], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-34.84194656115849, -32.71238640710036, 1.0171491356697007, -76.3273759005757, 24.28185952338771, 16.247351349195604, 8.237485027285446, -33.86917004696489, -105.85289150798224, -67.85728748205148, -78.55068402883296, -78.81613103658194, -2.8826810937411356, 8.752392810646379, -27.6373291103852, 0.012813177369972084, -26.6113636184524, -22.907727648098735, -55.982686564440144, -145.55109422632555, -44.72330587029697, -167.3558959353322, -38.829773910408996, -68.98194850844483, -54.348093462002055, -13.259790304372121, 51.8757223612213, 35.30589402200013, 1.1709317207336087, 1.0063671856071976, -95.2668256717204, -5.941209552437945, -31.984922948088382, -3.1764708217479334, -21.196150491232245, -93.80897545411649, -13.766390320815123, 31.55171093451427, -12.56132931457488, -1.9945721181681237, -40.61167955957616, 25.412709391480256, -110.6813187806403, 23.544189090820787, -0.6772816884427015, 46.97217588795552, 0.805169279229237, 84.02881771994697, -48.930108545797864, 20.977900547363888, -126.19696952394649, -76.94763334993674, -1.7169721014998902, -21.390451369878686, -8.552638662131791, -2.989193829497717, -32.98339006182163, -4.755298920928372, -60.37387278365263, -37.7830106999984, 101.37651708819467, -0.771660187297946, -45.31842680818609, -1.0416228671133068, 19.860300761390636, -0.7584813074559278, 73.94596182902839, -73.67006883202357, -86.76937914836003, -5.10914424744498, -3.891298920980674, -249.3822209434583, 63.41274385630935, -144.71148110494215, -11.931126751482385, -26.804147979501053, -106.12403555802298, -49.67600530359155, 21.080196030862105, -0.6935469778039789, 50.07818529550336, -96.36995937193427, 114.40180263442932, 126.14443839547022, 125.44737022781563, 1.0999084972530564, 21.651879606995333, -5.54767723580073, -6.468801836586273, 44.815686045037225, 57.86496172031795, 0.9810738528094921, 44.73931042932755, -146.06793183662066, -25.36308114307069, -15.146579909246373, 0.8868733764897011, -138.04952299080915, 97.89483932051932, -22.065456021945373, -64.70597836877324, -26.28861229277751, 73.99342574336553, -24.923509826349918, 34.461852608032004, -42.82248139054984, -27.24709654864718, -44.6625216948751, 40.90246151464953, -3.2616216446684927, 68.53595063272978, 0.20460048962421254, -181.94270394630985, -53.80857657611817, -8.958596108389392, -12.969119815181479, -4.535914251211629, 12.88999999999998, 75.1597998174868, -59.0636348675528, 108.09357346586155, -37.92240669451295, 99.90562716296863, 121.62836621252818, 93.09218729735692, -6.401431121731656, 152.60244879887074, 109.65286139829752, 106.23744237530288, 0.9402289393527218, 102.83811553786231, 106.74938461939604, -16.71458309400484, 183.18456931177263, 73.23208826591163, 130.67284347701684, -7.6388019357471215, 149.46492317041475, 110.43143244293783, -32.36343967163511, 65.64280247045119, 78.45735384975278, -24.974467158251255, 19.602891885675387, 66.87596429873399, 95.30288751775826, 38.17513925420708, 2.0000000000000013, 124.32459644544952, 121.68799068516152, 167.18684021285117, 12.749291055975162, 129.58910159347707, 168.7193236336115, 113.35894768113496, -7.007293998295026, -16.155865924343964, 150.01089284957203, 37.01638303040314, -12.545977389656784, 177.88241374648175, 165.04732476000734, 158.41262257604743, 144.03229526859758, 107.18506159128835, 154.03310941547454, 106.8495785718836, 166.80829416325545, 184.84037864351978, 154.12446856076605, 99.53196940651505, 112.17539487443489, 117.59830583536275, 98.03095226036211, -120.5281165142728, -11.113999417381653, 106.37280816428293, 148.80153099199165, 161.75797302094148, 79.86480275149651, 165.65463056133444, 168.487466558452, 134.99534429135502, 146.30420756317818, 82.83022530268775, -63.02090965033823, 135.42906858672967, 121.05259488376291, 156.55897900054666, -6.699188619781371, -93.08772245520392, 157.75860511950836, 158.17257917016323, 37.21468936642613, 73.40874724574657, 93.99779454777527, -90.81357638453458, 92.58049885480862, 155.80974076283104, -11.123923320339163], "policy_predator_policy_reward": [45.45260999460973, 92.94324759055674, 68.78376374216013, 104.06623295908476, 21.103617993177885, 37.17526079536339, 19.422948440216242, 44.38107526151601, 110.17306347807343, 153.16281383759684, 128.0299147368405, 112.14926621508657, 4.852681093741094, 62.17760718935358, 32.63512475845572, 39.43759028909975, 34.34795994683227, 25.190859687259486, 5.427822023343439, 196.87418558405244, 137.3338521096292, 99.43683434112104, 31.399661440905685, 86.29504084517032, 71.84445877753637, 2.1871791065090527, 17.304277638778622, 11.154105977999961, 0.9836328143928038, 0.0, 77.72323835561552, 76.17047517583104, 39.437449267973605, 14.163944501862904, 101.0658300082887, 77.7074511581628, 15.706390320815082, 19.808289065485766, 14.421329314574843, 3.964572118168082, 45.24167955957613, 79.97729060851981, 141.5454714536192, 15.610285445888065, 36.393370103267976, 12.371940200645946, 3.5945066828567067, 21.38150631796719, 51.61791416589061, 79.69452945776521, 142.2569695239471, 83.3776333499375, 24.36804116015391, 94.00885420153207, 13.331613968790464, 27.300608945044733, 34.64339006182166, 6.70529892092833, 101.04035661495936, 5.94034915177699, 29.56160063014788, 12.934418909928707, 62.59845037082394, 62.881383526193105, 44.2096992386094, 2.7384813074559133, 56.82494443383735, 76.91559962603436, 91.31937914836043, 7.069144247444938, 5.851298920980632, 254.52222094345726, 110.75670897790893, 107.30023709795488, 30.097098729967737, 29.65463831852143, 201.70081059317957, 44.21353269858716, 80.28810997465358, 10.745240972288292, 2.0932978785769456, 131.39930828802792, 3.3981973655710007, 5.475561604530041, 26.93262977218447, 5.937902953590851, 21.79812039300471, 7.5076772358006885, 87.05326131856144, 0.0, 2.409543134125199, 21.704421292747714, 159.53286810089375, 221.8552905104128, 37.802234408703605, 27.696293315456685, 7.367169048863939, 205.55952299080866, 11.91516067948091, 30.785456021945635, 65.48724025885889, 73.92873046334348, 70.13043814422198, 42.13364259459613, 0.0, 49.56062878251736, 109.84055877316742, 20.589059470354968, 56.63104458752435, 14.348126224157179, 35.10059003576668, 38.24936165830651, 159.4752582088561, 84.10189545183187, 10.90859610838935, 42.339119815181455, 6.4959142512115875, 0.0, 60.05484646709964, 70.96747748989452, 38.35708849326971, 51.36408493500694, 48.05135195637577, 2.68311592674071, 57.19781270264307, 8.351431121731615, 3.4286816400187687, 32.24293890424573, 42.24463147823528, 1.8076972071091393, 51.64078255497097, 0.0, 19.57290367254312, 0.9971101096893062, 45.12791173408837, 12.797156522983189, 9.57880193574708, 4.965076829585305, 15.781033196948455, 41.34097403174904, 68.17879264660384, 81.88173573765044, 38.72897037158501, 20.013176220976177, 31.368507537686966, 76.80847424757948, 55.36976646561626, 36.66415329770804, 2.5197285237454228, 47.13768434564367, 43.082925491304735, 11.060943239869, 0.7687276098569703, 20.247331988789636, 32.961052318865114, 8.957293998294984, 17.99586592434425, 24.089107150427985, 50.98294197314628, 53.11993665811092, 20.123735549003932, 8.544626617532261, 15.087141331533424, 10.724590493482188, 18.787075763503648, 20.63260943182378, 5.00042142811642, 2.471705836744538, 21.599386013126463, 25.533421348451746, 17.188030593485326, 5.604605125565432, 51.24088822022074, 43.90746655638952, 239.82811651427255, 13.063999417381611, 14.517857552734862, 33.28640815400501, 9.452026979058557, 19.751352409342456, 5.73253344154804, 3.5384410754231395, 10.27946737843028, 3.340980767036689, 51.34461353089312, 139.39648202521428, 24.743372472771778, 45.95113205616338, 1.074986246668239, 9.415223372566421, 94.73772245520476, 1.6313948804916505, 0.0, 110.89791724500917, 65.84788285512865, 65.16015843635824, 49.024456327533, 178.5999948464451, 19.699237894551224, 21.40188185302768]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8299216996270764, "mean_inference_ms": 2.623599485725704, "mean_action_processing_ms": 0.35433871427907926, "mean_env_wait_ms": 0.29013932167595696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006072282791137695, "StateBufferConnector_ms": 0.0032101869583129883, "ViewRequirementAgentConnector_ms": 0.09812843799591064}, "num_episodes": 23, "episode_return_max": 386.09765456586393, "episode_return_min": 0.7682268166310704, "episode_return_mean": 139.23519533349597, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 363.49246307203964, "num_env_steps_trained_throughput_per_sec": 363.49246307203964, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 23919.062, "restore_workers_time_ms": 0.012, "training_step_time_ms": 23919.027, "sample_time_ms": 1485.809, "learn_time_ms": 22416.599, "learn_throughput": 178.439, "synch_weights_time_ms": 15.457}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 96, "trial_id": "61e09_00000", "date": "2024-08-16_16-31-24", "timestamp": 1723806084, "time_this_iter_s": 11.00987696647644, "time_total_s": 1483.1328213214874, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2499dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1483.1328213214874, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 52.63333333333333, "ram_util_percent": 76.29333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.047544641311837, "cur_kl_coeff": 0.10678710937499997, "cur_lr": 0.00010000000000000003, "total_loss": 1.2504675395905025, "policy_loss": -0.005618532949925533, "vf_loss": 1.2554976667045916, "vf_explained_var": 0.17612870896934832, "kl": 0.005510110716711925, "entropy": 0.5722411731563548, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.969258367321479, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 6.33557504976868, "policy_loss": -0.008032518773827525, "vf_loss": 6.340077664107873, "vf_explained_var": 0.7377067868040983, "kl": 0.011766312851685001, "entropy": 1.3434853859048672, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "env_runners": {"episode_reward_max": 386.09765456586393, "episode_reward_min": 3.6099999999999675, "episode_reward_mean": 182.0573501253417, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -249.3822209434583, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.04000000000002, "predator_policy": 254.52222094345726}, "policy_reward_mean": {"prey_policy": 50.85646651067032, "predator_policy": 40.17220855200054}, "custom_metrics": {}, "hist_stats": {"episode_reward": [53.30000000000011, 3.8299999999999623, 110.02000000000027, 70.01862720968704, 95.06020450342704, 109.81000000000077, 103.36023562522226, 22.490000000000325, 95.26947189030804, 29.090390422206127, 3.6099999999999675, 8.823822283085624, 143.1008764409732, 79.11978422171744, 66.05000000000038, 134.01643705687658, 6.509999999999925, 7.09999999999995, 136.75820882723247, 21.01646231750562, 90.11430243015243, 111.42000000000056, 87.20083209017407, 249.419999999999, 159.41781145084377, 45.41000000000003, 125.4001455270128, 82.96000000000097, 280.0595372040129, 24.988866671843713, 75.76404242535374, 118.53000000000084, 48.42138006065136, 161.3339966558332, 41.19999999999942, 58.51999999999959, 108.62001068166282, 142.09050281642726, 7.82587313826118, 31.32000000000048, 14.849999999999955, 147.11848890692835, 159.89234019962487, 272.268461258613, 152.2400000000001, 297.92693074143244, 151.23000000000005, 261.2282827122287, 187.03999999999957, 261.8299999999999, 156.37000000000018, 135.19000000000028, 294.16068470445805, 53.370571319985025, 270.3558336017585, 132.20905901753156, 295.6699999999998, 234.0799999999998, 319.3244848257347, 148.27, 175.93999999999988, 128.57328427200412, 371.5981006730252, 328.25664966966036, 300.6378562020904, 281.1299999999999, 386.09765456586393, 234.4999999999988, 310.7776128723351, 121.25000000000038, 302.9786048630144, 270.826155160839, 343.41307163675754, 294.91999999999956, 210.55041120845635, 327.17616799942766, 160.34999999999997, 161.04000000000008, 306.28518578159844, 298.41458308500836, 229.39137364425233, 185.78693719007043, 359.5423166977274, 294.78999999999985, 4.933509308806518, 372.21000000000004, 330.77561405733616, 368.5071036007436, 186.79824741441783, 326.36, 190.99999999999963, 367.1434282956222, 318.84321828325733, 308.69940079232487, 177.21000000000004, 311.8331553638328, 299.10329921955247, 315.81847434303154, 311.5405165230811, 337.73612057126485], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-13.766390320815123, 31.55171093451427, -12.56132931457488, -1.9945721181681237, -40.61167955957616, 25.412709391480256, -110.6813187806403, 23.544189090820787, -0.6772816884427015, 46.97217588795552, 0.805169279229237, 84.02881771994697, -48.930108545797864, 20.977900547363888, -126.19696952394649, -76.94763334993674, -1.7169721014998902, -21.390451369878686, -8.552638662131791, -2.989193829497717, -32.98339006182163, -4.755298920928372, -60.37387278365263, -37.7830106999984, 101.37651708819467, -0.771660187297946, -45.31842680818609, -1.0416228671133068, 19.860300761390636, -0.7584813074559278, 73.94596182902839, -73.67006883202357, -86.76937914836003, -5.10914424744498, -3.891298920980674, -249.3822209434583, 63.41274385630935, -144.71148110494215, -11.931126751482385, -26.804147979501053, -106.12403555802298, -49.67600530359155, 21.080196030862105, -0.6935469778039789, 50.07818529550336, -96.36995937193427, 114.40180263442932, 126.14443839547022, 125.44737022781563, 1.0999084972530564, 21.651879606995333, -5.54767723580073, -6.468801836586273, 44.815686045037225, 57.86496172031795, 0.9810738528094921, 44.73931042932755, -146.06793183662066, -25.36308114307069, -15.146579909246373, 0.8868733764897011, -138.04952299080915, 97.89483932051932, -22.065456021945373, -64.70597836877324, -26.28861229277751, 73.99342574336553, -24.923509826349918, 34.461852608032004, -42.82248139054984, -27.24709654864718, -44.6625216948751, 40.90246151464953, -3.2616216446684927, 68.53595063272978, 0.20460048962421254, -181.94270394630985, -53.80857657611817, -8.958596108389392, -12.969119815181479, -4.535914251211629, 12.88999999999998, 75.1597998174868, -59.0636348675528, 108.09357346586155, -37.92240669451295, 99.90562716296863, 121.62836621252818, 93.09218729735692, -6.401431121731656, 152.60244879887074, 109.65286139829752, 106.23744237530288, 0.9402289393527218, 102.83811553786231, 106.74938461939604, -16.71458309400484, 183.18456931177263, 73.23208826591163, 130.67284347701684, -7.6388019357471215, 149.46492317041475, 110.43143244293783, -32.36343967163511, 65.64280247045119, 78.45735384975278, -24.974467158251255, 19.602891885675387, 66.87596429873399, 95.30288751775826, 38.17513925420708, 2.0000000000000013, 124.32459644544952, 121.68799068516152, 167.18684021285117, 12.749291055975162, 129.58910159347707, 168.7193236336115, 113.35894768113496, -7.007293998295026, -16.155865924343964, 150.01089284957203, 37.01638303040314, -12.545977389656784, 177.88241374648175, 165.04732476000734, 158.41262257604743, 144.03229526859758, 107.18506159128835, 154.03310941547454, 106.8495785718836, 166.80829416325545, 184.84037864351978, 154.12446856076605, 99.53196940651505, 112.17539487443489, 117.59830583536275, 98.03095226036211, -120.5281165142728, -11.113999417381653, 106.37280816428293, 148.80153099199165, 161.75797302094148, 79.86480275149651, 165.65463056133444, 168.487466558452, 134.99534429135502, 146.30420756317818, 82.83022530268775, -63.02090965033823, 135.42906858672967, 121.05259488376291, 156.55897900054666, -6.699188619781371, -93.08772245520392, 157.75860511950836, 158.17257917016323, 37.21468936642613, 73.40874724574657, 93.99779454777527, -90.81357638453458, 92.58049885480862, 155.80974076283104, -11.123923320339163, 148.63918972850172, 134.5982644136475, 135.64843445086478, 91.20680301897687, -1.2055496507585506, -0.23204034195194967, 196.04000000000002, 169.51397371920547, 158.25919151026295, 160.10865983169776, 149.6578286572551, 73.55292426746179, 2.0000000000000013, 160.39378496848914, 153.31194403330275, 113.19261712455044, -6.084223981712581, 181.6145140034182, 179.17447907267442, 186.13999999999996, 126.14549965746416, 138.31833044167792, 159.631928371632, 89.2083950133417, -5.136082049981184, 175.2500000000001, 58.52335082702066, 154.8177880242218, -6.3940063844476125, 128.62568769428322, 168.1780974104021, 118.09361613665878, 137.05960144319533, 160.70235837320655, 123.58432806223377, 168.94568590065674], "policy_predator_policy_reward": [15.706390320815082, 19.808289065485766, 14.421329314574843, 3.964572118168082, 45.24167955957613, 79.97729060851981, 141.5454714536192, 15.610285445888065, 36.393370103267976, 12.371940200645946, 3.5945066828567067, 21.38150631796719, 51.61791416589061, 79.69452945776521, 142.2569695239471, 83.3776333499375, 24.36804116015391, 94.00885420153207, 13.331613968790464, 27.300608945044733, 34.64339006182166, 6.70529892092833, 101.04035661495936, 5.94034915177699, 29.56160063014788, 12.934418909928707, 62.59845037082394, 62.881383526193105, 44.2096992386094, 2.7384813074559133, 56.82494443383735, 76.91559962603436, 91.31937914836043, 7.069144247444938, 5.851298920980632, 254.52222094345726, 110.75670897790893, 107.30023709795488, 30.097098729967737, 29.65463831852143, 201.70081059317957, 44.21353269858716, 80.28810997465358, 10.745240972288292, 2.0932978785769456, 131.39930828802792, 3.3981973655710007, 5.475561604530041, 26.93262977218447, 5.937902953590851, 21.79812039300471, 7.5076772358006885, 87.05326131856144, 0.0, 2.409543134125199, 21.704421292747714, 159.53286810089375, 221.8552905104128, 37.802234408703605, 27.696293315456685, 7.367169048863939, 205.55952299080866, 11.91516067948091, 30.785456021945635, 65.48724025885889, 73.92873046334348, 70.13043814422198, 42.13364259459613, 0.0, 49.56062878251736, 109.84055877316742, 20.589059470354968, 56.63104458752435, 14.348126224157179, 35.10059003576668, 38.24936165830651, 159.4752582088561, 84.10189545183187, 10.90859610838935, 42.339119815181455, 6.4959142512115875, 0.0, 60.05484646709964, 70.96747748989452, 38.35708849326971, 51.36408493500694, 48.05135195637577, 2.68311592674071, 57.19781270264307, 8.351431121731615, 3.4286816400187687, 32.24293890424573, 42.24463147823528, 1.8076972071091393, 51.64078255497097, 0.0, 19.57290367254312, 0.9971101096893062, 45.12791173408837, 12.797156522983189, 9.57880193574708, 4.965076829585305, 15.781033196948455, 41.34097403174904, 68.17879264660384, 81.88173573765044, 38.72897037158501, 20.013176220976177, 31.368507537686966, 76.80847424757948, 55.36976646561626, 36.66415329770804, 2.5197285237454228, 47.13768434564367, 43.082925491304735, 11.060943239869, 0.7687276098569703, 20.247331988789636, 32.961052318865114, 8.957293998294984, 17.99586592434425, 24.089107150427985, 50.98294197314628, 53.11993665811092, 20.123735549003932, 8.544626617532261, 15.087141331533424, 10.724590493482188, 18.787075763503648, 20.63260943182378, 5.00042142811642, 2.471705836744538, 21.599386013126463, 25.533421348451746, 17.188030593485326, 5.604605125565432, 51.24088822022074, 43.90746655638952, 239.82811651427255, 13.063999417381611, 14.517857552734862, 33.28640815400501, 9.452026979058557, 19.751352409342456, 5.73253344154804, 3.5384410754231395, 10.27946737843028, 3.340980767036689, 51.34461353089312, 139.39648202521428, 24.743372472771778, 45.95113205616338, 1.074986246668239, 9.415223372566421, 94.73772245520476, 1.6313948804916505, 0.0, 110.89791724500917, 65.84788285512865, 65.16015843635824, 49.024456327533, 178.5999948464451, 19.699237894551224, 21.40188185302768, 43.530594633831534, 32.77426792174676, 4.082278540183944, 63.852483989974395, 3.185549650758526, 3.185549650758526, 0.0, 6.6560262807945305, 9.42661098903578, 2.9811517263398732, 64.84946812898774, 80.446882547039, 6.001485809105487, 18.40297663682345, 21.808055966697246, 38.047382875449514, 9.057612465444093, 6.412097512850204, 0.8134282956222438, 1.0155209273255583, 33.09108431176274, 21.288303872352625, 0.8705855628129184, 58.98849184453831, 7.096082049981142, 0.0, 57.68606962406432, 40.80594688852615, 142.51400638444755, 34.357611525269306, 0.0, 29.546760795970894, 0.8110738809081025, 12.967482825771238, 20.126480348050155, 25.079626260324204]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8279080669947342, "mean_inference_ms": 2.6176488768137833, "mean_action_processing_ms": 0.35341213310664116, "mean_env_wait_ms": 0.2893157093603651, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005640983581542969, "StateBufferConnector_ms": 0.003195524215698242, "ViewRequirementAgentConnector_ms": 0.09815239906311035}, "num_episodes": 18, "episode_return_max": 386.09765456586393, "episode_return_min": 3.6099999999999675, "episode_return_mean": 182.0573501253417, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 378.7917122153866, "num_env_steps_trained_throughput_per_sec": 378.7917122153866, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 1552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1552000, "timers": {"training_iteration_time_ms": 23825.235, "restore_workers_time_ms": 0.012, "training_step_time_ms": 23825.201, "sample_time_ms": 1476.252, "learn_time_ms": 22332.84, "learn_throughput": 179.108, "synch_weights_time_ms": 14.873}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "done": false, "training_iteration": 97, "trial_id": "61e09_00000", "date": "2024-08-16_16-31-34", "timestamp": 1723806094, "time_this_iter_s": 10.565782070159912, "time_total_s": 1493.6986033916473, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x300255f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1493.6986033916473, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 48.306666666666665, "ram_util_percent": 76.08666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7785387212006505, "cur_kl_coeff": 0.10678710937499997, "cur_lr": 0.00010000000000000003, "total_loss": 1.1258524111654393, "policy_loss": -0.007018586391060756, "vf_loss": 1.1319916394652514, "vf_explained_var": 0.40540059350785757, "kl": 0.008234660907330316, "entropy": 0.5744160592556, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.414441784349068, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 4.932737124912323, "policy_loss": -0.016310861776706088, "vf_loss": 4.945757926708807, "vf_explained_var": 0.9290252846384806, "kl": 0.010966915232465811, "entropy": 1.2659935637125894, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "env_runners": {"episode_reward_max": 386.09765456586393, "episode_reward_min": 4.933509308806518, "episode_reward_mean": 230.68575144761763, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -181.94270394630985, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.01, "predator_policy": 283.30246626246606}, "policy_reward_mean": {"prey_policy": 81.0328769961778, "predator_policy": 34.30999872763107}, "custom_metrics": {}, "hist_stats": {"episode_reward": [87.20083209017407, 249.419999999999, 159.41781145084377, 45.41000000000003, 125.4001455270128, 82.96000000000097, 280.0595372040129, 24.988866671843713, 75.76404242535374, 118.53000000000084, 48.42138006065136, 161.3339966558332, 41.19999999999942, 58.51999999999959, 108.62001068166282, 142.09050281642726, 7.82587313826118, 31.32000000000048, 14.849999999999955, 147.11848890692835, 159.89234019962487, 272.268461258613, 152.2400000000001, 297.92693074143244, 151.23000000000005, 261.2282827122287, 187.03999999999957, 261.8299999999999, 156.37000000000018, 135.19000000000028, 294.16068470445805, 53.370571319985025, 270.3558336017585, 132.20905901753156, 295.6699999999998, 234.0799999999998, 319.3244848257347, 148.27, 175.93999999999988, 128.57328427200412, 371.5981006730252, 328.25664966966036, 300.6378562020904, 281.1299999999999, 386.09765456586393, 234.4999999999988, 310.7776128723351, 121.25000000000038, 302.9786048630144, 270.826155160839, 343.41307163675754, 294.91999999999956, 210.55041120845635, 327.17616799942766, 160.34999999999997, 161.04000000000008, 306.28518578159844, 298.41458308500836, 229.39137364425233, 185.78693719007043, 359.5423166977274, 294.78999999999985, 4.933509308806518, 372.21000000000004, 330.77561405733616, 368.5071036007436, 186.79824741441783, 326.36, 190.99999999999963, 367.1434282956222, 318.84321828325733, 308.69940079232487, 177.21000000000004, 311.8331553638328, 299.10329921955247, 315.81847434303154, 311.5405165230811, 337.73612057126485, 350.30781919121694, 350.26394805887116, 147.35000000000025, 288.6227267118123, 175.13, 359.3299999999999, 374.27310628484724, 384.1, 320.0470085799343, 278.9241901617579, 166.61484479693866, 337.4445970563367, 365.7267707552142, 154.1000000000001, 194.0099999999997, 364.1224934991013, 288.80264919678507, 327.5199999999999, 306.7419801077682, 303.896821055408, 348.2399999999999, 177.1599999999996], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [50.07818529550336, -96.36995937193427, 114.40180263442932, 126.14443839547022, 125.44737022781563, 1.0999084972530564, 21.651879606995333, -5.54767723580073, -6.468801836586273, 44.815686045037225, 57.86496172031795, 0.9810738528094921, 44.73931042932755, -146.06793183662066, -25.36308114307069, -15.146579909246373, 0.8868733764897011, -138.04952299080915, 97.89483932051932, -22.065456021945373, -64.70597836877324, -26.28861229277751, 73.99342574336553, -24.923509826349918, 34.461852608032004, -42.82248139054984, -27.24709654864718, -44.6625216948751, 40.90246151464953, -3.2616216446684927, 68.53595063272978, 0.20460048962421254, -181.94270394630985, -53.80857657611817, -8.958596108389392, -12.969119815181479, -4.535914251211629, 12.88999999999998, 75.1597998174868, -59.0636348675528, 108.09357346586155, -37.92240669451295, 99.90562716296863, 121.62836621252818, 93.09218729735692, -6.401431121731656, 152.60244879887074, 109.65286139829752, 106.23744237530288, 0.9402289393527218, 102.83811553786231, 106.74938461939604, -16.71458309400484, 183.18456931177263, 73.23208826591163, 130.67284347701684, -7.6388019357471215, 149.46492317041475, 110.43143244293783, -32.36343967163511, 65.64280247045119, 78.45735384975278, -24.974467158251255, 19.602891885675387, 66.87596429873399, 95.30288751775826, 38.17513925420708, 2.0000000000000013, 124.32459644544952, 121.68799068516152, 167.18684021285117, 12.749291055975162, 129.58910159347707, 168.7193236336115, 113.35894768113496, -7.007293998295026, -16.155865924343964, 150.01089284957203, 37.01638303040314, -12.545977389656784, 177.88241374648175, 165.04732476000734, 158.41262257604743, 144.03229526859758, 107.18506159128835, 154.03310941547454, 106.8495785718836, 166.80829416325545, 184.84037864351978, 154.12446856076605, 99.53196940651505, 112.17539487443489, 117.59830583536275, 98.03095226036211, -120.5281165142728, -11.113999417381653, 106.37280816428293, 148.80153099199165, 161.75797302094148, 79.86480275149651, 165.65463056133444, 168.487466558452, 134.99534429135502, 146.30420756317818, 82.83022530268775, -63.02090965033823, 135.42906858672967, 121.05259488376291, 156.55897900054666, -6.699188619781371, -93.08772245520392, 157.75860511950836, 158.17257917016323, 37.21468936642613, 73.40874724574657, 93.99779454777527, -90.81357638453458, 92.58049885480862, 155.80974076283104, -11.123923320339163, 148.63918972850172, 134.5982644136475, 135.64843445086478, 91.20680301897687, -1.2055496507585506, -0.23204034195194967, 196.04000000000002, 169.51397371920547, 158.25919151026295, 160.10865983169776, 149.6578286572551, 73.55292426746179, 2.0000000000000013, 160.39378496848914, 153.31194403330275, 113.19261712455044, -6.084223981712581, 181.6145140034182, 179.17447907267442, 186.13999999999996, 126.14549965746416, 138.31833044167792, 159.631928371632, 89.2083950133417, -5.136082049981184, 175.2500000000001, 58.52335082702066, 154.8177880242218, -6.3940063844476125, 128.62568769428322, 168.1780974104021, 118.09361613665878, 137.05960144319533, 160.70235837320655, 123.58432806223377, 168.94568590065674, 151.98275508782444, 138.71144791057793, 189.2344348850752, 145.6988213493761, -3.3068297392407944, 120.46977072396729, 85.60077799273779, 100.76078247380082, 163.8805031031966, -6.469095965256894, 167.9474602893356, 183.46467107189935, 161.4264708640768, 159.47556083348098, 199.01, 179.64581261820067, 87.67737240719188, 146.22781361144274, -157.13301091987694, 151.91485978720127, 155.9725632701384, -19.72725374798091, 138.5024539352322, 150.80891264583516, 146.77410222262867, 177.332508228091, -0.9033393437327604, 105.50652384941792, 190.32459785429035, -7.941160618135029, 125.67595397560177, 165.02206219200446, 84.89923776879067, 164.42360387677064, 198.05047891227946, 86.86836274756502, 152.72258901594472, 100.85832581159872, 89.19632018235781, 93.43900061496993, 175.29026124952765, 132.17315793649087, 167.60697755734694, -0.4108875724246339], "policy_predator_policy_reward": [2.0932978785769456, 131.39930828802792, 3.3981973655710007, 5.475561604530041, 26.93262977218447, 5.937902953590851, 21.79812039300471, 7.5076772358006885, 87.05326131856144, 0.0, 2.409543134125199, 21.704421292747714, 159.53286810089375, 221.8552905104128, 37.802234408703605, 27.696293315456685, 7.367169048863939, 205.55952299080866, 11.91516067948091, 30.785456021945635, 65.48724025885889, 73.92873046334348, 70.13043814422198, 42.13364259459613, 0.0, 49.56062878251736, 109.84055877316742, 20.589059470354968, 56.63104458752435, 14.348126224157179, 35.10059003576668, 38.24936165830651, 159.4752582088561, 84.10189545183187, 10.90859610838935, 42.339119815181455, 6.4959142512115875, 0.0, 60.05484646709964, 70.96747748989452, 38.35708849326971, 51.36408493500694, 48.05135195637577, 2.68311592674071, 57.19781270264307, 8.351431121731615, 3.4286816400187687, 32.24293890424573, 42.24463147823528, 1.8076972071091393, 51.64078255497097, 0.0, 19.57290367254312, 0.9971101096893062, 45.12791173408837, 12.797156522983189, 9.57880193574708, 4.965076829585305, 15.781033196948455, 41.34097403174904, 68.17879264660384, 81.88173573765044, 38.72897037158501, 20.013176220976177, 31.368507537686966, 76.80847424757948, 55.36976646561626, 36.66415329770804, 2.5197285237454228, 47.13768434564367, 43.082925491304735, 11.060943239869, 0.7687276098569703, 20.247331988789636, 32.961052318865114, 8.957293998294984, 17.99586592434425, 24.089107150427985, 50.98294197314628, 53.11993665811092, 20.123735549003932, 8.544626617532261, 15.087141331533424, 10.724590493482188, 18.787075763503648, 20.63260943182378, 5.00042142811642, 2.471705836744538, 21.599386013126463, 25.533421348451746, 17.188030593485326, 5.604605125565432, 51.24088822022074, 43.90746655638952, 239.82811651427255, 13.063999417381611, 14.517857552734862, 33.28640815400501, 9.452026979058557, 19.751352409342456, 5.73253344154804, 3.5384410754231395, 10.27946737843028, 3.340980767036689, 51.34461353089312, 139.39648202521428, 24.743372472771778, 45.95113205616338, 1.074986246668239, 9.415223372566421, 94.73772245520476, 1.6313948804916505, 0.0, 110.89791724500917, 65.84788285512865, 65.16015843635824, 49.024456327533, 178.5999948464451, 19.699237894551224, 21.40188185302768, 43.530594633831534, 32.77426792174676, 4.082278540183944, 63.852483989974395, 3.185549650758526, 3.185549650758526, 0.0, 6.6560262807945305, 9.42661098903578, 2.9811517263398732, 64.84946812898774, 80.446882547039, 6.001485809105487, 18.40297663682345, 21.808055966697246, 38.047382875449514, 9.057612465444093, 6.412097512850204, 0.8134282956222438, 1.0155209273255583, 33.09108431176274, 21.288303872352625, 0.8705855628129184, 58.98849184453831, 7.096082049981142, 0.0, 57.68606962406432, 40.80594688852615, 142.51400638444755, 34.357611525269306, 0.0, 29.546760795970894, 0.8110738809081025, 12.967482825771238, 20.126480348050155, 25.079626260324204, 40.30855208942206, 19.305064103392578, 2.72951317379599, 12.601178650623888, 5.266829739240753, 24.920229276032785, 69.47534830166106, 32.78581794361261, 9.319496896803507, 8.399095965256853, 2.3325397106643733, 5.585328928100653, 41.67663542077052, 11.694439166519041, 0.8599426431165913, 4.58424473868274, 29.323689101658754, 56.818133459640904, 283.30246626246606, 0.8398750319675342, 0.9739860483768267, 29.39554922640466, 15.55943359842985, 32.57379687683957, 23.241058865568817, 18.379101438925787, 2.873339343732743, 46.6234761505821, 1.7354021457096622, 9.891160618134988, 40.55168041043329, 32.87279692106185, 17.15642588913051, 22.323381662093343, 0.9495210877205226, 41.65163725243489, 7.063819434532869, 46.09724584569208, 57.127324096198215, 64.13417616188207, 8.799738750472343, 31.976842063509167, 7.573022442652926, 2.390887572424627]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8261139740295215, "mean_inference_ms": 2.6074977070168592, "mean_action_processing_ms": 0.3522316233804921, "mean_env_wait_ms": 0.2881025850416765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004760026931762695, "StateBufferConnector_ms": 0.003067493438720703, "ViewRequirementAgentConnector_ms": 0.09310996532440186}, "num_episodes": 22, "episode_return_max": 386.09765456586393, "episode_return_min": 4.933509308806518, "episode_return_mean": 230.68575144761763, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.116987226898088, "num_env_steps_trained_throughput_per_sec": 4.116987226898088, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 1568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1568000, "timers": {"training_iteration_time_ms": 119798.56, "restore_workers_time_ms": 0.012, "training_step_time_ms": 119798.526, "sample_time_ms": 1454.389, "learn_time_ms": 118327.405, "learn_throughput": 33.805, "synch_weights_time_ms": 15.486}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "done": false, "training_iteration": 98, "trial_id": "61e09_00000", "date": "2024-08-16_16-47-46", "timestamp": 1723807066, "time_this_iter_s": 971.6064221858978, "time_total_s": 2465.305025577545, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x300039b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2465.305025577545, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 52.517647058823535, "ram_util_percent": 76.09411764705882}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8309073896950516, "cur_kl_coeff": 0.10678710937499997, "cur_lr": 0.00010000000000000003, "total_loss": 1.488648790846426, "policy_loss": -0.005924680819439273, "vf_loss": 1.4939947285349406, "vf_explained_var": 0.2271384371966912, "kl": 0.005419617359909816, "entropy": 0.48792983241497523, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.156015795122379, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 4.554457858378294, "policy_loss": -0.01159034567828433, "vf_loss": 4.56268501634951, "vf_explained_var": 0.8183376221745102, "kl": 0.01121057434646751, "entropy": 1.285111296239984, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 386.09765456586393, "episode_reward_min": 4.933509308806518, "episode_reward_mean": 263.3027882688614, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -157.13301091987694, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.01, "predator_policy": 283.30246626246606}, "policy_reward_mean": {"prey_policy": 100.27686834995457, "predator_policy": 31.37452578447621}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.849999999999955, 147.11848890692835, 159.89234019962487, 272.268461258613, 152.2400000000001, 297.92693074143244, 151.23000000000005, 261.2282827122287, 187.03999999999957, 261.8299999999999, 156.37000000000018, 135.19000000000028, 294.16068470445805, 53.370571319985025, 270.3558336017585, 132.20905901753156, 295.6699999999998, 234.0799999999998, 319.3244848257347, 148.27, 175.93999999999988, 128.57328427200412, 371.5981006730252, 328.25664966966036, 300.6378562020904, 281.1299999999999, 386.09765456586393, 234.4999999999988, 310.7776128723351, 121.25000000000038, 302.9786048630144, 270.826155160839, 343.41307163675754, 294.91999999999956, 210.55041120845635, 327.17616799942766, 160.34999999999997, 161.04000000000008, 306.28518578159844, 298.41458308500836, 229.39137364425233, 185.78693719007043, 359.5423166977274, 294.78999999999985, 4.933509308806518, 372.21000000000004, 330.77561405733616, 368.5071036007436, 186.79824741441783, 326.36, 190.99999999999963, 367.1434282956222, 318.84321828325733, 308.69940079232487, 177.21000000000004, 311.8331553638328, 299.10329921955247, 315.81847434303154, 311.5405165230811, 337.73612057126485, 350.30781919121694, 350.26394805887116, 147.35000000000025, 288.6227267118123, 175.13, 359.3299999999999, 374.27310628484724, 384.1, 320.0470085799343, 278.9241901617579, 166.61484479693866, 337.4445970563367, 365.7267707552142, 154.1000000000001, 194.0099999999997, 364.1224934991013, 288.80264919678507, 327.5199999999999, 306.7419801077682, 303.896821055408, 348.2399999999999, 177.1599999999996, 264.2183789058702, 322.1000275494847, 354.2391597510949, 355.02, 312.06871718467085, 358.73358162811894, 184.0799999999998, 349.4913279398065, 343.38356280217766, 332.6814975154434, 175.09999999999985, 334.16042415763286, 328.1180162817235, 186.02999999999975, 276.9990035167445, 175.08999999999986, 188.03999999999962, 270.63298361368726], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-4.535914251211629, 12.88999999999998, 75.1597998174868, -59.0636348675528, 108.09357346586155, -37.92240669451295, 99.90562716296863, 121.62836621252818, 93.09218729735692, -6.401431121731656, 152.60244879887074, 109.65286139829752, 106.23744237530288, 0.9402289393527218, 102.83811553786231, 106.74938461939604, -16.71458309400484, 183.18456931177263, 73.23208826591163, 130.67284347701684, -7.6388019357471215, 149.46492317041475, 110.43143244293783, -32.36343967163511, 65.64280247045119, 78.45735384975278, -24.974467158251255, 19.602891885675387, 66.87596429873399, 95.30288751775826, 38.17513925420708, 2.0000000000000013, 124.32459644544952, 121.68799068516152, 167.18684021285117, 12.749291055975162, 129.58910159347707, 168.7193236336115, 113.35894768113496, -7.007293998295026, -16.155865924343964, 150.01089284957203, 37.01638303040314, -12.545977389656784, 177.88241374648175, 165.04732476000734, 158.41262257604743, 144.03229526859758, 107.18506159128835, 154.03310941547454, 106.8495785718836, 166.80829416325545, 184.84037864351978, 154.12446856076605, 99.53196940651505, 112.17539487443489, 117.59830583536275, 98.03095226036211, -120.5281165142728, -11.113999417381653, 106.37280816428293, 148.80153099199165, 161.75797302094148, 79.86480275149651, 165.65463056133444, 168.487466558452, 134.99534429135502, 146.30420756317818, 82.83022530268775, -63.02090965033823, 135.42906858672967, 121.05259488376291, 156.55897900054666, -6.699188619781371, -93.08772245520392, 157.75860511950836, 158.17257917016323, 37.21468936642613, 73.40874724574657, 93.99779454777527, -90.81357638453458, 92.58049885480862, 155.80974076283104, -11.123923320339163, 148.63918972850172, 134.5982644136475, 135.64843445086478, 91.20680301897687, -1.2055496507585506, -0.23204034195194967, 196.04000000000002, 169.51397371920547, 158.25919151026295, 160.10865983169776, 149.6578286572551, 73.55292426746179, 2.0000000000000013, 160.39378496848914, 153.31194403330275, 113.19261712455044, -6.084223981712581, 181.6145140034182, 179.17447907267442, 186.13999999999996, 126.14549965746416, 138.31833044167792, 159.631928371632, 89.2083950133417, -5.136082049981184, 175.2500000000001, 58.52335082702066, 154.8177880242218, -6.3940063844476125, 128.62568769428322, 168.1780974104021, 118.09361613665878, 137.05960144319533, 160.70235837320655, 123.58432806223377, 168.94568590065674, 151.98275508782444, 138.71144791057793, 189.2344348850752, 145.6988213493761, -3.3068297392407944, 120.46977072396729, 85.60077799273779, 100.76078247380082, 163.8805031031966, -6.469095965256894, 167.9474602893356, 183.46467107189935, 161.4264708640768, 159.47556083348098, 199.01, 179.64581261820067, 87.67737240719188, 146.22781361144274, -157.13301091987694, 151.91485978720127, 155.9725632701384, -19.72725374798091, 138.5024539352322, 150.80891264583516, 146.77410222262867, 177.332508228091, -0.9033393437327604, 105.50652384941792, 190.32459785429035, -7.941160618135029, 125.67595397560177, 165.02206219200446, 84.89923776879067, 164.42360387677064, 198.05047891227946, 86.86836274756502, 152.72258901594472, 100.85832581159872, 89.19632018235781, 93.43900061496993, 175.29026124952765, 132.17315793649087, 167.60697755734694, -0.4108875724246339, 48.56349029499158, 89.5693300357082, 155.12079530208416, 134.13744527546913, 74.45752443925389, 186.44399438826701, 49.79028679228588, 184.9012018829543, 120.47876376484996, 101.4748337905209, 172.65654207092547, 159.0914906929935, 169.47653731971047, 2.0000000000000013, 166.94698422782633, 144.76079215925392, 142.63974690386826, 150.5876322292555, 153.49999925179486, 116.584194583064, 2.0000000000000013, 145.32999600229988, 135.84977861568308, 137.66387697158507, 181.86043573515715, -10.743840165262654, -2.904674161306387, 171.17111060902408, 67.425857295674, 166.68330000321987, 158.50834689351547, -16.514260838469895, -5.504393013320916, 177.8504684790184, 109.81901858808558, -135.44354383291304], "policy_predator_policy_reward": [6.4959142512115875, 0.0, 60.05484646709964, 70.96747748989452, 38.35708849326971, 51.36408493500694, 48.05135195637577, 2.68311592674071, 57.19781270264307, 8.351431121731615, 3.4286816400187687, 32.24293890424573, 42.24463147823528, 1.8076972071091393, 51.64078255497097, 0.0, 19.57290367254312, 0.9971101096893062, 45.12791173408837, 12.797156522983189, 9.57880193574708, 4.965076829585305, 15.781033196948455, 41.34097403174904, 68.17879264660384, 81.88173573765044, 38.72897037158501, 20.013176220976177, 31.368507537686966, 76.80847424757948, 55.36976646561626, 36.66415329770804, 2.5197285237454228, 47.13768434564367, 43.082925491304735, 11.060943239869, 0.7687276098569703, 20.247331988789636, 32.961052318865114, 8.957293998294984, 17.99586592434425, 24.089107150427985, 50.98294197314628, 53.11993665811092, 20.123735549003932, 8.544626617532261, 15.087141331533424, 10.724590493482188, 18.787075763503648, 20.63260943182378, 5.00042142811642, 2.471705836744538, 21.599386013126463, 25.533421348451746, 17.188030593485326, 5.604605125565432, 51.24088822022074, 43.90746655638952, 239.82811651427255, 13.063999417381611, 14.517857552734862, 33.28640815400501, 9.452026979058557, 19.751352409342456, 5.73253344154804, 3.5384410754231395, 10.27946737843028, 3.340980767036689, 51.34461353089312, 139.39648202521428, 24.743372472771778, 45.95113205616338, 1.074986246668239, 9.415223372566421, 94.73772245520476, 1.6313948804916505, 0.0, 110.89791724500917, 65.84788285512865, 65.16015843635824, 49.024456327533, 178.5999948464451, 19.699237894551224, 21.40188185302768, 43.530594633831534, 32.77426792174676, 4.082278540183944, 63.852483989974395, 3.185549650758526, 3.185549650758526, 0.0, 6.6560262807945305, 9.42661098903578, 2.9811517263398732, 64.84946812898774, 80.446882547039, 6.001485809105487, 18.40297663682345, 21.808055966697246, 38.047382875449514, 9.057612465444093, 6.412097512850204, 0.8134282956222438, 1.0155209273255583, 33.09108431176274, 21.288303872352625, 0.8705855628129184, 58.98849184453831, 7.096082049981142, 0.0, 57.68606962406432, 40.80594688852615, 142.51400638444755, 34.357611525269306, 0.0, 29.546760795970894, 0.8110738809081025, 12.967482825771238, 20.126480348050155, 25.079626260324204, 40.30855208942206, 19.305064103392578, 2.72951317379599, 12.601178650623888, 5.266829739240753, 24.920229276032785, 69.47534830166106, 32.78581794361261, 9.319496896803507, 8.399095965256853, 2.3325397106643733, 5.585328928100653, 41.67663542077052, 11.694439166519041, 0.8599426431165913, 4.58424473868274, 29.323689101658754, 56.818133459640904, 283.30246626246606, 0.8398750319675342, 0.9739860483768267, 29.39554922640466, 15.55943359842985, 32.57379687683957, 23.241058865568817, 18.379101438925787, 2.873339343732743, 46.6234761505821, 1.7354021457096622, 9.891160618134988, 40.55168041043329, 32.87279692106185, 17.15642588913051, 22.323381662093343, 0.9495210877205226, 41.65163725243489, 7.063819434532869, 46.09724584569208, 57.127324096198215, 64.13417616188207, 8.799738750472343, 31.976842063509167, 7.573022442652926, 2.390887572424627, 77.6373213137352, 48.448237261435246, 31.894077815954436, 0.9477091559772819, 90.5924755607461, 2.74516536282795, 111.20971320771412, 9.118798117045685, 86.57408477019129, 3.5410348591086636, 15.32276295856671, 11.662785905633296, 12.603462680289532, 0.0, 10.514343711980263, 27.269207840746084, 31.54096909107197, 18.615214577981998, 10.980360143550648, 51.61694353703394, 0.0, 27.770003997700115, 55.25701720987627, 5.389751360488393, 0.0, 157.001420711829, 4.874674161306345, 12.88888939097589, 39.27291292683927, 3.6169332910115064, 14.641653106484535, 18.454260838470198, 7.4643930133208745, 8.229531520981572, 27.97151973769983, 268.2859891208147]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8236032287189136, "mean_inference_ms": 2.6049617070595428, "mean_action_processing_ms": 0.3514922333549822, "mean_env_wait_ms": 0.287583130412568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004399418830871582, "StateBufferConnector_ms": 0.003100275993347168, "ViewRequirementAgentConnector_ms": 0.09954535961151123}, "num_episodes": 18, "episode_return_max": 386.09765456586393, "episode_return_min": 4.933509308806518, "episode_return_mean": 263.3027882688614, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 359.1871457830801, "num_env_steps_trained_throughput_per_sec": 359.1871457830801, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 119817.565, "restore_workers_time_ms": 0.012, "training_step_time_ms": 119817.53, "sample_time_ms": 1506.578, "learn_time_ms": 118294.171, "learn_throughput": 33.814, "synch_weights_time_ms": 15.522}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 99, "trial_id": "61e09_00000", "date": "2024-08-16_16-47-57", "timestamp": 1723807077, "time_this_iter_s": 11.143105030059814, "time_total_s": 2476.448130607605, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3000dce50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2476.448130607605, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 45.88666666666667, "ram_util_percent": 76.23333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4053670614169387, "cur_kl_coeff": 0.10678710937499997, "cur_lr": 0.00010000000000000003, "total_loss": 1.1381449824130094, "policy_loss": -0.007845321841902597, "vf_loss": 1.1452878719363262, "vf_explained_var": 0.42072644429232076, "kl": 0.006577879680136383, "entropy": 0.5537109559017515, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.39088321640378, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 3.8021200279710152, "policy_loss": -0.010387924027742532, "vf_loss": 3.809901925243398, "vf_explained_var": 0.9156989653589864, "kl": 0.00868672936988399, "entropy": 1.2818094514034413, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 386.09765456586393, "episode_reward_min": 4.933509308806518, "episode_reward_mean": 279.69164275838574, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -157.13301091987694, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.01, "predator_policy": 283.30246626246606}, "policy_reward_mean": {"prey_policy": 107.97385999378719, "predator_policy": 31.871961385405747}, "custom_metrics": {}, "hist_stats": {"episode_reward": [328.25664966966036, 300.6378562020904, 281.1299999999999, 386.09765456586393, 234.4999999999988, 310.7776128723351, 121.25000000000038, 302.9786048630144, 270.826155160839, 343.41307163675754, 294.91999999999956, 210.55041120845635, 327.17616799942766, 160.34999999999997, 161.04000000000008, 306.28518578159844, 298.41458308500836, 229.39137364425233, 185.78693719007043, 359.5423166977274, 294.78999999999985, 4.933509308806518, 372.21000000000004, 330.77561405733616, 368.5071036007436, 186.79824741441783, 326.36, 190.99999999999963, 367.1434282956222, 318.84321828325733, 308.69940079232487, 177.21000000000004, 311.8331553638328, 299.10329921955247, 315.81847434303154, 311.5405165230811, 337.73612057126485, 350.30781919121694, 350.26394805887116, 147.35000000000025, 288.6227267118123, 175.13, 359.3299999999999, 374.27310628484724, 384.1, 320.0470085799343, 278.9241901617579, 166.61484479693866, 337.4445970563367, 365.7267707552142, 154.1000000000001, 194.0099999999997, 364.1224934991013, 288.80264919678507, 327.5199999999999, 306.7419801077682, 303.896821055408, 348.2399999999999, 177.1599999999996, 264.2183789058702, 322.1000275494847, 354.2391597510949, 355.02, 312.06871718467085, 358.73358162811894, 184.0799999999998, 349.4913279398065, 343.38356280217766, 332.6814975154434, 175.09999999999985, 334.16042415763286, 328.1180162817235, 186.02999999999975, 276.9990035167445, 175.08999999999986, 188.03999999999962, 270.63298361368726, 301.8795548591435, 170.04999999999993, 286.08527911792703, 370.05999999999995, 341.06999999999994, 314.8236397350948, 320.2774466227769, 260.27471461433635, 369.2824175742607, 163.02999999999997, 177.20999999999972, 291.84127182873704, 190.0485487052793, 301.1518638110116, 156.18000000000004, 334.2623935419074, 185.95999999999975, 191.0299999999997, 352.7165964378803, 335.336981039598, 181.73950348338118, 347.04992773346055, 318.2618320809651], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [158.41262257604743, 144.03229526859758, 107.18506159128835, 154.03310941547454, 106.8495785718836, 166.80829416325545, 184.84037864351978, 154.12446856076605, 99.53196940651505, 112.17539487443489, 117.59830583536275, 98.03095226036211, -120.5281165142728, -11.113999417381653, 106.37280816428293, 148.80153099199165, 161.75797302094148, 79.86480275149651, 165.65463056133444, 168.487466558452, 134.99534429135502, 146.30420756317818, 82.83022530268775, -63.02090965033823, 135.42906858672967, 121.05259488376291, 156.55897900054666, -6.699188619781371, -93.08772245520392, 157.75860511950836, 158.17257917016323, 37.21468936642613, 73.40874724574657, 93.99779454777527, -90.81357638453458, 92.58049885480862, 155.80974076283104, -11.123923320339163, 148.63918972850172, 134.5982644136475, 135.64843445086478, 91.20680301897687, -1.2055496507585506, -0.23204034195194967, 196.04000000000002, 169.51397371920547, 158.25919151026295, 160.10865983169776, 149.6578286572551, 73.55292426746179, 2.0000000000000013, 160.39378496848914, 153.31194403330275, 113.19261712455044, -6.084223981712581, 181.6145140034182, 179.17447907267442, 186.13999999999996, 126.14549965746416, 138.31833044167792, 159.631928371632, 89.2083950133417, -5.136082049981184, 175.2500000000001, 58.52335082702066, 154.8177880242218, -6.3940063844476125, 128.62568769428322, 168.1780974104021, 118.09361613665878, 137.05960144319533, 160.70235837320655, 123.58432806223377, 168.94568590065674, 151.98275508782444, 138.71144791057793, 189.2344348850752, 145.6988213493761, -3.3068297392407944, 120.46977072396729, 85.60077799273779, 100.76078247380082, 163.8805031031966, -6.469095965256894, 167.9474602893356, 183.46467107189935, 161.4264708640768, 159.47556083348098, 199.01, 179.64581261820067, 87.67737240719188, 146.22781361144274, -157.13301091987694, 151.91485978720127, 155.9725632701384, -19.72725374798091, 138.5024539352322, 150.80891264583516, 146.77410222262867, 177.332508228091, -0.9033393437327604, 105.50652384941792, 190.32459785429035, -7.941160618135029, 125.67595397560177, 165.02206219200446, 84.89923776879067, 164.42360387677064, 198.05047891227946, 86.86836274756502, 152.72258901594472, 100.85832581159872, 89.19632018235781, 93.43900061496993, 175.29026124952765, 132.17315793649087, 167.60697755734694, -0.4108875724246339, 48.56349029499158, 89.5693300357082, 155.12079530208416, 134.13744527546913, 74.45752443925389, 186.44399438826701, 49.79028679228588, 184.9012018829543, 120.47876376484996, 101.4748337905209, 172.65654207092547, 159.0914906929935, 169.47653731971047, 2.0000000000000013, 166.94698422782633, 144.76079215925392, 142.63974690386826, 150.5876322292555, 153.49999925179486, 116.584194583064, 2.0000000000000013, 145.32999600229988, 135.84977861568308, 137.66387697158507, 181.86043573515715, -10.743840165262654, -2.904674161306387, 171.17111060902408, 67.425857295674, 166.68330000321987, 158.50834689351547, -16.514260838469895, -5.504393013320916, 177.8504684790184, 109.81901858808558, -135.44354383291304, 144.51767070374558, 88.39322266350112, 123.4736209419282, 0.23536296458027256, 92.96117329667364, 98.11815332654938, 156.5775109272044, 185.1013050205996, 191.06497980395562, 61.45445809195922, 61.28423781264367, 165.28840702750466, 93.13648602636069, 123.70547024827627, 68.36850762719625, 0.9274333743717591, 174.41519218987875, 168.70141531924054, 110.07672309783051, -5.681000968963488, 2.0000000000000013, 171.04794437511543, -20.740110199594, 151.80605782789712, 179.2022134813136, 1.1469711195957308, 133.25696615490725, 17.487282193823404, 122.2377318762108, -1.8535260708039252, 122.77420565142799, 129.28362245684855, 154.73586707050666, -3.4508694189421565, 0.4877739185112501, 180.17985758812273, 160.66092411911183, 153.74524501784884, 151.67052587098374, 145.98495201716707, 144.51114481546932, -4.645340815923561, 138.05715516566335, 163.20647222903293, 145.9860085835524, 143.58114540074155], "policy_predator_policy_reward": [15.087141331533424, 10.724590493482188, 18.787075763503648, 20.63260943182378, 5.00042142811642, 2.471705836744538, 21.599386013126463, 25.533421348451746, 17.188030593485326, 5.604605125565432, 51.24088822022074, 43.90746655638952, 239.82811651427255, 13.063999417381611, 14.517857552734862, 33.28640815400501, 9.452026979058557, 19.751352409342456, 5.73253344154804, 3.5384410754231395, 10.27946737843028, 3.340980767036689, 51.34461353089312, 139.39648202521428, 24.743372472771778, 45.95113205616338, 1.074986246668239, 9.415223372566421, 94.73772245520476, 1.6313948804916505, 0.0, 110.89791724500917, 65.84788285512865, 65.16015843635824, 49.024456327533, 178.5999948464451, 19.699237894551224, 21.40188185302768, 43.530594633831534, 32.77426792174676, 4.082278540183944, 63.852483989974395, 3.185549650758526, 3.185549650758526, 0.0, 6.6560262807945305, 9.42661098903578, 2.9811517263398732, 64.84946812898774, 80.446882547039, 6.001485809105487, 18.40297663682345, 21.808055966697246, 38.047382875449514, 9.057612465444093, 6.412097512850204, 0.8134282956222438, 1.0155209273255583, 33.09108431176274, 21.288303872352625, 0.8705855628129184, 58.98849184453831, 7.096082049981142, 0.0, 57.68606962406432, 40.80594688852615, 142.51400638444755, 34.357611525269306, 0.0, 29.546760795970894, 0.8110738809081025, 12.967482825771238, 20.126480348050155, 25.079626260324204, 40.30855208942206, 19.305064103392578, 2.72951317379599, 12.601178650623888, 5.266829739240753, 24.920229276032785, 69.47534830166106, 32.78581794361261, 9.319496896803507, 8.399095965256853, 2.3325397106643733, 5.585328928100653, 41.67663542077052, 11.694439166519041, 0.8599426431165913, 4.58424473868274, 29.323689101658754, 56.818133459640904, 283.30246626246606, 0.8398750319675342, 0.9739860483768267, 29.39554922640466, 15.55943359842985, 32.57379687683957, 23.241058865568817, 18.379101438925787, 2.873339343732743, 46.6234761505821, 1.7354021457096622, 9.891160618134988, 40.55168041043329, 32.87279692106185, 17.15642588913051, 22.323381662093343, 0.9495210877205226, 41.65163725243489, 7.063819434532869, 46.09724584569208, 57.127324096198215, 64.13417616188207, 8.799738750472343, 31.976842063509167, 7.573022442652926, 2.390887572424627, 77.6373213137352, 48.448237261435246, 31.894077815954436, 0.9477091559772819, 90.5924755607461, 2.74516536282795, 111.20971320771412, 9.118798117045685, 86.57408477019129, 3.5410348591086636, 15.32276295856671, 11.662785905633296, 12.603462680289532, 0.0, 10.514343711980263, 27.269207840746084, 31.54096909107197, 18.615214577981998, 10.980360143550648, 51.61694353703394, 0.0, 27.770003997700115, 55.25701720987627, 5.389751360488393, 0.0, 157.001420711829, 4.874674161306345, 12.88888939097589, 39.27291292683927, 3.6169332910115064, 14.641653106484535, 18.454260838470198, 7.4643930133208745, 8.229531520981572, 27.97151973769983, 268.2859891208147, 16.929011721687964, 52.03964977020897, 43.730390844439285, 2.610625249052233, 66.33170507435545, 28.674247420348582, 20.482489072795616, 7.898694979400408, 0.0, 88.55056210408513, 86.0596107307256, 2.1913841642210596, 94.86023546434649, 8.575254883793539, 164.2707874441428, 26.7079861686254, 19.196877952082954, 6.968932113058443, 51.00327690216951, 7.631000968963447, 0.0, 4.1620556248844895, 157.98279027431562, 2.7925339261183373, 6.52196881955382, 3.177395284816471, 22.2273009505076, 128.18031451177353, 31.962268123789197, 3.8335260708038863, 34.69125377933778, 47.51331165429306, 29.264132929493343, 5.410869418942115, 3.8222530980777627, 6.54011539528828, 26.076747080087983, 12.233680220831761, 29.38040913878208, 8.301094012665164, 19.02750597183534, 22.846193512000443, 35.81451615763763, 9.971784181126747, 26.896299993243673, 1.7983781034275912]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8222002756956391, "mean_inference_ms": 2.6052571670308327, "mean_action_processing_ms": 0.35126400927589574, "mean_env_wait_ms": 0.28697764691587674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039016008377075195, "StateBufferConnector_ms": 0.0031027793884277344, "ViewRequirementAgentConnector_ms": 0.15308809280395508}, "num_episodes": 23, "episode_return_max": 386.09765456586393, "episode_return_min": 4.933509308806518, "episode_return_mean": 279.69164275838574, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 358.8327982600694, "num_env_steps_trained_throughput_per_sec": 358.8327982600694, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 119681.129, "restore_workers_time_ms": 0.012, "training_step_time_ms": 119681.094, "sample_time_ms": 1588.74, "learn_time_ms": 118076.032, "learn_throughput": 33.876, "synch_weights_time_ms": 15.138}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": true, "training_iteration": 100, "trial_id": "61e09_00000", "date": "2024-08-16_16-48-08", "timestamp": 1723807088, "time_this_iter_s": 11.151550769805908, "time_total_s": 2487.599681377411, "pid": 82630, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3000a68b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2487.599681377411, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 46.5875, "ram_util_percent": 76.67500000000001}}
